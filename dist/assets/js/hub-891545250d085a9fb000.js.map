{"version":3,"file":"assets/js/hub-891545250d085a9fb000.js","mappings":"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","sources":["webpack://hubs/./src/components/action-to-event.js","webpack://hubs/./src/components/action-to-remove.js","webpack://hubs/./src/components/ambient-light.js","webpack://hubs/./src/components/animation.js","webpack://hubs/./src/components/audio-zone.js","webpack://hubs/./src/components/avatar-inspect-collider.js","webpack://hubs/./src/components/billboard.js","webpack://hubs/./src/components/block-button.js","webpack://hubs/./src/components/bone-mute-state-indicator.js","webpack://hubs/./src/components/close-vr-notice-button.js","webpack://hubs/./src/components/css-class.js","webpack://hubs/./src/components/debug.js","webpack://hubs/./src/components/directional-light.js","webpack://hubs/./src/components/disable-frustum-culling.js","webpack://hubs/./src/components/drop-object-button.js","webpack://hubs/./src/components/duck.js","webpack://hubs/./src/components/emit-scene-event-on-remove.js","webpack://hubs/./src/components/emit-state-change.js","webpack://hubs/./src/components/event-repeater.js","webpack://hubs/./src/components/fader.js","webpack://hubs/./src/components/follow-in-fov.js","webpack://hubs/./src/components/frustrum.js","webpack://hubs/./src/components/heightfield.js","webpack://hubs/./src/components/hemisphere-light.js","webpack://hubs/./src/components/hide-when-pinned-and-forbidden.js","webpack://hubs/./src/components/hide-when-quality.js","webpack://hubs/./src/components/hover-menu.js","webpack://hubs/./src/components/icon-button.js","webpack://hubs/./src/components/inject-main-camera-here.js","webpack://hubs/./src/components/inspect-button.js","webpack://hubs/./src/components/inspect-pivot-child-selector.js","webpack://hubs/./src/components/kick-button.js","webpack://hubs/./src/components/leave-room-button.js","webpack://hubs/./src/components/mute-button.js","webpack://hubs/./src/components/networked-avatar.js","webpack://hubs/./src/components/networked-counter.js","webpack://hubs/./src/components/optional-alternative-to-not-hide.js","webpack://hubs/./src/components/owned-object-cleanup-timeout.js","webpack://hubs/./src/components/owned-object-limiter.js","webpack://hubs/./src/components/periodic-full-syncs.js","webpack://hubs/./src/components/point-light.js","webpack://hubs/./src/components/replay.js","webpack://hubs/./src/components/set-unowned-body-kinematic.js","webpack://hubs/./src/components/set-yxz-order.js","webpack://hubs/./src/components/spot-light.js","webpack://hubs/./src/components/text-button.js","webpack://hubs/./src/components/tools/drawing-manager.js","webpack://hubs/./src/components/track-pose.js","webpack://hubs/./src/components/trigger-volume.js","webpack://hubs/./src/components/video-pause-state.js","webpack://hubs/./src/components/visibility-by-path.js","webpack://hubs/./src/components/visibility-on-content-types.js","webpack://hubs/./src/components/visible-if-permitted.js","webpack://hubs/./src/components/visible-to-owner.js","webpack://hubs/./src/constants.js","webpack://hubs/./src/assets/locales/locale_config.js","webpack://hubs/./src/utils/i18n.js","webpack://hubs/./src/utils/configs.js","webpack://hubs/./src/utils/hub-utils.js","webpack://hubs/./src/utils/get-color-scheme-pref.js","webpack://hubs/./src/react-components/styles/theme.js","webpack://hubs/./src/utils/async-utils.js","webpack://hubs/./src/utils/theme.js","webpack://hubs/./src/utils/detect-touchscreen.js","webpack://hubs/./src/utils/is-mobile.js","webpack://hubs/./src/utils/aframe-overrides.js","webpack://hubs/./src/utils/logging.js","webpack://hubs/./src/utils/webgl.js","webpack://hubs/./src/utils/identity.js","webpack://hubs/./src/utils/media-devices-utils.js","webpack://hubs/./src/storage/store.js","webpack://hubs/./src/utils/phoenix-utils.js","webpack://hubs/./src/transport-for-channel.js","webpack://hubs/./src/bit-components.js","webpack://hubs/./src/utils/permissions-utils.js","webpack://hubs/./src/phoenix-adapter.js","webpack://hubs/./src/utils/next-tick.js","webpack://hubs/./src/utils/animation.js","webpack://hubs/./src/naf-dialog-adapter.js","webpack://hubs/./src/change-hub.js","webpack://hubs/./src/components/animation-mixer.js","webpack://hubs/./src/utils/scene-graph.js","webpack://hubs/./src/utils/easing.js","webpack://hubs/./src/utils/component-utils.js","webpack://hubs/./src/components/audio-feedback.js","webpack://hubs/./src/object-types.js","webpack://hubs/./src/utils/media-highlight-frag.glsl","webpack://hubs/./src/utils/material-utils.js","webpack://hubs/./src/loaders/HubsTextureLoader.js","webpack://hubs/./src/components/hoverable-visuals.js","webpack://hubs/./src/utils/media-url-utils.js","webpack://hubs/./src/utils/media-utils.js","webpack://hubs/./src/components/slice9.js","webpack://hubs/./src/utils/promisify-worker.js","webpack://hubs/./src/components/layers.js","webpack://hubs/./src/utils/three-utils.js","webpack://hubs/./src/components/gltf-model-plus.js","webpack://hubs/./src/workers/sketchfab-zip.worker.js","webpack://hubs/./src/components/loop-animation.js","webpack://hubs/./src/components/uv-scroll.js","webpack://hubs/./src/utils/auto-box-collider.js","webpack://hubs/./src/components/audio-params.js","webpack://hubs/./src/update-audio-settings.js","webpack://hubs/./src/systems/sound-effects-system.js","webpack://hubs/./src/components/media-loader.js","webpack://hubs/./src/components/quack.js","webpack://hubs/./src/systems/userinput/paths.js","webpack://hubs/./src/components/tags.js","webpack://hubs/./src/systems/camera-system.js","webpack://hubs/./src/components/scene-preview-camera.js","webpack://hubs/./src/components/skybox.js","webpack://hubs/./src/components/spawn-controller.js","webpack://hubs/./src/systems/floaty-object-system.js","webpack://hubs/./src/components/floaty-object.js","webpack://hubs/./src/components/super-spawner.js","webpack://hubs/./src/components/water.js","webpack://hubs/./src/components/simple-water.js","webpack://hubs/./src/components/particle-emitter.js","webpack://hubs/./src/components/audio-zone-source.js","webpack://hubs/./src/components/troika-text.js","webpack://hubs/./src/components/mute-mic.js","webpack://hubs/./src/components/bone-visibility.js","webpack://hubs/./src/components/in-world-hud.js","webpack://hubs/./src/components/emoji.js","webpack://hubs/./src/components/emoji-hud.js","webpack://hubs/./src/components/virtual-gamepad-controls.css","webpack://hubs/./src/components/virtual-gamepad-controls.js","webpack://hubs/./src/components/ik-controller.js","webpack://hubs/./src/components/hand-controls2.js","webpack://hubs/./src/components/hover-visuals.js","webpack://hubs/./src/components/offset-relative-to.js","webpack://hubs/./src/utils/avatar-utils.js","webpack://hubs/./src/components/player-info.js","webpack://hubs/./src/components/name-tag.js","webpack://hubs/./src/components/hand-poses.js","webpack://hubs/./src/components/hud-controller.js","webpack://hubs/./src/components/freeze-controller.js","webpack://hubs/./src/components/visibility-while-frozen.js","webpack://hubs/./src/components/stats-plus.js","webpack://hubs/./src/utils/mirror-utils.js","webpack://hubs/./src/utils/error-texture.js","webpack://hubs/./src/utils/scale-to-aspect-ratio.js","webpack://hubs/./src/utils/detect-safari.js","webpack://hubs/./src/components/media-video.js","webpack://hubs/./src/components/media-pdf.js","webpack://hubs/./src/utils/create-basis-texture.js","webpack://hubs/./src/utils/gif-texture.js","webpack://hubs/./src/workers/gifparsing.worker.js","webpack://hubs/./src/components/media-image.js","webpack://hubs/./src/utils/texture-cache.js","webpack://hubs/./src/utils/avatar-volume-utils.js","webpack://hubs/./src/components/avatar-volume-controls.js","webpack://hubs/./src/components/pinch-to-move.js","webpack://hubs/./src/components/pitch-yaw-rotator.js","webpack://hubs/./src/components/position-at-border.js","webpack://hubs/./src/components/pinnable.js","webpack://hubs/./src/components/pin-networked-object-button.js","webpack://hubs/./src/components/mirror-media-button.js","webpack://hubs/./src/components/close-mirrored-media-button.js","webpack://hubs/./src/utils/bit-utils.js","webpack://hubs/./src/components/camera-focus-button.js","webpack://hubs/./src/components/unmute-video-button.js","webpack://hubs/./src/components/clone-media-button.js","webpack://hubs/./src/utils/fullscreen.js","webpack://hubs/./src/utils/vr-interstitial.js","webpack://hubs/./src/components/open-media-button.js","webpack://hubs/./src/components/refresh-media-button.js","webpack://hubs/./src/components/tweet-media-button.js","webpack://hubs/./src/components/remix-avatar-button.js","webpack://hubs/./src/components/transform-object-button.js","webpack://hubs/./src/components/scale-button.js","webpack://hubs/./src/utils/aframe-utils.js","webpack://hubs/./src/components/teleporter.js","webpack://hubs/./src/components/cylinder-texture.js","webpack://hubs/./src/components/inspect-pivot-offset-from-camera.js","webpack://hubs/./src/components/avatar-audio-source.js","webpack://hubs/./src/components/video-texture-target.js","webpack://hubs/./src/components/mirror.js","webpack://hubs/./src/utils/history.js","webpack://hubs/./src/utils/vr-caps-detect.js","webpack://hubs/./src/utils/share.js","webpack://hubs/./src/assets/stylesheets/ui-root.scss","webpack://hubs/./src/react-components/styles/style-utils.scss","webpack://hubs/./src/react-components/wrap-with-audio.js","webpack://hubs/./src/react-components/state-route.js","webpack://hubs/./src/utils/microphone-presence.js","webpack://hubs/./src/react-components/sidebar/Sidebar.scss","webpack://hubs/./src/react-components/sidebar/Sidebar.js","webpack://hubs/./src/react-components/input/IconButton.scss","webpack://hubs/./src/react-components/input/IconButton.js","webpack://hubs/./src/react-components/input/TextInput.scss","webpack://hubs/./src/react-components/icons/Close.svg","webpack://hubs/./src/react-components/input/CloseButton.scss","webpack://hubs/./src/react-components/input/CloseButton.js","webpack://hubs/./src/react-components/input/BackButton.scss","webpack://hubs/./src/react-components/icons/ChevronBack.svg","webpack://hubs/./src/react-components/input/BackButton.js","webpack://hubs/./src/react-components/input/Button.scss","webpack://hubs/./src/react-components/input/Button.js","webpack://hubs/./src/react-components/room/AvatarSettingsContent.scss","webpack://hubs/./src/react-components/input/InputField.js","webpack://hubs/./src/react-components/input/InputField.scss","webpack://hubs/./src/react-components/icons/Warning.svg","webpack://hubs/./src/utils/focus-utils.js","webpack://hubs/./src/react-components/input/TextInput.js","webpack://hubs/./src/react-components/input/useId.js","webpack://hubs/./src/react-components/input/TextInputField.js","webpack://hubs/./src/react-components/layout/Column.scss","webpack://hubs/./src/react-components/layout/Column.js","webpack://hubs/./src/react-components/room/AvatarSettingsContent.js","webpack://hubs/./src/react-components/room/AvatarSettingsSidebar.js","webpack://hubs/./src/react-components/modal/Modal.scss","webpack://hubs/./src/react-components/modal/Modal.js","webpack://hubs/./src/react-components/room/AvatarSetupModal.js","webpack://hubs/./src/components/environment-map.js","webpack://hubs/./src/utils/image-bitmap-utils.js","webpack://hubs/./src/assets/stylesheets/avatar-preview.scss","webpack://hubs/./src/react-components/avatar-preview.js","webpack://hubs/./src/react-components/profile-entry-panel.js","webpack://hubs/./src/storage/media-search-store.js","webpack://hubs/./src/react-components/room/AvatarUrlModal.js","webpack://hubs/./src/react-components/room/AvatarUrlModalContainer.js","webpack://hubs/./src/react-components/room/SceneUrlModal.js","webpack://hubs/./src/utils/scene-url-utils.js","webpack://hubs/./src/react-components/icons/Attach.svg","webpack://hubs/./src/react-components/room/SceneUrlModalContainer.js","webpack://hubs/./src/react-components/room/ObjectUrlModal.scss","webpack://hubs/./src/react-components/room/ObjectUrlModal.js","webpack://hubs/./src/react-components/room/ObjectUrlModalContainer.js","webpack://hubs/./src/react-components/room/MediaBrowser.scss","webpack://hubs/./src/react-components/icons/Search.svg","webpack://hubs/./src/react-components/icons/Star.svg","webpack://hubs/./src/react-components/icons/ArrowForward.svg","webpack://hubs/./src/react-components/icons/ArrowBack.svg","webpack://hubs/./src/react-components/layout/FullscreenLayout.scss","webpack://hubs/./src/react-components/layout/FullscreenLayout.js","webpack://hubs/./src/react-components/room/MediaGrid.scss","webpack://hubs/./src/react-components/room/MediaGrid.js","webpack://hubs/./src/react-components/room/MediaBrowser.js","webpack://hubs/./src/react-components/icons/Upload.svg","webpack://hubs/./src/react-components/icons/Link.svg","webpack://hubs/./src/react-components/icons/People.svg","webpack://hubs/./src/react-components/room/MediaTiles.scss","webpack://hubs/./src/react-components/icons/Add.svg","webpack://hubs/./src/react-components/icons/Pen.svg","webpack://hubs/./src/react-components/icons/Duplicate.svg","webpack://hubs/./src/react-components/icons/Help.svg","webpack://hubs/./src/react-components/icons/ExternalLink.svg","webpack://hubs/./src/react-components/room/MediaTiles.js","webpack://hubs/./src/react-components/auth/LegalMessage.js","webpack://hubs/./src/react-components/auth/SignInModal.js","webpack://hubs/./src/react-components/media-browser.js","webpack://hubs/./src/react-components/entry-start-panel.js","webpack://hubs/./src/react-components/if-feature.js","webpack://hubs/./src/react-components/avatar-editor.js","webpack://hubs/./src/assets/stylesheets/avatar-editor.scss","webpack://hubs/./src/assets/stylesheets/preferences-screen.scss","webpack://hubs/./src/utils/media-devices-manager.js","webpack://hubs/./src/react-components/input/Slider.js","webpack://hubs/./src/react-components/input/Slider.scss","webpack://hubs/./src/utils/screen-orientation-utils.js","webpack://hubs/./src/react-components/preferences-screen.js","webpack://hubs/./src/react-components/icons/Wand.svg","webpack://hubs/./src/assets/stylesheets/presence-log.scss","webpack://hubs/./src/react-components/icons/Chat.svg","webpack://hubs/./src/react-components/icons/Send.svg","webpack://hubs/./src/react-components/icons/Reaction.svg","webpack://hubs/./src/react-components/input/TextAreaInput.js","webpack://hubs/./src/react-components/input/TextAreaInput.scss","webpack://hubs/./src/react-components/input/ToolbarButton.scss","webpack://hubs/./src/react-components/input/ToolbarButton.js","webpack://hubs/./src/react-components/popover/Popover.scss","webpack://hubs/./src/react-components/popover/Popover.js","webpack://hubs/./src/react-components/room/EmojiPicker.js","webpack://hubs/./src/react-components/room/ChatSidebar.scss","webpack://hubs/./src/utils/chat-message.js","webpack://hubs/./src/react-components/room/ChatSidebar.js","webpack://hubs/./src/react-components/chat-message.js","webpack://hubs/./src/react-components/photo-message.js","webpack://hubs/./src/react-components/video-message.js","webpack://hubs/./src/react-components/image-message.js","webpack://hubs/./src/react-components/presence-log.js","webpack://hubs/./src/assets/stylesheets/preload-overlay.scss","webpack://hubs/./src/react-components/preload-overlay.js","webpack://hubs/./src/react-components/debug-panel/DataGraph.js","webpack://hubs/./src/react-components/debug-panel/Prop.scss","webpack://hubs/./src/react-components/debug-panel/Prop.js","webpack://hubs/./src/react-components/debug-panel/DataPanel.scss","webpack://hubs/./src/react-components/debug-panel/DataPanel.js","webpack://hubs/./src/react-components/debug-panel/CollapsiblePanel.scss","webpack://hubs/./src/react-components/debug-panel/CollapsiblePanel.js","webpack://hubs/./src/react-components/debug-panel/RtcDebugPanel.scss","webpack://hubs/./src/react-components/icons/CaretDown.svg","webpack://hubs/./src/react-components/debug-panel/AudioDebugPanel.scss","webpack://hubs/./src/react-components/input/SelectInputField.scss","webpack://hubs/./src/react-components/input/SelectInputField.js","webpack://hubs/./src/react-components/debug-panel/AudioDebugPanel.js","webpack://hubs/./src/react-components/debug-panel/RtcDebugPanel.js","webpack://hubs/./src/utils/mask-email.js","webpack://hubs/./src/react-components/layout/LoadingScreenLayout.scss","webpack://hubs/./src/react-components/icons/HmcLogo.svg","webpack://hubs/./src/react-components/misc/AppLogo.js","webpack://hubs/./src/utils/isHmc.js","webpack://hubs/./src/react-components/layout/LoadingScreenLayout.js","webpack://hubs/./src/react-components/misc/Spinner.svg","webpack://hubs/./src/react-components/misc/Spinner.scss","webpack://hubs/./src/react-components/misc/Spinner.js","webpack://hubs/./src/react-components/room/LoadingScreen.js","webpack://hubs/./src/react-components/room/useRandomMessageTransition.js","webpack://hubs/./src/react-components/room/useRoomLoadingState.js","webpack://hubs/./src/react-components/room/LoadingScreenContainer.js","webpack://hubs/./src/react-components/layout/RoomLayout.scss","webpack://hubs/./src/react-components/layout/Toolbar.scss","webpack://hubs/./src/react-components/layout/Toolbar.js","webpack://hubs/./src/react-components/layout/RoomLayout.js","webpack://hubs/./src/react-components/room/RoomLayoutContainer.js","webpack://hubs/./src/react-components/room/useResizeViewport.js","webpack://hubs/./src/react-components/icons/Enter.svg","webpack://hubs/./src/react-components/icons/VR.svg","webpack://hubs/./src/react-components/icons/Show.svg","webpack://hubs/./src/react-components/icons/Settings.svg","webpack://hubs/./src/react-components/room/RoomEntryModal.scss","webpack://hubs/./src/react-components/room/RoomEntryModal.js","webpack://hubs/./src/react-components/room/EnterOnDeviceModal.js","webpack://hubs/./src/react-components/room/EnterOnDeviceModal.scss","webpack://hubs/./src/react-components/icons/Microphone.svg","webpack://hubs/./src/react-components/icons/MicrophoneMuted.svg","webpack://hubs/./src/react-components/icons/VolumeOff.svg","webpack://hubs/./src/react-components/icons/Info.svg","webpack://hubs/./src/react-components/room/MicSetupModal.scss","webpack://hubs/./src/react-components/input/ToggleInput.js","webpack://hubs/./src/react-components/input/ToggleInput.scss","webpack://hubs/./src/react-components/room/MicSetupModal.js","webpack://hubs/./src/react-components/room/useMicrophoneStatus.js","webpack://hubs/./src/react-components/room/useMicrophone.js","webpack://hubs/./src/react-components/room/useSound.js","webpack://hubs/./src/react-components/room/useSpeakers.js","webpack://hubs/./src/react-components/misc/LevelBar.scss","webpack://hubs/./src/react-components/misc/LevelBar.js","webpack://hubs/./src/react-components/misc/useVolumeMeter.js","webpack://hubs/./src/react-components/misc/VolumeLevelBar.js","webpack://hubs/./src/react-components/room/MicSetupModalContainer.js","webpack://hubs/./src/react-components/room/InvitePopover.scss","webpack://hubs/./src/react-components/input/CopyableTextInputField.scss","webpack://hubs/./src/react-components/input/CopyableTextInputField.js","webpack://hubs/./src/react-components/icons/Invite.svg","webpack://hubs/./src/react-components/room/RoomSettingsSidebar.scss","webpack://hubs/./src/react-components/room/InviteLinkInputField.js","webpack://hubs/./src/react-components/room/InvitePopover.js","webpack://hubs/./src/react-components/room/useInviteUrl.js","webpack://hubs/./src/react-components/room/InvitePopoverContainer.js","webpack://hubs/./src/react-components/room/MoreMenuPopover.scss","webpack://hubs/./src/react-components/icons/More.svg","webpack://hubs/./src/react-components/room/MoreMenuPopover.js","webpack://hubs/./src/react-components/room/ChatSidebarContainer.js","webpack://hubs/./src/react-components/misc/useMaintainScrollPosition.js","webpack://hubs/./src/react-components/misc/joinChildren.js","webpack://hubs/./src/react-components/room/ContentMenu.scss","webpack://hubs/./src/react-components/icons/Objects.svg","webpack://hubs/./src/react-components/room/ContentMenu.js","webpack://hubs/./src/react-components/icons/Camera.svg","webpack://hubs/./src/react-components/icons/Avatar.svg","webpack://hubs/./src/react-components/icons/Delete.svg","webpack://hubs/./src/react-components/icons/WarningCircle.svg","webpack://hubs/./src/react-components/icons/Home.svg","webpack://hubs/./src/react-components/icons/TextDocument.svg","webpack://hubs/./src/react-components/icons/Support.svg","webpack://hubs/./src/react-components/icons/Shield.svg","webpack://hubs/./src/react-components/icons/Discord.svg","webpack://hubs/./src/react-components/icons/Leave.svg","webpack://hubs/./src/react-components/room/PeopleSidebar.scss","webpack://hubs/./src/react-components/icons/Desktop.svg","webpack://hubs/./src/react-components/icons/Phone.svg","webpack://hubs/./src/react-components/icons/VolumeHigh.svg","webpack://hubs/./src/react-components/icons/VolumeMuted.svg","webpack://hubs/./src/react-components/icons/HandRaised.svg","webpack://hubs/./src/react-components/layout/List.scss","webpack://hubs/./src/react-components/layout/List.js","webpack://hubs/./src/react-components/room/PeopleSidebar.js","webpack://hubs/./src/react-components/room/PromoteClientModal.js","webpack://hubs/./src/react-components/room/UserProfileSidebar.scss","webpack://hubs/./src/react-components/room/UserProfileSidebar.js","webpack://hubs/./src/react-components/room/useAvatarVolume.js","webpack://hubs/./src/react-components/room/UserProfileSidebarContainer.js","webpack://hubs/./src/react-components/room/PeopleSidebarContainer.js","webpack://hubs/./src/utils/media-sorting.js","webpack://hubs/./src/react-components/room/useObjectList.js","webpack://hubs/./src/react-components/room/ObjectsSidebar.scss","webpack://hubs/./src/react-components/icons/Object.svg","webpack://hubs/./src/react-components/icons/Image.svg","webpack://hubs/./src/react-components/icons/Video.svg","webpack://hubs/./src/react-components/icons/Audio.svg","webpack://hubs/./src/react-components/room/ObjectsSidebar.js","webpack://hubs/./src/react-components/room/ObjectsSidebarContainer.js","webpack://hubs/./src/react-components/room/ObjectMenu.scss","webpack://hubs/./src/react-components/icons/Lightbulb.svg","webpack://hubs/./src/react-components/icons/LightbulbOutline.svg","webpack://hubs/./src/react-components/room/ObjectMenu.js","webpack://hubs/./src/utils/removeNetworkedObject.js","webpack://hubs/./src/react-components/icons/Pin.svg","webpack://hubs/./src/react-components/room/object-hooks.js","webpack://hubs/./src/react-components/icons/GoTo.svg","webpack://hubs/./src/react-components/icons/Hide.svg","webpack://hubs/./src/react-components/room/ObjectMenuContainer.js","webpack://hubs/./src/react-components/icons/GIF.svg","webpack://hubs/./src/react-components/icons/Scene.svg","webpack://hubs/./src/react-components/popover/ButtonGridPopover.scss","webpack://hubs/./src/react-components/popover/ButtonGridPopover.js","webpack://hubs/./src/react-components/room/PlacePopover.js","webpack://hubs/./src/react-components/room/PlacePopoverContainer.js","webpack://hubs/./src/react-components/icons/Share.svg","webpack://hubs/./src/react-components/room/SharePopover.js","webpack://hubs/./src/react-components/room/SharePopoverContainer.js","webpack://hubs/./src/react-components/room/useAvatar.js","webpack://hubs/./src/react-components/room/AudioPopover.scss","webpack://hubs/./src/react-components/layout/Row.scss","webpack://hubs/./src/react-components/layout/Row.js","webpack://hubs/./src/react-components/layout/Divider.js","webpack://hubs/./src/react-components/layout/Divider.scss","webpack://hubs/./src/react-components/room/AudioPopoverContent.js","webpack://hubs/./src/react-components/room/AudioPopoverContentContainer.js","webpack://hubs/./src/react-components/icons/Arrow.svg","webpack://hubs/./src/react-components/room/AudioPopoverButton.js","webpack://hubs/./src/react-components/input/ToolbarMicButton.js","webpack://hubs/./src/react-components/room/AudioPopoverButtonContainer.js","webpack://hubs/./src/react-components/room/AudioPopoverContainer.js","webpack://hubs/./src/react-components/popover/ImageGridPopover.scss","webpack://hubs/./src/react-components/popover/ImageGridPopover.js","webpack://hubs/./src/react-components/room/ReactionButton.scss","webpack://hubs/./src/react-components/room/ReactionButton.js","webpack://hubs/./src/react-components/room/ReactionPopover.scss","webpack://hubs/./src/react-components/room/ReactionPopover.js","webpack://hubs/./src/react-components/room/ReactionPopoverContainer.js","webpack://hubs/./src/react-components/room/SafariMicModal.js","webpack://hubs/./src/react-components/auth/RoomSignInModalContainer.js","webpack://hubs/./src/react-components/room/LeaveRoomModal.js","webpack://hubs/./src/react-components/room/RoomSidebar.scss","webpack://hubs/./src/react-components/room/RoomSidebar.js","webpack://hubs/./src/react-components/input/TextAreaInputField.js","webpack://hubs/./src/react-components/input/RadioInput.js","webpack://hubs/./src/react-components/input/RadioInput.scss","webpack://hubs/./src/react-components/input/RadioInputField.js","webpack://hubs/./src/react-components/input/NumericInput.js","webpack://hubs/./src/react-components/input/NumericInput.scss","webpack://hubs/./src/react-components/input/NumericInputField.js","webpack://hubs/./src/react-components/room/RoomSettingsSidebar.js","webpack://hubs/./src/react-components/room/RoomSettingsSidebarContainer.js","webpack://hubs/./src/react-components/room/AutoExitWarningModal.js","webpack://hubs/./src/react-components/room/ExitedRoomScreen.js","webpack://hubs/./src/react-components/room/CloseRoomModal.js","webpack://hubs/./src/react-components/room/WebVRUnsupportedModal.js","webpack://hubs/./src/react-components/room/TweetEditorModal.scss","webpack://hubs/./src/react-components/room/TweetEditorModal.js","webpack://hubs/./src/react-components/room/TweetEditorModalContainer.js","webpack://hubs/./src/react-components/room/TwitterOAuthModal.js","webpack://hubs/./src/react-components/room/TwitterOAuthModalContainer.js","webpack://hubs/./src/react-components/room/TweetModalContainer.js","webpack://hubs/./src/react-components/room/Tip.scss","webpack://hubs/./src/react-components/room/Tip.js","webpack://hubs/./src/react-components/room/TipContainer.js","webpack://hubs/./src/react-components/room/SpectatingLabel.js","webpack://hubs/./src/react-components/room/SpectatingLabel.scss","webpack://hubs/./src/react-components/ui-root.js","webpack://hubs/./src/react-components/input/useAccessibleOutlineStyle.js","webpack://hubs/./src/react-components/room/ExitedRoomScreenContainer.js","webpack://hubs/./src/utils/auth-channel.js","webpack://hubs/./src/utils/hub-channel.js","webpack://hubs/./src/utils/crypto.js","webpack://hubs/./src/utils/link-channel.js","webpack://hubs/./src/utils/disable-ios-zoom.js","webpack://hubs/./src/utils/physics-utils.js","webpack://hubs/./src/systems/single-action-button-system.js","webpack://hubs/./src/systems/bit-physics.js","webpack://hubs/./src/inflators/media-frame.js","webpack://hubs/./src/inflators/text.js","webpack://hubs/./src/utils/jsx-entity.js","webpack://hubs/./src/inflators/slice9.js","webpack://hubs/./src/update-slice9-geometry.js","webpack://hubs/./src/inflators/model.js","webpack://hubs/./src/network-prefabs/camera-tool.js","webpack://hubs/./src/systems/netcode.js","webpack://hubs/./src/message-dispatch.js","webpack://hubs/./src/scene-entry-manager.js","webpack://hubs/./src/subscriptions.js","webpack://hubs/./src/systems/nav.js","webpack://hubs/./src/utils/traverseFilteredSubtrees.js","webpack://hubs/./src/systems/personal-space-bubble.js","webpack://hubs/./src/systems/idle-detector.js","webpack://hubs/./src/systems/pen-tools.js","webpack://hubs/./src/systems/userinput/sets.js","webpack://hubs/./src/systems/userinput/devices/mouse.js","webpack://hubs/./src/systems/userinput/array-backed-set.js","webpack://hubs/./src/systems/userinput/devices/keyboard.js","webpack://hubs/./src/systems/userinput/devices/hud.js","webpack://hubs/./src/systems/userinput/devices/xbox-controller.js","webpack://hubs/./src/systems/userinput/pose.js","webpack://hubs/./src/systems/userinput/arm-model.js","webpack://hubs/./src/systems/userinput/devices/copy-sitting-to-standing-transform.js","webpack://hubs/./src/systems/userinput/devices/oculus-go-controller.js","webpack://hubs/./src/systems/userinput/devices/gear-vr-controller.js","webpack://hubs/./src/systems/userinput/devices/oculus-touch-controller.js","webpack://hubs/./src/systems/userinput/devices/daydream-controller.js","webpack://hubs/./src/systems/userinput/devices/vive-controller.js","webpack://hubs/./src/systems/userinput/devices/windows-mixed-reality-controller.js","webpack://hubs/./src/systems/userinput/devices/webxr-controller.js","webpack://hubs/./src/systems/userinput/devices/gyro.js","webpack://hubs/./src/systems/userinput/devices/app-aware-mouse.js","webpack://hubs/./src/systems/userinput/devices/touchscreen/assignments.js","webpack://hubs/./src/components/cursor-controller.js","webpack://hubs/./src/systems/userinput/devices/app-aware-touchscreen.js","webpack://hubs/./src/systems/userinput/bindings/xforms.js","webpack://hubs/./src/utils/dpad.js","webpack://hubs/./src/systems/userinput/bindings/utils.js","webpack://hubs/./src/systems/userinput/bindings/keyboard-mouse-user.js","webpack://hubs/./src/systems/userinput/bindings/touchscreen-user.js","webpack://hubs/./src/systems/userinput/bindings/keyboard-debugging.js","webpack://hubs/./src/systems/userinput/bindings/oculus-touch-user.js","webpack://hubs/./src/systems/userinput/bindings/webxr-user.js","webpack://hubs/./src/systems/userinput/bindings/vive-user.js","webpack://hubs/./src/systems/userinput/bindings/windows-mixed-reality-user.js","webpack://hubs/./src/systems/userinput/bindings/xbox-controller-user.js","webpack://hubs/./src/systems/userinput/bindings/daydream-user.js","webpack://hubs/./src/systems/userinput/bindings/cardboard-user.js","webpack://hubs/./src/systems/userinput/bindings/oculus-go-user.js","webpack://hubs/./src/systems/userinput/resolve-action-sets.js","webpack://hubs/./src/systems/userinput/devices/gamepad.js","webpack://hubs/./src/systems/userinput/bindings/generic-gamepad.js","webpack://hubs/./src/systems/userinput/userinput.js","webpack://hubs/./src/systems/userinput/userinput-debug.js","webpack://hubs/./src/systems/ui-hotkeys.js","webpack://hubs/./src/systems/tips.js","webpack://hubs/./src/systems/interactions.js","webpack://hubs/./src/systems/cursor-targetting-system.js","webpack://hubs/./src/systems/cursor-toggling-system.js","webpack://hubs/./src/systems/physics-system.js","webpack://hubs/./src/systems/two-point-stretching-system.js","webpack://hubs/./src/systems/button-systems.js","webpack://hubs/./src/systems/drawing-menu-system.js","webpack://hubs/./src/systems/hover-menu-system.js","webpack://hubs/./src/systems/super-spawner-system.js","webpack://hubs/./src/systems/haptic-feedback-system.js","webpack://hubs/./src/systems/scene-preview-camera-system.js","webpack://hubs/./src/systems/interaction-sfx-system.js","webpack://hubs/./src/utils/theme-sprites.js","webpack://hubs/./src/workers/color-shift.worker.js","webpack://hubs/./src/systems/sprites.js","webpack://hubs/./src/systems/sprites/sprite.vert","webpack://hubs/./src/systems/sprites/sprite.frag","webpack://hubs/./src/systems/waypoint-system.js","webpack://hubs/./src/utils/mat4-pool.js","webpack://hubs/./src/utils/get-current-player-height.js","webpack://hubs/./src/systems/character-controller-system.js","webpack://hubs/./src/systems/cursor-pose-tracking.js","webpack://hubs/./src/systems/menu-animation-system.js","webpack://hubs/./src/systems/audio-settings-system.js","webpack://hubs/./src/systems/audio-system.js","webpack://hubs/./src/systems/shadow-system.js","webpack://hubs/./src/systems/inspect-yourself-system.js","webpack://hubs/./src/systems/emoji-system.js","webpack://hubs/./src/systems/audio-zones-system.js","webpack://hubs/./src/systems/audio-gain-system.js","webpack://hubs/./src/systems/environment-system.js","webpack://hubs/./src/systems/name-tag-visibility-system.js","webpack://hubs/./src/systems/on-ownership-lost.js","webpack://hubs/./src/systems/bit-hand-hover-system.js","webpack://hubs/./src/systems/hold-system.js","webpack://hubs/./src/systems/not-hovered-if-held.js","webpack://hubs/./src/systems/remove-networked-object-button-system.js","webpack://hubs/./src/systems/remove-object3D-system.js","webpack://hubs/./src/systems/networked-transform.js","webpack://hubs/./src/systems/bit-constraints-system.js","webpack://hubs/./src/systems/bit-media-frames.js","webpack://hubs/./src/utils/render-target-recorder.js","webpack://hubs/./src/bit-systems/camera-tool.js","webpack://hubs/./src/systems/bit-destroy-at-extreme-distances.js","webpack://hubs/./src/systems/hubs-systems.js","webpack://hubs/./src/systems/bit-interaction-system.js","webpack://hubs/./src/systems/capture-system.js","webpack://hubs/./src/systems/linked-media.js","webpack://hubs/./src/systems/audio-debug.vert","webpack://hubs/./src/systems/audio-debug-system.js","webpack://hubs/./src/systems/audio-debug.frag","webpack://hubs/./src/utils/component-mappings.js","webpack://hubs/./src/gltf-component-mappings.js","webpack://hubs/./src/aframe-to-bit-components.js","webpack://hubs/./src/App.js","webpack://hubs/./src/utils/pinning-helper.js","webpack://hubs/./src/utils/pinned-entity-to-gltf.js","webpack://hubs/./src/components/scalable-when-grabbed.js","webpack://hubs/./src/components/tools/pen.js","webpack://hubs/./src/components/tools/pen-laser.js","webpack://hubs/./src/utils/sharedbuffergeometry.js","webpack://hubs/./src/utils/sharedbuffergeometrymanager.js","webpack://hubs/./src/components/tools/networked-drawing.js","webpack://hubs/./src/components/body-helper.js","webpack://hubs/./src/components/shape-helper.js","webpack://hubs/./src/telemetry.js","webpack://hubs/./src/react-components/wrapped-intl-provider.js","webpack://hubs/./src/react-components/auth/OAuthScreen.scss","webpack://hubs/./src/react-components/auth/OAuthScreen.js","webpack://hubs/./src/react-components/auth/OAuthScreenContainer.js","webpack://hubs/./src/hub.js","webpack://hubs/./src/utils/concurrent-load-detector.js","webpack://hubs/./src/emitter.js","webpack://hubs/./src/network-schemas.js","webpack://hubs/./src/systems/app-mode.js","webpack://hubs/./src/systems/auto-pixel-ratio.js","webpack://hubs/./src/systems/exit-on-blur.js","webpack://hubs/./src/systems/frame-scheduler.js","webpack://hubs/./src/systems/listed-media.js","webpack://hubs/./src/systems/permissions.js","webpack://hubs/./src/utils/debug-log.js","webpack://hubs/./src/utils/qs_truthy.js","webpack://hubs/./src/vendor/Water.js","webpack://hubs/./src/support.js","webpack://hubs/./src/assets/stylesheets/support.scss","webpack://hubs/./src/assets/locales/ lazy ^\\.\\/.*\\.json$ namespace object","webpack://hubs/webpack/bootstrap","webpack://hubs/webpack/runtime/chunk loaded","webpack://hubs/webpack/runtime/create fake namespace object","webpack://hubs/webpack/runtime/load script","webpack://hubs/webpack/runtime/amd options","webpack://hubs/webpack/runtime/compat get default export","webpack://hubs/webpack/runtime/define property getters","webpack://hubs/webpack/runtime/ensure chunk","webpack://hubs/webpack/runtime/get javascript chunk filename","webpack://hubs/webpack/runtime/get mini-css chunk filename","webpack://hubs/webpack/runtime/global","webpack://hubs/webpack/runtime/hasOwnProperty shorthand","webpack://hubs/webpack/runtime/make namespace object","webpack://hubs/webpack/runtime/node module decorator","webpack://hubs/webpack/runtime/runtimeId","webpack://hubs/webpack/runtime/publicPath","webpack://hubs/webpack/runtime/jsonp chunk loading","webpack://hubs/webpack/startup"],"sourcesContent":["AFRAME.registerComponent(\"action-to-event\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    event: { type: \"string\" },\n    withPermission: { type: \"string\" }\n  },\n\n  init() {\n    this.needsPermission = !!this.data.withPermission;\n    this.updatePermissions = () => {\n      if (!this.needsPermission || !window.APP.hubChannel) return;\n      this.hasPermission = window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    };\n  },\n\n  play() {\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updatePermissions);\n    this.updatePermissions();\n  },\n\n  pause() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updatePermissions);\n  },\n\n  tick() {\n    if (this.needsPermission && !this.hasPermission) return;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (userinput.get(this.data.path)) {\n      this.el.emit(this.data.event);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-remove\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    requireOwnership: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (!userinput.get(this.data.path)) return;\n    if (this.data.requireOwnership && this.networkedEl && !NAF.utils.isMine(this.networkedEl)) return;\n\n    this.el.parentNode.removeChild(this.el);\n  }\n});\n","AFRAME.registerComponent(\"ambient-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    this.light = new THREE.AmbientLight();\n    this.el.setObject3D(\"ambient-light\", this.light);\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n      this.light.color.convertSRGBToLinear();\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"ambient-light\");\n  }\n});\n","/* eslint-disable */\n\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\n// scenario where the transform changes on an object during an animation.\n//\n// Changes are identified w comment // hubs\n//\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\n// it erroneously restarts.\n\nvar anime = require(\"animejs\").default;\nvar components = AFRAME.components; // hubs\nvar registerComponent = AFRAME.registerComponent; // hubs\n//var THREE = require('../lib/three'); // hubs\nvar utils = AFRAME.utils; // hubs\n\ndelete AFRAME.components.animation; // hubs\n\nvar colorHelperFrom = new THREE.Color();\nvar colorHelperTo = new THREE.Color();\n\n/**\n * Split a delimited component property string (e.g., `material.color`) to an object\n * containing `component` name and `property` name. If there is no delimiter, just return the\n * string back.\n *\n * Cache arrays from splitting strings via delimiter to save on memory.\n *\n * @param {string} str - e.g., `material.opacity`.\n * @param {string} delimiter - e.g., `.`.\n * @returns {array} e.g., `['material', 'opacity']`.\n */\nvar propertyPathCache = {};\nfunction getComponentPropertyPath(str, delimiter) {\n  delimiter = delimiter || \".\";\n  if (!propertyPathCache[delimiter]) {\n    propertyPathCache[delimiter] = {};\n  }\n  if (str.indexOf(delimiter) !== -1) {\n    propertyPathCache[delimiter][str] = str.split(delimiter);\n  } else {\n    propertyPathCache[delimiter][str] = str;\n  }\n  return propertyPathCache[delimiter][str];\n}\n\n/**\n * Get component property using encoded component name + component property name with a\n * delimiter.\n */\nconst getComponentProperty = function(el, name, delimiter) {\n  var splitName;\n  delimiter = delimiter || \".\";\n  if (name.indexOf(delimiter) !== -1) {\n    splitName = getComponentPropertyPath(name, delimiter);\n    if (splitName.constructor === String) {\n      return el.getAttribute(splitName);\n    }\n    return el.getAttribute(splitName[0])[splitName[1]];\n  }\n  return el.getAttribute(name);\n};\n\n/**\n * Set component property using encoded component name + component property name with a\n * delimiter.\n */\nconst setComponentProperty = function(el, name, value, delimiter) {\n  var splitName;\n  delimiter = delimiter || \".\";\n  if (name.indexOf(delimiter) !== -1) {\n    splitName = getComponentPropertyPath(name, delimiter);\n    if (splitName.constructor === String) {\n      el.setAttribute(splitName, value);\n    } else {\n      el.setAttribute(splitName[0], splitName[1], value);\n    }\n    return;\n  }\n  el.setAttribute(name, value);\n};\n\nvar splitCache = {};\n\nvar TYPE_COLOR = \"color\";\nvar PROP_POSITION = \"position\";\nvar PROP_ROTATION = \"rotation\";\nvar PROP_SCALE = \"scale\";\nvar STRING_COMPONENTS = \"components\";\nvar STRING_OBJECT3D = \"object3D\";\n\n/**\n * Animation component for A-Frame using anime.js.\n *\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\n * boolean * flag * `isAnimationPlaying`.\n *\n * anime.js animation config for tweenining Javascript objects and values works as:\n *\n *  config = {\n *    targets: {foo: 0.0, bar: '#000'},\n *    foo: 1.0,\n *    bar: '#FFF'\n *  }\n *\n * The above will tween each property in `targets`. The `to` values are set in the root of\n * the config.\n *\n * @member {object} animation - anime.js instance.\n * @member {boolean} animationIsPlaying - Control if animation is playing.\n */\nmodule.exports.Component = registerComponent(\"animation\", {\n  schema: {\n    autoplay: { default: true },\n    delay: { default: 0 },\n    dir: { default: \"\" },\n    dur: { default: 1000 },\n    easing: { default: \"easeInQuad\" },\n    elasticity: { default: 400 },\n    enabled: { default: true },\n    from: { default: \"\" },\n    loop: {\n      default: 0,\n      parse: function(value) {\n        // Boolean or integer.\n        if (value === true || value === \"true\") {\n          return true;\n        }\n        if (value === false || value === \"false\") {\n          return false;\n        }\n        return parseInt(value, 10);\n      }\n    },\n    property: { default: \"\" },\n    startEvents: { type: \"array\" },\n    pauseEvents: { type: \"array\" },\n    resumeEvents: { type: \"array\" },\n    round: { default: false },\n    to: { default: \"\" },\n    type: { default: \"\" },\n    isRawProperty: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    var self = this;\n\n    this.eventDetail = { name: this.attrName };\n    this.time = 0;\n\n    this.animation = null;\n    this.animationIsPlaying = false;\n    this.onStartEvent = this.onStartEvent.bind(this);\n    this.beginAnimation = this.beginAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.resumeAnimation = this.resumeAnimation.bind(this);\n\n    this.fromColor = {};\n    this.toColor = {};\n    this.targets = {};\n    this.targetsArray = [];\n\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\n\n    this.config = {\n      complete: function() {\n        self.animationIsPlaying = false;\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\n        if (self.id) {\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\n        }\n      }\n    };\n  },\n\n  update: function(oldData) {\n    var config = this.config;\n    var data = this.data;\n\n    this.animationIsPlaying = false;\n\n    if (!this.data.enabled) {\n      return;\n    }\n\n    if (!data.property) {\n      return;\n    }\n\n    // Base config.\n    config.autoplay = false;\n    config.direction = data.dir;\n    config.duration = data.dur;\n    config.easing = data.easing;\n    config.elasticity = data.elasticity;\n    config.loop = data.loop;\n    config.round = data.round;\n\n    // Start new animation.\n    this.createAndStartAnimation();\n  },\n\n  tick: function(t, dt) {\n    if (!this.animationIsPlaying) {\n      return;\n    }\n    this.time += dt;\n    this.animation.tick(this.time);\n  },\n\n  remove: function() {\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  pause: function() {\n    this.paused = true;\n    this.pausedWasPlaying = this.animationIsPlaying;\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  /**\n   * `play` handler only for resuming scene.\n   */\n  play: function() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    this.addEventListeners();\n    if (this.pausedWasPlaying) {\n      this.resumeAnimation();\n      this.pausedWasPlaying = false;\n    }\n  },\n\n  /**\n   * Start animation from scratch.\n   */\n  createAndStartAnimation: function() {\n    var data = this.data;\n\n    this.updateConfig();\n    this.animationIsPlaying = false;\n    this.animation = anime(this.config);\n\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n    this.addEventListeners();\n\n    // Wait for start events for animation.\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\n      return;\n    }\n\n    // Delay animation.\n    if (data.delay) {\n      // hubs\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\n      return;\n    }\n\n    // Play animation.\n    this.beginAnimation();\n  },\n\n  /**\n   * This is before animation start (including from startEvents).\n   * Set to initial state (config.from, time = 0, seekTime = 0).\n   */\n  beginAnimation: function() {\n    this.updateConfig();\n    this.time = 0;\n    this.animationIsPlaying = true;\n    this.stopRelatedAnimations();\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\n  },\n\n  pauseAnimation: function() {\n    this.animationIsPlaying = false;\n  },\n\n  resumeAnimation: function() {\n    this.animationIsPlaying = true;\n  },\n\n  /**\n   * startEvents callback.\n   */\n  onStartEvent: function() {\n    if (!this.data.enabled) {\n      return;\n    }\n\n    this.updateConfig();\n    if (this.animation) {\n      this.animation.pause();\n    }\n    this.animation = anime(this.config);\n\n    // Include the delay before each start event.\n    if (this.data.delay) {\n      setTimeout(this.beginAnimation, this.data.delay);\n      return;\n    }\n    this.beginAnimation();\n  },\n\n  /**\n   * rawProperty: true and type: color;\n   */\n  updateConfigForRawColor: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var key;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\n      return;\n    }\n\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\n    to = data.to;\n\n    // Use r/g/b vector for color type.\n    this.setColorConfig(from, to);\n    from = this.fromColor;\n    to = this.toColor;\n\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target;\n        // For animation timeline.\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\n          return;\n        }\n\n        setRawProperty(el, data.property, value, data.type);\n      };\n    })();\n  },\n\n  /**\n   * Stuff property into generic `property` key.\n   */\n  updateConfigForDefault: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var isBoolean;\n    var isNumber;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\n      return;\n    }\n\n    if (data.from === \"\") {\n      // Infer from.\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\n    } else {\n      // Explicit from.\n      from = data.from;\n    }\n\n    to = data.to;\n\n    isNumber = !isNaN(from || to);\n    if (isNumber) {\n      from = parseFloat(from);\n      to = parseFloat(to);\n    } else {\n      from = from ? from.toString() : from;\n      to = to ? to.toString() : to;\n    }\n\n    // Convert booleans to integer to allow boolean flipping.\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\n    if (isBoolean) {\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\n    }\n\n    this.targets.aframeProperty = from;\n    config.targets = this.targets;\n    config.aframeProperty = to;\n    config.update = (function() {\n      var lastValue;\n\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target.aframeProperty;\n\n        // Need to do a last value check for animation timeline since all the tweening\n        // begins simultaenously even if the value has not changed. Also better for perf\n        // anyways.\n        if (value === lastValue) {\n          return;\n        }\n        lastValue = value;\n\n        if (isBoolean) {\n          value = value >= 1;\n        }\n\n        if (isRawProperty(data)) {\n          setRawProperty(el, data.property, value, data.type);\n        } else {\n          setComponentProperty(el, data.property, value);\n        }\n      };\n    })();\n  },\n\n  /**\n   * Extend x/y/z/w onto the config.\n   * Update vector by modifying object3D.\n   */\n  updateConfigForVector: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var key;\n    var from;\n    var to;\n\n    // Parse coordinates.\n    from =\n      data.from !== \"\"\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\n    to = utils.coordinates.parse(data.to);\n\n    if (data.property === PROP_ROTATION) {\n      toRadians(from);\n      toRadians(to);\n    }\n\n    // Set to and from.\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    // If animating object3D transformation, run more optimized updater.\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\n      config.update = (function() {\n        var lastValue = {};\n        return function(anim) {\n          var value = anim.animatables[0].target;\n\n          if (data.property === PROP_SCALE) {\n            value.x = Math.max(0.0001, value.x);\n            value.y = Math.max(0.0001, value.y);\n            value.z = Math.max(0.0001, value.z);\n          }\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          el.object3D[data.property].set(value.x, value.y, value.z);\n          el.object3D.matrixNeedsUpdate = true; // hubs\n        };\n      })();\n      return;\n    }\n\n    // Animating some vector.\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value = anim.animations[0].target;\n\n        // Animate rotation through radians.\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n        setComponentProperty(el, data.property, value);\n      };\n    })();\n  },\n\n  /**\n   * Update the config before each run.\n   */\n  updateConfig: function() {\n    var propType;\n\n    // Route config type.\n    propType = getPropertyType(this.el, this.data.property);\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\n      this.updateConfigForRawColor();\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\n      this.updateConfigForVector();\n    } else {\n      this.updateConfigForDefault();\n    }\n  },\n\n  /**\n   * Wait for component to initialize.\n   */\n  waitComponentInitRawProperty: function(cb) {\n    var componentName;\n    var data = this.data;\n    var el = this.el;\n    var self = this;\n\n    if (data.from !== \"\") {\n      return false;\n    }\n\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\n      return false;\n    }\n\n    componentName = splitDot(data.property)[1];\n    if (el.components[componentName]) {\n      return false;\n    }\n\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\n      if (evt.detail.name !== componentName) {\n        return;\n      }\n      cb();\n      // Since the config was created async, create the animation now since we missed it\n      // earlier.\n      self.animation = anime(self.config);\n      el.removeEventListener(\"componentinitialized\", wait);\n    });\n    return true;\n  },\n\n  /**\n   * Make sure two animations on the same property don't fight each other.\n   * e.g., animation__mouseenter=\"property: material.opacity\"\n   *       animation__mouseleave=\"property: material.opacity\"\n   */\n  stopRelatedAnimations: function() {\n    var component;\n    var componentName;\n    for (componentName in this.el.components) {\n      component = this.el.components[componentName];\n      if (componentName === this.attrName) {\n        continue;\n      }\n      if (component.name !== \"animation\") {\n        continue;\n      }\n      if (!component.animationIsPlaying) {\n        continue;\n      }\n      if (component.data.property !== this.data.property) {\n        continue;\n      }\n      component.animationIsPlaying = false;\n    }\n  },\n\n  addEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    addEventListeners(el, data.startEvents, this.onStartEvent);\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  removeEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  // hubs\n  cancelDelayedStart: function() {\n    if (this.delayTimeout) {\n      clearTimeout(this.delayTimeout);\n      this.delayTimeout = null;\n    }\n  },\n\n  setColorConfig: function(from, to) {\n    colorHelperFrom.set(from);\n    colorHelperTo.set(to);\n    from = this.fromColor;\n    to = this.toColor;\n    from.r = colorHelperFrom.r;\n    from.g = colorHelperFrom.g;\n    from.b = colorHelperFrom.b;\n    to.r = colorHelperTo.r;\n    to.g = colorHelperTo.g;\n    to.b = colorHelperTo.b;\n  }\n});\n\n/**\n * Given property name, check schema to see what type we are animating.\n * We just care whether the property is a vector.\n */\nfunction getPropertyType(el, property) {\n  var component;\n  var componentName;\n  var split;\n  var propertyName;\n\n  split = property.split(\".\");\n  componentName = split[0];\n  propertyName = split[1];\n  component = el.components[componentName] || components[componentName];\n\n  // Primitives.\n  if (!component) {\n    return null;\n  }\n\n  // Dynamic schema. We only care about vectors anyways.\n  if (propertyName && !component.schema[propertyName]) {\n    return null;\n  }\n\n  // Multi-prop.\n  if (propertyName) {\n    return component.schema[propertyName].type;\n  }\n\n  // Single-prop.\n  return component.schema.type;\n}\n\n/**\n * Convert object to radians.\n */\nfunction toRadians(obj) {\n  obj.x = THREE.MathUtils.degToRad(obj.x);\n  obj.y = THREE.MathUtils.degToRad(obj.y);\n  obj.z = THREE.MathUtils.degToRad(obj.z);\n}\n\nfunction addEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.addEventListener(eventNames[i], handler);\n  }\n}\n\nfunction removeEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.removeEventListener(eventNames[i], handler);\n  }\n}\n\nfunction getRawProperty(el, path) {\n  var i;\n  var split;\n  var value;\n  split = splitDot(path);\n  value = el;\n  for (i = 0; i < split.length; i++) {\n    value = value[split[i]];\n  }\n  return value;\n}\n\nfunction setRawProperty(el, path, value, type) {\n  var i;\n  var split;\n  var propertyName;\n  var targetValue;\n\n  if (path.startsWith(\"object3D.rotation\")) {\n    value = THREE.MathUtils.degToRad(value);\n  }\n\n  // Walk.\n  split = splitDot(path);\n  targetValue = el;\n  for (i = 0; i < split.length - 1; i++) {\n    targetValue = targetValue[split[i]];\n  }\n  propertyName = split[split.length - 1];\n\n  // Raw color.\n  if (type === TYPE_COLOR) {\n    if (\"r\" in targetValue[propertyName]) {\n      targetValue[propertyName].r = value.r;\n      targetValue[propertyName].g = value.g;\n      targetValue[propertyName].b = value.b;\n    } else {\n      targetValue[propertyName].x = value.r;\n      targetValue[propertyName].y = value.g;\n      targetValue[propertyName].z = value.b;\n    }\n    return;\n  }\n\n  targetValue[propertyName] = value;\n}\n\nfunction splitDot(path) {\n  if (path in splitCache) {\n    return splitCache[path];\n  }\n  splitCache[path] = path.split(\".\");\n  return splitCache[path];\n}\n\nfunction isRawProperty(data) {\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\n}\n","const DEBUG_BBAA_COLOR = 0x49ef4;\n\nconst debugMaterial = new THREE.MeshBasicMaterial({\n  color: DEBUG_BBAA_COLOR,\n  transparent: true,\n  opacity: 0.25,\n  side: THREE.DoubleSide\n});\n\nAFRAME.registerComponent(\"audio-zone\", {\n  schema: {\n    enabled: { default: true },\n    inOut: { default: true },\n    outIn: { default: true },\n    debuggable: { default: true }\n  },\n\n  init() {\n    const debugGeometry = new THREE.BoxGeometry();\n    this.debugMesh = new THREE.Mesh(debugGeometry, debugMaterial);\n    this.debugMesh.el = this.el.object3D.el;\n    const debugBBAA = new THREE.BoxHelper(this.debugMesh, DEBUG_BBAA_COLOR);\n    this.el.object3D.add(debugBBAA);\n    this.el.object3D.updateMatrixWorld(true);\n\n    // In some cases (ie. the scene page) these systems might not exist\n    // so we need to check if the do before registering.\n    this.el.sceneEl.systems[\"audio-debug\"]?.registerZone(this);\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.registerZone(this);\n\n    this.enableDebug(window.APP.store.state.preferences.showAudioDebugPanel);\n  },\n\n  remove() {\n    // In some cases (ie. the scene page) these systems might not exist\n    // so we need to check if the do before unregistering.\n    this.el.sceneEl.systems[\"audio-debug\"]?.unregisterZone(this);\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.unregisterZone(this);\n  },\n\n  update() {\n    this.enableDebug(this.data.debuggable && window.APP.store.state.preferences.showAudioDebugPanel);\n  },\n\n  isEnabled() {\n    return this.data.enabled;\n  },\n\n  getBoundingBox: (function() {\n    const bbaa = new THREE.Box3();\n    return function() {\n      return bbaa.copy(this.debugMesh.geometry.boundingBox).applyMatrix4(this.el.object3D.matrixWorld);\n    };\n  })(),\n\n  enableDebug(debuggable) {\n    this.data.debuggable = debuggable;\n    this.el.object3D.visible = debuggable;\n  },\n\n  getAudioParams() {\n    return APP.audioOverrides.get(this.el);\n  },\n\n  contains(position) {\n    return this.getBoundingBox().containsPoint(position);\n  }\n});\n","AFRAME.registerComponent(\"avatar-inspect-collider\", {\n  play() {\n    this.el.setObject3D(\n      \"avatar-inspect-collider\",\n      new THREE.Mesh(\n        new THREE.BoxGeometry(0.3, 0.8, 0.3),\n        new THREE.MeshBasicMaterial({\n          visible: false\n        })\n      )\n    );\n  }\n});\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n// Billboard component that only updates visible objects and only those in the camera view on mobile VR.\n// TODO billboarding assumes a single camera viewpoint but with video-texture-source, mirrors, and camera tools this is no longer valid\nAFRAME.registerComponent(\"billboard\", {\n  schema: {\n    onlyY: { type: \"boolean\" }\n  },\n  init: function() {\n    this._updateBillboard = this._updateBillboard.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateIsInView, \"billboards\");\n    }\n  },\n  remove() {\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateIsInView, \"billboards\");\n    }\n  },\n\n  tick() {\n    if (this.isInView || !isMobileVR) {\n      this._updateBillboard();\n    }\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const box = new THREE.Box3();\n    const boxTemp = new THREE.Box3();\n\n    const expandBox = o => {\n      if (o.geometry) {\n        o.updateMatrices();\n        o.geometry.computeBoundingBox();\n        boxTemp.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld);\n        box.expandByPoint(boxTemp.min);\n        box.expandByPoint(boxTemp.max);\n      }\n    };\n\n    const isInViewOfCamera = (obj, screenCamera) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromProjectionMatrix(frustumMatrix);\n      box.makeEmpty();\n      obj.traverse(expandBox);\n\n      // NOTE: not using box.setFromObject here because text nodes do not have Z values in their geometry buffer,\n      // and that routine ultimately assumes they do.\n      return frustum.intersectsBox(box);\n    };\n\n    return function() {\n      if (!this.el.object3D.visible) {\n        this.isInView = false;\n        return;\n      }\n\n      if (!this.playerCamera) {\n        this.playerCamera = document.getElementById(\"viewing-camera\").getObject3D(\"camera\");\n      }\n\n      if (!this.playerCamera) return;\n\n      this.isInView = this.el.sceneEl.is(\"vr-mode\") ? true : isInViewOfCamera(this.el.object3D, this.playerCamera);\n    };\n  })(),\n\n  _updateBillboard: (function() {\n    const targetPos = new THREE.Vector3();\n    const worldPos = new THREE.Vector3();\n    return function() {\n      if (!this.el.object3D.visible) return;\n\n      const camera = this.el.sceneEl.camera;\n      const object3D = this.el.object3D;\n\n      if (camera) {\n        // Set the camera world position as the target.\n        targetPos.setFromMatrixPosition(camera.matrixWorld);\n\n        if (this.data.onlyY) {\n          object3D.getWorldPosition(worldPos);\n          targetPos.y = worldPos.y;\n        }\n        object3D.lookAt(targetPos);\n\n        object3D.matrixNeedsUpdate = true;\n      }\n    };\n  })()\n});\n","/**\n * Registers a click handler and invokes the block method on the NAF adapter for the owner associated with its entity.\n * @namespace network\n * @component block-button\n */\nAFRAME.registerComponent(\"block-button\", {\n  init() {\n    this.onClick = () => {\n      this.block(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  block(clientId) {\n    window.APP.hubChannel.hide(clientId);\n  }\n});\n","/**\n * Toggles the position of 2 bones into \"on\" and \"off\" positions to indicate mute state.\n * @namespace avatar\n * @component bone-mute-state-indicator\n */\n// TODO: Remove this\nAFRAME.registerComponent(\"bone-mute-state-indicator\", {\n  schema: {\n    unmutedBoneName: { default: \"Watch_Joint_MicON\" },\n    mutedBoneName: { default: \"Watch_Joint_Muted\" },\n    onPos: { default: 0.81 },\n    offPos: { default: 0.5 }\n  },\n\n  init() {\n    this.onStateToggled = this.onStateToggled.bind(this);\n    this.el.addEventListener(\"model-loaded\", () => {\n      this.unmutedBone = this.el.object3D.getObjectByName(this.data.unmutedBoneName);\n      this.mutedBone = this.el.object3D.getObjectByName(this.data.mutedBoneName);\n      this.modelLoaded = true;\n\n      this.updateMuteState();\n    });\n\n    this.onMicStateChanged = () => {\n      this.updateMuteState();\n    };\n  },\n\n  play() {\n    APP.dialog.on(\"mic-state-changed\", this.onMicStateChanged);\n  },\n\n  pause() {\n    APP.dialog.off(\"mic-state-changed\", this.onMicStateChanged);\n  },\n\n  updateMuteState() {\n    if (!this.modelLoaded) return;\n    const muted = !APP.mediaDevicesManager.isMicEnabled;\n    this.mutedBone.position.y = muted ? this.data.onPos : this.data.offPos;\n    this.unmutedBone.position.y = !muted ? this.data.onPos : this.data.offPos;\n    this.mutedBone.matrixNeedsUpdate = true;\n    this.unmutedBone.matrixNeedsUpdate = true;\n  }\n});\n","AFRAME.registerComponent(\"close-vr-notice-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"action_vr_notice_closed\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","/**\n * Sets the CSS class on an entity.\n * @component css-class\n */\nAFRAME.registerComponent(\"css-class\", {\n  schema: {\n    type: \"string\"\n  },\n  multiple: true,\n  init() {\n    this.el.classList.add(this.data);\n  },\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.el.classList.remove(oldData);\n      this.el.classList.add(this.data);\n    }\n  },\n  remove() {\n    this.el.classList.remove(this.data);\n  }\n});\n","/**\n * Logs all events dispatched on an entity\n * @namespace debug\n * @component log-events\n */\nAFRAME.registerComponent(\"log-events\", {\n  init: function() {\n    const el = this.el;\n    const log = this.log.bind(this);\n    const origDispatch = this.el.dispatchEvent;\n    this.el.dispatchEvent = function() {\n      log(Array.from(arguments));\n      return origDispatch.apply(el, arguments);\n    };\n  },\n  log: function([e]) {\n    if ([\"componentchanged\"].includes(e.type)) return;\n    let firstObject = true;\n    const replacer = (k, x) => {\n      if (!x) return x;\n      if (typeof x === \"object\" && x.length === undefined) {\n        if (firstObject) {\n          firstObject = false;\n          return x;\n        }\n        return \"[object]\";\n      }\n      return x;\n    };\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\n  }\n});\n\n/**\n * Logs all life cycle phases on an entity.\n * @namespace debug\n * @component lifecycle-checker\n */\nAFRAME.registerComponent(\"lifecycle-checker\", {\n  schema: {\n    name: { type: \"string\" },\n    tick: { default: false }\n  },\n  init: function() {\n    this.log(\"init\");\n  },\n  update: function() {\n    this.log(\"update\");\n  },\n  tick: function() {\n    if (this.data.tick) {\n      this.log(\"tick\");\n    }\n  },\n  remove: function() {\n    this.log(\"remove\");\n  },\n  pause: function() {\n    this.log(\"pause\");\n  },\n  play: function() {\n    this.log(\"play\");\n  },\n\n  log: function(method) {\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\n  }\n});\n","AFRAME.registerComponent(\"directional-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    this.light = new THREE.DirectionalLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.el.setObject3D(\"directional-light\", this.light);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      color.convertSRGBToLinear();\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n\n    this.light.shadow.camera.matrixNeedsUpdate = true;\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"directional-light\");\n  }\n});\n","AFRAME.registerComponent(\"disable-frustum-culling\", {\n  init() {\n    this.el.object3D.traverse(o => (o.frustumCulled = false));\n  }\n});\n","const COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"drop-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"floaty-object\", { modifyGravityOnRelease: false });\n      this.targetEl.setAttribute(\"body-helper\", {\n        type: \"dynamic\",\n        gravity: { x: 0, y: -9.8, z: 0 },\n        angularDamping: 0.01,\n        linearDamping: 0.01,\n        linearSleepingThreshold: 1.6,\n        angularSleepingThreshold: 2.5,\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n      });\n\n      const physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n      if (this.targetEl.components[\"body-helper\"].uuid) {\n        physicsSystem.activateBody(this.targetEl.components[\"body-helper\"].uuid);\n      }\n\n      // Remove drop button after using it\n      this.el.parentNode.removeChild(this.el);\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","/**\n * Floats a duck based on its scale.\n * @component duck\n */\nAFRAME.registerComponent(\"duck\", {\n  schema: {\n    initialForce: { default: 0 },\n    maxForce: { default: 6.5 },\n    maxScale: { default: 5 }\n  },\n\n  init: function() {\n    this.initialScale = this.el.object3D.scale.x;\n    this.maxScale = this.data.maxScale * this.initialScale;\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n      this.networkedEntity = networkedEntity;\n\n      this.initialScale = this.networkedEntity.object3D.scale.x;\n      this.maxScale = this.data.maxScale * this.initialScale;\n    });\n  },\n\n  tick: function() {\n    if (!this.networkedEntity || NAF.utils.isMine(this.networkedEntity)) {\n      const entity = this.networkedEntity || this.el;\n      const currentScale = entity.object3D.scale.x;\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\n      const force = ratio * this.data.maxForce;\n      if (force > 0) {\n        const angle = Math.random() * Math.PI * 2;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        entity.setAttribute(\"body-helper\", { gravity: { x, y: force, z } });\n      }\n    }\n  }\n});\n","AFRAME.registerComponent(\"emit-scene-event-on-remove\", {\n  schema: {\n    event: { default: null }\n  },\n\n  remove() {\n    if (this.data.event) {\n      this.el.sceneEl.emit(this.data.event, { el: this.el });\n    }\n  }\n});\n","AFRAME.registerComponent(\"emit-state-change\", {\n  multiple: true,\n  schema: {\n    state: { type: \"string\" },\n    transform: { type: \"string\", oneof: [\"rising\", \"falling\"] },\n    event: { type: \"string\" }\n  },\n\n  init() {\n    this.stateadded = this.stateadded.bind(this);\n    this.stateremoved = this.stateremoved.bind(this);\n  },\n\n  stateadded(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n  stateremoved(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n\n  update() {\n    this.el.removeEventListener(\"stateadded\", this.stateadded);\n    this.el.removeEventListener(\"stateremoved\", this.stateremoved);\n\n    if (this.data.transform === \"rising\") {\n      this.el.addEventListener(\"stateadded\", this.stateadded);\n    }\n    if (this.data.transform === \"falling\") {\n      this.el.addEventListener(\"stateremoved\", this.stateremoved);\n    }\n  }\n});\n","/**\n * Listens to events from an event source and re-emits them on this entity\n * @component event-repeater\n */\nAFRAME.registerComponent(\"event-repeater\", {\n  schema: {\n    eventSource: { type: \"selector\" },\n    events: { type: \"array\" }\n  },\n\n  play: function() {\n    this.data.eventListeners = [];\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\n    }\n  },\n\n  pause: function() {\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\n    }\n    this.data.eventListeners = [];\n  },\n\n  _handleEvent: function(event, e) {\n    this.el.emit(event, e.detail);\n  }\n});\n","/**\n * Creates a box around the element (assumed to be the camera's PoV) which can be used for fade-to-black.\n */\n\nconst FADE_DURATION_MS = 750;\n\nAFRAME.registerComponent(\"fader\", {\n  schema: {\n    direction: { type: \"string\", default: \"none\" } // \"in\", \"out\", or \"none\"\n  },\n\n  init() {\n    const mesh = new THREE.Mesh(\n      new THREE.BoxGeometry(),\n      new THREE.MeshBasicMaterial({ color: 0x0, side: THREE.BackSide, opacity: 0, transparent: true, fog: false })\n    );\n    mesh.scale.x = mesh.scale.y = 1;\n    mesh.scale.z = 0.15;\n    mesh.matrixNeedsUpdate = true;\n    this.el.object3DMap.camera.add(mesh);\n    this.mesh = mesh;\n  },\n\n  fadeOut() {\n    return this.beginTransition(\"out\");\n  },\n\n  fadeIn() {\n    return this.beginTransition(\"in\");\n  },\n\n  async beginTransition(direction) {\n    if (this._resolveFinish) {\n      throw new Error(\"Cannot fade while a fade is happening.\");\n    }\n\n    this.el.setAttribute(\"fader\", { direction });\n\n    return new Promise(res => {\n      if (this.mesh.material.opacity === (direction == \"in\" ? 0 : 1)) {\n        res();\n      } else {\n        this._resolveFinish = res;\n      }\n    });\n  },\n\n  tick(t, dt) {\n    const mat = this.mesh.material;\n    this.mesh.visible = this.data.direction === \"out\" || mat.opacity !== 0;\n    if (!this.mesh.visible) return;\n\n    if (this.data.direction === \"in\") {\n      mat.opacity = Math.max(0, mat.opacity - (1.0 / FADE_DURATION_MS) * Math.min(dt, 50));\n    } else if (this.data.direction === \"out\") {\n      mat.opacity = Math.min(1, mat.opacity + (1.0 / FADE_DURATION_MS) * Math.min(dt, 50));\n    }\n\n    if (mat.opacity === 0 || mat.opacity === 1) {\n      if (this.data.direction !== \"none\") {\n        if (this._resolveFinish) {\n          this._resolveFinish();\n          this._resolveFinish = null;\n        }\n      }\n\n      this.el.setAttribute(\"fader\", { direction: \"none\" });\n    }\n  }\n});\n","AFRAME.registerComponent(\"follow-in-fov\", {\n  schema: {\n    target: { type: \"selector\" },\n    offset: { type: \"vec3\" },\n    speed: { type: \"number\", default: 0.003 },\n    angle: { type: \"number\", default: 45 }\n  },\n\n  init() {\n    this.targetPos = new THREE.Vector3();\n    this.offset = new THREE.Vector3();\n    this.offset.copy(this.data.offset);\n\n    this.snappedRot = new THREE.Euler();\n    this.snappedQ = new THREE.Quaternion();\n    this.snappedXForm = new THREE.Matrix4();\n    this.snappedXFormWorld = new THREE.Matrix4();\n    this.tempVector = new THREE.Vector3();\n  },\n\n  tick(t, dt) {\n    if (!this.el.object3D.visible) return;\n    if (!this.data.target) return;\n\n    const obj = this.el.object3D;\n    const target = this.data.target.object3D;\n\n    // Slow updating position if the element or any subelement is hovered.\n    let isHovered = false;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    const hoveredEl = interaction.state.rightRemote.hovered || interaction.state.leftRemote.hovered;\n\n    if (hoveredEl) {\n      let el = hoveredEl;\n\n      while (el) {\n        if (this.el === el) {\n          isHovered = true;\n          break;\n        }\n\n        el = el.parentNode;\n      }\n    }\n\n    if (!isHovered) {\n      this._hoveredFrames = 0;\n    } else {\n      this._hoveredFrames += 1;\n    }\n\n    // Compute position + rotation by projecting offset along a downward ray in target space,\n    // and mask out Z rotation.\n    this._applyMaskedTargetRotation(\n      -this.data.angle * THREE.MathUtils.DEG2RAD,\n      target.rotation.y,\n      0,\n      this.snappedXFormWorld\n    );\n\n    this.targetPos.copy(this.offset);\n    this.targetPos.applyMatrix4(this.snappedXFormWorld);\n\n    if (obj.parent) {\n      obj.parent.worldToLocal(this.targetPos);\n    }\n\n    if (!this.started) {\n      obj.position.copy(this.targetPos);\n      this.started = true;\n    } else {\n      // Slow down movement if hovering by dampening speed each frame.\n      const speed = this._hoveredFrames\n        ? this.data.speed * (1.0 / ((this._hoveredFrames + 5.0) * 0.2))\n        : this.data.speed;\n      const t = speed * dt;\n\n      obj.position.set(\n        obj.position.x + (this.targetPos.x - obj.position.x) * t,\n        obj.position.y + (this.targetPos.y - obj.position.y) * t,\n        obj.position.z + (this.targetPos.z - obj.position.z) * t\n      );\n    }\n\n    this.snappedXFormWorld.decompose(this.tempVector, obj.quaternion, this.tempVector);\n    obj.matrixNeedsUpdate = true;\n  },\n\n  reset() {\n    this.started = false;\n  },\n\n  _applyMaskedTargetRotation(x, y, z, to) {\n    const target = this.data.target.object3D;\n    this.snappedRot.set(x, y, z, target.rotation.order);\n    this.snappedQ.setFromEuler(this.snappedRot);\n\n    this.snappedXForm.compose(\n      target.position,\n      this.snappedQ,\n      target.scale\n    );\n\n    to.multiplyMatrices(target.parent.matrixWorld, this.snappedXForm);\n  }\n});\n","/**\n * Frustrum-based object visibilty\n * @component frustrum\n */\nAFRAME.registerComponent(\"frustrum\", {\n  schema: {\n    culled: { type: \"boolean\", default: true }\n  },\n\n  update: function() {\n    this.updateDescendants(this.data.culled);\n  },\n\n  remove: function() {\n    this.updateDescendants(true);\n  },\n\n  updateDescendants: function(culled) {\n    this.el.object3D.traverse(function(node) {\n      if (!(node instanceof THREE.Mesh)) {\n        return;\n      }\n      node.frustumCulled = culled;\n    });\n  }\n});\n","/* global CANNON */\nAFRAME.registerComponent(\"heightfield\", {\n  init() {\n    this.el.addEventListener(\"componentinitialized\", e => {\n      if (e.detail.name === \"static-body\") {\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\n      }\n    });\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\n  },\n  generateAndAddHeightfield(body) {\n    const { offset, distance, data } = this.data;\n\n    const orientation = new CANNON.Quaternion();\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\n\n    const rotation = new CANNON.Quaternion();\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\n    rotation.mult(orientation, orientation);\n\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\n\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\n\n    body.addShape(shape, cannonOffset, orientation);\n  }\n});\n","AFRAME.registerComponent(\"hemisphere-light\", {\n  schema: {\n    skyColor: { type: \"color\" },\n    groundColor: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    this.light = new THREE.HemisphereLight();\n    this.light.position.set(0, 0, 0);\n    this.light.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"hemisphere-light\", this.light);\n  },\n\n  update(prevData) {\n    if (this.data.skyColor !== prevData.skyColor) {\n      this.light.color.set(this.data.skyColor);\n    }\n\n    if (this.data.groundColor !== prevData.groundColor) {\n      this.light.groundColor.set(this.data.groundColor);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"hemisphere-light\");\n  }\n});\n","AFRAME.registerComponent(\"hide-when-pinned-and-forbidden\", {\n  schema: {\n    // Hide regardless of being forbidden.\n    whenPinned: { type: \"boolean\" }\n  },\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    if (!this.targetEl) return;\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n\n    if (this.data.whenPinned) {\n      this.el.object3D.visible = !isPinned;\n    } else {\n      const pinnedAndForbidden = isPinned && !window.APP.hubChannel.canOrWillIfCreator(\"pin_objects\");\n      this.el.object3D.visible = !pinnedAndForbidden;\n    }\n  }\n});\n","/**\n * Hides entities based on the scene's quality mode\n * @namespace environment\n * @component hide-when-quality\n */\nAFRAME.registerComponent(\"hide-when-quality\", {\n  schema: { type: \"string\", default: \"low\" },\n\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.updateComponentState(window.APP.store.state.preferences.materialQualitySetting);\n    }\n  },\n\n  updateComponentState(quality) {\n    this.el.setAttribute(\"visible\", quality !== this.data);\n  }\n});\n","AFRAME.registerComponent(\"hover-menu\", {\n  multiple: true,\n  schema: {\n    template: { type: \"selector\" },\n    isFlat: { default: true },\n    dim: { default: true },\n    withPermission: { type: \"string\" }\n  },\n\n  async init() {\n    this.onFrozenStateChange = this.onFrozenStateChange.bind(this);\n    this.hovering = false;\n    await this.getHoverMenu();\n    this.applyHoverState();\n  },\n\n  getHoverMenu() {\n    if (this.menuPromise) return this.menuPromise;\n    return (this.menuPromise = new Promise(resolve => {\n      const menu = this.el.appendChild(document.importNode(this.data.template.content, true).children[0]);\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n      setTimeout(() => {\n        this.menu = menu;\n\n        // HACK workaround for now due to position-at-box-shape-border having problems\n        // with nested entities, when using 'mirror' viewing.\n        //\n        // TODO Revisit once that component is removed/deprecated. If we disable repositioning,\n        // the menu will only appear on the front of the object (which is fine for our purposes)\n        const isMirroredMedia = this.el.parentEl.id === \"media-mirror-target\";\n        const enableRepositioning = !isMirroredMedia;\n\n        if (enableRepositioning) {\n          this.el.setAttribute(\"position-at-border\", {\n            target: \".hover-container\",\n            isFlat: this.data.isFlat,\n            animate: false,\n            scale: false\n          });\n        } else {\n          const hoverContainer = this.el.querySelector(\".hover-container\");\n          hoverContainer.object3D.position.z = 0.001;\n          hoverContainer.object3D.matrixNeedsUpdate = true;\n        }\n\n        resolve(this.menu);\n      });\n    }));\n  },\n\n  onFrozenStateChange(e) {\n    if (!e.detail === \"frozen\") return;\n    this.applyHoverState();\n  },\n\n  applyHoverState() {\n    if (!this.menu) return;\n    const allowed = !this.data.withPermission || window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    this.menu.object3D.visible = allowed && !this.el.sceneEl.is(\"frozen\") && this.hovering;\n    if (this.data.dim && this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) {\n      this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible ? 0.5 : 1);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onFrozenStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onFrozenStateChange);\n  }\n});\n","/**\n * A button with an image, tooltip, hover states.\n * @namespace ui\n * @component icon-button\n */\nAFRAME.registerComponent(\"icon-button\", {\n  schema: {\n    image: { type: \"string\" },\n    hoverImage: { type: \"string\" },\n    activeImage: { type: \"string\" },\n    activeHoverImage: { type: \"string\" },\n    disabledImage: { type: \"string\" },\n    active: { type: \"boolean\" },\n    disabled: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = true;\n      }\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = false;\n      }\n      this.updateButtonState();\n    };\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    const active = this.data.active;\n    const disabled = this.data.disabled;\n\n    let image;\n    if (disabled) {\n      image = \"disabledImage\";\n    } else if (active) {\n      image = hovering ? \"activeHoverImage\" : \"activeImage\";\n    } else {\n      image = hovering ? \"hoverImage\" : \"image\";\n    }\n\n    if (this.el.components.sprite) {\n      if (this.data[image]) {\n        this.el.setAttribute(\"sprite\", \"name\", this.data[image]);\n      } else {\n        console.warn(`No ${image} image on me.`, this);\n      }\n    } else {\n      console.error(\"No sprite.\");\n    }\n\n    if (this.data.tooltip && hovering) {\n      const tooltipText =\n        (this.data.active ? this.data.activeTooltipText : this.data.tooltipText) + (disabled ? \" Disabled\" : \"\");\n      this.data.tooltip.querySelector(\"[text]\").setAttribute(\"text\", \"value\", tooltipText);\n    }\n  }\n});\n","AFRAME.registerComponent(\"inject-main-camera-here\", {\n  init() {\n    // This is what actually puts the camera into the scene graph.\n    // Ideally we would just be doing this ourselves, but we have to do it after the entity we want to parent it to is created\n    // TODO any references to this entity should instead get the camera reference from the camera system\n    this.el.setObject3D(\"camera\", this.el.sceneEl.camera);\n  }\n});\n","AFRAME.registerComponent(\"inspect-button\", {\n  tick() {\n    if (!this.initializedInTick) {\n      // initialize in tick so that parent's `tags` component has been initialized\n      this.initializedInTick = true;\n      this.el.object3D.addEventListener(\"holdable-button-down\", () => {\n        this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.inspect(this.el, 1.5);\n      });\n      this.el.object3D.addEventListener(\"holdable-button-up\", () => {\n        this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.uninspect();\n      });\n    }\n  }\n});\n","AFRAME.registerComponent(\"inspect-pivot-child-selector\", {\n  schema: {\n    selector: { type: \"string\" }\n  }\n});\n","AFRAME.registerComponent(\"kick-button\", {\n  init() {\n    this.onClick = () => {\n      this.kick(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async kick(clientId) {\n    this.el.sceneEl.emit(\"action_kick_client\", { clientId });\n  }\n});\n","// AFRAME.registerComponent(\"leave-room-button\", {\n//   init() {\n//     this.onClick = () => {\n//       this.el.sceneEl.emit(\"leave_room_requested\");\n//     };\n//   },\n\n//   play() {\n//     this.el.object3D.addEventListener(\"interact\", this.onClick);\n//   },\n\n//   pause() {\n//     this.el.object3D.removeEventListener(\"interact\", this.onClick);\n//   }\n// });\nAFRAME.registerComponent(\"leave-room-button\", {\n  init() {\n    this.onClick = () => {\n      // Close the browser\n      window.close();\n    };\n    this.el.sceneEl.addEventListener(\"leave_room_requested\", this.onClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"leave_room_requested\", this.onClick);\n  }\n});","AFRAME.registerComponent(\"mute-button\", {\n  init() {\n    this.onClick = () => {\n      this.mute(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async mute(clientId) {\n    this.el.sceneEl.emit(\"action_mute_client\", { clientId });\n  }\n});\n","/**\n * Stores networked avatar state.\n * @namespace avatar\n * @component networked-avatar\n */\nAFRAME.registerComponent(\"networked-avatar\", {\n  schema: {\n    left_hand_pose: { default: 0 },\n    right_hand_pose: { default: 0 }\n  }\n});\n","/* global AFRAME performance */\n/**\n * Limits networked interactables to a maximum number at any given time\n * @namespace network\n * @component networked-counter\n */\nAFRAME.registerComponent(\"networked-counter\", {\n  schema: {\n    max: { default: 3 }\n  },\n\n  init() {\n    this.timestamps = new Map();\n    this.el.object3D.visible = false;\n  },\n\n  remove() {\n    this.timestamps.clear();\n  },\n\n  count() {\n    return this.timestamps.size;\n  },\n\n  register(el) {\n    if (this.data.max <= 0 || this.timestamps.has(el)) return;\n\n    this.timestamps.set(el, performance.now());\n    if (this.timestamps.size > this.data.max) {\n      this._destroyOldest();\n    }\n  },\n\n  deregister(el) {\n    if (!this.timestamps.has(el)) return;\n    this.timestamps.delete(el);\n  },\n\n  _destroyOldest() {\n    const interaction = this.el.sceneEl.systems.interaction;\n    let oldestEl = null,\n      minTs = Number.MAX_VALUE;\n    this.timestamps.forEach((ts, el) => {\n      if (ts < minTs && !interaction.isHeld(el) && NAF.utils.isMine(el)) {\n        oldestEl = el;\n        minTs = ts;\n      }\n    });\n    this._destroy(oldestEl);\n  },\n\n  _destroy(el) {\n    // Pause the entity so that it won't just re-register itself immediately in owned-object-limiter.\n    el.pause();\n    // networked-interactable's remove will also call deregister, but it will happen async so we do it here as well.\n    this.deregister(el);\n    if (el.parentNode) {\n      el.parentNode.removeChild(el);\n    }\n  }\n});\n","AFRAME.registerComponent(\"optional-alternative-to-not-hide\", {});\n","/* global performance */\nAFRAME.registerComponent(\"owned-object-cleanup-timeout\", {\n  schema: {\n    ttl: { default: 0 }\n  },\n\n  init() {\n    this.timeout = performance.now() + this.data.ttl * 1000;\n  },\n\n  tick() {\n    if (!this.el.components[\"networked\"] || !NAF.utils.isMine(this.el)) {\n      return;\n    }\n\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n\n    if (isHeld) {\n      this.timeout = performance.now() + this.data.ttl * 1000;\n      return;\n    }\n\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\n\n    if (!isPinned && performance.now() >= this.timeout) {\n      this.el.parentNode.removeChild(this.el);\n    }\n  }\n});\n","/* global AFRAME NAF performance */\nAFRAME.registerComponent(\"owned-object-limiter\", {\n  schema: {\n    counter: { type: \"selector\" }\n  },\n\n  init() {\n    this.counter = this.data.counter.components[\"networked-counter\"];\n  },\n\n  tick() {\n    this._syncCounterRegistration();\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n    if (!isHeld && this.wasHeld && this.counter.timestamps.has(this.el)) {\n      this.counter.timestamps.set(this.el, performance.now());\n    }\n    this.wasHeld = isHeld;\n  },\n\n  remove() {\n    this.counter.deregister(this.el);\n  },\n\n  _syncCounterRegistration() {\n    if (!this.el.components[\"networked\"]) return;\n\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\n\n    if (NAF.utils.isMine(this.el) && !isPinned) {\n      this.counter.register(this.el);\n    } else {\n      this.counter.deregister(this.el);\n    }\n  }\n});\n","const SYNC_DURATION_MS = 5000;\n\n// HACK this is a hacky component that is used to mitigate the situation where a first sync is missed on critical\n// networked elements. (At the time of this writing, specifically just the user's avatar.) The motivation\n// is that there have been a variety of issues resulting in missed avatar instantiation messages, and\n// this is meant to ensure we recover from those in the cases where they occur.\n//\n// This component, when added, will re-send a isFirstSync message for the networked object is it attached to\n// every SYNC_DURATION_MS milliseconds.\nAFRAME.registerComponent(\"periodic-full-syncs\", {\n  init() {\n    this.lastSync = 0;\n  },\n\n  tick() {\n    const now = performance.now();\n\n    if (now - this.lastSync >= SYNC_DURATION_MS && this.el.components && this.el.components.networked) {\n      this.lastSync = now;\n\n      // Sends an undirected first sync message.\n      this.el.components.networked.syncAll(null, true);\n    }\n  }\n});\n","AFRAME.registerComponent(\"point-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    this.light = new THREE.PointLight();\n    this.light.shadow.camera.matrixAutoUpdate = true;\n    this.el.setObject3D(\"point-light\", this.light);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      color.convertSRGBToLinear();\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"point-light\");\n  }\n});\n","AFRAME.registerComponent(\"replay\", {\n  init: function() {\n    this.playhead = 0;\n    this.poseIndex = 0;\n  },\n\n  tick: function(t, dt) {\n    let overflow = false;\n    while (!overflow && this.playhead >= this.poses[this.poseIndex].timestamp) {\n      this.el.setAttribute(\"position\", this.poses[this.poseIndex].position);\n      this.el.setAttribute(\"rotation\", this.poses[this.poseIndex].rotation);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.poseIndex += 1;\n      overflow = this.poseIndex === this.poses.length;\n    }\n\n    this.playhead += dt;\n\n    if (overflow) {\n      this.playhead = 0;\n      this.poseIndex = 0;\n    }\n  }\n});\n","/* global NAF */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"set-unowned-body-kinematic\", {\n  init() {\n    this.setBodyKinematic = this.setBodyKinematic.bind(this);\n  },\n  play() {\n    this.el.addEventListener(\"ownership-lost\", this.setBodyKinematic);\n\n    if (!this.didThisOnce) {\n      // Do this in play instead of init so that the ammo-body and networked components are done\n      this.didThisOnce = true;\n\n      if (!this.el.components.networked || !NAF.utils.isMine(this.el)) {\n        this.setBodyKinematic();\n      }\n    }\n  },\n  pause() {\n    this.el.removeEventListener(\"ownership-lost\", this.setBodyKinematic);\n  },\n  setBodyKinematic() {\n    this.el.setAttribute(\"body-helper\", {\n      type: \"kinematic\",\n      collisionFilterMask: COLLISION_LAYERS.UNOWNED_INTERACTABLE\n    });\n  }\n});\n","AFRAME.registerComponent(\"set-yxz-order\", {\n  init: function() {\n    this.el.object3D.rotation.order = \"YXZ\";\n  }\n});\n","AFRAME.registerComponent(\"spot-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    innerConeAngle: { default: 0 },\n    outerConeAngle: { default: Math.PI / 4.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    this.light = new THREE.SpotLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.light.matrixNeedsUpdate = true;\n    this.light.target.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"spot-light\", this.light);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\n      light.angle = this.data.outerConeAngle;\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"spot-light\");\n  }\n});\n","/**\n * A button with text\n * @namespace ui\n * @component text-button\n */\nAFRAME.registerComponent(\"text-button\", {\n  schema: {\n    textHoverColor: { type: \"string\" },\n    textColor: { type: \"string\" },\n    backgroundHoverColor: { type: \"string\" },\n    backgroundColor: { type: \"string\" }\n  },\n\n  init() {\n    // TODO: This is a bit of a hack to deal with position \"component\" not setting matrixNeedsUpdate. Come up with a better solution.\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n    this.textEl = this.el.querySelector(\"[text]\");\n\n    if (this.el.getObject3D(\"mesh\")) {\n      this.el.components.slice9.plane.material.toneMapped = false;\n    } else {\n      this.el.addEventListener(\n        \"object3dset\",\n        () => {\n          this.el.components.slice9.plane.material.toneMapped = false;\n        },\n        { once: true }\n      );\n    }\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    this.el.setAttribute(\"slice9\", \"color\", hovering ? this.data.backgroundHoverColor : this.data.backgroundColor);\n\n    if (this.textEl) {\n      this.textEl.setAttribute(\"text\", \"color\", hovering ? this.data.textHoverColor : this.data.textColor);\n    }\n  }\n});\n\nconst noop = function() {};\n// TODO: this should ideally be fixed upstream somehow but its pretty tricky since text is just a geometry not a different type of Object3D, and Object3D is what handles raycast checks.\nAFRAME.registerComponent(\"text-raycast-hack\", {\n  dependencies: [\"text\"],\n  init() {\n    this.el.getObject3D(\"text\").raycast = noop;\n  }\n});\n","/**\n * Drawing Manager\n * Manages what networked-drawings are available to pen components\n * @namespace drawing\n * @component drawing-manager\n */\nAFRAME.registerComponent(\"drawing-manager\", {\n  schema: {\n    penSpawner: { type: \"selector\" }\n  },\n\n  init() {\n    this.el.object3D.visible = false;\n    this.drawingToPen = new Map();\n    this.data.penSpawner.addEventListener(\"spawned-entity-created\", () => {\n      if (!this.drawingEl) {\n        this.createDrawing();\n      }\n    });\n  },\n\n  createDrawing() {\n    if (!this.createDrawingPromise) {\n      this.createDrawingPromise = new Promise(resolve => {\n        this.drawingEl = document.createElement(\"a-entity\");\n        this.drawingEl.setAttribute(\"networked\", \"template: #interactable-drawing\");\n        this.el.sceneEl.appendChild(this.drawingEl);\n\n        const handNetworkedDrawingInit = e => {\n          if (e.detail.name === \"networked-drawing\") {\n            this.drawing = this.drawingEl.components[\"networked-drawing\"];\n            this.drawingEl.removeEventListener(\"componentinitialized\", handNetworkedDrawingInit);\n            resolve();\n          }\n        };\n\n        this.drawingEl.addEventListener(\"componentinitialized\", handNetworkedDrawingInit);\n      });\n    }\n    return this.createDrawingPromise;\n  },\n\n  destroyDrawing(networkedDrawing) {\n    if (this.drawing === networkedDrawing) {\n      this.drawingToPen.delete(this.drawing);\n      this.drawing = null;\n      this.drawingEl = null;\n      this.createDrawingPromise = null;\n      this.getDrawingPromise = null;\n    }\n  },\n\n  getDrawing(pen) {\n    //TODO: future handling of multiple drawings\n    if (!this.getDrawingPromise) {\n      this.getDrawingPromise = new Promise((resolve, reject) => {\n        if (!this.drawingEl) {\n          this.createDrawing().then(() => {\n            this.drawingToPen.set(this.drawing, pen);\n            resolve(this.drawing);\n          });\n        } else if (\n          this.drawing &&\n          (!this.drawingToPen.has(this.drawing) || this.drawingToPen.get(this.drawing) === pen)\n        ) {\n          this.drawingToPen.set(this.drawing, pen);\n          resolve(this.drawing);\n        } else {\n          reject();\n        }\n      });\n    }\n    return this.getDrawingPromise;\n  },\n\n  returnDrawing(pen) {\n    if (this.drawingToPen.has(this.drawing) && this.drawingToPen.get(this.drawing) === pen) {\n      this.drawingToPen.delete(this.drawing);\n    }\n  }\n});\n","AFRAME.registerComponent(\"track-pose\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n\n  play() {\n    if (!this.didRegister) {\n      this.didRegister = true;\n      this.el.sceneEl.systems[\"hubs-systems\"].cursorPoseTrackingSystem.register(this.el.object3D, this.data.path);\n    }\n  },\n  remove() {\n    if (this.didRegister) {\n      this.el.sceneEl.systems[\"hubs-systems\"].cursorPoseTrackingSystem.unregister(this.el.object3D);\n    }\n  }\n});\n","const sizeVec = new THREE.Vector3();\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\nconst colliderWorldPositionVec = new THREE.Vector3();\n\nAFRAME.registerComponent(\"trigger-volume\", {\n  schema: {\n    colliders: { type: \"selectorAll\" },\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    target: { type: \"selector\" },\n    enterComponent: { type: \"string\" },\n    enterProperty: { type: \"string\" },\n    enterValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    },\n    leaveComponent: { type: \"string\" },\n    leaveProperty: { type: \"string\" },\n    leaveValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n  init() {\n    this.boundingBox = new THREE.Box3();\n    this.collidingLastFrame = {};\n  },\n  update() {\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\n    sizeVec.copy(this.data.size);\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\n  },\n  tick() {\n    if (!this.data.target) return;\n\n    const colliders = this.data.colliders;\n\n    for (let i = 0; i < colliders.length; i++) {\n      const collider = colliders[i];\n      const object3D = collider.object3D;\n\n      object3D.getWorldPosition(colliderWorldPositionVec);\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\n\n      if (isColliding && !collidingLastFrame) {\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\n      } else if (!isColliding && collidingLastFrame) {\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\n      }\n\n      this.collidingLastFrame[object3D.id] = isColliding;\n    }\n  }\n});\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\nAFRAME.registerComponent(\"video-pause-state\", {\n  schema: {\n    paused: { default: false }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.videoComponent = this.el.components[\"media-video\"];\n\n    if (this.videoComponent) {\n      this.onVideoLoaded();\n    } else {\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\n    }\n  },\n\n  onVideoLoaded() {\n    this.videoComponent = this.el.components[\"media-video\"];\n    this.video = this.videoComponent.video;\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\n  },\n\n  onPauseStateChange() {\n    this.el.setAttribute(\"paused\", this.video.paused);\n  },\n\n  update() {\n    if (this.video && this.data.paused !== this.video.paused) {\n      this.videoComponent.togglePlaying();\n    }\n  },\n\n  remove() {\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n    }\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\n  }\n});\n","AFRAME.registerComponent(\"visibility-by-path\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const shouldBeVisible = !!userinput.get(this.data.path);\n    if (this.el.object3D.visible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  }\n});\n","AFRAME.registerComponent(\"visibility-on-content-types\", {\n  schema: {\n    contentTypes: { type: \"string\" }, // Space separate content types. Or partial type, like video/\n    contentSubtype: { type: \"string\" },\n    visible: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(el => {\n        this.networkedEl = el;\n        el.addEventListener(\"media_resolved\", ({ detail: { contentType } }) => this.updateVisibility(contentType));\n        this.updateVisibility();\n      })\n      .catch(() => {\n        // Non-networked, do not handle for now.\n      });\n  },\n\n  updateVisibility(contentType) {\n    const mediaLoader = this.networkedEl.components[\"media-loader\"];\n    const mediaImage = this.networkedEl.components[\"media-image\"];\n    const mediaVideo = this.networkedEl.components[\"media-video\"];\n    const mediaPdf = this.networkedEl.components[\"media-pdf\"];\n    const currentContentType =\n      contentType ||\n      (mediaVideo && mediaVideo.data.contentType) ||\n      (mediaImage && mediaImage.data.contentType) ||\n      (mediaPdf && mediaPdf.data.contentType);\n\n    let matchesType = !this.data.contentTypes;\n\n    if (this.data.contentTypes && currentContentType) {\n      for (const contentType of this.data.contentTypes.split(\" \")) {\n        const targetContentType = currentContentType.toLowerCase().split(\";\")[0];\n\n        if (\n          targetContentType === contentType ||\n          (contentType.endsWith(\"/\") && targetContentType.startsWith(contentType))\n        ) {\n          matchesType = true;\n          break;\n        }\n      }\n    }\n\n    const matchesSubtype =\n      !this.data.contentSubtype ||\n      (mediaLoader.data.contentSubtype && mediaLoader.data.contentSubtype === this.data.contentSubtype);\n    const matches = !!(matchesType && matchesSubtype);\n    this.el.object3D.visible = this.data.visible ? matches : !matches;\n  }\n});\n","AFRAME.registerComponent(\"visible-if-permitted\", {\n  schema: {\n    type: \"string\"\n  },\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.updateVisibility();\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\n  },\n  updateVisibility() {\n    this.el.object3D.visible = this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data);\n  },\n  remove() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\n  }\n});\n","/**\n * Toggles the visibility of this entity based on networked ownership\n * @namespace ui\n * @component visible-to-owner\n */\nAFRAME.registerComponent(\"visible-to-owner\", {\n  init() {\n    this.onStateChange = e => {\n      this.el.setAttribute(\"visible\", e.detail.newOwner === NAF.clientId);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      el.addEventListener(\"ownership-changed\", this.onStateChange);\n      this.el.setAttribute(\"visible\", NAF.utils.isMine(el));\n    });\n  }\n});\n","let bit = 0;\nconst nextBit = () => 1 << bit++;\nconst CL = {\n  ALL: -1,\n  NONE: 0,\n  INTERACTABLES: nextBit(),\n  ENVIRONMENT: nextBit(),\n  AVATAR: nextBit(),\n  HANDS: nextBit(),\n  MEDIA_FRAMES: nextBit()\n};\n\n// @TODO we should split these \"sets\" off into something other than COLLISION_LAYERS or at least name\n// them differently to indicate they are a combination of multiple bits\nCL.DEFAULT_INTERACTABLE = CL.INTERACTABLES | CL.ENVIRONMENT | CL.AVATAR | CL.HANDS | CL.MEDIA_FRAMES;\nCL.UNOWNED_INTERACTABLE = CL.INTERACTABLES | CL.HANDS | CL.MEDIA_FRAMES;\nCL.DEFAULT_SPAWNER = CL.INTERACTABLES | CL.HANDS;\n\nconst PRIVACY = \"https://www.mozilla.org/en-US/privacy/hubs/\";\nconst TERMS = \"https://www.mozilla.org/en-US/about/legal/terms/hubs/\";\n\nmodule.exports = {\n  COLLISION_LAYERS: CL,\n  PRIVACY,\n  TERMS\n};\n","// Primary language tags for those languages we support\nexport const AVAILABLE_LOCALES = {\n  en: \"English\",\n  \"zh-cn\": \"简体中文\",\n  pt: \"Portugês (Brasil)\",\n  ja: \"日本語\",\n  es: \"Español\",\n  ru: \"Pусский\",\n  fr: \"Français\",\n  ko: \"한국어\",\n  de: \"Deutsch\",\n  \"zh-tw\": \"繁體中文\"\n};\n\n// Map from alternative primary language tags to those we support\nexport const FALLBACK_LOCALES = {\n  jp: \"ja\"\n};\n","import configs from \"./configs\";\nimport { AVAILABLE_LOCALES, FALLBACK_LOCALES } from \"../assets/locales/locale_config\";\n\n// These are set in the admin panel and are only included as fallbacks.\nconst defaultLocaleData = {\n  \"app-name\": \"App\",\n  \"editor-name\": \"Scene Editor\",\n  \"contact-email\": \"app@company.com\",\n  \"company-name\": \"Company\",\n  \"share-hashtag\": \"#app\",\n  \"app-description\": \"Gather share and collaborate together in a virtual, private and safe space\",\n  \"app-tagline\": \"Private social VR in your web browser\"\n};\n\nconst DEFAULT_LOCALE = \"en\";\nconst cachedMessages = new Map();\n\nlet _locale = DEFAULT_LOCALE;\nlet _localeData = defaultLocaleData;\n\nfunction findLocale(locale) {\n  const locales = (() => {\n    if (navigator.languages) {\n      return [...navigator.languages];\n    }\n    if (navigator.language) {\n      return [navigator.language];\n    }\n    if (navigator.userLanguage) {\n      return [navigator.userLanguage];\n    }\n  })();\n\n  if (locale && locale !== \"browser\") {\n    locales.unshift(locale);\n  }\n\n  for (let i = 0; i < locales.length; i++) {\n    const curLocale = locales[i];\n    if (AVAILABLE_LOCALES.hasOwnProperty(curLocale)) {\n      return curLocale;\n    }\n    if (FALLBACK_LOCALES.hasOwnProperty(curLocale)) {\n      FALLBACK_LOCALES.hasOwnProperty(curLocale);\n    }\n    // Also check the primary language subtag in case\n    // we do not have an entry for full tag\n    // See https://en.wikipedia.org/wiki/IETF_language_tag#Syntax_of_language_tags\n    // and https://github.com/mozilla/hubs/pull/3350/files#diff-70ef5717d3da03ef288e8d15c2fda32c5237d7f37074421496f22403e4475bf1R16\n    const primaryLanguageSubtag = curLocale.split(\"-\")[0].toLowerCase();\n    if (AVAILABLE_LOCALES.hasOwnProperty(primaryLanguageSubtag)) {\n      return primaryLanguageSubtag;\n    }\n    if (FALLBACK_LOCALES.hasOwnProperty(primaryLanguageSubtag)) {\n      return FALLBACK_LOCALES[primaryLanguageSubtag];\n    }\n  }\n  return DEFAULT_LOCALE;\n}\n\nexport function setLocale(locale) {\n  const resolvedLocale = findLocale(locale);\n\n  if (resolvedLocale === DEFAULT_LOCALE) {\n    _locale = resolvedLocale;\n    _localeData = defaultLocaleData;\n    window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n  } else {\n    if (cachedMessages.has(resolvedLocale)) {\n      _locale = resolvedLocale;\n      window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n    } else {\n      import(`../assets/locales/${resolvedLocale}.json`).then(({ default: localeData }) => {\n        _locale = resolvedLocale;\n        _localeData = localeData;\n        window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n      });\n    }\n  }\n}\n\nconst interval = window.setInterval(() => {\n  if (window.APP && window.APP.store) {\n    window.clearInterval(interval);\n    setLocale(window.APP.store.state.preferences.locale);\n    window.APP.store.addEventListener(\"statechanged\", () => {\n      setLocale(window.APP.store.state.preferences.locale);\n    });\n  }\n}, 100);\n\nexport const getLocale = () => {\n  return _locale;\n};\n\nexport const getMessage = key => {\n  return _localeData[key];\n};\n\n// TODO: This should be removed, lets not inject app config data up front but rather via variables so that defaultMessage works properly.\nexport const getMessages = () => {\n  if (cachedMessages.has(_locale)) {\n    return cachedMessages.get(_locale);\n  }\n\n  // Swap in translations specified via the admin panel\n  if (configs.APP_CONFIG && configs.APP_CONFIG.translations && configs.APP_CONFIG.translations[_locale]) {\n    const configTranslations = configs.APP_CONFIG.translations[_locale];\n    for (const messageKey in configTranslations) {\n      if (!configTranslations.hasOwnProperty(messageKey)) continue;\n      if (!configTranslations[messageKey]) continue;\n      _localeData[messageKey] = configTranslations[messageKey];\n    }\n  }\n\n  const entries = [];\n  for (const key in _localeData) {\n    if (!_localeData.hasOwnProperty(key)) continue;\n    entries.push([key, _localeData[key]]);\n  }\n\n  const messages = entries\n    .map(([key, message]) => [\n      key,\n      // Replace nested message keys (e.g. %app-name%) with their messages.\n      message.replace(/%([\\w-.]+)%/i, (_match, subkey) => _localeData[subkey])\n    ])\n    .reduce((acc, entry) => {\n      acc[entry[0]] = entry[1];\n      return acc;\n    }, {});\n\n  cachedMessages.set(_locale, messages);\n  return messages;\n};\n","import appLogo from \"../assets/images/app-logo.png\";\nimport appLogoDark from \"../assets/images/app-logo-dark.png\";\nimport companyLogo from \"../assets/images/company-logo.png\";\nimport homeHeroBackground from \"../assets/images/home-hero-background-unbranded.png\";\nimport sceneEditorLogo from \"../assets/images/editor-logo.png\";\nimport { getLocale, getMessage } from \"./i18n\";\n\n// Read configs from global variable if available, otherwise use the process.env injected from build.\nconst configs = {};\nlet isAdmin = false;\n[\n  \"RETICULUM_SERVER\",\n  \"THUMBNAIL_SERVER\",\n  \"CORS_PROXY_SERVER\",\n  \"NON_CORS_PROXY_DOMAINS\",\n  \"SENTRY_DSN\",\n  \"GA_TRACKING_ID\",\n  \"SHORTLINK_DOMAIN\",\n  \"BASE_ASSETS_PATH\",\n  \"UPLOADS_HOST\"\n].forEach(x => {\n  const el = document.querySelector(`meta[name='env:${x.toLowerCase()}']`);\n  configs[x] = el ? el.getAttribute(\"content\") : process.env[x];\n\n  const BASE_ASSETS_PATH_KEY = \"BASE_ASSETS_PATH\";\n  if (x === BASE_ASSETS_PATH_KEY && configs[BASE_ASSETS_PATH_KEY]) {\n    // BASE_ASSETS_PATH might be a relative URL like \"/\" when it is set in\n    // .env or .defaults.env when running locally. We need to convert that\n    // to an absolute URL.\n    if (!configs[BASE_ASSETS_PATH_KEY].startsWith(\"http\")) {\n      configs[BASE_ASSETS_PATH_KEY] = new URL(configs[BASE_ASSETS_PATH_KEY], window.location).toString();\n    }\n\n    // eslint-disable-next-line no-undef\n    __webpack_public_path__ = configs[BASE_ASSETS_PATH_KEY];\n  }\n});\n\n// Custom clients do not use <meta> tags for passing data, so if thumbnail_server meta tag exists, it is not a custom client\nconst hasThumbnailServerMetaTag = !!document.querySelector(\"meta[name='env:thumbnail_server']\");\nconfigs.IS_LOCAL_OR_CUSTOM_CLIENT = !hasThumbnailServerMetaTag;\n\n// Also include configs that reticulum injects as a script in the page head.\n\nconfigs.AVAILABLE_INTEGRATIONS = window.AVAILABLE_INTEGRATIONS || {};\n\nif (process.env.APP_CONFIG) {\n  window.APP_CONFIG = process.env.APP_CONFIG;\n}\n\nif (window.APP_CONFIG) {\n  configs.APP_CONFIG = window.APP_CONFIG;\n  const { theme } = configs.APP_CONFIG;\n  if (theme) {\n    const colorVars = [];\n    for (const key in theme) {\n      if (!theme.hasOwnProperty(key)) continue;\n      colorVars.push(`--${key}: ${theme[key]};`);\n    }\n    const style = document.createElement(\"style\");\n    style.innerHTML = `:root{${colorVars.join(\"\\n\")}}`;\n    document.head.insertBefore(style, document.head.firstChild);\n  }\n\n  if (!configs.APP_CONFIG.features) {\n    configs.APP_CONFIG.features = {};\n  }\n} else {\n  configs.APP_CONFIG = {\n    features: {}\n  };\n}\n\nconst isLocalDevelopment = process.env.NODE_ENV === \"development\";\n\nconfigs.feature = featureName => {\n  const value = configs.APP_CONFIG && configs.APP_CONFIG.features && configs.APP_CONFIG.features[featureName];\n  if (typeof value === \"boolean\" || featureName === \"enable_spoke\") {\n    const forceEnableSpoke = featureName === \"enable_spoke\" && isAdmin;\n    return forceEnableSpoke || value;\n  } else {\n    return value;\n  }\n};\n\nlet localDevImages = {};\nif (isLocalDevelopment) {\n  localDevImages = {\n    logo: appLogo,\n    logo_dark: appLogoDark,\n    company_logo: companyLogo,\n    editor_logo: sceneEditorLogo,\n    home_background: homeHeroBackground\n  };\n}\n\nconfigs.image = (imageName, cssUrl) => {\n  const url =\n    (configs.APP_CONFIG && configs.APP_CONFIG.images && configs.APP_CONFIG.images[imageName]) ||\n    localDevImages[imageName];\n  return url && cssUrl ? `url(${url})` : url;\n};\n\nconfigs.link = (linkName, defaultValue) => {\n  return (configs.APP_CONFIG && configs.APP_CONFIG.links && configs.APP_CONFIG.links[linkName]) || defaultValue;\n};\n\nconfigs.setIsAdmin = _isAdmin => {\n  isAdmin = _isAdmin;\n};\nconfigs.isAdmin = () => isAdmin;\n\nconfigs.integration = integration => {\n  const availableIntegrations = configs.AVAILABLE_INTEGRATIONS;\n  // AVAILABLE_INTEGRATIONS has no properties defined on the dev server, but does support all integrations.\n  return !availableIntegrations.hasOwnProperty(integration) || availableIntegrations[integration];\n};\n\nconfigs.translation = key => {\n  const locale = getLocale();\n  const translationsConfig = (configs.APP_CONFIG && configs.APP_CONFIG.translations) || {};\n\n  return (\n    (translationsConfig[locale] && translationsConfig[locale][key]) ||\n    (translationsConfig.en && translationsConfig.en[key]) ||\n    getMessage(key) ||\n    \"\"\n  );\n};\n\nexport default configs;\n","import configs from \"./configs\";\nexport function getCurrentHubId() {\n  const qs = new URLSearchParams(location.search);\n  const defaultRoomId = configs.feature(\"default_room_id\");\n\n  return (\n    qs.get(\"hub_id\") ||\n    (document.location.pathname === \"/\" && defaultRoomId\n      ? defaultRoomId\n      : document.location.pathname.substring(1).split(\"/\")[0])\n  );\n}\n\nexport function updateVRHudPresenceCount({ presence }) {\n  const occupantCount = Object.getOwnPropertyNames(presence.state).length;\n  const vrHudPresenceCount = document.querySelector(\"#hud-presence-count\");\n  vrHudPresenceCount.setAttribute(\"text\", \"value\", occupantCount.toString());\n}\nexport function updateSceneCopresentState(presence, scene) {\n  const occupantCount = Object.getOwnPropertyNames(presence.state).length;\n  if (occupantCount > 1) {\n    scene.addState(\"copresent\");\n  } else {\n    scene.removeState(\"copresent\");\n  }\n}\n\nexport function createHubChannelParams({\n  permsToken,\n  profile,\n  pushSubscriptionEndpoint,\n  isMobile,\n  isMobileVR,\n  isEmbed,\n  hubInviteId,\n  authToken\n}) {\n  return {\n    profile,\n    push_subscription_endpoint: pushSubscriptionEndpoint,\n    auth_token: authToken || null,\n    perms_token: permsToken || null,\n    context: {\n      mobile: isMobile || isMobileVR,\n      embed: isEmbed,\n      hmd: isMobileVR\n    },\n    hub_invite_id: hubInviteId\n  };\n}\n","import { themes } from \"../react-components/styles/theme\";\n\nexport function getColorSchemePref() {\n  const darkmodeQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n  const darkMode = darkmodeQuery.matches;\n  return (darkMode && themes.find(t => t.darkModeDefault)) || themes.find(t => t.default);\n}\n","import { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { getColorSchemePref } from \"../../utils/get-color-scheme-pref\";\nimport configs from \"../../utils/configs\";\n\nlet config = process.env.APP_CONFIG;\n\n// Storybook includes environment variables as a string\n// https://storybook.js.org/docs/react/configure/environment-variables\nif (!config && process.env.STORYBOOK_APP_CONFIG) {\n  config = JSON.parse(process.env.STORYBOOK_APP_CONFIG);\n}\n\nif (!config) {\n  config = window.APP_CONFIG;\n}\n\nif (config?.theme?.error) {\n  console.error(\n    `Custom themes failed to load.\\n${config.theme.error}\\nIf you are an admin, reconfigure your themes in the admin panel.`\n  );\n}\n\nexport const defaultTheme = \"default\";\n\nexport const themes = config?.theme?.themes || [];\n\nfunction useDarkMode() {\n  const [darkMode, setDarkMode] = useState(false);\n\n  const changeListener = useCallback(\n    event => {\n      setDarkMode(event.matches);\n    },\n    [setDarkMode]\n  );\n\n  useEffect(() => {\n    const darkmodeQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n\n    setDarkMode(darkmodeQuery.matches);\n\n    // This is a workaround for old Safari.\n    // Prior to Safari 14, MediaQueryList is based on EventTarget, so you must use\n    // addListener() and removeListener() to observe media query lists.\n    // https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/addListener\n    // We may remove this workaround when no one will use Safari 13 or before.\n    if (darkmodeQuery.addEventListener) {\n      darkmodeQuery.addEventListener(\"change\", changeListener);\n    } else {\n      darkmodeQuery.addListener(changeListener);\n    }\n\n    return () => {\n      if (darkmodeQuery.removeEventListener) {\n        darkmodeQuery.removeEventListener(\"change\", changeListener);\n      } else {\n        darkmodeQuery.removeListener(changeListener);\n      }\n    };\n  }, [changeListener]);\n\n  return darkMode;\n}\n\nexport function useTheme(themeId) {\n  const darkMode = useDarkMode();\n\n  useEffect(() => {\n    // Themes can come from an external source. Ensure it is an array.\n    if (!Array.isArray(themes)) return;\n\n    let theme;\n\n    if (themeId) {\n      theme = themes.find(t => t.id === themeId);\n    }\n\n    if (!theme && darkMode) {\n      theme = themes.find(t => t.darkModeDefault);\n    }\n\n    if (!theme) {\n      theme = themes.find(t => t.default);\n    }\n\n    if (!theme) {\n      return;\n    }\n\n    const variables = [];\n\n    for (const key in theme.variables) {\n      if (!theme.variables.hasOwnProperty(key)) continue;\n      variables.push(`--${key}: ${theme.variables[key]};`);\n    }\n\n    const styleTag = document.createElement(\"style\");\n\n    styleTag.innerHTML = `:root {\n        ${variables.join(\"\\n\")}\n      }`;\n\n    document.head.appendChild(styleTag);\n\n    return () => {\n      document.head.removeChild(styleTag);\n    };\n  }, [themeId, darkMode]);\n}\n\nfunction getCurrentTheme() {\n  if (!Array.isArray(themes)) return;\n\n  const preferredThemeId = window.APP?.store?.state?.preferences?.theme;\n  if (preferredThemeId) {\n    return themes.find(t => t.id === preferredThemeId);\n  } else {\n    return getColorSchemePref();\n  }\n}\n\nfunction getAppLogo(darkMode) {\n  const theme = getCurrentTheme();\n  const shouldUseDarkLogo = theme ? theme.darkModeDefault : darkMode;\n  return (shouldUseDarkLogo && configs.image(\"logo_dark\")) || configs.image(\"logo\");\n}\n\nexport function useLogo() {\n  const darkMode = useDarkMode();\n  return getAppLogo(darkMode);\n}\n\nexport function useThemeFromStore(store) {\n  const [themeId, setThemeId] = useState(store?.state?.preferences?.theme);\n\n  useEffect(() => {\n    function onStoreChanged() {\n      const nextThemeId = store.state?.preferences?.theme;\n\n      if (themeId !== nextThemeId) {\n        setThemeId(nextThemeId);\n      }\n    }\n\n    if (store) {\n      store.addEventListener(\"statechanged\", onStoreChanged);\n    }\n\n    return () => {\n      if (store) {\n        store.removeEventListener(\"statechanged\", onStoreChanged);\n      }\n    };\n  });\n\n  useTheme(themeId);\n}\n\nexport function ThemeProvider({ store, children }) {\n  useThemeFromStore(store);\n  return children;\n}\n\nThemeProvider.propTypes = {\n  store: PropTypes.object,\n  children: PropTypes.node\n};\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n\nexport const waitForDOMContentLoaded = function() {\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\n    return Promise.resolve(null);\n  } else {\n    return waitForEvent(\"DOMContentLoaded\", window);\n  }\n};\n\nexport const sleep = function(milliseconds) {\n  return new Promise(resolve => {\n    setTimeout(resolve, milliseconds);\n  });\n};\n","import { themes } from \"../react-components/styles/theme\";\nimport { waitForDOMContentLoaded } from \"./async-utils\";\nimport configs from \"./configs\";\n\n// Node these should be synchronized with the top of shared.scss\nconst DEFAULT_ACTION_COLOR = \"#FF3464\";\nconst DEFAULT_ACTION_COLOR_LIGHT = \"#FF74A4\";\n\nconst DEFAULT_COLORS = {\n  \"action-color\": DEFAULT_ACTION_COLOR,\n  \"action-label-color\": DEFAULT_ACTION_COLOR,\n  \"action-color-disabled\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-color-highlight\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-text-color\": \"#FFFFFF\",\n  \"action-subtitle-color\": \"#F0F0F0\",\n  \"notice-background-color\": \"#2F80ED\",\n  \"notice-text-color\": \"#FFFFFF\",\n  \"favorited-color\": \"#FFC000\",\n  \"nametag-color\": \"#000000\",\n  \"nametag-volume-color\": \"#7ED320\",\n  \"nametag-text-color\": \"#FFFFFF\",\n  \"nametag-border-color\": \"#7ED320\",\n  \"nametag-border-color-raised-hand\": \"#FFCD74\"\n};\n\nfunction getThemeColor(name) {\n  const themeId = window.APP?.store?.state?.preferences?.theme;\n\n  const theme =\n    (themeId && configs.APP_CONFIG?.theme?.themes?.find(theme => theme.id === themeId)) ||\n    configs.APP_CONFIG?.theme?.themes?.find(theme => theme.default === true);\n  if (theme?.variables?.[name]) {\n    return theme.variables[name];\n  }\n\n  return DEFAULT_COLORS[name];\n}\n\nfunction activateTheme() {\n  const actionColor = getThemeColor(\"action-color\");\n  const actionHoverColor = getThemeColor(\"action-color-highlight\");\n\n  if (document.querySelector(\"#rounded-text-button\")) {\n    // NOTE, using the object-based {} setAttribute variant in a-frame\n    // seems to not work in Firefox here -- the entities with the mixins are not\n    // updated.\n    document\n      .querySelector(\"#rounded-text-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-text-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n\n    document\n      .querySelector(\"#rounded-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n  }\n\n  window.dispatchEvent(new CustomEvent(\"update_theme\"));\n}\n\nconst onStoreChanged = (function() {\n  let themeId;\n  return function onStoreChanged() {\n    const newThemeId = window.APP?.store?.state?.preferences?.theme;\n    if (themeId !== newThemeId) {\n      themeId = newThemeId;\n      activateTheme();\n    }\n  };\n})();\n\nwaitForDOMContentLoaded().then(() => {\n  if (configs.APP_CONFIG && configs.APP_CONFIG.theme && configs.APP_CONFIG.theme[\"dark-theme\"]) {\n    document.body.classList.add(\"dark-theme\");\n  } else {\n    document.body.classList.add(\"light-theme\");\n  }\n  activateTheme();\n  window.APP?.store?.addEventListener(\"statechanged\", onStoreChanged);\n});\n\nfunction applyThemeToTextButton(el, highlighted) {\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundColor\",\n    highlighted ? getThemeColor(\"action-color-highlight\") : getThemeColor(\"action-color\")\n  );\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundHoverColor\",\n    highlighted ? \"#aaa\" : getThemeColor(\"action-color-highlight\")\n  );\n}\n\nfunction getDefaultTheme() {\n  return themes.find(t => t.default) || themes[0];\n}\n\nexport { applyThemeToTextButton, getThemeColor, getDefaultTheme };\n","// from https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\nfunction detectTouchScreen() {\n  let hasTouchScreen = false;\n  if (\"maxTouchPoints\" in navigator) {\n    hasTouchScreen = navigator.maxTouchPoints > 0;\n  } else if (\"msMaxTouchPoints\" in navigator) {\n    hasTouchScreen = navigator.msMaxTouchPoints > 0;\n  } else {\n    const mQ = window.matchMedia && matchMedia(\"(pointer:coarse)\");\n    if (mQ && mQ.media === \"(pointer:coarse)\") {\n      hasTouchScreen = !!mQ.matches;\n    } else if (\"orientation\" in window) {\n      hasTouchScreen = true; // deprecated, but good fallback\n    } else {\n      // Only as a last resort, fall back to user agent sniffing\n      const UA = navigator.userAgent;\n      hasTouchScreen =\n        /\\b(BlackBerry|webOS|iPhone|IEMobile)\\b/i.test(UA) || /\\b(Android|Windows Phone|iPad|iPod)\\b/i.test(UA);\n    }\n  }\n  return hasTouchScreen;\n}\n\nlet hackyMobileSafariTestValue = null;\n\n// HACK for https://github.com/mozilla/hubs/issues/1813\n// Touchscreen controls depend on iPad and iPhone detection,\n// which recently regressed. For UA matching \"Macintosh\", enable\n// touchscreen controls if there exists a touchscreen.\n// We cannot always enable touchscreen controls when a touchscreen\n// is present until we fix conflicts between simultaneous mouse\n// and touchscreen interactions.\nexport function hackyMobileSafariTest() {\n  if (hackyMobileSafariTestValue === null) {\n    hackyMobileSafariTestValue = /\\b(Macintosh|iPad|iPhone)\\b/i.test(navigator.userAgent) && detectTouchScreen();\n  }\n\n  return hackyMobileSafariTestValue;\n  // e.g. Match\n  // Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.1 Safari/605.1.15\n  // but not\n  // \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36\"\n}\n","import { hackyMobileSafariTest } from \"./detect-touchscreen\";\n\nconst MOBILE_RE = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i;\nconst TABLET_RE = /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;\n\nexport function isAndroid() {\n  return /Android/.test(window.navigator.userAgent);\n}\n\n// from https://stackoverflow.com/questions/57776001/how-to-detect-ipad-pro-as-ipad-using-javascript\nfunction isIpadOS() {\n  return window.navigator.maxTouchPoints && window.navigator.maxTouchPoints > 2 && /MacIntel/.test(navigator.platform);\n}\n\n// lifted from https://github.com/aframevr/aframe/blob/master/src/utils/device.js to ensure consistency\nexport function isIOS() {\n  return /iPad|iPhone|iPod/.test(window.navigator.platform) || isIpadOS();\n}\n\nfunction isTablet(mockUserAgent) {\n  const userAgent = mockUserAgent || window.navigator.userAgent;\n  return isIpadOS() || /ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(userAgent);\n}\n\nfunction isR7() {\n  return /R7 Build/.test(window.navigator.userAgent);\n}\n\nfunction isOculusBrowser() {\n  return /(OculusBrowser)/i.test(window.navigator.userAgent);\n}\n\nfunction isFirefoxReality() {\n  return /(Mobile VR)/i.test(window.navigator.userAgent);\n}\n\nexport function isMobileVR() {\n  return isOculusBrowser() || isFirefoxReality();\n}\n\nconst isMobile = (function() {\n  let _isMobile = false;\n  (function(a) {\n    // eslint-disable-next-line no-useless-escape\n    if (MOBILE_RE.test(a) || TABLET_RE.test(a.substr(0, 4))) {\n      _isMobile = true;\n    }\n    if (isIOS() || isTablet() || isR7()) {\n      _isMobile = true;\n    }\n    if (hackyMobileSafariTest()) {\n      _isMobile = true;\n    }\n    if (isMobileVR()) {\n      _isMobile = false;\n    }\n  })(window.navigator.userAgent || window.navigator.vendor || window.opera);\n\n  return function() {\n    return _isMobile;\n  };\n})();\n\nexport default isMobile;\n","import isMobile from \"./is-mobile\";\n\n/**\n * Checks if browser is mobile and not stand-alone dedicated vr device.\n * @return {Boolean} True if mobile browser detected.\n */\nAFRAME.utils.device.isMobile = isMobile;\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*,naf-dialog-adapter:*,mediasoup*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer({ forceWebVR: true });\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.getContext().getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n\nexport function getWebGLVersion(renderer) {\n  const gl = renderer.getContext();\n  return gl.getParameter(gl.VERSION).split(\" \")[1];\n}\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport defaultAvatar from \"../assets/models/DefaultAvatar.glb\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction chooseRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${chooseRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport async function fetchRandomDefaultAvatarId() {\n  const defaultAvatarEndpoint = \"/api/v1/media/search?filter=default&source=avatar_listings\";\n  const defaultAvatars = (await fetchReticulumAuthenticated(defaultAvatarEndpoint)).entries || [];\n  if (defaultAvatars.length === 0) {\n    // If reticulum doesn't return any default avatars, just default to the duck model. This should only happen\n    // when running against a fresh reticulum server, e.g. a local ret instance.\n    return new URL(defaultAvatar, location.href).href;\n  }\n  const avatarIds = defaultAvatars.map(avatar => avatar.id);\n  return chooseRandom(avatarIds);\n}\n","export const MediaDevicesEvents = Object.freeze({\n  PERMISSIONS_STATUS_CHANGED: \"permissions_status_changed\",\n  MIC_SHARE_STARTED: \"mic_share_started\",\n  MIC_SHARE_ENDED: \"mic_share_ended\",\n  VIDEO_SHARE_STARTED: \"video_share_started\",\n  VIDEO_SHARE_ENDED: \"video_share_ended\",\n  DEVICE_CHANGE: \"devicechange\"\n});\n\nexport const PermissionStatus = Object.freeze({\n  GRANTED: \"granted\",\n  DENIED: \"denied\",\n  PROMPT: \"prompt\"\n});\n\nexport const MediaDevices = Object.freeze({\n  MICROPHONE: \"microphone\",\n  SPEAKERS: \"speakers\",\n  CAMERA: \"camera\",\n  SCREEN: \"screen\"\n});\n\nexport const NO_DEVICE_ID = \"none\";\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\nimport { qsGet } from \"../utils/qs_truthy.js\";\nimport detectMobile, { isAndroid, isMobileVR } from \"../utils/is-mobile\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { fetchRandomDefaultAvatarId, generateRandomName } from \"../utils/identity.js\";\nimport { NO_DEVICE_ID } from \"../utils/media-devices-utils.js\";\nimport { getDefaultTheme } from \"../utils/theme.js\";\n\nconst defaultMaterialQuality = (function() {\n  const MATERIAL_QUALITY_OPTIONS = [\"low\", \"medium\", \"high\"];\n\n  // HACK: AFRAME is not available on all pages, so we catch the ReferenceError.\n  // We could move AFRAME's device utils into a separate package (or into this repo)\n  // if we wanted to use these checks without having to import all of AFRAME.\n  const isMobile = window.AFRAME && (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR());\n  if (isMobile) {\n    const qsMobileDefault = qsGet(\"default_mobile_material_quality\");\n    if (qsMobileDefault && MATERIAL_QUALITY_OPTIONS.indexOf(qsMobileDefault) !== -1) {\n      return qsMobileDefault;\n    }\n    return \"low\";\n  }\n\n  const qsDefault = qsGet(\"default_material_quality\");\n  if (qsDefault && MATERIAL_QUALITY_OPTIONS.indexOf(qsDefault) !== -1) {\n    return qsDefault;\n  }\n\n  return \"high\";\n})();\n\n// WebAudio on Android devices (only non-VR devices?) seems to have\n// a bug and audio can be broken if there are many people in a room.\n// We have reported the problem to the Android devs. We found that\n// using equal power panning mode can mitigate the problem so we\n// use low audio panning quality (= equal power mode) by default\n// on Android as workaround until the root issue is fixed on\n// Android end. See\n//   - https://github.com/mozilla/hubs/issues/5057\n//   - https://bugs.chromium.org/p/chromium/issues/detail?id=1308962\nconst defaultAudioPanningQuality = () => {\n  return isAndroid() && !isMobileVR() ? \"Low\" : \"High\";\n};\n\n//workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1626081 : disable echoCancellation, noiseSuppression, autoGainControl\nconst isFirefoxReality = window.AFRAME?.utils.device.isMobileVR() && navigator.userAgent.match(/Firefox/);\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z가-힣0-9_~ -]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        // personalAvatarId is obsolete, but we need it here for backwards compatibility.\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" },\n        hasOpenedShare: { type: \"boolean\" },\n        entryCount: { type: \"number\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" },\n        micMuted: { type: \"bool\" }\n      }\n    },\n\n    preferences: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        shouldPromptForRefresh: { type: \"bool\", default: false },\n        // Preferred media will be set dynamically\n        preferredMic: { type: \"string\", default: NO_DEVICE_ID },\n        preferredSpeakers: { type: \"string\", default: NO_DEVICE_ID },\n        preferredCamera: { type: \"string\", default: NO_DEVICE_ID },\n        muteMicOnEntry: { type: \"bool\", default: false },\n        disableLeftRightPanning: { type: \"bool\", default: false },\n        audioNormalization: { type: \"bool\", default: 0.0 },\n        invertTouchscreenCameraMove: { type: \"bool\", default: true },\n        enableOnScreenJoystickLeft: { type: \"bool\", default: detectMobile() },\n        enableOnScreenJoystickRight: { type: \"bool\", default: detectMobile() },\n        enableGyro: { type: \"bool\", default: true },\n        animateWaypointTransitions: { type: \"bool\", default: true },\n        showFPSCounter: { type: \"bool\", default: false },\n        allowMultipleHubsInstances: { type: \"bool\", default: false },\n        disableIdleDetection: { type: \"bool\", default: false },\n        fastRoomSwitching: { type: \"bool\", default: false },\n        lazyLoadSceneMedia: { type: \"bool\", default: false },\n        preferMobileObjectInfoPanel: { type: \"bool\", default: false },\n        // if unset, maxResolution = screen resolution\n        maxResolutionWidth: { type: \"number\", default: undefined },\n        maxResolutionHeight: { type: \"number\", default: undefined },\n        globalVoiceVolume: { type: \"number\", default: 100 },\n        globalMediaVolume: { type: \"number\", default: 100 },\n        globalSFXVolume: { type: \"number\", default: 100 },\n        snapRotationDegrees: { type: \"number\", default: 45 },\n        materialQualitySetting: { type: \"string\", default: defaultMaterialQuality },\n        enableDynamicShadows: { type: \"bool\", default: false },\n        disableSoundEffects: { type: \"bool\", default: false },\n        disableMovement: { type: \"bool\", default: false },\n        disableBackwardsMovement: { type: \"bool\", default: false },\n        disableStrafing: { type: \"bool\", default: false },\n        disableTeleporter: { type: \"bool\", default: false },\n        disableAutoPixelRatio: { type: \"bool\", default: false },\n        movementSpeedModifier: { type: \"number\", default: 1 },\n        disableEchoCancellation: { type: \"bool\", default: isFirefoxReality },\n        disableNoiseSuppression: { type: \"bool\", default: isFirefoxReality },\n        disableAutoGainControl: { type: \"bool\", default: isFirefoxReality },\n        locale: { type: \"string\", default: \"browser\" },\n        showRtcDebugPanel: { type: \"bool\", default: false },\n        showAudioDebugPanel: { type: \"bool\", default: false },\n        enableAudioClipping: { type: \"bool\", default: false },\n        audioClippingThreshold: { type: \"number\", default: 0.015 },\n        audioPanningQuality: { type: \"string\", default: defaultAudioPanningQuality() },\n        theme: { type: \"string\", default: getDefaultTheme()?.name },\n        cursorSize: { type: \"number\", default: 1 },\n        nametagVisibility: { type: \"string\", default: \"showAll\" },\n        nametagVisibilityDistance: { type: \"number\", default: 5 },\n        avatarVoiceLevels: { type: \"object\" }\n      }\n    },\n\n    // Legacy\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    confirmedBroadcastedRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    },\n\n    embedTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          embedToken: { type: \"string\" }\n        }\n      }\n    },\n\n    onLoadActions: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          action: { type: \"string\" },\n          args: { type: \"object\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    preferences: { $ref: \"#/definitions/preferences\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    this._preferences = {};\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n\n    // When storage is updated in another window\n    window.addEventListener(\"storage\", e => {\n      if (e.key !== LOCAL_STORE_KEY) return;\n      delete this[STORE_STATE_CACHE_KEY];\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    });\n\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      confirmedBroadcastedRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: [],\n      embedTokens: [],\n      onLoadActions: [],\n      preferences: {}\n    });\n\n    this._shouldResetAvatarOnInit = false;\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this._shouldResetAvatarOnInit = true;\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n\n    this._signOutOnExpiredAuthToken();\n\n    const maybeDispatchThemeChanged = (() => {\n      let previous;\n      return () => {\n        const current = this.state.preferences.theme;\n        if ((previous || current) && previous !== current) {\n          this.dispatchEvent(new CustomEvent(\"themechanged\", { detail: { current, previous } }));\n        }\n        previous = current;\n      };\n    })();\n    this.addEventListener(\"statechanged\", maybeDispatchThemeChanged);\n  }\n\n  _signOutOnExpiredAuthToken = () => {\n    if (!this.state.credentials.token) return;\n\n    const expiry = jwtDecode(this.state.credentials.token).exp * 1000;\n    if (expiry <= Date.now()) {\n      this.update({ credentials: { token: null, email: null } });\n    }\n  };\n\n  initProfile = async () => {\n    if (this._shouldResetAvatarOnInit) {\n      await this.resetToRandomDefaultAvatar();\n    } else {\n      this.update({\n        profile: { avatarId: await fetchRandomDefaultAvatarId(), ...(this.state.profile || {}) }\n      });\n    }\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomDefaultAvatar = async () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), avatarId: await fetchRandomDefaultAvatarId() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      const state = (this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY)));\n      if (!state.preferences) state.preferences = {};\n      this._preferences = { ...state.preferences }; // cache prefs without injected defaults\n      // inject default values\n      for (const [key, props] of Object.entries(SCHEMA.definitions.preferences.properties)) {\n        if (!props.hasOwnProperty(\"default\")) continue;\n        if (!state.preferences.hasOwnProperty(key)) {\n          state.preferences[key] = props.default;\n        } else if (state.preferences[key] === props.default) {\n          delete this._preferences[key];\n        }\n      }\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedBroadcastedRooms() {\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\n  }\n\n  resetTipActivityFlags() {\n    this.update({\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\n    });\n  }\n\n  bumpEntryCount() {\n    const currentEntryCount = this.state.activity.entryCount || 0;\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\n  }\n\n  // Sets a one-time action to perform the next time the page loads\n  enqueueOnLoadAction(action, args) {\n    this.update({ onLoadActions: [{ action, args }] });\n  }\n\n  executeOnLoadActions(sceneEl) {\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\n      const { action, args } = this.state.onLoadActions[i];\n\n      if (action === \"emit_scene_event\") {\n        sceneEl.emit(args.event, args.detail);\n      }\n    }\n\n    this.clearOnLoadActions();\n  }\n\n  clearOnLoadActions() {\n    this.clearStoredArray(\"onLoadActions\");\n  }\n\n  clearStoredArray(key) {\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    const update = {};\n    update[key] = [];\n\n    this.update(update, { arrayMerge: overwriteMerge });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge({ ...this.state, preferences: this._preferences }, newState, mergeOpts);\n    const { valid, errors } = validator.validate(finalState, SCHEMA);\n\n    // Cleanup unsupported properties\n    if (!valid) {\n      errors.forEach(error => {\n        console.error(`Removing invalid preference from store: ${error.message}`);\n        delete error.instance[error.argument];\n      });\n    }\n\n    if (newState.preferences) {\n      // clear preference if equal to default value so that, when client is updated with different defaults,\n      // new defaults will apply without user action\n      for (const [key, value] of Object.entries(finalState.preferences)) {\n        if (\n          SCHEMA.definitions.preferences.properties[key]?.hasOwnProperty(\"default\") &&\n          value === SCHEMA.definitions.preferences.properties[key].default\n        ) {\n          delete finalState.preferences[key];\n        }\n      }\n      this._preferences = finalState.preferences;\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    if (newState.profile !== undefined) {\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\n    }\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n\n  get schema() {\n    return SCHEMA;\n  }\n}\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\nimport configs from \"../utils/configs\";\nimport { sleep } from \"../utils/async-utils\";\n\nimport Store from \"../storage/store\";\n\nexport function hasReticulumServer() {\n  return !!configs.RETICULUM_SERVER;\n}\n\nexport function isLocalClient() {\n  return hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER;\n}\n\nexport function hubUrl(hubId, extraParams, slug) {\n  if (!hubId) {\n    if (isLocalClient()) {\n      hubId = new URLSearchParams(location.search).get(\"hub_id\");\n    } else {\n      hubId = location.pathname.split(\"/\")[1];\n    }\n  }\n\n  let url;\n  if (isLocalClient()) {\n    url = new URL(`/hub.html`, location.href);\n    url.searchParams.set(\"hub_id\", hubId);\n  } else {\n    const maybeSlug = slug ? `/${slug}` : \"\";\n    url = new URL(`/${hubId}${maybeSlug}`, location.href);\n  }\n\n  for (const key in extraParams) {\n    if (extraParams.hasOwnProperty(key)) {\n      url.searchParams.set(key, extraParams[key]);\n    }\n  }\n\n  return url;\n}\n\nconst resolverLink = document.createElement(\"a\");\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport function getReticulumFetchUrl(path, absolute = false, host = null, port = null) {\n  if (host || hasReticulumServer()) {\n    return `https://${host || configs.RETICULUM_SERVER}${port ? `:${port}` : \"\"}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nexport function getUploadsUrl(path, absolute = false, host = null, port = null) {\n  // If the Hubs Cloud stack is configured to use Cloudflare, we need to ignore the configured UPLOADS_HOST\n  // since reticulum will only serve uploads via the Cloudflare worker. BASE_ASSETS_PATH will have been\n  // correctly configured to use the Cloudflare worker, though we only need the hostname,\n  // not the full assets URL.\n  const isUsingCloudflare = configs.BASE_ASSETS_PATH.includes(\"workers.dev\");\n  const uploadsHost = isUsingCloudflare ? new URL(configs.BASE_ASSETS_PATH).hostname : configs.UPLOADS_HOST;\n  return uploadsHost\n    ? `https://${uploadsHost}${port ? `:${port}` : \"\"}${path}`\n    : getReticulumFetchUrl(path, absolute, host, port);\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nlet directReticulumHostAndPort;\n\nasync function refreshDirectReticulumHostAndPort() {\n  const qs = new URLSearchParams(location.search);\n  let host = qs.get(\"phx_host\");\n  const reticulumMeta = await getReticulumMeta();\n  host = host || configs.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\n  const port =\n    qs.get(\"phx_port\") ||\n    (hasReticulumServer() ? new URL(`${document.location.protocol}//${configs.RETICULUM_SERVER}`).port : \"443\");\n  directReticulumHostAndPort = { host, port };\n}\n\nexport function getDirectReticulumFetchUrl(path, absolute = false) {\n  if (!directReticulumHostAndPort) {\n    console.warn(\"Cannot call getDirectReticulumFetchUrl before connectToReticulum. Returning non-direct url.\");\n    return getReticulumFetchUrl(path, absolute);\n  }\n\n  const { host, port } = directReticulumHostAndPort;\n  return getReticulumFetchUrl(path, absolute, host, port);\n}\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function connectToReticulum(debug = false, params = null, socketClass = Socket) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    await refreshDirectReticulumHostAndPort();\n    const { host, port } = directReticulumHostAndPort;\n    const protocol =\n      qs.get(\"phx_protocol\") ||\n      configs.RETICULUM_SOCKET_PROTOCOL ||\n      (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n\n    return `${protocol}//${host}${port ? `:${port}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new socketClass(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: { \"content-type\": \"application/json\" },\n    method\n  };\n  if (token) {\n    params.headers.authorization = `bearer ${token}`;\n  }\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  const payload = { hub: { name: name || generateHubName() } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n\n    // Don't need to store the embed token if there's no creator assignment token, since that means\n    // we are the owner and will get the embed token on page load.\n    const embedToken = hub.embed_token;\n\n    if (embedToken) {\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\n    }\n  }\n\n  if (isLocalClient()) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceEntryForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0]) || {};\n}\n\nexport function getPresenceContextForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\n}\n\nfunction migrateBindings(oldChannel, newChannel) {\n  const doNotDuplicate = [\"phx_close\", \"phx_error\", \"phx_reply\", \"presence_state\", \"presence_diff\"];\n  const shouldDuplicate = event => {\n    return !event.startsWith(\"chan_reply_\") && !doNotDuplicate.includes(event);\n  };\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    if (shouldDuplicate(item.event)) {\n      newChannel.bindings.push(item);\n    }\n  }\n  newChannel.bindingRef = oldChannel.bindingRef;\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  migrateBindings(oldChannel, channel);\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n\nexport function migrateToChannel(oldChannel, newChannel) {\n  migrateBindings(oldChannel, newChannel);\n\n  return new Promise((resolve, reject) => {\n    newChannel\n      .join()\n      .receive(\"ok\", data => {\n        oldChannel.leave();\n        oldChannel.bindings = [];\n        resolve(data);\n      })\n      .receive(\"error\", data => {\n        newChannel.leave();\n        reject(data);\n      });\n  });\n}\n\nexport function discordBridgesForPresences(presences) {\n  const channels = [];\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.profile && m.profile.discordBridges) {\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n      }\n    }\n  }\n  return channels;\n}\n\nexport function hasEmbedPresences(presences) {\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.context && m.context.embed) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nexport function denoisePresence({ onJoin, onLeave, onChange }) {\n  return {\n    rawOnJoin: (key, beforeJoin, afterJoin) => {\n      if (beforeJoin === undefined) {\n        onJoin(key, afterJoin.metas[0]);\n      }\n    },\n    rawOnLeave: (key, remaining, removed) => {\n      if (remaining.metas.length === 0) {\n        onLeave(key, removed.metas[0]);\n      } else {\n        onChange(key, removed.metas[removed.metas.length - 1], remaining.metas[remaining.metas.length - 1]);\n      }\n    }\n  };\n}\n\nexport function presenceEventsForHub(events) {\n  const onJoin = (key, meta) => {\n    events.trigger(`hub:join`, { key, meta });\n  };\n  const onLeave = (key, meta) => {\n    events.trigger(`hub:leave`, { key, meta });\n  };\n  const onChange = (key, previous, current) => {\n    events.trigger(`hub:change`, { key, previous, current });\n  };\n  return {\n    onJoin,\n    onLeave,\n    onChange\n  };\n}\n\nexport const tryGetMatchingMeta = async ({ ret_pool, ret_version }, shouldAbandonMigration) => {\n  const backoffMS = 5000;\n  const randomMS = 15000;\n  const maxAttempts = 10;\n  let didMatchMeta = false;\n  let attempt = 0;\n  while (!didMatchMeta && attempt < maxAttempts && !shouldAbandonMigration()) {\n    try {\n      // Add randomness to the first request avoid flooding reticulum.\n      const delayMS = attempt * backoffMS + (attempt === 0 ? Math.random() * randomMS : 0);\n      console.log(\n        `[reconnect] Getting reticulum meta in ${Math.ceil(delayMS / 1000)} seconds.${\n          attempt ? ` (Attempt ${attempt + 1} of ${maxAttempts})` : \"\"\n        }`\n      );\n      await sleep(delayMS);\n      invalidateReticulumMeta();\n      console.log(`[reconnect] Getting reticulum meta.${attempt ? ` (Attempt ${attempt + 1} of ${maxAttempts})` : \"\"}`);\n      const { pool, version } = await getReticulumMeta();\n      didMatchMeta = ret_pool === pool && ret_version === version;\n    } catch {\n      didMatchMeta = false;\n    }\n\n    attempt = attempt + 1;\n  }\n  return didMatchMeta;\n};\n","export function transportForChannel(channel, reliable = true) {\n  return (clientId, dataType, data) => {\n    const payload = { dataType, data };\n\n    if (clientId) {\n      payload.clientId = clientId;\n    }\n\n    const isOpen = channel.socket.connectionState() === \"open\";\n\n    if (isOpen || reliable) {\n      const hasFirstSync =\n        payload.dataType === \"um\" ? payload.data.d.find(r => r.isFirstSync) : payload.data.isFirstSync;\n\n      if (hasFirstSync) {\n        if (isOpen) {\n          channel.push(\"naf\", payload);\n        } else {\n          // Memory is re-used, so make a copy\n          channel.push(\"naf\", AFRAME.utils.clone(payload));\n        }\n      } else {\n        // Optimization: Strip isFirstSync and send payload as a string to reduce server parsing.\n        // The server will not parse messages without isFirstSync keys when sent to the nafr event.\n        //\n        // The client must assume any payload that does not have a isFirstSync key is not a first sync.\n        const nafrPayload = AFRAME.utils.clone(payload);\n        if (nafrPayload.dataType === \"um\") {\n          for (let i = 0; i < nafrPayload.data.d.length; i++) {\n            delete nafrPayload.data.d[i].isFirstSync;\n          }\n        } else {\n          delete nafrPayload.data.isFirstSync;\n        }\n\n        channel.push(\"nafr\", { naf: JSON.stringify(nafrPayload) });\n      }\n    }\n  };\n}\n","import { defineComponent, setDefaultSize, setRemovedRecycleThreshold, Types } from \"bitecs\";\n\n// TODO this has to happen before all components are defined. Is there a better spot to be doing this?\nsetDefaultSize(10000);\nsetRemovedRecycleThreshold(0.2);\n\nexport const $isStringType = Symbol(\"isStringType\");\n\nexport const Networked = defineComponent({\n  id: Types.ui32,\n  creator: Types.ui32,\n  owner: Types.ui32,\n\n  lastOwnerTime: Types.ui32\n});\nNetworked.id[$isStringType] = true;\nNetworked.creator[$isStringType] = true;\nNetworked.owner[$isStringType] = true;\n\nexport const Owned = defineComponent();\nexport const NetworkedMediaFrame = defineComponent({\n  capturedNid: Types.ui32,\n  scale: [Types.f32, 3]\n});\nNetworkedMediaFrame.capturedNid[$isStringType] = true;\n\nexport const MediaFrame = defineComponent({\n  capturedNid: Types.ui32,\n  scale: [Types.f32, 3],\n  mediaType: Types.ui8,\n  bounds: [Types.f32, 3],\n  preview: Types.eid,\n  previewingNid: Types.eid\n});\nexport const Text = defineComponent();\nexport const Slice9 = defineComponent({\n  insets: [Types.ui32, 4],\n  size: [Types.f32, 2]\n});\n\nexport const NetworkedTransform = defineComponent({\n  position: [Types.f32, 3],\n  rotation: [Types.f32, 4],\n  scale: [Types.f32, 3]\n});\n\nexport const AEntity = defineComponent();\nexport const Object3DTag = defineComponent();\nexport const GLTFModel = defineComponent();\nexport const CursorRaycastable = defineComponent();\nexport const RemoteHoverTarget = defineComponent();\nexport const NotRemoteHoverTarget = defineComponent();\nexport const Holdable = defineComponent();\nexport const RemoveNetworkedEntityButton = defineComponent();\nexport const Interacted = defineComponent();\n\nexport const HandRight = defineComponent();\nexport const HandLeft = defineComponent();\nexport const RemoteRight = defineComponent();\nexport const RemoteLeft = defineComponent();\nexport const HoveredHandRight = defineComponent();\nexport const HoveredHandLeft = defineComponent();\nexport const HoveredRemoteRight = defineComponent();\nexport const HoveredRemoteLeft = defineComponent();\nexport const HeldHandRight = defineComponent();\nexport const HeldHandLeft = defineComponent();\nexport const HeldRemoteRight = defineComponent();\nexport const HeldRemoteLeft = defineComponent();\nexport const Held = defineComponent();\nexport const OffersRemoteConstraint = defineComponent();\nexport const HandCollisionTarget = defineComponent();\nexport const OffersHandConstraint = defineComponent();\nexport const TogglesHoveredActionSet = defineComponent();\n\nexport const HoverButton = defineComponent({ type: Types.ui8 });\nexport const TextButton = defineComponent({ labelRef: Types.eid });\nexport const HoldableButton = defineComponent();\nexport const SingleActionButton = defineComponent();\n\nexport const Pen = defineComponent();\nexport const HoverMenuChild = defineComponent();\nexport const Static = defineComponent();\nexport const Inspectable = defineComponent();\nexport const PreventAudioBoost = defineComponent();\nexport const IgnoreSpaceBubble = defineComponent();\nexport const Rigidbody = defineComponent({\n  bodyId: Types.ui16,\n  collisionGroup: Types.ui32,\n  collisionMask: Types.ui32,\n  flags: Types.ui8,\n  gravity: Types.f32\n});\nexport const PhysicsShape = defineComponent({ bodyId: Types.ui16, shapeId: Types.ui16, halfExtents: [Types.f32, 3] });\nexport const Pinnable = defineComponent();\nexport const Pinned = defineComponent();\nexport const DestroyAtExtremeDistance = defineComponent();\n\nexport const MediaLoading = defineComponent();\n\nexport const FloatyObject = defineComponent({ flags: Types.ui8, releaseGravity: Types.f32 });\nexport const MakeKinematicOnRelease = defineComponent();\n\nexport const CameraTool = defineComponent({\n  snapTime: Types.f32,\n  state: Types.ui8,\n  captureDurIdx: Types.ui8,\n  trackTarget: Types.eid,\n\n  snapMenuRef: Types.eid,\n  button_next: Types.eid,\n  button_prev: Types.eid,\n  snapRef: Types.eid,\n  cancelRef: Types.eid,\n  recVideoRef: Types.eid,\n  screenRef: Types.eid,\n  selfieScreenRef: Types.eid,\n  cameraRef: Types.eid,\n  countdownLblRef: Types.eid,\n  captureDurLblRef: Types.eid,\n  sndToggleRef: Types.eid\n});\nexport const MyCameraTool = defineComponent();\n","// Brief overview of client authorization can be found in the wiki:\n\nimport { hasComponent } from \"bitecs\";\nimport { HoldableButton } from \"../bit-components\";\n\n// https://github.com/mozilla/hubs/wiki/Hubs-authorization\nexport function showHoverEffect(el) {\n  const isFrozen = el.sceneEl.is(\"frozen\");\n  const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\n  const isSpawner = !!el.components[\"super-spawner\"];\n  const isEmojiSpawner = isSpawner && el.components[\"super-spawner\"].data.template === \"#interactable-emoji\";\n  const isEmoji = !!el.components.emoji;\n  const canMove =\n    (isEmoji || isEmojiSpawner\n      ? window.APP.hubChannel.can(\"spawn_emoji\")\n      : window.APP.hubChannel.can(\"spawn_and_move_media\")) &&\n    (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n  return (isSpawner || !isPinned || isFrozen) && canMove;\n}\n\nexport function canMove(entity) {\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n  const networkedTemplate = entity && entity.components.networked && entity.components.networked.data.template;\n  const isPen = networkedTemplate === \"#interactable-pen\";\n  const spawnerTemplate =\n    entity && entity.components[\"super-spawner\"] && entity.components[\"super-spawner\"].data.template;\n  const isEmojiSpawner = spawnerTemplate === \"#interactable-emoji\";\n  const isEmoji = !!entity.components.emoji;\n  return (\n    hasComponent(APP.world, HoldableButton, entity.eid) ||\n    ((isEmoji || isEmojiSpawner\n      ? window.APP.hubChannel.can(\"spawn_emoji\")\n      : window.APP.hubChannel.can(\"spawn_and_move_media\")) &&\n      (!isPinned || window.APP.hubChannel.can(\"pin_objects\")) &&\n      (!isPen || window.APP.hubChannel.can(\"spawn_drawing\")))\n  );\n}\n\nfunction indexForComponent(component, schema) {\n  const fullComponent = typeof component === \"string\";\n  const componentName = fullComponent ? component : component.component;\n\n  if (fullComponent) {\n    return schema.components.findIndex(schemaComponent => schemaComponent === componentName);\n  } else {\n    return schema.components.findIndex(\n      schemaComponent => schemaComponent.component === componentName && schemaComponent.property === component.property\n    );\n  }\n}\n\nlet nonAuthorizedSchemas = null;\nfunction initializeNonAuthorizedSchemas() {\n  /*\n  Takes the NAF schemas defined in network-schemas.js and produces a data structure of template name to non-authorized\n  component indices:\n  {\n    \"#interactable-media\": [\"4\", \"5\", \"6\"]\n  }\n  */\n  nonAuthorizedSchemas = {};\n  const { schemaDict } = NAF.schemas;\n  for (const template in schemaDict) {\n    if (!schemaDict.hasOwnProperty(template)) continue;\n    const schema = schemaDict[template];\n    nonAuthorizedSchemas[template] = (schema.nonAuthorizedComponents || [])\n      .map(nonAuthorizedComponent => indexForComponent(nonAuthorizedComponent, schema))\n      .map(index => index.toString());\n  }\n}\n\nfunction sanitizeMessageData(template, data) {\n  if (nonAuthorizedSchemas === null) {\n    initializeNonAuthorizedSchemas();\n  }\n  const nonAuthorizedIndices = nonAuthorizedSchemas[template];\n  for (const index in data.components) {\n    if (!data.components.hasOwnProperty(index)) continue;\n    if (!nonAuthorizedIndices.includes(index)) {\n      data.components[index] = null;\n    }\n  }\n  return data;\n}\n\nfunction authorizeEntityManipulation(entityMetadata, sender, senderPermissions) {\n  const { template, creator, isPinned } = entityMetadata;\n  const isCreator = sender === creator;\n\n  if (template.endsWith(\"-waypoint-avatar\") || template.endsWith(\"-media-frame\")) {\n    return true;\n  } else if (template.endsWith(\"-avatar\")) {\n    return isCreator;\n  } else if (template.endsWith(\"-media\")) {\n    return (!isPinned || senderPermissions.pin_objects) && (isCreator || senderPermissions.spawn_and_move_media);\n  } else if (template.endsWith(\"-camera\")) {\n    return isCreator || senderPermissions.spawn_camera;\n  } else if (template.endsWith(\"-pen\") || template.endsWith(\"-drawing\")) {\n    return isCreator || senderPermissions.spawn_drawing;\n  } else if (template.endsWith(\"-emoji\")) {\n    return isCreator || senderPermissions.spawn_emoji;\n  } else {\n    return false;\n  }\n}\n\nfunction getPendingOrExistingEntityMetadata(networkId) {\n  const pendingData = NAF.connection.adapter.getPendingDataForNetworkId(networkId);\n\n  if (pendingData) {\n    if (pendingData.owner) {\n      // If owner is no longer present, give up.\n      const presenceState = window.APP.hubChannel.presence.state[pendingData.owner];\n      if (!presenceState) return;\n    }\n\n    const { template, creator } = pendingData;\n    const schema = NAF.schemas.schemaDict[template];\n    const pinnableComponent = pendingData.components[indexForComponent(\"pinnable\", schema)];\n    const isPinned = pinnableComponent && pinnableComponent.pinned;\n    return { template, creator, isPinned };\n  }\n\n  const entity = NAF.entities.getEntity(networkId);\n  if (!entity) return null;\n\n  const { template, creator } = entity.components.networked.data;\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n  return { template, creator, isPinned };\n}\n\nfunction authorizeOrSanitizeMessageData(data, sender, senderPermissions) {\n  const entityMetadata = getPendingOrExistingEntityMetadata(data.networkId);\n  if (!entityMetadata) return false;\n\n  if (authorizeEntityManipulation(entityMetadata, sender, senderPermissions)) {\n    return true;\n  } else {\n    const { template } = entityMetadata;\n    sanitizeMessageData(template, data);\n    return true;\n  }\n}\n\n// If we receive a sync from a persistent object that we don't have an entity for yet, it must be a scene-owned object\n// (since we guarantee that pinned objects are loaded before connecting NAF).\n// Since we need to get metadata (the template id in particular) from the entity, we must stash these messages until\n// the scene has loaded.\n// Components which require this data must call applyPersistentSync after they are initialized\nconst persistentSyncs = {};\nfunction stashPersistentSync(message, entityData) {\n  if (!persistentSyncs[entityData.networkId]) {\n    persistentSyncs[entityData.networkId] = {\n      dataType: \"u\",\n      data: entityData,\n      clientId: message.clientId,\n      from_session_id: message.from_session_id\n    };\n  } else {\n    const currentData = persistentSyncs[entityData.networkId].data;\n    const currentComponents = currentData.components;\n    Object.assign(currentData, entityData);\n    currentData.components = Object.assign(currentComponents, entityData.components);\n  }\n}\n\nconst emptyObject = {};\nexport function authorizeOrSanitizeMessage(message) {\n  const { dataType, from_session_id } = message;\n\n  if (dataType === \"u\" && message.data.isFirstSync && !message.data.persistent) {\n    // The server has already authorized first sync messages that result in an instantiation.\n    return message;\n  }\n\n  const presenceState = window.APP.hubChannel.presence.state[from_session_id];\n\n  if (!presenceState) {\n    // We've received a manipulation message from a user that we don't have presence state for yet.\n    // Since we can't make a judgement about their permissions, we'll have to ignore the message.\n    return emptyObject;\n  }\n\n  const senderPermissions = presenceState.metas[0].permissions;\n\n  if (dataType === \"um\") {\n    let sanitizedAny = false;\n    let stashedAny = false;\n    for (const index in message.data.d) {\n      if (!message.data.d.hasOwnProperty(index)) continue;\n      const entityData = message.data.d[index];\n      if (entityData.persistent && !NAF.entities.getEntity(entityData.networkId)) {\n        stashPersistentSync(message, entityData);\n        message.data.d[index] = null;\n        stashedAny = true;\n      } else {\n        const authorizedOrSanitized = authorizeOrSanitizeMessageData(entityData, from_session_id, senderPermissions);\n        if (!authorizedOrSanitized) {\n          message.data.d[index] = null;\n          sanitizedAny = true;\n        }\n      }\n    }\n\n    if (sanitizedAny || stashedAny) {\n      message.data.d = message.data.d.filter(x => x != null);\n    }\n\n    return message;\n  } else if (dataType === \"u\") {\n    if (message.data.persistent && !NAF.entities.getEntity(message.data.networkId)) {\n      persistentSyncs[message.data.networkId] = message;\n      return emptyObject;\n    } else {\n      const authorizedOrSanitized = authorizeOrSanitizeMessageData(message.data, from_session_id, senderPermissions);\n      if (authorizedOrSanitized) {\n        return message;\n      } else {\n        return emptyObject;\n      }\n    }\n  } else if (dataType === \"r\") {\n    const entityMetadata = getPendingOrExistingEntityMetadata(message.data.networkId);\n    if (!entityMetadata) return emptyObject;\n    if (authorizeEntityManipulation(entityMetadata, from_session_id, senderPermissions)) {\n      return message;\n    } else {\n      return emptyObject;\n    }\n  } else {\n    // Fall through for other data types. Namely, \"drawing-<networkId>\" messages at the moment.\n    return message;\n  }\n}\n\nexport function applyPersistentSync(networkId) {\n  if (!persistentSyncs[networkId]) return;\n  NAF.connection.adapter.handleIncomingNAF(persistentSyncs[networkId]);\n  delete persistentSyncs[networkId];\n}\n","import { transportForChannel } from \"./transport-for-channel\";\nimport { authorizeOrSanitizeMessage } from \"./utils/permissions-utils\";\n\n// TODO: Use the websocket connection, not HEAD requests\nconst getTimeOffsetToServer = async () => {\n  const precision = 1000;\n  const clientSentTime = Date.now();\n  const serverReceivedTime =\n    new Date(\n      (await fetch(document.location.href, {\n        method: \"HEAD\",\n        cache: \"no-cache\"\n      })).headers.get(\"Date\")\n    ).getTime() +\n    precision / 2;\n  const clientReceivedTime = Date.now();\n  const serverTime = serverReceivedTime + (clientReceivedTime - clientSentTime) / 2;\n  const offset = serverTime - clientReceivedTime;\n  return offset;\n};\n\nconst getAverageTimeOffset = (() => {\n  let average = 0;\n  const numOffsetsToGather = 10;\n  const offsets = [];\n  let n = 0;\n\n  const update = async () => {\n    offsets[n % numOffsetsToGather] = await getTimeOffsetToServer();\n    n = n + 1;\n    average = offsets.reduce((acc, offset) => (acc += offset), 0) / offsets.length;\n    if (offsets.length == numOffsetsToGather) {\n      setTimeout(update, 5 * 60 * 1000);\n    } else {\n      update();\n    }\n  };\n\n  update();\n\n  return () => {\n    return average;\n  };\n})();\n\nexport default class PhoenixAdapter {\n  constructor() {\n    this.refs = new Map();\n    // TODO: Frozen messages can be handled outside this class.\n    this.frozenUpdates = new Map();\n    this._blockedClients = new Map();\n  }\n  setServerUrl() {}\n  setApp() {}\n  setRoom() {}\n  setWebRtcOptions() {}\n  setServerConnectListeners(nafConnectSuccess, nafConnectFailed) {\n    this.nafConnectSuccess = nafConnectSuccess;\n    this.nafConnectFailed = nafConnectFailed;\n  }\n  setRoomOccupantListener() {}\n  setDataChannelListeners(nafOccupantJoined, nafOccupantLeave, nafMessageReceived) {\n    this.nafOccupantJoined = nafOccupantJoined;\n    this.nafOccupantLeave = nafOccupantLeave;\n    this.nafMessageReceived = nafMessageReceived;\n  }\n  async connect() {\n    this.refs.set(\"naf\", this.hubChannel.channel.on(\"naf\", this.handleIncomingNAF));\n    this.refs.set(\"nafr\", this.hubChannel.channel.on(\"nafr\", this.handleIncomingNAFR));\n\n    this.nafConnectSuccess(this.session_id);\n    this.reliableTransport = transportForChannel(this.hubChannel.channel, true);\n    this.unreliableTransport = transportForChannel(this.hubChannel.channel, false);\n\n    this.hubChannel.presence.list(key => key).forEach(this.nafOccupantJoined);\n    this.refs.set(\"hub:join\", this.events.on(`hub:join`, ({ key }) => this.nafOccupantJoined(key)));\n    this.refs.set(\"hub:leave\", this.events.on(`hub:leave`, ({ key }) => this.nafOccupantLeave(key)));\n  }\n  shouldStartConnectionTo() {}\n  startStreamConnection() {}\n  closeStreamConnection() {}\n  getConnectStatus() {}\n\n  getMediaStream() {\n    return Promise.reject(\"getMediaStream not implemented in phoenix-adapter\");\n  }\n\n  getServerTime() {\n    return Date.now() + getAverageTimeOffset();\n  }\n\n  sendData(clientId, dataType, data) {\n    this.unreliableTransport(clientId, dataType, data);\n  }\n  sendDataGuaranteed(clientId, dataType, data) {\n    this.reliableTransport(clientId, dataType, data);\n  }\n  broadcastData(dataType, data) {\n    this.unreliableTransport(undefined, dataType, data);\n  }\n  broadcastDataGuaranteed(dataType, data) {\n    this.reliableTransport(undefined, dataType, data);\n  }\n\n  disconnect() {\n    this.hubChannel.presence.list(key => key).forEach(this.nafOccupantLeave);\n    this.hubChannel.channel.off(\"naf\", this.refs.get(\"naf\"));\n    this.hubChannel.channel.off(\"nafr\", this.refs.get(\"nafr\"));\n    this.events.off(\"hub:join\", this.refs.get(\"hub:join\"));\n    this.events.off(\"hub:leave\", this.refs.get(\"hub:leave\"));\n    this.refs.delete(\"naf\");\n    this.refs.delete(\"nafr\");\n    this.refs.delete(\"hub:join\");\n    this.refs.delete(\"hub:leave\");\n  }\n\n  toggleFreeze() {\n    if (this.frozen) {\n      this.unfreeze();\n    } else {\n      this.freeze();\n    }\n  }\n\n  freeze() {\n    this.frozen = true;\n  }\n\n  unfreeze() {\n    this.frozen = false;\n    this.flushPendingUpdates();\n  }\n\n  flushPendingUpdates() {\n    for (const [networkId, message] of this.frozenUpdates) {\n      const data = this.getPendingData(networkId, message);\n      if (!data) continue;\n\n      // Override the data type on \"um\" messages types, since we extract entity updates from \"um\" messages into\n      // individual frozenUpdates in storeSingleMessage.\n      const dataType = message.dataType === \"um\" ? \"u\" : message.dataType;\n\n      this.nafMessageReceived(null, dataType, data, message.source);\n    }\n    this.frozenUpdates.clear();\n  }\n\n  getPendingData(networkId, message) {\n    if (!message) return null;\n\n    const data = message.dataType === \"um\" ? this.dataForUpdateMultiMessage(networkId, message) : message.data;\n\n    // Ignore messages from users that we may have blocked while frozen.\n    if (data.owner && this._blockedClients.has(data.owner)) return null;\n\n    return data;\n  }\n\n  // Used externally\n  getPendingDataForNetworkId(networkId) {\n    return this.getPendingData(networkId, this.frozenUpdates.get(networkId));\n  }\n\n  handleIncomingNAF = data => {\n    const message = authorizeOrSanitizeMessage(data);\n    const source = \"phx-reliable\";\n    if (!message.dataType) return;\n\n    message.source = source;\n\n    if (this.frozen && (message.dataType === \"um\" || message.dataType === \"u\")) {\n      this.storeMessage(message);\n    } else {\n      this.nafMessageReceived(message.from_session_id, message.dataType, message.data, message.source);\n    }\n  };\n  handleIncomingNAFR = ({ from_session_id, naf: unparsedData }) => {\n    // Server optimization: server passes through unparsed NAF message, we must now parse it.\n    const data = JSON.parse(unparsedData);\n    data.from_session_id = from_session_id;\n    this.handleIncomingNAF(data);\n  };\n\n  storeMessage(message) {\n    if (message.dataType === \"um\") {\n      // UpdateMulti\n      for (let i = 0, l = message.data.d.length; i < l; i++) {\n        this.storeSingleMessage(message, i);\n      }\n    } else {\n      this.storeSingleMessage(message);\n    }\n  }\n\n  storeSingleMessage(message, index) {\n    const data = index !== undefined ? message.data.d[index] : message.data;\n    const dataType = message.dataType;\n\n    const networkId = data.networkId;\n\n    if (!this.frozenUpdates.has(networkId)) {\n      this.frozenUpdates.set(networkId, message);\n    } else {\n      const storedMessage = this.frozenUpdates.get(networkId);\n      const storedData =\n        storedMessage.dataType === \"um\" ? this.dataForUpdateMultiMessage(networkId, storedMessage) : storedMessage.data;\n\n      // Avoid updating components if the entity data received did not come from the current owner.\n      const isOutdatedMessage = data.lastOwnerTime < storedData.lastOwnerTime;\n      const isContemporaneousMessage = data.lastOwnerTime === storedData.lastOwnerTime;\n      if (isOutdatedMessage || (isContemporaneousMessage && storedData.owner > data.owner)) {\n        return;\n      }\n\n      if (dataType === \"r\") {\n        const createdWhileFrozen = storedData && storedData.isFirstSync;\n        if (createdWhileFrozen) {\n          // If the entity was created and deleted while frozen, don't bother conveying anything to the consumer.\n          this.frozenUpdates.delete(networkId);\n        } else {\n          // Delete messages override any other messages for this entity\n          this.frozenUpdates.set(networkId, message);\n        }\n      } else {\n        // merge in component updates\n        if (storedData.components && data.components) {\n          Object.assign(storedData.components, data.components);\n        }\n      }\n    }\n  }\n  dataForUpdateMultiMessage(networkId, message) {\n    // \"d\" is an array of entity datas, where each item in the array represents a unique entity and contains\n    // metadata for the entity, and an array of components that have been updated on the entity.\n    // This method finds the data corresponding to the given networkId.\n    for (let i = 0, l = message.data.d.length; i < l; i++) {\n      const data = message.data.d[i];\n\n      if (data.networkId === networkId) {\n        return data;\n      }\n    }\n\n    return null;\n  }\n\n  block(clientId) {\n    this._blockedClients.set(clientId, true);\n  }\n\n  unblock(clientId) {\n    this._blockedClients.delete(clientId);\n  }\n}\n\nNAF.adapters.register(\"phoenix\", PhoenixAdapter);\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","export function addAnimationComponents(modelEl) {\n  if (!modelEl.components[\"animation-mixer\"]) {\n    return;\n  }\n\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\n    modelEl.setAttribute(\"loop-animation\", \"\");\n  }\n}\n","import * as mediasoupClient from \"mediasoup-client\";\nimport protooClient from \"protoo-client\";\nimport { debug as newDebug } from \"debug\";\nimport EventEmitter from \"eventemitter3\";\nimport { MediaDevices } from \"./utils/media-devices-utils\";\n\n// Used for VP9 webcam video.\n//const VIDEO_KSVC_ENCODINGS = [{ scalabilityMode: \"S3T3_KEY\" }];\n\n// Used for VP9 desktop sharing.\n//const VIDEO_SVC_ENCODINGS = [{ scalabilityMode: \"S3T3\", dtx: true }];\n\n// TODO\n// - look into requestConsumerKeyframe\n// - look into applyNetworkThrottle\n// SFU todo\n// - remove active speaker stuff\n// - remove score stuff\n\n// Based upon mediasoup-demo RoomClient\n\nconst debug = newDebug(\"naf-dialog-adapter:debug\");\n//const warn = newDebug(\"naf-dialog-adapter:warn\");\nconst error = newDebug(\"naf-dialog-adapter:error\");\nconst info = newDebug(\"naf-dialog-adapter:info\");\n\nconst PC_PROPRIETARY_CONSTRAINTS = {\n  optional: [{ googDscp: true }]\n};\n\nconst WEBCAM_SIMULCAST_ENCODINGS = [\n  { scaleResolutionDownBy: 4, maxBitrate: 500000 },\n  { scaleResolutionDownBy: 2, maxBitrate: 1000000 },\n  { scaleResolutionDownBy: 1, maxBitrate: 5000000 }\n];\n\n// Used for simulcast screen sharing.\nconst SCREEN_SHARING_SIMULCAST_ENCODINGS = [{ dtx: true, maxBitrate: 1500000 }, { dtx: true, maxBitrate: 6000000 }];\n\nexport const DIALOG_CONNECTION_CONNECTED = \"dialog-connection-connected\";\nexport const DIALOG_CONNECTION_ERROR_FATAL = \"dialog-connection-error-fatal\";\n\nexport class DialogAdapter extends EventEmitter {\n  constructor() {\n    super();\n\n    this._micShouldBeEnabled = false;\n    this._micProducer = null;\n    this._cameraProducer = null;\n    this._shareProducer = null;\n    this._localMediaStream = null;\n    this._consumers = new Map();\n    this._pendingMediaRequests = new Map();\n    this._blockedClients = new Map();\n    this._forceTcp = false;\n    this._forceTurn = false;\n    this._iceTransportPolicy = null;\n    this.scene = null;\n    this._serverParams = {};\n    this._consumerStats = {};\n  }\n\n  get consumerStats() {\n    return this._consumerStats;\n  }\n\n  get downlinkBwe() {\n    return this._downlinkBwe;\n  }\n\n  getIceServers(host, port, turn) {\n    const iceServers = [];\n\n    this._serverUrl = `wss://${host}:${port}`;\n\n    if (turn && turn.enabled) {\n      turn.transports.forEach(ts => {\n        // Try both TURN DTLS and TCP/TLS\n        if (!this._forceTcp) {\n          iceServers.push({\n            urls: `turns:${host}:${ts.port}`,\n            username: turn.username,\n            credential: turn.credential\n          });\n        }\n\n        iceServers.push({\n          urls: `turns:${host}:${ts.port}?transport=tcp`,\n          username: turn.username,\n          credential: turn.credential\n        });\n      });\n      iceServers.push({ urls: \"stun:stun1.l.google.com:19302\" });\n    } else {\n      iceServers.push({ urls: \"stun:stun1.l.google.com:19302\" }, { urls: \"stun:stun2.l.google.com:19302\" });\n    }\n\n    return iceServers;\n  }\n\n  /**\n   * Gets transport/consumer/producer stats on the server side.\n   */\n  async getServerStats() {\n    if (!this._protoo.connected) {\n      // Signaling channel not connected, no reason to get remote RTC stats.\n      return;\n    }\n\n    const result = {};\n    try {\n      if (!this._sendTransport?._closed) {\n        const sendTransport = (result[this._sendTransport.id] = {});\n        sendTransport.name = \"Send\";\n        sendTransport.stats = await this._protoo.request(\"getTransportStats\", {\n          transportId: this._sendTransport.id\n        });\n        result[this._sendTransport.id][\"producers\"] = {};\n        for (const producer of this._sendTransport._producers) {\n          const id = producer[0];\n          result[this._sendTransport.id][\"producers\"][id] = await this._protoo.request(\"getProducerStats\", {\n            producerId: id\n          });\n        }\n      }\n      if (!this._recvTransport?._closed) {\n        const recvTransport = (result[this._recvTransport.id] = {});\n        recvTransport.name = \"Receive\";\n        recvTransport.stats = await this._protoo.request(\"getTransportStats\", {\n          transportId: this._recvTransport.id\n        });\n        result[this._recvTransport.id][\"consumers\"] = {};\n        for (const consumer of this._recvTransport._consumers) {\n          const id = consumer[0];\n          result[this._recvTransport.id][\"consumers\"][id] = await this._protoo.request(\"getConsumerStats\", {\n            consumerId: id\n          });\n        }\n      }\n      return result;\n    } catch (e) {\n      this.emitRTCEvent(\"error\", \"Adapter\", () => `Error getting the server status: ${e}`);\n      return { error: `Error getting the server status: ${e}` };\n    }\n  }\n\n  async iceRestart(transport) {\n    // Force an ICE restart to gather new candidates and trigger a reconnection\n    this.emitRTCEvent(\n      \"log\",\n      \"RTC\",\n      () => `Restarting ${transport.id === this._sendTransport.id ? \"send\" : \"receive\"} transport ICE`\n    );\n    const iceParameters = await this._protoo.request(\"restartIce\", { transportId: transport.id });\n    await transport.restartIce({ iceParameters });\n  }\n\n  async recreateSendTransport(iceServers) {\n    this.emitRTCEvent(\"log\", \"RTC\", () => `Recreating send transport ICE`);\n    await this.closeSendTransport();\n    await this.createSendTransport(iceServers);\n  }\n\n  /**\n   * Restart ICE in the underlying send peerconnection.\n   */\n  async restartSendICE() {\n    // Do not restart ICE if Signaling is disconnected.\n    if (!this._protoo || !this._protoo.connected) {\n      return;\n    }\n\n    try {\n      if (!this._sendTransport?._closed) {\n        await this.iceRestart(this._sendTransport);\n      } else {\n        // If the transport is closed but the signaling is connected, we try to recreate\n        const { host, port, turn } = this._serverParams;\n        const iceServers = this.getIceServers(host, port, turn);\n        await this.recreateSendTransport(iceServers);\n      }\n    } catch (err) {\n      this.emitRTCEvent(\"error\", \"RTC\", () => `Send transport [recreate] failed: ${err}`);\n    }\n  }\n\n  /**\n   * Checks the Send Transport ICE status and restarts it in case is in failed state.\n   * This is called by the Send Transport \"connectionstatechange\" event listener.\n   * @param {boolean} connectionState The transport connnection state (ICE connection state)\n   */\n  checkSendIceStatus(connectionState) {\n    // If the ICE connection state is failed, we force an ICE restart\n    if (connectionState === \"failed\") {\n      this.restartSendICE();\n    }\n  }\n\n  async recreateRecvTransport(iceServers) {\n    this.emitRTCEvent(\"log\", \"RTC\", () => `Recreating receive transport ICE`);\n    await this.closeRecvTransport();\n    await this.createRecvTransport(iceServers);\n    await this._protoo.request(\"refreshConsumers\");\n  }\n\n  /**\n   * Restart ICE in the underlying receive peerconnection.\n   * @param {boolean} force Forces the execution of the reconnect.\n   */\n  async restartRecvICE() {\n    if (!this._protoo || !this._protoo.connected) {\n      return;\n    }\n\n    try {\n      if (!this._recvTransport?._closed) {\n        await this.iceRestart(this._recvTransport);\n      } else {\n        // If the transport is closed but the signaling is connected, we try to recreate\n        const { host, port, turn } = this._serverParams;\n        const iceServers = this.getIceServers(host, port, turn);\n        await this.recreateRecvTransport(iceServers);\n      }\n    } catch (err) {\n      this.emitRTCEvent(\"error\", \"RTC\", () => `Receive transport [recreate] failed: ${err}`);\n    }\n  }\n\n  /**\n   * Checks the ReeceiveReeceive Transport ICE status and restarts it in case is in failed state.\n   * This is called by the Reeceive Transport \"connectionstatechange\" event listener.\n   * @param {boolean} connectionState The transport connection state (ICE connection state)\n   */\n  checkRecvIceStatus(connectionState) {\n    // If the ICE connection state is failed, we force an ICE restart\n    if (connectionState === \"failed\") {\n      this.restartRecvICE();\n    }\n  }\n\n  async connect({\n    serverUrl,\n    roomId,\n    joinToken,\n    serverParams,\n    scene,\n    clientId,\n    forceTcp,\n    forceTurn,\n    iceTransportPolicy\n  }) {\n    this._serverUrl = serverUrl;\n    this._roomId = roomId;\n    this._joinToken = joinToken;\n    this._serverParams = serverParams;\n    this._clientId = clientId;\n    this.scene = scene;\n    this._forceTcp = forceTcp;\n    this._forceTurn = forceTurn;\n    this._iceTransportPolicy = iceTransportPolicy;\n\n    const urlWithParams = new URL(this._serverUrl);\n    urlWithParams.searchParams.append(\"roomId\", this._roomId);\n    urlWithParams.searchParams.append(\"peerId\", this._clientId);\n\n    // TODO: Establishing connection could take a very long time.\n    //       Inform the user if we are stuck here.\n    const protooTransport = new protooClient.WebSocketTransport(urlWithParams.toString(), {\n      retry: { retries: 2 }\n    });\n    this._protoo = new protooClient.Peer(protooTransport);\n\n    this._protoo.on(\"disconnected\", () => {\n      this.emitRTCEvent(\"info\", \"Signaling\", () => `Disconnected`);\n      this.cleanUpLocalState();\n    });\n\n    this._protoo.on(\"failed\", attempt => {\n      this.emitRTCEvent(\"error\", \"Signaling\", () => `Failed: ${attempt}, retrying...`);\n    });\n\n    this._protoo.on(\"close\", async () => {\n      // We explicitly disconnect event handlers when closing the socket ourselves,\n      // so if we get into here, we were not the ones closing the connection.\n      this.emitRTCEvent(\"error\", \"Signaling\", () => `Closed`);\n      this._retryConnectWithNewHost();\n    });\n\n    // eslint-disable-next-line no-unused-vars\n    this._protoo.on(\"request\", async (request, accept, reject) => {\n      this.emitRTCEvent(\"info\", \"Signaling\", () => `Request [${request.method}]: ${request.data?.id}`);\n      debug('proto \"request\" event [method:%s, data:%o]', request.method, request.data?.id);\n\n      switch (request.method) {\n        case \"newConsumer\": {\n          const {\n            peerId,\n            producerId,\n            id,\n            kind,\n            rtpParameters,\n            /*type, */ appData /*, producerPaused */\n          } = request.data;\n\n          try {\n            const consumer = await this._recvTransport.consume({\n              id,\n              producerId,\n              kind,\n              rtpParameters,\n              appData: { ...appData, peerId } // Trick.\n            });\n\n            // Store in the map.\n            this._consumers.set(consumer.id, consumer);\n\n            consumer.on(\"transportclose\", () => {\n              this.emitRTCEvent(\"error\", \"RTC\", () => `Consumer transport closed`);\n              this.removeConsumer(consumer.id);\n            });\n\n            if (kind === \"video\") {\n              const { spatialLayers, temporalLayers } = mediasoupClient.parseScalabilityMode(\n                consumer.rtpParameters.encodings[0].scalabilityMode\n              );\n\n              this._consumerStats[consumer.id] = this._consumerStats[consumer.id] || {};\n              this._consumerStats[consumer.id][\"spatialLayers\"] = spatialLayers;\n              this._consumerStats[consumer.id][\"temporalLayers\"] = temporalLayers;\n            }\n\n            // We are ready. Answer the protoo request so the server will\n            // resume this Consumer (which was paused for now if video).\n            accept();\n\n            this.resolvePendingMediaRequestForTrack(peerId, consumer.track);\n\n            // Notify of an stream update event\n            this.emit(\"stream_updated\", peerId, kind);\n          } catch (err) {\n            this.emitRTCEvent(\"error\", \"Adapter\", () => `Error: ${err}`);\n            error('\"newConsumer\" request failed:%o', err);\n\n            throw err;\n          }\n\n          break;\n        }\n      }\n    });\n\n    this._protoo.on(\"notification\", notification => {\n      debug('proto \"notification\" event [method:%s, data:%o]', notification.method, notification.data);\n\n      switch (notification.method) {\n        case \"newPeer\": {\n          break;\n        }\n\n        case \"peerClosed\": {\n          const { peerId } = notification.data;\n          this.closePeer(peerId);\n\n          break;\n        }\n\n        case \"consumerClosed\": {\n          const { consumerId } = notification.data;\n          const consumer = this._consumers.get(consumerId);\n\n          if (!consumer) {\n            info(`consumerClosed event received without related consumer: ${consumerId}`);\n            break;\n          }\n\n          consumer.close();\n          this.removeConsumer(consumer.id);\n\n          break;\n        }\n\n        case \"peerBlocked\": {\n          const { peerId } = notification.data;\n          document.body.dispatchEvent(new CustomEvent(\"blocked\", { detail: { clientId: peerId } }));\n\n          break;\n        }\n\n        case \"peerUnblocked\": {\n          const { peerId } = notification.data;\n          document.body.dispatchEvent(new CustomEvent(\"unblocked\", { detail: { clientId: peerId } }));\n\n          break;\n        }\n\n        case \"downlinkBwe\": {\n          this._downlinkBwe = notification.data;\n          break;\n        }\n\n        case \"consumerLayersChanged\": {\n          const { consumerId, spatialLayer, temporalLayer } = notification.data;\n\n          const consumer = this._consumers.get(consumerId);\n\n          if (!consumer) {\n            info(`consumerLayersChanged event received without related consumer: ${consumerId}`);\n            break;\n          }\n\n          this._consumerStats[consumerId] = this._consumerStats[consumerId] || {};\n          this._consumerStats[consumerId][\"spatialLayer\"] = spatialLayer;\n          this._consumerStats[consumerId][\"temporalLayer\"] = temporalLayer;\n\n          // TODO: If spatialLayer/temporalLayer are null, that's probably because the current downlink\n          // it's not enough forany spatial layer bitrate. In that case the server has paused the consumer.\n          // At this point we it would be nice to give the user some visual cue that this stream is paused.\n          // ie. A grey overlay with some icon or replacing the video stream por a generic person image.\n          break;\n        }\n\n        case \"consumerScore\": {\n          const { consumerId, score } = notification.data;\n\n          const consumer = this._consumers.get(consumerId);\n\n          if (!consumer) {\n            info(`consumerScore event received without related consumer: ${consumerId}`);\n            break;\n          }\n\n          this._consumerStats[consumerId] = this._consumerStats[consumerId] || {};\n          this._consumerStats[consumerId][\"score\"] = score;\n        }\n      }\n    });\n\n    return new Promise((resolve, reject) => {\n      this._protoo.on(\"open\", async () => {\n        this.emitRTCEvent(\"info\", \"Signaling\", () => `Open`);\n\n        try {\n          await this._joinRoom();\n          resolve();\n          this.emit(DIALOG_CONNECTION_CONNECTED);\n        } catch (err) {\n          this.emitRTCEvent(\"warn\", \"Adapter\", () => `Error during connect: ${error}`);\n          reject(err);\n          this.emit(DIALOG_CONNECTION_ERROR_FATAL);\n        }\n      });\n    });\n  }\n\n  async _retryConnectWithNewHost() {\n    this.cleanUpLocalState();\n    this._protoo.removeAllListeners();\n    const serverParams = await APP.hubChannel.getHost();\n    const { host, port } = serverParams;\n    const newServerUrl = `wss://${host}:${port}`;\n    if (this._serverUrl === newServerUrl) {\n      console.error(\"Reconnect to dialog failed.\");\n      this.emit(DIALOG_CONNECTION_ERROR_FATAL);\n      return;\n    }\n    console.log(`The Dialog server has changed to ${newServerUrl}, reconnecting with the new server...`);\n    await this.connect({\n      serverUrl: newServerUrl,\n      roomId: this._roomId,\n      joinToken: APP.hubChannel.token,\n      serverParams,\n      scene: this.scene,\n      clientId: this._clientId,\n      forceTcp: this._forceTcp,\n      forceTurn: this._forceTurn,\n      iceTransportPolicy: this._iceTransportPolicy\n    });\n  }\n\n  closePeer(peerId) {\n    const pendingMediaRequests = this._pendingMediaRequests.get(peerId);\n\n    if (pendingMediaRequests) {\n      const msg = \"The user disconnected before the media stream was resolved.\";\n      info(msg);\n\n      if (pendingMediaRequests.audio) {\n        pendingMediaRequests.audio.resolve(null);\n      }\n\n      if (pendingMediaRequests.video) {\n        pendingMediaRequests.video.resolve(null);\n      }\n\n      this._pendingMediaRequests.delete(peerId);\n    }\n  }\n\n  resolvePendingMediaRequestForTrack(clientId, track) {\n    const requests = this._pendingMediaRequests.get(clientId);\n\n    if (requests && requests[track.kind]) {\n      const resolve = requests[track.kind].resolve;\n      delete requests[track.kind];\n      resolve(new MediaStream([track]));\n    }\n\n    if (requests && Object.keys(requests).length === 0) {\n      this._pendingMediaRequests.delete(clientId);\n    }\n  }\n\n  removeConsumer(consumerId) {\n    this.emitRTCEvent(\"info\", \"RTC\", () => `Consumer removed: ${consumerId}`);\n    this._consumers.delete(consumerId);\n  }\n\n  getMediaStream(clientId, kind = \"audio\") {\n    let track;\n\n    if (this._clientId === clientId) {\n      if (kind === \"audio\" && this._micProducer) {\n        track = this._micProducer.track;\n      } else if (kind === \"video\") {\n        if (this._cameraProducer && !this._cameraProducer.closed) {\n          track = this._cameraProducer.track;\n        } else if (this._shareProducer && !this._shareProducer.closed) {\n          track = this._shareProducer.track;\n        }\n      }\n    } else {\n      this._consumers.forEach(consumer => {\n        if (consumer.appData.peerId === clientId && kind == consumer.track.kind) {\n          track = consumer.track;\n        }\n      });\n    }\n\n    if (track) {\n      debug(`Already had ${kind} for ${clientId}`);\n      return Promise.resolve(new MediaStream([track]));\n    } else {\n      debug(`Waiting on ${kind} for ${clientId}`);\n      if (!this._pendingMediaRequests.has(clientId)) {\n        this._pendingMediaRequests.set(clientId, {});\n      }\n\n      const requests = this._pendingMediaRequests.get(clientId);\n      const promise = new Promise((resolve, reject) => (requests[kind] = { resolve, reject }));\n      requests[kind].promise = promise;\n      promise.catch(e => {\n        this.emitRTCEvent(\"error\", \"Adapter\", () => `getMediaStream error: ${e}`);\n        console.warn(`${clientId} getMediaStream Error`, e);\n      });\n      return promise;\n    }\n  }\n\n  async createSendTransport(iceServers) {\n    // Create mediasoup Transport for sending (unless we don't want to produce).\n    const sendTransportInfo = await this._protoo.request(\"createWebRtcTransport\", {\n      producing: true,\n      consuming: false,\n      sctpCapabilities: undefined\n    });\n\n    this._sendTransport = this._mediasoupDevice.createSendTransport({\n      id: sendTransportInfo.id,\n      iceParameters: sendTransportInfo.iceParameters,\n      iceCandidates: sendTransportInfo.iceCandidates,\n      dtlsParameters: sendTransportInfo.dtlsParameters,\n      sctpParameters: sendTransportInfo.sctpParameters,\n      iceServers,\n      iceTransportPolicy: this._iceTransportPolicy,\n      proprietaryConstraints: PC_PROPRIETARY_CONSTRAINTS\n    });\n\n    this._sendTransport.on(\"connect\", (\n      { dtlsParameters },\n      callback,\n      errback // eslint-disable-line no-shadow\n    ) => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [connect]`);\n      this._sendTransport.observer.on(\"close\", () => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [close]`);\n      });\n      this._sendTransport.observer.on(\"newproducer\", producer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [newproducer]: ${producer.id}`);\n      });\n      this._sendTransport.observer.on(\"newconsumer\", consumer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [newconsumer]: ${consumer.id}`);\n      });\n\n      this._protoo\n        .request(\"connectWebRtcTransport\", {\n          transportId: this._sendTransport.id,\n          dtlsParameters\n        })\n        .then(callback)\n        .catch(errback);\n    });\n\n    this._sendTransport.on(\"connectionstatechange\", connectionState => {\n      let level = \"info\";\n      if (connectionState === \"failed\" || connectionState === \"disconnected\") {\n        level = \"error\";\n      }\n      this.emitRTCEvent(level, \"RTC\", () => `Send transport [connectionstatechange]: ${connectionState}`);\n\n      this.checkSendIceStatus(connectionState);\n    });\n\n    this._sendTransport.on(\"produce\", async ({ kind, rtpParameters, appData }, callback, errback) => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [produce]: ${kind}`);\n      try {\n        // eslint-disable-next-line no-shadow\n        const { id } = await this._protoo.request(\"produce\", {\n          transportId: this._sendTransport.id,\n          kind,\n          rtpParameters,\n          appData\n        });\n\n        callback({ id });\n      } catch (error) {\n        this.emitRTCEvent(\"error\", \"Signaling\", () => `[produce] error: ${error}`);\n        errback(error);\n      }\n    });\n  }\n\n  async closeSendTransport() {\n    if (this._micProducer) {\n      this._micProducer.close();\n      this._protoo?.connected && this._protoo?.request(\"closeProducer\", { producerId: this._micProducer.id });\n      this._micProducer = null;\n    }\n\n    if (this._videoProducer) {\n      this._videoProducer.close();\n      this._protoo?.connected && this._protoo?.request(\"closeProducer\", { producerId: this._videoProducer.id });\n      this._videoProducer = null;\n    }\n\n    // TODO: If _sendTransport is falsey then return\n    const transportId = this._sendTransport?.id;\n    if (this._sendTransport && !this._sendTransport._closed) {\n      this._sendTransport.close();\n      this._sendTransport = null;\n    }\n\n    if (this._protoo?.connected) {\n      try {\n        await this._protoo.request(\"closeWebRtcTransport\", { transportId });\n      } catch (err) {\n        error(err);\n      }\n    }\n  }\n\n  async createRecvTransport(iceServers) {\n    // Create mediasoup Transport for sending (unless we don't want to consume).\n    const recvTransportInfo = await this._protoo.request(\"createWebRtcTransport\", {\n      producing: false,\n      consuming: true,\n      sctpCapabilities: undefined\n    });\n\n    this._recvTransport = this._mediasoupDevice.createRecvTransport({\n      id: recvTransportInfo.id,\n      iceParameters: recvTransportInfo.iceParameters,\n      iceCandidates: recvTransportInfo.iceCandidates,\n      dtlsParameters: recvTransportInfo.dtlsParameters,\n      sctpParameters: recvTransportInfo.sctpParameters,\n      iceServers,\n      iceTransportPolicy: this._iceTransportPolicy\n    });\n\n    this._recvTransport.on(\"connect\", (\n      { dtlsParameters },\n      callback,\n      errback // eslint-disable-line no-shadow\n    ) => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [connect]`);\n      this._recvTransport.observer.on(\"close\", () => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [close]`);\n      });\n      this._recvTransport.observer.on(\"newproducer\", producer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [newproducer]: ${producer.id}`);\n      });\n      this._recvTransport.observer.on(\"newconsumer\", consumer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [newconsumer]: ${consumer.id}`);\n      });\n\n      this._protoo\n        .request(\"connectWebRtcTransport\", {\n          transportId: this._recvTransport.id,\n          dtlsParameters\n        })\n        .then(callback)\n        .catch(errback);\n    });\n\n    this._recvTransport.on(\"connectionstatechange\", connectionState => {\n      let level = \"info\";\n      if (connectionState === \"failed\" || connectionState === \"disconnected\") {\n        level = \"error\";\n      }\n      this.emitRTCEvent(level, \"RTC\", () => `Receive transport [connectionstatechange]: ${connectionState}`);\n\n      this.checkRecvIceStatus(connectionState);\n    });\n  }\n\n  async closeRecvTransport() {\n    const transportId = this._recvTransport?.id;\n    if (this._recvTransport && !this._recvTransport._closed) {\n      this._recvTransport.close();\n      this._recvTransport = null;\n    }\n    if (this._protoo?.connected) {\n      try {\n        await this._protoo.request(\"closeWebRtcTransport\", { transportId });\n      } catch (err) {\n        error(err);\n      }\n    }\n  }\n\n  async _joinRoom() {\n    debug(\"_joinRoom()\");\n\n    this._mediasoupDevice = new mediasoupClient.Device({});\n\n    const routerRtpCapabilities = await this._protoo.request(\"getRouterRtpCapabilities\");\n\n    await this._mediasoupDevice.load({ routerRtpCapabilities });\n\n    const { host, port, turn } = this._serverParams;\n    const iceServers = this.getIceServers(host, port, turn);\n\n    await this.createSendTransport(iceServers);\n    await this.createRecvTransport(iceServers);\n\n    await this._protoo.request(\"join\", {\n      displayName: this._clientId,\n      device: this._device,\n      rtpCapabilities: this._mediasoupDevice.rtpCapabilities,\n      sctpCapabilities: this._useDataChannel ? this._mediasoupDevice.sctpCapabilities : undefined,\n      token: this._joinToken\n    });\n\n    if (this._localMediaStream) {\n      // TODO: Refactor to be \"Create producers\"\n      await this.setLocalMediaStream(this._localMediaStream);\n    }\n  }\n\n  async setLocalMediaStream(stream) {\n    if (!this._sendTransport) {\n      console.error(\"Tried to setLocalMediaStream before a _sendTransport existed\");\n      return;\n    }\n    this.emitRTCEvent(\"info\", \"RTC\", () => `Creating missing producers`);\n    let sawAudio = false;\n    let sawVideo = false;\n\n    await Promise.all(\n      stream.getTracks().map(async track => {\n        if (track.kind === \"audio\") {\n          sawAudio = true;\n\n          // TODO multiple audio tracks?\n          if (this._micProducer) {\n            if (this._micProducer.track !== track) {\n              this._micProducer.track.stop();\n              this._micProducer.replaceTrack(track);\n            }\n          } else {\n            // stopTracks = false because otherwise the track will end during a temporary disconnect\n            this._micProducer = await this._sendTransport.produce({\n              track,\n              pause: !this._micShouldBeEnabled,\n              stopTracks: false,\n              codecOptions: { opusStereo: false, opusDtx: true },\n              zeroRtpOnPause: true,\n              disableTrackOnPause: true\n            });\n\n            this._micProducer.on(\"transportclose\", () => {\n              this.emitRTCEvent(\"info\", \"RTC\", () => `Mic transport closed`);\n              this._micProducer = null;\n            });\n\n            this.emit(\"mic-state-changed\", { enabled: this.isMicEnabled });\n          }\n        } else {\n          sawVideo = true;\n\n          if (track._hubs_contentHint === MediaDevices.SCREEN) {\n            await this.disableCamera();\n            await this.enableShare(track);\n          } else if (track._hubs_contentHint === MediaDevices.CAMERA) {\n            await this.disableShare();\n            await this.enableCamera(track);\n          }\n        }\n\n        this.resolvePendingMediaRequestForTrack(this._clientId, track);\n      })\n    );\n\n    if (!sawAudio && this._micProducer) {\n      this._protoo.request(\"closeProducer\", { producerId: this._micProducer.id });\n      this._micProducer.close();\n      this._micProducer = null;\n    }\n    if (!sawVideo) {\n      this.disableCamera();\n      this.disableShare();\n    }\n    this._localMediaStream = stream;\n  }\n\n  async enableCamera(track) {\n    // stopTracks = false because otherwise the track will end during a temporary disconnect\n    this._cameraProducer = await this._sendTransport.produce({\n      track,\n      stopTracks: false,\n      codecOptions: { videoGoogleStartBitrate: 1000 },\n      encodings: WEBCAM_SIMULCAST_ENCODINGS,\n      zeroRtpOnPause: true,\n      disableTrackOnPause: true\n    });\n\n    this._cameraProducer.on(\"transportclose\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Camera transport closed`);\n      this.disableCamera();\n    });\n    this._cameraProducer.observer.on(\"trackended\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Camera track ended`);\n      this.disableCamera();\n    });\n  }\n\n  async disableCamera() {\n    if (!this._cameraProducer) return;\n\n    this._cameraProducer.close();\n\n    try {\n      if (!this._sendTransport.closed) {\n        await this._protoo.request(\"closeProducer\", { producerId: this._cameraProducer.id });\n      }\n    } catch (error) {\n      console.error(`disableCamera(): ${error}`);\n    }\n\n    this._cameraProducer = null;\n  }\n\n  async enableShare(track) {\n    // stopTracks = false because otherwise the track will end during a temporary disconnect\n    this._shareProducer = await this._sendTransport.produce({\n      track,\n      stopTracks: false,\n      codecOptions: { videoGoogleStartBitrate: 1000 },\n      encodings: SCREEN_SHARING_SIMULCAST_ENCODINGS,\n      zeroRtpOnPause: true,\n      disableTrackOnPause: true,\n      appData: {\n        share: true\n      }\n    });\n\n    this._shareProducer.on(\"transportclose\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Desktop Share transport closed`);\n      this.disableShare();\n    });\n    this._shareProducer.observer.on(\"trackended\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Desktop Share transport track ended`);\n      this.disableShare();\n    });\n  }\n\n  async disableShare() {\n    if (!this._shareProducer) return;\n\n    this._shareProducer.close();\n\n    try {\n      if (!this._sendTransport.closed) {\n        await this._protoo.request(\"closeProducer\", { producerId: this._shareProducer.id });\n      }\n    } catch (error) {\n      console.error(`disableShare(): ${error}`);\n    }\n\n    this._shareProducer = null;\n  }\n\n  toggleMicrophone() {\n    if (this.isMicEnabled) {\n      this.enableMicrophone(false);\n    } else {\n      this.enableMicrophone(true);\n    }\n  }\n\n  enableMicrophone(enabled) {\n    if (!this._micProducer) {\n      console.error(\"Tried to toggle mic but there's no producer.\");\n      return;\n    }\n\n    if (enabled && !this.isMicEnabled) {\n      this._micProducer.resume();\n      this._protoo.request(\"resumeProducer\", { producerId: this._micProducer.id });\n    } else if (!enabled && this.isMicEnabled) {\n      this._micProducer.pause();\n      this._protoo.request(\"pauseProducer\", { producerId: this._micProducer.id });\n    }\n    this._micShouldBeEnabled = enabled;\n    this.emit(\"mic-state-changed\", { enabled: this.isMicEnabled });\n  }\n\n  get isMicEnabled() {\n    return this._micProducer && !this._micProducer.paused;\n  }\n\n  cleanUpLocalState() {\n    this._sendTransport && this._sendTransport.close();\n    this._sendTransport = null;\n    this._recvTransport && this._recvTransport.close();\n    this._recvTransport = null;\n    this._micProducer = null;\n    this._shareProducer = null;\n    this._cameraProducer = null;\n  }\n\n  disconnect() {\n    debug(\"disconnect()\");\n    this.cleanUpLocalState();\n    if (this._protoo) {\n      this._protoo.removeAllListeners();\n      if (this._protoo.connected) {\n        this._protoo.close();\n        this.emitRTCEvent(\"info\", \"Signaling\", () => `[close]`);\n      }\n    }\n  }\n\n  kick(clientId) {\n    return this._protoo\n      .request(\"kick\", {\n        room_id: this.room,\n        user_id: clientId,\n        token: this._joinToken\n      })\n      .then(() => {\n        document.body.dispatchEvent(new CustomEvent(\"kicked\", { detail: { clientId: clientId } }));\n      });\n  }\n\n  block(clientId) {\n    return this._protoo.request(\"block\", { whom: clientId }).then(() => {\n      this._blockedClients.set(clientId, true);\n      document.body.dispatchEvent(new CustomEvent(\"blocked\", { detail: { clientId: clientId } }));\n    });\n  }\n\n  unblock(clientId) {\n    return this._protoo.request(\"unblock\", { whom: clientId }).then(() => {\n      this._blockedClients.delete(clientId);\n      document.body.dispatchEvent(new CustomEvent(\"unblocked\", { detail: { clientId: clientId } }));\n    });\n  }\n\n  emitRTCEvent(level, tag, msgFunc) {\n    if (!window.APP.store.state.preferences.showRtcDebugPanel) return;\n    const time = new Date().toLocaleTimeString(\"en-US\", {\n      hour12: false,\n      hour: \"numeric\",\n      minute: \"numeric\",\n      second: \"numeric\"\n    });\n    this.scene.emit(\"rtc_event\", { level, tag, time, msg: msgFunc() });\n  }\n}\n","/* global APP*/\nimport { getReticulumFetchUrl, hubUrl } from \"./utils/phoenix-utils\";\nimport { updateEnvironmentForHub, getSceneUrlForHub, updateUIForHub, remountUI } from \"./hub\";\n\nfunction unloadRoomObjects() {\n  document.querySelectorAll(\"[pinnable]\").forEach(el => {\n    if (el.components.pinnable.data.pinned) {\n      el.parentNode.removeChild(el);\n    }\n  });\n\n  // Clean up empty object.gltf nodes\n  document.querySelectorAll(\"#objects-scene .Room_Objects\").forEach(el => {\n    if (!el.children.length) {\n      el.parentNode.parentNode.removeChild(el.parentNode);\n    }\n  });\n}\n\nfunction loadRoomObjects(hubId) {\n  const objectsScene = document.querySelector(\"#objects-scene\");\n  const objectsUrl = getReticulumFetchUrl(`/${hubId}/objects.gltf`);\n  const objectsEl = document.createElement(\"a-entity\");\n  objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\n  objectsScene.appendChild(objectsEl);\n}\n\nexport async function changeHub(hubId, addToHistory = true) {\n  if (hubId === APP.hub.hub_id) {\n    console.log(\"Change hub called with the current hub id. This is a noop.\");\n    return;\n  }\n  // Suppress on-screen join and leave messages until we receive a sync.\n  APP.hideHubPresenceEvents = true;\n  const scene = AFRAME.scenes[0];\n\n  let data;\n  try {\n    data = await APP.hubChannel.migrateToHub(hubId);\n  } catch (e) {\n    console.warn(`Failed to join hub ${hubId}: ${e.reason}|${e.message}`);\n    APP.messageDispatch.log(\"joinFailed\", { message: e.message });\n    return;\n  }\n\n  const hub = data.hubs[0];\n\n  if (addToHistory) {\n    window.history.pushState(null, null, hubUrl(hubId, {}, hub.slug));\n  }\n\n  APP.hub = hub;\n  updateUIForHub(hub, APP.hubChannel);\n  scene.emit(\"hub_updated\", { hub });\n\n  APP.subscriptions.setSubscribed(data.subscriptions.web_push);\n\n  remountUI({\n    hubIsBound: data.hub_requires_oauth,\n    initialIsFavorited: data.subscriptions.favorites\n  });\n\n  NAF.entities.removeRemoteEntities();\n  await NAF.connection.adapter.disconnect();\n  await APP.dialog.disconnect();\n  unloadRoomObjects();\n  NAF.connection.connectedClients = {};\n  NAF.connection.activeDataChannels = {};\n\n  NAF.room = hub.hub_id;\n\n  if (\n    document.querySelector(\"#environment-scene\").childNodes[0].components[\"gltf-model-plus\"].data.src !==\n    (await getSceneUrlForHub(hub))\n  ) {\n    const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\n    fader.fadeOut().then(() => {\n      scene.emit(\"reset_scene\");\n      updateEnvironmentForHub(hub, APP.entryManager);\n    });\n  }\n\n  APP.retChannel.push(\"change_hub\", { hub_id: hub.hub_id });\n\n  await Promise.all([\n    APP.dialog.connect({\n      serverUrl: `wss://${hub.host}:${hub.port}`,\n      roomId: hub.hub_id,\n      joinToken: data.perms_token,\n      serverParams: { host: hub.host, port: hub.port, turn: hub.turn },\n      scene,\n      clientId: APP.dialog._clientId,\n      forceTcp: APP.dialog._forceTcp,\n      forceTurn: APP.dialog._forceTurn,\n      iceTransportPolicy: APP.dialog._iceTransportPolicy\n    }),\n\n    NAF.connection.adapter.connect()\n  ]);\n\n  loadRoomObjects(hubId);\n\n  APP.hubChannel.sendEnteredEvent();\n\n  APP.messageDispatch.receive({\n    type: \"hub_changed\",\n    hubName: hub.name,\n    showLineBreak: true\n  });\n}\nwindow.changeHub = changeHub;\n\n// TODO see if there is a better way to do this with react router\nwindow.addEventListener(\"popstate\", function() {\n  if (!APP.store.state.preferences.fastRoomSwitching) return;\n  const qs = new URLSearchParams(location.search);\n  const newHubId = qs.get(\"hub_id\") || document.location.pathname.substring(1).split(\"/\")[0];\n  if (newHubId !== APP.hub.hub_id) {\n    changeHub(newHubId, false);\n  }\n});\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\n\nconst components = [];\nexport class AnimationMixerSystem {\n  tick(dt) {\n    for (let i = 0; i < components.length; i++) {\n      const cmp = components[i];\n      if (cmp.mixer) {\n        cmp.mixer.update(dt / 1000);\n      }\n    }\n  }\n}\n\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n  play() {\n    components.push(this);\n  },\n  pause() {\n    components.splice(components.indexOf(this), 1);\n  }\n});\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n\nexport function findComponentsInNearestAncestor(entity, componentName) {\n  const components = [];\n  while (entity) {\n    if (entity.components) {\n      for (const c in entity.components) {\n        if (entity.components[c].name === componentName) {\n          components.push(entity.components[c]);\n        }\n      }\n    }\n    if (components.length) {\n      return components;\n    }\n    entity = entity.parentNode;\n  }\n  return components;\n}\n","export function easeOutQuadratic(t) {\n  return t * (2 - t);\n}\n// Adapted from\n// https://github.com/d3/d3-ease/blob/master/src/elastic.js#L18\nexport const elasticOut = (function() {\n  const tau = 2 * Math.PI,\n    a = 1,\n    p = 0.3 / tau,\n    s = Math.asin(1) * p;\n  return function elasticOut(t) {\n    return 1 - a * Math.pow(2, -10 * (t = +t)) * Math.sin((t + s) / p);\n  };\n})();\n","// Provides a global registry of running components\nexport function registerComponentInstance(component, name) {\n  window.APP.componentRegistry = window.APP.componentRegistry || {};\n  window.APP.componentRegistry[name] = window.APP.componentRegistry[name] || [];\n  window.APP.componentRegistry[name].push(component);\n}\n\nexport function deregisterComponentInstance(component, name) {\n  if (!window.APP.componentRegistry || !window.APP.componentRegistry[name]) return;\n  window.APP.componentRegistry[name].splice(window.APP.componentRegistry[name].indexOf(component), 1);\n}\n\nexport function getCurrentStreamer() {\n  if (!window.APP || !window.APP.componentRegistry || !window.APP.hubChannel || !window.APP.hubChannel.presence)\n    return null;\n  const playerInfos = window.APP.componentRegistry[\"player-info\"] || [];\n  const presences = window.APP.hubChannel.presence.state;\n\n  for (let i = 0; i < playerInfos.length; i++) {\n    const playerInfo = playerInfos[i];\n    const presence = presences[playerInfo.playerSessionId];\n\n    if (presence && presence.metas[0] && presence.metas[0].streaming) {\n      return playerInfo;\n    }\n  }\n\n  return null;\n}\n\nexport function getPlayerInfo(sessionId) {\n  const playerInfos = window.APP?.componentRegistry[\"player-info\"] || [];\n  return playerInfos.find(info => {\n    return info.playerSessionId === sessionId;\n  });\n}\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { easeOutQuadratic } from \"../utils/easing\";\nimport { registerComponentInstance, deregisterComponentInstance } from \"../utils/component-utils\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\n\n// This computation is expensive, so we run on at most one avatar per frame, including quiet avatars.\n// However if we detect an avatar is seen speaking (its volume is above DISABLE_AT_VOLUME_THRESHOLD)\n// then we continue analysis for at least DISABLE_GRACE_PERIOD_MS and disable doing it every frame if\n// the avatar is quiet during that entire duration (eg they are muted)\nconst DISABLE_AT_VOLUME_THRESHOLD = 0.00001;\nconst DISABLE_GRACE_PERIOD_MS = 10000;\nconst IS_TALKING_THRESHOLD_MS = 1000;\nconst MIN_VOLUME_THRESHOLD = 0.08;\n\nconst calculateVolume = (analyser, levels) => {\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n  analyser.getByteTimeDomainData(levels);\n  let sum = 0;\n  for (let i = 0; i < levels.length; i++) {\n    const amplitude = (levels[i] - 128) / 128;\n    sum += amplitude * amplitude;\n  }\n  const currVolume = Math.sqrt(sum / levels.length);\n  return currVolume;\n};\n\nfunction updateVolume(component) {\n  const newRawVolume = calculateVolume(component.analyser, component.levels);\n\n  const newPerceivedVolume = Math.log(THREE.MathUtils.mapLinear(newRawVolume, 0, 1, 1, Math.E));\n\n  component.volume = newPerceivedVolume < MIN_VOLUME_THRESHOLD ? 0 : newPerceivedVolume;\n\n  const s = component.volume > component.prevVolume ? 0.35 : 0.3;\n  component.volume = s * component.volume + (1 - s) * component.prevVolume;\n  component.prevVolume = component.volume;\n}\n\n/**\n * Updates a `volume` property based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.disableUpdates = true;\n    this.avatarIsTalking = false;\n\n    this._updateAnalysis = this._updateAnalysis.bind(this);\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"audio-analyser\");\n    this.el.addEventListener(\n      \"sound-source-set\",\n      event => {\n        const ctx = THREE.AudioContext.getContext();\n        this.analyser = ctx.createAnalyser();\n        this.analyser.fftSize = 32;\n        this.levels = new Uint8Array(this.analyser.fftSize);\n        event.detail.soundSource.connect(this.analyser);\n      },\n      { once: true }\n    );\n\n    this.playerSessionId = findAncestorWithComponent(this.el, \"player-info\").components[\"player-info\"].playerSessionId;\n    registerComponentInstance(this, \"networked-audio-analyser\");\n  },\n\n  remove: function() {\n    deregisterComponentInstance(this, \"networked-audio-analyser\");\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"audio-analyser\");\n  },\n\n  tick: function(t) {\n    if (!this.disableUpdates) {\n      this._updateAnalysis(t);\n    }\n  },\n\n  _runScheduledWork: function() {\n    if (this.disableUpdates) {\n      this._updateAnalysis();\n    }\n  },\n\n  // Updates the analysis/volume. If t is passed, that implies this is called via tick\n  // and so as a performance optimization will check to see if it's been at least DISABLE_GRACE_PERIOD_MS\n  // since the last volume was seen above DISABLE_AT_VOLUME_THRESHOLD, and if so, will disable\n  // tick updates until the volume exceeds the level again.\n  _updateAnalysis: function(t) {\n    if (!this.analyser) return;\n\n    updateVolume(this);\n\n    if (this.volume < DISABLE_AT_VOLUME_THRESHOLD) {\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - DISABLE_GRACE_PERIOD_MS) {\n        this.disableUpdates = true;\n      }\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - IS_TALKING_THRESHOLD_MS) {\n        this.avatarIsTalking = false;\n      }\n    } else {\n      if (t) {\n        this.lastSeenVolume = t;\n      }\n\n      this.disableUpdates = false;\n      this.avatarIsTalking = true;\n    }\n  }\n});\n\nfunction getAnalyser(el) {\n  // Is this the local player\n  const ikRootEl = findAncestorWithComponent(el, \"ik-root\");\n  if (ikRootEl && ikRootEl.id === \"avatar-rig\") {\n    return el.sceneEl.systems[\"local-audio-analyser\"];\n  } else {\n    const analyserEl = findAncestorWithComponent(el, \"networked-audio-analyser\");\n    if (!analyserEl) return null;\n    return analyserEl.components[\"networked-audio-analyser\"];\n  }\n}\n\n/**\n * Calculates volume of the local audio stream.\n */\nAFRAME.registerSystem(\"local-audio-analyser\", {\n  init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n\n    this.onMicEnabled = this.onMicEnabled.bind(this);\n    this.el.addEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, this.onMicEnabled);\n  },\n\n  remove() {\n    this.el.removeEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, this.onMicEnabled);\n  },\n\n  onMicEnabled() {\n    const audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n    this.analyser = audioSystem.outboundAnalyser;\n    this.levels = audioSystem.analyserLevels;\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // TODO Ideally, when muted no audio should ever even make it into the analyser to begin with\n    if (APP.dialog.isMicEnabled) {\n      updateVolume(this);\n    } else {\n      this.prevVolume = this.volume;\n      this.volume = 0;\n    }\n  }\n});\n\n/**\n * Sets an entity's scale base on the volume of an audio-analyser in a parent entity.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 1.5 }\n  },\n\n  async init() {\n    await waitForDOMContentLoaded();\n    this.cameraEl = document.getElementById(\"viewing-camera\");\n  },\n\n  tick() {\n    if (!this.cameraEl) return;\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\n\n    this.el.object3D.scale.setScalar(\n      THREE.MathUtils.mapLinear(this.analyser?.volume || 0, 0, 1, this.data.minScale, this.data.maxScale)\n    );\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n\n/**\n * Animates a morph target based on an audio-analyser in a parent entity\n * @namespace avatar\n * @component morph-audio-feedback\n */\nAFRAME.registerComponent(\"morph-audio-feedback\", {\n  schema: {\n    name: { default: \"\" },\n    minValue: { default: 0 },\n    maxValue: { default: 2 }\n  },\n\n  init() {\n    const meshes = [];\n    if (this.el.object3DMap.skinnedmesh) {\n      meshes.push(this.el.object3DMap.skinnedmesh);\n    } else if (this.el.object3DMap.group) {\n      // skinned mesh with multiple materials\n      this.el.object3DMap.group.traverse(o => o.isSkinnedMesh && meshes.push(o));\n    }\n    if (meshes.length) {\n      this.morphs = meshes\n        .map(mesh => ({ mesh, morphNumber: mesh.morphTargetDictionary[this.data.name] }))\n        .filter(m => m.morphNumber !== undefined);\n    }\n  },\n\n  tick() {\n    if (!this.morphs || !this.morphs.length) return;\n\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\n\n    const { minValue, maxValue } = this.data;\n    const morphValue = THREE.MathUtils.mapLinear(\n      easeOutQuadratic(this.analyser ? this.analyser.volume : 0),\n      0,\n      1,\n      minValue,\n      maxValue\n    );\n    for (let i = 0; i < this.morphs.length; i++) {\n      this.morphs[i].mesh.morphTargetInfluences[this.morphs[i].morphNumber] = morphValue;\n    }\n  }\n});\n\nconst SPRITE_NAMES = {\n  MIC: [\"mic-0.png\", \"mic-1.png\", \"mic-2.png\", \"mic-3.png\", \"mic-4.png\", \"mic-5.png\", \"mic-6.png\", \"mic-7.png\"],\n  MIC_HOVER: [\n    \"mic-0_hover.png\",\n    \"mic-1_hover.png\",\n    \"mic-2_hover.png\",\n    \"mic-3_hover.png\",\n    \"mic-4_hover.png\",\n    \"mic-5_hover.png\",\n    \"mic-6_hover.png\",\n    \"mic-7_hover.png\"\n  ],\n  MIC_OFF: [\n    \"mic-off-0.png\",\n    \"mic-off-1.png\",\n    \"mic-off-2.png\",\n    \"mic-off-3.png\",\n    \"mic-off-4.png\",\n    \"mic-off-5.png\",\n    \"mic-off-6.png\",\n    \"mic-off-7.png\"\n  ],\n  MIC_OFF_HOVER: [\n    \"mic-off-0_hover.png\",\n    \"mic-off-1_hover.png\",\n    \"mic-off-2_hover.png\",\n    \"mic-off-3_hover.png\",\n    \"mic-off-4_hover.png\",\n    \"mic-off-5_hover.png\",\n    \"mic-off-6_hover.png\",\n    \"mic-off-7_hover.png\"\n  ]\n};\n\nexport function micLevelForVolume(volume) {\n  return THREE.MathUtils.clamp(Math.ceil(THREE.MathUtils.mapLinear(volume - 0.05, 0, 1, 0, 7)), 0, 7);\n}\n\nAFRAME.registerComponent(\"mic-button\", {\n  schema: {\n    active: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.prevSpriteName = \"\";\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.hovering = false;\n    this.onHover = () => {\n      this.hovering = true;\n      this.data.tooltip.setAttribute(\"visible\", true);\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.data.tooltip.setAttribute(\"visible\", false);\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    if (this.data.tooltip) {\n      this.textEl = this.data.tooltip.querySelector(\"[text]\");\n    }\n  },\n\n  tick() {\n    const audioAnalyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\n    const active = this.data.active;\n    const hovering = this.hovering;\n    const spriteNames =\n      SPRITE_NAMES[active ? (hovering ? \"MIC_HOVER\" : \"MIC\") : hovering ? \"MIC_OFF_HOVER\" : \"MIC_OFF\"];\n    const level = micLevelForVolume(audioAnalyser.volume);\n    const spriteName = spriteNames[level];\n    if (spriteName !== this.prevSpriteName) {\n      this.prevSpriteName = spriteName;\n      this.el.setAttribute(\"sprite\", \"name\", spriteName);\n    }\n\n    if (this.data.tooltip && hovering) {\n      this.textEl = this.textEl || this.data.tooltip.querySelector(\"[text]\");\n      this.textEl.setAttribute(\"text\", \"value\", active ? this.data.activeTooltipText : this.data.tooltipText);\n    }\n  }\n});\n","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"application/vnd.apple.mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"application/x-mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\nconst srcSuffixLookupMap = {\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.toLowerCase().startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  if (src) {\n    for (const suffix in srcSuffixLookupMap) {\n      if (src.toLowerCase().endsWith(suffix)) {\n        const types = srcSuffixLookupMap[suffix];\n        return objectTypeForOrigin(contentOrigin, ...types);\n      }\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","export default \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n  float ratio = 0.0;\\n  float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\";","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function updateMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material = object3D.material.map(fn);\n  } else {\n    object3D.material = fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return [];\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return [fn(object3D.material)];\n  }\n}\n\n// HubsMeshBasicMaterial exists because we need to be able to set the emissiveMap in the avatar preview.\n// It also allows the material to be properly copied/cloned.\nclass HubsMeshBasicMaterial extends THREE.MeshBasicMaterial {\n  static fromMeshStandardMaterial(source) {\n    const material = new HubsMeshBasicMaterial();\n\n    THREE.Material.prototype.copy.call(material, source);\n\n    material.color.copy(source.color);\n\n    material.emissive.copy(source.emissive);\n    material.emissiveIntensity = source.emissiveIntensity;\n    material.emissiveMap = source.emissiveMap;\n\n    material.map = source.map;\n\n    material.lightMap = source.lightMap;\n    // See https://github.com/mrdoob/three.js/pull/23613 for \"* Math.PI\"\n    material.lightMapIntensity = source.lightMapIntensity * Math.PI;\n\n    material.aoMap = source.aoMap;\n    material.aoMapIntensity = source.aoMapIntensity;\n\n    material.alphaMap = source.alphaMap;\n\n    material.wireframe = source.wireframe;\n    material.wireframeLinewidth = source.wireframeLinewidth;\n    material.wireframeLinecap = source.wireframeLinecap;\n    material.wireframeLinejoin = source.wireframeLinejoin;\n\n    return material;\n  }\n\n  constructor({ emissive, emissiveMap, emissiveIntensity, ...rest } = {}) {\n    super(rest);\n    this._emissive = { value: emissive || new THREE.Color() };\n    this._emissiveIntensity = { value: emissiveIntensity === undefined ? 1 : emissiveIntensity };\n    this._emissiveMap = { value: emissiveMap };\n  }\n\n  get emissive() {\n    return this._emissive.value;\n  }\n\n  set emissive(emissive) {\n    this._emissive.value = emissive;\n  }\n\n  get emissiveIntensity() {\n    return this._emissiveIntensity.value;\n  }\n\n  set emissiveIntensity(emissiveIntensity) {\n    this._emissiveIntensity.value = emissiveIntensity;\n  }\n\n  get emissiveMap() {\n    return this._emissiveMap.value;\n  }\n\n  set emissiveMap(emissiveMap) {\n    this._emissiveMap.value = emissiveMap;\n  }\n\n  copy(source) {\n    super.copy(source);\n    this.emissive.copy(source.emissive);\n    this.emissiveIntensity = source.emissiveIntensity;\n    this.emissiveMap = source.emissiveMap;\n    return this;\n  }\n\n  onBeforeCompile = shader => {\n    // This patch to the MeshBasicMaterial adds support for emissive maps.\n    shader.uniforms.emissive = this._emissive;\n    shader.uniforms.emissiveIntensity = this._emissiveIntensity;\n    shader.uniforms.emissiveMap = this._emissiveMap;\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <lightmap_pars_fragment>\",\n      `#include <lightmap_pars_fragment>\n      uniform vec3 emissive;\n      uniform sampler2D emissiveMap;\n      `\n    );\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <envmap_fragment>\",\n      `#include <envmap_fragment>\n\n      vec3 totalEmissiveRadiance = emissive;\n      #include <emissivemap_fragment>\n      outgoingLight += totalEmissiveRadiance;\n\n      `\n    );\n  };\n}\n\nclass HubsMeshPhongMaterial extends THREE.MeshPhongMaterial {\n  static fromMeshStandardMaterial(source) {\n    const material = new HubsMeshPhongMaterial();\n\n    THREE.Material.prototype.copy.call(material, source);\n\n    material.color.copy(source.color);\n\n    material.map = source.map;\n\n    material.lightMap = source.lightMap;\n    material.lightMapIntensity = source.lightMapIntensity;\n\n    material.aoMap = source.aoMap;\n    material.aoMapIntensity = source.aoMapIntensity;\n\n    material.emissive.copy(source.emissive);\n    material.emissiveMap = source.emissiveMap;\n    material.emissiveIntensity = source.emissiveIntensity;\n\n    material.normalMapType = source.normalMapType;\n    material.normalMap = source.normalMap;\n    material.normalScale.copy(source.normalScale);\n\n    material.bumpMap = source.bumpMap;\n    material.bumpScale = source.bumpScale;\n\n    material.displacementMap = source.displacementMap;\n    material.displacementScale = source.displacementScale;\n    material.displacementBias = source.displacementBias;\n\n    material.alphaMap = source.alphaMap;\n\n    material.reflectivity = 0.5;\n    material.refractionRatio = source.refractionRatio;\n\n    material.wireframe = source.wireframe;\n    material.wireframeLinewidth = source.wireframeLinewidth;\n    material.wireframeLinecap = source.wireframeLinecap;\n    material.wireframeLinejoin = source.wireframeLinejoin;\n\n    return material;\n  }\n\n  onBeforeCompile = shader => {\n    // This patch to MeshPhongMaterial adds support for tangent space normal maps.\n    shader.vertexShader = shader.vertexShader.replace(\n      \"varying vec3 vNormal;\",\n      `varying vec3 vNormal;\n      #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n      #endif\n      `\n    );\n    shader.vertexShader = shader.vertexShader.replace(\n      \"vNormal = normalize( transformedNormal );\",\n      `vNormal = normalize( transformedNormal );\n      \n        #ifdef USE_TANGENT\n      \n          vTangent = normalize( transformedTangent );\n          vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n      \n        #endif\n      `\n    );\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <lights_phong_pars_fragment>\",\n      `#include <lights_phong_pars_fragment>\n      #ifndef FLAT_SHADED\n\n        #ifdef USE_TANGENT\n          varying vec3 vTangent;\n          varying vec3 vBitangent;\n        #endif\n\n      #endif\n      `\n    );\n  };\n}\n\nexport function convertStandardMaterial(source, quality) {\n  if (!source.isMeshStandardMaterial) {\n    return source;\n  }\n\n  if (quality === \"medium\") {\n    return HubsMeshPhongMaterial.fromMeshStandardMaterial(source);\n  } else if (quality === \"low\") {\n    return HubsMeshBasicMaterial.fromMeshStandardMaterial(source);\n  }\n\n  return source;\n}\n\nexport function disposeTexture(texture) {\n  if (texture.dash) {\n    texture.dash.reset();\n  }\n\n  if (texture.image instanceof HTMLVideoElement) {\n    const video = texture.image;\n    video.pause();\n    video.src = \"\";\n    video.load();\n  }\n\n  if (texture.hls) {\n    texture.hls.stopLoad();\n    texture.hls.detachMedia();\n    texture.hls.destroy();\n    texture.hls = null;\n  }\n\n  texture.dispose();\n}\n","import { isIOS as detectIOS } from \"../utils/is-mobile\";\n\nconst isIOS = detectIOS();\n\n// Disable ImageBitmap for Firefox so far because\n// createImageBitmap() with option fails on Firefox due to the bug.\n// Three.js ImageBitmapLoader passes {colorSpaceConversion: 'none'} option.\n// Without the option, the rendering result can be wrong if image file has ICC profiles.\n// See https://github.com/mrdoob/three.js/pull/21336\nconst HAS_IMAGE_BITMAP =\n  window.createImageBitmap !== undefined && /Firefox/.test(navigator.userAgent) === false && !isIOS;\nexport const TEXTURES_FLIP_Y = !HAS_IMAGE_BITMAP;\n\n// Browsers on iOS devices can crash if huge or many textures are used in a room.\n// Perhaps huge VRAM usage may cause it. We already reported it to the webkit devs.\n// Until the root issue is fixed on iOS end, we resize huge texture images in the\n// low material quality mode as workaround. It isn't a perfect solution but it\n// should mitigate the problem. Also disable image bitmap (See the above)\n// because huge textures resize + image bitmap can still even crash browsers.\n//\n// See\n//   - https://github.com/mozilla/hubs/issues/5295\n//   - https://bugs.webkit.org/show_bug.cgi?id=241478\n\nconst IOS_TEXTURE_MAX_WIDTH = 2048;\nconst IOS_TEXTURE_MAX_HEIGHT = 2048;\n\nfunction resizeIfNeeded(texture) {\n  if (!isIOS || window.APP.store.state.preferences.materialQualitySetting !== \"low\") {\n    return texture;\n  }\n\n  const image = texture.image;\n\n  // Just in case.\n  if (!image || image.width === undefined || image.height === undefined) {\n    return texture;\n  }\n\n  if (image.width <= IOS_TEXTURE_MAX_WIDTH && image.height <= IOS_TEXTURE_MAX_HEIGHT) {\n    return texture;\n  }\n\n  const conversionRatio = Math.min(IOS_TEXTURE_MAX_WIDTH / image.width, IOS_TEXTURE_MAX_HEIGHT / image.height);\n\n  const newWidth = Math.round(image.width * conversionRatio);\n  const newHeight = Math.round(image.height * conversionRatio);\n\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = newWidth;\n  canvas.height = newHeight;\n  const context = canvas.getContext(\"2d\");\n  context.drawImage(image, 0, 0, newWidth, newHeight);\n\n  texture.image = canvas;\n\n  if (image.close !== undefined) {\n    image.close();\n  }\n\n  texture.format = THREE.RGBAFormat;\n  texture.type = THREE.UnsignedByteType;\n  return texture;\n}\n\nexport default class HubsTextureLoader extends THREE.TextureLoader {\n  constructor(manager) {\n    super(manager);\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const callback = texture => {\n      resizeIfNeeded(texture);\n      if (onLoad) {\n        onLoad(texture);\n      }\n    };\n\n    const texture = HAS_IMAGE_BITMAP\n      ? this._loadImageBitmapTexture(url, callback, onProgress, onError)\n      : super.load(url, callback, onProgress, onError);\n\n    texture.onUpdate = function() {\n      // Delete texture data once it has been uploaded to the GPU\n      texture.image.close && texture.image.close();\n      texture.image = null;\n    };\n\n    return texture;\n  }\n\n  async loadAsync(url, onProgress) {\n    return new Promise((resolve, reject) => {\n      this.load(url, resolve, onProgress, reject);\n    });\n  }\n\n  _loadImageBitmapTexture(url, onLoad, onProgress, onError) {\n    const texture = new THREE.Texture();\n    const loader = new THREE.ImageBitmapLoader(this.manager);\n    loader.setCrossOrigin(this.crossOrigin);\n    loader.setPath(this.path);\n\n    loader.load(\n      url,\n      bitmap => {\n        texture.image = bitmap;\n        texture.needsUpdate = true;\n\n        // We close the image bitmap when it's uploaded to texture.\n        // Closed image bitmap can't be reused so we remove the cache\n        // added in ImageBitmapLoader.\n        // You can remove this line once we entirely disable THREE.Cache.\n        THREE.Cache.remove(this.manager.resolveURL(url));\n\n        if (onLoad !== undefined) {\n          onLoad(texture);\n        }\n      },\n      onProgress,\n      onError\n    );\n\n    texture.flipY = false;\n    return texture;\n  }\n}\n","import { showHoverEffect } from \"../utils/permissions-utils\";\n\nconst interactorOneTransform = [];\nconst interactorTwoTransform = [];\n\nexport const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MeshPhongMaterial\"];\n/**\n * Applies effects to a hoverable based on hover state.\n * @namespace interactables\n * @component hoverable-visuals\n */\nAFRAME.registerComponent(\"hoverable-visuals\", {\n  schema: {\n    enableSweepingEffect: { type: \"boolean\", default: true }\n  },\n  init() {\n    // uniforms and boundingSphere are set from the component responsible for loading the mesh.\n    this.uniforms = null;\n    this.geometryRadius = 0;\n\n    this.sweepParams = [0, 0];\n  },\n  remove() {\n    this.uniforms = null;\n    this.boundingBox = null;\n\n    const isMobile = AFRAME.utils.device.isMobile();\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\n    this.isTouchscreen = isMobile && !isMobileVR;\n  },\n  tick(time) {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const showEffect = showHoverEffect(this.el);\n    const toggling = this.el.sceneEl.systems[\"hubs-systems\"].cursorTogglingSystem;\n\n    let interactorOne, interactorTwo;\n    const interaction = this.el.sceneEl.systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    if (interaction.state.leftHand.hovered === this.el && !interaction.state.leftHand.held) {\n      interactorOne = interaction.options.leftHand.entity.object3D;\n    }\n    if (\n      interaction.state.leftRemote.hovered === this.el &&\n      !interaction.state.leftRemote.held &&\n      !toggling.leftToggledOff\n    ) {\n      interactorOne = interaction.options.leftRemote.entity.object3D;\n    }\n    if (\n      interaction.state.rightRemote.hovered === this.el &&\n      !interaction.state.rightRemote.held &&\n      !toggling.rightToggledOff\n    ) {\n      interactorTwo = interaction.options.rightRemote.entity.object3D;\n    }\n    if (interaction.state.rightHand.hovered === this.el && !interaction.state.rightHand.held) {\n      interactorTwo = interaction.options.rightHand.entity.object3D;\n    }\n\n    if (interactorOne) {\n      interactorOne.matrixWorld.toArray(interactorOneTransform);\n    }\n    if (interactorTwo) {\n      interactorTwo.matrixWorld.toArray(interactorTwoTransform);\n    }\n\n    if (interactorOne || interactorTwo || isFrozen) {\n      const worldY = this.el.object3D.matrixWorld.elements[13];\n      const ms1 = this.el.object3D.matrixWorld.elements[4];\n      const ms2 = this.el.object3D.matrixWorld.elements[5];\n      const ms3 = this.el.object3D.matrixWorld.elements[6];\n      const worldScale = Math.sqrt(ms1 * ms1 + ms2 * ms2 + ms3 * ms3);\n      const scaledRadius = worldScale * this.geometryRadius;\n      this.sweepParams[0] = worldY - scaledRadius;\n      this.sweepParams[1] = worldY + scaledRadius;\n    }\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_EnableSweepingEffect.value = this.data.enableSweepingEffect && showEffect;\n      uniform.hubs_IsFrozen.value = isFrozen;\n      uniform.hubs_SweepParams.value = this.sweepParams;\n\n      uniform.hubs_HighlightInteractorOne.value = !!interactorOne && showEffect && !this.isTouchscreen;\n      uniform.hubs_InteractorOnePos.value[0] = interactorOneTransform[12];\n      uniform.hubs_InteractorOnePos.value[1] = interactorOneTransform[13];\n      uniform.hubs_InteractorOnePos.value[2] = interactorOneTransform[14];\n\n      uniform.hubs_HighlightInteractorTwo.value = !!interactorTwo && showEffect && !this.isTouchscreen;\n      uniform.hubs_InteractorTwoPos.value[0] = interactorTwoTransform[12];\n      uniform.hubs_InteractorTwoPos.value[1] = interactorTwoTransform[13];\n      uniform.hubs_InteractorTwoPos.value[2] = interactorTwoTransform[14];\n\n      if (interactorOne || interactorTwo || isFrozen) {\n        uniform.hubs_Time.value = time;\n      }\n    }\n  }\n});\n","import { hasReticulumServer } from \"./phoenix-utils\";\nimport configs from \"./configs\";\n\nconst nonCorsProxyDomains = (configs.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (configs.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(configs.CORS_PROXY_SERVER.split(\":\")[0]);\n}\nnonCorsProxyDomains.push(document.location.hostname);\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\",\n  basis: \"image/basis\",\n  ktx2: \"image/ktx2\",\n  m3u8: \"application/vnd.apple.mpegurl\",\n  mpd: \"application/dash+xml\"\n};\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url).replace(/=+$/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  let extension = \"\";\n  try {\n    const pathParts = new URL(url).pathname.split(\".\");\n\n    if (pathParts.length > 1) {\n      const extensionCandidate = pathParts.pop();\n      if (commonKnownContentTypes[extensionCandidate]) {\n        extension = `.${extensionCandidate}`;\n      }\n    }\n  } catch (e) {\n    extension = \".png\";\n  }\n\n  // HACK: the extension is needed to ensure CDN caching on Cloudflare\n  const thumbnailUrl = `https://${configs.THUMBNAIL_SERVER}/thumbnail/${farsparkEncodeUrl(\n    url\n  )}${extension}?w=${width}&h=${height}`;\n\n  try {\n    const urlHostname = new URL(url).hostname;\n\n    if (hasReticulumServer()) {\n      const retHostname = new URL(`https://${configs.RETICULUM_SERVER}`).hostname;\n      if (retHostname === urlHostname) return url;\n    }\n  } catch (e) {\n    return thumbnailUrl;\n  }\n\n  return thumbnailUrl;\n};\n\nexport const isNonCorsProxyDomain = hostname => {\n  return nonCorsProxyDomains.find(domain => hostname.endsWith(domain));\n};\n\nexport const proxiedUrlFor = url => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  // Skip known domains that do not require CORS proxying.\n  try {\n    const parsedUrl = new URL(url);\n    if (isNonCorsProxyDomain(parsedUrl.hostname)) return url;\n  } catch (e) {\n    // Ignore\n  }\n\n  return `https://${configs.CORS_PROXY_SERVER}/${url}`;\n};\n\nexport function getAbsoluteUrl(baseUrl, relativeUrl) {\n  return new URL(relativeUrl, baseUrl);\n}\n\nexport function getAbsoluteHref(baseUrl, relativeUrl) {\n  return getAbsoluteUrl(baseUrl, relativeUrl).href;\n}\n\n// Note these files are configured in webpack.config.js to be handled with file-loader, so this will be a string containing the file paths\nimport basisJsUrl from \"three/examples/js/libs/basis/basis_transcoder.js\";\nimport dracoWrapperJsUrl from \"three/examples/js/libs/draco/gltf/draco_wasm_wrapper.js\";\nimport basisWasmUrl from \"three/examples/js/libs/basis/basis_transcoder.wasm\";\nimport dracoWasmUrl from \"three/examples/js/libs/draco/gltf/draco_decoder.wasm\";\n\nexport const rewriteBasisTranscoderUrls = function (url) {\n  if (url === \"basis_transcoder.js\") {\n    return basisJsUrl;\n  } else if (url === \"basis_transcoder.wasm\") {\n    return basisWasmUrl;\n  }\n  return url;\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  // Intercept loading of basis transcoder with content hashed urls\n  if (url === \"basis_transcoder.js\") {\n    return basisJsUrl;\n  } else if (url === \"basis_transcoder.wasm\") {\n    return basisWasmUrl;\n  } else if (url === \"draco_wasm_wrapper.js\") {\n    return dracoWrapperJsUrl;\n  } else if (url === \"draco_decoder.wasm\") {\n    return dracoWasmUrl;\n  }\n\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return proxiedUrlFor(url);\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (configs.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nconst dataUrlRegex = /data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/;\n\nexport const guessContentType = url => {\n  if (!url) return;\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  if (url.startsWith(\"data:\")) {\n    const matches = dataUrlRegex.exec(url);\n    if (matches.length > 0) {\n      matches[1];\n    }\n  }\n  const extension = new URL(url, window.location).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nconst originIsHubsServer = new Map();\nasync function isHubsServer(url) {\n  if (!url) return false;\n  if (!url.startsWith(\"http\")) {\n    url = \"https://\" + url;\n  }\n  const { origin } = new URL(url);\n\n  if (originIsHubsServer.has(origin)) {\n    return originIsHubsServer.get(origin);\n  }\n\n  let isHubsServer;\n  try {\n    isHubsServer = (await fetch(proxiedUrlFor(origin), { method: \"HEAD\" })).headers.has(\"hub-name\");\n  } catch (e) {\n    isHubsServer = false;\n  }\n  originIsHubsServer.set(origin, isHubsServer);\n  return isHubsServer;\n}\n\nconst hubsSceneRegex = /https?:\\/\\/[^/]+\\/scenes\\/[a-zA-Z0-9]{7}(?:\\/|$)/;\nconst hubsAvatarRegex = /https?:\\/\\/[^/]+\\/avatars\\/(?<id>[a-zA-Z0-9]{7})(?:\\/|$)/;\nconst hubsRoomRegex = /(https?:\\/\\/)?[^/]+\\/(?<id>[a-zA-Z0-9]{7})(?:\\/|$)/;\n\nexport const isLocalHubsUrl = async url =>\n  (await isHubsServer(url)) && new URL(url).origin === document.location.origin;\n\nexport const isHubsSceneUrl = async url => (await isHubsServer(url)) && hubsSceneRegex.test(url);\nexport const isLocalHubsSceneUrl = async url => (await isHubsSceneUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsAvatarUrl = async url => (await isHubsServer(url)) && hubsAvatarRegex.test(url);\nexport const isLocalHubsAvatarUrl = async url => (await isHubsAvatarUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsRoomUrl = async url =>\n  (await isHubsServer(url)) &&\n  !(await isHubsAvatarUrl(url)) &&\n  !(await isHubsSceneUrl(url)) &&\n  url.match(hubsRoomRegex)?.groups.id;\n\nexport const isHubsDestinationUrl = async url =>\n  (await isHubsServer(url)) && ((await isHubsSceneUrl(url)) || (await isHubsRoomUrl(url)));\n\nexport const idForAvatarUrl = url => {\n  const match = url.match(hubsAvatarRegex);\n  if (match) {\n    return match.groups.id;\n  }\n  return null;\n};\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl, getDirectReticulumFetchUrl } from \"./phoenix-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\nimport { updateMaterials } from \"./material-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { validMaterials } from \"../components/hoverable-visuals\";\nimport { proxiedUrlFor, guessContentType } from \"../utils/media-url-utils\";\nimport { isIOS as detectIOS } from \"./is-mobile\";\nimport Linkify from \"linkify-it\";\nimport tlds from \"tlds\";\n\nimport anime from \"animejs\";\n\nexport const MediaType = {\n  MODEL: 1 << 0,\n  IMAGE: 1 << 1,\n  VIDEO: 1 << 2,\n  PDF: 1 << 3\n};\nMediaType.ALL = MediaType.MODEL | MediaType.IMAGE | MediaType.VIDEO | MediaType.PDF;\nMediaType.ALL_2D = MediaType.IMAGE | MediaType.VIDEO | MediaType.PDF;\n\nconst linkify = Linkify();\nlinkify.tlds(tlds);\n\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\nconst getDirectMediaAPIEndpoint = () => getDirectReticulumFetchUrl(\"/api/v1/media\");\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobile();\n\n// Map<String, Promise<Object>\nconst resolveUrlCache = new Map();\nexport const getDefaultResolveQuality = (is360 = false) => {\n  const useLowerQuality = isMobile || isMobileVR;\n  return !is360 ? (useLowerQuality ? \"low\" : \"high\") : useLowerQuality ? \"low_360\" : \"high_360\";\n};\n\nexport const resolveUrl = async (url, quality = null, version = 1, bustCache) => {\n  const key = `${url}_${version}`;\n  if (!bustCache && resolveUrlCache.has(key)) return resolveUrlCache.get(key);\n\n  const resultPromise = fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, quality: quality || getDefaultResolveQuality() }, version })\n  }).then(async response => {\n    if (!response.ok) {\n      const message = `Error resolving url \"${url}\":`;\n      try {\n        const body = await response.text();\n        throw new Error(message + \" \" + body);\n      } catch (e) {\n        throw new Error(message + \" \" + response.statusText);\n      }\n    }\n    return response.json();\n  });\n\n  resolveUrlCache.set(key, resultPromise);\n  return resultPromise;\n};\n\nexport const upload = (file, desiredContentType) => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n\n  if (desiredContentType) {\n    formData.append(\"desired_content_type\", desiredContentType);\n  }\n\n  // To eliminate the extra hop and avoid proxy timeouts, upload files directly\n  // to a reticulum host.\n  return fetch(getDirectMediaAPIEndpoint(), {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nfunction getLatestMediaVersionOfSrc(src) {\n  const els = document.querySelectorAll(\"[media-loader]\");\n  let version = 1;\n\n  for (const el of els) {\n    const loader = el.components[\"media-loader\"];\n\n    if (loader.data && loader.data.src === src) {\n      version = Math.max(version, loader.data.version);\n    }\n  }\n\n  return version;\n}\n\nexport function coerceToUrl(urlOrText) {\n  if (!linkify.test(urlOrText)) return urlOrText;\n\n  // See: https://github.com/Soapbox/linkifyjs/blob/master/src/linkify.js#L52\n  return urlOrText.indexOf(\"://\") >= 0 ? urlOrText : `https://${urlOrText}`;\n}\n\nexport const addMedia = (\n  src,\n  template,\n  contentOrigin,\n  contentSubtype = null,\n  resolve = false,\n  fitToBox = false,\n  animate = true,\n  mediaOptions = {},\n  networked = true,\n  parentEl = null,\n  linkedEl = null\n) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n\n  const nid = NAF.utils.createNetworkId();\n  if (networked) {\n    entity.setAttribute(\"networked\", { template: template, networkId: nid });\n  } else {\n    const templateBody = document\n      .importNode(document.body.querySelector(template).content, true)\n      .firstElementChild.cloneNode(true);\n    const elAttrs = templateBody.attributes;\n\n    // Merge root element attributes with this entity\n    for (let attrIdx = 0; attrIdx < elAttrs.length; attrIdx++) {\n      entity.setAttribute(elAttrs[attrIdx].name, elAttrs[attrIdx].value);\n    }\n\n    // Append all child elements\n    while (templateBody.firstElementChild) {\n      entity.appendChild(templateBody.firstElementChild);\n    }\n  }\n\n  const needsToBeUploaded = src instanceof File;\n\n  // If we're re-pasting an existing src in the scene, we should use the latest version\n  // seen across any other entities. Otherwise, start with version 1.\n  const version = getLatestMediaVersionOfSrc(src);\n\n  entity.setAttribute(\"media-loader\", {\n    fitToBox,\n    resolve,\n    animate,\n    src: typeof src === \"string\" ? coerceToUrl(src) || src : \"\",\n    version,\n    contentSubtype,\n    fileIsOwned: !needsToBeUploaded,\n    linkedEl,\n    mediaOptions\n  });\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  (parentEl || scene).appendChild(entity);\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    // Video camera videos are converted to mp4 for compatibility\n    const desiredContentType = contentSubtype === \"video-camera\" ? \"video/mp4\" : src.type || guessContentType(src.name);\n\n    upload(src, desiredContentType)\n      .then(response => {\n        const srcUrl = new URL(proxiedUrlFor(response.origin));\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport const cloneMedia = (sourceEl, template, src = null, networked = true, link = false, parentEl = null) => {\n  if (!src) {\n    ({ src } = sourceEl.components[\"media-loader\"].data);\n  }\n\n  const { contentSubtype, fitToBox, mediaOptions } = sourceEl.components[\"media-loader\"].data;\n\n  return addMedia(\n    src,\n    template,\n    ObjectContentOrigins.URL,\n    contentSubtype,\n    true,\n    fitToBox,\n    false,\n    mediaOptions,\n    networked,\n    parentEl,\n    link ? sourceEl : null\n  );\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const shaderUniforms = [];\n\n  obj.traverse(object => {\n    if (!object.material || object.isTroikaText) return;\n\n    // TODO this does not really belong here\n    object.reflectionProbeMode = \"dynamic\";\n\n    updateMaterials(object, material => {\n      if (material.hubs_InjectedCustomShaderChunks) return material;\n      if (!validMaterials.includes(material.type)) {\n        return material;\n      }\n\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\n      // hover/toggle state, so for now just skip these while we figure out a more correct\n      // solution.\n      if (\n        object.el &&\n        (object.el.classList.contains(\"ui\") ||\n          object.el.classList.contains(\"hud\") ||\n          object.el.getAttribute(\"text-button\"))\n      )\n        return material;\n\n      const newMaterial = material.clone();\n      newMaterial.onBeforeCompile = (shader, renderer) => {\n        if (shader.vertexShader.indexOf(\"#include <skinning_vertex>\") == -1) return;\n\n        if (material.onBeforeCompile) {\n          material.onBeforeCompile(shader, renderer);\n        }\n\n        shader.uniforms.hubs_IsFrozen = { value: false };\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n        shader.uniforms.hubs_Time = { value: 0 };\n\n        shader.vertexShader =\n          [\n            \"varying vec3 hubs_WorldPosition;\",\n            \"uniform bool hubs_IsFrozen;\",\n            \"uniform bool hubs_HighlightInteractorOne;\",\n            \"uniform bool hubs_HighlightInteractorTwo;\\n\"\n          ].join(\"\\n\") +\n          shader.vertexShader.replace(\n            \"#include <skinning_vertex>\",\n            `#include <skinning_vertex>\n             if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n              vec4 wt = modelMatrix * vec4(transformed, 1);\n\n              // Used in the fragment shader below.\n              hubs_WorldPosition = wt.xyz;\n            }`\n          );\n\n        shader.fragmentShader =\n          [\n            \"varying vec3 hubs_WorldPosition;\",\n            \"uniform bool hubs_IsFrozen;\",\n            \"uniform bool hubs_EnableSweepingEffect;\",\n            \"uniform vec2 hubs_SweepParams;\",\n            \"uniform bool hubs_HighlightInteractorOne;\",\n            \"uniform vec3 hubs_InteractorOnePos;\",\n            \"uniform bool hubs_HighlightInteractorTwo;\",\n            \"uniform vec3 hubs_InteractorTwoPos;\",\n            \"uniform float hubs_Time;\\n\"\n          ].join(\"\\n\") +\n          shader.fragmentShader.replace(\n            \"#include <output_fragment>\",\n            \"#include <output_fragment>\\n\" + mediaHighlightFrag\n          );\n\n        shaderUniforms.push(shader.uniforms);\n      };\n      newMaterial.needsUpdate = true;\n      newMaterial.hubs_InjectedCustomShaderChunks = true;\n      return newMaterial;\n    });\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n\nconst mediaPos = new THREE.Vector3();\n\nexport function addAndArrangeMedia(el, media, contentSubtype, snapCount, mirrorOrientation = false, distance = 0.75) {\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, contentSubtype, false);\n\n  const pos = el.object3D.position;\n\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\n  entity.object3D.rotation.copy(el.object3D.rotation);\n\n  if (mirrorOrientation) {\n    entity.object3D.rotateY(Math.PI);\n  }\n\n  // Generate photos in a circle around camera, starting from the bottom.\n  // Prevent z-fighting but place behind viewfinder\n  const idx = (snapCount % 6) + 3;\n\n  mediaPos.set(\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * distance,\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * distance,\n    -0.05 + idx * 0.001\n  );\n\n  el.object3D.localToWorld(mediaPos);\n  entity.object3D.visible = false;\n\n  const handler = () => {\n    entity.object3D.visible = true;\n    entity.setAttribute(\"animation__photo_pos\", {\n      property: \"position\",\n      dur: 800,\n      from: { x: pos.x, y: pos.y, z: pos.z },\n      to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\n      easing: \"easeOutElastic\"\n    });\n  };\n\n  let eventType = null;\n\n  if (contentSubtype.startsWith(\"photo\")) {\n    entity.addEventListener(\"image-loaded\", handler, { once: true });\n    eventType = \"photo\";\n  } else if (contentSubtype.startsWith(\"video\")) {\n    entity.addEventListener(\"video-loaded\", handler, { once: true });\n    eventType = \"video\";\n  } else {\n    console.error(\"invalid type \" + contentSubtype);\n    return;\n  }\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      el.emit(`${eventType}_taken`, entity.components[\"media-loader\"].data.src);\n    },\n    { once: true }\n  );\n\n  return { entity, orientation };\n}\n\nexport const textureLoader = new HubsTextureLoader().setCrossOrigin(\"anonymous\");\n\nexport async function createImageTexture(url, filter) {\n  let texture;\n\n  if (filter) {\n    const image = new Image();\n    image.crossOrigin = \"anonymous\";\n    const load = new Promise(res => image.addEventListener(\"load\", res, { once: true }));\n    image.src = url;\n    await load;\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0);\n    await filter(ctx, image.width, image.height);\n\n    texture = new THREE.CanvasTexture(canvas);\n  } else {\n    try {\n      texture = await textureLoader.loadAsync(url);\n    } catch (e) {\n      throw new Error(`'${url}' could not be fetched (Error code: ${e.status}; Response: ${e.statusText})`);\n    }\n  }\n\n  texture.encoding = THREE.sRGBEncoding;\n  texture.anisotropy = 4;\n\n  return texture;\n}\n\nconst isIOS = detectIOS();\n\n/**\n * Create video element to be used as a texture.\n *\n * @param {string} src - Url to a video file.\n * @returns {Element} Video element.\n */\nexport function createVideoOrAudioEl(type) {\n  const el = document.createElement(type);\n  el.setAttribute(\"playsinline\", \"\");\n  el.setAttribute(\"webkit-playsinline\", \"\");\n  // iOS Safari requires the autoplay attribute, or it won't play the video at all.\n  el.autoplay = true;\n  // iOS Safari will not play videos without user interaction. We mute the video so that it can autoplay and then\n  // allow the user to unmute it with an interaction in the unmute-video-button component.\n  el.muted = isIOS;\n  el.preload = \"auto\";\n  el.crossOrigin = \"anonymous\";\n  // Audio should default to zero or it be heard before it is positioning and adjusted\n  el.volume = 0;\n  return el;\n}\n\nexport function addMeshScaleAnimation(mesh, initialScale, onComplete) {\n  const step = (function() {\n    const lastValue = {};\n    return function(anim) {\n      const value = anim.animatables[0].target;\n\n      value.x = Math.max(Number.MIN_VALUE, value.x);\n      value.y = Math.max(Number.MIN_VALUE, value.y);\n      value.z = Math.max(Number.MIN_VALUE, value.z);\n\n      // For animation timeline.\n      if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n        return;\n      }\n\n      lastValue.x = value.x;\n      lastValue.y = value.y;\n      lastValue.z = value.z;\n\n      mesh.scale.set(value.x, value.y, value.z);\n      mesh.matrixNeedsUpdate = true;\n    };\n  })();\n\n  const config = {\n    duration: 400,\n    easing: \"easeOutElastic\",\n    elasticity: 400,\n    loop: 0,\n    round: false,\n    x: mesh.scale.x,\n    y: mesh.scale.y,\n    z: mesh.scale.z,\n    targets: [initialScale],\n    update: anim => step(anim),\n    complete: anim => {\n      step(anim);\n      if (onComplete) onComplete();\n    }\n  };\n\n  mesh.scale.copy(initialScale);\n  mesh.matrixNeedsUpdate = true;\n\n  return anime(config);\n}\n\nexport function closeExistingMediaMirror() {\n  const mirrorTarget = document.querySelector(\"#media-mirror-target\");\n\n  // Remove old mirror target media element\n  if (mirrorTarget.firstChild) {\n    mirrorTarget.firstChild.setAttribute(\"animation__remove\", {\n      property: \"scale\",\n      dur: 200,\n      to: { x: 0.01, y: 0.01, z: 0.01 },\n      easing: \"easeInQuad\"\n    });\n\n    return new Promise(res => {\n      mirrorTarget.firstChild.addEventListener(\"animationcomplete\", () => {\n        mirrorTarget.removeChild(mirrorTarget.firstChild);\n        mirrorTarget.parentEl.object3D.visible = false;\n        res();\n      });\n    });\n  }\n}\n\nexport function hasAudioTracks(el) {\n  if (!el) return false;\n\n  // `audioTracks` is the \"correct\" way to check this but is not implemented by most browsers\n  // The rest of the checks are a bit of a race condition, but when loading videos we wait for\n  // the first frame to load, so audio should exist by then. We special case audio-only by checkin\n  // for a 0 size video. Not great...\n  if (el.audioTracks !== undefined) {\n    return el.audioTracks.length > 0;\n  } else if (el.videoWidth === 0 && el.videoHeight === 0) {\n    return true;\n  } else if (el.mozHasAudio !== undefined) {\n    return el.mozHasAudio;\n  } else if (el.webkitAudioDecodedByteCount !== undefined) {\n    return el.webkitAudioDecodedByteCount > 0;\n  } else {\n    return false;\n  }\n}\n","/* global AFRAME */\nimport { textureLoader } from \"../utils/media-utils\";\n\nimport actionButtonSrc from \"../assets/hud/action_button.9.png\";\nimport buttonSrc from \"../assets/hud/button.9.png\";\nimport nametagSrc from \"../assets/hud/nametag.9.png\";\nimport nametagBorderSrc from \"../assets/hud/nametag-border.9.png\";\n\nconst textures = {\n  \"action-button\": {\n    tex: textureLoader.load(actionButtonSrc),\n    width: 128,\n    height: 128\n  },\n  button: {\n    tex: textureLoader.load(buttonSrc),\n    width: 128,\n    height: 128\n  },\n  nametag: {\n    tex: textureLoader.load(nametagSrc),\n    width: 128,\n    height: 128\n  },\n  \"nametag-border\": {\n    tex: textureLoader.load(nametagBorderSrc),\n    width: 128,\n    height: 128\n  }\n};\n\nfunction parseSide(side) {\n  switch (side) {\n    case \"back\": {\n      return THREE.BackSide;\n    }\n    case \"double\": {\n      return THREE.DoubleSide;\n    }\n    default: {\n      // Including case `front`.\n      return THREE.FrontSide;\n    }\n  }\n}\n\n/**\n * Slice9 component for A-Frame.\n */\nAFRAME.registerComponent(\"slice9\", {\n  schema: {\n    alphaTest: { default: 0.0 },\n    bottom: { default: 0, min: 0 },\n    color: { type: \"color\", default: \"#fff\" },\n    debug: { default: false },\n    height: { default: 1, min: 0 },\n    left: { default: 0, min: 0 },\n    opacity: { default: 1.0, min: 0, max: 1 },\n    padding: { default: 0.1, min: 0.01 },\n    right: { default: 0, min: 0 },\n    side: { default: \"front\", oneOf: [\"front\", \"back\", \"double\"] },\n    src: { oneOf: Object.keys(textures) },\n    top: { default: 0, min: 0 },\n    transparent: { default: true },\n    width: { default: 1, min: 0 },\n    usingCustomMaterial: { default: false },\n    usingAtlas: { default: false },\n    uvAtlasMin: { type: \"vec2\" },\n    uvAtlasMax: { type: \"vec2\" }\n  },\n\n  init: function() {\n    const data = this.data;\n\n    this.textureSrc = null;\n\n    const geometry = (this.geometry = new THREE.PlaneBufferGeometry(data.width, data.height, 3, 3));\n\n    // Create mesh.\n    if (data.usingCustomMaterial) {\n      this.plane = new THREE.Mesh(geometry);\n    } else {\n      const material = new THREE.MeshBasicMaterial({\n        alphaTest: data.alphaTest,\n        color: data.color,\n        opacity: data.opacity,\n        transparent: data.transparent,\n        wireframe: data.debug\n      });\n      this.plane = new THREE.Mesh(geometry, material);\n    }\n    this.el.setObject3D(\"mesh\", this.plane);\n  },\n\n  // TODO use updateSlice9Geometry\n  regenerateMesh: function() {\n    const data = this.data;\n    let height;\n    const pos = this.geometry.attributes.position.array;\n    const uvs = this.geometry.attributes.uv.array;\n    let width;\n\n    if (this.plane.material && !this.plane.material.map) {\n      return;\n    }\n\n    /*\n      0--1------------------------------2--3\n      |  |                              |  |\n      4--5------------------------------6--7\n      |  |                              |  |\n      |  |                              |  |\n      |  |                              |  |\n      8--9-----------------------------10--11\n      |  |                              |  |\n      12-13----------------------------14--15\n    */\n    function setPos(id, x, y) {\n      pos[3 * id] = x;\n      pos[3 * id + 1] = y;\n    }\n\n    function setUV(id, u, v) {\n      if (data.usingAtlas) {\n        u = data.uvAtlasMin.x + u * (data.uvAtlasMax.x - data.uvAtlasMin.x);\n        v = data.uvAtlasMin.y + v * (data.uvAtlasMax.y - data.uvAtlasMin.y);\n      }\n      uvs[2 * id] = u;\n      uvs[2 * id + 1] = v;\n    }\n\n    // Update UVS\n    if (data.usingCustomMaterial) {\n      height = 1;\n      width = 1;\n    } else {\n      height = textures[data.src].height;\n      width = textures[data.src].width;\n    }\n    const uv = {\n      left: data.left / width,\n      right: data.right / width,\n      top: data.top / height,\n      bottom: data.bottom / height\n    };\n\n    setUV(1, uv.left, 1);\n    setUV(2, uv.right, 1);\n\n    setUV(4, 0, uv.bottom);\n    setUV(5, uv.left, uv.bottom);\n    setUV(6, uv.right, uv.bottom);\n    setUV(7, 1, uv.bottom);\n\n    setUV(8, 0, uv.top);\n    setUV(9, uv.left, uv.top);\n    setUV(10, uv.right, uv.top);\n    setUV(11, 1, uv.top);\n\n    setUV(13, uv.left, 0);\n    setUV(14, uv.right, 0);\n\n    if (data.usingAtlas) {\n      setUV(0, 0, 1);\n      setUV(3, 1, 1);\n      setUV(12, 0, 0);\n      setUV(15, 1, 0);\n    }\n\n    // Update vertex positions\n    const w2 = data.width / 2;\n    const h2 = data.height / 2;\n    const left = -w2 + data.padding;\n    const right = w2 - data.padding;\n    const top = h2 - data.padding;\n    const bottom = -h2 + data.padding;\n\n    setPos(0, -w2, h2);\n    setPos(1, left, h2);\n    setPos(2, right, h2);\n    setPos(3, w2, h2);\n\n    setPos(4, -w2, top);\n    setPos(5, left, top);\n    setPos(6, right, top);\n    setPos(7, w2, top);\n\n    setPos(8, -w2, bottom);\n    setPos(9, left, bottom);\n    setPos(10, right, bottom);\n    setPos(11, w2, bottom);\n\n    setPos(13, left, -h2);\n    setPos(14, right, -h2);\n    setPos(12, -w2, -h2);\n    setPos(15, w2, -h2);\n\n    this.geometry.attributes.position.needsUpdate = true;\n    this.geometry.attributes.uv.needsUpdate = true;\n  },\n\n  update: function(oldData) {\n    const data = this.data;\n    const diff = AFRAME.utils.diff(data, oldData);\n\n    // Update material if using built-in material.\n    if (!data.usingCustomMaterial) {\n      this.plane.material.alphaTest = data.alphaTest;\n      this.plane.material.color.setStyle(data.color);\n      this.plane.material.opacity = data.opacity;\n      this.plane.material.transparent = data.transparent;\n      this.plane.material.wireframe = data.debug;\n      this.plane.material.side = parseSide(data.side);\n      this.plane.material.needsUpdate = true;\n      if (\"src\" in diff) {\n        this.updateMap();\n      }\n    }\n\n    if (\n      \"width\" in diff ||\n      \"height\" in diff ||\n      \"padding\" in diff ||\n      \"left\" in diff ||\n      \"top\" in diff ||\n      \"bottom\" in diff ||\n      \"right\" in diff\n    ) {\n      this.regenerateMesh();\n    }\n  },\n\n  setMap(texture) {\n    this.plane.material.map = texture;\n    this.plane.material.needsUpdate = true;\n    this.regenerateMesh();\n  },\n\n  /**\n   * Update `src` if using built-in material.\n   */\n  updateMap: function() {\n    const src = this.data.src;\n\n    if (src) {\n      if (src === this.textureSrc) {\n        return;\n      }\n      // Texture added or changed.\n      this.textureSrc = src;\n      this.setMap(textures[src].tex);\n      return;\n    }\n\n    // Texture removed.\n    if (!this.plane.material.map) {\n      return;\n    }\n\n    this.setMap(null);\n  },\n\n  remove() {\n    this.geometry?.dispose();\n  }\n});\n","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer, args = {}) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage(Object.assign(args, { id, payload: data }), transfer);\n    return promise;\n  };\n}\n","// NOTE when changing be sure to check hardcoded mask values in hub.html\nexport const Layers = {\n  // These 3 layers are hardcoded in THREE\n  CAMERA_LAYER_DEFAULT: 0,\n  CAMERA_LAYER_XR_LEFT_EYE: 1,\n  CAMERA_LAYER_XR_RIGHT_EYE: 2,\n\n  CAMERA_LAYER_REFLECTION: 3,\n  CAMERA_LAYER_INSPECT: 4,\n  CAMERA_LAYER_VIDEO_TEXTURE_TARGET: 5,\n\n  CAMERA_LAYER_THIRD_PERSON_ONLY: 6,\n  CAMERA_LAYER_FIRST_PERSON_ONLY: 7,\n  CAMERA_LAYER_UI: 8\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    mask: { default: Layers.CAMERA_LAYER_DEFAULT },\n    recursive: { default: false }\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"object3dset\", this.update);\n  },\n  update() {\n    const obj = this.el.object3D;\n    if (this.data.recursive) {\n      obj.traverse(o => (o.layers.mask = this.data.mask));\n    } else {\n      obj.layers.mask = this.data.mask;\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"object3dset\", this.update);\n  }\n});\n","const tempVector3 = new THREE.Vector3();\nconst tempQuaternion = new THREE.Quaternion();\n\nexport function getLastWorldPosition(src, target) {\n  src.updateMatrices();\n  target.setFromMatrixPosition(src.matrixWorld);\n  return target;\n}\n\nexport function getLastWorldQuaternion(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\n  return target;\n}\n\nexport function getLastWorldScale(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\n  return target;\n}\n\nexport function disposeMaterial(mtrl) {\n  if (mtrl.map) mtrl.map.dispose();\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\n  if (mtrl.envMap) mtrl.envMap.dispose();\n  if (mtrl.aoMap) mtrl.aoMap.dispose();\n  if (mtrl.metalnessMap) mtrl.metalnessMap.dispose();\n  if (mtrl.roughnessMap) mtrl.roughnessMap.dispose();\n  if (mtrl.emissiveMap) mtrl.emissiveMap.dispose();\n  mtrl.dispose();\n}\n\nexport function disposeNode(node) {\n  if (!(node instanceof THREE.Mesh)) return;\n\n  if (node.geometry) {\n    node.geometry.dispose();\n  }\n\n  if (node.material) {\n    if (Array.isArray(node.material)) {\n      node.material.forEach(disposeMaterial);\n    } else {\n      disposeMaterial(node.material);\n    }\n  }\n}\n\nconst IDENTITY = new THREE.Matrix4().identity();\nconst tempMatrix4 = new THREE.Matrix4();\nconst EPSILON = 0.00000000001;\nexport function setMatrixWorld(object3D, m) {\n  if (!object3D.matrixIsModified) {\n    object3D.applyMatrix4(IDENTITY); // hack around our matrix optimizations\n  }\n  tempMatrix4.copy(object3D.matrixWorld);\n  object3D.matrixWorld.copy(m);\n  if (object3D.parent) {\n    object3D.parent.updateMatrices();\n    object3D.matrix\n      .copy(object3D.parent.matrixWorld)\n      .invert()\n      .multiply(m);\n  } else {\n    object3D.matrix.copy(m);\n  }\n  object3D.matrix.decompose(object3D.position, object3D.quaternion, object3D.scale);\n  if (tempMatrix4.near(object3D.matrixWorld, EPSILON)) {\n    object3D.matrixWorld.copy(tempMatrix4);\n  } else {\n    object3D.childrenNeedMatrixWorldUpdate = true;\n  }\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\n// Supports the following PropertyBinding path formats:\n// uuid.propertyName\n// uuid.propertyName[propertyIndex]\n// uuid.objectName[objectIndex].propertyName[propertyIndex]\n// Does not support property bindings that use object3D names or parent nodes\nfunction cloneKeyframeTrack(sourceKeyframeTrack, cloneUUIDLookup) {\n  const { nodeName: uuid, objectName, objectIndex, propertyName, propertyIndex } = THREE.PropertyBinding.parseTrackName(\n    sourceKeyframeTrack.name\n  );\n\n  let path = \"\";\n\n  if (uuid !== undefined) {\n    const clonedUUID = cloneUUIDLookup.get(uuid);\n\n    if (clonedUUID === undefined) {\n      console.warn(`Could not find KeyframeTrack target with uuid: \"${uuid}\"`);\n    }\n\n    path += clonedUUID;\n  }\n\n  if (objectName !== undefined) {\n    path += \".\" + objectName;\n  }\n\n  if (objectIndex !== undefined) {\n    path += \"[\" + objectIndex + \"]\";\n  }\n\n  if (propertyName !== undefined) {\n    path += \".\" + propertyName;\n  }\n\n  if (propertyIndex !== undefined) {\n    path += \"[\" + propertyIndex + \"]\";\n  }\n\n  const clonedKeyframeTrack = sourceKeyframeTrack.clone();\n  clonedKeyframeTrack.name = path;\n\n  return clonedKeyframeTrack;\n}\n\nfunction cloneAnimationClip(sourceAnimationClip, cloneUUIDLookup) {\n  const clonedTracks = sourceAnimationClip.tracks.map(keyframeTrack =>\n    cloneKeyframeTrack(keyframeTrack, cloneUUIDLookup)\n  );\n  return new THREE.AnimationClip(sourceAnimationClip.name, sourceAnimationClip.duration, clonedTracks);\n}\n\nexport function cloneObject3D(source, preserveUUIDs) {\n  const cloneLookup = new Map();\n  const cloneUUIDLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, (sourceNode, clonedNode) => {\n    cloneLookup.set(sourceNode, clonedNode);\n  });\n\n  source.traverse(sourceNode => {\n    const clonedNode = cloneLookup.get(sourceNode);\n\n    if (preserveUUIDs) {\n      clonedNode.uuid = sourceNode.uuid;\n    }\n\n    cloneUUIDLookup.set(sourceNode.uuid, clonedNode.uuid);\n  });\n\n  source.traverse(sourceNode => {\n    const clonedNode = cloneLookup.get(sourceNode);\n\n    if (!clonedNode) {\n      return;\n    }\n\n    if (sourceNode.animations) {\n      clonedNode.animations = sourceNode.animations.map(animationClip =>\n        cloneAnimationClip(animationClip, cloneUUIDLookup)\n      );\n    }\n\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n\n    if ((clonedNode.isDirectionalLight || clonedNode.isSpotLight) && sourceNode.target) {\n      clonedNode.target = cloneLookup.get(sourceNode.target);\n    }\n\n    if (!sourceNode.isSkinnedMesh) return;\n\n    const sourceBones = sourceNode.skeleton.bones;\n\n    clonedNode.skeleton = sourceNode.skeleton.clone();\n\n    clonedNode.skeleton.bones = sourceBones.map(sourceBone => {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedNode.bind(clonedNode.skeleton, sourceNode.bindMatrix);\n  });\n\n  return clone;\n}\n\nexport function findNode(root, pred) {\n  let nodes = [root];\n  while (nodes.length) {\n    const node = nodes.shift();\n    if (pred(node)) return node;\n    if (node.children) nodes = nodes.concat(node.children);\n  }\n  return null;\n}\n\nexport const interpolateAffine = (function() {\n  const mat4 = new THREE.Matrix4();\n  const end = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  const start = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  const interpolated = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  return function(startMat4, endMat4, progress, outMat4) {\n    start.quaternion.setFromRotationMatrix(mat4.extractRotation(startMat4));\n    end.quaternion.setFromRotationMatrix(mat4.extractRotation(endMat4));\n    interpolated.quaternion.slerpQuaternions(start.quaternion, end.quaternion, progress);\n    interpolated.position.lerpVectors(\n      start.position.setFromMatrixColumn(startMat4, 3),\n      end.position.setFromMatrixColumn(endMat4, 3),\n      progress\n    );\n    interpolated.scale.lerpVectors(\n      start.scale.setFromMatrixScale(startMat4),\n      end.scale.setFromMatrixScale(endMat4),\n      progress\n    );\n    return outMat4.compose(\n      interpolated.position,\n      interpolated.quaternion,\n      interpolated.scale\n    );\n  };\n})();\n\nexport const squareDistanceBetween = (function() {\n  const posA = new THREE.Vector3();\n  const posB = new THREE.Vector3();\n  return function(objA, objB) {\n    objA.updateMatrices();\n    objB.updateMatrices();\n    posA.setFromMatrixColumn(objA.matrixWorld, 3);\n    posB.setFromMatrixColumn(objB.matrixWorld, 3);\n    return posA.distanceToSquared(posB);\n  };\n})();\n\nexport function isAlmostUniformVector3(v, epsilonHalf = 0.005) {\n  return Math.abs(v.x - v.y) < epsilonHalf && Math.abs(v.x - v.z) < epsilonHalf;\n}\nexport function almostEqual(a, b, epsilon = 0.01) {\n  return Math.abs(a - b) < epsilon;\n}\n\nexport const affixToWorldUp = (function() {\n  const inRotationMat4 = new THREE.Matrix4();\n  const inForward = new THREE.Vector3();\n  const outForward = new THREE.Vector3();\n  const outSide = new THREE.Vector3();\n  const worldUp = new THREE.Vector3(); // Could be called \"outUp\"\n  const v = new THREE.Vector3();\n  const inMat4Copy = new THREE.Matrix4();\n  return function affixToWorldUp(inMat4, outMat4) {\n    inRotationMat4.identity().extractRotation(inMat4Copy.copy(inMat4));\n    inForward.setFromMatrixColumn(inRotationMat4, 2).multiplyScalar(-1);\n    outForward\n      .copy(inForward)\n      .sub(v.copy(inForward).projectOnVector(worldUp.set(0, 1, 0)))\n      .normalize();\n    outSide.crossVectors(outForward, worldUp);\n    outMat4.makeBasis(outSide, worldUp, outForward.multiplyScalar(-1));\n    outMat4.scale(v.setFromMatrixScale(inMat4Copy));\n    outMat4.setPosition(v.setFromMatrixColumn(inMat4Copy, 3));\n    return outMat4;\n  };\n})();\n\nexport const calculateCameraTransformForWaypoint = (function() {\n  const upAffixedCameraTransform = new THREE.Matrix4();\n  const upAffixedWaypointTransform = new THREE.Matrix4();\n  const detachFromWorldUp = new THREE.Matrix4();\n  return function calculateCameraTransformForWaypoint(cameraTransform, waypointTransform, outMat4) {\n    affixToWorldUp(cameraTransform, upAffixedCameraTransform);\n    detachFromWorldUp\n      .copy(upAffixedCameraTransform)\n      .invert()\n      .multiply(cameraTransform);\n    affixToWorldUp(waypointTransform, upAffixedWaypointTransform);\n    outMat4.copy(upAffixedWaypointTransform).multiply(detachFromWorldUp);\n  };\n})();\n\nexport const calculateViewingDistance = (function() {\n  return function calculateViewingDistance(fov, aspect, box, center, vrMode) {\n    const halfYExtents = Math.max(Math.abs(box.max.y - center.y), Math.abs(center.y - box.min.y));\n    const halfXExtents = Math.max(Math.abs(box.max.x - center.x), Math.abs(center.x - box.min.x));\n    const halfVertFOV = THREE.MathUtils.degToRad(fov / 2);\n    const halfHorFOV = Math.atan(Math.tan(halfVertFOV) * aspect) * (vrMode ? 0.5 : 1);\n    const margin = 1.05;\n    const length1 = Math.abs((halfYExtents * margin) / Math.tan(halfVertFOV));\n    const length2 = Math.abs((halfXExtents * margin) / Math.tan(halfHorFOV));\n    const length3 = Math.abs(box.max.z - center.z) + Math.max(length1, length2);\n    const length = vrMode ? Math.max(0.25, length3) : length3;\n    return length || 1.25;\n  };\n})();\n\nexport const rotateInPlaceAroundWorldUp = (function() {\n  const inMat4Copy = new THREE.Matrix4();\n  const startRotation = new THREE.Matrix4();\n  const endRotation = new THREE.Matrix4();\n  const v = new THREE.Vector3();\n  return function rotateInPlaceAroundWorldUp(inMat4, theta, outMat4) {\n    inMat4Copy.copy(inMat4);\n    return outMat4\n      .copy(endRotation.makeRotationY(theta).multiply(startRotation.extractRotation(inMat4Copy)))\n      .scale(v.setFromMatrixScale(inMat4Copy))\n      .setPosition(v.setFromMatrixPosition(inMat4Copy));\n  };\n})();\n\nexport const childMatch = (function() {\n  const inverseParentWorld = new THREE.Matrix4();\n  const childRelativeToParent = new THREE.Matrix4();\n  const childInverse = new THREE.Matrix4();\n  const newParentMatrix = new THREE.Matrix4();\n  // transform the parent such that its child matches the target\n  return function childMatch(parent, child, target) {\n    parent.updateMatrices();\n    inverseParentWorld.copy(parent.matrixWorld).invert();\n    child.updateMatrices();\n    childRelativeToParent.multiplyMatrices(inverseParentWorld, child.matrixWorld);\n    childInverse.copy(childRelativeToParent).invert();\n    newParentMatrix.multiplyMatrices(target, childInverse);\n    setMatrixWorld(parent, newParentMatrix);\n  };\n})();\n\nexport function createPlaneBufferGeometry(width, height, widthSegments, heightSegments, flipY = true) {\n  const geometry = new THREE.PlaneBufferGeometry(width, height, widthSegments, heightSegments);\n  // Three.js seems to assume texture flipY is true for all its built in geometry\n  // but we turn this off on our texture loader since createImageBitmap in Firefox\n  // does not support flipping. Then we flip the uv for flipY = false texture.\n  if (flipY === false) {\n    const uv = geometry.getAttribute(\"uv\");\n    for (let i = 0; i < uv.count; i++) {\n      uv.setY(i, 1.0 - uv.getY(i));\n    }\n  }\n  return geometry;\n}\n\nimport { Layers } from \"../components/layers\";\n\n// This code is from three-vrm. We will likely be using that in the future and this inlined code can go away\nfunction excludeTriangles(triangles, bws, skinIndex, exclude) {\n  let count = 0;\n  if (bws != null && bws.length > 0) {\n    for (let i = 0; i < triangles.length; i += 3) {\n      const a = triangles[i];\n      const b = triangles[i + 1];\n      const c = triangles[i + 2];\n      const bw0 = bws[a];\n      const skin0 = skinIndex[a];\n\n      if (bw0[0] > 0 && exclude.includes(skin0[0])) continue;\n      if (bw0[1] > 0 && exclude.includes(skin0[1])) continue;\n      if (bw0[2] > 0 && exclude.includes(skin0[2])) continue;\n      if (bw0[3] > 0 && exclude.includes(skin0[3])) continue;\n\n      const bw1 = bws[b];\n      const skin1 = skinIndex[b];\n      if (bw1[0] > 0 && exclude.includes(skin1[0])) continue;\n      if (bw1[1] > 0 && exclude.includes(skin1[1])) continue;\n      if (bw1[2] > 0 && exclude.includes(skin1[2])) continue;\n      if (bw1[3] > 0 && exclude.includes(skin1[3])) continue;\n\n      const bw2 = bws[c];\n      const skin2 = skinIndex[c];\n      if (bw2[0] > 0 && exclude.includes(skin2[0])) continue;\n      if (bw2[1] > 0 && exclude.includes(skin2[1])) continue;\n      if (bw2[2] > 0 && exclude.includes(skin2[2])) continue;\n      if (bw2[3] > 0 && exclude.includes(skin2[3])) continue;\n\n      triangles[count++] = a;\n      triangles[count++] = b;\n      triangles[count++] = c;\n    }\n  }\n  return count;\n}\n\nfunction createErasedMesh(src, erasingBonesIndex) {\n  const dst = new THREE.SkinnedMesh(src.geometry.clone(), src.material);\n  dst.name = `${src.name}(headless)`;\n  dst.frustumCulled = src.frustumCulled;\n  dst.layers.set(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n\n  const geometry = dst.geometry;\n\n  const skinIndexAttr = geometry.getAttribute(\"skinIndex\").array;\n  const skinIndex = [];\n  for (let i = 0; i < skinIndexAttr.length; i += 4) {\n    skinIndex.push([skinIndexAttr[i], skinIndexAttr[i + 1], skinIndexAttr[i + 2], skinIndexAttr[i + 3]]);\n  }\n\n  const skinWeightAttr = geometry.getAttribute(\"skinWeight\").array;\n  const skinWeight = [];\n  for (let i = 0; i < skinWeightAttr.length; i += 4) {\n    skinWeight.push([skinWeightAttr[i], skinWeightAttr[i + 1], skinWeightAttr[i + 2], skinWeightAttr[i + 3]]);\n  }\n\n  const index = geometry.getIndex();\n  if (!index) {\n    throw new Error(\"The geometry doesn't have an index buffer\");\n  }\n  const oldTriangles = Array.from(index.array);\n\n  const count = excludeTriangles(oldTriangles, skinWeight, skinIndex, erasingBonesIndex);\n  const newTriangle = [];\n  for (let i = 0; i < count; i++) {\n    newTriangle[i] = oldTriangles[i];\n  }\n  geometry.setIndex(newTriangle);\n\n  if (src.onBeforeRender) {\n    dst.onBeforeRender = src.onBeforeRender;\n  }\n\n  dst.bind(new THREE.Skeleton(src.skeleton.bones, src.skeleton.boneInverses), new THREE.Matrix4());\n\n  return dst;\n}\n\nfunction isEraseTㄹarget(bone) {\n  return bone.name === \"Head\" || (bone.parent && isEraseTarget(bone.parent));\n}\n\nexport function createHeadlessModelForSkinnedMesh(mesh) {\n  const eraseBoneIndexes = [];\n  mesh.skeleton.bones.forEach((bone, index) => {\n    if (isEraseTarget(bone)) eraseBoneIndexes.push(index);\n  });\n\n  if (!eraseBoneIndexes.length) {\n    mesh.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n    mesh.layers.enable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n    return;\n  }\n\n  mesh.layers.set(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n\n  return createErasedMesh(mesh, eraseBoneIndexes);\n}\n\nexport function createModelForSkinnedMesh(mesh) {\n  return createErasedMesh(mesh, []);\n}\n\nexport const isFacingCamera = (function() {\n  const objWorldDir = new THREE.Vector3();\n  const objWorld = new THREE.Vector3();\n  const camWorld = new THREE.Vector3();\n  return function isFacingCamera(obj) {\n    const playerCamera = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n    playerCamera.getWorldPosition(camWorld);\n    obj.getWorldPosition(objWorld);\n    obj.getWorldDirection(objWorldDir);\n    return objWorldDir.dot(objWorld.sub(camWorld)) < 0;\n  };\n})();\n","import nextTick from \"../utils/next-tick\";\nimport { updateMaterials, mapMaterials, convertStandardMaterial } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-url-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nimport { disposeNode, cloneObject3D } from \"../utils/three-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { KTX2Loader } from \"three/examples/jsm/loaders/KTX2Loader\";\nimport { RGBELoader } from \"three/examples/jsm/loaders/RGBELoader\";\nimport { BasisTextureLoader } from \"three/examples/jsm/loaders/BasisTextureLoader\";\nimport { DRACOLoader } from \"three/examples/jsm/loaders/DRACOLoader\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\n\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nclass GLTFCache {\n  cache = new Map();\n\n  set(src, gltf) {\n    this.cache.set(src, {\n      gltf,\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached gltf ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    if (cacheItem.count <= 0) {\n      cacheItem.gltf.scene.traverse(disposeNode);\n      this.cache.delete(src);\n    }\n  }\n}\nexport const gltfCache = new GLTFCache();\nconst inflightGltfs = new Map();\n\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    console.warn(`Inflator failed. \"${componentName}\" component does not exist.`);\n    return;\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n\n      if (\n        geo.attributes.position.isInterleavedBufferAttribute ||\n        (geo.index && geo.index.isInterleavedBufferAttribute)\n      ) {\n        console.warn(\"Skipping generaton of MeshBVH for interleaved geoemtry as it is not supported\");\n        return;\n      }\n\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.scene.animations,\n    scene: cloneObject3D(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\nfunction getHubsComponentsFromMaterial(node) {\n  const material = node.material;\n\n  if (!material) {\n    return null;\n  }\n\n  return getHubsComponents(material);\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function (indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n  const materialComponents = getHubsComponentsFromMaterial(node);\n\n  const nodeHasBehavior = !!entityComponents || !!materialComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that templates can be attached to the correct AFrame entity.\n  el.object3D.name = node.name;\n\n  // Set the uuid of the `THREE.Group` to match the uuid of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.uuid = node.uuid;\n  node.uuid = THREE.MathUtils.generateUUID();\n\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  if (node.morphTargetInfluences) {\n    node.parent.morphTargetInfluences = node.morphTargetInfluences;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nasync function inflateComponents(inflatedEntity, indexToEntityMap) {\n  let isFirstInflation = true;\n  const objectInflations = [];\n\n  inflatedEntity.object3D.traverse(async object3D => {\n    const objectInflation = {};\n    objectInflation.promise = new Promise(resolve => (objectInflation.resolve = resolve));\n    objectInflations.push(objectInflation);\n\n    if (!isFirstInflation) {\n      await objectInflations.shift().promise;\n    }\n    isFirstInflation = false;\n\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    function resolveNodeRefs(componentData) {\n      for (const propName in componentData) {\n        const value = componentData[propName];\n        const type = value?.__mhc_link_type;\n        if (type === \"node\" && value.index !== undefined) {\n          if (indexToEntityMap[value.index]) {\n            componentData[propName] = indexToEntityMap[value.index].object3D;\n          } else {\n            console.warn(\"inflateComponents: invalid node reference\", propName);\n            componentData[propName] = null;\n          }\n        }\n      }\n      return componentData;\n    }\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          await inflator(\n            el,\n            componentName,\n            resolveNodeRefs(entityComponents[prop]),\n            entityComponents,\n            indexToEntityMap\n          );\n        }\n      }\n    }\n\n    const materialComponents = getHubsComponentsFromMaterial(object3D);\n\n    if (materialComponents && el) {\n      for (const prop in materialComponents) {\n        if (materialComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          await inflator(\n            el,\n            componentName,\n            resolveNodeRefs(materialComponents[prop]),\n            materialComponents,\n            indexToEntityMap\n          );\n        }\n      }\n    }\n\n    objectInflation.resolve();\n  });\n\n  await objectInflations.shift().promise;\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction getHubsComponentsExtension(node) {\n  if (node.extensions && node.extensions.MOZ_hubs_components) {\n    return node.extensions.MOZ_hubs_components;\n  } else if (node.extensions && node.extensions.HUBS_components) {\n    return node.extensions.HUBS_components;\n  } else if (node.extras && node.extras.gltfExtensions && node.extras.gltfExtensions.MOZ_hubs_components) {\n    return node.extras.gltfExtensions.MOZ_hubs_components;\n  }\n}\n\n// Versions are documented here: https://github.com/mozilla/hubs/wiki/MOZ_hubs_components-Changelog\n// Make sure to update the wiki and Spoke when bumping a version\nfunction runMigration(version, json) {\n  if (version < 2) {\n    //old heightfields will be on the same node as the nav-mesh, delete those\n    const oldHeightfieldNode = json.nodes.find(node => {\n      const components = getHubsComponentsExtension(node);\n      return components && components.heightfield && components[\"nav-mesh\"];\n    });\n    if (oldHeightfieldNode) {\n      if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.MOZ_hubs_components) {\n        delete oldHeightfieldNode.extensions.MOZ_hubs_components.heightfield;\n      } else if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.HUBS_components) {\n        delete oldHeightfieldNode.extensions.HUBS_components.heightfield;\n      } else if (\n        oldHeightfieldNode.extras &&\n        oldHeightfieldNode.extras.gltfExtensions &&\n        oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components\n      ) {\n        delete oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components;\n      }\n    }\n  }\n\n  if (version < 4) {\n    // Lights prior to version 4 should treat range === 0 as if it has zero decay\n    if (json.nodes) {\n      for (const node of json.nodes) {\n        const components = getHubsComponentsExtension(node);\n\n        if (!components) {\n          continue;\n        }\n\n        const light = components[\"spot-light\"] || components[\"point-light\"];\n\n        if (light && light.range === 0) {\n          light.decay = 0;\n        }\n      }\n    }\n  }\n}\n\nlet ktxLoader;\nlet dracoLoader;\n\nclass GLTFHubsPlugin {\n  constructor(parser, jsonPreprocessor) {\n    this.parser = parser;\n    this.jsonPreprocessor = jsonPreprocessor;\n\n    // We override glTF parser textureLoader with our HubsTextureLoader for\n    // 1. Clean up the texture image related resources after it is uploaded to WebGL texture\n    // 2. Use ImageBitmapLoader if it is available. The latest official Three.js (r128) glTF loader\n    //    attempts to use ImageBitmapLoader if it is avaiable except for Firefox.\n    //    But we want to use ImageBitmapLoader even for Firefox so we need this overriding hack.\n    // But overriding the textureLoader is hacky and it can cause future potential problems\n    // especially in upstraming Three.js. So ideally we should replace this hack\n    // with the one using more proper APIs like plugin system at some point.\n    // Note: Be careful when replacing our Three.js fork with the official upstraming one that\n    //       the latest ImageBitmapLoader passes the second argument to createImageBitmap()\n    //       but currently createImageBitmap() on Firefox fails if the second argument is defined.\n    //       https://bugzilla.mozilla.org/show_bug.cgi?id=1367251\n    //       and this is the reason why the official glTF loader doesn't use ImageBitmapLoader\n    //       for Firefox. We will need a workaround for that.\n    parser.textureLoader = new HubsTextureLoader(parser.options.manager);\n  }\n\n  beforeRoot() {\n    const parser = this.parser;\n    const jsonPreprocessor = this.jsonPreprocessor;\n\n    //\n    if (jsonPreprocessor) {\n      parser.json = jsonPreprocessor(parser.json);\n    }\n\n    // Ideally Hubs components stuffs should be handled in MozHubsComponents plugin?\n    let version = 0;\n    if (\n      parser.json.extensions &&\n      parser.json.extensions.MOZ_hubs_components &&\n      parser.json.extensions.MOZ_hubs_components.hasOwnProperty(\"version\")\n    ) {\n      version = parser.json.extensions.MOZ_hubs_components.version;\n    }\n    runMigration(version, parser.json);\n\n    // Note: Here may be rewritten with the one with parser.associations\n    const nodes = parser.json.nodes;\n    if (nodes) {\n      for (let i = 0; i < nodes.length; i++) {\n        const node = nodes[i];\n\n        if (!node.extras) {\n          node.extras = {};\n        }\n\n        node.extras.gltfIndex = i;\n      }\n    }\n  }\n\n  afterRoot(gltf) {\n    gltf.scene.traverse(object => {\n      // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n      // @TODO: Should this be fixed in the gltf loader?\n      object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n      const materialQuality = window.APP.store.state.preferences.materialQualitySetting;\n      updateMaterials(object, material => convertStandardMaterial(material, materialQuality));\n    });\n\n    // Replace animation target node name with the node uuid.\n    // I assume track name is 'nodename.property'.\n    if (gltf.animations) {\n      for (const animation of gltf.animations) {\n        for (const track of animation.tracks) {\n          const parsedPath = THREE.PropertyBinding.parseTrackName(track.name);\n          for (const scene of gltf.scenes) {\n            const node = THREE.PropertyBinding.findNode(scene, parsedPath.nodeName);\n            if (node) {\n              track.name = track.name.replace(/^[^.]*\\./, node.uuid + \".\");\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    //\n    gltf.scene.animations = gltf.animations;\n  }\n}\n\nclass GLTFHubsComponentsExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_hubs_components\";\n  }\n\n  afterRoot({ scenes, parser }) {\n    const deps = [];\n\n    const resolveComponents = (gltfRootType, obj) => {\n      const idx = parser.associations.get(obj)?.[gltfRootType];\n      if (idx === undefined) return;\n      const ext = parser.json[gltfRootType][idx].extensions?.[this.name];\n      if (!ext) return;\n\n      // TODO putting this into userData is a bit silly, we should just inflate here, but entities need to be inflated first...\n      obj.userData.gltfExtensions = Object.assign(obj.userData.gltfExtensions || {}, {\n        MOZ_hubs_components: ext\n      });\n\n      for (const componentName in ext) {\n        const props = ext[componentName];\n        for (const propName in props) {\n          const value = props[propName];\n          const type = value?.__mhc_link_type;\n          if (type && value.index !== undefined) {\n            deps.push(\n              parser.getDependency(type, value.index).then(loadedDep => {\n                // TODO similar to above, this logic being spread out in multiple places is not great...\n                // Node refences are assumed to always be in the scene graph. These referneces are late-resolved in inflateComponents\n                // otherwise they will need to be updated when cloning (which happens as part of caching).\n                if (type === \"node\") return;\n\n                if (type === \"texture\" && !parser.json.textures[value.index].extensions?.MOZ_texture_rgbe) {\n                  // For now assume all non HDR textures linked in hubs components are sRGB.\n                  // We can allow this to be overriden later if needed\n                  loadedDep.encoding = THREE.sRGBEncoding;\n                }\n\n                props[propName] = loadedDep;\n\n                return loadedDep;\n              })\n            );\n          }\n        }\n      }\n    };\n\n    for (let i = 0; i < scenes.length; i++) {\n      // TODO this should be done by GLTLoader\n      parser.associations.set(scenes[i], { scenes: i });\n      scenes[i].traverse(obj => {\n        resolveComponents(\"scenes\", obj);\n        resolveComponents(\"nodes\", obj);\n        mapMaterials(obj, resolveComponents.bind(this, \"materials\"));\n      });\n    }\n\n    return Promise.all(deps);\n  }\n}\n\nclass GLTFHubsLightMapExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_lightmap\";\n  }\n\n  // @TODO: Ideally we should use extendMaterialParams hook.\n  //        But the current official glTF loader doesn't fire extendMaterialParams\n  //        hook for unlit and specular-glossiness materials.\n  //        So using loadMaterial hook as workaround so far.\n  //        Cons is loadMaterial hook is fired as _invokeOne so\n  //        if other plugins defining loadMaterial is registered\n  //        there is a chance that this light map extension handler isn't called.\n  //        The glTF loader should be updated to remove the limitation.\n  loadMaterial(materialIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const materialDef = json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = materialDef.extensions[this.name];\n\n    const pending = [];\n\n    pending.push(parser.loadMaterial(materialIndex));\n    pending.push(parser.getDependency(\"texture\", extensionDef.index));\n\n    return Promise.all(pending).then(results => {\n      const material = results[0];\n      const lightMap = results[1];\n      material.lightMap = lightMap;\n      material.lightMapIntensity = extensionDef.intensity !== undefined ? extensionDef.intensity : 1;\n\n      // See https://github.com/mrdoob/three.js/pull/23613\n      if (material.isMeshBasicMaterial) {\n        material.lightMapIntensity *= Math.PI;\n      }\n\n      return material;\n    });\n  }\n}\n\nclass GLTFHubsTextureBasisExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_HUBS_texture_basis\";\n    this.basisLoader = null;\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    if (this.basisLoader === null) {\n      this.basisLoader = new BasisTextureLoader(parser.options.manager).detectSupport(AFRAME.scenes[0].renderer);\n    }\n\n    if (!this.basisLoader) {\n      // @TODO: Display warning (only if the extension is in extensionsRequired)?\n      return null;\n    }\n\n    console.warn(`The ${this.name} extension is deprecated, you should use KHR_texture_basisu instead.`);\n\n    const extensionDef = textureDef.extensions[this.name];\n    const source = extensionDef.source;\n\n    return parser.loadTextureImage(textureIndex, source, this.basisLoader);\n  }\n}\n\nclass GLTFMozTextureRGBE {\n  constructor(parser, loader) {\n    this.parser = parser;\n    this.loader = loader;\n    this.name = \"MOZ_texture_rgbe\";\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = textureDef.extensions[this.name];\n    const source = extensionDef.source;\n    return parser.loadTextureImage(textureIndex, source, this.loader).then(t => {\n      // TODO pretty severe artifacting when using mipmaps, disable for now\n      if (t.minFilter == THREE.NearestMipmapNearestFilter || t.minFilter == THREE.NearestMipmapLinearFilter) {\n        t.minFilter = THREE.NearestFilter;\n      } else if (t.minFilter == THREE.LinearMipmapNearestFilter || t.minFilter == THREE.LinearMipmapLinearFilter) {\n        t.minFilter = THREE.LinearFilter;\n      }\n      return t;\n    });\n  }\n}\n\nexport async function loadGLTF(src, contentType, onProgress, jsonPreprocessor) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType && (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\"))) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new GLTFLoader(loadingManager);\n  gltfLoader\n    .register(parser => new GLTFHubsComponentsExtension(parser))\n    .register(parser => new GLTFHubsPlugin(parser, jsonPreprocessor))\n    .register(parser => new GLTFHubsLightMapExtension(parser))\n    .register(parser => new GLTFHubsTextureBasisExtension(parser))\n    .register(parser => new GLTFMozTextureRGBE(parser, new RGBELoader().setDataType(THREE.HalfFloatType)));\n\n  // TODO some models are loaded before the renderer exists. This is likely things like the camera tool and loading cube.\n  // They don't currently use KTX textures but if they did this would be an issue. Fixing this is hard but is part of\n  // \"taking control of the render loop\" which is something we want to tackle for many reasons.\n  if (!ktxLoader && AFRAME && AFRAME.scenes && AFRAME.scenes[0]) {\n    ktxLoader = new KTX2Loader(loadingManager).detectSupport(AFRAME.scenes[0].renderer);\n  }\n  if (!dracoLoader && AFRAME && AFRAME.scenes && AFRAME.scenes[0]) {\n    dracoLoader = new DRACOLoader(loadingManager);\n  }\n\n  if (ktxLoader) {\n    gltfLoader.setKTX2Loader(ktxLoader);\n  }\n  if (dracoLoader) {\n    gltfLoader.setDRACOLoader(dracoLoader);\n  }\n\n  return new Promise((resolve, reject) => {\n    gltfLoader.load(gltfUrl, resolve, onProgress, reject);\n  }).finally(() => {\n    if (fileMap) {\n      // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n      Object.keys(fileMap).forEach(URL.revokeObjectURL);\n    }\n  });\n}\n\nexport async function loadModel(src, contentType = null, useCache = false, jsonPreprocessor = null) {\n  console.log(`Loading model ${src}`);\n  if (useCache) {\n    if (gltfCache.has(src)) {\n      gltfCache.retain(src);\n      return cloneGltf(gltfCache.get(src).gltf);\n    } else {\n      if (inflightGltfs.has(src)) {\n        const gltf = await inflightGltfs.get(src);\n        gltfCache.retain(src);\n        return cloneGltf(gltf);\n      } else {\n        const promise = loadGLTF(src, contentType, null, jsonPreprocessor);\n        inflightGltfs.set(src, promise);\n        const gltf = await promise;\n        inflightGltfs.delete(src);\n        gltfCache.set(src, gltf);\n        return cloneGltf(gltf);\n      }\n    }\n  } else {\n    return loadGLTF(src, contentType, null, jsonPreprocessor);\n  }\n}\n\nfunction resolveAsset(src) {\n  // If the src attribute is a selector, get the url from the asset item.\n  if (src && src.charAt(0) === \"#\") {\n    const assetEl = document.getElementById(src.substring(1));\n    if (assetEl) {\n      return assetEl.getAttribute(\"src\");\n    }\n  }\n  return src;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * allowed components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    // This can be set externally if a consumer wants to do some node preprocssing.\n    this.jsonPreprocessor = null;\n\n    this.loadTemplates();\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  update() {\n    this.applySrc(resolveAsset(this.data.src), this.data.contentType);\n  },\n\n  remove() {\n    if (this.data.useCache) {\n      const src = resolveAsset(this.data.src);\n      if (src) {\n        gltfCache.release(src);\n      }\n    }\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      if (src === this.lastSrc) return;\n\n      const lastSrc = this.lastSrc;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await loadModel(src, contentType, this.data.useCache, this.jsonPreprocessor);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene;\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(this.model.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        object3DToSet.visible = false;\n\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        await inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      if (lastSrc && this.data.useCache) {\n        gltfCache.release(lastSrc);\n      }\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      object3DToSet.visible = true;\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: object3DToSet });\n    } catch (e) {\n      gltfCache.release(src);\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","\nimport worker from \"!!../../node_modules/worker-loader/dist/runtime/inline.js\";\n\nexport default function Worker_fn() {\n  return worker(\"!function(){\\\"use strict\\\";var e,t,i=(e=function(e,t){var i=\\\"undefined\\\"!=typeof Uint8Array&&\\\"undefined\\\"!=typeof Uint16Array&&\\\"undefined\\\"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if(\\\"object\\\"!=typeof i)throw new TypeError(i+\\\"must be non-object\\\");for(var a in i)n(i,a)&&(e[a]=i[a])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,i,n,a){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+n),a);else for(var r=0;r<n;r++)e[a+r]=t[i+r]},flattenChunks:function(e){var t,i,n,a,r,o;for(n=0,t=0,i=e.length;t<i;t++)n+=e[t].length;for(o=new Uint8Array(n),a=0,t=0,i=e.length;t<i;t++)r=e[t],o.set(r,a),a+=r.length;return o}},r={arraySet:function(e,t,i,n,a){for(var r=0;r<n;r++)e[a+r]=t[i+r]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,r))},t.setTyped(i)},e(t={exports:{}},t.exports),t.exports);i.assign,i.shrinkBuf,i.setTyped,i.Buf8,i.Buf16,i.Buf32;var n=function(e,t,i,n){for(var a=65535&e|0,r=e>>>16&65535|0,o=0;0!==i;){i-=o=i>2e3?2e3:i;do{r=r+(a=a+t[n++]|0)|0}while(--o);a%=65521,r%=65521}return a|r<<16|0},a=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}(),r=function(e,t,i,n){var r=a,o=n+i;e^=-1;for(var s=n;s<o;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},o=function(e,t){var i,n,a,r,o,s,f,l,d,c,h,u,w,b,p,m,k,_,v,g,y,x,B,E,S;i=e.state,n=e.next_in,E=e.input,a=n+(e.avail_in-5),r=e.next_out,S=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),f=i.dmax,l=i.wsize,d=i.whave,c=i.wnext,h=i.window,u=i.hold,w=i.bits,b=i.lencode,p=i.distcode,m=(1<<i.lenbits)-1,k=(1<<i.distbits)-1;e:do{w<15&&(u+=E[n++]<<w,w+=8,u+=E[n++]<<w,w+=8),_=b[u&m];t:for(;;){if(u>>>=v=_>>>24,w-=v,0==(v=_>>>16&255))S[r++]=65535&_;else{if(!(16&v)){if(0==(64&v)){_=b[(65535&_)+(u&(1<<v)-1)];continue t}if(32&v){i.mode=12;break e}e.msg=\\\"invalid literal/length code\\\",i.mode=30;break e}g=65535&_,(v&=15)&&(w<v&&(u+=E[n++]<<w,w+=8),g+=u&(1<<v)-1,u>>>=v,w-=v),w<15&&(u+=E[n++]<<w,w+=8,u+=E[n++]<<w,w+=8),_=p[u&k];i:for(;;){if(u>>>=v=_>>>24,w-=v,!(16&(v=_>>>16&255))){if(0==(64&v)){_=p[(65535&_)+(u&(1<<v)-1)];continue i}e.msg=\\\"invalid distance code\\\",i.mode=30;break e}if(y=65535&_,w<(v&=15)&&(u+=E[n++]<<w,(w+=8)<v&&(u+=E[n++]<<w,w+=8)),(y+=u&(1<<v)-1)>f){e.msg=\\\"invalid distance too far back\\\",i.mode=30;break e}if(u>>>=v,w-=v,y>(v=r-o)){if((v=y-v)>d&&i.sane){e.msg=\\\"invalid distance too far back\\\",i.mode=30;break e}if(x=0,B=h,0===c){if(x+=l-v,v<g){g-=v;do{S[r++]=h[x++]}while(--v);x=r-y,B=S}}else if(c<v){if(x+=l+c-v,(v-=c)<g){g-=v;do{S[r++]=h[x++]}while(--v);if(x=0,c<g){g-=v=c;do{S[r++]=h[x++]}while(--v);x=r-y,B=S}}}else if(x+=c-v,v<g){g-=v;do{S[r++]=h[x++]}while(--v);x=r-y,B=S}for(;g>2;)S[r++]=B[x++],S[r++]=B[x++],S[r++]=B[x++],g-=3;g&&(S[r++]=B[x++],g>1&&(S[r++]=B[x++]))}else{x=r-y;do{S[r++]=S[x++],S[r++]=S[x++],S[r++]=S[x++],g-=3}while(g>2);g&&(S[r++]=S[x++],g>1&&(S[r++]=S[x++]))}break}}break}}while(n<a&&r<s);n-=g=w>>3,u&=(1<<(w-=g<<3))-1,e.next_in=n,e.next_out=r,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=r<s?s-r+257:257-(r-s),i.hold=u,i.bits=w},s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],c=function(e,t,n,a,r,o,c,h){var u,w,b,p,m,k,_,v,g,y=h.bits,x=0,B=0,E=0,S=0,R=0,A=0,Z=0,T=0,O=0,U=0,L=null,C=0,N=new i.Buf16(16),D=new i.Buf16(16),I=null,F=0;for(x=0;x<=15;x++)N[x]=0;for(B=0;B<a;B++)N[t[n+B]]++;for(R=y,S=15;S>=1&&0===N[S];S--);if(R>S&&(R=S),0===S)return r[o++]=20971520,r[o++]=20971520,h.bits=1,0;for(E=1;E<S&&0===N[E];E++);for(R<E&&(R=E),T=1,x=1;x<=15;x++)if(T<<=1,(T-=N[x])<0)return-1;if(T>0&&(0===e||1!==S))return-1;for(D[1]=0,x=1;x<15;x++)D[x+1]=D[x]+N[x];for(B=0;B<a;B++)0!==t[n+B]&&(c[D[t[n+B]]++]=B);if(0===e?(L=I=c,k=19):1===e?(L=s,C-=257,I=f,F-=257,k=256):(L=l,I=d,k=-1),U=0,B=0,x=E,m=o,A=R,Z=0,b=-1,p=(O=1<<R)-1,1===e&&O>852||2===e&&O>592)return 1;for(;;){_=x-Z,c[B]<k?(v=0,g=c[B]):c[B]>k?(v=I[F+c[B]],g=L[C+c[B]]):(v=96,g=0),u=1<<x-Z,E=w=1<<A;do{r[m+(U>>Z)+(w-=u)]=_<<24|v<<16|g|0}while(0!==w);for(u=1<<x-1;U&u;)u>>=1;if(0!==u?(U&=u-1,U+=u):U=0,B++,0==--N[x]){if(x===S)break;x=t[n+c[B]]}if(x>R&&(U&p)!==b){for(0===Z&&(Z=R),m+=E,T=1<<(A=x-Z);A+Z<S&&!((T-=N[A+Z])<=0);)A++,T<<=1;if(O+=1<<A,1===e&&O>852||2===e&&O>592)return 1;r[b=U&p]=R<<24|A<<16|m-o|0}}return 0!==U&&(r[m+U]=x-Z<<24|64<<16|0),h.bits=R,0},h=0,u=-2,w=1,b=12,p=30,m=852,k=592;function _(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function g(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=\\\"\\\",t.wrap&&(e.adler=1&t.wrap),t.mode=w,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(m),t.distcode=t.distdyn=new i.Buf32(k),t.sane=1,t.back=-1,h):u}function y(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,g(e)):u}function x(e,t){var i,n;return e&&e.state?(n=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?u:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,y(e))):u}function B(e,t){var i,n;return e?(n=new v,e.state=n,n.window=null,(i=x(e,t))!==h&&(e.state=null),i):u}var E,S,R=!0;function A(e){if(R){var t;for(E=new i.Buf32(512),S=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(c(1,e.lens,0,288,E,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;c(2,e.lens,0,32,S,0,e.work,{bits:5}),R=!1}e.lencode=E,e.lenbits=9,e.distcode=S,e.distbits=5}function Z(e,t,n,a){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),a>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((r=o.wsize-o.wnext)>a&&(r=a),i.arraySet(o.window,t,n-a,r,o.wnext),(a-=r)?(i.arraySet(o.window,t,n-a,a,0),o.wnext=a,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}var T={inflateReset:y,inflateReset2:x,inflateResetKeep:g,inflateInit:function(e){return B(e,15)},inflateInit2:B,inflate:function(e,t){var a,s,f,l,d,m,k,v,g,y,x,B,E,S,R,T,O,U,L,C,N,D,I,F,H=0,z=new i.Buf8(4),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;(a=e.state).mode===b&&(a.mode=13),d=e.next_out,f=e.output,k=e.avail_out,l=e.next_in,s=e.input,m=e.avail_in,v=a.hold,g=a.bits,y=m,x=k,D=h;e:for(;;)switch(a.mode){case w:if(0===a.wrap){a.mode=13;break}for(;g<16;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(2&a.wrap&&35615===v){a.check=0,z[0]=255&v,z[1]=v>>>8&255,a.check=r(a.check,z,2,0),v=0,g=0,a.mode=2;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&v)<<8)+(v>>8))%31){e.msg=\\\"incorrect header check\\\",a.mode=p;break}if(8!=(15&v)){e.msg=\\\"unknown compression method\\\",a.mode=p;break}if(g-=4,N=8+(15&(v>>>=4)),0===a.wbits)a.wbits=N;else if(N>a.wbits){e.msg=\\\"invalid window size\\\",a.mode=p;break}a.dmax=1<<N,e.adler=a.check=1,a.mode=512&v?10:b,v=0,g=0;break;case 2:for(;g<16;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(a.flags=v,8!=(255&a.flags)){e.msg=\\\"unknown compression method\\\",a.mode=p;break}if(57344&a.flags){e.msg=\\\"unknown header flags set\\\",a.mode=p;break}a.head&&(a.head.text=v>>8&1),512&a.flags&&(z[0]=255&v,z[1]=v>>>8&255,a.check=r(a.check,z,2,0)),v=0,g=0,a.mode=3;case 3:for(;g<32;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}a.head&&(a.head.time=v),512&a.flags&&(z[0]=255&v,z[1]=v>>>8&255,z[2]=v>>>16&255,z[3]=v>>>24&255,a.check=r(a.check,z,4,0)),v=0,g=0,a.mode=4;case 4:for(;g<16;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}a.head&&(a.head.xflags=255&v,a.head.os=v>>8),512&a.flags&&(z[0]=255&v,z[1]=v>>>8&255,a.check=r(a.check,z,2,0)),v=0,g=0,a.mode=5;case 5:if(1024&a.flags){for(;g<16;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}a.length=v,a.head&&(a.head.extra_len=v),512&a.flags&&(z[0]=255&v,z[1]=v>>>8&255,a.check=r(a.check,z,2,0)),v=0,g=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(1024&a.flags&&((B=a.length)>m&&(B=m),B&&(a.head&&(N=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),i.arraySet(a.head.extra,s,l,B,N)),512&a.flags&&(a.check=r(a.check,s,B,l)),m-=B,l+=B,a.length-=B),a.length))break e;a.length=0,a.mode=7;case 7:if(2048&a.flags){if(0===m)break e;B=0;do{N=s[l+B++],a.head&&N&&a.length<65536&&(a.head.name+=String.fromCharCode(N))}while(N&&B<m);if(512&a.flags&&(a.check=r(a.check,s,B,l)),m-=B,l+=B,N)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.flags){if(0===m)break e;B=0;do{N=s[l+B++],a.head&&N&&a.length<65536&&(a.head.comment+=String.fromCharCode(N))}while(N&&B<m);if(512&a.flags&&(a.check=r(a.check,s,B,l)),m-=B,l+=B,N)break e}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(512&a.flags){for(;g<16;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(v!==(65535&a.check)){e.msg=\\\"header crc mismatch\\\",a.mode=p;break}v=0,g=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=b;break;case 10:for(;g<32;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}e.adler=a.check=_(v),v=0,g=0,a.mode=11;case 11:if(0===a.havedict)return e.next_out=d,e.avail_out=k,e.next_in=l,e.avail_in=m,a.hold=v,a.bits=g,2;e.adler=a.check=1,a.mode=b;case b:if(5===t||6===t)break e;case 13:if(a.last){v>>>=7&g,g-=7&g,a.mode=27;break}for(;g<3;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}switch(a.last=1&v,g-=1,3&(v>>>=1)){case 0:a.mode=14;break;case 1:if(A(a),a.mode=20,6===t){v>>>=2,g-=2;break e}break;case 2:a.mode=17;break;case 3:e.msg=\\\"invalid block type\\\",a.mode=p}v>>>=2,g-=2;break;case 14:for(v>>>=7&g,g-=7&g;g<32;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if((65535&v)!=(v>>>16^65535)){e.msg=\\\"invalid stored block lengths\\\",a.mode=p;break}if(a.length=65535&v,v=0,g=0,a.mode=15,6===t)break e;case 15:a.mode=16;case 16:if(B=a.length){if(B>m&&(B=m),B>k&&(B=k),0===B)break e;i.arraySet(f,s,l,B,d),m-=B,l+=B,k-=B,d+=B,a.length-=B;break}a.mode=b;break;case 17:for(;g<14;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(a.nlen=257+(31&v),v>>>=5,g-=5,a.ndist=1+(31&v),v>>>=5,g-=5,a.ncode=4+(15&v),v>>>=4,g-=4,a.nlen>286||a.ndist>30){e.msg=\\\"too many length or distance symbols\\\",a.mode=p;break}a.have=0,a.mode=18;case 18:for(;a.have<a.ncode;){for(;g<3;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}a.lens[j[a.have++]]=7&v,v>>>=3,g-=3}for(;a.have<19;)a.lens[j[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,I={bits:a.lenbits},D=c(0,a.lens,0,19,a.lencode,0,a.work,I),a.lenbits=I.bits,D){e.msg=\\\"invalid code lengths set\\\",a.mode=p;break}a.have=0,a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;T=(H=a.lencode[v&(1<<a.lenbits)-1])>>>16&255,O=65535&H,!((R=H>>>24)<=g);){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(O<16)v>>>=R,g-=R,a.lens[a.have++]=O;else{if(16===O){for(F=R+2;g<F;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(v>>>=R,g-=R,0===a.have){e.msg=\\\"invalid bit length repeat\\\",a.mode=p;break}N=a.lens[a.have-1],B=3+(3&v),v>>>=2,g-=2}else if(17===O){for(F=R+3;g<F;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}g-=R,N=0,B=3+(7&(v>>>=R)),v>>>=3,g-=3}else{for(F=R+7;g<F;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}g-=R,N=0,B=11+(127&(v>>>=R)),v>>>=7,g-=7}if(a.have+B>a.nlen+a.ndist){e.msg=\\\"invalid bit length repeat\\\",a.mode=p;break}for(;B--;)a.lens[a.have++]=N}}if(a.mode===p)break;if(0===a.lens[256]){e.msg=\\\"invalid code -- missing end-of-block\\\",a.mode=p;break}if(a.lenbits=9,I={bits:a.lenbits},D=c(1,a.lens,0,a.nlen,a.lencode,0,a.work,I),a.lenbits=I.bits,D){e.msg=\\\"invalid literal/lengths set\\\",a.mode=p;break}if(a.distbits=6,a.distcode=a.distdyn,I={bits:a.distbits},D=c(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,I),a.distbits=I.bits,D){e.msg=\\\"invalid distances set\\\",a.mode=p;break}if(a.mode=20,6===t)break e;case 20:a.mode=21;case 21:if(m>=6&&k>=258){e.next_out=d,e.avail_out=k,e.next_in=l,e.avail_in=m,a.hold=v,a.bits=g,o(e,x),d=e.next_out,f=e.output,k=e.avail_out,l=e.next_in,s=e.input,m=e.avail_in,v=a.hold,g=a.bits,a.mode===b&&(a.back=-1);break}for(a.back=0;T=(H=a.lencode[v&(1<<a.lenbits)-1])>>>16&255,O=65535&H,!((R=H>>>24)<=g);){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(T&&0==(240&T)){for(U=R,L=T,C=O;T=(H=a.lencode[C+((v&(1<<U+L)-1)>>U)])>>>16&255,O=65535&H,!(U+(R=H>>>24)<=g);){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}v>>>=U,g-=U,a.back+=U}if(v>>>=R,g-=R,a.back+=R,a.length=O,0===T){a.mode=26;break}if(32&T){a.back=-1,a.mode=b;break}if(64&T){e.msg=\\\"invalid literal/length code\\\",a.mode=p;break}a.extra=15&T,a.mode=22;case 22:if(a.extra){for(F=a.extra;g<F;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}a.length+=v&(1<<a.extra)-1,v>>>=a.extra,g-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=23;case 23:for(;T=(H=a.distcode[v&(1<<a.distbits)-1])>>>16&255,O=65535&H,!((R=H>>>24)<=g);){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(0==(240&T)){for(U=R,L=T,C=O;T=(H=a.distcode[C+((v&(1<<U+L)-1)>>U)])>>>16&255,O=65535&H,!(U+(R=H>>>24)<=g);){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}v>>>=U,g-=U,a.back+=U}if(v>>>=R,g-=R,a.back+=R,64&T){e.msg=\\\"invalid distance code\\\",a.mode=p;break}a.offset=O,a.extra=15&T,a.mode=24;case 24:if(a.extra){for(F=a.extra;g<F;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}a.offset+=v&(1<<a.extra)-1,v>>>=a.extra,g-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg=\\\"invalid distance too far back\\\",a.mode=p;break}a.mode=25;case 25:if(0===k)break e;if(B=x-k,a.offset>B){if((B=a.offset-B)>a.whave&&a.sane){e.msg=\\\"invalid distance too far back\\\",a.mode=p;break}B>a.wnext?(B-=a.wnext,E=a.wsize-B):E=a.wnext-B,B>a.length&&(B=a.length),S=a.window}else S=f,E=d-a.offset,B=a.length;B>k&&(B=k),k-=B,a.length-=B;do{f[d++]=S[E++]}while(--B);0===a.length&&(a.mode=21);break;case 26:if(0===k)break e;f[d++]=a.length,k--,a.mode=21;break;case 27:if(a.wrap){for(;g<32;){if(0===m)break e;m--,v|=s[l++]<<g,g+=8}if(x-=k,e.total_out+=x,a.total+=x,x&&(e.adler=a.check=a.flags?r(a.check,f,x,d-x):n(a.check,f,x,d-x)),x=k,(a.flags?v:_(v))!==a.check){e.msg=\\\"incorrect data check\\\",a.mode=p;break}v=0,g=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;g<32;){if(0===m)break e;m--,v+=s[l++]<<g,g+=8}if(v!==(4294967295&a.total)){e.msg=\\\"incorrect length check\\\",a.mode=p;break}v=0,g=0}a.mode=29;case 29:D=1;break e;case p:D=-3;break e;case 31:return-4;default:return u}return e.next_out=d,e.avail_out=k,e.next_in=l,e.avail_in=m,a.hold=v,a.bits=g,(a.wsize||x!==e.avail_out&&a.mode<p&&(a.mode<27||4!==t))&&Z(e,e.output,e.next_out,x-e.avail_out)?(a.mode=31,-4):(y-=e.avail_in,x-=e.avail_out,e.total_in+=y,e.total_out+=x,a.total+=x,a.wrap&&x&&(e.adler=a.check=a.flags?r(a.check,f,x,e.next_out-x):n(a.check,f,x,e.next_out-x)),e.data_type=a.bits+(a.last?64:0)+(a.mode===b?128:0)+(20===a.mode||15===a.mode?256:0),(0===y&&0===x||4===t)&&D===h&&(D=-5),D)},inflateEnd:function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,h},inflateGetHeader:function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?u:(i.head=t,t.done=!1,h):u},inflateSetDictionary:function(e,t){var i,a=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?u:11===i.mode&&n(1,t,a,0)!==i.check?-3:Z(e,t,a,a)?(i.mode=31,-4):(i.havedict=1,h):u},inflateInfo:\\\"pako inflate (from Nodeca project)\\\"},O=!0,U=!0;try{String.fromCharCode.apply(null,[0])}catch(e){O=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){U=!1}for(var L=new i.Buf8(256),C=0;C<256;C++)L[C]=C>=252?6:C>=248?5:C>=240?4:C>=224?3:C>=192?2:1;L[254]=L[254]=1;var N=function(e){var t,n,a,r,o,s=e.length,f=0;for(r=0;r<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(a=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(a-56320),r++),f+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(f),o=0,r=0;o<f;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(a=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(a-56320),r++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},D=function(e,t){var n,a,r,o,s=t||e.length,f=new Array(2*s);for(a=0,n=0;n<s;)if((r=e[n++])<128)f[a++]=r;else if((o=L[r])>4)f[a++]=65533,n+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&n<s;)r=r<<6|63&e[n++],o--;o>1?f[a++]=65533:r<65536?f[a++]=r:(r-=65536,f[a++]=55296|r>>10&1023,f[a++]=56320|1023&r)}return function(e,t){if(t<65537&&(e.subarray&&U||!e.subarray&&O))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n=\\\"\\\",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}(f,a)},I=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+L[e[i]]>t?i:t},F={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},H={2:\\\"need dictionary\\\",1:\\\"stream end\\\",0:\\\"\\\",\\\"-1\\\":\\\"file error\\\",\\\"-2\\\":\\\"stream error\\\",\\\"-3\\\":\\\"data error\\\",\\\"-4\\\":\\\"insufficient memory\\\",\\\"-5\\\":\\\"buffer error\\\",\\\"-6\\\":\\\"incompatible version\\\"},z=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\\\"\\\",this.state=null,this.data_type=2,this.adler=0},j=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\\\"\\\",this.comment=\\\"\\\",this.hcrc=0,this.done=!1},M=Object.prototype.toString;function K(e){if(!(this instanceof K))return new K(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:\\\"\\\"},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg=\\\"\\\",this.ended=!1,this.chunks=[],this.strm=new z,this.strm.avail_out=0;var n=T.inflateInit2(this.strm,t.windowBits);if(n!==F.Z_OK)throw new Error(H[n]);this.header=new j,T.inflateGetHeader(this.strm,this.header)}function P(e,t){var i=new K(t);if(i.push(e,!0),i.err)throw i.msg||H[i.err];return i.result}K.prototype.push=function(e,t){var n,a,r,o,s,f,l=this.strm,d=this.options.chunkSize,c=this.options.dictionary,h=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?F.Z_FINISH:F.Z_NO_FLUSH,\\\"string\\\"==typeof e?l.input=function(e){for(var t=new i.Buf8(e.length),n=0,a=t.length;n<a;n++)t[n]=e.charCodeAt(n);return t}(e):\\\"[object ArrayBuffer]\\\"===M.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new i.Buf8(d),l.next_out=0,l.avail_out=d),(n=T.inflate(l,F.Z_NO_FLUSH))===F.Z_NEED_DICT&&c&&(f=\\\"string\\\"==typeof c?N(c):\\\"[object ArrayBuffer]\\\"===M.call(c)?new Uint8Array(c):c,n=T.inflateSetDictionary(this.strm,f)),n===F.Z_BUF_ERROR&&!0===h&&(n=F.Z_OK,h=!1),n!==F.Z_STREAM_END&&n!==F.Z_OK)return this.onEnd(n),this.ended=!0,!1;l.next_out&&(0!==l.avail_out&&n!==F.Z_STREAM_END&&(0!==l.avail_in||a!==F.Z_FINISH&&a!==F.Z_SYNC_FLUSH)||(\\\"string\\\"===this.options.to?(r=I(l.output,l.next_out),o=l.next_out-r,s=D(l.output,r),l.next_out=o,l.avail_out=d-o,o&&i.arraySet(l.output,l.output,r,o,0),this.onData(s)):this.onData(i.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(h=!0)}while((l.avail_in>0||0===l.avail_out)&&n!==F.Z_STREAM_END);return n===F.Z_STREAM_END&&(a=F.Z_FINISH),a===F.Z_FINISH?(n=T.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===F.Z_OK):a!==F.Z_SYNC_FLUSH||(this.onEnd(F.Z_OK),l.avail_out=0,!0)},K.prototype.onData=function(e){this.chunks.push(e)},K.prototype.onEnd=function(e){e===F.Z_OK&&(\\\"string\\\"===this.options.to?this.result=this.chunks.join(\\\"\\\"):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var J={Inflate:K,inflate:P,inflateRaw:function(e,t){return(t=t||{}).raw=!0,P(e,t)},ungzip:P},Y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e),this.dataView=new DataView(t),this.position=0}return e.prototype.skip=function(e){this.position+=e},e.prototype.readBytes=function(e){var t=4===e?\\\"getUint32\\\":2===e?\\\"getUint16\\\":\\\"getUint8\\\",i=this.position;return this.position+=e,this.dataView[t](i,!0)},e}(),G=function(e){for(var t=new Y(e),i={};;){var n=t.readBytes(4);if(67324752!==n){if(33639248!==n)break;V(t)}else{var a=$(t);i[a.name]={buffer:a.buffer}}}return i},$=function(e){var t=0,i=void 0;e.skip(4);var n=e.readBytes(2);e.skip(8);var a=e.readBytes(4);e.skip(4);var r=e.readBytes(2),o=e.readBytes(2),s=[],f=new Uint8Array(a);for(t=0;t<r;t++)s.push(String.fromCharCode(e.readBytes(1)));for(e.skip(o),t=0;t<a;t++)f[t]=e.readBytes(1);switch(n){case 0:i=f;break;case 8:i=new Uint8Array(J.inflate(f,{raw:!0}));break;default:console.log(s.join(\\\"\\\")+\\\": unsupported compression type\\\"),i=f}return{name:s.join(\\\"\\\"),buffer:i}},V=function(e){e.skip(24);var t=e.readBytes(2),i=e.readBytes(2),n=e.readBytes(2);e.skip(12),e.skip(t),e.skip(i),e.skip(n)},X=\\\"function\\\"==typeof Promise?Promise:function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e);var i=function(){};return t((function(){i()})),{then:function(e){i=e}}},q=0,W=void 0,Q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e),this._id=q,this._listeners={},this.url=t,this.files=null,q++}return e.unzip=function(t){return new X((function(i){var n=new e,a=new FileReader;a.onload=function(e){var t=e.target.result;n.files=G(t),i(n)},t instanceof Blob&&a.readAsArrayBuffer(t)}))},e.prototype.load=function(){var e=this;return new X((function(t){var i=Date.now(),n=new XMLHttpRequest;n.open(\\\"GET\\\",e.url,!0),n.responseType=\\\"arraybuffer\\\",n.onprogress=function(t){e.dispatch({type:\\\"progress\\\",loaded:t.loaded,total:t.total,elapsedTime:Date.now()-i})},n.onload=function(){e.files=G(n.response),e.dispatch({type:\\\"load\\\",elapsedTime:Date.now()-i}),t()},n.send()}))},e.prototype.extractAsBlobUrl=function(e,t){if(this.files[e].url)return this.files[e].url;var i=new Blob([this.files[e].buffer],{type:t});return this.files[e].url=URL.createObjectURL(i),this.files[e].url},e.prototype.extractAsText=function(e){var t=this.files[e].buffer;if(\\\"undefined\\\"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var i=\\\"\\\",n=0,a=t.length;n<a;n++)i+=String.fromCharCode(t[n]);return decodeURIComponent(escape(i))},e.prototype.extractAsJSON=function(e){return JSON.parse(this.extractAsText(e))},e.prototype.loadThreeJSON=function(e){var t=this,i=this.extractAsJSON(e),n=e.replace(/\\\\/.+\\\\.json$/,\\\"/\\\"),a=\\\"__ziploader_\\\"+this._id+\\\"__\\\",r=new RegExp(a);return-1!==!W.Loader.Handlers.handlers.indexOf(r)&&W.Loader.Handlers.add(r,{load:function(e){return t.loadThreeTexture(e.replace(r,\\\"\\\"))}}),W.JSONLoader.prototype.parse(i,a+n)},e.prototype.loadThreeTexture=function(e){var t=new W.Texture,i=/\\\\.jpg$/.test(e)?\\\"image/jpeg\\\":/\\\\.png$/.test(e)?\\\"image/png\\\":/\\\\.gif$/.test(e)?\\\"image/gif\\\":void 0,n=new Blob([this.files[e].buffer],{type:i});return t.image=new Image,t.image.addEventListener(\\\"load\\\",(function e(){t.needsUpdate=!0,t.image.removeEventListener(\\\"load\\\",e),URL.revokeObjectURL(t.image.src)})),t.image.src=URL.createObjectURL(n),t},e.prototype.on=function(e,t){this._listeners[e]||(this._listeners[e]=[]),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)},e.prototype.off=function(e,t){var i=this._listeners[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},e.prototype.dispatch=function(e){var t=this._listeners[e.type];if(t){e.target=this;for(var i=t.length,n=0;n<i;n++)t[n].call(this,e)}},e.prototype.clear=function(e){if(e)return URL.revokeObjectURL(this.files[e].url),void delete this.files[e];for(var t in this.files)URL.revokeObjectURL(this.files[t].url);if(delete this.files,W){var i=\\\"__ziploader_\\\"+this._id+\\\"__\\\";W.Loader.Handlers.handlers.some((function(e,t){if(e instanceof RegExp&&e.source===i)return W.Loader.Handlers.handlers.splice(t,2),!0}))}},e.install=function(e){e.THREE&&(W=e.THREE)},e}();function ee(e,t,i,n,a,r,o){try{var s=e[r](o),f=s.value}catch(e){return void i(e)}s.done?t(f):Promise.resolve(f).then(n,a)}function te(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var r=e.apply(t,i);function o(e){ee(r,n,a,o,s,\\\"next\\\",e)}function s(e){ee(r,n,a,o,s,\\\"throw\\\",e)}o(void 0)}))}}function ie(){return(ie=te((function*(e){const t=new Q(e);return t.load().then((()=>{const e={},i=i=>(e[i]=e[i]||t.extractAsBlobUrl(i),e[i]),n=JSON.parse(t.extractAsText(\\\"scene.gltf\\\"));return n.buffers&&n.buffers.forEach((e=>e.uri=i(e.uri))),n.images&&n.images.forEach((e=>e.uri=i(e.uri))),e[\\\"scene.gtlf\\\"]=URL.createObjectURL(new Blob([JSON.stringify(n,null,2)],{type:\\\"text/plain\\\"})),e}))}))).apply(this,arguments)}self.onmessage=function(){var e=te((function*(e){try{const t=yield function(e){return ie.apply(this,arguments)}(e.data.payload);self.postMessage({id:e.data.id,result:t})}catch(t){self.postMessage({id:e.data.id,err:t.message})}}));return function(t){return e.apply(this,arguments)}}()}();\\n\", \"Worker\", undefined, undefined);\n}\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    paused: { type: \"boolean\", default: false },\n    /* DEPRECATED: Use activeClipIndex instead since animation names are not unique */\n    clip: { type: \"string\", default: \"\" },\n    activeClipIndex: { type: \"int\", default: 0 },\n    activeClipIndices: { type: \"array\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n    this.currentActions = [];\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n  },\n\n  update(oldData) {\n    if (this.mixerEl) {\n      if (oldData.clip !== this.data.clip || oldData.activeClipIndex !== this.data.activeClipIndex) {\n        this.updateClip();\n      }\n\n      if (oldData.paused !== this.data.paused) {\n        for (let i = 0; i < this.currentActions.length; i++) {\n          this.currentActions[i].paused = this.data.paused;\n        }\n      }\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const { clip: clipName, activeClipIndex } = this.data;\n    const { activeClipIndices } = this.data;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clips = [];\n    if (activeClipIndices && activeClipIndices.length > 0) {\n      // Support for Spoke->Hubs activeClipIndices struct\n      clips = activeClipIndices.map(index => animations[index]);\n    } else {\n      // Support for old Spoke->Hubs { clipName, activeClipIndex } struct. Still used for Blender imports.\n      if (clipName !== \"\") {\n        const clipNames = clipName.split(\",\");\n        for (let i = 0; i < clipNames.length; i++) {\n          const n = clipNames[i];\n          const a = animations.find(({ name }) => name === n);\n          if (a) {\n            clips.push(a);\n          } else {\n            console.warn(`Could not find animation named '${n}' in ${this.el.className}`);\n          }\n        }\n      } else {\n        clips = [animations[activeClipIndex]];\n      }\n    }\n\n    if (!(clips && clips.length)) return;\n\n    this.currentActions.length = 0;\n\n    for (let i = 0; i < clips.length; i++) {\n      const action = mixer.clipAction(clips[i], this.el.object3D);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.currentActions.push(action);\n    }\n  },\n\n  destroy() {\n    for (let i = 0; i < this.currentActions.length; i++) {\n      this.currentActions[i].enabled = false;\n      this.currentActions[i].stop();\n    }\n    this.currentActions.length = 0;\n  }\n});\n","const textureToData = new Map();\nconst registeredTextures = [];\n\nexport class UVScrollSystem {\n  tick(dt) {\n    for (let i = 0; i < registeredTextures.length; i++) {\n      const map = registeredTextures[i];\n      const { offset, instances } = textureToData.get(map);\n      const { component } = instances[0];\n\n      offset.addScaledVector(component.data.speed, dt / 1000);\n\n      offset.x = offset.x % 1.0;\n      offset.y = offset.y % 1.0;\n\n      const increment = component.data.increment;\n      map.offset.x = increment.x ? offset.x - (offset.x % increment.x) : offset.x;\n      map.offset.y = increment.y ? offset.y - (offset.y % increment.y) : offset.y;\n    }\n  }\n}\n\n/**\n * Animate the UV offset of a mesh's material\n * @component uv-scroll\n */\nAFRAME.registerComponent(\"uv-scroll\", {\n  schema: {\n    speed: { type: \"vec2\", default: { x: 0, y: 0 } },\n    increment: { type: \"vec2\", default: { x: 0, y: 0 } }\n  },\n  play() {\n    const mesh = this.el.getObject3D(\"mesh\") || this.el.getObject3D(\"skinnedmesh\");\n    const material = mesh && mesh.material;\n    if (material) {\n      // We store mesh here instead of the material directly because we end up swapping out the material in injectCustomShaderChunks.\n      // We need material in the first place because of MobileStandardMaterial\n      const instance = { component: this, mesh };\n\n      this.instance = instance;\n      this.map = material.map || material.emissiveMap;\n\n      if (this.map && !textureToData.has(this.map)) {\n        textureToData.set(this.map, {\n          offset: new THREE.Vector2(),\n          instances: [instance]\n        });\n        registeredTextures.push(this.map);\n      } else if (!this.map) {\n        console.warn(\"Ignoring uv-scroll added to mesh with no scrollable texture.\");\n      } else {\n        console.warn(\n          \"Multiple uv-scroll instances added to objects sharing a texture, only the speed/increment from the first one will have any effect\"\n        );\n        textureToData.get(this.map).instances.push(instance);\n      }\n    }\n  },\n\n  pause() {\n    if (this.map) {\n      const instances = textureToData.get(this.map).instances;\n      instances.splice(instances.indexOf(this.instance), 1);\n      // If this was the last uv-scroll component for a given texture\n      if (!instances.length) {\n        textureToData.delete(this.map);\n        registeredTextures.splice(registeredTextures.indexOf(this.map), 1);\n      }\n    }\n  }\n});\n","function isVisibleUpToRoot(node, root) {\n  let child = node;\n  while (child) {\n    if (child === root) return true;\n    if (!child.visible) return false;\n    child = child.parent;\n  }\n  console.error(`Root ${root} is not an ancestor of node ${node}`);\n  return false;\n}\n\n// HACK Troika Text GlyphGeometry doesn't play nicely with this code. Also it's infinitely thin.\n// We don't particularly care about it's bounds, but its important that they are non zero since\n// other code checks for that case. Fudge it for now with a very small static box.\nconst FAKE_TROIKA_BOUNDS = new THREE.Box3(\n  new THREE.Vector3(-0.001, -0.001, -0.001),\n  new THREE.Vector3(0.001, 0.001, 0.001)\n);\n\n// TODO This whole function is suspect for manually computing bounding boxes when geometry already has code for this\nexport const computeLocalBoundingBox = (function() {\n  const vertex = new THREE.Vector3();\n  const rootInverse = new THREE.Matrix4();\n  const toRootSpace = new THREE.Matrix4();\n  return function computeLocalBoundingBox(root, box, excludeInvisible) {\n    box.makeEmpty();\n    root.updateMatrices();\n    rootInverse.copy(root.matrixWorld).invert();\n    root.traverse(node => {\n      if (excludeInvisible && !isVisibleUpToRoot(node, root)) {\n        return;\n      }\n      node.updateMatrices();\n      toRootSpace.multiplyMatrices(rootInverse, node.matrixWorld);\n      if (node.geometry) {\n        if (node.isTroikaText) {\n          box.union(FAKE_TROIKA_BOUNDS);\n        } else if (node.geometry.isGeometry) {\n          for (let i = 0; i < node.geometry.vertices; i++) {\n            vertex.copy(node.geometry.vertices[i]).applyMatrix4(toRootSpace);\n            if (isNaN(vertex.x)) continue;\n            box.expandByPoint(vertex);\n          }\n        } else if (node.geometry.isBufferGeometry && node.geometry.attributes.position) {\n          const array = node.geometry.attributes.position.array;\n          const itemSize = node.geometry.attributes.position.itemSize;\n          for (let i = 0; i < node.geometry.attributes.position.count; i++) {\n            if (itemSize === 2) {\n              vertex.set(array[2 * i], array[2 * i + 1], 0);\n            } else if (itemSize === 3) {\n              vertex.fromBufferAttribute(node.geometry.attributes.position, i);\n            } else {\n              return;\n            }\n            vertex.applyMatrix4(toRootSpace);\n            if (isNaN(vertex.x)) continue;\n            box.expandByPoint(vertex);\n          }\n        }\n      }\n    });\n  };\n})();\n\n// Computes an AABB that surrounds the object in question and all of its children.\n// Note that if the children have rotations, this probably won't return the tightest\n// possible AABB -- we could return a tighter one if we examined all of the vertices\n// of the geometry for ourselves, but we don't care enough for what we're using this\n// for to do so much work.\nexport const computeObjectAABB = (function() {\n  const bounds = new THREE.Box3();\n  return function computeObjectAABB(root, target, excludeInvisible) {\n    target.makeEmpty();\n    root.updateMatrices();\n    root.traverse(node => {\n      if (excludeInvisible && !isVisibleUpToRoot(node, root)) {\n        return;\n      }\n      node.updateMatrices();\n      const geometry = node.geometry;\n      if (geometry != null) {\n        if (geometry.boundingBox == null) {\n          geometry.computeBoundingBox();\n        }\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\n      }\n    });\n    return target;\n  };\n})();\n\nconst rotation = new THREE.Euler();\nexport function getBox(entity, boxRoot, worldSpace) {\n  const box = new THREE.Box3();\n\n  rotation.copy(entity.object3D.rotation);\n  entity.object3D.rotation.set(0, 0, 0);\n\n  entity.object3D.updateMatrices(true, true);\n  boxRoot.updateMatrices(true, true);\n  boxRoot.updateMatrixWorld(true);\n\n  computeObjectAABB(boxRoot, box, false);\n\n  if (!box.isEmpty()) {\n    if (!worldSpace) {\n      entity.object3D.worldToLocal(box.min);\n      entity.object3D.worldToLocal(box.max);\n    }\n    entity.object3D.rotation.copy(rotation);\n    entity.object3D.matrixNeedsUpdate = true;\n  }\n\n  boxRoot.matrixWorldNeedsUpdate = true;\n  boxRoot.updateMatrices();\n\n  return box;\n}\n\nexport function getScaleCoefficient(length, box) {\n  if (box.isEmpty()) return 1.0;\n\n  const { max, min } = box;\n  const dX = Math.abs(max.x - min.x);\n  const dY = Math.abs(max.y - min.y);\n  const dZ = Math.abs(max.z - min.z);\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\n  return length / lengthOfLongestComponent;\n}\n","// TODO: Reintroduce audio normalization\n// import { AudioNormalizer } from \"../utils/audio-normalizer\";\n\nexport const DISTANCE_MODEL_OPTIONS = [\"linear\", \"inverse\", \"exponential\"];\n\nexport const SourceType = Object.freeze({\n  MEDIA_VIDEO: 0,\n  AVATAR_AUDIO_SOURCE: 1,\n  SFX: 2,\n  AUDIO_TARGET: 3,\n  AUDIO_ZONE: 4\n});\n\nexport const AudioType = {\n  Stereo: \"stereo\",\n  PannerNode: \"pannernode\"\n};\n\nexport const DistanceModelType = {\n  Linear: \"linear\",\n  Inverse: \"inverse\",\n  Exponential: \"exponential\"\n};\n\nexport const PanningModelType = Object.freeze({\n  HRTF: \"HRTF\",\n  EqualPower: \"equalpower\"\n});\n\nexport const AvatarAudioDefaults = Object.freeze({\n  audioType: AudioType.PannerNode,\n  distanceModel: DistanceModelType.Inverse,\n  panningModel: PanningModelType.HRTF,\n  rolloffFactor: 5,\n  refDistance: 5,\n  maxDistance: 10000,\n  coneInnerAngle: 180,\n  coneOuterAngle: 360,\n  coneOuterGain: 0.9,\n  gain: 1.0\n});\n\nexport const MediaAudioDefaults = Object.freeze({\n  audioType: AudioType.PannerNode,\n  distanceModel: DistanceModelType.Inverse,\n  panningModel: PanningModelType.HRTF,\n  rolloffFactor: 5,\n  refDistance: 5,\n  maxDistance: 10000,\n  coneInnerAngle: 360,\n  coneOuterAngle: 0,\n  coneOuterGain: 0.9,\n  gain: 0.5\n});\n\nexport const TargetAudioDefaults = Object.freeze({\n  audioType: AudioType.PannerNode,\n  distanceModel: DistanceModelType.Inverse,\n  panningModel: PanningModelType.HRTF,\n  rolloffFactor: 5,\n  refDistance: 8,\n  maxDistance: 10000,\n  coneInnerAngle: 170,\n  coneOuterAngle: 300,\n  coneOuterGain: 0.3,\n  gain: 1.0\n});\n\nexport const GAIN_TIME_CONST = 0.2;\n","import {\n  AudioType,\n  SourceType,\n  PanningModelType,\n  MediaAudioDefaults,\n  AvatarAudioDefaults,\n  TargetAudioDefaults\n} from \"./components/audio-params\";\n\nconst defaultSettingsForSourceType = Object.freeze(\n  new Map([\n    [SourceType.MEDIA_VIDEO, MediaAudioDefaults],\n    [SourceType.AVATAR_AUDIO_SOURCE, AvatarAudioDefaults],\n    [SourceType.AUDIO_TARGET, TargetAudioDefaults]\n  ])\n);\n\nfunction applySettings(audio, settings) {\n  if (audio.panner) {\n    audio.setDistanceModel(settings.distanceModel);\n    audio.setRolloffFactor(settings.rolloffFactor);\n    audio.setRefDistance(settings.refDistance);\n    audio.setMaxDistance(settings.maxDistance);\n    audio.panner.panningModel = settings.panningModel;\n    audio.panner.coneInnerAngle = settings.coneInnerAngle;\n    audio.panner.coneOuterAngle = settings.coneOuterAngle;\n    audio.panner.coneOuterGain = settings.coneOuterGain;\n  }\n  audio.gain.gain.setTargetAtTime(settings.gain, audio.context.currentTime, 0.1);\n}\n\nexport function getOverriddenPanningModelType() {\n  switch (APP.store.state.preferences.audioPanningQuality) {\n    case \"High\":\n      return PanningModelType.HRTF;\n    case \"Low\":\n      return PanningModelType.EqualPower;\n    default:\n      return null;\n  }\n}\n\nexport function getCurrentAudioSettings(el) {\n  const sourceType = APP.sourceType.get(el);\n  const defaults = defaultSettingsForSourceType.get(sourceType);\n  const sceneOverrides = APP.sceneAudioDefaults.get(sourceType);\n  const audioOverrides = APP.audioOverrides.get(el);\n  const audioDebugPanelOverrides = APP.audioDebugPanelOverrides.get(sourceType);\n  const zoneSettings = APP.zoneOverrides.get(el);\n  const preferencesOverrides = {};\n\n  const overriddenPanningModelType = getOverriddenPanningModelType();\n\n  if (overriddenPanningModelType !== null) {\n    preferencesOverrides.panningModel = overriddenPanningModelType;\n  }\n\n  if (APP.store.state.preferences.disableLeftRightPanning) {\n    preferencesOverrides.audioType = AudioType.Stereo;\n  }\n\n  const settings = Object.assign(\n    {},\n    defaults,\n    sceneOverrides,\n    audioOverrides,\n    audioDebugPanelOverrides,\n    zoneSettings,\n    preferencesOverrides\n  );\n\n  if (APP.clippingState.has(el) || APP.mutedState.has(el)) {\n    settings.gain = 0;\n  } else if (APP.gainMultipliers.has(el)) {\n    settings.gain = settings.gain * APP.gainMultipliers.get(el);\n  }\n\n  if (APP.supplementaryAttenuation.has(el)) {\n    settings.gain = settings.gain * APP.supplementaryAttenuation.get(el);\n  }\n\n  return settings;\n}\n\nexport function getCurrentAudioSettingsForSourceType(sourceType) {\n  const defaults = defaultSettingsForSourceType.get(sourceType);\n  const sceneOverrides = APP.sceneAudioDefaults.get(sourceType);\n  const audioDebugPanelOverrides = APP.audioDebugPanelOverrides.get(sourceType);\n  return Object.assign({}, defaults, sceneOverrides, audioDebugPanelOverrides);\n}\n\nexport function updateAudioSettings(el, audio) {\n  // Follow these rules and you'll have a good time:\n  // - If a THREE.Audio or THREE.PositionalAudio is created, call this function.\n  // - If audio settings change, call this function.\n  const settings = getCurrentAudioSettings(el);\n  if (\n    (audio.panner === undefined && settings.audioType === AudioType.PannerNode) ||\n    (audio.panner !== undefined && settings.audioType === AudioType.Stereo)\n  ) {\n    el.emit(\"audio_type_changed\");\n  }\n  applySettings(audio, settings);\n}\n\nexport function shouldAddSupplementaryAttenuation(el, audio) {\n  // Never add supplemental attenuation to audios that have a panner node;\n  // The panner node adds its own attenuation.\n  if (audio.panner) return false;\n\n  // This function must distinguish between Audios that are \"incidentally\"\n  // not PositionalAudios from Audios that are \"purposefully\" not PositionalAudios:\n  // - An audio is \"incidentally\" non-positional if it only non-positional\n  //     because the disableLeftRightPanning pref is set to true, or\n  //     because panner nodes are broken on a particular platform, or\n  //     because of something else like that.\n  // - An audio is \"purposefully\" non-positional if it was authored to be\n  //     a \"background sound\" or otherwise made that way \"on purpose\".\n  //\n  // Authoring tools like Spoke create components where \"audioType : stereo\"\n  // is used to indicate that audio should play in the background without\n  // left/right panning and without distance-based attenuation.\n  //\n  // Those components also include properties like distanceModel, rolloffFactor, etc,\n  // but these properties were assumed to be ignored by the client.\n  // Thus we cannot simply apply the attenuation values we would get if we calculated\n  // attenuation with the provided distanceModel, rolloffFactor, etc.\n  //\n  // Instead, we determine what the audioType would be if it were not for the\n  // \"incidental\" factors. In particular, we check if the audioType would have\n  // been PannerNode if we ignored the overrides due to disableLeftRightPanning and platform\n  // problems (e.g. Safari).\n  //\n  // If the audioType would have been PannerNode, then we should apply \"fake\",\n  // \"supplementary\" attenuation. Otherwise, the audio is purposefully a\n  // \"background sound\" and we should not apply supplementary attenuation.\n  const sourceType = APP.sourceType.get(el);\n  const defaults = defaultSettingsForSourceType.get(sourceType);\n  const sceneOverrides = APP.sceneAudioDefaults.get(sourceType);\n  const audioDebugPanelOverrides = APP.audioDebugPanelOverrides.get(sourceType);\n  const audioOverrides = APP.audioOverrides.get(el);\n  const zoneSettings = APP.zoneOverrides.get(el);\n  const settings = Object.assign({}, defaults, sceneOverrides, audioDebugPanelOverrides, audioOverrides, zoneSettings);\n  return settings.audioType === AudioType.PannerNode;\n}\n","/* global fetch THREE */\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\nimport URL_POP from \"../assets/sfx/pop.mp3\";\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\nimport URL_SPAWN_EMOJI from \"../assets/sfx/emoji.mp3\";\nimport URL_SPEAKER_TONE from \"../assets/sfx/tone.mp3\";\nimport { setMatrixWorld } from \"../utils/three-utils\";\nimport { SourceType } from \"../components/audio-params\";\nimport { getOverriddenPanningModelType } from \"../update-audio-settings\";\n\nlet soundEnum = 0;\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\nexport const SOUND_THAW = soundEnum++;\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\nexport const SOUND_TOGGLE_MIC = soundEnum++;\nexport const SOUND_TELEPORT_START = soundEnum++;\nexport const SOUND_TELEPORT_END = soundEnum++;\nexport const SOUND_WAYPOINT_START = soundEnum++;\nexport const SOUND_WAYPOINT_END = soundEnum++;\nexport const SOUND_SNAP_ROTATE = soundEnum++;\nexport const SOUND_SPAWN_PEN = soundEnum++;\nexport const SOUND_PEN_START_DRAW = soundEnum++;\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\nexport const SOUND_ENTER_SCENE = soundEnum++;\nexport const SOUND_QUACK = soundEnum++;\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\nexport const SOUND_FREEZE = soundEnum++;\nexport const SOUND_PIN = soundEnum++;\nexport const SOUND_MEDIA_LOADING = soundEnum++;\nexport const SOUND_MEDIA_LOADED = soundEnum++;\nexport const SOUND_CAMERA_TOOL_COUNTDOWN = soundEnum++;\nexport const SOUND_PREFERENCE_MENU_HOVER = soundEnum++;\nexport const SOUND_SPAWN_EMOJI = soundEnum++;\nexport const SOUND_SPEAKER_TONE = soundEnum++;\n\n// Safari doesn't support the promise form of decodeAudioData, so we polyfill it.\nfunction decodeAudioData(audioContext, arrayBuffer) {\n  return new Promise((resolve, reject) => {\n    audioContext.decodeAudioData(arrayBuffer, resolve, reject);\n  });\n}\n\nexport class SoundEffectsSystem {\n  constructor(scene) {\n    this.pendingAudioSourceNodes = [];\n    this.pendingPositionalAudios = [];\n    this.positionalAudiosStationary = [];\n    this.positionalAudiosFollowingObject3Ds = [];\n\n    this.audioContext = THREE.AudioContext.getContext();\n    this.scene = scene;\n\n    const soundsAndUrls = [\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\n      [SOUND_THAW, URL_TICK],\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\n      [SOUND_TOGGLE_MIC, URL_TICK],\n      [SOUND_CAMERA_TOOL_COUNTDOWN, URL_TICK],\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\n      [SOUND_WAYPOINT_START, URL_QUICK_TURN],\n      [SOUND_WAYPOINT_END, URL_TICK],\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\n      [SOUND_ENTER_SCENE, URL_WELCOME],\n      [SOUND_QUACK, URL_QUACK],\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\n      [SOUND_CHAT_MESSAGE, URL_POP],\n      [SOUND_FREEZE, URL_FREEZE],\n      [SOUND_PIN, URL_TACK],\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED],\n      [SOUND_PREFERENCE_MENU_HOVER, URL_FREEZE],\n      [SOUND_SPAWN_EMOJI, URL_SPAWN_EMOJI],\n      [SOUND_SPEAKER_TONE, URL_SPEAKER_TONE]\n    ];\n    const loading = new Map();\n    const load = url => {\n      let audioBufferPromise = loading.get(url);\n      if (!audioBufferPromise) {\n        audioBufferPromise = fetch(url)\n          .then(r => r.arrayBuffer())\n          .then(arrayBuffer => decodeAudioData(this.audioContext, arrayBuffer));\n        loading.set(url, audioBufferPromise);\n      }\n      return audioBufferPromise;\n    };\n    this.sounds = new Map();\n    soundsAndUrls.map(([sound, url]) => {\n      load(url).then(audioBuffer => {\n        this.sounds.set(sound, audioBuffer);\n      });\n    });\n\n    this.isDisabled = window.APP.store.state.preferences.disableSoundEffects;\n    window.APP.store.addEventListener(\"statechanged\", () => {\n      const shouldBeDisabled = window.APP.store.state.preferences.disableSoundEffects;\n      if (shouldBeDisabled && !this.isDisabled) {\n        this.stopAllPositionalAudios();\n        // TODO: Technically we should stop any other sounds that have been started,\n        // but we do not hold references to these and they're short-lived so I didn't bother.\n      }\n      this.isDisabled = shouldBeDisabled;\n    });\n  }\n\n  enqueueSound(sound, loop) {\n    if (this.isDisabled) return null;\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n    // The nodes are very inexpensive to create, according to\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\n    const source = this.audioContext.createBufferSource();\n    source.buffer = audioBuffer;\n    this.scene.systems[\"hubs-systems\"].audioSystem.addAudio({ sourceType: SourceType.SFX, node: source });\n    source.loop = loop;\n    this.pendingAudioSourceNodes.push(source);\n    return source;\n  }\n\n  enqueuePositionalSound(sound, loop) {\n    if (this.isDisabled) return null;\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const disablePositionalAudio = window.APP.store.state.preferences.disableLeftRightPanning;\n    const positionalAudio = disablePositionalAudio\n      ? new THREE.Audio(this.scene.audioListener)\n      : new THREE.PositionalAudio(this.scene.audioListener);\n    positionalAudio.setBuffer(audioBuffer);\n    positionalAudio.loop = loop;\n    if (!disablePositionalAudio) {\n      const overriddenPanningModelType = getOverriddenPanningModelType();\n      if (overriddenPanningModelType !== null) {\n        positionalAudio.panner.panningModel = overriddenPanningModelType;\n      }\n    }\n    this.pendingPositionalAudios.push(positionalAudio);\n    this.scene.systems[\"hubs-systems\"].audioSystem.addAudio({\n      sourceType: SourceType.SFX,\n      node: positionalAudio\n    });\n    return positionalAudio;\n  }\n\n  playPositionalSoundAt(sound, position, loop) {\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\n    if (!positionalAudio) return null;\n    positionalAudio.position.copy(position);\n    positionalAudio.matrixWorldNeedsUpdate = true;\n    this.positionalAudiosStationary.push(positionalAudio);\n  }\n\n  playPositionalSoundFollowing(sound, object3D, loop) {\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\n    if (!positionalAudio) return null;\n    this.positionalAudiosFollowingObject3Ds.push({ positionalAudio, object3D });\n    return positionalAudio;\n  }\n\n  playSoundOneShot(sound) {\n    return this.enqueueSound(sound, false);\n  }\n\n  playSoundLooped(sound) {\n    return this.enqueueSound(sound, true);\n  }\n\n  playSoundLoopedWithGain(sound) {\n    if (this.isDisabled) return null;\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const source = this.audioContext.createBufferSource();\n    const gain = this.audioContext.createGain();\n    source.buffer = audioBuffer;\n    source.connect(gain);\n    this.scene.systems[\"hubs-systems\"].audioSystem.addAudio({ sourceType: SourceType.SFX, node: gain });\n    source.loop = true;\n    this.pendingAudioSourceNodes.push(source);\n    return { gain, source };\n  }\n\n  stopSoundNode(node) {\n    const index = this.pendingAudioSourceNodes.indexOf(node);\n    if (index !== -1) {\n      this.pendingAudioSourceNodes.splice(index, 1);\n    } else {\n      node.stop();\n      this.scene.systems[\"hubs-systems\"].audioSystem.removeAudio({ node });\n    }\n  }\n\n  stopPositionalAudio(inPositionalAudio) {\n    const pendingIndex = this.pendingPositionalAudios.indexOf(inPositionalAudio);\n    if (pendingIndex !== -1) {\n      this.pendingPositionalAudios.splice(pendingIndex, 1);\n    } else {\n      if (inPositionalAudio.isPlaying) {\n        inPositionalAudio.stop();\n      }\n      if (inPositionalAudio.parent) {\n        inPositionalAudio.removeFromParent();\n      }\n    }\n    this.positionalAudiosStationary = this.positionalAudiosStationary.filter(\n      positionalAudio => positionalAudio !== inPositionalAudio\n    );\n    this.positionalAudiosFollowingObject3Ds = this.positionalAudiosFollowingObject3Ds.filter(\n      ({ positionalAudio }) => positionalAudio !== inPositionalAudio\n    );\n    this.scene.systems[\"hubs-systems\"].audioSystem.removeAudio({ node: inPositionalAudio });\n  }\n\n  stopAllPositionalAudios() {\n    for (let i = this.positionalAudiosStationary.length - 1; i >= 0; i--) {\n      const positionalAudio = this.positionalAudiosStationary[i];\n      this.stopPositionalAudio(positionalAudio);\n    }\n\n    for (let i = this.positionalAudiosFollowingObject3Ds.length - 1; i >= 0; i--) {\n      const positionalAudioAndObject3D = this.positionalAudiosFollowingObject3Ds[i];\n      const positionalAudio = positionalAudioAndObject3D.positionalAudio;\n      this.stopPositionalAudio(positionalAudio);\n    }\n  }\n\n  tick() {\n    if (this.isDisabled) {\n      return;\n    }\n\n    for (let i = 0; i < this.pendingAudioSourceNodes.length; i++) {\n      this.pendingAudioSourceNodes[i].start();\n    }\n    this.pendingAudioSourceNodes.length = 0;\n\n    for (let i = 0; i < this.pendingPositionalAudios.length; i++) {\n      const pendingPositionalAudio = this.pendingPositionalAudios[i];\n      this.scene.object3D.add(pendingPositionalAudio);\n      pendingPositionalAudio.play();\n    }\n    this.pendingPositionalAudios.length = 0;\n\n    for (let i = this.positionalAudiosStationary.length - 1; i >= 0; i--) {\n      const positionalAudio = this.positionalAudiosStationary[i];\n      if (!positionalAudio.isPlaying) {\n        this.stopPositionalAudio(positionalAudio);\n      }\n    }\n\n    for (let i = this.positionalAudiosFollowingObject3Ds.length - 1; i >= 0; i--) {\n      const positionalAudioAndObject3D = this.positionalAudiosFollowingObject3Ds[i];\n      const positionalAudio = positionalAudioAndObject3D.positionalAudio;\n      const object3D = positionalAudioAndObject3D.object3D;\n      if (!positionalAudio.isPlaying || !object3D.parent) {\n        this.stopPositionalAudio(positionalAudio);\n      } else {\n        object3D.updateMatrices();\n        setMatrixWorld(positionalAudio, object3D.matrixWorld);\n      }\n    }\n  }\n}\n","import { computeObjectAABB, getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport {\n  resolveUrl,\n  getDefaultResolveQuality,\n  injectCustomShaderChunks,\n  addMeshScaleAnimation,\n  closeExistingMediaMirror\n} from \"../utils/media-utils\";\nimport {\n  isNonCorsProxyDomain,\n  guessContentType,\n  proxiedUrlFor,\n  isHubsRoomUrl,\n  isLocalHubsSceneUrl,\n  isLocalHubsAvatarUrl\n} from \"../utils/media-url-utils\";\nimport { addAnimationComponents } from \"../utils/animation\";\n\nimport loadingObjectSrc from \"../assets/models/LoadingObject_Atom.glb\";\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\nimport { loadModel } from \"./gltf-model-plus\";\nimport { cloneObject3D, setMatrixWorld } from \"../utils/three-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nimport { SHAPE } from \"three-ammo/constants\";\nimport { addComponent, entityExists, removeComponent } from \"bitecs\";\nimport { MediaLoading } from \"../bit-components\";\n\nlet loadingObject;\n\nwaitForDOMContentLoaded().then(() => {\n  loadModel(loadingObjectSrc).then(gltf => {\n    loadingObject = gltf;\n  });\n});\n\nconst fetchContentType = url => {\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\n};\n\nAFRAME.registerComponent(\"media-loader\", {\n  schema: {\n    playSoundEffect: { default: true },\n    fileId: { type: \"string\" },\n    fileIsOwned: { type: \"boolean\" },\n    src: { type: \"string\" },\n    version: { type: \"number\", default: 1 }, // Used to force a re-resolution\n    fitToBox: { default: false },\n    moveTheParentNotTheMesh: { default: false },\n    resolve: { default: false },\n    contentType: { default: null },\n    contentSubtype: { default: null },\n    animate: { default: true },\n    linkedEl: { default: null }, // This is the element of which this is a linked derivative. See linked-media.js\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.onError = this.onError.bind(this);\n    this.showLoader = this.showLoader.bind(this);\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\n    this.handleLinkedElRemoved = this.handleLinkedElRemoved.bind(this);\n    this.refresh = this.refresh.bind(this);\n    this.animating = false;\n\n    try {\n      NAF.utils\n        .getNetworkedEntity(this.el)\n        .then(networkedEl => {\n          this.networkedEl = networkedEl;\n        })\n        .catch(() => {}); //ignore exception, entity might not be networked\n    } catch (e) {\n      // NAF may not exist on scene landing page\n    }\n  },\n\n  updateScale: (function() {\n    const center = new THREE.Vector3();\n    const originalMeshMatrix = new THREE.Matrix4();\n    const desiredObjectMatrix = new THREE.Matrix4();\n    const position = new THREE.Vector3();\n    const quaternion = new THREE.Quaternion();\n    const scale = new THREE.Vector3();\n    const box = new THREE.Box3();\n    return function(fitToBox, moveTheParentNotTheMesh) {\n      this.el.object3D.updateMatrices();\n      const mesh = this.el.getObject3D(\"mesh\");\n      mesh.updateMatrices();\n      if (moveTheParentNotTheMesh) {\n        if (fitToBox) {\n          console.warn(\n            \"Unexpected combination of inputs. Can fit the mesh to a box OR move the parent to the mesh, but did not expect to do both.\",\n            this.el\n          );\n        }\n        // Keep the mesh exactly where it is, but move the parent transform such that it aligns with the center of the mesh's bounding box.\n        originalMeshMatrix.copy(mesh.matrixWorld);\n        computeObjectAABB(mesh, box);\n        center.addVectors(box.min, box.max).multiplyScalar(0.5);\n        this.el.object3D.matrixWorld.decompose(position, quaternion, scale);\n        desiredObjectMatrix.compose(\n          center,\n          quaternion,\n          scale\n        );\n        setMatrixWorld(this.el.object3D, desiredObjectMatrix);\n        mesh.updateMatrices();\n        setMatrixWorld(mesh, originalMeshMatrix);\n      } else {\n        // Move the mesh such that the center of its bounding box is in the same position as the parent matrix position\n        const box = getBox(this.el, mesh);\n        const scaleCoefficient = fitToBox ? getScaleCoefficient(0.5, box) : 1;\n        const { min, max } = box;\n        center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\n        mesh.scale.multiplyScalar(scaleCoefficient);\n        mesh.position.sub(center);\n        mesh.matrixNeedsUpdate = true;\n      }\n    };\n  })(),\n\n  removeShape(id) {\n    if (this.el.getAttribute(\"shape-helper__\" + id)) {\n      this.el.removeAttribute(\"shape-helper__\" + id);\n    }\n  },\n\n  tick(t, dt) {\n    if (this.loaderMixer) {\n      this.loaderMixer.update(dt / 1000);\n    }\n  },\n\n  handleLinkedElRemoved(e) {\n    if (e.detail.name === \"media-loader\") {\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\n\n      // this should be revisited if we ever use media linking for something other than media mirroring UX --\n      // right now it is assumed if there is a linkedEl, this is the currently active mirrored media\n      closeExistingMediaMirror();\n    }\n  },\n\n  remove() {\n    if (this.data.linkedEl) {\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\n    }\n\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n    if (this.loadingSoundEffect) {\n      sfx.stopPositionalAudio(this.loadingSoundEffect);\n      this.loadingSoundEffect = null;\n    }\n    if (this.loadedSoundEffect) {\n      sfx.stopPositionalAudio(this.loadedSoundEffect);\n      this.loadedSoundEffect = null;\n    }\n  },\n\n  onError() {\n    this.el.removeAttribute(\"gltf-model-plus\");\n    this.el.removeAttribute(\"media-pager\");\n    this.el.removeAttribute(\"media-video\");\n    this.el.removeAttribute(\"audio-zone-source\");\n    this.el.removeAttribute(\"media-pdf\");\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\n    this.clearLoadingTimeout();\n  },\n\n  showLoader() {\n    if (this.el.object3DMap.mesh) {\n      this.clearLoadingTimeout();\n      return;\n    }\n    const useFancyLoader = !!loadingObject;\n\n    const mesh = useFancyLoader\n      ? cloneObject3D(loadingObject.scene)\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\n    this.el.setObject3D(\"mesh\", mesh);\n\n    this.updateScale(true, false);\n\n    if (useFancyLoader) {\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\n\n      this.loadingClip = this.loaderMixer.clipAction(mesh.animations[0]);\n      this.loadingScaleClip = this.loaderMixer.clipAction(\n        new THREE.AnimationClip(null, 1000, [\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\n        ])\n      );\n      setTimeout(() => {\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\n        this.el.setAttribute(\"shape-helper__loader\", { type: SHAPE.BOX });\n      }, 200);\n\n      this.loadingClip.play();\n      this.loadingScaleClip.play();\n    }\n\n    if (\n      this.el.sceneEl.is(\"entered\") &&\n      (!this.networkedEl || NAF.utils.isMine(this.networkedEl)) &&\n      this.data.playSoundEffect\n    ) {\n      this.loadingSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\n        SOUND_MEDIA_LOADING,\n        this.el.object3D,\n        true\n      );\n    }\n\n    delete this.showLoaderTimeout;\n  },\n\n  clearLoadingTimeout() {\n    clearTimeout(this.showLoaderTimeout);\n    if (this.loadingSoundEffect) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopPositionalAudio(this.loadingSoundEffect);\n      this.loadingSoundEffect = null;\n    }\n    if (this.loaderMixer) {\n      this.loadingClip.stop();\n      this.loadingScaleClip.stop();\n      delete this.loaderMixer;\n      delete this.loadingScaleClip;\n      delete this.loadingClip;\n    }\n    delete this.showLoaderTimeout;\n    this.removeShape(\"loader\");\n  },\n\n  updateHoverableVisuals: (function() {\n    const boundingBox = new THREE.Box3();\n    const boundingSphere = new THREE.Sphere();\n    return function() {\n      const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\n\n      if (hoverableVisuals) {\n        if (!this.injectedCustomShaderChunks) {\n          this.injectedCustomShaderChunks = true;\n          hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\n        }\n\n        boundingBox.setFromObject(this.el.object3DMap.mesh);\n        boundingBox.getBoundingSphere(boundingSphere);\n        hoverableVisuals.geometryRadius = boundingSphere.radius / this.el.object3D.scale.y;\n      }\n    };\n  })(),\n\n  onMediaLoaded(physicsShape = null, shouldUpdateScale) {\n    const el = this.el;\n    this.clearLoadingTimeout();\n\n    if (this.el.sceneEl.is(\"entered\") && this.data.playSoundEffect) {\n      this.loadedSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\n        SOUND_MEDIA_LOADED,\n        this.el.object3D,\n        false\n      );\n    }\n\n    const finish = () => {\n      this.animating = false;\n\n      if (physicsShape) {\n        el.setAttribute(\"shape-helper\", {\n          type: physicsShape,\n          minHalfExtent: 0.04\n        });\n      }\n\n      this.updateHoverableVisuals();\n\n      if (this.data.linkedEl) {\n        this.el.sceneEl.systems[\"linked-media\"].registerLinkage(this.data.linkedEl, this.el);\n        this.data.linkedEl.addEventListener(\"componentremoved\", this.handleLinkedElRemoved);\n      }\n\n      // TODO this does duplicate work in some cases, but finish() is the only consistent place to do it\n      this.contentBounds = getBox(this.el, this.el.getObject3D(\"mesh\")).getSize(new THREE.Vector3());\n\n      el.emit(\"media-loaded\");\n      if (el.eid && entityExists(APP.world, el.eid)) {\n        removeComponent(APP.world, MediaLoading, el.eid);\n      }\n    };\n\n    if (this.data.animate) {\n      if (!this.animating) {\n        this.animating = true;\n        if (shouldUpdateScale) this.updateScale(this.data.fitToBox, this.data.moveTheParentNotTheMesh);\n        const mesh = this.el.getObject3D(\"mesh\");\n        const scale = { x: 0.001, y: 0.001, z: 0.001 };\n        scale.x = mesh.scale.x < scale.x ? mesh.scale.x * 0.001 : scale.x;\n        scale.y = mesh.scale.y < scale.y ? mesh.scale.x * 0.001 : scale.y;\n        scale.z = mesh.scale.z < scale.z ? mesh.scale.x * 0.001 : scale.z;\n        addMeshScaleAnimation(mesh, scale, finish);\n      }\n    } else {\n      if (shouldUpdateScale) this.updateScale(this.data.fitToBox, this.data.moveTheParentNotTheMesh);\n      finish();\n    }\n  },\n\n  refresh() {\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n\n    // When we refresh, we bump the version to the current timestamp.\n    //\n    // The only use-case for refresh right now is re-fetching screenshots.\n    this.el.setAttribute(\"media-loader\", { version: Math.floor(Date.now() / 1000) });\n  },\n\n  async update(oldData, forceLocalRefresh) {\n    const { version, contentSubtype } = this.data;\n    let src = this.data.src;\n    if (!src) return;\n\n    const srcChanged = oldData.src !== src;\n    const versionChanged = !!(oldData.version && oldData.version !== version);\n\n    if (versionChanged) {\n      this.el.emit(\"media_refreshing\");\n\n      // Don't animate if its a refresh.\n      this.data.animate = false;\n\n      // Play the sound effect on a refresh only if we are the owner\n      this.data.playSoundEffect = NAF.utils.isMine(this.networkedEl);\n    }\n\n    if (forceLocalRefresh) {\n      this.el.removeAttribute(\"gltf-model-plus\");\n      this.el.removeAttribute(\"media-pager\");\n      this.el.removeAttribute(\"media-video\");\n      this.el.removeAttribute(\"audio-zone-source\");\n      this.el.removeAttribute(\"media-pdf\");\n      this.el.removeAttribute(\"media-image\");\n    }\n\n    try {\n      if ((forceLocalRefresh || srcChanged) && !this.showLoaderTimeout) {\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\n        addComponent(APP.world, MediaLoading, this.el.eid);\n      }\n\n      //check if url is an anchor hash e.g. #Spawn_Point_1\n      if (src.charAt(0) === \"#\") {\n        src = this.data.src = `${window.location.origin}${window.location.pathname}${window.location.search}${src}`;\n      }\n\n      let canonicalUrl = src;\n      let canonicalAudioUrl = null; // set non-null only if audio track is separated from video track (eg. 360 video)\n      let accessibleUrl = src;\n      let contentType = this.data.contentType;\n      let thumbnail;\n\n      const parsedUrl = new URL(src);\n\n      // We want to resolve and proxy some hubs urls, like rooms and scene links,\n      // but want to avoid proxying assets in order for this to work in dev environments\n      const isLocalModelAsset =\n        isNonCorsProxyDomain(parsedUrl.hostname) && (guessContentType(src) || \"\").startsWith(\"model/gltf\");\n\n      if (this.data.resolve && !src.startsWith(\"data:\") && !src.startsWith(\"hubs:\") && !isLocalModelAsset) {\n        const is360 = !!(this.data.mediaOptions.projection && this.data.mediaOptions.projection.startsWith(\"360\"));\n        const quality = getDefaultResolveQuality(is360);\n        const result = await resolveUrl(src, quality, version, forceLocalRefresh);\n        canonicalUrl = result.origin;\n\n        // handle protocol relative urls\n        if (canonicalUrl.startsWith(\"//\")) {\n          canonicalUrl = location.protocol + canonicalUrl;\n        }\n\n        canonicalAudioUrl = result.origin_audio;\n        if (canonicalAudioUrl && canonicalAudioUrl.startsWith(\"//\")) {\n          canonicalAudioUrl = location.protocol + canonicalAudioUrl;\n        }\n\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\n\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\n\n      // TODO we should probably just never return \"application/octet-stream\" as expectedContentType, since its not really useful\n      if (contentType === \"application/octet-stream\") {\n        contentType = guessContentType(canonicalUrl) || contentType;\n      }\n\n      // Some servers treat m3u8 playlists as \"audio/x-mpegurl\", we always want to treat them as HLS videos\n      if (contentType === \"audio/x-mpegurl\" || contentType === \"audio/mpegurl\") {\n        contentType = \"application/vnd.apple.mpegurl\";\n      }\n\n      // We don't want to emit media_resolved for index updates.\n      if (forceLocalRefresh || srcChanged) {\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\n      } else {\n        this.el.emit(\"media_refreshed\", { src, raw: accessibleUrl, contentType });\n      }\n\n      if (\n        contentType.startsWith(\"video/\") ||\n        contentType.startsWith(\"audio/\") ||\n        contentType.startsWith(\"application/dash\") ||\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\n      ) {\n        let linkedVideoTexture, linkedAudioSource, linkedMediaElementAudioSource;\n        if (this.data.linkedEl) {\n          const linkedMediaVideo = this.data.linkedEl.components[\"media-video\"];\n\n          linkedVideoTexture = linkedMediaVideo.videoTexture;\n          linkedAudioSource = linkedMediaVideo.audioSource;\n          linkedMediaElementAudioSource = linkedMediaVideo.mediaElementAudioSource;\n        }\n\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\n        const startTime = hashTime || qsTime || 0;\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"video-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\n          \"media-video\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            audioSrc: canonicalAudioUrl ? proxiedUrlFor(canonicalAudioUrl) : null,\n            time: startTime,\n            contentType,\n            linkedVideoTexture,\n            linkedAudioSource,\n            linkedMediaElementAudioSource\n          })\n        );\n        this.el.setAttribute(\"audio-zone-source\", {});\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else if (contentType.startsWith(\"image/\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n\n            if (contentSubtype === \"photo-camera\") {\n              this.el.setAttribute(\"hover-menu__photo\", {\n                template: \"#photo-hover-menu\",\n                isFlat: true\n              });\n            } else if (this.data.mediaOptions.href) {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", isFlat: true });\n            }\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            version,\n            contentType\n          })\n        );\n\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else if (contentType.startsWith(\"application/pdf\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.setAttribute(\n          \"media-pdf\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType\n          })\n        );\n        this.el.setAttribute(\"media-pager\", {});\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"pdf-loaded\",\n          () => {\n            this.clearLoadingTimeout();\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else if (\n        contentType.includes(\"application/octet-stream\") ||\n        contentType.includes(\"x-zip-compressed\") ||\n        contentType.startsWith(\"model/gltf\")\n      ) {\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"model-loaded\",\n          () => {\n            this.onMediaLoaded(SHAPE.HULL, true);\n            addAnimationComponents(this.el);\n          },\n          { once: true }\n        );\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\n        if (this.data.mediaOptions.hasOwnProperty(\"applyGravity\")) {\n          this.el.setAttribute(\"floaty-object\", {\n            modifyGravityOnRelease: !this.data.mediaOptions.applyGravity\n          });\n        }\n        this.el.setAttribute(\n          \"gltf-model-plus\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType: contentType,\n            inflate: true,\n            modelToWorldScale: this.data.fitToBox ? 0.0001 : 1.0\n          })\n        );\n      } else if (contentType.startsWith(\"text/html\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          async () => {\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\n\n            if (await isLocalHubsAvatarUrl(src)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#avatar-link-hover-menu\",\n                isFlat: true\n              });\n            } else if ((await isHubsRoomUrl(src)) || ((await isLocalHubsSceneUrl(src)) && mayChangeScene)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#hubs-destination-hover-menu\",\n                isFlat: true\n              });\n            } else {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", isFlat: true });\n            }\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: thumbnail,\n            version,\n            contentType: guessContentType(thumbnail) || \"image/png\"\n          })\n        );\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else {\n        throw new Error(`Unsupported content type: ${contentType}`);\n      }\n    } catch (e) {\n      if (this.el.components[\"position-at-border__freeze\"]) {\n        this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n      }\n      if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n        this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n      }\n      console.error(\"Error adding media\", e);\n      this.onError();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-pager\", {\n  schema: {\n    index: { default: 0 },\n    maxIndex: { default: 0 }\n  },\n\n  init() {\n    this.onNext = this.onNext.bind(this);\n    this.onPrev = this.onPrev.bind(this);\n    this.onSnap = this.onSnap.bind(this);\n    this.update = this.update.bind(this);\n\n    this.el.setAttribute(\"hover-menu__pager\", { template: \"#pager-hover-menu\", isFlat: true });\n    this.el.components[\"hover-menu__pager\"].getHoverMenu().then(menu => {\n      // If we got removed while waiting, do nothing.\n      if (!this.el.parentNode) return;\n\n      this.hoverMenu = menu;\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\n      this.snapButton = this.el.querySelector(\".snap-button [text-button]\");\n      this.pageLabel = this.el.querySelector(\".page-label\");\n\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\n      this.snapButton.object3D.addEventListener(\"interact\", this.onSnap);\n\n      this.update();\n      this.el.emit(\"pager-loaded\");\n    });\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkedEl.addEventListener(\"pinned\", this.update);\n        this.networkedEl.addEventListener(\"unpinned\", this.update);\n        window.APP.hubChannel.addEventListener(\"permissions_updated\", this.update);\n      })\n      .catch(() => {}); //ignore exception, entity might not be networked\n\n    this.el.addEventListener(\"pdf-loaded\", this.update);\n  },\n\n  async update(oldData) {\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      if (oldData && typeof oldData.index === \"number\" && oldData.index !== this.data.index) {\n        this.el.emit(\"owned-pager-page-changed\");\n      }\n    }\n\n    if (this.pageLabel) {\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.data.maxIndex + 1}`);\n    }\n\n    if (this.prevButton && this.nextButton) {\n      const pinnableElement = this.el.components[\"media-loader\"].data.linkedEl || this.el;\n      const isPinned = pinnableElement.components.pinnable && pinnableElement.components.pinnable.data.pinned;\n      this.prevButton.object3D.visible = this.nextButton.object3D.visible =\n        !isPinned || window.APP.hubChannel.can(\"pin_objects\");\n    }\n  },\n\n  onNext() {\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    const newIndex = Math.min(this.data.index + 1, this.data.maxIndex);\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\n  },\n\n  onPrev() {\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    const newIndex = Math.max(this.data.index - 1, 0);\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\n  },\n\n  onSnap() {\n    this.el.emit(\"pager-snap-clicked\");\n  },\n\n  remove() {\n    if (this.networkedEl) {\n      this.networkedEl.removeEventListener(\"pinned\", this.update);\n      this.networkedEl.removeEventListener(\"unpinned\", this.update);\n    }\n\n    this.nextButton.object3D.removeEventListener(\"interact\", this.onNext);\n    this.prevButton.object3D.removeEventListener(\"interact\", this.onPrev);\n    this.snapButton.object3D.removeEventListener(\"interact\", this.onSnap);\n\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.update);\n\n    this.el.removeEventListener(\"pdf-loaded\", this.update);\n  }\n});\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"quack\", {\n  schema: {\n    quackPercentage: { default: 1 },\n    specialQuackPercentage: { default: 0.01 }\n  },\n\n  init: function() {\n    this.wasInteracting = false;\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n      this.networkedEntity = networkedEntity;\n    });\n  },\n\n  tick: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const isInteracting = interaction.isHeld(this.networkedEntity || this.el);\n\n    if (isInteracting && !this.wasInteracting) {\n      this.quack();\n    }\n\n    this.wasInteracting = isInteracting;\n  },\n\n  quack: function() {\n    const rand = Math.random();\n    if (rand < this.data.specialQuackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n    } else if (rand < this.data.quackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n    }\n  }\n});\n","export const paths = {};\npaths.noop = \"/noop\";\npaths.actions = {};\npaths.actions.log = \"/actions/log\";\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\npaths.actions.angularVelocity = \"/actions/angularVelocity\";\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\npaths.actions.debugUserInput = {};\npaths.actions.debugUserInput.describeCurrentMasks = \"/actions/debugUserInput/describeCurrentMasks\";\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\npaths.actions.lobbyCameraDelta = \"/actions/lobbyCameraDelta\";\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\npaths.actions.dCharSpeed = \"/actions/dCharSpeed\";\npaths.actions.boost = \"/actions/boost\";\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\npaths.actions.spawnPen = \"/actions/spawnPen\";\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\npaths.actions.thaw = \"/actions/thaw\";\npaths.actions.muteMic = \"/actions/muteMic\";\npaths.actions.toggleFly = \"/actions/toggleFly\";\npaths.actions.toggleUI = \"/actions/toggleUI\";\npaths.actions.waypointDeltaDistance = \"/actions/waypointDeltaDistance\";\npaths.actions.focusChat = \"/actions/focusChat\";\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\npaths.actions.mediaExit = \"/actions/mediaExit\";\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\npaths.actions.transformModifier = \"/actions/transformModifier\";\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\npaths.actions.cursor = {};\npaths.actions.cursor.right = {};\npaths.actions.cursor.right.pose = \"/actions/cursor/right/Pose\";\npaths.actions.cursor.right.hideLine = \"/actions/cursor/right/HideLine\";\npaths.actions.cursor.right.grab = \"/actions/cursor/right/Grab\";\npaths.actions.cursor.right.drop = \"/actions/cursor/right/Drop\";\npaths.actions.cursor.right.modDelta = \"/actions/cursor/right/ModDelta\";\npaths.actions.cursor.right.startDrawing = \"/actions/cursor/right/StartDrawing\";\npaths.actions.cursor.right.stopDrawing = \"/actions/cursor/right/StopDrawing\";\npaths.actions.cursor.right.undoDrawing = \"/actions/cursor/right/UndoDrawing\";\npaths.actions.cursor.right.penNextColor = \"/actions/cursor/right/PenNextColor\";\npaths.actions.cursor.right.penPrevColor = \"/actions/cursor/right/PenPrevColor\";\npaths.actions.cursor.right.scalePenTip = \"/actions/cursor/right/ScalePenTip\";\npaths.actions.cursor.right.scaleGrabbedGrabbable = \"/actions/cursor/right/ScaleGrabbedGrabbable\";\npaths.actions.cursor.right.mediaVolumeMod = \"/actions/cursor/right//mediaVolumeMod\";\npaths.actions.cursor.right.takeSnapshot = \"/actions/cursor/right/TakeSnapshot\";\npaths.actions.cursor.right.wake = \"/actions/cursor/right/wake\";\npaths.actions.cursor.left = {};\npaths.actions.cursor.left.pose = \"/actions/cursor/left/Pose\";\npaths.actions.cursor.left.hideLine = \"/actions/cursor/left/HideLine\";\npaths.actions.cursor.left.grab = \"/actions/cursor/left/Grab\";\npaths.actions.cursor.left.drop = \"/actions/cursor/left/Drop\";\npaths.actions.cursor.left.modDelta = \"/actions/cursor/left/ModDelta\";\npaths.actions.cursor.left.startDrawing = \"/actions/cursor/left/StartDrawing\";\npaths.actions.cursor.left.stopDrawing = \"/actions/cursor/left/StopDrawing\";\npaths.actions.cursor.left.undoDrawing = \"/actions/cursor/left/UndoDrawing\";\npaths.actions.cursor.left.penNextColor = \"/actions/cursor/left/PenNextColor\";\npaths.actions.cursor.left.penPrevColor = \"/actions/cursor/left/PenPrevColor\";\npaths.actions.cursor.left.scalePenTip = \"/actions/cursor/left/ScalePenTip\";\npaths.actions.cursor.left.scaleGrabbedGrabbable = \"/actions/cursor/left/ScaleGrabbedGrabbable\";\npaths.actions.cursor.left.mediaVolumeMod = \"/actions/cursor/left//mediaVolumeMod\";\npaths.actions.cursor.left.takeSnapshot = \"/actions/cursor/left/TakeSnapshot\";\npaths.actions.cursor.left.wake = \"/actions/cursor/left/wake\";\npaths.actions.pen = {};\npaths.actions.pen.remove = \"/actions/pen/remove\";\npaths.actions.rightHand = {};\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\npaths.actions.rightHand.switchDrawMode = \"/actions/rightHandSwitchDrawMode\";\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\npaths.actions.leftHand = {};\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\npaths.actions.leftHand.switchDrawMode = \"/actions/leftHandSwitchDrawMode\";\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\npaths.actions.camera = {};\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\npaths.actions.startInspecting = \"/actions/startInspecting\";\npaths.actions.startInspectingSelf = \"/actions/startInspectingSelf\";\npaths.actions.stopInspecting = \"/actions/stopInspecting\";\npaths.actions.inspectZoom = \"/actions/inspectZoom\";\npaths.actions.inspectPanY = \"/actions/inspectPanY\";\npaths.actions.resetInspectView = \"/actions/resetInspectView\";\npaths.actions.nextCameraMode = \"/actions/nextCameraMode\";\npaths.actions.spawnEmoji0 = \"/actions/spawnEmoji0\";\npaths.actions.spawnEmoji1 = \"/actions/spawnEmoji1\";\npaths.actions.spawnEmoji2 = \"/actions/spawnEmoji2\";\npaths.actions.spawnEmoji3 = \"/actions/spawnEmoji3\";\npaths.actions.spawnEmoji4 = \"/actions/spawnEmoji4\";\npaths.actions.spawnEmoji5 = \"/actions/spawnEmoji5\";\npaths.actions.spawnEmoji6 = \"/actions/spawnEmoji6\";\npaths.haptics = {};\npaths.haptics.actuators = {};\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\n\npaths.device = {};\npaths.device.mouse = {};\npaths.device.mouse.coords = \"/device/mouse/coords\";\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\npaths.device.mouse.buttonMiddle = \"/device/mouse/buttonMiddle\";\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\npaths.device.smartMouse = {};\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\npaths.device.smartMouse.shouldMoveCamera = \"/device/smartMouse/shouldMoveCamera\";\npaths.device.touchscreen = {};\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\npaths.device.touchscreen.pinch = {};\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\npaths.device.touchscreen.anything = \"/device/touchscreen/anything\";\npaths.device.gyro = {};\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\npaths.device.hud = {};\npaths.device.hud.penButton = \"/device/hud/penButton\";\n\npaths.device.keyboard = {\n  map: new Map(),\n  key: function(k) {\n    let path = this.map.get(k);\n    if (path) {\n      return path;\n    }\n    path = `/device/keyboard/${k === \" \" ? \"space\" : k.toLowerCase()}`;\n    this.map.set(k, path);\n    return path;\n  }\n};\n\npaths.device.gamepad = gamepadIndex => ({\n  button: buttonIndex => ({\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\n  }),\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\n});\n\nconst xbox = \"/device/xbox/\";\npaths.device.xbox = {\n  v: name => `/vars/xbox/${name}`,\n  button: buttonName => ({\n    pressed: `${xbox}button/${buttonName}/pressed`,\n    touched: `${xbox}button/${buttonName}/touched`,\n    value: `${xbox}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${xbox}axis/${axisName}`;\n  },\n  axesSum: `${xbox}axis/sum`\n};\n\npaths.device.oculusgo = {\n  // TODO remove these in favor of the direct accessors\n  button: buttonName => ({\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\n    value: `/device/oculusgo/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/oculusgo/axis/${axisName}`;\n  },\n  //\n  trigger: {\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\n    touched: \"/device/oculusgo/button/trigger/touched\",\n    value: \"/device/oculusgo/button/trigger/value\"\n  },\n  touchpad: {\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\n    touched: \"/device/oculusgo/button/touchpad/touched\",\n    value: \"/device/oculusgo/button/touchpad/value\",\n    axisX: \"/device/oculusgo/axis/touchpadX\",\n    axisY: \"/device/oculusgo/axis/touchpadY\"\n  },\n  pose: \"/device/oculusgo/pose\",\n  matrix: \"/device/oculusgo/matrix\",\n  v: name => {\n    return `/vars/oculusgo/${name}`;\n  }\n};\n\nconst gearVRController = \"/device/gearVRController/\";\npaths.device.gearVRController = {\n  button: buttonName => ({\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\n    touched: `${gearVRController}button/${buttonName}/touched`,\n    value: `${gearVRController}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${gearVRController}axis/${axisName}`;\n  },\n  pose: `${gearVRController}pose`,\n  matrix: `${gearVRController}matrix`,\n  v: name => {\n    return `/vars/gearVRController/${name}`;\n  }\n};\n\nconst daydream = \"/device/daydream/\";\npaths.device.daydream = {\n  button: buttonName => ({\n    pressed: `${daydream}button/${buttonName}/pressed`,\n    touched: `${daydream}button/${buttonName}/touched`,\n    value: `${daydream}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${daydream}axis/${axisName}`;\n  },\n  pose: `${daydream}pose`,\n  matrix: `${daydream}matrix`\n};\n\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\npaths.device.rightOculusTouch = {\n  button: buttonName => ({\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\n    value: `${rightOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${rightOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${rightOculusTouch}axis/sum`,\n  pose: `${rightOculusTouch}pose`,\n  matrix: `${rightOculusTouch}matrix`\n};\n\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\npaths.device.leftOculusTouch = {\n  button: buttonName => ({\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\n    value: `${leftOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${leftOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${leftOculusTouch}axis/sum`,\n  pose: `${leftOculusTouch}pose`,\n  matrix: `${leftOculusTouch}matrix`\n};\n\npaths.device.vive = {};\npaths.device.vive.left = {\n  button: buttonName => ({\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\n    touched: `/device/vive/left/button/${buttonName}/touched`,\n    value: `/device/vive/left/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/left/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/left/axis/sum\",\n  pose: `/device/vive/left/pose`,\n  matrix: `/device/vive/left/matrix`\n};\npaths.device.vive.right = {\n  button: buttonName => ({\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\n    touched: `/device/vive/right/button/${buttonName}/touched`,\n    value: `/device/vive/right/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/right/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/right/axis/sum\",\n  pose: `/device/vive/right/pose`,\n  matrix: `/device/vive/right/matrix`\n};\n\nfunction button(device, side, name) {\n  return {\n    pressed: `${device}${side}/button/${name}/pressed`,\n    touched: `${device}${side}/button/${name}/touched`,\n    value: `${device}${side}/button/${name}/value`\n  };\n}\n\nfunction axes(device, side, name) {\n  return {\n    axisX: `${device}${side}/axis/${name}X`,\n    axisY: `${device}${side}/axis/${name}Y`\n  };\n}\n\nfunction wmrController(side) {\n  const wmr = \"/device/wmr/\";\n  return {\n    touchpad: {\n      ...button(wmr, side, \"touchpad\"),\n      ...axes(wmr, side, \"touchpad\")\n    },\n    trigger: button(wmr, side, \"trigger\"),\n    grip: button(wmr, side, \"grip\"),\n    menu: button(wmr, side, \"menu\"),\n    joystick: axes(wmr, side, \"joystick\"),\n    pose: `${wmr}${side}/pose`,\n    matrix: `${wmr}${side}/matrix`\n  };\n}\npaths.device.wmr = {};\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\npaths.device.wmr.left = wmrController(\"left\");\npaths.device.wmr.right = wmrController(\"right\");\n\nconst webxr = \"/device/webxr/\";\npaths.device.webxr = {};\npaths.device.webxr.right = {\n  button: {\n    trigger: button(webxr, \"right\", \"trigger\"),\n    grip: button(webxr, \"right\", \"grip\"),\n    touchpad: button(webxr, \"right\", \"touchpad\"),\n    a: button(webxr, \"right\", \"a\"),\n    b: button(webxr, \"right\", \"b\"),\n    thumbStick: button(webxr, \"right\", \"thumbStick\")\n  },\n  axis: {\n    touchpadX: `${webxr}right/axis/touchpadX`,\n    touchpadY: `${webxr}right/axis/touchpadY`,\n    joyX: `${webxr}right/axis/joyX`,\n    joyY: `${webxr}right/axis/joyY`\n  },\n  pose: `${webxr}right/pose`,\n  matrix: `${webxr}right/matrix`\n};\npaths.device.webxr.left = {\n  button: {\n    trigger: button(webxr, \"left\", \"trigger\"),\n    grip: button(webxr, \"left\", \"grip\"),\n    touchpad: button(webxr, \"left\", \"touchpad\"),\n    a: button(webxr, \"left\", \"a\"),\n    b: button(webxr, \"left\", \"b\"),\n    thumbStick: button(webxr, \"left\", \"thumbStick\")\n  },\n  axis: {\n    touchpadX: `${webxr}left/axis/touchpadX`,\n    touchpadY: `${webxr}left/axis/touchpadY`,\n    joyX: `${webxr}left/axis/joyX`,\n    joyY: `${webxr}left/axis/joyY`\n  },\n  pose: `${webxr}left/pose`,\n  matrix: `${webxr}left/matrix`\n};\n","import { addComponent, hasComponent } from \"bitecs\";\nimport {\n  Holdable,\n  OffersRemoteConstraint,\n  HandCollisionTarget,\n  OffersHandConstraint,\n  TogglesHoveredActionSet,\n  SingleActionButton,\n  HoldableButton,\n  Pen,\n  HoverMenuChild,\n  Static,\n  Inspectable,\n  PreventAudioBoost,\n  IgnoreSpaceBubble\n} from \"../bit-components\";\n\nconst tag2ecs = {\n  isHoldable: Holdable,\n  offersRemoteConstraint: OffersRemoteConstraint,\n  isHandCollisionTarget: HandCollisionTarget,\n  offersHandConstraint: OffersHandConstraint,\n  togglesHoveredActionSet: TogglesHoveredActionSet,\n  singleActionButton: SingleActionButton,\n  holdableButton: HoldableButton,\n  isPen: Pen,\n  isHoverMenuChild: HoverMenuChild,\n  isStatic: Static,\n  inspectable: Inspectable,\n  preventAudioBoost: PreventAudioBoost,\n  ignoreSpaceBubble: IgnoreSpaceBubble\n};\n\n// TODO usages of this should be replaced with direct hasComponent calls\n// but this also has additional logic to check for non existant object\nexport function isTagged(elOrObject3D, tag) {\n  return elOrObject3D && hasComponent(APP.world, tag2ecs[tag], elOrObject3D.eid);\n}\n\nAFRAME.registerComponent(\"tags\", {\n  schema: {\n    isHandCollisionTarget: { default: false },\n    isHoldable: { default: false },\n    offersHandConstraint: { default: false },\n    offersRemoteConstraint: { default: false },\n    togglesHoveredActionSet: { default: false },\n    singleActionButton: { default: false },\n    holdableButton: { default: false },\n    isPen: { default: false },\n    isHoverMenuChild: { default: false },\n    isStatic: { default: false },\n    inspectable: { default: false },\n    preventAudioBoost: { default: false },\n    ignoreSpaceBubble: { default: false }\n  },\n  update() {\n    if (this.didUpdateOnce) {\n      console.warn(\"Do not edit tags with .setAttribute\");\n    }\n    this.didUpdateOnce = true;\n    Object.entries(this.data).forEach(([tagName, isSet]) => {\n      if (isSet) addComponent(APP.world, tag2ecs[tagName], this.el.eid);\n    });\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { childMatch, setMatrixWorld, calculateViewingDistance } from \"../utils/three-utils\";\nimport { paths } from \"./userinput/paths\";\nimport { getBox } from \"../utils/auto-box-collider\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { isTagged } from \"../components/tags\";\nimport { qsGet } from \"../utils/qs_truthy\";\nconst customFOV = qsGet(\"fov\");\nconst enableThirdPersonMode = qsTruthy(\"thirdPerson\");\nimport { Layers } from \"../components/layers\";\n\nfunction getInspectableInHierarchy(el) {\n  let inspectable = el;\n  while (inspectable) {\n    if (isTagged(inspectable, \"inspectable\")) {\n      return inspectable.object3D;\n    }\n    inspectable = inspectable.parentNode;\n  }\n  console.warn(\"could not find inspectable in hierarchy\");\n  return el.object3D;\n}\n\nfunction pivotFor(el) {\n  const selector =\n    el.components[\"inspect-pivot-child-selector\"] && el.components[\"inspect-pivot-child-selector\"].data.selector;\n  if (!selector) {\n    return el.object3D;\n  }\n\n  const child = el.querySelector(selector);\n  if (!child) {\n    console.error(`Failed to find pivot for selector: ${selector}`, el);\n    return el.object3D;\n  }\n  return child.object3D;\n}\n\nexport function getInspectableAndPivot(el) {\n  const inspectable = getInspectableInHierarchy(el);\n  const pivot = pivotFor(inspectable.el);\n  return { inspectable, pivot };\n}\n\nconst decompose = (function() {\n  const scale = new THREE.Vector3();\n  return function decompose(m, p, q) {\n    m.decompose(p, q, scale); //ignore scale, like we're dealing with a motor\n  };\n})();\n\nconst IDENTITY = new THREE.Matrix4().identity();\nconst orbit = (function() {\n  const owq = new THREE.Quaternion();\n  const owp = new THREE.Vector3();\n  const cwq = new THREE.Quaternion();\n  const cwp = new THREE.Vector3();\n  const rwq = new THREE.Quaternion();\n  const UP = new THREE.Vector3();\n  const RIGHT = new THREE.Vector3();\n  const dPos = new THREE.Vector3();\n  const targetPos = new THREE.Vector3();\n  const targetQuat = new THREE.Quaternion();\n  const targetScale = new THREE.Vector3(1, 1, 1);\n  const targetMatrix = new THREE.Matrix4();\n  const dhQ = new THREE.Quaternion();\n  const dvQ = new THREE.Quaternion();\n  return function orbit(pivot, rig, camera, dh, dv, dz, dt, panY) {\n    pivot.updateMatrices();\n    decompose(pivot.matrixWorld, owp, owq);\n\n    camera.updateMatrices();\n    decompose(camera.matrixWorld, cwp, cwq);\n\n    rig.getWorldQuaternion(rwq);\n\n    dhQ.setFromAxisAngle(UP.set(0, 1, 0).applyQuaternion(owq), 0.1 * dh * dt);\n    targetQuat.copy(cwq).premultiply(dhQ);\n    dPos.subVectors(cwp, owp);\n    const zoom = 1 - dz * dt;\n    const newLength = dPos.length() * zoom;\n    // TODO: These limits should be calculated based on the calculated view distance.\n    if (newLength > 0.1 && newLength < 100) {\n      dPos.multiplyScalar(zoom);\n    }\n\n    dvQ.setFromAxisAngle(RIGHT.set(1, 0, 0).applyQuaternion(targetQuat), 0.1 * dv * dt);\n    targetQuat.premultiply(dvQ);\n    targetPos.addVectors(owp, dPos.applyQuaternion(dhQ).applyQuaternion(dvQ)).add(\n      UP.set(0, 1, 0)\n        .multiplyScalar(panY * newLength)\n        .applyQuaternion(targetQuat)\n    );\n\n    targetMatrix.compose(\n      targetPos,\n      targetQuat,\n      targetScale\n    );\n\n    childMatch(rig, camera, targetMatrix);\n  };\n})();\n\nconst moveRigSoCameraLooksAtPivot = (function() {\n  const owq = new THREE.Quaternion();\n  const owp = new THREE.Vector3();\n  const cwq = new THREE.Quaternion();\n  const cwp = new THREE.Vector3();\n  const oForw = new THREE.Vector3();\n  const center = new THREE.Vector3();\n  const defaultBoxMax = new THREE.Vector3(0.3, 0.3, 0.3);\n  const target = new THREE.Object3D();\n  return function moveRigSoCameraLooksAtPivot(rig, camera, inspectable, pivot, distanceMod) {\n    if (!target.parent) {\n      // add dummy object to the scene, if this is the first time we call this function\n      AFRAME.scenes[0].object3D.add(target);\n      target.applyMatrix4(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\n    }\n\n    pivot.updateMatrices();\n    decompose(pivot.matrixWorld, owp, owq);\n    decompose(camera.matrixWorld, cwp, cwq);\n    rig.getWorldQuaternion(cwq);\n\n    const box = getBox(inspectable.el, inspectable.el.getObject3D(\"mesh\") || inspectable, true);\n    if (box.min.x === Infinity) {\n      // fix edgecase where inspectable object has no mesh / dimensions\n      box.min.subVectors(owp, defaultBoxMax);\n      box.max.addVectors(owp, defaultBoxMax);\n    }\n    box.getCenter(center);\n    const vrMode = inspectable.el.sceneEl.is(\"vr-mode\");\n    const dist =\n      calculateViewingDistance(\n        inspectable.el.sceneEl.camera.fov,\n        inspectable.el.sceneEl.camera.aspect,\n        box,\n        center,\n        vrMode\n      ) * distanceMod;\n    target.position.addVectors(\n      owp,\n      oForw\n        .set(0, 0, 1) //TODO: Suspicious that this is called oForw but (0,0,1) is backwards\n        .multiplyScalar(dist)\n        .applyQuaternion(owq)\n    );\n    target.quaternion.copy(owq);\n    target.matrixNeedsUpdate = true;\n    target.updateMatrices();\n    childMatch(rig, camera, target.matrixWorld);\n  };\n})();\n\nexport const CAMERA_MODE_FIRST_PERSON = 0;\nexport const CAMERA_MODE_THIRD_PERSON_NEAR = 1;\nexport const CAMERA_MODE_THIRD_PERSON_FAR = 2;\nexport const CAMERA_MODE_INSPECT = 3;\nexport const CAMERA_MODE_SCENE_PREVIEW = 4;\nexport const CAMERA_MODE_THIRD_PERSON_VIEW = 5;\n\nconst NEXT_MODES = {\n  [CAMERA_MODE_FIRST_PERSON]: CAMERA_MODE_THIRD_PERSON_NEAR,\n  [CAMERA_MODE_THIRD_PERSON_NEAR]: CAMERA_MODE_THIRD_PERSON_FAR,\n  [CAMERA_MODE_THIRD_PERSON_FAR]: CAMERA_MODE_FIRST_PERSON\n};\n\nconst ensureLightsAreSeenByCamera = function(o) {\n  if (o.isLight) {\n    o.layers.enable(Layers.CAMERA_LAYER_INSPECT);\n  }\n};\n\nconst firstPersonOnlyLayer = new THREE.Layers();\nfirstPersonOnlyLayer.set(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\nconst enableInspectLayer = function(o) {\n  // Ignore first person only meshes\n  if (o.layers.test(firstPersonOnlyLayer)) return;\n  o.layers.enable(Layers.CAMERA_LAYER_INSPECT);\n};\nconst disableInspectLayer = function(o) {\n  // Ignore first person only meshes\n  if (o.layers.test(firstPersonOnlyLayer)) return;\n  o.layers.disable(Layers.CAMERA_LAYER_INSPECT);\n};\n\nfunction getAudio(o) {\n  let audio;\n  o.traverse(c => {\n    if (!audio && c.type === \"Audio\") {\n      audio = c;\n    }\n  });\n  return audio;\n}\n\nconst FALLOFF = 0.9;\nexport class CameraSystem {\n  constructor(camera, renderer) {\n    this.viewingCamera = camera;\n    this.lightsEnabled = localStorage.getItem(\"show-background-while-inspecting\") === \"true\";\n    this.verticalDelta = 0;\n    this.horizontalDelta = 0;\n    this.inspectZoom = 0;\n    this.mode = CAMERA_MODE_SCENE_PREVIEW;\n    this.snapshot = { audioTransform: new THREE.Matrix4(), matrixWorld: new THREE.Matrix4() };\n    this.audioSourceTargetTransform = new THREE.Matrix4();\n\n    if (customFOV) {\n      this.viewingCamera.fov = customFOV;\n    }\n    this.viewingCamera.layers.enable(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n    this.viewingCamera.layers.enable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n    this.viewingCamera.layers.enable(Layers.CAMERA_LAYER_UI);\n\n    // xr.updateCamera gets called every render to copy the active cameras properties to the XR cameras. We also want to copy layers.\n    // TODO this logic should either be moved into THREE or removed when we ditch aframe camera system\n    const xrManager = renderer.xr;\n    const updateXRCamera = xrManager.updateCamera;\n    xrManager.updateCamera = function(camera) {\n      updateXRCamera(camera);\n      const xrCamera = xrManager.getCamera();\n      xrCamera.layers.mask = camera.layers.mask;\n      if (xrCamera.cameras.length) {\n        xrCamera.cameras[0].layers.set(Layers.CAMERA_LAYER_XR_LEFT_EYE);\n        xrCamera.cameras[0].layers.mask |= camera.layers.mask;\n        xrCamera.cameras[1].layers.set(Layers.CAMERA_LAYER_XR_RIGHT_EYE);\n        xrCamera.cameras[1].layers.mask |= camera.layers.mask;\n      }\n    };\n\n    waitForDOMContentLoaded().then(() => {\n      this.avatarPOV = document.getElementById(\"avatar-pov-node\");\n      this.avatarRig = document.getElementById(\"avatar-rig\");\n      this.viewingRig = document.getElementById(\"viewing-rig\");\n\n      const bg = new THREE.Mesh(\n        new THREE.BoxGeometry(100, 100, 100),\n        new THREE.MeshBasicMaterial({ color: 0x020202, side: THREE.BackSide })\n      );\n      bg.layers.set(Layers.CAMERA_LAYER_INSPECT);\n      this.viewingRig.object3D.add(bg);\n    });\n  }\n\n  nextMode() {\n    if (this.mode === CAMERA_MODE_INSPECT) {\n      this.uninspect();\n      return;\n    }\n\n    if (!enableThirdPersonMode) return;\n    if (this.mode === CAMERA_MODE_SCENE_PREVIEW) return;\n\n    this.mode = NEXT_MODES[this.mode] || 0;\n  }\n\n  inspect(el, distanceMod, fireChangeEvent = true) {\n    const { inspectable, pivot } = getInspectableAndPivot(el);\n\n    this.verticalDelta = 0;\n    this.horizontalDelta = 0;\n    this.inspectZoom = 0;\n    if (this.mode === CAMERA_MODE_INSPECT) {\n      return;\n    }\n    const scene = AFRAME.scenes[0];\n    scene.object3D.traverse(ensureLightsAreSeenByCamera);\n    scene.classList.add(\"hand-cursor\");\n    scene.classList.remove(\"no-cursor\");\n    this.snapshot.mode = this.mode;\n    this.mode = CAMERA_MODE_INSPECT;\n    this.inspectable = inspectable;\n    this.pivot = pivot;\n\n    const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n    this.snapshot.mask = camera.layers.mask;\n    if (!this.lightsEnabled) {\n      this.hideEverythingButThisObject(inspectable);\n    } else {\n      camera.layers.disable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n      camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n    }\n\n    this.viewingCamera.updateMatrices();\n    this.snapshot.matrixWorld.copy(this.viewingRig.object3D.matrixWorld);\n\n    this.snapshot.audio = !(inspectable.el && isTagged(inspectable.el, \"preventAudioBoost\")) && getAudio(inspectable);\n    if (this.snapshot.audio) {\n      this.snapshot.audio.updateMatrices();\n      this.snapshot.audioTransform.copy(this.snapshot.audio.matrixWorld);\n      scene.audioListener.updateMatrices();\n      this.audioSourceTargetTransform.makeTranslation(0, 0, -0.25).premultiply(scene.audioListener.matrixWorld);\n      setMatrixWorld(this.snapshot.audio, this.audioSourceTargetTransform);\n    }\n\n    this.ensureListenerIsParentedCorrectly(scene);\n\n    moveRigSoCameraLooksAtPivot(\n      this.viewingRig.object3D,\n      this.viewingCamera,\n      this.inspectable,\n      this.pivot,\n      distanceMod || 1\n    );\n\n    if (fireChangeEvent) {\n      scene.emit(\"inspect-target-changed\");\n    }\n  }\n\n  uninspect(fireChangeEvent = true) {\n    if (this.mode !== CAMERA_MODE_INSPECT) return;\n    const scene = AFRAME.scenes[0];\n    if (scene.is(\"entered\")) {\n      scene.classList.remove(\"hand-cursor\");\n      scene.classList.add(\"no-cursor\");\n    }\n    this.showEverythingAsNormal();\n    this.inspectable = null;\n    this.pivot = null;\n    if (this.snapshot.audio) {\n      setMatrixWorld(this.snapshot.audio, this.snapshot.audioTransform);\n      this.snapshot.audio = null;\n    }\n\n    this.mode = this.snapshot.mode;\n    if (this.snapshot.mode === CAMERA_MODE_SCENE_PREVIEW) {\n      setMatrixWorld(this.viewingRig.object3D, this.snapshot.matrixWorld);\n    }\n    this.snapshot.mode = null;\n    this.tick(AFRAME.scenes[0]);\n\n    if (fireChangeEvent) {\n      scene.emit(\"inspect-target-changed\");\n    }\n  }\n\n  toggleLights() {\n    this.lightsEnabled = !this.lightsEnabled;\n    localStorage.setItem(\"show-background-while-inspecting\", this.lightsEnabled.toString());\n\n    if (this.mode === CAMERA_MODE_INSPECT && this.inspectable) {\n      if (this.lightsEnabled) {\n        this.showEverythingAsNormal();\n        const scene = AFRAME.scenes[0];\n        const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n        camera.layers.disable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n        camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n      } else {\n        this.hideEverythingButThisObject(this.inspectable);\n      }\n    }\n\n    AFRAME.scenes[0].emit(\"inspect-lights-changed\");\n  }\n\n  ensureListenerIsParentedCorrectly(scene) {\n    if (scene.audioListener && this.avatarPOV) {\n      if (this.mode === CAMERA_MODE_INSPECT && scene.audioListener.parent !== this.avatarPOV.object3D) {\n        this.avatarPOV.object3D.add(scene.audioListener);\n      } else if (\n        (this.mode === CAMERA_MODE_FIRST_PERSON ||\n          this.mode === CAMERA_MODE_THIRD_PERSON_NEAR ||\n          this.mode === CAMERA_MODE_THIRD_PERSON_FAR) &&\n        scene.audioListener.parent !== this.viewingCamera\n      ) {\n        this.viewingCamera.add(scene.audioListener);\n      }\n    }\n  }\n\n  hideEverythingButThisObject(o) {\n    this.notHiddenObject = o;\n    o.traverse(enableInspectLayer);\n\n    const scene = AFRAME.scenes[0];\n    const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n    camera.layers.set(Layers.CAMERA_LAYER_INSPECT);\n  }\n\n  showEverythingAsNormal() {\n    if (this.notHiddenObject) {\n      this.notHiddenObject.traverse(disableInspectLayer);\n      this.notHiddenObject = null;\n    }\n    const scene = AFRAME.scenes[0];\n    const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n    camera.layers.mask = this.snapshot.mask;\n  }\n\n  tick = (function() {\n    const translation = new THREE.Matrix4();\n    let uiRoot;\n    return function tick(scene, dt) {\n      this.viewingCamera.matrixNeedsUpdate = true;\n      this.viewingCamera.updateMatrix();\n      this.viewingCamera.updateMatrixWorld();\n\n      const entered = scene.is(\"entered\");\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\n      const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n      if (isGhost && this.mode !== CAMERA_MODE_FIRST_PERSON && this.mode !== CAMERA_MODE_INSPECT) {\n        this.mode = CAMERA_MODE_FIRST_PERSON;\n        const position = new THREE.Vector3();\n        const quat = new THREE.Quaternion();\n        const scale = new THREE.Vector3();\n        this.viewingRig.object3D.updateMatrices();\n        this.viewingRig.object3D.matrixWorld.decompose(position, quat, scale);\n        position.setFromMatrixPosition(this.viewingCamera.matrixWorld);\n        position.y = position.y - 1.6;\n        setMatrixWorld(\n          this.avatarRig.object3D,\n          new THREE.Matrix4().compose(\n            position,\n            quat,\n            scale\n          )\n        );\n        scene.systems[\"hubs-systems\"].characterController.fly = true;\n        this.avatarPOV.object3D.updateMatrices();\n        setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.matrixWorld);\n      }\n      if (!this.enteredScene && entered) {\n        this.enteredScene = true;\n        this.mode = CAMERA_MODE_FIRST_PERSON;\n      }\n      this.avatarPOVRotator = this.avatarPOVRotator || this.avatarPOV.components[\"pitch-yaw-rotator\"];\n      this.viewingCameraRotator = this.viewingCameraRotator || this.viewingCamera.el.components[\"pitch-yaw-rotator\"];\n      this.avatarPOVRotator.on = true;\n      this.viewingCameraRotator.on = true;\n\n      this.userinput = this.userinput || scene.systems.userinput;\n      this.interaction = this.interaction || scene.systems.interaction;\n\n      if (this.userinput.get(paths.actions.startInspecting) && this.mode !== CAMERA_MODE_INSPECT) {\n        const hoverEl = this.interaction.state.rightRemote.hovered || this.interaction.state.leftRemote.hovered;\n\n        if (hoverEl) {\n          this.inspect(hoverEl, 1.5);\n        }\n      } else if (this.mode === CAMERA_MODE_INSPECT && this.userinput.get(paths.actions.stopInspecting)) {\n        scene.emit(\"uninspect\");\n        this.uninspect();\n      }\n\n      if (this.userinput.get(paths.actions.nextCameraMode)) {\n        this.nextMode();\n      }\n\n      this.ensureListenerIsParentedCorrectly(scene);\n\n      if (this.mode === CAMERA_MODE_FIRST_PERSON) {\n        this.viewingCameraRotator.on = false;\n        this.avatarRig.object3D.updateMatrices();\n        setMatrixWorld(this.viewingRig.object3D, this.avatarRig.object3D.matrixWorld);\n        if (scene.is(\"vr-mode\")) {\n          this.viewingCamera.updateMatrices();\n          setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.matrixWorld);\n        } else {\n          this.avatarPOV.object3D.updateMatrices();\n          setMatrixWorld(this.viewingCamera, this.avatarPOV.object3D.matrixWorld);\n        }\n      } else if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR || this.mode === CAMERA_MODE_THIRD_PERSON_FAR) {\n        if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR) {\n          translation.makeTranslation(0, 1, 3);\n        } else {\n          translation.makeTranslation(0, 2, 8);\n        }\n        this.avatarRig.object3D.updateMatrices();\n        this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld).multiply(translation);\n        setMatrixWorld(this.viewingRig.object3D, this.viewingRig.object3D.matrixWorld);\n        this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.quaternion);\n        this.avatarPOV.object3D.matrixNeedsUpdate = true;\n      } else if (this.mode === CAMERA_MODE_INSPECT) {\n        this.avatarPOVRotator.on = false;\n        this.viewingCameraRotator.on = false;\n        const cameraDelta = this.userinput.get(\n          scene.is(\"entered\") ? paths.actions.cameraDelta : paths.actions.lobbyCameraDelta\n        );\n\n        if (cameraDelta) {\n          // TODO: Move device specific tinkering to action sets\n          const horizontalDelta = (AFRAME.utils.device.isMobile() ? -0.6 : 1) * cameraDelta[0] || 0;\n          const verticalDelta = (AFRAME.utils.device.isMobile() ? -1.2 : 1) * cameraDelta[1] || 0;\n          this.horizontalDelta = (this.horizontalDelta + horizontalDelta) / 2;\n          this.verticalDelta = (this.verticalDelta + verticalDelta) / 2;\n        } else if (Math.abs(this.verticalDelta) > 0.0001 || Math.abs(this.horizontalDelta) > 0.0001) {\n          this.verticalDelta = FALLOFF * this.verticalDelta;\n          this.horizontalDelta = FALLOFF * this.horizontalDelta;\n        }\n\n        const inspectZoom = this.userinput.get(paths.actions.inspectZoom) * 0.001;\n        if (inspectZoom) {\n          this.inspectZoom = inspectZoom + (5 * this.inspectZoom) / 6;\n        } else if (Math.abs(this.inspectZoom) > 0.0001) {\n          this.inspectZoom = FALLOFF * this.inspectZoom;\n        }\n        const panY = this.userinput.get(paths.actions.inspectPanY) || 0;\n        if (this.userinput.get(paths.actions.resetInspectView)) {\n          moveRigSoCameraLooksAtPivot(this.viewingRig.object3D, this.viewingCamera, this.inspectable, this.pivot, 1);\n        }\n        if (this.snapshot.audio) {\n          setMatrixWorld(this.snapshot.audio, this.audioSourceTargetTransform);\n        }\n\n        if (\n          Math.abs(this.verticalDelta) > 0.001 ||\n          Math.abs(this.horizontalDelta) > 0.001 ||\n          Math.abs(this.inspectZoom) > 0.001 ||\n          Math.abs(panY) > 0.0001\n        ) {\n          orbit(\n            this.pivot,\n            this.viewingRig.object3D,\n            this.viewingCamera,\n            this.horizontalDelta,\n            this.verticalDelta,\n            this.inspectZoom,\n            dt,\n            panY\n          );\n        }\n      } else if (this.mode === CAMERA_MODE_THIRD_PERSON_VIEW) {\n        this.viewingCameraRotator.on = false;\n        translation.makeTranslation(0, 0, 1);\n        this.avatarRig.object3D.updateMatrices();\n        setMatrixWorld(this.viewingRig.object3D, this.avatarRig.object3D.matrixWorld);\n        if (scene.is(\"vr-mode\")) {\n          this.viewingCamera.updateMatrices();\n          setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.matrixWorld);\n        } else {\n          this.avatarPOV.object3D.updateMatrices();\n          setMatrixWorld(this.viewingCamera, this.avatarPOV.object3D.matrixWorld.multiply(translation));\n        }\n\n        this.avatarRig.object3D.updateMatrices();\n        this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld);\n        setMatrixWorld(this.viewingRig.object3D, this.viewingRig.object3D.matrixWorld);\n        this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.quaternion);\n        this.avatarPOV.object3D.matrixNeedsUpdate = true;\n      }\n    };\n  })();\n}\n","import { setMatrixWorld } from \"../utils/three-utils\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\nimport { CAMERA_MODE_SCENE_PREVIEW } from \"../systems/camera-system\";\n\nfunction getStreamerCamera() {\n  const streamer = getCurrentStreamer();\n  if (streamer) {\n    return streamer.el.querySelector(\".camera\").object3D;\n  }\n  return null;\n}\n\nfunction lerp(start, end, t) {\n  return (1 - t) * start + t * end;\n}\n\nconst newRot = new THREE.Quaternion();\n\n/**\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\n * since it ends up panning in a direction dependent upon the start camera orientation,\n * but it's good enough for now.\n */\nAFRAME.registerComponent(\"scene-preview-camera\", {\n  schema: {\n    duration: { default: 90, type: \"number\" },\n    positionOnly: { default: false, type: \"boolean\" }\n  },\n\n  init: function() {\n    const systems = AFRAME.scenes[0].systems[\"hubs-systems\"] || AFRAME.scenes[0].systems[\"scene-systems\"];\n\n    if (systems) {\n      systems.scenePreviewCameraSystem.register(this.el);\n    }\n\n    this.startPoint = this.el.object3D.position.clone();\n    this.startRotation = this.el.object3D.quaternion.clone();\n\n    this.targetPoint = this.el.object3D.position.clone();\n    this.targetPoint.y = Math.max(this.targetPoint.y - 1.5, 1);\n    this.targetPoint.add(new THREE.Vector3(2, 0, -2));\n\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\n    this.targetRotation = new THREE.Quaternion();\n    this.targetRotation.setFromEuler(targetRotDelta);\n    this.targetRotation.premultiply(this.startRotation);\n\n    this.startTime = performance.now();\n    this.backwards = false;\n    this.ranOnePass = false;\n  },\n\n  tick2: function() {\n    const hubsSystems = this.el.sceneEl.systems[\"hubs-systems\"];\n\n    let streamerCamera;\n    if (hubsSystems) {\n      hubsSystems.cameraSystem.mode = CAMERA_MODE_SCENE_PREVIEW;\n      streamerCamera = getStreamerCamera();\n    }\n\n    if (streamerCamera) {\n      setMatrixWorld(this.el.object3D, streamerCamera.matrixWorld);\n      // Move camera forward just a bit so that we don't see the avatar's eye cylinders.\n      this.el.object3D.translateZ(-0.1);\n      this.el.object3D.matrixNeedsUpdate = true;\n    } else {\n      let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\n      t = Math.min(1.0, Math.max(0.0, t));\n\n      if (!this.ranOnePass) {\n        t = t * (2 - t);\n      } else {\n        t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n      }\n\n      const from = this.backwards ? this.targetPoint : this.startPoint;\n      const to = this.backwards ? this.startPoint : this.targetPoint;\n      const fromRot = this.backwards ? this.targetRotation : this.startRotation;\n      const toRot = this.backwards ? this.startRotation : this.targetRotation;\n\n      newRot.slerpQuaternions(fromRot, toRot, t);\n\n      this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\n\n      if (!this.data.positionOnly) {\n        this.el.object3D.rotation.setFromQuaternion(newRot);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n\n      if (t >= 0.9999) {\n        this.ranOnePass = true;\n        this.backwards = !this.backwards;\n        this.startTime = performance.now();\n      }\n    }\n  },\n\n  remove: function() {\n    const systems = AFRAME.scenes[0]?.systems[\"hubs-systems\"] || AFRAME.scenes[0]?.systems[\"scene-systems\"];\n\n    if (systems) {\n      systems.scenePreviewCameraSystem.unregister(this.el);\n    }\n  }\n});\n","import { LightProbeGenerator } from \"three/examples/jsm/lights/LightProbeGenerator\";\n\nconst {\n  AmbientLight,\n  BackSide,\n  BoxBufferGeometry,\n  CubeCamera,\n  LinearFilter,\n  Mesh,\n  Object3D,\n  PMREMGenerator,\n  RGBAFormat,\n  Scene,\n  ShaderMaterial,\n  sRGBEncoding,\n  UniformsLib,\n  UniformsUtils,\n  Vector3,\n  WebGLCubeRenderTarget\n} = THREE;\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nconst vertexShader = `\n#include <common>\n#include <fog_pars_vertex>\n\nuniform vec3 sunPosition;\nuniform float rayleigh;\nuniform float turbidity;\nuniform float mieCoefficient;\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\nconst float pi = 3.141592653589793238462643383279502884197169;\n\n// wavelength of used primaries, according to preetham\nconst vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\nconst vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n// mie stuff\n// K coefficient for the primaries\nconst float v = 4.0;\nconst vec3 K = vec3( 0.686, 0.678, 0.666 );\n// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\nconst vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n// earth shadow hack\n// cutoffAngle = pi / 1.95;\nconst float cutoffAngle = 1.6110731556870734;\nconst float steepness = 1.5;\nconst float EE = 1000.0;\n\nfloat sunIntensity( float zenithAngleCos ) {\n  zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n  return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n}\n\nvec3 totalMie( float T ) {\n  float c = ( 0.2 * T ) * 10E-18;\n  return 0.434 * c * MieConst;\n}\n\nvoid main() {\n  #include <begin_vertex>\n\n  vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n  vWorldPosition = worldPosition.xyz;\n\n  #include <project_vertex>\n\n  vSunDirection = normalize( sunPosition );\n\n  vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n  vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n  float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n  // extinction (absorbtion + out scattering)\n  // rayleigh coefficients\n  vBetaR = totalRayleigh * rayleighCoefficient;\n\n  // mie coefficients\n  vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n  #include <fog_vertex>\n}\n`;\n\nconst fragmentShader = `\n#include <common>\n#include <fog_pars_fragment>\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nuniform float luminance;\nuniform float mieDirectionalG;\n\nconst vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float pi = 3.141592653589793238462643383279502884197169;\n\nconst float n = 1.0003; // refractive index of air\nconst float N = 2.545E25; // number of molecules per unit volume for air at\n// 288.15K and 1013mb (sea level -45 celsius)\n\n// optical length at zenith for molecules\nconst float rayleighZenithLength = 8.4E3;\nconst float mieZenithLength = 1.25E3;\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n// 66 arc seconds -> degrees, and the cosine of that\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n// 3.0 / ( 16.0 * pi )\nconst float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n// 1.0 / ( 4.0 * pi )\nconst float ONE_OVER_FOURPI = 0.07957747154594767;\n\nfloat rayleighPhase( float cosTheta ) {\n  return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n}\n\nfloat hgPhase( float cosTheta, float g ) {\n  float g2 = pow( g, 2.0 );\n  float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n  return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n}\n\n// Filmic ToneMapping http://filmicgames.com/archives/75\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\nconst float whiteScale = 1.0748724675633854; // 1.0 / Uncharted2Tonemap(1000.0)\n\nvec3 Uncharted2Tonemap( vec3 x ) {\n  return ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\n}\n\nvoid main() {\n  // optical length\n  // cutoff angle at 90 to avoid singularity in next formula.\n  float zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\n  float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n  float sR = rayleighZenithLength * inverse;\n  float sM = mieZenithLength * inverse;\n\n  // combined extinction factor\n  vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n  // in scattering\n  float cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\n\n  float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n  vec3 betaRTheta = vBetaR * rPhase;\n\n  float mPhase = hgPhase( cosTheta, mieDirectionalG );\n  vec3 betaMTheta = vBetaM * mPhase;\n\n  vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n  Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n  // nightsky\n  vec3 direction = normalize( vWorldPosition - cameraPos );\n  float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\n  float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\n  vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n  vec3 L0 = vec3( 0.1 ) * Fex;\n\n  // composition + solar disc\n  float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n  L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n  vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n  vec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\n  vec3 color = curr * whiteScale;\n\n  vec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n  gl_FragColor = vec4( retColor, 1.0 );\n\n  #include <fog_fragment>\n}\n`;\n\nexport default class Sky extends Object3D {\n  static shader = {\n    uniforms: UniformsUtils.merge([\n      UniformsLib.fog,\n      {\n        luminance: { value: 1 },\n        turbidity: { value: 10 },\n        rayleigh: { value: 2 },\n        mieCoefficient: { value: 0.005 },\n        mieDirectionalG: { value: 0.8 },\n        sunPosition: { value: new Vector3() }\n      }\n    ]),\n    vertexShader,\n    fragmentShader\n  };\n\n  static _geometry = new BoxBufferGeometry(1, 1, 1);\n\n  constructor() {\n    super();\n\n    const material = new ShaderMaterial({\n      fragmentShader: Sky.shader.fragmentShader,\n      vertexShader: Sky.shader.vertexShader,\n      uniforms: UniformsUtils.clone(Sky.shader.uniforms),\n      side: BackSide,\n      fog: true\n    });\n\n    this.sky = new Mesh(Sky._geometry, material);\n    this.sky.name = \"Sky\";\n    this.add(this.sky);\n\n    this._inclination = 0;\n    this._azimuth = 0.15;\n    this._distance = 8000;\n    this.updateSunPosition();\n  }\n\n  get turbidity() {\n    return this.sky.material.uniforms.turbidity.value;\n  }\n\n  set turbidity(value) {\n    this.sky.material.uniforms.turbidity.value = value;\n  }\n\n  get rayleigh() {\n    return this.sky.material.uniforms.rayleigh.value;\n  }\n\n  set rayleigh(value) {\n    this.sky.material.uniforms.rayleigh.value = value;\n  }\n\n  get luminance() {\n    return this.sky.material.uniforms.luminance.value;\n  }\n\n  set luminance(value) {\n    this.sky.material.uniforms.luminance.value = value;\n  }\n\n  get mieCoefficient() {\n    return this.sky.material.uniforms.mieCoefficient.value;\n  }\n\n  set mieCoefficient(value) {\n    this.sky.material.uniforms.mieCoefficient.value = value;\n  }\n\n  get mieDirectionalG() {\n    return this.sky.material.uniforms.mieDirectionalG.value;\n  }\n\n  set mieDirectionalG(value) {\n    this.sky.material.uniforms.mieDirectionalG.value = value;\n  }\n\n  get inclination() {\n    return this._inclination;\n  }\n\n  set inclination(value) {\n    this._inclination = value;\n    this.updateSunPosition();\n  }\n\n  get azimuth() {\n    return this._azimuth;\n  }\n\n  set azimuth(value) {\n    this._azimuth = value;\n    this.updateSunPosition();\n  }\n\n  get distance() {\n    return this._distance;\n  }\n\n  set distance(value) {\n    this._distance = value;\n    this.updateSunPosition();\n  }\n\n  updateSunPosition() {\n    const theta = Math.PI * (this._inclination - 0.5);\n    const phi = 2 * Math.PI * (this._azimuth - 0.5);\n\n    const distance = Math.min(1000, this._distance);\n\n    const x = distance * Math.cos(phi);\n    const y = distance * Math.sin(phi) * Math.sin(theta);\n    const z = distance * Math.sin(phi) * Math.cos(theta);\n\n    this.sky.material.uniforms.sunPosition.value.set(x, y, z).normalize();\n    this.sky.scale.set(distance, distance, distance);\n  }\n\n  generateEnvironmentMap(renderer) {\n    const skyScene = new Scene();\n    const cubeCamera = new CubeCamera(1, 100000, new WebGLCubeRenderTarget(512));\n    skyScene.add(cubeCamera);\n    skyScene.add(this.sky);\n    cubeCamera.update(renderer, skyScene);\n    this.add(this.sky);\n    const vrEnabled = renderer.xr.enabled;\n    renderer.xr.enabled = false;\n    const pmremGenerator = new PMREMGenerator(renderer);\n    const envMap = pmremGenerator.fromCubemap(cubeCamera.renderTarget.texture).texture;\n    renderer.xr.enabled = vrEnabled;\n    pmremGenerator.dispose();\n    cubeCamera.renderTarget.dispose();\n    return envMap;\n  }\n\n  generateLightProbe(renderer) {\n    const skyScene = new Scene();\n    skyScene.add(this.sky);\n\n    const cubeCamera = new CubeCamera(\n      1,\n      100000,\n      new WebGLCubeRenderTarget(512, {\n        format: RGBAFormat,\n        magFilter: LinearFilter,\n        minFilter: LinearFilter,\n        encoding: sRGBEncoding\n      })\n    );\n    skyScene.add(cubeCamera);\n    skyScene.add(this.sky);\n    cubeCamera.update(renderer, skyScene);\n    this.add(this.sky);\n    const lightProbe = LightProbeGenerator.fromCubeRenderTarget(renderer, cubeCamera.renderTarget);\n    cubeCamera.renderTarget.dispose();\n    return lightProbe;\n  }\n\n  copy(source, recursive = true) {\n    if (recursive) {\n      this.remove(this.sky);\n    }\n\n    super.copy(source, recursive);\n\n    if (recursive) {\n      const skyIndex = source.children.indexOf(source.sky);\n\n      if (skyIndex !== -1) {\n        this.sky = this.children[skyIndex];\n      }\n    }\n\n    this.turbidity = source.turbidity;\n    this.rayleigh = source.rayleigh;\n    this.luminance = source.luminance;\n    this.mieCoefficient = source.mieCoefficient;\n    this.mieDirectionalG = source.mieDirectionalG;\n    this.inclination = source.inclination;\n    this.azimuth = source.azimuth;\n    this.distance = source.distance;\n\n    return this;\n  }\n}\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0.15 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n  },\n\n  update(oldData) {\n    if (this.data.turbidity !== oldData.turbidity) {\n      this.sky.turbidity = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      this.sky.rayleigh = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      this.sky.luminance = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      this.sky.mieCoefficient = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      this.sky.mieDirectionalG = this.data.mieDirectionalG;\n    }\n\n    if (this.data.inclination !== oldData.inclination) {\n      this.sky.inclination = this.data.inclination;\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    if (this.data.azimuth !== oldData.azimuth) {\n      this.sky.azimuth = this.data.azimuth;\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    if (this.data.distance !== oldData.distance) {\n      const distance = this.data.distance;\n\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\n      // have their sky scales set to 1.\n      this.sky.distance = this.el.object3D.scale.x === 1 ? distance : 1;\n      this.sky.matrixNeedsUpdate = true;\n    }\n\n    // TODO Remove or rework medium quality mode\n    if (window.APP.store.state.preferences.materialQualitySetting === \"medium\") {\n      // This extra ambient light is here to normalize lighting with the MeshStandardMaterial.\n      // Without it, objects are significantly darker in brighter environments.\n      // It's kept to a low value to not wash out objects in very dark environments.\n      // This is a hack, but the results are much better than they are without it.\n      this.el.setObject3D(\"ambient-light\", new AmbientLight(0xffffff, 0.3));\n      this.el.setObject3D(\"light-probe\", this.sky.generateLightProbe(this.el.sceneEl.renderer));\n    }\n\n    // TODO if we care about dynamic skybox changes we should also update the enviornment map here\n    //\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\n/**\n * Used on a avatar-rig to move the avatar to a random spawn point on entry.\n * @namespace avatar\n * @component spawn-controller\n */\nAFRAME.registerComponent(\"spawn-controller\", {\n  schema: {\n    target: { type: \"selector\" },\n    camera: { type: \"selector\", default: \"#avatar-pov-node\" },\n    playerHeight: { default: 1.6 },\n    loadedEvent: { type: \"string\" }\n  },\n  init() {\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\n\n    waitForDOMContentLoaded().then(() => {\n      this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\n    });\n  },\n  moveToSpawnPoint() {\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\n\n    if (spawnPoints.length === 0) {\n      // Keep default position\n      return;\n    }\n\n    const camera = this.data.camera;\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\n    const spawnPoint = spawnPoints[spawnPointIndex];\n\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\n\n    if (this.el.sceneEl.is(\"vr-mode\")) {\n      // Rotate the avatar rig such that the vr-camera faces forward.\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\n    } else {\n      // Reset the camera transform in 2D mode.\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\n      camera.object3D.rotation.set(0, 0, 0);\n      camera.object3D.matrixNeedsUpdate = true;\n    }\n\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\n    this.el.object3D.rotation.y += Math.PI;\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n\n/**\n * Marks an entity as a potential spawn point.\n * @namespace environment\n * @component spawn-point\n */\nAFRAME.registerComponent(\"spawn-point\", {\n  init() {\n    this.el.object3D.visible = false;\n  }\n});\n","const COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nimport {\n  enterQuery,\n  addComponent,\n  removeComponent,\n  defineComponent,\n  defineQuery,\n  exitQuery,\n  hasComponent,\n  Not,\n  entityExists\n} from \"bitecs\";\nimport { FloatyObject, Held, Owned, Rigidbody, MakeKinematicOnRelease } from \"../bit-components\";\n\nexport const MakeStaticWhenAtRest = defineComponent();\n\nconst makeStaticAtRestQuery = defineQuery([FloatyObject, Rigidbody, Not(Held), MakeStaticWhenAtRest]);\nfunction makeStaticAtRest(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  makeStaticAtRestQuery(world).forEach(eid => {\n    const isMine = hasComponent(world, Owned, eid);\n    if (!isMine) {\n      removeComponent(world, MakeStaticWhenAtRest, eid);\n      return;\n    }\n\n    const bodyId = Rigidbody.bodyId[eid];\n    const bodyData = physicsSystem.bodyUuidToData.get(bodyId);\n    const isAtRest =\n      physicsSystem.bodyInitialized(bodyId) &&\n      physicsSystem.getLinearVelocity(bodyId) < bodyData.options.linearSleepingThreshold &&\n      physicsSystem.getAngularVelocity(bodyId) < bodyData.options.angularSleepingThreshold;\n\n    if (isAtRest) {\n      Object.assign(bodyData.options, {\n        type: \"kinematic\"\n      });\n      physicsSystem.updateBody(bodyId, bodyData.options);\n      removeComponent(world, MakeStaticWhenAtRest, eid);\n    }\n  });\n}\n\nconst makeKinematicOnReleaseExitQuery = exitQuery(defineQuery([Rigidbody, Held, MakeKinematicOnRelease]));\nfunction makeKinematicOnRelease(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  makeKinematicOnReleaseExitQuery(world).forEach(eid => {\n    if (!entityExists(world, eid) || !hasComponent(world, Owned, eid)) return;\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], { type: \"kinematic\" });\n  });\n}\n\nexport const FLOATY_OBJECT_FLAGS = {\n  MODIFY_GRAVITY_ON_RELEASE: 1 << 0,\n  REDUCE_ANGULAR_FLOAT: 1 << 1,\n  UNTHROWABLE: 1 << 2\n};\n\nconst enteredFloatyObjectsQuery = enterQuery(defineQuery([FloatyObject, Rigidbody]));\nconst heldFloatyObjectsQuery = defineQuery([FloatyObject, Rigidbody, Held]);\nconst exitedHeldFloatyObjectsQuery = exitQuery(heldFloatyObjectsQuery);\nconst enterHeldFloatyObjectsQuery = enterQuery(heldFloatyObjectsQuery);\nexport const floatyObjectSystem = world => {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  enteredFloatyObjectsQuery(world).forEach(eid => {\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], {\n      type: \"kinematic\",\n      gravity: { x: 0, y: 0, z: 0 }\n    });\n  });\n\n  enterHeldFloatyObjectsQuery(world).forEach(eid => {\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], {\n      gravity: { x: 0, y: 0, z: 0 },\n      type: \"dynamic\",\n      collisionFilterMask: COLLISION_LAYERS.HANDS | COLLISION_LAYERS.MEDIA_FRAMES\n    });\n  });\n\n  exitedHeldFloatyObjectsQuery(world).forEach(eid => {\n    if (!entityExists(world, eid) || !(hasComponent(world, FloatyObject, eid) && hasComponent(world, Rigidbody, eid)))\n      return;\n\n    const bodyId = Rigidbody.bodyId[eid];\n    const bodyData = physicsSystem.bodyUuidToData.get(bodyId);\n    if (FloatyObject.flags[eid] & FLOATY_OBJECT_FLAGS.MODIFY_GRAVITY_ON_RELEASE) {\n      if (bodyData.linearVelocity < 1.85) {\n        physicsSystem.updateBodyOptions(bodyId, {\n          gravity: { x: 0, y: 0, z: 0 },\n          angularDamping: FloatyObject.flags[eid] & FLOATY_OBJECT_FLAGS.REDUCE_ANGULAR_FLOAT ? 0.89 : 0.5,\n          linearDamping: 0.95,\n          linearSleepingThreshold: 0.1,\n          angularSleepingThreshold: 0.1,\n          collisionFilterMask: COLLISION_LAYERS.HANDS | COLLISION_LAYERS.MEDIA_FRAMES\n        });\n        addComponent(world, MakeStaticWhenAtRest, eid);\n      } else {\n        physicsSystem.updateBodyOptions(bodyId, {\n          gravity: { x: 0, y: FloatyObject.releaseGravity[eid], z: 0 },\n          angularDamping: 0.01,\n          linearDamping: 0.01,\n          linearSleepingThreshold: 1.6,\n          angularSleepingThreshold: 2.5,\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n        });\n        removeComponent(world, MakeStaticWhenAtRest, eid);\n      }\n    } else {\n      physicsSystem.updateBodyOptions(bodyId, {\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE,\n        gravity: { x: 0, y: -9.8, z: 0 }\n      });\n    }\n  });\n\n  makeStaticAtRest(world);\n  makeKinematicOnRelease(world);\n};\n","import { addComponent } from \"bitecs\";\nimport { FloatyObject } from \"../bit-components\";\nimport { FLOATY_OBJECT_FLAGS } from \"../systems/floaty-object-system\";\n/* global AFRAME */\n\nAFRAME.registerComponent(\"floaty-object\", {\n  schema: {\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\n    // otherwise apply releaseGravity.\n    modifyGravityOnRelease: { default: false },\n\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\n    releaseGravity: { default: -2 },\n\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\n    reduceAngularFloat: { default: false },\n\n    // If true, the object will behave the same regardless of how fast it was moving when released\n    unthrowable: { default: false }\n  },\n\n  init() {\n    addComponent(APP.world, FloatyObject, this.el.object3D.eid);\n  },\n\n  update() {\n    FloatyObject.flags[this.el.eid] =\n      (this.data.modifyGravityOnRelease && FLOATY_OBJECT_FLAGS.MODIFY_GRAVITY_ON_RELEASE) |\n      (this.data.reduceAngularFloat && FLOATY_OBJECT_FLAGS.REDUCE_ANGULAR_FLOAT) |\n      (this.data.unthrowable && FLOATY_OBJECT_FLAGS.UNTHROWABLE);\n    FloatyObject.releaseGravity[this.el.eid] = this.data.releaseGravity;\n  }\n});\n","/* global require AFRAME THREE setTimeout clearTimeout */\nimport { addMedia } from \"../utils/media-utils\";\nimport { waitForEvent } from \"../utils/async-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport { addComponent } from \"bitecs\";\nimport { Held, HeldRemoteLeft, HeldRemoteRight } from \"../bit-components\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nfunction setNonNullVec3Components(target, values) {\n  target.set(\n    values.x === null ? target.x : values.x,\n    values.y === null ? target.y : values.y,\n    values.z === null ? target.z : values.z\n  );\n}\n\n/**\n * Spawns networked objects when grabbed or when a specified event is fired.\n * @namespace network\n * @component super-spawner\n */\nAFRAME.registerComponent(\"super-spawner\", {\n  schema: {\n    /**\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\n     */\n    src: { default: \"\" },\n\n    /**\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\n     */\n    resolve: { default: false },\n\n    /**\n     * The template to use for this object\n     */\n    template: { default: \"\" },\n\n    /**\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\n     */\n    spawnScale: { type: \"vec3\", default: { x: NaN, y: NaN, z: NaN } },\n\n    /**\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\n     */\n    spawnCooldown: { default: 1 },\n\n    /**\n     * Optional event to listen for to spawn an object on the preferred superHand\n     */\n    spawnEvent: { type: \"string\" },\n\n    /**\n     * If true, will spawn the object at the cursor and animate it into the hand.\n     */\n    animateFromCursor: { type: \"boolean\" },\n\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.cooldownTimeout = null;\n    this.handPosition = new THREE.Vector3();\n\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\n\n    this.sceneEl = this.el.sceneEl;\n\n    this.tempSpawnHandPosition = new THREE.Vector3();\n\n    this.handleMediaLoaded = this.handleMediaLoaded.bind(this);\n\n    this.spawnedMediaScale = null;\n  },\n\n  play() {\n    this.el.addEventListener(\"media-loaded\", this.handleMediaLoaded);\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n  },\n\n  pause() {\n    this.el.removeEventListener(\"media-loaded\", this.handleMediaLoaded);\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n    if (this.cooldownTimeout) {\n      clearTimeout(this.cooldownTimeout);\n      this.cooldownTimeout = null;\n      this.el.setAttribute(\"visible\", true);\n      this.el.classList.add(\"interactable\");\n    }\n  },\n\n  handleMediaLoaded(e) {\n    const spawnedEntity = e.target;\n    this.spawnedMediaScale = spawnedEntity.object3D.scale.clone();\n    setNonNullVec3Components(this.spawnedMediaScale, this.data.spawnScale);\n\n    const boxSize =\n      spawnedEntity.components[\"media-image\"] ||\n      spawnedEntity.components[\"media-video\"] ||\n      spawnedEntity.components[\"media-pdf\"]\n        ? 1\n        : 0.5;\n\n    const scaleCoefficient = getScaleCoefficient(boxSize, getBox(spawnedEntity, spawnedEntity.object3D));\n    this.spawnedMediaScale.divideScalar(scaleCoefficient);\n  },\n\n  async onSpawnEvent(e) {\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\n      return;\n    }\n\n    const spawnedEntity = addMedia(\n      this.data.src,\n      this.data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      this.data.resolve,\n      false,\n      {\n        x: this.data.spawnScale.x === null ? 1 : this.data.spawnScale.x,\n        y: this.data.spawnScale.y === null ? 1 : this.data.spawnScale.y,\n        z: this.data.spawnScale.z === null ? 1 : this.data.spawnScale.z\n      },\n      this.data.mediaOptions\n    ).entity;\n\n    const interaction = this.el.sceneEl.systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    const cursor = (e.detail && e.detail.object3D) || interaction.options.rightRemote.entity.object3D;\n\n    const left = cursor.el.id.indexOf(\"right\") === -1;\n    const hand = left ? interaction.options.leftHand.entity.object3D : interaction.options.rightHand.entity.object3D;\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n    this.el.emit(\"spawned-entity-created\", { target: spawnedEntity });\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const willAnimateFromCursor =\n      this.data.animateFromCursor &&\n      (userinput.get(paths.actions.rightHand.matrix) || userinput.get(paths.actions.leftHand.matrix));\n    this.activateCooldown();\n    await waitForEvent(\"model-loaded\", spawnedEntity);\n\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n    if (willAnimateFromCursor) {\n      hand.getWorldPosition(this.handPosition);\n      spawnedEntity.setAttribute(\"animation__spawn-at-cursor\", {\n        property: \"position\",\n        delay: 500,\n        dur: 1500,\n        from: {\n          x: spawnedEntity.object3D.position.x,\n          y: spawnedEntity.object3D.position.y,\n          z: spawnedEntity.object3D.position.z\n        },\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\n        easing: \"easeInOutBack\"\n      });\n    } else {\n      addComponent(APP.world, Held, spawnedEntity.eid);\n      if (left) {\n        addComponent(APP.world, HeldRemoteLeft, spawnedEntity.eid);\n      } else {\n        addComponent(APP.world, HeldRemoteRight, spawnedEntity.eid);\n      }\n    }\n\n    // We skip this in the scene preview because\n    //   1. hubs-systems is not initialized in the scene preview\n    //   2. physics is not needed in the scene preview\n    if (this.el.sceneEl.systems[\"hubs-systems\"]) {\n      this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem.resetDynamicBody(\n        spawnedEntity.components[\"body-helper\"].uuid\n      );\n    }\n\n    spawnedEntity.addEventListener(\n      \"media-loaded\",\n      () => {\n        this.el.emit(\"spawned-entity-loaded\", { target: spawnedEntity });\n      },\n      { once: true }\n    );\n  },\n\n  activateCooldown() {\n    if (this.data.spawnCooldown > 0) {\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\n\n      this.el.setAttribute(\"visible\", false);\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.el.classList.remove(\"interactable\");\n      this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.NONE });\n      this.cooldownTimeout = setTimeout(() => {\n        this.el.setAttribute(\"visible\", true);\n        this.el.classList.add(\"interactable\");\n        this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\n          property: \"scale\",\n          delay: 50,\n          dur: 350,\n          from: { x: 0.001, y: 0.001, z: 0.001 },\n          to: { x: sx, y: sy, z: sz },\n          easing: \"easeOutElastic\"\n        });\n\n        setTimeout(() => {\n          this.cooldownTimeout = null;\n        }, 400);\n      }, this.data.spawnCooldown * 1000);\n    }\n  }\n});\n","import { Layers } from \"./layers\";\nimport \"../vendor/Water\";\nimport waterNormalMap from \"../assets/waternormals.jpg\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\n\n/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nfunction MobileWater(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: `\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    `,\n\n    fragmentShader: `\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk[\"common\"]}\n      ${THREE.ShaderChunk[\"packing\"]}\n      ${THREE.ShaderChunk[\"bsdfs\"]}\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: false,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n}\n\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\nMobileWater.prototype.constructor = THREE.Water;\n\nasync function loadWaterNormals(url) {\n  const texture = await new Promise((resolve, reject) => new HubsTextureLoader().load(url, resolve, undefined, reject));\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n  texture.needsUpdate = true;\n  return texture;\n}\n\nAFRAME.registerComponent(\"water\", {\n  schema: {\n    waterColor: { type: \"color\", default: \"#001e0f\" },\n    distortionScale: { type: \"number\", default: 3.7 },\n    sunColor: { type: \"color\", default: \"#ffffff\" },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 1 },\n    speed: { type: \"number\", default: 0.1 },\n    forceMobile: { type: \"boolean\", default: false }\n  },\n  init() {\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    const waterGeometry = waterMesh.geometry;\n\n    // Render THREE.Water shader instead of THREE.Mesh\n    waterMesh.visible = false;\n\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\n      const waterConfig = {\n        textureWidth: 512,\n        textureHeight: 512,\n        waterNormals: waterNormals,\n        sunDirection: this.data.sunDirection,\n        sunColor: new THREE.Color(this.data.sunColor),\n        waterColor: new THREE.Color(this.data.waterColor),\n        distortionScale: this.data.distortionScale,\n        fog: false\n      };\n\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\n        this.water = new MobileWater(waterGeometry, waterConfig);\n      } else {\n        this.water = new THREE.Water(waterGeometry, waterConfig);\n        this.water.mirrorCamera.layers.set(Layers.CAMERA_LAYER_REFLECTION);\n      }\n\n      this.el.setObject3D(\"water\", this.water);\n    });\n  },\n\n  update(oldData) {\n    if (this.data.forceMobile !== oldData.forceMobile) {\n      this.el.removeObject3D(\"water\");\n      this.init();\n      return;\n    }\n\n    if (!this.water) {\n      return;\n    }\n\n    const uniforms = this.water.material.uniforms;\n\n    if (this.data.waterColor !== oldData.waterColor) {\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\n    }\n\n    if (this.data.distortionScale !== oldData.distortionScale) {\n      uniforms.distortionScale.value = this.data.distortionScale;\n    }\n\n    if (this.data.sunColor !== oldData.sunColor) {\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunDirection.value.set(x, y, z);\n    }\n  },\n\n  tick(time) {\n    if (this.water) {\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"water\");\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    waterMesh.visible = true;\n  }\n});\n","import { SimplexNoise } from \"three/examples/jsm/math/SimplexNoise\";\nimport waterNormalsUrl from \"../assets/waternormals.jpg\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\n\nconst { Mesh, PlaneBufferGeometry, MeshStandardMaterial, MeshPhongMaterial, Vector2, RepeatWrapping } = THREE;\n\n/**\n * SimpleWater\n * Keep in sync with Spoke's SimpleWater class\n */\n\n/**\n * Adapted dynamic geometry code from: https://github.com/ditzel/UnityOceanWavesAndShip\n */\n\nclass Octave {\n  constructor(speed = new Vector2(1, 1), scale = new Vector2(1, 1), height = 0.0025, alternate = true) {\n    this.speed = speed;\n    this.scale = scale;\n    this.height = height;\n    this.alternate = alternate;\n  }\n}\nexport default class SimpleWater extends Mesh {\n  constructor(normalMap, resolution = 24, lowQuality = false) {\n    const geometry = new PlaneBufferGeometry(10, 10, resolution, resolution);\n    geometry.rotateX(-Math.PI / 2);\n\n    const waterUniforms = {\n      ripplesSpeed: { value: 0.25 },\n      ripplesScale: { value: 1 },\n      time: { value: 0 }\n    };\n\n    const materialClass = lowQuality ? MeshPhongMaterial : MeshStandardMaterial;\n\n    normalMap.wrapS = normalMap.wrapT = RepeatWrapping;\n\n    const material = new materialClass({ color: 0x0054df, normalMap, roughness: 0.5, metalness: 0.5 });\n    material.name = \"SimpleWaterMaterial\";\n\n    material.onBeforeCompile = shader => {\n      Object.assign(shader.uniforms, waterUniforms);\n\n      shader.vertexShader = shader.vertexShader.replace(\n        \"#include <fog_pars_vertex>\",\n        `\n        #include <fog_pars_vertex>\n        varying vec3 vWPosition;\n      `\n      );\n\n      shader.vertexShader = shader.vertexShader.replace(\n        \"#include <fog_vertex>\",\n        `\n        #include <fog_vertex>\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\n      `\n      );\n\n      // getNoise function from https://github.com/mrdoob/three.js/blob/dev/examples/jsm/objects/Water.js\n      shader.fragmentShader = shader.fragmentShader.replace(\n        \"#include <normalmap_pars_fragment>\",\n        `\n        #include <normalmap_pars_fragment>\n\n        uniform float time;\n        uniform float ripplesSpeed;\n        uniform float ripplesScale;\n      \n        varying vec3 vWPosition;\n      \n        vec4 getNoise(vec2 uv){\n          float timeOffset = time * ripplesSpeed;\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\n          vec4 noise = (texture2D(normalMap, uv0)) +\n                       (texture2D(normalMap, uv1)) +\n                       (texture2D(normalMap, uv2)) +\n                       (texture2D(normalMap, uv3));\n          return noise / 4.0;\n        }\n      `\n      );\n\n      // https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl.js#L20\n      shader.fragmentShader = shader.fragmentShader.replace(\n        \"#include <normal_fragment_maps>\",\n        `\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n          vec3 eye_pos = -vViewPosition;\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n          vec2 st0 = dFdx( vUv.st );\n          vec2 st1 = dFdy( vUv.st );\n\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n          vec3 N = normalize( normal );\n          mat3 tsn = mat3( S, T, N );\n\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\n\n          mapN.xy *= normalScale;\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n          normal = normalize( tsn * mapN );\n        `\n      );\n    };\n\n    super(geometry, material);\n\n    this.lowQuality = lowQuality;\n    this.waterUniforms = waterUniforms;\n\n    if (lowQuality) {\n      this.material.specular.set(0xffffff);\n    } else {\n      this.receiveShadow = true;\n    }\n\n    this.geometry.attributes.position.dynamic = true;\n\n    this.resolution = resolution;\n    this.octaves = [\n      new Octave(new Vector2(0.5, 0.5), new Vector2(1, 1), 0.01, true),\n      new Octave(new Vector2(0.05, 6), new Vector2(1, 20), 0.1, false)\n    ];\n\n    this.simplex = new SimplexNoise();\n  }\n\n  get opacity() {\n    return this.material.opacity;\n  }\n\n  set opacity(value) {\n    this.material.opacity = value;\n\n    if (value !== 1) {\n      this.material.transparent = true;\n    }\n  }\n\n  get color() {\n    return this.material.color;\n  }\n\n  get tideHeight() {\n    return this.octaves[0].height;\n  }\n\n  get tideScale() {\n    return this.octaves[0].scale;\n  }\n\n  get tideSpeed() {\n    return this.octaves[0].speed;\n  }\n\n  set tideHeight(value) {\n    this.octaves[0].height = value;\n  }\n\n  get waveHeight() {\n    return this.octaves[1].height;\n  }\n\n  set waveHeight(value) {\n    this.octaves[1].height = value;\n  }\n\n  get waveScale() {\n    return this.octaves[1].scale;\n  }\n\n  get waveSpeed() {\n    return this.octaves[1].speed;\n  }\n\n  set ripplesSpeed(value) {\n    this.waterUniforms.ripplesSpeed.value = value;\n  }\n\n  get ripplesSpeed() {\n    return this.waterUniforms.ripplesSpeed.value;\n  }\n\n  set ripplesScale(value) {\n    this.waterUniforms.ripplesScale.value = value;\n  }\n\n  get ripplesScale() {\n    return this.waterUniforms.ripplesScale.value;\n  }\n\n  update(time) {\n    const positionAttribute = this.geometry.attributes.position;\n\n    for (let x = 0; x <= this.resolution; x++) {\n      for (let z = 0; z <= this.resolution; z++) {\n        let y = 0;\n\n        for (let o = 0; o < this.octaves.length; o++) {\n          const octave = this.octaves[o];\n\n          if (octave.alternate) {\n            const noise = this.simplex.noise(\n              (x * octave.scale.x) / this.resolution,\n              (z * octave.scale.y) / this.resolution\n            );\n            y += Math.cos(noise + octave.speed.length() * time) * octave.height;\n          } else {\n            const noise =\n              this.simplex.noise(\n                (x * octave.scale.x + time * octave.speed.x) / this.resolution,\n                (z * octave.scale.y + time * octave.speed.y) / this.resolution\n              ) - 0.5;\n            y += noise * octave.height;\n          }\n        }\n\n        positionAttribute.setY(x * (this.resolution + 1) + z, y);\n      }\n    }\n\n    this.geometry.computeVertexNormals();\n    positionAttribute.needsUpdate = true;\n    this.waterUniforms.time.value = time;\n  }\n\n  clone(recursive) {\n    return new SimpleWater(this.material.normalMap, this.resolution, this.lowQuality).copy(this, recursive);\n  }\n\n  copy(source, recursive = true) {\n    super.copy(source, recursive);\n\n    this.opacity = source.opacity;\n    this.color.copy(source.color);\n    this.tideHeight = source.tideHeight;\n    this.tideScale.copy(source.tideScale);\n    this.tideSpeed.copy(source.tideSpeed);\n    this.waveHeight = source.waveHeight;\n    this.waveScale.copy(source.waveScale);\n    this.waveSpeed.copy(source.waveSpeed);\n    this.ripplesSpeed = source.ripplesSpeed;\n    this.ripplesScale = source.ripplesScale;\n\n    return this;\n  }\n}\n\nfunction vec2Equals(a, b) {\n  return a && b && a.x === b.x && a.y === b.y;\n}\n\nlet waterNormalMap = null;\n\nAFRAME.registerComponent(\"simple-water\", {\n  schema: {\n    opacity: { type: \"number\", default: 1 },\n    color: { type: \"color\" },\n    tideHeight: { type: \"number\", default: 0.01 },\n    tideScale: { type: \"vec2\", default: { x: 1, y: 1 } },\n    tideSpeed: { type: \"vec2\", default: { x: 0.5, y: 0.5 } },\n    waveHeight: { type: \"number\", default: 0.1 },\n    waveScale: { type: \"vec2\", default: { x: 1, y: 20 } },\n    waveSpeed: { type: \"vec2\", default: { x: 0.05, y: 6 } },\n    ripplesScale: { type: \"number\", default: 1 },\n    ripplesSpeed: { type: \"number\", default: 0.25 }\n  },\n\n  init() {\n    if (!waterNormalMap) {\n      waterNormalMap = new HubsTextureLoader().load(waterNormalsUrl);\n    }\n\n    const usePhongShader = window.APP.store.state.preferences.materialQualitySetting !== \"high\";\n    this.water = new SimpleWater(waterNormalMap, undefined, usePhongShader);\n    this.el.setObject3D(\"mesh\", this.water);\n  },\n\n  update(oldData) {\n    if (this.data.opacity !== oldData.opacity) {\n      this.water.opacity = this.data.opacity;\n    }\n\n    if (this.data.color !== oldData.color) {\n      this.water.color.set(this.data.color);\n    }\n\n    if (this.data.tideHeight !== oldData.tideHeight) {\n      this.water.tideHeight = this.data.tideHeight;\n    }\n\n    if (!vec2Equals(this.data.tideScale, oldData.tideScale)) {\n      this.water.tideScale.copy(this.data.tideScale);\n    }\n\n    if (!vec2Equals(this.data.tideSpeed, oldData.tideSpeed)) {\n      this.water.tideSpeed.copy(this.data.tideSpeed);\n    }\n\n    if (this.data.waveHeight !== oldData.waveHeight) {\n      this.water.waveHeight = this.data.waveHeight;\n    }\n\n    if (!vec2Equals(this.data.waveScale, oldData.waveScale)) {\n      this.water.waveScale.copy(this.data.waveScale);\n    }\n\n    if (!vec2Equals(this.data.waveSpeed, oldData.waveSpeed)) {\n      this.water.waveSpeed.copy(this.data.waveSpeed);\n    }\n\n    if (this.data.ripplesScale !== oldData.ripplesScale) {\n      this.water.ripplesScale = this.data.ripplesScale;\n    }\n\n    if (this.data.ripplesSpeed !== oldData.ripplesSpeed) {\n      this.water.ripplesSpeed = this.data.ripplesSpeed;\n    }\n  },\n\n  tick(time) {\n    this.water.update(time / 1000);\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","import { ParticleEmitter } from \"lib-hubs/packages/three-particle-emitter/lib/esm/index\";\nimport { textureLoader } from \"../utils/media-utils\";\nimport { resolveUrl } from \"../utils/media-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport defaultSrcImage from \"../assets/images/warning_icon.png\";\n\nconst defaultSrcUrl = new URL(defaultSrcImage, window.location.href).href;\n\nAFRAME.registerComponent(\"particle-emitter\", {\n  schema: {\n    resolve: { type: \"boolean\", default: true },\n    src: { type: \"string\", default: defaultSrcUrl },\n    startColor: { type: \"color\" },\n    middleColor: { type: \"color\" },\n    endColor: { type: \"color\" },\n    startOpacity: { type: \"number\", default: 1 },\n    middleOpacity: { type: \"number\", default: 1 },\n    endOpacity: { type: \"number\", default: 1 },\n    colorCurve: { type: \"string\", default: \"linear\" },\n    sizeCurve: { type: \"string\", default: \"linear\" },\n    startSize: { type: \"number\", default: 1 },\n    endSize: { type: \"number\", default: 1 },\n    sizeRandomness: { type: \"number\" },\n    ageRandomness: { type: \"number\" },\n    lifetime: { type: \"number\", default: 1 },\n    lifetimeRandomness: { type: \"number\" },\n    particleCount: { type: \"number\", default: 10 },\n    startVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\n    endVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\n    velocityCurve: { type: \"string\", default: \"linear\" },\n    angularVelocity: { type: \"number\" }\n  },\n\n  init() {\n    this.particleEmitter = new ParticleEmitter(null);\n    this.particleEmitter.visible = false;\n    this.el.setObject3D(\"particle-emitter\", this.particleEmitter);\n    this.updateParticles = false;\n    if (this.data.src === defaultSrcUrl) {\n      this.data.resolve = false;\n    }\n  },\n\n  async setTexture(src, resolve) {\n    let accessibleUrl = src;\n\n    if (resolve) {\n      const result = await resolveUrl(src);\n      let canonicalUrl = result.origin;\n\n      // handle protocol relative urls\n      if (canonicalUrl.startsWith(\"//\")) {\n        canonicalUrl = location.protocol + canonicalUrl;\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\n    }\n\n    const texture = await textureLoader.loadAsync(accessibleUrl);\n\n    // Guard against src changing while request was in flight\n    if (this.data.src !== src) {\n      return;\n    }\n\n    this.particleEmitter.material.uniforms.map.value = texture;\n    this.particleEmitter.visible = true;\n    this.updateParticles = true;\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const particleEmitter = this.particleEmitter;\n\n    if (prevData.src !== data.src) {\n      this.setTexture(data.src, data.resolve).catch(console.error);\n    }\n\n    if (\n      prevData.startColor !== data.startColor ||\n      prevData.startSize !== data.startSize ||\n      prevData.sizeRandomness !== data.sizeRandomness ||\n      prevData.ageRandomness !== data.ageRandomness ||\n      prevData.lifetime !== data.lifetime ||\n      prevData.lifetimeRandomness !== data.lifetimeRandomness ||\n      prevData.particleCount !== data.particleCount\n    ) {\n      this.updateParticles = true;\n    }\n\n    particleEmitter.startColor.set(data.startColor);\n    particleEmitter.middleColor.set(data.middleColor);\n    particleEmitter.endColor.set(data.endColor);\n    particleEmitter.startOpacity = data.startOpacity;\n    particleEmitter.middleOpacity = data.middleOpacity;\n    particleEmitter.endOpacity = data.endOpacity;\n    particleEmitter.colorCurve = data.colorCurve;\n    particleEmitter.sizeCurve = data.sizeCurve;\n    particleEmitter.startSize = data.startSize;\n    particleEmitter.endSize = data.endSize;\n    particleEmitter.sizeRandomness = data.sizeRandomness;\n    particleEmitter.ageRandomness = data.ageRandomness;\n    particleEmitter.lifetime = data.lifetime;\n    particleEmitter.lifetimeRandomness = data.lifetimeRandomness;\n    particleEmitter.particleCount = data.particleCount;\n    particleEmitter.startVelocity.copy(data.startVelocity);\n    particleEmitter.endVelocity.copy(data.endVelocity);\n    particleEmitter.velocityCurve = data.velocityCurve;\n    particleEmitter.angularVelocity = data.angularVelocity;\n  },\n\n  tick(time, dt) {\n    if (this.updateParticles) {\n      this.particleEmitter.updateParticles();\n      this.updateParticles = false;\n    }\n\n    if (this.particleEmitter.visible) {\n      this.particleEmitter.update(dt / 1000);\n    }\n  }\n});\n","import { updateAudioSettings } from \"../update-audio-settings\";\n\nAFRAME.registerComponent(\"audio-zone-source\", {\n  init() {\n    this.originalAudioParamsData = null;\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.registerSource(this);\n  },\n\n  remove() {\n    APP.zoneOverrides.delete(this.el);\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.unregisterSource(this);\n  },\n\n  getPosition: (() => {\n    const sourcePos = new THREE.Vector3();\n    return function () {\n      const audio = APP.audios.get(this.el);\n      if (audio) {\n        audio.getWorldPosition(sourcePos);\n      } else {\n        sourcePos.set(0, 0, 0);\n      }\n      return sourcePos;\n    };\n  })(),\n\n  apply(params) {\n    APP.zoneOverrides.set(this.el, params);\n    const audio = APP.audios.get(this.el);\n    if (audio) {\n      updateAudioSettings(this.el, audio);\n    }\n  },\n\n  restore() {\n    APP.zoneOverrides.delete(this.el);\n    const audio = APP.audios.get(this.el);\n    if (audio) {\n      updateAudioSettings(this.el, audio);\n    }\n  }\n});\n","// This is based largely on: @lojjic https://github.com/lojjic/aframe-troika-text/blob/master/src/aframe-troika-text-component.js\n// but has been made functional and restyled for Mozilla Hubs (hubs.mozilla.com)\n// by @jamesckane at Paradowski Creative (paradowski.com)\n\nimport { Text } from \"troika-three-text\";\n\n// Mark this type of object so we can filter in from our shader patching\nText.prototype.isTroikaText = true;\n\nconst THREE_SIDES = {\n  front: THREE.FrontSide,\n  back: THREE.BackSide,\n  double: THREE.DoubleSide\n};\n\nfunction numberOrPercent(defaultValue) {\n  return {\n    default: defaultValue,\n    parse: function(value) {\n      if (typeof value === \"string\" && value.indexOf(\"%\") > 0) {\n        return value;\n      }\n      value = +value;\n      return isNaN(value) ? 0 : value;\n    },\n    stringify: function(value) {\n      return \"\" + value;\n    }\n  };\n}\n\nAFRAME.registerComponent(\"text\", {\n  schema: {\n    textAlign: { type: \"string\", default: \"left\", oneOf: [\"left\", \"right\", \"center\", \"justify\"] },\n    anchorX: { default: \"center\", oneOf: [\"left\", \"right\", \"center\"] },\n    anchorY: { default: \"middle\", oneOf: [\"top\", \"top-baseline\", \"middle\", \"bottom-baseline\", \"bottom\"] },\n    clipRect: {\n      type: \"string\",\n      default: \"\",\n      parse: function(value) {\n        if (value) {\n          value = value.split(/[\\s,]+/).reduce(function(out, val) {\n            val = +val;\n            if (!isNaN(val)) {\n              out.push(val);\n            }\n            return out;\n          }, []);\n        }\n        return value && value.length === 4 ? value : null;\n      },\n      stringify: function(value) {\n        return value ? value.join(\" \") : \"\";\n      }\n    },\n    color: { type: \"color\", default: \"#FFF\" },\n    curveRadius: { type: \"number\", default: 0 },\n    depthOffset: { type: \"number\", default: 0 },\n    direction: { type: \"string\", default: \"auto\", oneOf: [\"auto\", \"ltr\", \"rtl\"] },\n    fillOpacity: { type: \"number\", default: 1 },\n    // {type:\"string\"},\n    // This is different from the Troika preoperty name, Using \"fontUrl\" to prevent conflict with previous \"font\" property and to allow us to make named fonts later\n    fontUrl: { \n      type: \"string\",\n      default : \"https://delivr.net/gh/spoqa/spoqa-han-sans@latest/Subset/SpoqaHanSansNeo/SpoqaHanSansNeo-Regular.woff\"\n    },\n    // This default value differs from the Troika default of 0.1, it most closely matches the size of our previous text component.\n    fontSize: { type: \"number\", default: 0.075 },\n    letterSpacing: { type: \"number\", default: 0 },\n    lineHeight: { type: \"number\" },\n    maxWidth: { type: \"number\", default: Infinity },\n    outlineBlur: numberOrPercent(0),\n    outlineColor: { type: \"color\", default: \"#000\" },\n    outlineOffsetX: numberOrPercent(0),\n    outlineOffsetY: numberOrPercent(0),\n    outlineOpacity: { type: \"number\", default: 1 },\n    outlineWidth: numberOrPercent(0),\n    overflowWrap: { type: \"string\", default: \"normal\", oneOf: [\"normal\", \"break-word\"] },\n    strokeColor: { type: \"color\", default: \"grey\" },\n    strokeOpacity: { type: \"number\", default: 1 },\n    strokeWidth: numberOrPercent(0),\n    // Note this is different than the Troika property name, Using \"value\" instead of \"text\" here to prevent code changes.\n    value: { type: \"string\", default: \"\" },\n    textIndent: { type: \"number\", default: 0 },\n    whiteSpace: { default: \"normal\", oneOf: [\"normal\", \"nowrap\"] },\n    opacity: { type: \"number\", default: 1.0 },\n    side: { default: \"front\", oneOf: [\"front\", \"back\", \"double\"] }\n  },\n\n  /**\n   * Called once when component is attached for initial setup.\n   */\n  init: function() {\n    this.troikaTextMesh = new Text();\n    this.troikaTextMesh.material.toneMapped = false;\n    this.el.setObject3D(\"text\", this.troikaTextMesh);\n  },\n\n  /**\n   * Called when component is attached and when component data changes.\n   * Generally modifies the entity based on the data.\n   */\n  update: function() {\n    const data = this.data;\n    const mesh = this.troikaTextMesh;\n\n    // Update the text mesh\n    mesh.text = data.value || \"\";\n    mesh.textAlign = data.textAlign;\n    mesh.anchorX = data.anchorX;\n    mesh.anchorY = data.anchorY;\n    mesh.color = data.color;\n    mesh.material.side = THREE_SIDES[data.side];\n    mesh.material.opacity = data.opacity;\n    mesh.curveRadius = data.curveRadius;\n    mesh.depthOffset = data.depthOffset || 0;\n    mesh.direction = data.direction;\n    mesh.fillOpacity = data.fillOpacity;\n    mesh.font = data.fontUrl;\n    mesh.fontSize = data.fontSize;\n    mesh.letterSpacing = data.letterSpacing || 0;\n    mesh.clipRect = data.clipRect;\n    mesh.lineHeight = data.lineHeight || \"normal\";\n    mesh.outlineBlur = data.outlineBlur;\n    mesh.outlineColor = data.outlineColor;\n    mesh.outlineOffsetX = data.outlineOffsetX;\n    mesh.outlineOffsetY = data.outlineOffsetY;\n    mesh.outlineOpacity = data.outlineOpacity;\n    mesh.outlineWidth = data.outlineWidth;\n    mesh.overflowWrap = data.overflowWrap;\n    mesh.strokeColor = data.strokeColor;\n    mesh.strokeOpacity = data.strokeOpacity;\n    mesh.strokeWidth = data.strokeWidth;\n    mesh.textIndent = data.textIndent;\n    mesh.whiteSpace = data.whiteSpace;\n    mesh.maxWidth = data.maxWidth;\n    mesh.sync(() => {\n      this.el.emit(\"text-updated\", this);\n    });\n  },\n\n  /**\n   * Called when a component is removed (e.g., via removeAttribute).\n   * Generally undoes all modifications to the entity.\n   */\n  remove: function() {\n    // Free memory\n    this.troikaTextMesh.dispose();\n  },\n\n  getSize: (function() {\n    const size = new THREE.Vector3();\n    return function(outSize) {\n      this.troikaTextMesh.geometry.boundingBox.getSize(size);\n      outSize.set(\n        size.x * this.troikaTextMesh.scale.x,\n        size.y * this.troikaTextMesh.scale.y,\n        size.z * this.troikaTextMesh.scale.z\n      );\n    };\n  })()\n});\n","import { SOUND_TOGGLE_MIC } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles the microphone on the current network connection based on the given events.\n * @namespace network\n * @component mute-mic\n */\nAFRAME.registerComponent(\"mute-mic\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    muteEvents: { type: \"array\" },\n    unmuteEvents: { type: \"array\" }\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    this.onMute = this.onMute.bind(this);\n    this.onUnmute = this.onUnmute.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    bindAllEvents(eventSrc, muteEvents, this.onMute);\n    bindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    unbindAllEvents(eventSrc, muteEvents, this.onMute);\n    unbindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  onToggle: function() {\n    APP.mediaDevicesManager.toggleMic();\n    if (!this.el.sceneEl.is(\"entered\")) return;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n  },\n\n  onMute: function() {\n    APP.mediaDevicesManager.micEnabled = false;\n  },\n\n  onUnmute: function() {\n    APP.mediaDevicesManager.micEnabled = true;\n  }\n});\n","/**\n * Scales an object to near-zero if the object is invisible. Useful for bones representing avatar body parts.\n * @namespace avatar\n * @component bone-visibility\n */\n\nconst HIDDEN_SCALE = 0.00000001;\n\nconst components = [];\nexport class BoneVisibilitySystem {\n  tick() {\n    for (let i = 0; i < components.length; i++) {\n      const cmp = components[i];\n      const obj = cmp.el.object3D;\n      const { visible, scale } = obj;\n      const { updateWhileInvisible } = cmp.data;\n      if (visible !== cmp.lastVisible || updateWhileInvisible) {\n        if (visible && (scale.x !== 1 || scale.y !== 1 || scale.z !== 1)) {\n          scale.setScalar(1);\n          obj.matrixNeedsUpdate = true;\n        } else if (!visible && (scale.x !== HIDDEN_SCALE || scale.y !== HIDDEN_SCALE || scale.z !== HIDDEN_SCALE)) {\n          scale.setScalar(HIDDEN_SCALE);\n          obj.matrixNeedsUpdate = true;\n        }\n\n        // Normally this object being invisible would cause it not to get updated even though the matrixNeedsUpdate flag is set, force it\n        if (updateWhileInvisible && obj.matrixNeedsUpdate) {\n          obj.updateMatrixWorld(true, true);\n        }\n      }\n      cmp.lastVisible = visible;\n    }\n  }\n\n  // Called only from camera-tool.tock() to update the matrices\n  // of objects and their children whose are updated in tick().\n  updateMatrices() {\n    for (let i = 0; i < components.length; i++) {\n      const cmp = components[i];\n      const obj = cmp.el.object3D;\n      if (obj.matrixNeedsUpdate) {\n        obj.updateMatrixWorld();\n      }\n    }\n  }\n}\n\nAFRAME.registerComponent(\"bone-visibility\", {\n  schema: {\n    updateWhileInvisible: { type: \"boolean\", default: false }\n  },\n  play() {\n    components.push(this);\n  },\n  pause() {\n    components.splice(components.indexOf(this), 1);\n  }\n});\n","import { SOUND_SPAWN_PEN } from \"../systems/sound-effects-system\";\n/**\n * HUD panel for muting, freezing, and other controls that don't necessarily have hardware buttons.\n * @namespace ui\n * @component in-world-hud\n */\nAFRAME.registerComponent(\"in-world-hud\", {\n  init() {\n    this.mic = this.el.querySelector(\".mic\");\n    this.spawn = this.el.querySelector(\".spawn\");\n    this.pen = this.el.querySelector(\".penhud\");\n    this.cameraBtn = this.el.querySelector(\".camera-btn\");\n    this.inviteBtn = this.el.querySelector(\".invite-btn\");\n    this.background = this.el.querySelector(\".bg\");\n\n    this.onMicStateChanged = () => {\n      this.mic.setAttribute(\"mic-button\", \"active\", APP.dialog.isMicEnabled);\n    };\n    APP.dialog.on(\"mic-state-changed\", this.onMicStateChanged);\n\n    this.updateButtonStates = () => {\n      this.mic.setAttribute(\"mic-button\", \"active\", APP.dialog.isMicEnabled);\n      this.pen.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"pen\"));\n      this.cameraBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"camera\"));\n      if (window.APP.hubChannel) {\n        this.spawn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_and_move_media\"));\n        this.pen.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_drawing\"));\n        this.cameraBtn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_camera\"));\n      }\n    };\n\n    this.onStateChange = evt => {\n      if (!(evt.detail === \"frozen\" || evt.detail === \"pen\" || evt.detail === \"camera\")) return;\n      this.updateButtonStates();\n    };\n\n    this.onMicClick = () => {\n      APP.mediaDevicesManager.toggleMic();\n    };\n\n    this.onSpawnClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_and_move_media\")) return;\n      this.el.emit(\"action_spawn\");\n    };\n\n    this.onPenClick = e => {\n      if (!window.APP.hubChannel.can(\"spawn_drawing\")) return;\n      this.el.emit(\"spawn_pen\", { object3D: e.object3D });\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPAWN_PEN);\n    };\n\n    this.onCameraClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_camera\")) return;\n      this.el.emit(\"action_toggle_camera\");\n    };\n\n    this.onInviteClick = () => {\n      this.el.emit(\"action_invite\");\n    };\n\n    this.onHubUpdated = e => {\n      this.inviteBtn.object3D.visible = e.detail.hub.entry_mode !== \"invite\";\n    };\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updateButtonStates);\n    this.el.sceneEl.addEventListener(\"hub_updated\", this.onHubUpdated);\n    this.updateButtonStates();\n\n    this.mic.object3D.addEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.addEventListener(\"interact\", this.onSpawnClick);\n    this.pen.object3D.addEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.addEventListener(\"interact\", this.onCameraClick);\n    this.inviteBtn.object3D.addEventListener(\"interact\", this.onInviteClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateButtonStates);\n    this.el.sceneEl.removeEventListener(\"hub_updated\", this.onHubUpdated);\n\n    this.mic.object3D.removeEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.removeEventListener(\"interact\", this.onSpawnClick);\n    this.pen.object3D.removeEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.removeEventListener(\"interact\", this.onCameraClick);\n    this.inviteBtn.object3D.removeEventListener(\"interact\", this.onInviteClick);\n  }\n});\n","/* global performance */\nimport { addMedia } from \"../utils/media-utils\";\nimport { SOUND_SPAWN_EMOJI } from \"../systems/sound-effects-system\";\nimport emoji0Particle from \"../assets/images/emojis/emoji_0.png\";\nimport emoji1Particle from \"../assets/images/emojis/emoji_1.png\";\nimport emoji2Particle from \"../assets/images/emojis/emoji_2.png\";\nimport emoji3Particle from \"../assets/images/emojis/emoji_3.png\";\nimport emoji4Particle from \"../assets/images/emojis/emoji_4.png\";\nimport emoji5Particle from \"../assets/images/emojis/emoji_5.png\";\nimport emoji6Particle from \"../assets/images/emojis/emoji_6.png\";\nimport emoji0Model from \"../assets/models/emojis/emoji_0.glb\";\nimport emoji1Model from \"../assets/models/emojis/emoji_1.glb\";\nimport emoji2Model from \"../assets/models/emojis/emoji_2.glb\";\nimport emoji3Model from \"../assets/models/emojis/emoji_3.glb\";\nimport emoji4Model from \"../assets/models/emojis/emoji_4.glb\";\nimport emoji5Model from \"../assets/models/emojis/emoji_5.glb\";\nimport emoji6Model from \"../assets/models/emojis/emoji_6.glb\";\n\nexport const emojis = [\n  { id: \"smile\", model: emoji0Model, particle: emoji0Particle },\n  { id: \"laugh\", model: emoji1Model, particle: emoji1Particle },\n  { id: \"clap\", model: emoji2Model, particle: emoji2Particle },\n  { id: \"heart\", model: emoji3Model, particle: emoji3Particle },\n  { id: \"wave\", model: emoji4Model, particle: emoji4Particle },\n  { id: \"angry\", model: emoji5Model, particle: emoji5Particle },\n  { id: \"cry\", model: emoji6Model, particle: emoji6Particle }\n].map(({ model, particle, ...rest }) => {\n  return {\n    ...rest,\n    model: new URL(model, window.location).href,\n    particleEmitterConfig: {\n      src: new URL(particle, window.location).href,\n      resolve: false,\n      particleCount: 20,\n      startSize: 0.01,\n      endSize: 0.2,\n      sizeRandomness: 0.05,\n      lifetime: 1,\n      lifetimeRandomness: 0.2,\n      ageRandomness: 1,\n      startVelocity: { x: 0, y: 1, z: 0 },\n      endVelocity: { x: 0, y: 0.25, z: 0 },\n      startOpacity: 1,\n      middleOpacity: 1,\n      endOpacity: 0\n    }\n  };\n});\n\nexport function spawnEmojiInFrontOfUser({ model, particleEmitterConfig }) {\n  const { entity } = addMedia(model, \"#interactable-emoji\");\n  entity.setAttribute(\"offset-relative-to\", {\n    target: \"#avatar-pov-node\",\n    offset: { x: 0, y: 0, z: -1.5 }\n  });\n  entity.addEventListener(\"model-loaded\", () => {\n    entity.querySelector(\".particle-emitter\").setAttribute(\"particle-emitter\", particleEmitterConfig);\n    entity.setAttribute(\"emoji\", { particleEmitterConfig: particleEmitterConfig });\n  });\n}\n\nAFRAME.registerComponent(\"emoji\", {\n  schema: {\n    emitDecayTime: { default: 1.5 },\n    emitFadeTime: { default: 0.5 },\n    emitEndTime: { default: 0 },\n    particleEmitterConfig: {\n      default: null,\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.data.emitEndTime = performance.now() + this.data.emitDecayTime * 1000;\n    this.physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n  },\n\n  play() {\n    const mediaLoader = this.el.components[\"media-loader\"];\n    if (emojis.find(emoji => emoji.model !== mediaLoader.data.src) === -1) {\n      this.el.parentNode.removeChild(this.el);\n      return;\n    }\n\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\n      SOUND_SPAWN_EMOJI,\n      this.el.object3D\n    );\n    this.particleEmitter = this.el.querySelector(\".particle-emitter\");\n  },\n\n  update() {\n    if (!this.particleConfig && this.data.particleEmitterConfig) {\n      this.particleConfig = Object.assign({}, this.data.particleEmitterConfig);\n      this.originalParticleCount = this.particleConfig.particleCount;\n    }\n  },\n\n  tick() {\n    const isMine = this.el.components.networked.initialized && this.el.components.networked.isMine();\n\n    if (this.particleConfig && isMine) {\n      const now = performance.now();\n\n      const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n\n      if (isHeld) {\n        this.data.emitEndTime = now + this.data.emitDecayTime * 1000;\n      }\n\n      const emitFadeTime = this.data.emitFadeTime * 1000;\n\n      if (now < this.data.emitEndTime && this.particleConfig.startOpacity < 1) {\n        this.particleConfig.particleCount = this.originalParticleCount;\n        this.particleConfig.startOpacity = 1;\n        this.particleConfig.middleOpacity = 1;\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\n      } else if (now >= this.data.emitEndTime && this.particleConfig.startOpacity > 0.001) {\n        const timeSinceStop = Math.min(now - this.data.emitEndTime, emitFadeTime);\n        const opacity = 1 - timeSinceStop / emitFadeTime;\n        const particleCount = opacity < 0.001 && this.particleConfig.particleCount > 0 ? 0 : this.originalParticleCount;\n        this.particleConfig.particleCount = particleCount;\n        this.particleConfig.startOpacity = opacity;\n        this.particleConfig.middleOpacity = opacity;\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\n      }\n    }\n  }\n});\n","import { addComponent, removeComponent } from \"bitecs\";\nimport { TYPE } from \"three-ammo/constants\";\nimport { HandCollisionTarget } from \"../bit-components\";\nimport { emojis } from \"./emoji\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nfunction setOffsetVector(i, totalNumEmojis, width, spacing, offsetVector) {\n  const sign = i & 1 ? -1 : 1;\n  offsetVector.y = 0;\n  if (totalNumEmojis % 2 === 0) {\n    offsetVector.x = (spacing / 2 + width / 2 + Math.floor(i / 2) * (width + spacing)) * sign;\n    offsetVector.z = (Math.floor(i / 2) * width) / 2;\n  } else if (i !== 0) {\n    offsetVector.x = (width + spacing) * Math.floor((i + 1) / 2) * -sign;\n    offsetVector.z = (Math.floor((i + 1) / 2) * width) / 2;\n  }\n}\n\nAFRAME.registerComponent(\"emoji-hud\", {\n  schema: {\n    spawnerScale: { default: 0.1 },\n    spawnedScale: { default: 0.5 },\n    camera: { type: \"selector\", default: \"#avatar-pov-node\" },\n    hudAngle: { default: -0.5 },\n    minHudAngle: { default: -0.2 },\n    maxHudAngle: { default: 0.7 },\n    hudDistance: { default: 0.4 },\n    spawnerPlatformWidth: { default: 0.0625 },\n    spawnerPlatformSpacing: { default: 0.021 }\n  },\n\n  init: (() => {\n    const cameraWorldPosition = new THREE.Vector3();\n    const offsetVector = new THREE.Vector3();\n    return function() {\n      this._onFrozen = this._onFrozen.bind(this);\n      this._onThaw = this._onThaw.bind(this);\n\n      const width = this.data.spawnerPlatformWidth;\n      const spacing = this.data.spawnerPlatformSpacing;\n\n      this.spawnerEntities = [];\n\n      for (let i = 0; i < emojis.length; i++) {\n        const spawnerEntity = document.createElement(\"a-entity\");\n        spawnerEntity.setAttribute(\"media-loader\", { src: emojis[i].model });\n        spawnerEntity.setAttribute(\"hoverable-visuals\", \"\");\n        spawnerEntity.setAttribute(\"scale\", {\n          x: this.data.spawnerScale,\n          y: this.data.spawnerScale,\n          z: this.data.spawnerScale\n        });\n        spawnerEntity.setAttribute(\"is-remote-hover-target\", \"\");\n        spawnerEntity.setAttribute(\"tags\", { isHandCollisionTarget: false });\n        spawnerEntity.setAttribute(\"visibility-while-frozen\", {\n          requireHoverOnNonMobile: false,\n          withPermission: \"spawn_emoji\"\n        });\n        spawnerEntity.setAttribute(\"css-class\", \"interactable\");\n        spawnerEntity.setAttribute(\"body-helper\", {\n          mass: 0,\n          type: TYPE.STATIC,\n          collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n        });\n\n        spawnerEntity.addEventListener(\"spawned-entity-created\", e => {\n          if (this.el.sceneEl.is(\"vr-mode\")) {\n            return;\n          }\n          const object3D = e.detail.target.object3D;\n          const cameraObject3D = this.data.camera.object3D;\n          object3D.updateMatrices();\n          cameraObject3D.getWorldPosition(cameraWorldPosition);\n          object3D.lookAt(cameraWorldPosition.x, object3D.position.y, cameraWorldPosition.z);\n          object3D.matrixNeedsUpdate = true;\n        });\n\n        spawnerEntity.addEventListener(\"spawned-entity-loaded\", e => {\n          const particleEmitterConfig = emojis[i].particleEmitterConfig;\n          e.detail.target.querySelector(\".particle-emitter\").setAttribute(\"particle-emitter\", particleEmitterConfig);\n          e.detail.target.setAttribute(\"emoji\", { particleEmitterConfig: particleEmitterConfig });\n        });\n\n        spawnerEntity.setAttribute(\"super-spawner\", {\n          src: emojis[i].model,\n          template: \"#interactable-emoji\",\n          spawnScale: { x: this.data.spawnedScale, y: this.data.spawnedScale, z: this.data.spawnedScale }\n        });\n\n        setOffsetVector(i, emojis.length, width, spacing, offsetVector);\n\n        spawnerEntity.object3D.position.copy(offsetVector);\n        spawnerEntity.object3D.matrixNeedsUpdate = true;\n\n        this.el.appendChild(spawnerEntity);\n\n        this.spawnerEntities.push(spawnerEntity);\n      }\n    };\n  })(),\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this._onFrozen);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._onThaw);\n    this._updateOffset();\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._onFrozen);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._onThaw);\n  },\n\n  _onFrozen(e) {\n    if (e.detail === \"frozen\") {\n      this._updateOffset();\n      for (let i = 0; i < this.spawnerEntities.length; i++) {\n        addComponent(APP.world, HandCollisionTarget, this.spawnerEntities[i].eid);\n      }\n    }\n  },\n\n  _onThaw(e) {\n    if (e.detail === \"frozen\") {\n      for (let i = 0; i < this.spawnerEntities.length; i++) {\n        removeComponent(APP.world, HandCollisionTarget, this.spawnerEntities[i].eid);\n      }\n    }\n  },\n\n  _updateOffset: (function() {\n    const targetWorldPos = new THREE.Vector3();\n    const cameraForward = new THREE.Vector3();\n    const projectedCameraForward = new THREE.Vector3();\n    const angledCameraForward = new THREE.Vector3();\n    const defaultRight = new THREE.Vector3(1, 0, 0);\n    return function() {\n      const obj = this.el.object3D;\n      const cameraObject3D = this.data.camera.object3D;\n      cameraObject3D.updateMatrices();\n      cameraForward.set(0, 0, -1);\n      cameraForward.transformDirection(cameraObject3D.matrixWorld);\n      projectedCameraForward.set(0, 0, -1);\n      projectedCameraForward.transformDirection(cameraObject3D.matrixWorld);\n      projectedCameraForward.projectOnPlane(THREE.Object3D.DefaultUp).normalize();\n      const angle =\n        Math.sign(THREE.Object3D.DefaultUp.dot(cameraForward)) * projectedCameraForward.angleTo(cameraForward);\n      const angleOffset = angle - Math.max(this.data.minHudAngle, Math.min(this.data.maxHudAngle, angle));\n      angledCameraForward.set(0, 0, -1);\n      angledCameraForward.applyAxisAngle(defaultRight, this.data.hudAngle - angleOffset);\n      angledCameraForward.multiplyScalar(this.data.hudDistance);\n      cameraObject3D.localToWorld(angledCameraForward);\n      obj.parent.worldToLocal(angledCameraForward);\n      obj.position.copy(angledCameraForward);\n      obj.updateMatrices(true);\n      cameraObject3D.getWorldPosition(targetWorldPos);\n      obj.lookAt(targetWorldPos);\n      obj.matrixNeedsUpdate = true;\n    };\n  })()\n});\n","// extracted by mini-css-extract-plugin\nexport default {\"touchZone\":\"virtual-gamepad-controls__touchZone__s5d9p\",\"left\":\"virtual-gamepad-controls__left__SOA3B\",\"right\":\"virtual-gamepad-controls__right__CheCZ\",\"mockJoystickContainer\":\"virtual-gamepad-controls__mockJoystickContainer__KBQOm\",\"mockJoystick\":\"virtual-gamepad-controls__mockJoystick__uIAar\",\"hidden\":\"virtual-gamepad-controls__hidden__kFvSs\",\"inner\":\"virtual-gamepad-controls__inner__B2zxf\"};","import nipplejs from \"nipplejs\";\nimport styles from \"./virtual-gamepad-controls.css\";\n\nfunction insertAfter(el, referenceEl) {\n  referenceEl.parentNode.insertBefore(el, referenceEl.nextSibling);\n}\n\nconst ROTATION_SPEED = 0.025;\n\n/**\n * Instantiates 2D virtual gamepads and emits associated events.\n * @namespace user-input\n * @component virtual-gamepad-controls\n */\nAFRAME.registerComponent(\"virtual-gamepad-controls\", {\n  schema: {},\n\n  init() {\n    this.characterController = this.el.sceneEl.systems[\"hubs-systems\"].characterController;\n\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n    this.onFirstInteraction = this.onFirstInteraction.bind(this);\n    this.onMoveJoystickChanged = this.onMoveJoystickChanged.bind(this);\n    this.onMoveJoystickEnd = this.onMoveJoystickEnd.bind(this);\n    this.onLookJoystickChanged = this.onLookJoystickChanged.bind(this);\n    this.onLookJoystickEnd = this.onLookJoystickEnd.bind(this);\n\n    this.mockJoystickContainer = document.createElement(\"div\");\n    this.mockJoystickContainer.classList.add(styles.mockJoystickContainer);\n    this.leftMock = document.createElement(\"div\");\n    this.leftMock.classList.add(styles.mockJoystick);\n    this.leftMockSmall = document.createElement(\"div\");\n    this.leftMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    this.leftMock.appendChild(this.leftMockSmall);\n    this.mockJoystickContainer.appendChild(this.leftMock);\n    this.rightMock = document.createElement(\"div\");\n    this.rightMock.classList.add(styles.mockJoystick);\n    this.rightMockSmall = document.createElement(\"div\");\n    this.rightMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    this.rightMock.appendChild(this.rightMockSmall);\n    this.mockJoystickContainer.appendChild(this.rightMock);\n\n    this.enableLeft = window.APP.store.state.preferences.enableOnScreenJoystickLeft;\n    this.enableRight = window.APP.store.state.preferences.enableOnScreenJoystickRight;\n    if (this.enableLeft || this.enableRight) {\n      // Add the joystick container after the canvas element but before the rest of the UI.\n      insertAfter(this.mockJoystickContainer, this.el.sceneEl.canvas);\n    }\n    if (this.enableLeft) {\n      this.createLeftStick();\n    } else {\n      this.leftMock.classList.add(styles.hidden);\n      this.leftMockSmall.classList.add(styles.hidden);\n    }\n    if (this.enableRight) {\n      this.createRightStick();\n    } else {\n      this.rightMock.classList.add(styles.hidden);\n      this.rightMockSmall.classList.add(styles.hidden);\n    }\n    this.onPreferenceChange = this.onPreferenceChange.bind(this);\n    window.APP.store.addEventListener(\"statechanged\", this.onPreferenceChange);\n\n    this.inVr = false;\n    this.moving = false;\n    this.rotating = false;\n\n    this.displacement = new THREE.Vector3();\n    this.lookDy = 0;\n    this.lookDx = 0;\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVr);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n\n  onPreferenceChange() {\n    const newEnableLeft = window.APP.store.state.preferences.enableOnScreenJoystickLeft;\n    const newEnableRight = window.APP.store.state.preferences.enableOnScreenJoystickRight;\n    const isChanged = this.enableLeft !== newEnableLeft || this.enableRight !== newEnableRight;\n    if (!isChanged) {\n      return;\n    }\n    if ((newEnableLeft || newEnableRight) && !this.mockJoystickContainer.parentNode) {\n      insertAfter(this.mockJoystickContainer, this.el.sceneEl.canvas);\n    }\n    if (!this.enableLeft && newEnableLeft) {\n      this.createLeftStick();\n    } else if (this.enableLeft && !newEnableLeft) {\n      this.leftMock.classList.add(styles.hidden);\n      this.leftMockSmall.classList.add(styles.hidden);\n      this.leftStick.destroy();\n      this.leftTouchZone.parentNode.removeChild(this.leftTouchZone);\n      this.leftStick = null;\n      this.leftTouchZone = null;\n    }\n    if (!this.enableRight && newEnableRight) {\n      this.createRightStick();\n    } else if (this.enableRight && !newEnableRight) {\n      this.rightMock.classList.add(styles.hidden);\n      this.rightMockSmall.classList.add(styles.hidden);\n      this.rightStick.destroy();\n      this.rightTouchZone.parentNode.removeChild(this.rightTouchZone);\n      this.rightStick = null;\n      this.rightTouchZone = null;\n    }\n    this.enableLeft = newEnableLeft;\n    this.enableRight = newEnableRight;\n\n    if (this.enableLeft) {\n      this.leftMock.classList.remove(styles.hidden);\n      this.leftMockSmall.classList.remove(styles.hidden);\n      this.leftStick.on(\"start\", this.onFirstInteraction);\n    }\n    if (this.enableRight) {\n      this.rightMock.classList.remove(styles.hidden);\n      this.rightMockSmall.classList.remove(styles.hidden);\n      this.rightStick.on(\"start\", this.onFirstInteraction);\n    }\n    if (!this.enableLeft && !this.enableRight && this.mockJoystickContainer.parentNode) {\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\n    }\n  },\n\n  createRightStick() {\n    this.rightTouchZone = document.createElement(\"div\");\n    this.rightTouchZone.classList.add(styles.touchZone, styles.right);\n    insertAfter(this.rightTouchZone, this.mockJoystickContainer);\n    this.rightStick = nipplejs.create({\n      mode: \"static\",\n      position: { left: \"50%\", top: \"50%\" },\n      zone: this.rightTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n    // nipplejs sets z-index 999 but it makes the joysticks\n    // visible even if the scene is hidden for example by\n    // preference dialog. So remove z-index.\n    this.rightStick[0].ui.el.style.removeProperty(\"z-index\");\n    this.rightStick.on(\"start\", this.onFirstInteraction);\n    this.rightStick.on(\"move\", this.onLookJoystickChanged);\n    this.rightStick.on(\"end\", this.onLookJoystickEnd);\n  },\n\n  createLeftStick() {\n    this.leftTouchZone = document.createElement(\"div\");\n    this.leftTouchZone.classList.add(styles.touchZone, styles.left);\n    insertAfter(this.leftTouchZone, this.mockJoystickContainer);\n    this.leftStick = nipplejs.create({\n      mode: \"static\",\n      position: { left: \"50%\", top: \"50%\" },\n      zone: this.leftTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n    this.leftStick[0].ui.el.style.removeProperty(\"z-index\");\n    this.leftStick.on(\"start\", this.onFirstInteraction);\n    this.leftStick.on(\"move\", this.onMoveJoystickChanged);\n    this.leftStick.on(\"end\", this.onMoveJoystickEnd);\n  },\n\n  onFirstInteraction() {\n    if (this.leftStick) this.leftStick.off(\"start\", this.onFirstInteraction);\n    if (this.rightStick) this.rightStick.off(\"start\", this.onFirstInteraction);\n    this.mockJoystickContainer.parentNode &&\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\n  },\n\n  onMoveJoystickChanged(event, joystick) {\n    if (window.APP.preferenceScreenIsVisible) return;\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    this.displacement.set(Math.cos(angle), 0, -Math.sin(angle)).multiplyScalar(force * 1.85);\n    this.moving = true;\n  },\n\n  onMoveJoystickEnd() {\n    this.moving = false;\n    this.displacement.set(0, 0, 0);\n  },\n\n  onLookJoystickChanged(event, joystick) {\n    if (window.APP.preferenceScreenIsVisible) return;\n    // Set pitch and yaw angles on right stick move\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    this.rotating = true;\n    this.lookDy = -Math.cos(angle) * force * ROTATION_SPEED;\n    this.lookDx = Math.sin(angle) * force * ROTATION_SPEED;\n  },\n\n  onLookJoystickEnd() {\n    this.rotating = false;\n    this.lookDx = 0;\n    this.lookDy = 0;\n    this.el.sceneEl.emit(\"rotateX\", this.lookDx);\n  },\n\n  tick() {\n    if (this.inVr) {\n      return;\n    }\n    if (this.moving) {\n      this.characterController.enqueueRelativeMotion(this.displacement);\n    }\n    if (this.rotating) {\n      this.characterController.enqueueInPlaceRotationAroundWorldUp(this.lookDy);\n      this.el.sceneEl.emit(\"rotateX\", this.lookDx);\n    }\n  },\n\n  onEnterVr() {\n    // Hide the joystick controls\n    this.inVr = true;\n    if (this.leftTouchZone) this.leftTouchZone.style.display = \"none\";\n    if (this.rightTouchZone) this.rightTouchZone.style.display = \"none\";\n  },\n\n  onExitVr() {\n    // Show the joystick controls\n    this.inVr = false;\n    if (this.leftTouchZone) this.leftTouchZone.style.display = \"block\";\n    if (this.rightTouchZone) this.rightTouchZone.style.display = \"block\";\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"entervr\", this.onEnterVr);\n    this.el.sceneEl.removeEventListener(\"exitvr\", this.onExitVr);\n    this.mockJoystickContainer.parentNode &&\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\n    if (this.leftTouchZone) this.leftTouchZone.parentNode.removeChild(this.leftTouchZone);\n    if (this.rightTouchZone) this.rightTouchZone.parentNode.removeChild(this.rightTouchZone);\n  }\n});\n","import { defineQuery } from \"bitecs\";\nimport { CameraTool } from \"../bit-components\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nconst { Vector3, Quaternion, Matrix4, Euler } = THREE;\n\nfunction quaternionAlmostEquals(epsilon, u, v) {\n  // Note: q and -q represent same rotation\n  return (\n    (Math.abs(u.x - v.x) < epsilon &&\n      Math.abs(u.y - v.y) < epsilon &&\n      Math.abs(u.z - v.z) < epsilon &&\n      Math.abs(u.w - v.w) < epsilon) ||\n    (Math.abs(-u.x - v.x) < epsilon &&\n      Math.abs(-u.y - v.y) < epsilon &&\n      Math.abs(-u.z - v.z) < epsilon &&\n      Math.abs(-u.w - v.w) < epsilon)\n  );\n}\n\nconst cameraToolsQuery = defineQuery([CameraTool]);\n\n/**\n * Provides access to the end effectors for IK.\n * @namespace avatar\n * @component ik-root\n */\nAFRAME.registerComponent(\"ik-root\", {\n  schema: {\n    camera: { type: \"string\", default: \".camera\" },\n    leftController: { type: \"string\", default: \".left-controller\" },\n    rightController: { type: \"string\", default: \".right-controller\" }\n  },\n  update(oldData) {\n    if (this.data.camera !== oldData.camera) {\n      this.camera = this.el.querySelector(this.data.camera);\n    }\n\n    if (this.data.leftController !== oldData.leftController) {\n      this.leftController = this.el.querySelector(this.data.leftController);\n    }\n\n    if (this.data.rightController !== oldData.rightController) {\n      this.rightController = this.el.querySelector(this.data.rightController);\n    }\n  }\n});\n\nfunction findIKRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"ik-root\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"ik-root\"];\n}\n\nconst HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, -Math.PI / 2, 0))\n};\n\nconst angleOnXZPlaneBetweenMatrixRotations = (function() {\n  const XZ_PLANE_NORMAL = new THREE.Vector3(0, -1, 0);\n  const v1 = new THREE.Vector3();\n  const v2 = new THREE.Vector3();\n  return function angleOnXZPlaneBetweenMatrixRotations(matrixA, matrixB) {\n    v1.setFromMatrixColumn(matrixA, 2).projectOnPlane(XZ_PLANE_NORMAL);\n    v2.setFromMatrixColumn(matrixB, 2).projectOnPlane(XZ_PLANE_NORMAL);\n    return v1.angleTo(v2);\n  };\n})();\n\n/**\n * Performs IK on a hip-rooted skeleton to align the hip, head and hands with camera and controller inputs.\n * @namespace avatar\n * @component ik-controller\n */\nAFRAME.registerComponent(\"ik-controller\", {\n  schema: {\n    leftEye: { type: \"string\", default: \"LeftEye\" },\n    rightEye: { type: \"string\", default: \"RightEye\" },\n    head: { type: \"string\", default: \"Head\" },\n    neck: { type: \"string\", default: \"Neck\" },\n    leftHand: { type: \"string\", default: \"LeftHand\" },\n    rightHand: { type: \"string\", default: \"RightHand\" },\n    chest: { type: \"string\", default: \"Spine\" },\n    rotationSpeed: { default: 8 },\n    maxLerpAngle: { default: 90 * THREE.MathUtils.DEG2RAD },\n    alwaysUpdate: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    this.flipY = new Matrix4().makeRotationY(Math.PI);\n\n    this.cameraForward = new Matrix4();\n    this.headTransform = new Matrix4();\n    this.hipsPosition = new Vector3();\n\n    this.invHipsToHeadVector = new Vector3();\n\n    this.middleEyeMatrix = new Matrix4();\n    this.middleEyePosition = new Vector3();\n    this.invMiddleEyeToHead = new Matrix4();\n\n    this.cameraYRotation = new Euler();\n    this.cameraYQuaternion = new Quaternion();\n\n    this.invHipsQuaternion = new Quaternion();\n    this.headQuaternion = new Quaternion();\n\n    this.rootToChest = new Matrix4();\n    this.invRootToChest = new Matrix4();\n\n    this.ikRoot = findIKRoot(this.el);\n\n    this.isInView = true;\n    this.hasConvergedHips = false;\n    this.lastCameraTransform = new THREE.Matrix4();\n    waitForDOMContentLoaded().then(() => {\n      this.playerCamera = document.getElementById(\"viewing-camera\").getObject3D(\"camera\");\n    });\n\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"ik\");\n    this.forceIkUpdate = true;\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"ik\");\n  },\n\n  update(oldData) {\n    this.avatar = this.el.object3D;\n\n    if (this.data.leftEye !== oldData.leftEye) {\n      this.leftEye = this.el.object3D.getObjectByName(this.data.leftEye);\n    }\n\n    if (this.data.rightEye !== oldData.rightEye) {\n      this.rightEye = this.el.object3D.getObjectByName(this.data.rightEye);\n    }\n\n    if (this.data.head !== oldData.head) {\n      this.head = this.el.object3D.getObjectByName(this.data.head);\n    }\n\n    if (this.data.neck !== oldData.neck) {\n      this.neck = this.el.object3D.getObjectByName(this.data.neck);\n    }\n\n    if (this.data.leftHand !== oldData.leftHand) {\n      this.leftHand = this.el.object3D.getObjectByName(this.data.leftHand);\n    }\n\n    if (this.data.rightHand !== oldData.rightHand) {\n      this.rightHand = this.el.object3D.getObjectByName(this.data.rightHand);\n    }\n\n    if (this.data.chest !== oldData.chest) {\n      this.chest = this.el.object3D.getObjectByName(this.data.chest);\n    }\n\n    // Set middleEye's position to be right in the middle of the left and right eyes.\n    this.middleEyePosition.addVectors(this.leftEye.position, this.rightEye.position);\n    this.middleEyePosition.divideScalar(2);\n    this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x, this.middleEyePosition.y, this.middleEyePosition.z);\n    this.invMiddleEyeToHead = this.middleEyeMatrix.copy(this.middleEyeMatrix).invert();\n\n    this.invHipsToHeadVector\n      .addVectors(this.chest.position, this.neck.position)\n      .add(this.head.position)\n      .negate();\n  },\n\n  tick(time, dt) {\n    if (!this.ikRoot) {\n      return;\n    }\n\n    const root = this.ikRoot.el.object3D;\n    root.updateMatrices();\n    const { camera, leftController, rightController } = this.ikRoot;\n\n    camera.object3D.updateMatrix();\n\n    const hasNewCameraTransform = !this.lastCameraTransform.equals(camera.object3D.matrix);\n\n    // Optimization: if the camera hasn't moved and the hips converged to the target orientation on a previous frame,\n    // then the avatar does not need any IK this frame.\n    //\n    // Update in-view avatars every frame, and update out-of-view avatars via frame scheduler.\n    if (\n      this.data.alwaysUpdate ||\n      this.forceIkUpdate ||\n      (this.isInView && (hasNewCameraTransform || !this.hasConvergedHips))\n    ) {\n      if (hasNewCameraTransform) {\n        this.lastCameraTransform.copy(camera.object3D.matrix);\n      }\n\n      const {\n        avatar,\n        head,\n        neck,\n        chest,\n        cameraForward,\n        headTransform,\n        invMiddleEyeToHead,\n        invHipsToHeadVector,\n        flipY,\n        cameraYRotation,\n        cameraYQuaternion,\n        invHipsQuaternion,\n        rootToChest,\n        invRootToChest\n      } = this;\n\n      // Camera faces the -Z direction. Flip it along the Y axis so that it is +Z.\n      cameraForward.multiplyMatrices(camera.object3D.matrix, flipY);\n\n      // Compute the head position such that the hmd position would be in line with the middleEye\n      headTransform.multiplyMatrices(cameraForward, invMiddleEyeToHead);\n\n      // Then position the avatar such that the head is aligned with headTransform\n      // (which positions middleEye in line with the hmd)\n      //\n      // Note that we position the avatar itself, *not* the hips, since positioning the\n      // hips will use vertex skinning to do the root displacement, which results in\n      // frustum culling errors since three.js does not take into account skinning when\n      // computing frustum culling sphere bounds.\n      avatar.position.setFromMatrixPosition(headTransform).add(invHipsToHeadVector);\n      avatar.matrixNeedsUpdate = true;\n\n      // Animate the hip rotation to follow the Y rotation of the camera with some damping.\n      cameraYRotation.setFromRotationMatrix(cameraForward, \"YXZ\");\n      cameraYRotation.x = 0;\n      cameraYRotation.z = 0;\n      cameraYQuaternion.setFromEuler(cameraYRotation);\n\n      if (this._hadFirstTick) {\n        camera.object3D.updateMatrices();\n        avatar.updateMatrices();\n        // Note: Camera faces down -Z, avatar faces down +Z\n        const yDelta = Math.PI - angleOnXZPlaneBetweenMatrixRotations(camera.object3D.matrixWorld, avatar.matrixWorld);\n\n        if (yDelta > this.data.maxLerpAngle) {\n          avatar.quaternion.copy(cameraYQuaternion);\n        } else {\n          avatar.quaternion.slerpQuaternions(\n            avatar.quaternion,\n            cameraYQuaternion,\n            (this.data.rotationSpeed * dt) / 1000\n          );\n        }\n      } else {\n        avatar.quaternion.copy(cameraYQuaternion);\n      }\n\n      this.hasConvergedHips = quaternionAlmostEquals(0.0001, cameraYQuaternion, avatar.quaternion);\n\n      // Take the head orientation computed from the hmd, remove the Y rotation already applied to it by the hips,\n      // and apply it to the head\n      invHipsQuaternion.copy(avatar.quaternion).invert();\n      head.quaternion.setFromRotationMatrix(headTransform).premultiply(invHipsQuaternion);\n\n      avatar.updateMatrix();\n      rootToChest.multiplyMatrices(avatar.matrix, chest.matrix);\n      invRootToChest.copy(rootToChest).invert();\n\n      root.matrixNeedsUpdate = true;\n      neck.matrixNeedsUpdate = true;\n      head.matrixNeedsUpdate = true;\n      chest.matrixNeedsUpdate = true;\n    }\n\n    const { leftHand, rightHand } = this;\n\n    if (leftHand) this.updateHand(HAND_ROTATIONS.left, leftHand, leftController.object3D, true, this.isInView);\n    if (rightHand) this.updateHand(HAND_ROTATIONS.right, rightHand, rightController.object3D, false, this.isInView);\n    this.forceIkUpdate = false;\n\n    if (!this._hadFirstTick) {\n      // Ensure the avatar is not shown until we've done our first IK step, to prevent seeing mis-oriented/t-pose pose or our own avatar at the wrong place.\n      this.ikRoot.el.object3D.visible = true;\n      this._hadFirstTick = true;\n      this.el.emit(\"ik-first-tick\");\n    }\n  },\n\n  updateHand(handRotation, handObject3D, controllerObject3D, isLeft, isInView) {\n    const handMatrix = handObject3D.matrix;\n\n    // TODO: This coupling with personal-space-invader is not ideal.\n    // There should be some intermediate thing managing multiple opinions about object visibility\n    const spaceInvader = handObject3D.el.components[\"personal-space-invader\"];\n\n    if (spaceInvader) {\n      // If this hand has an invader, defer to it to manage visibility overall but tell it to hide based upon controller state\n      spaceInvader.setAlwaysHidden(!controllerObject3D.visible);\n    } else {\n      handObject3D.visible = controllerObject3D.visible;\n    }\n\n    // Optimization: skip IK update if not in view and not forced by frame scheduler\n    if (controllerObject3D.visible && (isInView || this.forceIkUpdate || this.data.alwaysUpdate)) {\n      handMatrix.multiplyMatrices(this.invRootToChest, controllerObject3D.matrix);\n\n      handMatrix.multiply(handRotation);\n\n      handObject3D.position.setFromMatrixPosition(handMatrix);\n      handObject3D.rotation.setFromRotationMatrix(handMatrix);\n      handObject3D.matrixNeedsUpdate = true;\n    }\n  },\n\n  _runScheduledWork() {\n    // Every scheduled run, we force an IK update on the next frame (so at most one avatar with forced IK per frame)\n    // and also update the this.isInView bit on the avatar which is used to determine if an IK update should be run\n    // every frame.\n    this.forceIkUpdate = true;\n\n    this._updateIsInView();\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const tmpPos = new THREE.Vector3();\n    const isInViewOfCamera = (screenCamera, pos) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromProjectionMatrix(frustumMatrix);\n      return frustum.containsPoint(pos);\n    };\n\n    return function() {\n      if (!this.playerCamera || this.data.alwaysUpdate) return;\n\n      const camera = this.ikRoot.camera.object3D;\n      camera.getWorldPosition(tmpPos);\n\n      // Check player camera\n      this.isInView = isInViewOfCamera(this.playerCamera, tmpPos);\n\n      if (!this.isInView) {\n        const world = APP.world;\n        // Check camera tools if they are rendering to viewfinder\n        const cameraTools = cameraToolsQuery(world);\n        for (const eid of cameraTools) {\n          const screenObj = world.eid2obj.get(CameraTool.screenRef[eid]);\n          const cameraObj = world.eid2obj.get(CameraTool.cameraRef[eid]);\n          this.isInView = screenObj.visible && isInViewOfCamera(cameraObj, tmpPos);\n          if (this.isInView) break;\n        }\n      }\n    };\n  })()\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst POSES = {\n  open: \"open\",\n  point: \"point\",\n  fist: \"fist\",\n  hold: \"hold\",\n  thumbUp: \"thumbUp\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  pinch: \"pinch\",\n  mrpDown: \"mrpDown\"\n};\n\n/**\n * Emits events indicating that avatar hands should be posed differently.\n * @namespace user-input\n * @component hand-controls2\n */\nAFRAME.registerComponent(\"hand-controls2\", {\n  schema: { default: \"left\" },\n\n  init() {\n    this.pose = POSES.open;\n  },\n\n  poseForFingers(thumb, index, middleRingPinky) {\n    if (!thumb && !index && !middleRingPinky) {\n      return POSES.open;\n    } else if (thumb && index && middleRingPinky) {\n      return POSES.fist;\n    } else if (!thumb && index && middleRingPinky) {\n      return POSES.thumbUp;\n    } else if (!thumb && !index && middleRingPinky) {\n      return POSES.mrpDown;\n    } else if (!thumb && index && !middleRingPinky) {\n      return POSES.indexDown;\n    } else if (thumb && !index && !middleRingPinky) {\n      return POSES.thumbDown;\n    } else if (thumb && index && !middleRingPinky) {\n      return POSES.pinch;\n    } else if (thumb && !index && middleRingPinky) {\n      return POSES.point;\n    }\n\n    console.warn(`Did not find matching pose for thumb ${thumb}, index ${index}, middleRingPinky ${middleRingPinky}`);\n    return POSES.open;\n  },\n\n  tick() {\n    const hand = this.data;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const subpath = hand === \"left\" ? paths.actions.leftHand : paths.actions.rightHand;\n    const thumb = userinput.get(subpath.thumb);\n    const index = userinput.get(subpath.index);\n    const middleRingPinky = userinput.get(subpath.middleRingPinky);\n    const pose = this.poseForFingers(thumb, index, middleRingPinky);\n    if (pose !== this.pose) {\n      this.el.emit(\"hand-pose\", { previous: this.pose, current: pose });\n      this.pose = pose;\n    }\n  }\n});\n","import { showHoverEffect } from \"../utils/permissions-utils\";\n\n/**\n * Applies effects to a hoverer based on hover state.\n * @namespace interactables\n * @component hover-visuals\n */\nAFRAME.registerComponent(\"hover-visuals\", {\n  schema: {\n    hand: { type: \"string\" }\n  },\n  init() {\n    // uniforms are set from the component responsible for loading the mesh.\n    this.handleLeftVisuals = this.handleLeftVisuals.bind(this);\n    this.handleRightVisuals = this.handleRightVisuals.bind(this);\n    this.hadLeftVisualLastFrame = false;\n    this.hadRightVisualLastFrame = false;\n    this.uniforms = null;\n    this.sweepParams = [0, 1.0];\n  },\n  remove() {\n    this.uniforms = null;\n  },\n  tick() {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    // Push down loops to assist JIT:\n    if (this.data.hand === \"left\") {\n      this.handleLeftVisuals();\n    } else {\n      this.handleRightVisuals();\n    }\n  },\n\n  handleLeftVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const interactingElement = interaction.state.leftHand.held || interaction.state.leftHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadLeftVisualLastFrame) return;\n    this.hadLeftVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorOne.value = !hideVisual;\n      uniform.hubs_InteractorOnePos.value[0] = elements[12];\n      uniform.hubs_InteractorOnePos.value[1] = elements[13];\n      uniform.hubs_InteractorOnePos.value[2] = elements[14];\n    }\n  },\n\n  handleRightVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    const interactingElement = interaction.state.rightHand.held || interaction.state.rightHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadRightVisualLastFrame) return;\n    this.hadRightVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_SweepParams.value = this.sweepParams;\n\n      uniform.hubs_HighlightInteractorTwo.value = !hideVisual;\n      uniform.hubs_InteractorTwoPos.value[0] = elements[12];\n      uniform.hubs_InteractorTwoPos.value[1] = elements[13];\n      uniform.hubs_InteractorTwoPos.value[2] = elements[14];\n    }\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\n/**\n * Positions an entity relative to a given target when the given event is fired.\n * @component offset-relative-to\n */\nAFRAME.registerComponent(\"offset-relative-to\", {\n  schema: {\n    target: {\n      type: \"selector\"\n    },\n    offset: {\n      type: \"vec3\"\n    },\n    on: {\n      type: \"string\"\n    },\n    orientation: {\n      default: 1 // see doc/image_orientations.gif\n    },\n    selfDestruct: {\n      default: false\n    },\n    lookAt: {\n      default: false\n    }\n  },\n  init() {\n    this.updateOffset = this.updateOffset.bind(this);\n\n    waitForDOMContentLoaded().then(() => {\n      if (this.data.on) {\n        this.el.sceneEl.addEventListener(this.data.on, this.updateOffset);\n      } else {\n        this.updateOffset();\n      }\n    });\n  },\n\n  updateOffset: (function() {\n    const y = new THREE.Vector3(0, 1, 0);\n    const z = new THREE.Vector3(0, 0, -1);\n    const QUARTER_CIRCLE = Math.PI / 2;\n    const offsetVector = new THREE.Vector3();\n    const targetWorldPos = new THREE.Vector3();\n    return function() {\n      const obj = this.el.object3D;\n      const target = this.data.target.object3D;\n      offsetVector.copy(this.data.offset);\n      target.localToWorld(offsetVector);\n      if (obj.parent) {\n        obj.parent.worldToLocal(offsetVector);\n      }\n      obj.position.copy(offsetVector);\n      if (this.data.lookAt) {\n        target.getWorldPosition(targetWorldPos);\n        obj.updateMatrices(true);\n        obj.lookAt(targetWorldPos);\n      } else {\n        target.getWorldQuaternion(obj.quaternion);\n      }\n\n      // See doc/image_orientations.gif\n      switch (this.data.orientation) {\n        case 8:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          break;\n        case 7:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 6:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          break;\n        case 5:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 4:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 3:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          break;\n        case 2:\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 1:\n        default:\n          break;\n      }\n\n      obj.matrixNeedsUpdate = true;\n\n      if (this.data.selfDestruct) {\n        if (this.data.on) {\n          this.el.sceneEl.removeEventListener(this.data.on, this.updateOffset);\n        }\n        this.el.removeAttribute(\"offset-relative-to\");\n      }\n    };\n  })()\n});\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport { proxiedUrlFor } from \"./media-url-utils\";\nimport avatarUnavailableImage from \"../assets/images/avatar_unavailable.png\";\n\nconst AVATARS_API = \"/api/v1/avatars\";\n\nexport const AVATAR_TYPES = {\n  SKINNABLE: \"skinnable\",\n  URL: \"url\"\n};\n\nexport function getAvatarType(avatarId) {\n  if (avatarId.startsWith(\"http\")) return AVATAR_TYPES.URL;\n  return AVATAR_TYPES.SKINNABLE;\n}\n\nasync function fetchSkinnableAvatar(avatarId) {\n  const resp = await fetchReticulumAuthenticated(`/api/v1/avatars/${avatarId}`);\n  return resp && resp.avatars && resp.avatars[0];\n}\n\nexport async function fetchAvatar(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchSkinnableAvatar(avatarId);\n    case AVATAR_TYPES.URL:\n      return {\n        avatar_id: avatarId,\n        gltf_url: proxiedUrlFor(avatarId)\n      };\n  }\n}\n\nasync function fetchAvatarGltfUrl(avatarId) {\n  return fetchAvatar(avatarId).then(avatar => avatar && avatar.gltf_url);\n}\n\nexport function getAvatarSrc(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatarGltfUrl(avatarId);\n    case AVATAR_TYPES.URL:\n      return proxiedUrlFor(avatarId);\n    default:\n      return avatarId;\n  }\n}\n\nexport async function getAvatarThumbnailUrl(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatar(avatarId).then(avatar => avatar.files.thumbnail);\n    default:\n      return avatarUnavailableImage;\n  }\n}\n\n// Currently the way we do material overrides is with a special named material.\n// We want to migrate eventually to having a GLTF extension that specifies what\n// materials can be overridden, but in the meantime we want to be able to support\n// arbitrary models with some sort of functionality. This provides a fallback\nexport const MAT_NAME = \"Bot_PBS\";\nexport function ensureAvatarMaterial(gltf) {\n  if (gltf.materials.find(m => m.name === MAT_NAME)) return gltf;\n\n  function materialForMesh(mesh) {\n    if (!mesh.primitives) return;\n    const primitive = mesh.primitives.find(p => p.material !== undefined);\n    return primitive && gltf.materials[primitive.material];\n  }\n\n  let nodes = gltf.scenes[gltf.scene].nodes.slice(0);\n  while (nodes.length) {\n    const node = gltf.nodes[nodes.shift()];\n    const material = node.mesh !== undefined && materialForMesh(gltf.meshes[node.mesh]);\n    if (material) {\n      material.name = MAT_NAME;\n      break;\n    }\n    if (node.children) nodes = nodes.concat(node.children);\n  }\n\n  return gltf;\n}\n\nexport async function remixAvatar(parentId, name) {\n  const avatar = {\n    parent_avatar_listing_id: parentId,\n    name: name,\n    files: {}\n  };\n\n  return fetchReticulumAuthenticated(AVATARS_API, \"POST\", { avatar });\n}\n","import { injectCustomShaderChunks } from \"../utils/media-utils\";\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\nimport { registerComponentInstance, deregisterComponentInstance } from \"../utils/component-utils\";\nimport defaultAvatar from \"../assets/models/DefaultAvatar.glb\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\nimport { createModelForSkinnedMesh } from \"../utils/three-utils\";\nimport { Layers } from \"./layers\";\n\nfunction ensureAvatarNodes(json) {\n  const { nodes } = json;\n  if (!nodes.some(node => node.name === \"Head\")) {\n    // If the avatar model doesn't have a Head node. The user has probably chosen a custom GLB.\n    // So, we need to construct a suitable hierarchy for avatar functionality to work.\n    // We re-parent the original root node to the Head node and set the scene root to a new AvatarRoot.\n\n    // Note: We assume that the first node in the primary scene is the one we care about.\n    const originalRoot = json.scenes[json.scene].nodes[0];\n    nodes.push({ name: \"LeftEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({ name: \"RightEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({\n      name: \"Head\",\n      children: [originalRoot, nodes.length - 1, nodes.length - 2],\n      extensions: { MOZ_hubs_components: { \"scale-audio-feedback\": \"\" } }\n    });\n    nodes.push({ name: \"Neck\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Spine\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Hips\", children: [nodes.length - 1] });\n    nodes.push({ name: \"AvatarRoot\", children: [nodes.length - 1] });\n    json.scenes[json.scene].nodes[0] = nodes.length - 1;\n  }\n  return json;\n}\n\nAFRAME.registerComponent(\"player-info\", {\n  schema: {\n    avatarSrc: { type: \"string\" },\n    avatarType: { type: \"string\", default: AVATAR_TYPES.SKINNABLE },\n    muted: { default: false },\n    isSharingAvatarCamera: { default: false }\n  },\n  init() {\n    this.applyProperties = this.applyProperties.bind(this);\n    this.handleModelError = this.handleModelError.bind(this);\n    this.handleRemoteModelError = this.handleRemoteModelError.bind(this);\n    this.update = this.update.bind(this);\n    this.onPresenceUpdated = this.onPresenceUpdated.bind(this);\n    this.onMicStateChanged = this.onMicStateChanged.bind(this);\n    this.onAvatarModelLoaded = this.onAvatarModelLoaded.bind(this);\n\n    this.isLocalPlayerInfo = this.el.id === \"avatar-rig\";\n    this.playerSessionId = null;\n\n    if (!this.isLocalPlayerInfo) {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n        this.playerSessionId = NAF.utils.getCreator(networkedEntity);\n        const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\n        if (playerPresence) {\n          this.updateFromPresenceMeta(playerPresence.metas[0]);\n        }\n      });\n    }\n\n    registerComponentInstance(this, \"player-info\");\n  },\n\n  remove() {\n    const avatarEl = this.el.querySelector(\"[avatar-audio-source]\");\n    APP.isAudioPaused.delete(avatarEl);\n    deregisterComponentInstance(this, \"player-info\");\n  },\n\n  onAvatarModelLoaded(e) {\n    this.applyProperties(e);\n\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.isLocalPlayerInfo && e.target === modelEl) {\n      let isSkinnedAvatar = false;\n      modelEl.object3D.traverse(function(o) {\n        if (o.isSkinnedMesh) {\n          const mesh = createModelForSkinnedMesh(o);\n          if (mesh) {\n            isSkinnedAvatar = true;\n            o.parent.add(mesh);\n          }\n        }\n      });\n      // This is to support using arbitrary models as avatars.\n      // TODO We can drop support for this when we go full VRM, or at least handle it earlier in the process.\n      if (!isSkinnedAvatar) {\n        modelEl.object3D.traverse(function(o) {\n          if (o.isMesh) o.layers.set(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n        });\n      }\n    }\n  },\n\n  play() {\n    this.el.addEventListener(\"model-loaded\", this.onAvatarModelLoaded);\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.onPresenceUpdated);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").addEventListener(\"model-error\", this.handleModelError);\n    } else {\n      this.el.querySelector(\".model\").addEventListener(\"model-error\", this.handleRemoteModelError);\n    }\n    window.APP.store.addEventListener(\"statechanged\", this.update);\n\n    this.el.sceneEl.addEventListener(\"stateadded\", this.update);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.update);\n\n    if (this.isLocalPlayerInfo) {\n      APP.dialog.on(\"mic-state-changed\", this.onMicStateChanged);\n    }\n  },\n\n  //three.js 라이브러리 사용 3D모델링 구현\n\n  pause() {\n    this.el.removeEventListener(\"model-loaded\", this.onAvatarModelLoaded);\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.onPresenceUpdated);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").removeEventListener(\"model-error\", this.handleModelError);\n    } else {\n      this.el.querySelector(\".model\").removeEventListener(\"model-error\", this.handleRemoteModelError);\n    }\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.update);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.update);\n    window.APP.store.removeEventListener(\"statechanged\", this.update);\n\n    if (this.isLocalPlayerInfo) {\n      APP.dialog.off(\"mic-state-changed\", this.onMicStateChanged);\n    }\n  },\n\n  onPresenceUpdated(e) {\n    this.updateFromPresenceMeta(e.detail);\n  },\n\n  updateFromPresenceMeta(presenceMeta) {\n    if (!this.playerSessionId && this.isLocalPlayerInfo) {\n      this.playerSessionId = NAF.clientId;\n    }\n    if (!this.playerSessionId) return;\n    if (this.playerSessionId !== presenceMeta.sessionId) return;\n\n    this.permissions = presenceMeta.permissions;\n  },\n\n  update(oldData) {\n    if (this.data.muted !== oldData.muted) {\n      this.el.emit(\"remote_mute_updated\", { muted: this.data.muted });\n    }\n    this.applyProperties();\n  },\n\n  can(perm) {\n    return !!this.permissions && this.permissions[perm];\n  },\n\n  applyProperties(e) {\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.data.avatarSrc && modelEl) {\n      modelEl.components[\"gltf-model-plus\"].jsonPreprocessor = ensureAvatarNodes;\n      modelEl.setAttribute(\"gltf-model-plus\", \"src\", this.data.avatarSrc);\n    }\n\n    if (!e || e.target === modelEl) {\n      const uniforms = injectCustomShaderChunks(this.el.object3D);\n      this.el.querySelectorAll(\"[hover-visuals]\").forEach(el => {\n        el.components[\"hover-visuals\"].uniforms = uniforms;\n      });\n    }\n\n    const videoTextureTargets = modelEl.querySelectorAll(\"[video-texture-target]\");\n\n    const sessionId = this.isLocalPlayerInfo ? NAF.clientId : this.playerSessionId;\n\n    for (const el of Array.from(videoTextureTargets)) {\n      el.setAttribute(\"video-texture-target\", {\n        src: this.data.isSharingAvatarCamera ? `hubs://clients/${sessionId}/video` : \"\"\n      });\n\n      if (this.isLocalPlayerInfo) {\n        el.setAttribute(\"emit-scene-event-on-remove\", `event:${MediaDevicesEvents.VIDEO_SHARE_ENDED}`);\n      }\n    }\n\n    const avatarEl = this.el.querySelector(\"[avatar-audio-source]\");\n    if (this.data.muted) {\n      APP.isAudioPaused.add(avatarEl);\n    } else {\n      APP.isAudioPaused.delete(avatarEl);\n    }\n  },\n\n  handleModelError() {\n    window.APP.store.resetToRandomDefaultAvatar();\n  },\n\n  handleRemoteModelError() {\n    this.data.avatarSrc = defaultAvatar;\n    this.applyProperties();\n  },\n\n  onMicStateChanged({ enabled }) {\n    this.el.setAttribute(\"player-info\", { muted: !enabled });\n  }\n});\n","import anime from \"animejs\";\nimport MovingAverage from \"moving-average\";\nimport { getThemeColor } from \"../utils/theme\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport nextTick from \"../utils/next-tick\";\nimport { createPlaneBufferGeometry, setMatrixWorld } from \"../utils/three-utils\";\nimport { textureLoader } from \"../utils/media-utils\";\n\nimport handRaisedIconSrc from \"../assets/hud/hand-raised.png\";\n\nconst DEBUG = qsTruthy(\"debug\");\nconst NAMETAG_BACKGROUND_PADDING = 0.05;\nconst NAMETAG_STATUS_BORDER_PADDING = 0.035;\nconst NAMETAG_MIN_WIDTH = 0.6;\nconst NAMETAG_HEIGHT = 0.25;\nconst NAMETAG_OFFSET = 0.2;\nconst TYPING_ANIM_SPEED = 150;\nconst DISPLAY_NAME_LENGTH = 18;\n\nconst ANIM_CONFIG = {\n  duration: 400,\n  easing: \"easeOutQuart\",\n  elasticity: 400,\n  loop: 0,\n  round: false\n};\n\nconst nametagVolumeGeometry = new THREE.PlaneBufferGeometry(1, 0.025);\nconst nametagVolumeMaterial = new THREE.MeshBasicMaterial({ color: \"#7ED320\" });\n\nconst nametagTypingGeometry = new THREE.CircleBufferGeometry(0.01, 6);\n\nconst handRaisedTexture = textureLoader.load(handRaisedIconSrc);\nconst handRaisedGeometry = createPlaneBufferGeometry(0.2, 0.2, 1, 1, handRaisedTexture.flipY);\nconst handRaisedMaterial = new THREE.MeshBasicMaterial({ transparent: true, map: handRaisedTexture });\n\nAFRAME.registerComponent(\"name-tag\", {\n  schema: {},\n  init() {\n    this.store = window.APP.store;\n    this.displayName = null;\n    this.identityName = null;\n    this.isTalking = false;\n    this.isTyping = false;\n    this.isOwner = false;\n    this.isRecording = false;\n    this.isHandRaised = false;\n    this.volumeAvg = new MovingAverage(128);\n    this.shouldBeVisible = true;\n    this.size = new THREE.Vector3();\n    this.avatarAABB = new THREE.Box3();\n    this.avatarAABBSize = new THREE.Vector3();\n    this.avatarAABBCenter = new THREE.Vector3();\n    this.nametagHeight = 0;\n    this.isAvatarReady = false;\n    this.lastUpdateTime = Date.now();\n\n    this.onPresenceUpdated = this.onPresenceUpdated.bind(this);\n    this.onModelLoading = this.onModelLoading.bind(this);\n    this.onModelLoaded = this.onModelLoaded.bind(this);\n    this.onModelIkFirstTick = this.onModelIkFirstTick.bind(this);\n    this.onStateChanged = this.onStateChanged.bind(this);\n\n    this.nametag = this.el.object3D;\n    this.nametagIdentityName = this.el.querySelector(\".identityName\").object3D;\n    this.nametagBackground = this.el.querySelector(\".nametag-background\").object3D;\n    this.nametagStatusBorder = this.el.querySelector(\".nametag-status-border\").object3D;\n    this.recordingBadge = this.el.querySelector(\".recordingBadge\").object3D;\n    this.modBadge = this.el.querySelector(\".modBadge\").object3D;\n    this.nametagText = this.el.querySelector(\".nametag-text\").object3D;\n\n    this.handRaised = new THREE.Mesh(handRaisedGeometry, handRaisedMaterial);\n    this.handRaised.position.set(0, -0.3, 0.001);\n    this.el.object3D.add(this.handRaised);\n\n    this.nametagVolume = new THREE.Mesh(nametagVolumeGeometry, nametagVolumeMaterial);\n    this.nametagVolume.position.set(0, -0.075, 0.001);\n    this.nametagVolume.visible = false;\n    this.el.object3D.add(this.nametagVolume);\n\n    // TODO this is horribly inneficient draw call and geometry wise. Replace with custom shader code or at least a uv-croll image\n    this.nametagTyping = new THREE.Group();\n    this.nametagTyping.position.set(0, -0.075, 0.001);\n    for (let i = 0; i < 5; i++) {\n      const dot = new THREE.Mesh(\n        nametagTypingGeometry,\n        new THREE.MeshBasicMaterial({ transparent: true, color: 0xffffff, depthWrite: false })\n      );\n      dot.position.x = i * 0.035 - 0.07;\n      this.nametagTyping.add(dot);\n    }\n    this.el.object3D.add(this.nametagTyping);\n\n    this.updateTheme();\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n      this.playerSessionId = NAF.utils.getCreator(networkedEntity);\n      const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\n      if (playerPresence) {\n        this.updateFromPresenceMeta(playerPresence.metas[0]);\n      }\n    });\n\n    if (DEBUG) {\n      this.avatarAABBHelper = new THREE.Box3Helper(this.avatarAABB, 0xffff00);\n      this.el.sceneEl.object3D.add(this.avatarAABBHelper);\n    }\n\n    this.onStateChanged();\n  },\n\n  remove() {\n    if (DEBUG) this.el.sceneEl.object3D.remove(this.avatarAABBHelper);\n  },\n\n  tick: (() => {\n    let typingAnimTime = 0;\n    const worldPos = new THREE.Vector3();\n    const mat = new THREE.Matrix4();\n    return function (t) {\n      if (!this.isAvatarReady) {\n        this.nametag.visible = false;\n        return;\n      }\n      this.wasTalking = this.isTalking;\n      this.isTalking = this.audioAnalyzer.avatarIsTalking;\n\n      if (this.shouldBeVisible) {\n        this.nametag.visible = true;\n        if (this.isTalking !== this.wasTalking) {\n          this.resizeNameTag();\n        }\n        if (this.isTalking) {\n          this.nametagVolume.visible = this.isTalking;\n          this.nametagVolume.scale.setX(this.audioAnalyzer.volume * this.size.x);\n          this.nametagVolume.matrixNeedsUpdate = true;\n          this.nametagTyping.visible = false;\n        } else {\n          if (this.isTyping) {\n            this.nametagTyping.visible = true;\n            typingAnimTime = t;\n            this.nametagTyping.traverse(o => {\n              if (o.material) {\n                o.material.opacity = (Math.sin(typingAnimTime / TYPING_ANIM_SPEED) + 1) / 2;\n                typingAnimTime -= TYPING_ANIM_SPEED;\n              }\n            });\n          } else {\n            this.nametagTyping.visible = false;\n          }\n        }\n        this.nametagStatusBorder.visible = this.isTyping || this.isTalking || this.isHandRaised;\n        this.recordingBadge.visible = this.isRecording;\n        this.modBadge.visible = this.isOwner && !this.isRecording;\n        this.handRaised.visible = this.isHandRaised;\n\n        this.neck.getWorldPosition(worldPos);\n        worldPos.setY(this.nametagElPosY + this.ikRoot.position.y);\n        mat.setPosition(worldPos);\n        setMatrixWorld(this.nametag, mat);\n      } else {\n        this.nametag.visible = false;\n      }\n\n      if (DEBUG) {\n        this.updateAvatarModelAABB();\n        this.avatarAABBHelper.matrixNeedsUpdate = true;\n        this.avatarAABBHelper.updateMatrixWorld(true);\n      }\n    };\n  })(),\n\n  play() {\n    this.el.parentEl.addEventListener(\"model-loading\", this.onModelLoading);\n    this.el.parentEl.addEventListener(\"model-loaded\", this.onModelLoaded);\n    this.el.parentEl.addEventListener(\"ik-first-tick\", this.onModelIkFirstTick);\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.onPresenceUpdated);\n    window.APP.store.addEventListener(\"statechanged\", this.onStateChanged);\n    this.el.sceneEl.systems[\"hubs-systems\"].nameTagSystem.register(this);\n  },\n\n  pause() {\n    this.el.parentEl.removeEventListener(\"model-loading\", this.onModelLoading);\n    this.el.parentEl.removeEventListener(\"model-loaded\", this.onModelLoaded);\n    this.el.parentEl.removeEventListener(\"ik-first-tick\", this.onModelIkFirstTick);\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.onPresenceUpdated);\n    window.APP.store.removeEventListener(\"statechanged\", this.onStateChanged);\n    this.el.sceneEl.systems[\"hubs-systems\"].nameTagSystem.unregister(this);\n  },\n\n  onPresenceUpdated({ detail: presenceMeta }) {\n    if (presenceMeta.sessionId === this.playerSessionId) {\n      this.updateFromPresenceMeta(presenceMeta);\n    }\n  },\n\n  updateFromPresenceMeta(presenceMeta) {\n    this.displayName = presenceMeta.profile.displayName;\n    this.identityName = presenceMeta.profile.identityName;\n    this.isRecording = !!(presenceMeta.streaming || presenceMeta.recording);\n    this.isOwner = !!(presenceMeta.roles && presenceMeta.roles.owner);\n    this.isTyping = !!presenceMeta.typing;\n    this.isHandRaised = !!presenceMeta.hand_raised;\n    if (this.isAvatarReady) {\n      this.updateDisplayName();\n      this.updateHandRaised();\n      this.resizeNameTag();\n    }\n  },\n\n  updateDisplayName() {\n    if (this.displayName && this.displayName !== this.prevDisplayName) {\n      this.nametagText.el.addEventListener(\n        \"text-updated\",\n        () => {\n          if (this.nametagText.el) {\n            this.nametagText.el.components[\"text\"].getSize(this.size);\n            this.size.x = Math.max(this.size.x, NAMETAG_MIN_WIDTH);\n            this.resizeNameTag();\n          }\n        },\n        { once: true }\n      );\n      if (this.displayName.length > DISPLAY_NAME_LENGTH) {\n        this.displayName = this.displayName.slice(0, DISPLAY_NAME_LENGTH).concat(\"...\");\n      }\n      this.nametagText.el.setAttribute(\"text\", {\n        value: this.displayName\n      });\n      this.prevDisplayName = this.displayName;\n    }\n\n    if (this.identityName) {\n      if (this.identityName.length > DISPLAY_NAME_LENGTH) {\n        this.identityName = this.identityName.slice(0, DISPLAY_NAME_LENGTH).concat(\"...\");\n      }\n      this.nametagIdentityName.el.setAttribute(\"text\", { value: this.identityName });\n    }\n  },\n\n  onModelLoading() {\n    this.model = null;\n    this.isAvatarReady = false;\n  },\n\n  onModelLoaded({ detail: { model } }) {\n    this.model = model;\n  },\n\n  async onModelIkFirstTick() {\n    await nextTick();\n    this.ikRoot = findAncestorWithComponent(this.el, \"ik-root\").object3D;\n    this.neck = this.ikRoot.el.querySelector(\".Neck\").object3D;\n    this.audioAnalyzer = this.ikRoot.el.querySelector(\".AvatarRoot\").components[\"networked-audio-analyser\"];\n\n    this.updateAvatarModelAABB();\n    const tmpVector = new THREE.Vector3();\n    this.nametagHeight =\n      Math.abs(tmpVector.subVectors(this.ikRoot.position, this.avatarAABBCenter).y) +\n      this.avatarAABBSize.y / 2 +\n      NAMETAG_OFFSET;\n    this.nametagElPosY = this.nametagHeight + (this.isHandRaised ? NAMETAG_OFFSET : 0);\n    this.nametagText.el.components[\"text\"].getSize(this.size);\n    this.size.x = Math.max(this.size.x, NAMETAG_MIN_WIDTH);\n    this.isAvatarReady = true;\n\n    this.updateDisplayName();\n    this.updateHandRaised();\n    this.resizeNameTag();\n  },\n\n  updateTheme() {\n    this.nametagStatusBorder.el.setAttribute(\n      \"slice9\",\n      \"color\",\n      getThemeColor(this.isHandRaised ? \"nametag-border-color-raised-hand\" : \"nametag-border-color\")\n    );\n    nametagVolumeMaterial.color.set(getThemeColor(\"nametag-volume-color\"));\n    this.nametagBackground.el.setAttribute(\"slice9\", \"color\", getThemeColor(\"nametag-color\"));\n    this.nametagText.el.setAttribute(\"text\", \"color\", getThemeColor(\"nametag-text-color\"));\n  },\n\n  onStateChanged() {\n    this.updateTheme();\n  },\n\n  resizeNameTag() {\n    this.nametagBackground.el.setAttribute(\"slice9\", {\n      width: this.size.x + NAMETAG_BACKGROUND_PADDING * 2,\n      height: NAMETAG_HEIGHT\n    });\n    this.nametagStatusBorder.el.setAttribute(\"slice9\", {\n      width: this.size.x + NAMETAG_BACKGROUND_PADDING * 2 + NAMETAG_STATUS_BORDER_PADDING,\n      height: NAMETAG_HEIGHT + NAMETAG_STATUS_BORDER_PADDING\n    });\n  },\n\n  updateHandRaised() {\n    this.nametagStatusBorder.el.setAttribute(\n      \"slice9\",\n      \"color\",\n      getThemeColor(this.isHandRaised ? \"nametag-border-color-raised-hand\" : \"nametag-border-color\")\n    );\n    const targetScale = this.isHandRaised ? 1 : 0;\n    anime({\n      ...ANIM_CONFIG,\n      targets: {\n        x: this.handRaised.scale.x,\n        y: this.handRaised.scale.y,\n        z: this.handRaised.scale.z\n      },\n      x: targetScale,\n      y: targetScale,\n      z: targetScale,\n      update: anim => {\n        this.handRaised.scale.set(\n          anim.animatables[0].target.x,\n          anim.animatables[0].target.y,\n          anim.animatables[0].target.z\n        );\n        this.handRaised.matrixNeedsUpdate = true;\n      }\n    });\n    anime({\n      ...ANIM_CONFIG,\n      targets: {\n        y: this.nametagElPosY\n      },\n      y: this.nametagHeight + (this.isHandRaised ? NAMETAG_OFFSET : 0),\n      update: anim => {\n        this.nametagElPosY = anim.animatables[0].target.y;\n      }\n    });\n  },\n\n  updateAvatarModelAABB() {\n    if (!this.model) return;\n    this.avatarAABB.setFromObject(this.model);\n    this.avatarAABB.getSize(this.avatarAABBSize);\n    this.avatarAABB.getCenter(this.avatarAABBCenter);\n  }\n});\n","import { LoopOnce } from \"three/src/constants\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nconst POSES = {\n  open: \"allOpen\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  mrpDown: \"mrpDown\",\n  thumbUp: \"thumbsUp\",\n  point: \"point\",\n  fist: \"allGrip\",\n  pinch: \"pinch\"\n};\n\nconst NETWORK_POSES = [\"allOpen\", \"thumbDown\", \"indexDown\", \"mrpDown\", \"thumbsUp\", \"point\", \"allGrip\", \"pinch\"];\n\n/**\n * Animates between poses based on networked pose state using an animation mixer.\n * @namespace avatar\n * @component hand-pose\n */\nAFRAME.registerComponent(\"hand-pose\", {\n  multiple: true,\n\n  init() {\n    this.pose = 0;\n    this.animatePose = this.animatePose.bind(this);\n    const mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.mixer = mixerEl && mixerEl.components[\"animation-mixer\"].mixer;\n    if (!this.mixer || !this.mixer.clipAction(POSES.open + suffix)) {\n      console.warn(\"Avatar does not an 'allOpen' animation, disabling hand animations\");\n      this.el.removeAttribute(\"hand-pose\");\n      return;\n    }\n    this.from = this.to = this.mixer.clipAction(POSES.open + suffix);\n    this.from.play();\n    this.networkField = `${this.id}_hand_pose`;\n\n    const getNetworkedAvatar = el => {\n      if (!el) {\n        window.setTimeout(() => {\n          getNetworkedAvatar(this.el);\n        }, 1000);\n        return;\n      }\n      const networkedAvatar = el.components && el.components[\"networked-avatar\"];\n      if (networkedAvatar) {\n        return networkedAvatar;\n      }\n      return getNetworkedAvatar(el.parentEl);\n    };\n    this.networkedAvatar = getNetworkedAvatar(this.el);\n  },\n\n  tick() {\n    if (\n      !this.networkedAvatar ||\n      !this.networkedAvatar.data ||\n      this.networkedAvatar.data[this.networkField] === this.pose\n    ) {\n      return;\n    }\n\n    this.animatePose(NETWORK_POSES[this.pose], NETWORK_POSES[this.networkedAvatar.data[this.networkField]]);\n    this.pose = this.networkedAvatar.data[this.networkField];\n  },\n\n  animatePose(prev, curr) {\n    if (this.from) {\n      this.from.stop();\n    }\n    if (this.to) {\n      this.to.stop();\n    }\n\n    const duration = 0.065;\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.from = this.mixer.clipAction(prev + suffix);\n    this.to = this.mixer.clipAction(curr + suffix);\n    if (this.from) {\n      this.from.setLoop(LoopOnce, -1);\n      this.from.clampWhenFinished = true;\n      this.from.fadeOut(duration);\n      this.from.play();\n    }\n    if (this.to) {\n      this.to.setLoop(LoopOnce, -1);\n      this.to.clampWhenFinished = true;\n      this.to.fadeIn(duration);\n      this.to.play();\n    }\n\n    this.mixer.update(0.001);\n  }\n});\n\n/**\n * Sets the networked hand pose state based on hand-pose events.\n * @namespace avatar\n * @component hand-pose-controller\n */\nAFRAME.registerComponent(\"hand-pose-controller\", {\n  multiple: true,\n  schema: {\n    eventSrc: { type: \"selector\" },\n    networkedAvatar: { type: \"selector\" }\n  },\n  init: function() {\n    this.setHandPose = this.setHandPose.bind(this);\n  },\n\n  play: function() {\n    this.data.eventSrc.addEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  pause: function() {\n    this.data.eventSrc.removeEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  setHandPose: function(evt) {\n    this.data.networkedAvatar.setAttribute(\n      \"networked-avatar\",\n      `${this.id}_hand_pose`,\n      NETWORK_POSES.indexOf(POSES[evt.detail.current])\n    );\n  }\n});\n","import { CAMERA_MODE_FIRST_PERSON } from \"../systems/camera-system\";\nconst TWOPI = Math.PI * 2;\nfunction deltaAngle(a, b) {\n  const p = Math.abs(b - a) % TWOPI;\n  return p > Math.PI ? TWOPI - p : p;\n}\n\n/**\n * Positions the HUD and toggles app mode based on where the user is looking\n * @namespace ui\n * @component hud-controller\n */\nAFRAME.registerComponent(\"hud-controller\", {\n  schema: {\n    head: { type: \"selector\" },\n    offset: { default: 0.7 }, // distance from hud above head,\n    lookCutoff: { default: 20 }, // angle at which the hud should be \"on\",\n    animRange: { default: 30 }, // degrees over which to animate the hud into view\n    yawCutoff: { default: 50 } // yaw degrees at wich the hud should reoirent even if the user is looking up\n  },\n  init() {\n    this.onChildHovered = this.onChildHovered.bind(this);\n    this.removeHoverEvents = this.removeHoverEvents.bind(this);\n    this.isYLocked = false;\n    this.lockedHeadPositionY = 0;\n    this.lookDir = new THREE.Vector3();\n    this.lookEuler = new THREE.Euler();\n    this.store = window.APP.store;\n    this.hoverableChildren = this.el.querySelectorAll(\"[is-remote-hover-target]\");\n  },\n\n  tick() {\n    const hud = this.el.object3D;\n    const head = this.data.head.object3DMap.camera;\n\n    const { offset, lookCutoff, animRange, yawCutoff } = this.data;\n\n    const pitch = head.rotation.x * THREE.MathUtils.RAD2DEG;\n    const yawDif = deltaAngle(head.rotation.y, hud.rotation.y) * THREE.MathUtils.RAD2DEG;\n\n    // HUD is always visible until first hover, to increase discoverability.\n    const forceHudVisible = !this.store.state.activity.hasHoveredInWorldHud;\n\n    // animate the hud into place over animRange degrees as the user aproaches the lookCutoff angle\n    let t = 1 - THREE.MathUtils.clamp(lookCutoff - pitch, 0, animRange) / animRange;\n\n    // HUD is locked down while showing tooltip or if forced.\n    if (forceHudVisible) {\n      t = 1;\n    }\n\n    // Once the HUD is in place it should stay in place until you look sufficiently far down\n    if (t === 1) {\n      this.lockedHeadPositionY = head.position.y;\n      this.hudLocked = true;\n    } else if (this.hudLocked && pitch < lookCutoff - animRange / 2) {\n      this.hudLocked = false;\n    }\n\n    if (this.hudLocked) {\n      t = 1;\n    }\n\n    // Reorient the hud only if the user is looking away from the hud, for right now this arbitrarily means the hud is 1/2 way animated away\n    // TODO: come up with better huristics for this that maybe account for the user turning away from the hud \"too far\", also animate the position so that it doesnt just snap.\n    const hudOutOfView = yawDif >= yawCutoff || pitch < lookCutoff - animRange / 2;\n\n    if (hudOutOfView) {\n      this.lookDir.set(0, 0, -1);\n      this.lookDir.applyQuaternion(head.quaternion);\n      this.lookDir.add(head.position);\n      hud.position.x = this.lookDir.x;\n      hud.position.z = this.lookDir.z;\n      hud.rotation.copy(head.rotation);\n      hud.rotation.x = 0;\n      hud.rotation.z = 0;\n    }\n\n    hud.visible =\n      (!hudOutOfView || forceHudVisible) &&\n      this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_FIRST_PERSON;\n    hud.position.y = (this.isYLocked ? this.lockedHeadPositionY : head.position.y) + offset + (1 - t) * offset;\n    hud.rotation.x = (1 - t) * THREE.MathUtils.DEG2RAD * 90;\n    hud.matrixNeedsUpdate = true;\n  },\n\n  play() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.addEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  pause() {\n    this.removeHoverEvents();\n  },\n\n  removeHoverEvents() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.removeEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  onChildHovered() {\n    if (!this.store.state.activity.hasHoveredInWorldHud) {\n      this.store.update({ activity: { hasHoveredInWorldHud: true } });\n      this.removeHoverEvents();\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_FREEZE, SOUND_THAW } from \"../systems/sound-effects-system\";\nimport { CAMERA_MODE_INSPECT } from \"../systems/camera-system\";\n\n/**\n * Toggles freezing of network traffic on the given event.\n * @namespace network\n * @component freeze-controller\n */\nAFRAME.registerComponent(\"freeze-controller\", {\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n  },\n\n  tick: function() {\n    const scene = this.el.sceneEl;\n    if (!scene.is(\"entered\")) return;\n    const inspecting = scene.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT;\n    if (inspecting) {\n      if (this.el.is(\"frozen\")) {\n        this.onToggle();\n      }\n      if (!NAF.connection.adapter.frozen) {\n        NAF.connection.adapter.toggleFreeze();\n      }\n      this.wasInspecting = true;\n    } else if (this.wasInspecting) {\n      if (NAF.connection.adapter.frozen) {\n        NAF.connection.adapter.toggleFreeze();\n      }\n      this.wasInspecting = false;\n    } else {\n      const userinput = scene.systems.userinput;\n      const ensureFrozen = userinput.get(paths.actions.ensureFrozen);\n      const thaw = userinput.get(paths.actions.thaw);\n      const toggleFreeze = userinput.get(paths.actions.toggleFreeze);\n\n      const toggleFreezeDueToInput =\n        (this.el.is(\"frozen\") && thaw) || (!this.el.is(\"frozen\") && ensureFrozen) || toggleFreeze;\n\n      if (toggleFreezeDueToInput) {\n        this.onToggle();\n      }\n    }\n  },\n\n  onToggle: function() {\n    window.APP.store.update({ activity: { hasFoundFreeze: true } });\n    if (!NAF.connection.adapter) return;\n    NAF.connection.adapter.toggleFreeze();\n    if (NAF.connection.adapter.frozen) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_FREEZE);\n      this.el.addState(\"frozen\");\n    } else {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_THAW);\n      this.el.removeState(\"frozen\");\n    }\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\n/**\n * Toggles the visibility of this entity when the scene is frozen.\n * @namespace ui\n * @component visibility-while-frozen\n */\nAFRAME.registerComponent(\"visibility-while-frozen\", {\n  schema: {\n    withinDistance: { type: \"number\" },\n    visible: { type: \"boolean\", default: true },\n    requireHoverOnNonMobile: { type: \"boolean\", default: true },\n    withPermission: { type: \"string\" },\n    withoutPermission: { type: \"string\" },\n    visibleIfOwned: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.camWorldPos = new THREE.Vector3();\n    this.objWorldPos = new THREE.Vector3();\n\n    waitForDOMContentLoaded().then(() => {\n      this.cameraEl = document.getElementById(\"viewing-camera\");\n      this.updateVisibility();\n    });\n\n    let hoverableSearch = this.el;\n\n    while (hoverableSearch !== document) {\n      if (hoverableSearch.getAttribute(\"is-remote-hover-target\") !== null) {\n        this.hoverable = hoverableSearch;\n        break;\n      }\n\n      hoverableSearch = hoverableSearch.parentNode;\n    }\n    if (!this.hoverable && this.data.requireHoverOnNonMobile) {\n      console.error(\"Didn't find a remote hover target.\");\n    }\n\n    if (!this.data.visibleIfOwned) {\n      NAF.utils\n        .getNetworkedEntity(this.el)\n        .then(networkedEl => {\n          this.networkedEl = networkedEl;\n        })\n        .then(() => {}); //ignore exception, entity might not be networked\n    }\n\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.updateVisibility();\n    };\n    this.updateVisibility();\n  },\n\n  tick() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const isVisible = this.el.object3D.visible;\n    const shouldNotBeVisible = isFrozen === !this.data.visible;\n    if (!isVisible && shouldNotBeVisible) return;\n\n    this.updateVisibility();\n  },\n\n  updateVisibility() {\n    if (!this.cameraEl) return;\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n\n    let isWithinDistance = true;\n    const isVisible = this.el.object3D.visible;\n\n    if (this.data.withinDistance) {\n      if (!isVisible) {\n        // Edge case, if the object is not visible force a matrix update\n        // since the main matrix update loop will not do it.\n        this.el.object3D.updateMatrices(true, true);\n      }\n\n      getLastWorldPosition(this.cameraEl.object3DMap.camera, this.camWorldPos);\n      this.objWorldPos.copy(this.el.object3D.position);\n      this.el.object3D.localToWorld(this.objWorldPos);\n\n      isWithinDistance =\n        this.camWorldPos.distanceToSquared(this.objWorldPos) < this.data.withinDistance * this.data.withinDistance;\n    }\n\n    const isTransforming = this.el.sceneEl.systems[\"transform-selected-object\"].transforming;\n    const isHoldingAnything = this.el.sceneEl.systems.interaction.isHoldingAnything();\n\n    if (this.data.withPermission && this.data.withoutPermission) {\n      throw new Error(\n        \"only withPermission or withoutPermission can be speciifed on visibility-while-frozen, not both.\"\n      );\n    }\n\n    const allowed = !!(\n      (!this.data.withPermission && !this.data.withoutPermission) ||\n      (this.data.withPermission &&\n        window.APP.hubChannel &&\n        window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission)) ||\n      (this.data.withoutPermission &&\n        window.APP.hubChannel &&\n        !window.APP.hubChannel.canOrWillIfCreator(this.data.withoutPermission))\n    );\n\n    let shouldBeVisible =\n      allowed &&\n      ((isFrozen && this.data.visible) || (!isFrozen && !this.data.visible)) &&\n      isWithinDistance &&\n      !isTransforming &&\n      !isHoldingAnything;\n\n    if (this.data.requireHoverOnNonMobile && !isMobile) {\n      shouldBeVisible =\n        shouldBeVisible &&\n        ((this.hoverable &&\n          (this.el.sceneEl.systems.interaction.state.rightRemote.hovered === this.hoverable ||\n            this.el.sceneEl.systems.interaction.state.leftRemote.hovered === this.hoverable)) ||\n          isVisible);\n    }\n\n    if (!this.data.visibleIfOwned) {\n      shouldBeVisible = shouldBeVisible && this.networkedEl && !NAF.utils.isMine(this.networkedEl);\n    }\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  }\n});\n\n/**\n * Toggles the interactivity of a UI entity while the scene is frozen.\n * @namespace ui\n * @component ui-class-while-frozen\n */\nAFRAME.registerComponent(\"ui-class-while-frozen\", {\n  init() {\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n    };\n    this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n  }\n});\n","import \"./stats-plus.css\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { defineQuery } from \"bitecs\";\nimport { AEntity } from \"../bit-components\";\n\nfunction ThreeStats(renderer) {\n  let _rS = null;\n\n  const _values = {\n    \"renderer.info.memory.geometries\": {\n      caption: \"Geometries\"\n    },\n    \"renderer.info.memory.textures\": {\n      caption: \"Textures\"\n    },\n    \"renderer.info.programs\": {\n      caption: \"Programs\"\n    },\n    \"renderer.info.render.calls\": {\n      caption: \"Calls\"\n    },\n    \"renderer.info.render.triangles\": {\n      caption: \"Triangles\",\n      over: 100000\n    },\n    \"renderer.info.render.points\": {\n      caption: \"Points\"\n    }\n  };\n\n  const _groups = [\n    {\n      caption: \"Three.js - Memory\",\n      values: [\"renderer.info.memory.geometries\", \"renderer.info.programs\", \"renderer.info.memory.textures\"]\n    },\n    {\n      caption: \"Three.js - Render\",\n      values: [\"renderer.info.render.calls\", \"renderer.info.render.triangles\", \"renderer.info.render.points\"]\n    }\n  ];\n\n  const _fractions = [];\n\n  function _update() {\n    _rS(\"renderer.info.memory.geometries\").set(renderer.info.memory.geometries);\n    _rS(\"renderer.info.programs\").set(renderer.info.programs.length);\n    _rS(\"renderer.info.memory.textures\").set(renderer.info.memory.textures);\n    _rS(\"renderer.info.render.calls\").set(renderer.info.render.calls);\n    _rS(\"renderer.info.render.triangles\").set(renderer.info.render.triangles);\n    _rS(\"renderer.info.render.points\").set(renderer.info.render.points);\n  }\n\n  function _start() {}\n\n  function _end() {}\n\n  function _attach(r) {\n    _rS = r;\n  }\n\n  return {\n    update: _update,\n    start: _start,\n    end: _end,\n    attach: _attach,\n    values: _values,\n    groups: _groups,\n    fractions: _fractions\n  };\n}\n\n// Adapted from https://github.com/aframevr/aframe/blob/master/src/components/scene/stats.js\nfunction createStats(scene) {\n  const plugins = scene.isMobile ? [] : [new ThreeStats(scene.renderer)];\n  return new window.rStats({\n    css: [],\n    values: {\n      fps: { caption: \"fps\", below: 30 }\n    },\n    groups: [\n      { caption: \"Framerate\", values: [\"fps\", \"raf\", \"physics\"] },\n      { caption: \"BitECS\", values: [\"entities\", \"a-entities\", \"queries\"] }\n    ],\n    plugins: plugins\n  });\n}\n\nconst HIDDEN_CLASS = \"a-hidden\";\n\nlet $queries;\n\nconst allEntitiesQuery = defineQuery();\nconst aEntityQuery = defineQuery([AEntity]);\n\nAFRAME.registerComponent(\"stats-plus\", {\n  // Whether or not the stats panel is expanded.\n  // Shows FPS counter when collapsed.\n  schema: { default: false },\n  init() {\n    this.onExpand = this.onExpand.bind(this);\n    this.onCollapse = this.onCollapse.bind(this);\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n\n    const scene = this.el.sceneEl;\n    this.stats = createStats(scene);\n    this.statsEl = document.querySelector(\".rs-base\");\n    // HACK for now in rare case where dom isn't ready, just bail\n    if (!this.statsEl) return;\n\n    // Add header to stats panel so we can collapse it\n    const statsHeaderEl = document.createElement(\"div\");\n    statsHeaderEl.classList.add(\"rs-header\");\n\n    const statsTitleEl = document.createElement(\"h1\");\n    statsTitleEl.innerHTML = \"Stats\";\n    statsHeaderEl.appendChild(statsTitleEl);\n\n    const collapseEl = document.createElement(\"div\");\n    collapseEl.classList.add(\"rs-collapse-btn\");\n    collapseEl.innerHTML = \"X\";\n    collapseEl.addEventListener(\"click\", this.onCollapse);\n    statsHeaderEl.appendChild(collapseEl);\n\n    this.statsEl.insertBefore(statsHeaderEl, this.statsEl.firstChild);\n\n    // Add fps counter to the page\n    this.fpsEl = document.createElement(\"div\");\n    this.fpsEl.addEventListener(\"click\", this.onExpand);\n    this.fpsEl.classList.add(\"rs-fps-counter\");\n    document.body.appendChild(this.fpsEl);\n    this.lastFpsUpdate = performance.now();\n    this.lastFps = 0;\n    this.frameCount = 0;\n    this.inVR = scene.is(\"vr-mode\");\n    this.showFPSCounter = window.APP.store.state.preferences.showFPSCounter;\n    this.fpsEl.style.display = this.showFPSCounter ? \"block\" : \"none\";\n\n    if (scene.isMobile) {\n      this.statsEl.classList.add(\"rs-mobile\");\n      this.fpsEl.classList.add(\"rs-mobile\");\n    }\n\n    scene.addEventListener(\"enter-vr\", this.onEnterVr);\n    scene.addEventListener(\"exit-vr\", this.onExitVr);\n\n    this.vrStatsEnabled = qsTruthy(\"vrstats\");\n    if (this.vrStatsEnabled) {\n      this.initVRStats();\n    }\n    this.lastUpdate = 0;\n\n    $queries = Object.getOwnPropertySymbols(APP.world).find(s => s.description == \"queries\");\n  },\n  initVRStats() {\n    this.vrPanel = document.createElement(\"a-entity\");\n    this.vrPanel.setAttribute(\"text\", { maxWidth: 0.5, value: \"_\", anchorY: \"bottom\" });\n    this.vrPanel.addEventListener(\n      \"loaded\",\n      () =>\n        this.vrPanel.object3D.traverse(x => {\n          if (x.material) x.material.depthTest = false;\n        }),\n      { once: true }\n    );\n    this.el.append(this.vrPanel);\n    const background = new THREE.Mesh(\n      new THREE.PlaneBufferGeometry(0.1, 0.12),\n      new THREE.MeshBasicMaterial({ color: 0x333333, depthTest: false })\n    );\n    background.position.set(-0.2, 0.055, 0);\n    this.el.object3D.add(background);\n  },\n  toggleVRStats() {\n    if (this.vrStatsEnabled) {\n      this.el.object3D.visible = false;\n      this.vrStatsEnabled = false;\n    } else {\n      if (!this.vrPanel) {\n        this.initVRStats();\n      }\n      this.el.object3D.visible = true;\n      this.vrStatsEnabled = true;\n    }\n  },\n  update(oldData) {\n    if (oldData !== this.data) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n        this.fpsEl.classList.add(HIDDEN_CLASS);\n      } else {\n        this.statsEl.classList.add(HIDDEN_CLASS);\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  tick(time) {\n    const stats = this.stats;\n    if (!this.statsEl) return;\n    if (this.showFPSCounter !== window.APP.store.state.preferences.showFPSCounter) {\n      this.showFPSCounter = window.APP.store.state.preferences.showFPSCounter;\n      this.fpsEl.style.display = this.showFPSCounter ? \"block\" : \"none\";\n    }\n    if (!this.showFPSCounter) {\n      return;\n    }\n    if (this.data || this.vrStatsEnabled) {\n      // Update rStats\n      stats(\"rAF\").tick();\n      stats(\"FPS\").frame();\n      stats(\"physics\").set(this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem.stepDuration);\n\n      stats(\"queries\").set(APP.world[$queries].size);\n      stats(\"entities\").set(allEntitiesQuery(APP.world).length);\n      stats(\"a-entities\").set(aEntityQuery(APP.world).length);\n\n      stats().update();\n    } else if (!this.inVR) {\n      // Update the fps counter\n      const now = performance.now();\n      this.frameCount++;\n\n      // Update the fps counter text once a second\n      if (now >= this.lastFpsUpdate + 1000) {\n        const fps = Math.round(this.frameCount / ((now - this.lastFpsUpdate) / 1000));\n        if (fps !== this.lastFps) {\n          this.fpsEl.innerHTML = Math.round(fps) + \" FPS\";\n          this.lastFps = fps;\n        }\n        this.lastFpsUpdate = now;\n        this.frameCount = 0;\n      }\n    }\n    if (this.vrStatsEnabled && time - this.lastUpdate > 100) {\n      this.vrPanel.setAttribute(\n        \"text\",\n        \"value\",\n        [\n          `f ${stats(\"fps\")\n            .value()\n            .toFixed(0)}`,\n          `r ${stats(\"raf\")\n            .value()\n            .toFixed(0)}`,\n          `p ${stats(\"physics\")\n            .value()\n            .toFixed(0)}`,\n          `c ${this.el.sceneEl.renderer.info.render.calls}`,\n          `t ${(this.el.sceneEl.renderer.info.render.triangles / 1000).toFixed(0)}k`\n        ].join(\"\\n\")\n      );\n      this.lastUpdate = time;\n    }\n  },\n  onEnterVr() {\n    this.inVR = true;\n    // Hide all stats elements when entering VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      this.statsEl.classList.add(HIDDEN_CLASS);\n      this.fpsEl.classList.add(HIDDEN_CLASS);\n    }\n  },\n  onExitVr() {\n    this.inVR = false;\n    // Revert to previous state whe exiting VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n      } else {\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  onExpand() {\n    this.el.setAttribute(this.name, true);\n  },\n  onCollapse() {\n    this.el.setAttribute(this.name, false);\n  },\n  remove() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.hide);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.show);\n\n    if (this.statsEl) {\n      this.statsEl.parentNode.removeChild(this.statsEl);\n      this.fpsEl.parentNode.removeChild(this.fpsEl);\n    }\n  }\n});\n","import { cloneMedia, closeExistingMediaMirror } from \"./media-utils\";\nlet mirrorTarget;\nexport function getCurrentMirroredMedia() {\n  mirrorTarget = mirrorTarget || document.querySelector(\"#media-mirror-target\");\n  const mirrorEl = mirrorTarget.firstChild;\n  const linkedEl = mirrorEl && mirrorEl.components[\"media-loader\"] && mirrorEl.components[\"media-loader\"].data.linkedEl;\n  return linkedEl;\n}\nexport async function refreshMediaMirror() {\n  const linkedEl = getCurrentMirroredMedia();\n  if (!linkedEl) {\n    return;\n  }\n  await closeExistingMediaMirror();\n  const { entity } = cloneMedia(\n    linkedEl,\n    \"#linked-media\",\n    linkedEl.components[\"media-loader\"].data.src,\n    false,\n    true,\n    mirrorTarget\n  );\n\n  entity.object3D.scale.set(0.75, 0.75, 0.75);\n  entity.object3D.matrixNeedsUpdate = true;\n\n  const refreshButton = entity.querySelector(\"[refresh-media-button]\");\n  if (refreshButton) {\n    refreshButton.parentNode.removeChild(refreshButton);\n  }\n\n  const localRefreshButton = entity.querySelector(\"[local-refresh-media-button]\");\n  if (localRefreshButton) {\n    localRefreshButton.parentNode.removeChild(localRefreshButton);\n  }\n\n  mirrorTarget.parentEl.components[\"follow-in-fov\"].reset();\n  mirrorTarget.parentEl.object3D.visible = true;\n}\n","import errorImageSrc from \"!!url-loader!../assets/images/media-error.png\";\n\nconst errorImage = new Image();\nerrorImage.src = errorImageSrc;\nexport const errorTexture = new THREE.Texture(errorImage);\nerrorImage.onload = () => {\n  errorTexture.needsUpdate = true;\n};\n","export function scaleToAspectRatio(el, ratio) {\n  const width = Math.min(1.0, 1.0 / ratio);\n  const height = Math.min(1.0, ratio);\n  el.object3DMap.mesh.scale.set(width, height, 1);\n  el.object3DMap.mesh.matrixNeedsUpdate = true;\n}\n","import { detect } from \"detect-browser\";\n\nconst browser = detect();\nconst browserIsSafari = [\"iOS\", \"Mac OS\"].includes(browser.os) && [\"safari\", \"ios\"].includes(browser.name);\n\nexport function isSafari() {\n  return browserIsSafari;\n}\n","/* global performance THREE AFRAME NAF MediaStream setTimeout */\nimport configs from \"../utils/configs\";\nimport audioIcon from \"../assets/images/audio.png\";\nimport { paths } from \"../systems/userinput/paths\";\nimport HLS from \"hls.js\";\nimport { MediaPlayer } from \"dashjs\";\nimport { addAndArrangeMedia, createVideoOrAudioEl, hasAudioTracks } from \"../utils/media-utils\";\nimport { disposeTexture } from \"../utils/material-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport { buildAbsoluteURL } from \"url-toolkit\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { applyPersistentSync } from \"../utils/permissions-utils\";\nimport { refreshMediaMirror, getCurrentMirroredMedia } from \"../utils/mirror-utils\";\nimport { detect } from \"detect-browser\";\nimport semver from \"semver\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { getCurrentAudioSettings, updateAudioSettings } from \"../update-audio-settings\";\nimport { SourceType, AudioType } from \"./audio-params\";\nimport { errorTexture } from \"../utils/error-texture\";\nimport { scaleToAspectRatio } from \"../utils/scale-to-aspect-ratio\";\nimport { isSafari } from \"../utils/detect-safari\";\nimport { isIOS as detectIOS } from \"../utils/is-mobile\";\n\nimport qsTruthy from \"../utils/qs_truthy\";\n\nconst ONCE_TRUE = { once: true };\nconst TYPE_IMG_PNG = { type: \"image/png\" };\n\nconst isIOS = detectIOS();\nconst audioIconTexture = new HubsTextureLoader().load(audioIcon);\n\nexport const VOLUME_LABELS = [];\nfor (let i = 0; i <= 20; i++) {\n  let s = \"[\";\n  for (let j = 1; j <= 20; j++) {\n    s += i >= j ? \"|\" : \" \";\n  }\n  s += \"]\";\n  VOLUME_LABELS[i] = s;\n}\n\nfunction timeFmt(t) {\n  let s = Math.floor(t),\n    h = Math.floor(s / 3600);\n  s -= h * 3600;\n  let m = Math.floor(s / 60);\n  s -= m * 60;\n  if (h < 10) h = `0${h}`;\n  if (m < 10) m = `0${m}`;\n  if (s < 10) s = `0${s}`;\n  return h === \"00\" ? `${m}:${s}` : `${h}:${m}:${s}`;\n}\n\nconst MAX_GAIN_MULTIPLIER = 2;\n\nAFRAME.registerComponent(\"media-video\", {\n  schema: {\n    src: { type: \"string\", default: '' },\n\n    startTime: { type: \"string\", default: ''},\n    endTime: { type: \"string\", default: ''},\n\n    audioSrc: { type: \"string\" }, // set only if audio track is separated from video track (eg. 360 video)\n    contentType: { type: \"string\" },\n    loop: { type: \"boolean\", default: true },\n    hidePlaybackControls: { type: \"boolean\", default: false },\n    videoPaused: { type: \"boolean\" },\n    projection: { type: \"string\", default: \"flat\" },\n    time: { type: \"number\" },\n    tickRate: { default: 1000 }, // ms interval to send time interval updates\n    syncTolerance: { default: 2 },\n    linkedVideoTexture: { default: null },\n    linkedAudioSource: { default: null },\n    linkedMediaElementAudioSource: { default: null }\n  },\n\n  init() {\n    APP.gainMultipliers.set(this.el, 1);\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.updateHoverMenu = this.updateHoverMenu.bind(this);\n    this.tryUpdateVideoPlaybackState = this.tryUpdateVideoPlaybackState.bind(this);\n    this.ensureOwned = this.ensureOwned.bind(this);\n    this.isMineOrLocal = this.isMineOrLocal.bind(this);\n    this.updateSrc = this.updateSrc.bind(this);\n\n    this.seekForward = this.seekForward.bind(this);\n    this.seekBack = this.seekBack.bind(this);\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.snap = this.snap.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.togglePlaying = this.togglePlaying.bind(this);\n    this.setupAudio = this.setupAudio.bind(this);\n\n    this.audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n\n    this.lastUpdate = 0;\n    this.videoMutedAt = 0;\n    this.localSnapCount = 0;\n    this.isSnapping = false;\n    this.videoIsLive = null; // value null until we've determined if the video is live or not.\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\n    this.hasAudioTracks = false;\n\n    this.el.setAttribute(\"hover-menu__video\", { template: \"#video-hover-menu\", isFlat: true });\n    this.el.components[\"hover-menu__video\"].getHoverMenu().then(menu => {\n      // If we got removed while waiting, do nothing.\n      if (!this.el.parentNode) return;\n\n      this.hoverMenu = menu;\n\n      this.playbackControls = this.el.querySelector(\".video-playback\");\n      this.playPauseButton = this.el.querySelector(\".video-playpause-button\");\n      this.volumeUpButton = this.el.querySelector(\".video-volume-up-button\");\n      this.volumeDownButton = this.el.querySelector(\".video-volume-down-button\");\n      this.seekForwardButton = this.el.querySelector(\".video-seek-forward-button\");\n      this.seekBackButton = this.el.querySelector(\".video-seek-back-button\");\n      this.snapButton = this.el.querySelector(\".video-snap-button\");\n      this.timeLabel = this.el.querySelector(\".video-time-label\");\n      this.volumeLabel = this.el.querySelector(\".video-volume-label\");\n      this.linkButton = this.el.querySelector(\".video-link-button\");\n\n      this.playPauseButton.object3D.addEventListener(\"interact\", this.togglePlaying);\n      this.seekForwardButton.object3D.addEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.addEventListener(\"interact\", this.seekBack);\n      this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n      this.snapButton.object3D.addEventListener(\"interact\", this.snap);\n\n      this.updateVolumeLabel();\n      this.updateHoverMenu();\n      this.updatePlaybackState();\n    });\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => {\n        this.networkedEl = networkedEl;\n        applyPersistentSync(this.networkedEl.components.networked.data.networkId);\n        this.updatePlaybackState();\n\n        this.networkedEl.addEventListener(\"pinned\", this.updateHoverMenu);\n        this.networkedEl.addEventListener(\"unpinned\", this.updateHoverMenu);\n        window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateHoverMenu);\n\n        // For scene-owned videos, take ownership after a random delay if nobody\n        // else has so there is a timekeeper. Do not due this on iOS because iOS has an\n        // annoying \"auto-pause\" feature that forces one non-autoplaying video to play\n        // at once, which will pause the videos for everyone in the room if owned.\n        if (!isIOS && NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n          setTimeout(() => {\n            if (NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n              NAF.utils.takeOwnership(this.networkedEl);\n            }\n          }, 2000 + Math.floor(Math.random() * 2000));\n        }\n      })\n      .catch(() => {\n        // Non-networked\n        this.updatePlaybackState();\n      });\n\n    let { disableLeftRightPanning, audioPanningQuality } = APP.store.state.preferences;\n    this.onPreferenceChanged = () => {\n      const newDisableLeftRightPanning = APP.store.state.preferences.disableLeftRightPanning;\n      const newAudioPanningQuality = APP.store.state.preferences.audioPanningQuality;\n\n      const shouldRecreateAudio =\n        disableLeftRightPanning !== newDisableLeftRightPanning && this.audio && this.mediaElementAudioSource;\n      const shouldUpdateAudioSettings = audioPanningQuality !== newAudioPanningQuality;\n\n      disableLeftRightPanning = newDisableLeftRightPanning;\n      audioPanningQuality = newAudioPanningQuality;\n\n      if (shouldRecreateAudio) {\n        this.setupAudio();\n      } else if (shouldUpdateAudioSettings) {\n        // updateAudioSettings() is called in this.setupAudio()\n        // so no need to call it if shouldRecreateAudio is true.\n        updateAudioSettings(this.el, this.audio);\n      }\n    };\n\n    APP.store.addEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.addEventListener(\"audio_type_changed\", this.setupAudio);\n\n    const startTime = this.data.startTime;\n    const endTime = this.data.endTime;\n    const currentHour = new Date().getHours();\n\n    if (startTime && endTime && currentHour >= parseInt(startTime) && currentHour < parseInt(endTime)) {\n      this.updateSrc(this.data.src);\n      this.setupVideo();\n      this.el.play;\n    }\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  isMineOrLocal() {\n    return !this.el.components.networked || (this.networkedEl && NAF.utils.isMine(this.networkedEl));\n  },\n\n  ensureOwned() {\n    return (\n      !this.el.components.networked ||\n      ((this.networkedEl && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl))\n    );\n  },\n\n  seekForward() {\n    if (!this.videoIsLive && this.ensureOwned()) {\n      this.video.currentTime += 30;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  seekBack() {\n    if (!this.videoIsLive && this.ensureOwned()) {\n      this.video.currentTime -= 10;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  changeVolumeBy(v) {\n    let gainMultiplier = APP.gainMultipliers.get(this.el);\n    gainMultiplier = THREE.MathUtils.clamp(gainMultiplier + v, 0, MAX_GAIN_MULTIPLIER);\n    APP.gainMultipliers.set(this.el, gainMultiplier);\n    this.updateVolumeLabel();\n    const audio = APP.audios.get(this.el);\n    if (audio) {\n      updateAudioSettings(this.el, audio);\n    }\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.2);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.2);\n  },\n\n  async snap() {\n    if (this.isSnapping) return;\n    this.isSnapping = true;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.video.videoWidth;\n    canvas.height = this.video.videoHeight;\n    canvas.getContext(\"2d\").drawImage(this.video, 0, 0, canvas.width, canvas.height);\n    const blob = await new Promise(resolve => canvas.toBlob(resolve));\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\n\n    this.localSnapCount++;\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount);\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\n  },\n\n  togglePlaying() {\n    // See onPauseStateChanged for note about iOS\n    if (isIOS && this.video.paused && this.isMineOrLocal()) {\n      this.video.play();\n      return;\n    }\n\n    if (this.ensureOwned()) {\n      this.tryUpdateVideoPlaybackState(!this.data.videoPaused);\n    }\n  },\n\n  onPauseStateChange() {\n    // iOS Safari will auto-pause other videos if one is manually started (not autoplayed.) So, to keep things\n    // easy to reason about, we *never* broadcast pauses from iOS.\n    //\n    // if an iOS safari user pauses and plays a video they'll pause all the other videos,\n    // which isn't great, but this check will at least ensure they don't pause those videos\n    // for all other users in the room! Of course, if they go and hit play on those videos auto-paused,\n    // they will become the timekeeper, and will seek everyone to where the video was auto-paused.\n    //\n    // This specific case will diverge the network schema and the video player state, so that\n    // this.data.videoPaused is false (so others will keep playing it) but our local player will\n    // have stopped. So we deal with this special case as well when we press the play button.\n    if (isIOS && this.video.paused && this.isMineOrLocal()) {\n      return;\n    }\n\n    // Used in the HACK in hub.js for dealing with auto-pause in Oculus Browser\n    if (this._ignorePauseStateChanges) return;\n\n    this.el.setAttribute(\"media-video\", \"videoPaused\", this.video.paused);\n    if (this.video.paused) {\n      APP.isAudioPaused.add(this.el);\n    } else {\n      APP.isAudioPaused.delete(this.el);\n    }\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      this.el.emit(\"owned-video-state-changed\");\n    }\n  },\n\n  updatePlaybackState(force) {\n    this.updateHoverMenu();\n    \n    // Only update playback position for videos you don't own\n    if (this.video && (force || (this.networkedEl && !NAF.utils.isMine(this.networkedEl)))) {\n      if (Math.abs(this.data.time - this.video.currentTime) > this.data.syncTolerance) {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused, this.data.time);\n      } else {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused);\n      }\n    }\n  },\n\n  tryUpdateVideoPlaybackState(pause, currentTime) {\n    if (this._playbackStateChangeTimeout) {\n      clearTimeout(this._playbackStateChangeTimeout);\n      delete this._playbackStateChangeTimeout;\n    }\n\n    // Update current time if we've determined this video is not a live stream, since otherwise we may\n    // update the video to currentTime = 0\n    if (this.videoIsLive === false && currentTime !== undefined) {\n      this.video.currentTime = currentTime;\n    }\n\n    if (this.hoverMenu) {\n      this.playPauseButton.setAttribute(\"icon-button\", \"active\", pause);\n    }\n\n    if (pause) {\n      this.video.pause();\n    } else {\n      // Need to deal with the fact play() may fail if user has not interacted with browser yet.\n      this.video.play().catch(() => {\n        if (pause !== this.data.videoPaused) return;\n        this._playbackStateChangeTimeout = setTimeout(() => this.tryUpdateVideoPlaybackState(pause, currentTime), 1000);\n      });\n    }\n  },\n\n  update(oldData) {\n    this.updatePlaybackState();\n\n    const shouldUpdateSrc = this.data.src && this.data.src !== oldData.src;\n    if (shouldUpdateSrc) {\n      this.updateSrc(oldData);\n      return;\n    }\n  },\n\n  setupAudio() {\n    this.removeAudio();\n\n    APP.sourceType.set(this.el, SourceType.MEDIA_VIDEO);\n\n    if (this.data.videoPaused) {\n      APP.isAudioPaused.add(this.el);\n    } else {\n      APP.isAudioPaused.delete(this.el);\n    }\n\n    const { audioType } = getCurrentAudioSettings(this.el);\n    const audioListener = this.el.sceneEl.audioListener;\n    if (audioType === AudioType.PannerNode) {\n      this.audio = new THREE.PositionalAudio(audioListener);\n    } else {\n      this.audio = new THREE.Audio(audioListener);\n    }\n    // Default to being quiet so it fades in when volume is set by audio systems\n    this.audio.gain.gain.value = 0;\n    this.audioSystem.addAudio({ sourceType: SourceType.MEDIA_VIDEO, node: this.audio });\n\n    this.audio.setNodeSource(this.mediaElementAudioSource);\n    this.el.setObject3D(\"sound\", this.audio);\n\n    // Make sure that the audio is initialized to the right place.\n    // Its matrix may not update if this element is not visible.\n    // See https://github.com/mozilla/hubs/issues/2855\n    this.audio.updateMatrixWorld();\n\n    APP.audios.set(this.el, this.audio);\n    updateAudioSettings(this.el, this.audio);\n    // Original audio source volume can now be restored as audio systems will take over\n    this.mediaElementAudioSource.mediaElement.volume = 1;\n  },\n\n  async updateSrc(oldData) {\n    const { src, linkedVideoTexture, linkedAudioSource, linkedMediaElementAudioSource } = this.data;\n\n    this.cleanUp();\n    if (this.mesh && this.mesh.material) {\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    let texture, audioSourceEl;\n    try {\n      if (linkedVideoTexture) {\n        texture = linkedVideoTexture;\n        audioSourceEl = linkedAudioSource;\n      } else {\n        this.el.emit(\"video-loading\");\n        ({ texture, audioSourceEl } = await this.createVideoTextureAudioSourceEl());\n        if (getCurrentMirroredMedia() === this.el) {\n          await refreshMediaMirror();\n        }\n      }\n\n      this.hasAudioTracks = hasAudioTracks(audioSourceEl);\n\n      // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n      if (this.data.src !== src) {\n        disposeTexture(texture);\n        return;\n      }\n\n      this.mediaElementAudioSource = null;\n      if (!src.startsWith(\"hubs://\")) {\n        // iOS video audio is broken on ios safari < 13.1.2, see: https://github.com/mozilla/hubs/issues/1797\n        if (!isIOS || semver.satisfies(detect().version, \">=13.1.2\")) {\n          // TODO FF error here if binding mediastream: The captured HTMLMediaElement is playing a MediaStream. Applying volume or mute status is not currently supported -- not an issue since we have no audio atm in shared video.\n          this.mediaElementAudioSource =\n            linkedMediaElementAudioSource ||\n            this.el.sceneEl.audioListener.context.createMediaElementSource(audioSourceEl);\n\n          this.hasAudioTracks && this.setupAudio();\n        }\n      }\n\n      this.video = texture.image;\n      this.video.loop = this.data.loop;\n      this.video.addEventListener(\"pause\", this.onPauseStateChange);\n      this.video.addEventListener(\"play\", this.onPauseStateChange);\n\n      if (texture.hls) {\n        const updateHLSLiveState = () => {\n          if (texture.hls.currentLevel >= 0) {\n            this.videoIsLive = texture.hls.levels[texture.hls.currentLevel].details.live;\n            this.updateHoverMenu();\n          }\n        };\n        texture.hls.on(HLS.Events.LEVEL_LOADED, updateHLSLiveState);\n        texture.hls.on(HLS.Events.LEVEL_SWITCHED, updateHLSLiveState);\n        if (texture.hls.currentLevel >= 0) {\n          updateHLSLiveState();\n        }\n      } else {\n        this.videoIsLive = this.video.duration === Infinity;\n        this.updateHoverMenu();\n      }\n\n      if (isIOS) {\n        const template = document.getElementById(\"video-unmute\");\n        this.el.appendChild(document.importNode(template.content, true));\n        this.el.setAttribute(\"position-at-border__unmute-ui\", {\n          target: \".unmute-ui\",\n          isFlat: true\n        });\n      }\n\n      this.videoTexture = texture;\n      this.audioSource = audioSourceEl;\n    } catch (e) {\n      console.error(\"Error loading video\", this.data.src, e);\n      texture = errorTexture;\n      this.videoTexture = this.audioSource = null;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n      material.toneMapped = false;\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        const flipY = texture.isVideoTexture ? texture.flipY : audioIconTexture.flipY;\n        geometry = createPlaneBufferGeometry(undefined, undefined, undefined, undefined, flipY);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    if (!texture.isVideoTexture) {\n      this.mesh.material.map = audioIconTexture;\n    } else {\n      this.mesh.material.map = texture;\n      if (projection === \"flat\") {\n        scaleToAspectRatio(\n          this.el,\n          (texture.image.videoHeight || texture.image.height) / (texture.image.videoWidth || texture.image.width)\n        );\n      }\n    }\n    this.mesh.material.needsUpdate = true;\n\n    this.updatePlaybackState(true);\n\n    if (this.video && this.video.muted) {\n      this.videoMutedAt = performance.now();\n    }\n\n    this.el.emit(\"video-loaded\", { projection: projection });\n  },\n\n  async createVideoTextureAudioSourceEl() {\n    const url = this.data.src;\n    const contentType = this.data.contentType;\n    let pollTimeout;\n\n    return new Promise(async (resolve, reject) => {\n      if (this._audioSyncInterval) {\n        clearInterval(this._audioSyncInterval);\n        this._audioSyncInterval = null;\n      }\n\n      let resolved = false;\n      const failLoad = function(e) {\n        if (resolved) return;\n        resolved = true;\n        clearTimeout(pollTimeout);\n        reject(e);\n      };\n\n      const videoEl = createVideoOrAudioEl(\"video\");\n\n      let texture, audioEl, isReady;\n      if (contentType.startsWith(\"audio/\")) {\n        // We want to treat audio almost exactly like video, so we mock a video texture with an image property.\n        texture = new THREE.Texture();\n        texture.image = videoEl;\n        isReady = () => videoEl.readyState > 0;\n      } else {\n        texture = new THREE.VideoTexture(videoEl);\n        texture.minFilter = THREE.LinearFilter;\n        texture.encoding = THREE.sRGBEncoding;\n\n        // Firefox seems to have video play (or decode) performance issue.\n        // Somehow setting RGBA format improves the performance very well.\n        // Some tickets have been opened for the performance issue but\n        // I don't think it will be fixed soon. So we set RGBA format for Firefox\n        // as workaround so far.\n        // See https://github.com/mozilla/hubs/issues/3470\n        if (/firefox/i.test(navigator.userAgent)) {\n          texture.format = THREE.RGBAFormat;\n        }\n\n        isReady = () => {\n          if (texture.hls && texture.hls.streamController.audioOnly) {\n            audioEl = videoEl;\n            const hls = texture.hls;\n            texture = new THREE.Texture();\n            texture.image = videoEl;\n            texture.hls = hls;\n            return true;\n          } else {\n            const ready =\n              (texture.image.videoHeight || texture.image.height) && (texture.image.videoWidth || texture.image.width);\n            return ready;\n          }\n        };\n      }\n\n      // Set src on video to begin loading.\n      if (url.startsWith(\"hubs://\")) {\n        const streamClientId = url.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\n        const stream = await APP.dialog.getMediaStream(streamClientId, \"video\");\n        // We subscribe to video stream notifications for this peer to update the video element\n        // This could happen in case there is an ICE failure that requires a transport recreation.\n        if (this._onStreamUpdated) {\n          APP.dialog.off(\"stream_updated\", this._onStreamUpdated);\n        }\n        this._onStreamUpdated = async (peerId, kind) => {\n          if (peerId === streamClientId && kind === \"video\") {\n            // The video stream for this peer has been updated\n            const stream = await APP.dialog.getMediaStream(peerId, \"video\").catch(e => {\n              console.error(`Error getting video stream for ${peerId}`, e);\n            });\n            if (stream) {\n              videoEl.srcObject = new MediaStream(stream);\n            }\n          }\n        };\n        APP.dialog.on(\"stream_updated\", this._onStreamUpdated, this);\n        videoEl.srcObject = new MediaStream(stream.getVideoTracks());\n        // If hls.js is supported we always use it as it gives us better events\n      } else if (contentType.startsWith(\"application/dash\")) {\n        const dashPlayer = MediaPlayer().create();\n        dashPlayer.extend(\"RequestModifier\", function() {\n          return { modifyRequestHeader: xhr => xhr, modifyRequestURL: proxiedUrlFor };\n        });\n        dashPlayer.on(MediaPlayer.events.ERROR, failLoad);\n        dashPlayer.initialize(videoEl, url);\n        dashPlayer.setTextDefaultEnabled(false);\n\n        // TODO this countinously pings to get updated time, unclear if this is actually needed, but this preserves the default behavior\n        dashPlayer.clearDefaultUTCTimingSources();\n        dashPlayer.addUTCTimingSource(\n          \"urn:mpeg:dash:utc:http-xsdate:2014\",\n          proxiedUrlFor(\"https://time.akamai.com/?iso\")\n        );\n        // We can also use our own HEAD request method like we use to sync NAF\n        // dashPlayer.addUTCTimingSource(\"urn:mpeg:dash:utc:http-head:2014\", location.href);\n\n        texture.dash = dashPlayer;\n      } else if (AFRAME.utils.material.isHLS(url, contentType)) {\n        if (HLS.isSupported()) {\n          const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\n          const baseUrl = url.startsWith(corsProxyPrefix) ? url.substring(corsProxyPrefix.length) : url;\n          const setupHls = () => {\n            if (texture.hls) {\n              texture.hls.stopLoad();\n              texture.hls.detachMedia();\n              texture.hls.destroy();\n              texture.hls = null;\n            }\n\n            const hls = new HLS({\n              debug: qsTruthy(\"hlsDebug\"),\n              xhrSetup: (xhr, u) => {\n                if (u.startsWith(corsProxyPrefix)) {\n                  u = u.substring(corsProxyPrefix.length);\n                }\n\n                // HACK HLS.js resolves relative urls internally, but our CORS proxying screws it up. Resolve relative to the original unproxied url.\n                // TODO extend HLS.js to allow overriding of its internal resolving instead\n                if (!u.startsWith(\"http\")) {\n                  u = buildAbsoluteURL(baseUrl, u.startsWith(\"/\") ? u : `/${u}`);\n                }\n\n                xhr.open(\"GET\", proxiedUrlFor(u), true);\n              }\n            });\n\n            texture.hls = hls;\n            hls.loadSource(url);\n            hls.attachMedia(videoEl);\n\n            hls.on(HLS.Events.ERROR, function(event, data) {\n              if (data.fatal) {\n                switch (data.type) {\n                  case HLS.ErrorTypes.NETWORK_ERROR:\n                    // try to recover network error\n                    hls.startLoad();\n                    break;\n                  case HLS.ErrorTypes.MEDIA_ERROR:\n                    hls.recoverMediaError();\n                    break;\n                  default:\n                    failLoad(event);\n                    return;\n                }\n              }\n            });\n          };\n\n          setupHls();\n        } else if (videoEl.canPlayType(contentType)) {\n          videoEl.src = url;\n          videoEl.onerror = failLoad;\n        } else {\n          failLoad(\"HLS unsupported\");\n        }\n      } else if(url === \"https://d211oxh2wr4amt.cloudfront.net/Marlon%20Brando.mp4\") {\n        const now = new Date();\n        const videoStartTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 9, 0, 0); // 9시로 설정\n    \n        const timePassed = (now - videoStartTime) / 1000; // 초 단위로 경과된 시간 계산\n        const videoDuration = 2 * 60 * 60; // 비디오 길이 2시간 (초 단위)\n        const currentTime = (timePassed % videoDuration) + 9 * 60 * 60; // 시작 시간을 포함한 경과 시간 계산\n    \n        videoEl.currentTime = currentTime;\n      } else {\n        videoEl.src = url;\n        // Workaround for Safari.\n        // Safari seems to have a bug that it doesn't transfer range property in HTTP request header\n        // for redirects if crossOrigin is set (while other major browsers do).\n        // So Safari can fail to load video if the server responds redirect because\n        // it expects 206 HTTP status code but gets 200.\n        // If we fail to load video on Safari we retry with fetch() and videoEl.srcObject\n        // which may avoid the problem.\n        // Refer to #4516 for the details.\n        if (isSafari()) {\n          // There seems no way to detect whether the error is caused by the problem mentioned above.\n          // So always retrying.\n          videoEl.onerror = async () => {\n            videoEl.onerror = failLoad;\n            try {\n              const res = await fetch(url);\n              videoEl.srcObject = await res.blob();\n            } catch (e) {\n              failLoad(e);\n            }\n          };\n        } else {\n          videoEl.onerror = failLoad;\n        }\n\n        // audioSrc is non-empty only if audio track is separated from video track (eg. 360 video)\n        if (this.data.audioSrc) {\n          // Mute video track just in case\n          videoEl.muted = true;\n\n          // If there's an audio src, create an audio element to play it that we keep in sync\n          // with the video while this component is active.\n          audioEl = createVideoOrAudioEl(\"audio\");\n          audioEl.src = this.data.audioSrc;\n          audioEl.onerror = failLoad;\n\n          this._audioSyncInterval = setInterval(() => {\n            if (Math.abs(audioEl.currentTime - videoEl.currentTime) >= 0.33) {\n              // In Chrome, drift of a few frames seems persistent\n              audioEl.currentTime = videoEl.currentTime;\n            }\n\n            // During pause state change, correct any drift that remains.\n            if (videoEl.paused !== audioEl.paused) {\n              videoEl.paused ? audioEl.pause() : audioEl.play();\n              audioEl.currentTime = videoEl.currentTime;\n            }\n          }, 1000);\n        }\n      }\n\n      // NOTE: We used to use the canplay event here to yield the texture, but that fails to fire on iOS Safari\n      // and also sometimes in Chrome it seems.\n      const poll = () => {\n        if (isReady()) {\n          resolved = true;\n          resolve({ texture, audioSourceEl: audioEl || texture.image });\n        } else {\n          pollTimeout = setTimeout(poll, 500);\n        }\n      };\n\n      poll();\n    });\n  },\n\n  updateHoverMenu() {\n    if (!this.hoverMenu) return;\n\n    const mediaLoader = this.el.components[\"media-loader\"].data;\n    const pinnableElement = mediaLoader.linkedEl || this.el;\n    const isPinned = pinnableElement.components.pinnable && pinnableElement.components.pinnable.data.pinned;\n    this.playbackControls.object3D.visible = !this.data.hidePlaybackControls && !!this.video;\n    this.timeLabel.object3D.visible = !this.data.hidePlaybackControls;\n    this.volumeLabel.object3D.visible = this.volumeUpButton.object3D.visible = this.volumeDownButton.object3D.visible =\n      this.hasAudioTracks && !this.data.hidePlaybackControls && !!this.video;\n\n    this.snapButton.object3D.visible =\n      !!this.video && !this.data.contentType.startsWith(\"audio/\") && window.APP.hubChannel.can(\"spawn_and_move_media\");\n    this.seekForwardButton.object3D.visible = !!this.video && !this.videoIsLive;\n\n    const mayModifyPlayHead =\n      !!this.video && !this.videoIsLive && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n\n    this.playPauseButton.object3D.visible = this.seekForwardButton.object3D.visible = this.seekBackButton.object3D.visible = mayModifyPlayHead;\n\n    this.linkButton.object3D.visible = !!mediaLoader.mediaOptions.href;\n\n    if (this.videoIsLive) {\n      this.timeLabel.setAttribute(\"text\", \"value\", \"LIVE\");\n    }\n  },\n\n  updateVolumeLabel() {\n    const gainMultiplier = APP.gainMultipliers.get(this.el);\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      gainMultiplier === 0 ? \"MUTE\" : VOLUME_LABELS[Math.floor(gainMultiplier / (MAX_GAIN_MULTIPLIER / 20))]\n    );\n  },\n\n  tick: (() => {\n    return function() {\n      if (!this.video) return;\n\n      const userinput = this.el.sceneEl.systems.userinput;\n      const interaction = this.el.sceneEl.systems.interaction;\n      const volumeModRight = userinput.get(paths.actions.cursor.right.mediaVolumeMod);\n      if (interaction.state.rightRemote.hovered === this.el && volumeModRight) {\n        this.changeVolumeBy(volumeModRight);\n      }\n      const volumeModLeft = userinput.get(paths.actions.cursor.left.mediaVolumeMod);\n      if (interaction.state.leftRemote.hovered === this.el && volumeModLeft) {\n        this.changeVolumeBy(volumeModLeft);\n      }\n\n      const isHeld = interaction.isHeld(this.el);\n\n      if (this.wasHeld && !isHeld) {\n        this.localSnapCount = 0;\n      }\n\n      this.wasHeld = isHeld;\n\n      if (this.hoverMenu && this.hoverMenu.object3D.visible && !this.videoIsLive) {\n        this.timeLabel.setAttribute(\n          \"text\",\n          \"value\",\n          `${timeFmt(this.video.currentTime)} / ${timeFmt(this.video.duration)}`\n        );\n      }\n\n      // If a known non-live video is currently playing and we own it, send out time updates\n      if (\n        !this.data.videoPaused &&\n        this.videoIsLive === false &&\n        this.networkedEl &&\n        NAF.utils.isMine(this.networkedEl)\n      ) {\n        const now = performance.now();\n        if (now - this.lastUpdate > this.data.tickRate) {\n          this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n          this.lastUpdate = now;\n        }\n      }\n    };\n  })(),\n\n  cleanUp() {\n    if (this.videoTexture && !this.data.linkedVideoTexture) {\n      disposeTexture(this.videoTexture);\n    }\n  },\n\n  remove() {\n    this.cleanUp();\n\n    APP.isAudioPaused.delete(this.el);\n\n    if (this.mesh) {\n      this.el.removeObject3D(\"mesh\");\n    }\n\n    if (this._audioSyncInterval) {\n      clearInterval(this._audioSyncInterval);\n      this._audioSyncInterval = null;\n    }\n\n    APP.gainMultipliers.delete(this.el);\n    APP.audios.delete(this.el);\n    APP.sourceType.delete(this.el);\n    APP.supplementaryAttenuation.delete(this.el);\n\n    this.removeAudio();\n\n    if (this.networkedEl) {\n      this.networkedEl.removeEventListener(\"pinned\", this.updateHoverMenu);\n      this.networkedEl.removeEventListener(\"unpinned\", this.updateHoverMenu);\n    }\n\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateHoverMenu);\n\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n      this.video.removeEventListener(\"play\", this.onPauseStateChange);\n      APP.dialog.off(\"stream_updated\", this._onStreamUpdated);\n    }\n\n    if (this.hoverMenu) {\n      this.playPauseButton.object3D.removeEventListener(\"interact\", this.togglePlaying);\n      this.volumeUpButton.object3D.removeEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.removeEventListener(\"interact\", this.volumeDown);\n      this.seekForwardButton.object3D.removeEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.removeEventListener(\"interact\", this.seekBack);\n      this.snapButton.object3D.removeEventListener(\"interact\", this.snap);\n    }\n\n    window.APP.store.removeEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.addEventListener(\"audio_type_changed\", this.setupAudio);\n  },\n\n  removeAudio() {\n    if (this.audio) {\n      this.el.removeObject3D(\"sound\");\n      this.audioSystem.removeAudio({ node: this.audio });\n      delete this.audio;\n    }\n  }\n});\n","import * as pdfjs from \"pdfjs-dist\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { scaleToAspectRatio } from \"../utils/scale-to-aspect-ratio\";\nimport { errorTexture } from \"../utils/error-texture\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport { addAndArrangeMedia } from \"../utils/media-utils\";\nconst ONCE_TRUE = { once: true };\nconst TYPE_IMG_PNG = { type: \"image/png\" };\n\n/**\n * Warning! This require statement is fragile!\n *\n * How it works:\n * require -> require the file after all import statements have been called, particularly the configs.js import which modifies __webpack_public_path__\n * !! -> don't run any other loaders\n * file-loader -> make webpack move the file into the dist directory and return the file path\n * outputPath -> where to put the file\n * name -> how to name the file\n * Then the path to the worker script\n */\npdfjs.GlobalWorkerOptions.workerSrc =\n  require(\"!!file-loader?outputPath=assets/js&name=[name]-[hash].js!pdfjs-dist/build/pdf.worker.min.js\").default;\n\nAFRAME.registerComponent(\"media-pdf\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" },\n    index: { default: 0 }\n  },\n\n  init() {\n    this.snap = this.snap.bind(this);\n    this.canvas = document.createElement(\"canvas\");\n    this.canvasContext = this.canvas.getContext(\"2d\");\n    this.localSnapCount = 0;\n    this.isSnapping = false;\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\n    this.texture = new THREE.CanvasTexture(this.canvas);\n\n    this.texture.encoding = THREE.sRGBEncoding;\n    this.texture.minFilter = THREE.LinearFilter;\n\n    this.el.addEventListener(\"pager-snap-clicked\", () => this.snap());\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  async snap() {\n    if (this.isSnapping) return;\n    this.isSnapping = true;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n\n    const blob = await new Promise(resolve => this.canvas.toBlob(resolve));\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\n\n    this.localSnapCount++;\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount, false, 1);\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n\n    try {\n      const { src, index } = this.data;\n      if (!src) return;\n\n      if (this.renderTask) {\n        await this.renderTask.promise;\n        if (src !== this.data.src || index !== this.data.index) return;\n      }\n\n      this.el.emit(\"pdf-loading\");\n\n      if (src !== oldData.src) {\n        const loadingSrc = this.data.src;\n        const pdf = await pdfjs.getDocument(src).promise;\n        if (loadingSrc !== this.data.src) return;\n\n        this.pdf = pdf;\n        this.el.setAttribute(\"media-pager\", { maxIndex: this.pdf.numPages - 1 });\n      }\n\n      const page = await this.pdf.getPage(index + 1);\n      if (src !== this.data.src || index !== this.data.index) return;\n\n      const viewport = page.getViewport({ scale: 3 });\n      const pw = viewport.width;\n      const ph = viewport.height;\n      texture = this.texture;\n      ratio = ph / pw;\n\n      this.canvas.width = pw;\n      this.canvas.height = ph;\n\n      this.renderTask = page.render({ canvasContext: this.canvasContext, viewport });\n\n      await this.renderTask.promise;\n\n      this.renderTask = null;\n\n      if (src !== this.data.src || index !== this.data.index) return;\n    } catch (e) {\n      console.error(\"Error loading PDF\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    if (!this.mesh) {\n      const material = new THREE.MeshBasicMaterial();\n      const geometry = createPlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n      material.side = THREE.DoubleSide;\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    this.mesh.material.transparent = texture == errorTexture;\n    this.mesh.material.map = texture;\n    this.mesh.material.map.needsUpdate = true;\n    this.mesh.material.needsUpdate = true;\n\n    scaleToAspectRatio(this.el, ratio);\n\n    if (this.el.components[\"media-pager\"] && this.el.components[\"media-pager\"].data.index !== this.data.index) {\n      this.el.setAttribute(\"media-pager\", { index: this.data.index });\n    }\n\n    this.el.emit(\"pdf-loaded\", { src: this.data.src });\n  }\n});\n","import { KTX2Loader } from \"three/examples/jsm/loaders/KTX2Loader\";\nimport { BasisTextureLoader } from \"three/examples/jsm/loaders/BasisTextureLoader\";\nimport { rewriteBasisTranscoderUrls } from \"./media-url-utils\";\nconst loadingManager = new THREE.LoadingManager();\nloadingManager.setURLModifier(rewriteBasisTranscoderUrls);\nlet ktxLoader;\nlet basisLoader;\nexport function createBasisTexture(url) {\n  if (!basisLoader) {\n    basisLoader = new BasisTextureLoader(loadingManager).detectSupport(AFRAME.scenes[0].renderer);\n  }\n  return new Promise((resolve, reject) => {\n    basisLoader.load(\n      url,\n      function(texture) {\n        texture.encoding = THREE.sRGBEncoding;\n        texture.onUpdate = function() {\n          // Delete texture data once it has been uploaded to the GPU\n          texture.mipmaps.length = 0;\n        };\n        // texture.anisotropy = 4;\n        resolve(texture);\n      },\n      undefined,\n      function(error) {\n        console.error(error);\n        reject(new Error(`'${url}' could not be fetched (Error: ${error}`));\n      }\n    );\n  });\n}\n\nexport function createKTX2Texture(url) {\n  if (!ktxLoader) {\n    ktxLoader = new KTX2Loader(loadingManager).detectSupport(AFRAME.scenes[0].renderer);\n  }\n  return new Promise((resolve, reject) => {\n    ktxLoader.load(\n      url,\n      function(texture) {\n        texture.encoding = THREE.sRGBEncoding;\n        texture.onUpdate = function() {\n          // Delete texture data once it has been uploaded to the GPU\n          texture.mipmaps.length = 0;\n        };\n        texture.anisotropy = 4;\n        resolve(texture);\n      },\n      undefined,\n      function(error) {\n        console.error(error);\n        reject(new Error(`'${url}' could not be fetched (Error: ${error}`));\n      }\n    );\n  });\n}\n","import { promisifyWorker } from \"../utils/promisify-worker.js\";\n\nimport GIFWorker from \"../workers/gifparsing.worker.js\";\n\nclass GIFTexture extends THREE.Texture {\n  constructor(frames, delays, disposals) {\n    super(document.createElement(\"canvas\"));\n    this.image.width = frames[0].width;\n    this.image.height = frames[0].height;\n\n    this._ctx = this.image.getContext(\"2d\");\n\n    this.generateMipmaps = false;\n    this.isVideoTexture = true;\n    this.minFilter = THREE.NearestFilter;\n\n    this.frames = frames;\n    this.delays = delays;\n    this.disposals = disposals;\n\n    this.frame = 0;\n    this.frameStartTime = Date.now();\n  }\n\n  update() {\n    if (!this.frames || !this.delays || !this.disposals) return;\n    const now = Date.now();\n    if (now - this.frameStartTime > this.delays[this.frame]) {\n      if (this.disposals[this.frame] === 2) {\n        this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n      }\n      this.frame = (this.frame + 1) % this.frames.length;\n      this.frameStartTime = now;\n      this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n      this.needsUpdate = true;\n    }\n  }\n}\n\nconst parseGIF = promisifyWorker(new GIFWorker());\n\nexport async function createGIFTexture(url) {\n  return new Promise((resolve, reject) => {\n    fetch(url, { mode: \"cors\" })\n      .then(r => r.arrayBuffer())\n      .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n      .then(result => {\n        const { frames, delayTimes, disposals } = result;\n        let loadCnt = 0;\n        for (let i = 0; i < frames.length; i++) {\n          const img = new Image();\n          img.onload = e => {\n            loadCnt++;\n            frames[i] = e.target;\n            if (loadCnt === frames.length) {\n              const texture = new GIFTexture(frames, delayTimes, disposals);\n              texture.image.src = url;\n              texture.encoding = THREE.sRGBEncoding;\n              texture.minFilter = THREE.LinearFilter;\n              resolve(texture);\n            }\n          };\n          img.src = frames[i];\n        }\n      })\n      .catch(reject);\n  });\n}\n","\nimport worker from \"!!../../node_modules/worker-loader/dist/runtime/inline.js\";\n\nexport default function Worker_fn() {\n  return worker(\"self.onmessage=s=>{try{const e=function(s){let e=0;const r=[];let a=null;const o=[],t=[];let n=0;if(71!==s[0]||73!==s[1]||70!==s[2]||56!==s[3]||57!==s[4]||97!==s[5])throw new Error(\\\"parseGIF: no GIF89a\\\");{e+=13+ +!!(128&s[10])*Math.pow(2,1+(7&s[10]))*3;const l=s.subarray(0,e);for(;s[e]&&59!==s[e];){const c=e,f=s[e];if(33===f){const o=s[++e];if(-1===[1,254,249,255].indexOf(o))throw new Error(\\\"parseGIF: unknown label\\\");for(249===o&&r.push(10*(s[e+3]+(s[e+4]<<8))),255===o&&(n=s[e+15]+(s[e+16]<<8));s[++e];)e+=s[e];249===o&&(a=s.subarray(c,e+1),t.push(a[3]>>2&7))}else{if(44!==f)throw new Error(\\\"parseGIF: unknown blockId\\\");{for(e+=9,e+=1+ +!!(128&s[e])*(3*Math.pow(2,1+(7&s[e])));s[++e];)e+=s[e];const r=s.subarray(c,e+1);o.push(URL.createObjectURL(new Blob([l,a,r])))}}e++}}return{delayTimes:r,loopCnt:n,frames:o,disposals:t}}(new Uint8Array(s.data.payload));self.postMessage({id:s.data.id,result:e})}catch(e){self.postMessage({id:s.data.id,err:e.message})}};\\n\", \"Worker\", undefined, undefined);\n}\n","import { createImageTexture } from \"../utils/media-utils\";\nimport { createBasisTexture, createKTX2Texture } from \"../utils/create-basis-texture\";\nimport { TextureCache } from \"../utils/texture-cache\";\nimport { errorTexture } from \"../utils/error-texture\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport { scaleToAspectRatio } from \"../utils/scale-to-aspect-ratio\";\nimport { createGIFTexture } from \"../utils/gif-texture\";\n\nconst textureCache = new TextureCache();\nconst inflightTextures = new Map();\n\nconst errorCacheItem = { texture: errorTexture, ratio: 1400 / 1200 };\n\nAFRAME.registerComponent(\"media-image\", {\n  schema: {\n    src: { type: \"string\" },\n    version: { type: \"number\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" },\n    alphaMode: { type: \"string\", default: undefined },\n    alphaCutoff: { type: \"number\" }\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  remove() {\n    if (this.currentSrcIsRetained) {\n      textureCache.release(this.data.src, this.data.version);\n      this.currentSrcIsRetained = false;\n    }\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n\n    try {\n      const { src, version, contentType } = this.data;\n      if (!src) return;\n\n      this.el.emit(\"image-loading\");\n\n      if (this.mesh && this.mesh.material.map && (src !== oldData.src || version !== oldData.version)) {\n        this.mesh.material.map = null;\n        this.mesh.material.needsUpdate = true;\n        if (this.mesh.material.map !== errorTexture) {\n          textureCache.release(oldData.src, oldData.version);\n          this.currentSrcIsRetained = false;\n        }\n      }\n\n      let cacheItem;\n      if (textureCache.has(src, version)) {\n        if (this.currentSrcIsRetained) {\n          cacheItem = textureCache.get(src, version);\n        } else {\n          cacheItem = textureCache.retain(src, version);\n        }\n      } else {\n        const inflightKey = textureCache.key(src, version);\n\n        if (src === \"error\") {\n          cacheItem = errorCacheItem;\n        } else if (inflightTextures.has(inflightKey)) {\n          await inflightTextures.get(inflightKey);\n          cacheItem = textureCache.retain(src, version);\n        } else {\n          let promise;\n          if (contentType.includes(\"image/gif\")) {\n            promise = createGIFTexture(src);\n          } else if (contentType.includes(\"image/basis\")) {\n            promise = createBasisTexture(src);\n          } else if (contentType.includes(\"image/ktx2\")) {\n            promise = createKTX2Texture(src);\n          } else if (contentType.startsWith(\"image/\")) {\n            promise = createImageTexture(src);\n          } else {\n            throw new Error(`Unknown image content type: ${contentType}`);\n          }\n          inflightTextures.set(inflightKey, promise);\n          texture = await promise;\n          inflightTextures.delete(inflightKey);\n          cacheItem = textureCache.set(src, version, texture);\n        }\n\n        // No way to cancel promises, so if src has changed or this entity was removed while we were creating the texture just throw it away.\n        if (this.data.src !== src || this.data.version !== version || !this.el.parentNode) {\n          textureCache.release(src, version);\n          return;\n        }\n      }\n\n      texture = cacheItem.texture;\n      ratio = cacheItem.ratio;\n\n      this.currentSrcIsRetained = true;\n    } catch (e) {\n      console.error(\"Error loading image\", this.data.src, e);\n      texture = errorTexture;\n      this.currentSrcIsRetained = false;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n      material.toneMapped = false;\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n\n        // Flip uvs on the geometry\n        if (!texture.flipY) {\n          const uvs = geometry.attributes.uv.array;\n\n          for (let i = 1; i < uvs.length; i += 2) {\n            uvs[i] = 1 - uvs[i];\n          }\n        }\n      } else {\n        geometry = createPlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    if (texture == errorTexture) {\n      this.mesh.material.transparent = true;\n    } else {\n      // if transparency setting isnt explicitly defined, default to on for all gifs, and basis textures with alpha\n      switch (this.data.alphaMode) {\n        case \"opaque\":\n          this.mesh.material.transparent = false;\n          break;\n        case \"mask\":\n          this.mesh.material.transparent = false;\n          this.mesh.material.alphaTest = this.data.alphaCutoff;\n          break;\n        case \"blend\":\n        default:\n          this.mesh.material.transparent = true;\n          this.mesh.material.alphaTest = 0;\n      }\n    }\n\n    this.mesh.material.map = texture;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, ratio);\n    }\n\n    this.el.emit(\"image-loaded\", { src: this.data.src, projection: projection });\n  }\n});\n","import { disposeTexture } from \"./material-utils\";\n\nexport class TextureCache {\n  cache = new Map();\n\n  key(src, version) {\n    return `${src}_${version}`;\n  }\n\n  set(src, version, texture) {\n    const image = texture.image;\n    this.cache.set(this.key(src, version), {\n      texture,\n      ratio: (image.videoHeight || image.height) / (image.videoWidth || image.width),\n      count: 0\n    });\n    return this.retain(src, version);\n  }\n\n  has(src, version) {\n    return this.cache.has(this.key(src, version));\n  }\n\n  get(src, version) {\n    return this.cache.get(this.key(src, version));\n  }\n\n  retain(src, version) {\n    const cacheItem = this.cache.get(this.key(src, version));\n    cacheItem.count++;\n    // console.log(\"retain\", src, cacheItem.count);\n    return cacheItem;\n  }\n\n  release(src, version) {\n    const cacheItem = this.cache.get(this.key(src, version));\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached texture src ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    // console.log(\"release\", src, cacheItem.count);\n    if (cacheItem.count <= 0) {\n      // Unload the video element to prevent it from continuing to play in the background\n      disposeTexture(cacheItem.texture);\n      this.cache.delete(this.key(src, version));\n    }\n  }\n}\n","export const MAX_VOLUME_LABELS = 21;\nexport const MAX_GAIN_MULTIPLIER = 8;\nexport const SMALL_GAIN_STEP = 1 / (MAX_VOLUME_LABELS / 2);\nexport const SMALL_LEVEL_STEP = 1 / (MAX_GAIN_MULTIPLIER / 2);\nexport const BIG_GAIN_STEP = (MAX_GAIN_MULTIPLIER - 1) / (MAX_VOLUME_LABELS / 2);\nexport const BIG_LEVEL_STEP = 1;\nexport const DEFAULT_VOLUME_BAR_MULTIPLIER = 1.0;\n\nexport function calcGainStepUp(gainMultiplier) {\n  return gainMultiplier > 1 - SMALL_GAIN_STEP ? BIG_GAIN_STEP : SMALL_GAIN_STEP;\n}\n\nexport function calcGainStepDown(gainMultiplier) {\n  return gainMultiplier > 1 + SMALL_GAIN_STEP ? BIG_GAIN_STEP : SMALL_GAIN_STEP;\n}\n\nexport function calcLevel(gainMultiplier) {\n  return Math.min(\n    MAX_VOLUME_LABELS - 1,\n    gainMultiplier <= 1.001\n      ? Math.floor(gainMultiplier / SMALL_GAIN_STEP)\n      : Math.floor(MAX_VOLUME_LABELS / 2 + (gainMultiplier - 1) / BIG_GAIN_STEP)\n  );\n}\n\nexport function calcGainMultiplier(level) {\n  return Math.min(\n    MAX_GAIN_MULTIPLIER,\n    level <= MAX_VOLUME_LABELS / 2 ? level * SMALL_GAIN_STEP : 1 + (level - MAX_VOLUME_LABELS / 2) * BIG_GAIN_STEP\n  );\n}\n\nexport function updateAvatarVolumesPref(displayName, gainMultiplier, muted) {\n  const avatarVoiceLevels = APP.store.state.preferences.avatarVoiceLevels || {};\n  avatarVoiceLevels[displayName] = {\n    gainMultiplier,\n    muted\n  };\n  APP.store.update({\n    preferences: {\n      avatarVoiceLevels: avatarVoiceLevels\n    }\n  });\n}\n\nexport function getAvatarVolumePref(displayName) {\n  return APP.store.state.preferences.avatarVoiceLevels?.[displayName];\n}\n","import { updateAudioSettings } from \"../update-audio-settings\";\nimport { VOLUME_LABELS } from \"./media-video\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport {\n  calcLevel,\n  calcGainStepDown,\n  calcGainStepUp,\n  DEFAULT_VOLUME_BAR_MULTIPLIER,\n  MAX_GAIN_MULTIPLIER,\n  updateAvatarVolumesPref,\n  getAvatarVolumePref\n} from \"../utils/avatar-volume-utils\";\n\nAFRAME.registerComponent(\"avatar-volume-controls\", {\n  init() {\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.volumeUpButton = this.el.querySelector(\".avatar-volume-up-button\");\n    this.volumeDownButton = this.el.querySelector(\".avatar-volume-down-button\");\n    this.muteButton = this.el.querySelector(\".avatar-mute-button\");\n    this.volumeLabel = this.el.querySelector(\".avatar-volume-label\");\n    this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n    this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n    this.update = this.update.bind(this);\n    this.normalizer = null;\n    window.APP.store.addEventListener(\"statechanged\", this.update);\n    this.audioEl = this.el.parentEl.parentEl.querySelector(\"[avatar-audio-source]\");\n    this.playerInfo = findAncestorWithComponent(this.el, \"player-info\").components[\"player-info\"];\n    this.onRemoteMuteUpdated = this.onRemoteMuteUpdated.bind(this);\n    this.playerInfo.el.addEventListener(\"remote_mute_updated\", this.onRemoteMuteUpdated);\n    this.muteButton.object3D.visible = this.playerInfo.data.muted;\n    const volumePref = getAvatarVolumePref(this.playerInfo.displayName);\n    this.updateGainMultiplier(volumePref === undefined ? DEFAULT_VOLUME_BAR_MULTIPLIER : volumePref.gainMultiplier);\n    this.updateLocalMuted(volumePref === undefined ? false : volumePref.muted);\n  },\n  remove() {\n    APP.gainMultipliers.delete(this.audioEl);\n    window.APP.store.removeEventListener(\"statechanged\", this.update);\n    this.playerInfo.el.removeEventListener(\"remote_mute_updated\", this.onRemoteMuteUpdated);\n  },\n\n  updateGainMultiplier(gainMultiplier, updatePref = false) {\n    APP.gainMultipliers.set(this.audioEl, gainMultiplier);\n    const audio = APP.audios.get(this.audioEl);\n    if (audio) {\n      updateAudioSettings(this.audioEl, audio);\n    }\n    this.updateVolumeLabel();\n    this.el.emit(\"gain_multiplier_updated\", { gainMultiplier });\n    const isLocalMuted = APP.mutedState.has(this.audioEl);\n    updatePref && updateAvatarVolumesPref(this.playerInfo.displayName, gainMultiplier, isLocalMuted);\n  },\n\n  updateLocalMuted(muted, updatePref = false) {\n    if (muted === true) {\n      APP.mutedState.add(this.audioEl);\n    } else {\n      APP.mutedState.delete(this.audioEl);\n    }\n    const audio = APP.audios.get(this.audioEl);\n    if (audio) {\n      updateAudioSettings(this.audioEl, audio);\n    }\n    this.updateVolumeLabel();\n    this.el.emit(\"local_muted_updated\", { muted });\n    const gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const isLocalMuted = APP.mutedState.has(this.audioEl);\n    updatePref && updateAvatarVolumesPref(this.playerInfo.displayName, gainMultiplier, isLocalMuted);\n  },\n\n  volumeUp() {\n    let gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const step = calcGainStepUp(gainMultiplier);\n    gainMultiplier = THREE.MathUtils.clamp(gainMultiplier + step, 0, MAX_GAIN_MULTIPLIER);\n    this.updateGainMultiplier(gainMultiplier, true);\n  },\n\n  volumeDown() {\n    let gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const step = -calcGainStepDown(gainMultiplier);\n    gainMultiplier = THREE.MathUtils.clamp(gainMultiplier + step, 0, MAX_GAIN_MULTIPLIER);\n    this.updateGainMultiplier(gainMultiplier, true);\n  },\n\n  updateVolumeLabel() {\n    const gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const isLocalMuted = APP.mutedState.has(this.audioEl);\n    const numBars = calcLevel(gainMultiplier);\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      gainMultiplier === 0 || isLocalMuted ? \"Muted\" : VOLUME_LABELS[numBars]\n    );\n  },\n\n  onRemoteMuteUpdated({ detail: { muted } }) {\n    if (!this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"mute_users\")) return;\n    this.muteButton.object3D.traverse(obj => {\n      obj.visible = !muted;\n    });\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"pinch-to-move\", {\n  schema: {\n    speed: { default: 0.25 }\n  },\n  init() {\n    this.axis = [0, 0];\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const pinch = userinput.get(paths.device.touchscreen.pinchDelta);\n    if (pinch) {\n      this.axis[1] = pinch * this.data.speed;\n      this.el.emit(\"move\", { axis: this.axis });\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst rotatePitchAndYaw = (function() {\n  const opq = new THREE.Quaternion();\n  const owq = new THREE.Quaternion();\n  const oq = new THREE.Quaternion();\n  const pq = new THREE.Quaternion();\n  const yq = new THREE.Quaternion();\n  const q = new THREE.Quaternion();\n  const right = new THREE.Vector3();\n  const v = new THREE.Vector3();\n  const UP = new THREE.Vector3(0, 1, 0);\n\n  return function rotatePitchAndYaw(o, p, y) {\n    o.parent.updateMatrices();\n    o.updateMatrices();\n    o.parent.getWorldQuaternion(opq);\n    o.getWorldQuaternion(owq);\n    oq.copy(o.quaternion);\n    v.set(0, 1, 0).applyQuaternion(oq);\n    const initialUpDot = v.dot(UP);\n    v.set(0, 0, 1).applyQuaternion(oq);\n    const initialForwardDotUp = Math.abs(v.dot(UP));\n    right.set(1, 0, 0).applyQuaternion(owq);\n    pq.setFromAxisAngle(right, p);\n    yq.setFromAxisAngle(UP, y);\n\n    q.copy(owq)\n      .premultiply(pq)\n      .premultiply(yq)\n      .premultiply(opq.invert());\n    v.set(0, 1, 0).applyQuaternion(q);\n    const newUpDot = v.dot(UP);\n    v.set(0, 0, 1).applyQuaternion(q);\n    const newForwardDotUp = Math.abs(v.dot(UP));\n    // Ensure our pitch is in an accepted range and our head would not be flipped upside down\n    if ((newForwardDotUp > 0.9 && newForwardDotUp > initialForwardDotUp) || (newUpDot < 0 && newUpDot < initialUpDot)) {\n      // TODO: Apply a partial rotation that does not exceed the bounds for nicer UX\n      return;\n    } else {\n      o.quaternion.copy(q);\n      o.matrixNeedsUpdate = true;\n      o.updateMatrices();\n    }\n  };\n})();\n\nlet uiRoot;\nlet scenePreviewNode;\nAFRAME.registerComponent(\"pitch-yaw-rotator\", {\n  init() {\n    this.pendingXRotation = 0;\n    this.el.sceneEl.addEventListener(\"rotateX\", e => {\n      this.pendingXRotation += e.detail;\n    });\n    this.on = true;\n  },\n\n  tick() {\n    if (this.on) {\n      const scene = AFRAME.scenes[0];\n      const userinput = scene.systems.userinput;\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\n      scenePreviewNode = scenePreviewNode || document.getElementById(\"scene-preview-node\");\n      const lobby = !scene.is(\"entered\");\n      const isGhost = lobby && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n      const cameraDelta = userinput.get(lobby ? paths.actions.lobbyCameraDelta : paths.actions.cameraDelta);\n      if (cameraDelta) {\n        rotatePitchAndYaw(\n          lobby && !isGhost ? scenePreviewNode.object3D : this.el.object3D,\n          this.pendingXRotation + cameraDelta[1],\n          cameraDelta[0]\n        );\n      } else if (this.pendingXRotation) {\n        rotatePitchAndYaw(lobby && !isGhost ? scenePreviewNode.object3D : this.el.object3D, this.pendingXRotation, 0);\n      }\n    }\n    this.pendingXRotation = 0;\n  }\n});\n","import { computeLocalBoundingBox } from \"../utils/auto-box-collider.js\";\nimport { setMatrixWorld } from \"../utils/three-utils\";\n\nconst MIN_SCALE = 0.05;\nconst MAX_SCALE = 4;\nconst ROTATE_Y = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 1, 0), Math.PI);\n\nconst updateFromLocalBB = (function() {\n  const currentPosition = new THREE.Vector3();\n  const currentScale = new THREE.Vector3();\n  return function updateFromLocalBB(object3D, localBox, center, halfExtents, offsetToCenter) {\n    object3D.updateMatrices();\n    const min = localBox.min;\n    const max = localBox.max;\n    center\n      .addVectors(min, max)\n      .multiplyScalar(0.5)\n      .applyMatrix4(object3D.matrixWorld);\n    currentScale.setFromMatrixScale(object3D.matrixWorld);\n    halfExtents\n      .subVectors(max, min)\n      .multiplyScalar(0.5)\n      .multiply(currentScale);\n    currentPosition.setFromMatrixPosition(object3D.matrixWorld);\n    offsetToCenter.subVectors(center, currentPosition);\n  };\n})();\n\nconst updateTargetRotationFromCamera = (function() {\n  const right = new THREE.Vector3();\n  const up = new THREE.Vector3();\n  const back = new THREE.Vector3();\n  const forward = new THREE.Vector3();\n  const rotation = new THREE.Matrix4();\n  return function updateTargetRotationFromCamera(\n    cameraPosition,\n    cameraRotation,\n    isVR,\n    vrFocalPoint,\n    desiredTargetQuaternion\n  ) {\n    if (!isVR) {\n      back\n        .set(0, 0, 1)\n        .applyMatrix4(cameraRotation)\n        .normalize();\n    } else {\n      back.subVectors(cameraPosition, vrFocalPoint).normalize();\n    }\n    up.set(0, 1, 0);\n    forward.copy(back).multiplyScalar(-1);\n    right.crossVectors(forward, up).normalize();\n    up.crossVectors(right, forward);\n    rotation.makeBasis(right, up, back);\n    desiredTargetQuaternion.setFromRotationMatrix(rotation);\n  };\n})();\n\nconst positionAtBorderComponents = [];\nAFRAME.registerComponent(\"position-at-border\", {\n  multiple: true,\n  schema: {\n    target: { type: \"string\" },\n    isFlat: { default: false },\n    animate: { default: true },\n    scale: { default: true }\n  },\n\n  init() {\n    this.ready = false;\n    this.didInit = false;\n    this.tick2 = this.tick2.bind(this);\n    this.doInit = this.doInit.bind(this);\n    positionAtBorderComponents.push(this);\n  },\n\n  doInit() {\n    this.didInit = true;\n    this.cam = document.getElementById(\"viewing-camera\").object3DMap.camera;\n    if (!this.data.target) {\n      console.error(\"No target for position-at-border on element:\", this.el);\n      return;\n    }\n    const targetEl = this.el.querySelector(this.data.target);\n    if (!targetEl) {\n      console.error(`Could not find ${this.data.target} underneath element:`, this.el);\n      return;\n    }\n    if (this.data.animate) {\n      this.didRegisterWithAnimationSystem = true;\n      this.el.sceneEl.systems[\"hubs-systems\"].menuAnimationSystem.register(this, targetEl, this.data.scale);\n    }\n    this.target = targetEl.object3D;\n    this.wasVisible = false;\n    this.previousMesh = null;\n    this.meshLocalBoundingBox = new THREE.Box3();\n    this.meshCenter = new THREE.Vector3();\n    this.meshHalfExtents = new THREE.Vector3();\n    this.meshOffsetToCenter = new THREE.Vector3();\n    this.isTargetBoundingBoxDirty = true;\n    this.targetLocalBoundingBox = new THREE.Box3();\n    this.targetCenter = new THREE.Vector3();\n    this.targetHalfExtents = new THREE.Vector3();\n    this.targetOffsetToCenter = new THREE.Vector3();\n    this.ready = true;\n  },\n\n  remove() {\n    if (this.didRegisterWithAnimationSystem) {\n      this.el.sceneEl.systems[\"hubs-systems\"].menuAnimationSystem.unregister(this);\n    }\n    positionAtBorderComponents.splice(positionAtBorderComponents.indexOf(this), 1);\n  },\n\n  markDirty() {\n    this.isTargetBoundingBoxDirty = true;\n  },\n\n  tick2: (function() {\n    const cameraPosition = new THREE.Vector3();\n    const cameraRotation = new THREE.Matrix4();\n    const centerToCamera = new THREE.Vector3();\n    const intersectionToCam = new THREE.Vector3();\n    const desiredCenterPoint = new THREE.Vector3();\n    const desiredTargetPosition = new THREE.Vector3();\n    const desiredTargetQuaternion = new THREE.Quaternion();\n    const currentTargetScale = new THREE.Vector3();\n    const desiredTargetScale = new THREE.Vector3();\n    const desiredTargetTransform = new THREE.Matrix4();\n    const centerToBorder = new THREE.Vector3();\n    const currentMeshRotation = new THREE.Matrix4();\n    const currentMeshScale = new THREE.Vector3();\n    const meshForward = new THREE.Vector3();\n    const boxCorners = new THREE.Vector3();\n    return function tick2() {\n      if (!this.didInit) {\n        this.doInit();\n      }\n      if (!this.ready) {\n        return;\n      }\n      const currentMesh = this.el.getObject3D(\"mesh\");\n      if (!currentMesh) {\n        return;\n      }\n      const isVisible = this.target.visible;\n      const isOpening = isVisible && !this.wasVisible;\n      this.wasVisible = isVisible;\n      if (!isOpening) {\n        return;\n      }\n      if (this.isTargetBoundingBoxDirty) {\n        computeLocalBoundingBox(this.target, this.targetLocalBoundingBox, true);\n        if (this.targetLocalBoundingBox.min.x === Infinity) {\n          // May be no visible elements in the target. Nothing to do in this case\n          return;\n        }\n        this.isTargetBoundingBoxDirty = false;\n      }\n      updateFromLocalBB(\n        this.target,\n        this.targetLocalBoundingBox,\n        this.targetCenter,\n        this.targetHalfExtents,\n        this.targetOffsetToCenter\n      );\n      const isMeshChanged = currentMesh !== this.previousMesh;\n      if (isMeshChanged) {\n        computeLocalBoundingBox(currentMesh, this.meshLocalBoundingBox, true);\n        this.previousMesh = currentMesh;\n      }\n      updateFromLocalBB(\n        currentMesh,\n        this.meshLocalBoundingBox,\n        this.meshCenter,\n        this.meshHalfExtents,\n        this.meshOffsetToCenter\n      );\n      currentMeshRotation.extractRotation(currentMesh.matrixWorld);\n      meshForward.set(0, 0, -1).applyMatrix4(currentMeshRotation);\n      this.cam.updateMatrices();\n      cameraPosition.setFromMatrixPosition(this.cam.matrixWorld);\n      cameraRotation.extractRotation(this.cam.matrixWorld);\n      centerToCamera.subVectors(cameraPosition, this.meshCenter);\n      const needsYRotate = this.data.isFlat && meshForward.dot(centerToCamera) > 0;\n      const intersection = this.el.sceneEl.systems.interaction.getActiveIntersection();\n      const meshSphereRadius =\n        boxCorners\n          .subVectors(this.meshLocalBoundingBox.max, this.meshLocalBoundingBox.min)\n          .multiply(currentMeshScale.setFromMatrixScale(currentMesh.matrixWorld))\n          .length() * 0.5;\n      if (this.data.isFlat) {\n        // Put in front of the flat media, on the side where the user is\n        desiredCenterPoint.copy(this.meshCenter).add(\n          centerToBorder\n            .set(0, 0, this.meshHalfExtents.z + this.targetHalfExtents.z + 0.02)\n            .multiplyScalar(needsYRotate ? -1 : 1)\n            .applyMatrix4(currentMeshRotation)\n        );\n      } else if (meshSphereRadius + 2 > centerToCamera.length()) {\n        // Inside the bounding sphere, put it close to the intersection, or close to the camera if there is no intersection\n        desiredCenterPoint.lerpVectors(\n          cameraPosition,\n          intersection ? intersection.point : this.meshCenter,\n          intersection ? 0.8 : 0.25\n        );\n      } else if (intersection) {\n        // Put it in the line towards the intersection, outside the bounding sphere\n        const distanceToSphere = centerToCamera.length() - meshSphereRadius;\n        intersectionToCam.subVectors(intersection.point, cameraPosition);\n        desiredCenterPoint.copy(cameraPosition).add(intersectionToCam.normalize().multiplyScalar(distanceToSphere));\n      } else {\n        // Put it on the bounding sphere\n        centerToCamera.normalize().multiplyScalar(meshSphereRadius);\n        desiredCenterPoint.copy(this.meshCenter).add(centerToCamera);\n      }\n      if (this.data.scale) {\n        const distanceToCenter = centerToCamera.subVectors(cameraPosition, desiredCenterPoint).length();\n        desiredTargetScale.setScalar(THREE.MathUtils.clamp(0.45 * distanceToCenter, MIN_SCALE, MAX_SCALE));\n      } else {\n        desiredTargetScale.setFromMatrixScale(this.target.matrixWorld);\n      }\n      if (this.data.scale) {\n        desiredTargetPosition\n          .copy(desiredCenterPoint)\n          .sub(\n            this.targetOffsetToCenter\n              .divide(currentTargetScale.setFromMatrixScale(this.target.matrixWorld))\n              .multiply(desiredTargetScale)\n          );\n      } else {\n        desiredTargetPosition.copy(this.meshCenter).add(\n          centerToBorder\n            .set(0, 0, this.meshHalfExtents.z + this.targetHalfExtents.z + 0.02)\n            .multiplyScalar(needsYRotate ? -1 : 1)\n            .applyMatrix4(currentMeshRotation)\n        );\n      }\n      if (this.data.isFlat) {\n        desiredTargetQuaternion.setFromRotationMatrix(currentMeshRotation);\n        if (needsYRotate) {\n          desiredTargetQuaternion.multiply(ROTATE_Y);\n        }\n      } else {\n        updateTargetRotationFromCamera(\n          cameraPosition,\n          cameraRotation,\n          this.el.sceneEl.is(\"vr-mode\"),\n          desiredTargetPosition,\n          desiredTargetQuaternion\n        );\n      }\n      desiredTargetTransform.compose(\n        desiredTargetPosition,\n        desiredTargetQuaternion,\n        desiredTargetScale\n      );\n      setMatrixWorld(this.target, desiredTargetTransform);\n    };\n  })()\n});\n\nexport class PositionAtBorderSystem {\n  constructor() {}\n  tick() {\n    for (let i = 0; i < positionAtBorderComponents.length; i++) {\n      positionAtBorderComponents[i].tick2();\n    }\n  }\n}\n","import { addComponent, removeComponent } from \"bitecs\";\nimport { Pinnable, Pinned } from \"../bit-components\";\n\nAFRAME.registerComponent(\"pinnable\", {\n  schema: {\n    pinned: { default: false }\n  },\n\n  init() {\n    this._persist = this._persist.bind(this);\n    this._persistAndAnimate = this._persistAndAnimate.bind(this);\n\n    // Persist when media is refreshed since the version will be bumped.\n    this.el.addEventListener(\"media_refreshed\", this._persistAndAnimate);\n\n    this.el.addEventListener(\"owned-pager-page-changed\", this._persist);\n\n    this.el.addEventListener(\"owned-video-state-changed\", this._persistAndAnimate);\n\n    addComponent(APP.world, Pinnable, this.el.object3D.eid);\n  },\n\n  update() {\n    this._animate();\n\n    if (this.data.pinned) {\n      addComponent(APP.world, Pinned, this.el.object3D.eid);\n    } else {\n      removeComponent(APP.world, Pinned, this.el.object3D.eid);\n    }\n  },\n\n  _persistAndAnimate() {\n    this._persist();\n    this._animate();\n  },\n\n  _persist() {\n    // Re-pin or unpin entity to reflect state changes.\n    window.APP.pinningHelper.setPinned(this.el, this.data.pinned);\n  },\n\n  _isMine() {\n    return this.el.components.networked?.data && NAF.utils.isMine(this.el);\n  },\n\n  _animate() {\n    const isAnimationRunning =\n      this.el.components[\"animation__pin-start\"]?.animationIsPlaying ||\n      this.el.components[\"animation__pin-end\"]?.animationIsPlaying;\n\n    if (this._isMine() && this.data.pinned && !isAnimationRunning) {\n      this.el.removeAttribute(\"animation__pin-start\");\n      this.el.removeAttribute(\"animation__pin-end\");\n      const currentScale = this.el.object3D.scale;\n\n      this.el.setAttribute(\"animation__pin-start\", {\n        property: \"scale\",\n        dur: 200,\n        from: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        to: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        easing: \"easeOutElastic\"\n      });\n\n      this.el.setAttribute(\"animation__pin-end\", {\n        property: \"scale\",\n        delay: 200,\n        dur: 200,\n        from: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        to: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        easing: \"easeOutElastic\"\n      });\n\n      if (this.el.components[\"body-helper\"] && !this.el.sceneEl.systems.interaction.isHeld(this.el)) {\n        this.el.setAttribute(\"body-helper\", { type: \"kinematic\" });\n      }\n    }\n  },\n\n  tick() {\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n    const isMine = this._isMine();\n\n    let didFireThisFrame = false;\n    if (!isHeld && this.wasHeld && isMine) {\n      didFireThisFrame = true;\n      this._persistAndAnimate();\n    }\n\n    this.wasHeld = isHeld;\n\n    this.transformObjectSystem = this.transformObjectSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n    const transforming = this.transformObjectSystem.transforming && this.transformObjectSystem.target.el === this.el;\n    if (!didFireThisFrame && !transforming && this.wasTransforming && isMine) {\n      this._persistAndAnimate();\n    }\n    this.wasTransforming = transforming;\n  }\n});\n","import { getPromotionTokenForFile } from \"../utils/media-utils\";\nimport { SOUND_PIN } from \"../systems/sound-effects-system\";\nimport { applyThemeToTextButton } from \"../utils/theme\";\n\nAFRAME.registerComponent(\"pin-networked-object-button\", {\n  schema: {\n    // Selector for label informing users about Discord bridging of pins.\n    tipSelector: { type: \"string\" },\n\n    // Selector for label to change when pinned/unpinned, must be sibling of this components element\n    labelSelector: { type: \"string\" }\n  },\n\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    this.tipEl = this.el.parentNode.querySelector(this.data.tipSelector);\n    this.labelEl = this.el.parentNode.querySelector(this.data.labelSelector);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n\n    this.onHovered = () => {\n      this.hovering = true;\n      this._updateUI();\n    };\n\n    this.onUnhovered = () => {\n      this.hovering = false;\n      this._updateUI();\n    };\n\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      const wasPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n      window.APP.pinningHelper.setPinned(this.targetEl, !wasPinned);\n      if (!wasPinned) {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PIN);\n      }\n    };\n\n    APP.store.addEventListener(\"themechanged\", this._updateUI);\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n    this.el.object3D.addEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.addEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n    this.el.object3D.removeEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _discordBridges() {\n    return window.APP.hubChannel.discordBridges();\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    const { fileIsOwned, fileId } = this.targetEl.components[\"media-loader\"].data;\n    const canPin =\n      window.APP.hubChannel.can(\"pin_objects\") && !!(fileIsOwned || (fileId && getPromotionTokenForFile(fileId)));\n    this.el.object3D.visible = canPin;\n    this.labelEl.object3D.visible = canPin;\n\n    const isPinned = this.targetEl.getAttribute(\"pinnable\") && this.targetEl.getAttribute(\"pinnable\").pinned;\n    const discordBridges = this._discordBridges();\n    this.tipEl.object3D.visible = !!(canPin && !isPinned && this.hovering && discordBridges.length > 0);\n\n    if (!canPin) return;\n    this.labelEl.setAttribute(\"text\", \"value\", isPinned ? \"un-pin\" : \"pin\");\n    applyThemeToTextButton(this.el, isPinned);\n  }\n});\n","import { cloneMedia } from \"../utils/media-utils\";\nimport { closeExistingMediaMirror } from \"../utils/media-utils\";\n\nAFRAME.registerComponent(\"mirror-media-button\", {\n  init() {\n    this.updateSrc = () => {\n      if (!this.targetEl.parentNode) return; // If removed\n      this.src = this.targetEl.components[\"media-loader\"].data.src;\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n\n    this.onClick = async () => {\n      const mirrorTarget = document.querySelector(\"#media-mirror-target\");\n\n      await closeExistingMediaMirror();\n\n      const { entity } = cloneMedia(this.targetEl, \"#linked-media\", this.src, false, true, mirrorTarget);\n\n      entity.object3D.scale.set(0.75, 0.75, 0.75);\n      entity.object3D.matrixNeedsUpdate = true;\n\n      mirrorTarget.parentEl.components[\"follow-in-fov\"].reset();\n      mirrorTarget.parentEl.object3D.visible = true;\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { closeExistingMediaMirror } from \"../utils/media-utils\";\n\nAFRAME.registerComponent(\"close-mirrored-media-button\", {\n  init() {\n    this.onClick = async () => {\n      this.el.object3D.visible = false; // Hide button immediately on click\n      await closeExistingMediaMirror();\n      this.el.object3D.visible = true;\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { defineQuery, hasComponent } from \"bitecs\";\nimport { $isStringType, NetworkedMediaFrame } from \"../bit-components\";\n\nconst queries = new Map();\nexport function anyEntityWith(world, component) {\n  if (!queries.has(component)) {\n    queries.set(component, defineQuery([component]));\n  }\n\n  const eids = queries.get(component)(world);\n  return eids.length && eids[0];\n}\n\nexport function hasAnyComponent(world, components, eid) {\n  for (let i = 0; i < components.length; i++) {\n    if (hasComponent(world, components[i], eid)) return true;\n  }\n  return false;\n}\n\n// TODO HACK gettting internal bitecs symbol, should expose createShadow\nconst $parentArray = Object.getOwnPropertySymbols(NetworkedMediaFrame.scale).find(s => s.description == \"parentArray\");\nconst $storeFlattened = Object.getOwnPropertySymbols(NetworkedMediaFrame).find(s => s.description == \"storeFlattened\");\n\nconst createShadow = (store, key) => {\n  if (!ArrayBuffer.isView(store)) {\n    const shadowStore = store[$parentArray].slice(0);\n    store[key] = store.map((_, eid) => {\n      const { length } = store[eid];\n      const start = length * eid;\n      const end = start + length;\n      return shadowStore.subarray(start, end);\n    });\n  } else {\n    store[key] = store.slice(0);\n  }\n  return key;\n};\n\n// TODO this array encoding is silly, use a buffer once we are not sending JSON\nexport function defineNetworkSchema(Component) {\n  const componentProps = Component[$storeFlattened];\n  const shadowSymbols = componentProps.map((prop, i) => {\n    return createShadow(prop, Symbol(`netshadow-${i}`));\n  });\n\n  return {\n    serialize(_world, eid, data, isFullSync = false) {\n      const changedPids = [];\n      data.push(changedPids);\n      for (let pid = 0; pid < componentProps.length; pid++) {\n        const prop = componentProps[pid];\n        const shadow = prop[shadowSymbols[pid]];\n        // if property is an array\n        if (ArrayBuffer.isView(prop[eid])) {\n          for (let i = 0; i < prop[eid].length; i++) {\n            if (isFullSync || shadow[eid][i] !== prop[eid][i]) {\n              changedPids.push(pid);\n              // TODO handle EID type and arrays of strings\n              data.push(Array.from(prop[eid]));\n              break;\n            }\n          }\n          if (!isFullSync) shadow[eid].set(prop[eid]);\n        } else {\n          if (isFullSync || shadow[eid] !== prop[eid]) {\n            changedPids.push(pid);\n            // TODO handle EID type\n            data.push(prop[$isStringType] ? APP.getString(prop[eid]) : prop[eid]);\n          }\n          if (!isFullSync) shadow[eid] = prop[eid];\n        }\n      }\n      if (!changedPids.length) {\n        data.pop();\n        return false;\n      }\n      return true;\n    },\n    deserialize(_world, eid, data) {\n      const updatedPids = data[data.cursor++];\n      for (let i = 0; i < updatedPids.length; i++) {\n        const pid = updatedPids[i];\n        const prop = componentProps[pid];\n        const shadow = prop[shadowSymbols[pid]];\n        // TODO updating the shadow here is slightly odd. Should taking ownership do it?\n        if (ArrayBuffer.isView(prop[eid])) {\n          prop[eid].set(data[data.cursor++]);\n          shadow[eid].set(prop[eid]);\n        } else {\n          const val = data[data.cursor++];\n          prop[eid] = prop[$isStringType] ? APP.getSid(val) : val;\n          shadow[eid] = prop[eid];\n        }\n      }\n    }\n  };\n}\n","import { CameraTool, MyCameraTool } from \"../bit-components\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\nimport { findComponentsInNearestAncestor } from \"../utils/scene-graph\";\n\nconst tmpPos = new THREE.Vector3();\nAFRAME.registerComponent(\"camera-focus-button\", {\n  schema: {\n    track: { default: false },\n    selector: { default: null }\n  },\n\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      if (this.data.selector) {\n        this.targetEl = networkedEl.querySelector(this.data.selector);\n      } else {\n        this.targetEl = networkedEl;\n      }\n    });\n\n    this.onClick = () => {\n      const myCam = anyEntityWith(APP.world, MyCameraTool);\n      if (!myCam) return;\n\n      if (this.data.track) {\n        const tracking = CameraTool.trackTarget[myCam];\n        CameraTool.trackTarget[myCam] = tracking === this.targetEl.eid ? 0 : this.targetEl.eid;\n      } else {\n        this.targetEl.object3D.getWorldPosition(tmpPos);\n        APP.world.eid2obj.get(myCam).lookAt(tmpPos);\n      }\n    };\n\n    this.menuPlacementRoots = findComponentsInNearestAncestor(this.el, \"position-at-border\");\n  },\n\n  tick() {\n    const isVisible = this.el.object3D.visible;\n    const shouldBeVisible = !!anyEntityWith(APP.world, MyCameraTool);\n    if (isVisible !== shouldBeVisible) {\n      this.el.object3D.visible = shouldBeVisible;\n      for (let i = 0; i < this.menuPlacementRoots.length; i++) {\n        this.menuPlacementRoots[i].markDirty();\n      }\n    }\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nAFRAME.registerComponent(\"unmute-video-button\", {\n  init() {\n    this.onClick = () => {\n      const videoEl = findAncestorWithComponent(this.el, \"media-video\");\n      const mediaVideo = videoEl.components[\"media-video\"];\n      if (!mediaVideo || !mediaVideo.video || !mediaVideo.videoMutedAt) return;\n\n      // iOS initially plays the sound and *then* mutes it, and sometimes a second video playing\n      // can break all sound in the app. (Likely a Safari bug.) Adding a delay before the unmute\n      // occurs seems to help with reducing this.\n      if (performance.now() - mediaVideo.videoMutedAt < 3000) {\n        return;\n      }\n\n      if (mediaVideo.video.muted) {\n        mediaVideo.video.muted = false;\n        this.el.setAttribute(\"visible\", false);\n      }\n    };\n  },\n\n  play() {\n    // Safari won't accept grab-start or even mousedown as user-initiated gestures,\n    // so we have to use a global touchstart event here.\n    document.addEventListener(\"touchstart\", this.onClick);\n  },\n\n  pause() {\n    document.removeEventListener(\"touchstart\", this.onClick);\n  }\n});\n","import { cloneMedia } from \"../utils/media-utils\";\nimport { guessContentType } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"clone-media-button\", {\n  init() {\n    this.updateSrc = () => {\n      if (!this.targetEl.parentNode) return; // If removed\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      this.el.object3D.visible = !!visible;\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n\n    this.onClick = () => {\n      const { entity } = cloneMedia(this.targetEl, \"#interactable-media\", this.src);\n\n      entity.object3D.scale.copy(this.targetEl.object3D.scale);\n      entity.object3D.matrixNeedsUpdate = true;\n\n      entity.setAttribute(\"offset-relative-to\", {\n        target: \"#avatar-pov-node\",\n        offset: { x: 0, y: 0, z: -1.5 * this.targetEl.object3D.scale.z }\n      });\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import screenfull from \"screenfull\";\nimport { isIOS } from \"./is-mobile\";\n\nlet hasEnteredFullScreenThisSession = false;\n\nfunction shouldShowFullScreen() {\n  // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n  return (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) && !isIOS() && screenfull.enabled;\n}\n\nexport function willRequireUserGesture() {\n  return !screenfull.isFullscreen && shouldShowFullScreen();\n}\n\nexport async function showFullScreenIfAvailable() {\n  if (shouldShowFullScreen() && !screenfull.isFullscreen) {\n    hasEnteredFullScreenThisSession = true;\n    await screenfull.request();\n  }\n}\n\nexport async function showFullScreenIfWasFullScreen() {\n  if (hasEnteredFullScreenThisSession && !screenfull.isFullscreen) {\n    await screenfull.request();\n  }\n}\n","import { willRequireUserGesture, showFullScreenIfAvailable } from \"./fullscreen\";\nimport screenfull from \"screenfull\";\n\nlet _isIn2DInterstitial = false;\nlet _exitAction = null;\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst getUserGesture = () => {\n  return new Promise(resolve => {\n    const scene = document.querySelector(\"a-scene\");\n    scene.addEventListener(\"2d-interstitial-gesture-complete\", resolve, { once: true });\n    scene.emit(\"2d-interstitial-gesture-required\");\n  });\n};\n\nexport async function handleExitTo2DInterstitial(isLower, exitAction, nonFullscreen) {\n  const scene = document.querySelector(\"a-scene\");\n  if (!scene.is(\"vr-mode\")) {\n    if (isMobileVR && willRequireUserGesture()) {\n      await getUserGesture();\n      await showFullScreenIfAvailable();\n    }\n\n    return;\n  }\n\n  _isIn2DInterstitial = true;\n  _exitAction = exitAction;\n\n  if (isMobileVR) {\n    await scene.exitVR();\n\n    if (!nonFullscreen) {\n      await getUserGesture();\n      await showFullScreenIfAvailable();\n    }\n  } else {\n    // Non-immersive browser, show notice\n    const vrNotice = document.querySelector(\".vr-notice\");\n    vrNotice.object3D.visible = true;\n    vrNotice.setAttribute(\"follow-in-fov\", {\n      angle: isLower ? 39 : -15\n    });\n  }\n}\n\nexport async function exit2DInterstitialAndEnterVR(force) {\n  if (!force && !_isIn2DInterstitial) {\n    return;\n  }\n\n  _isIn2DInterstitial = false;\n\n  document.querySelector(\".vr-notice\").object3D.visible = false;\n\n  const scene = document.querySelector(\"a-scene\");\n\n  if (isMobileVR) {\n    if (screenfull.isFullscreen) {\n      await screenfull.exit();\n      await getUserGesture();\n      await scene.enterVR();\n    } else {\n      await scene.enterVR();\n    }\n  } else {\n    if (!scene.is(\"vr-mode\")) {\n      await scene.enterVR();\n    }\n  }\n}\n\nexport function isIn2DInterstitial() {\n  return _isIn2DInterstitial;\n}\n\nexport async function forceExitFrom2DInterstitial() {\n  if (!_isIn2DInterstitial) return;\n\n  if (_exitAction) {\n    _exitAction();\n    _exitAction = null;\n  }\n\n  await exit2DInterstitialAndEnterVR();\n}\n","import { isLocalHubsUrl, isLocalHubsSceneUrl, isHubsRoomUrl, isLocalHubsAvatarUrl } from \"../utils/media-url-utils\";\nimport { guessContentType } from \"../utils/media-url-utils\";\nimport { handleExitTo2DInterstitial } from \"../utils/vr-interstitial\";\nimport { changeHub } from \"../change-hub\";\nimport { exists } from \"fs-extra\";\n\nAFRAME.registerComponent(\"open-media-button\", {\n  schema: {\n    onlyOpenLink: { type: \"boolean\" }\n  },\n  init() {\n    this.label = this.el.querySelector(\"[text]\");\n\n    this.updateSrc = async () => {\n      if (!this.targetEl.parentNode) return; // If removed\n      const mediaLoader = this.targetEl.components[\"media-loader\"].data;\n      const src = (this.src = (mediaLoader.mediaOptions && mediaLoader.mediaOptions.href) || mediaLoader.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      this.el.object3D.visible = !!visible;\n\n      if (visible) {\n        let label = \"open link\";\n        if (!this.data.onlyOpenLink) {\n          let hubId;\n          if (await isLocalHubsAvatarUrl(src)) {\n            label = \"use avatar\";\n          } else if ((await isLocalHubsSceneUrl(src)) && mayChangeScene) {\n            label = \"use scene\";\n          } else if ((hubId = await isHubsRoomUrl(src))) {\n            const url = new URL(src);\n            if (url.hash && window.APP.hub.hub_id === hubId) {\n              label = \"go to\";\n            } else {\n              label = \"visit room\";\n            }\n          }\n        }\n        this.label.setAttribute(\"text\", \"value\", label);\n      }\n    };\n\n    this.onClick = async () => {\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      const exitImmersive = async () => await handleExitTo2DInterstitial(false, () => {}, true);\n\n    let hubId;\n      if (this.data.onlyOpenLink) {\n        await exitImmersive();\n        window.open(this.src);\n      }\n      else if (await isLocalHubsAvatarUrl(this.src)) {\n        const avatarId = new URL(this.src).pathname.split(\"/\").pop();\n        window.APP.store.update({ profile: { avatarId } });\n        this.el.sceneEl.emit(\"avatar_updated\");\n      } else if ((await isLocalHubsSceneUrl(this.src)) && mayChangeScene) {\n        this.el.sceneEl.emit(\"scene_media_selected\", this.src);\n      } else if ((hubId = await isHubsRoomUrl(this.src))) {\n        const url = new URL(this.src);\n        if (url.hash && window.APP.hub.hub_id === hubId) {\n          // move to waypoint w/o writing to history\n          window.history.replaceState(null, null, window.location.href.split(\"#\")[0] + url.hash);\n        } else if (APP.store.state.preferences.fastRoomSwitching && isLocalHubsUrl(this.src)) {\n          // move to new room without page load or entry flow\n          changeHub(hubId);\n        } else {\n          await exitImmersive();\n          location.href = this.src;\n        }\n      } \n      //   else {\n      //   await exitImmersive();\n\t    //   const srcSplit = this.src.split(\"_\");\n      // \tif (srcSplit[0] === \"btn\") {\n\t    //     fnClickObj(this.src); \n      // \t} else {\n      // \t  window.open(this.src);\n\t    //   }\n      // } \n    };\n\n    //fnClickObj\n    // function fnClickObj(src) {\n    //   console.log(\"fnClickObj 시작\");\n      \n    //   if( (screen.width <= 640) || (window.matchMedia && window.matchMedia('only screen and (max-width: 640px)').matches)) {\n    //     //Mobile\n    //     document.getElementById(\"custom-popup-mobile\").style.display = \"none\";\n\n    //     var str = \"<table style='width:300px;' cellpadding='0' cellspacing='0' border='0'>\";\n    //     str += \"<tr><td><div align='center'><img src='https://metatest.nztoverse.com/img/guest_top_mobile.png' style='width:300px; height:50px;' id='btnClickClose-mobile'></div></td></tr>\";\n    //     str += \"<tr><td style='text-align:center; padding-top:0px; padding-bottom:0px;' align='center'><div align='center'><iframe src='https://metatest.nztoverse.com/_quiz.html' style='width:300px; height:400px;' frameborder=0 framespacing=0 marginheight=0 marginwidth=0 scrolling=yes vspace=0></iframe></div></td></tr>\";\n    //     str += \"</table>\";\n\t\t\n    //     document.getElementById(\"custom-popup-text-mobile\").innerHTML = str;\n    //     document.getElementById(\"custom-popup-mobile\").style.display = \"flex\";\n    //     document.getElementById('btnClickClose-mobile').addEventListener(\"click\", function() { document.getElementById(\"custom-popup-mobile\").style.display = \"none\"; });\n    //   } else {\n    //     document.getElementById(\"custom-popup\").style.display = \"none\";\n\n    //     var str = \"<table style='width:800px;' cellpadding='0' cellspacing='0' border='0'>\";\n    //     str += \"<tr><td><div align='center'><img src='https://metatest.nztoverse.com/img/guest_top_pc.png' style='width:800px; height:50px;' id='btnClickClose'></div></td></tr>\";\n    //     str += \"<tr><td style='text-align:center; padding-top:0px; padding-bottom:0px;' align='center'><div align='center'><iframe src='https://metatest.nztoverse.com/_quiz.html' style='width:800px; height:600px;' frameborder=0 framespacing=0 marginheight=0 marginwidth=0 scrolling=yes vspace=0></iframe></div></td></tr>\";\n    //     str += \"</table>\";\n\n    //     document.getElementById(\"custom-popup-text\").innerHTML = str;\n    //     document.getElementById(\"custom-popup\").style.display = \"flex\";\n    //     document.getElementById('btnClickClose').addEventListener(\"click\", function() { document.getElementById(\"custom-popup\").style.display = \"none\"; });\n\t  //   }\n    // }\n    //\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n  },\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { SOUND_MEDIA_LOADING } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"local-refresh-media-button\", {\n  init() {\n    this.onClick = async () => {\n      if (this.targetEl) {\n        const c = this.targetEl.components;\n        // If an HLS stream is loaded, refresh directly with HLS.js\n        if (c[\"media-video\"] && c[\"media-video\"].videoTexture && c[\"media-video\"].videoTexture.hls) {\n          c[\"media-video\"].videoTexture.hls.recoverMediaError();\n        } else if (c[\"media-loader\"]) {\n          // Otherwise fall back to hard resolve-level refresh which should work for any media\n          c[\"media-loader\"].update(c[\"media-loader\"].data, true);\n        }\n      }\n    };\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => (this.targetEl = networkedEl))\n      .catch(() => this.el.parentNode.removeChild(this.el));\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n\nAFRAME.registerComponent(\"refresh-media-button\", {\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n\n    this.onClick = async () => {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n\n      if (this.targetEl) {\n        this.targetEl.components[\"media-loader\"].refresh();\n\n        // Hide button + do the sound effect here, so only the person who clicked hears it, not everyone.\n        this.el.object3D.visible = false;\n        const loadingSoundEffect = sfx.playPositionalSoundFollowing(SOUND_MEDIA_LOADING, this.targetEl.object3D, true);\n\n        this.targetEl.addEventListener(\n          \"media_refreshed\",\n          () => {\n            sfx.stopPositionalAudio(loadingSoundEffect);\n            this.el.object3D.visible = true;\n            this.updateVisibility();\n          },\n          { once: true }\n        );\n      }\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\n\n      if (this.targetEl) {\n        this.targetEl.addEventListener(\"pinned\", this.updateVisibility);\n        this.targetEl.addEventListener(\"unpinned\", this.updateVisibility);\n      }\n\n      this.updateVisibility();\n    });\n  },\n\n  updateVisibility() {\n    if (!this.targetEl) return;\n\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n    this.el.object3D.visible =\n      (!isPinned && window.APP.hubChannel.can(\"spawn_and_move_media\")) || window.APP.hubChannel.can(\"pin_objects\");\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  remove() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this.updateVisibility);\n      this.targetEl.removeEventListener(\"unpinned\", this.updateVisibility);\n    }\n  }\n});\n","import configs from \"../utils/configs\";\n\nAFRAME.registerComponent(\"tweet-media-button\", {\n  init() {\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => {\n        this.targetEl = networkedEl;\n      })\n      .catch(() => {\n        // Non-networked, do not handle for now, and hide button.\n        this.el.object3D.visible = false;\n      });\n\n    this.onClick = () => {\n      const initialTweet = `Taken in ${location.hostname} `;\n\n      const { src, contentSubtype } = this.targetEl.components[\"media-loader\"].data;\n      this.el.sceneEl.emit(\"action_media_tweet\", { mediaUrl: src, contentSubtype, initialTweet });\n    };\n  },\n\n  play() {\n    if (!configs.integration(\"twitter\")) {\n      this.el.object3D.visible = false;\n      return;\n    }\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { idForAvatarUrl } from \"../utils/media-url-utils\";\nimport { fetchAvatar, remixAvatar } from \"../utils/avatar-utils\";\n\nconst REMIX_LABEL = \"save avatar\";\nAFRAME.registerComponent(\"remix-avatar-button\", {\n  init() {\n    this.label = this.el.querySelector(\"[text]\");\n    this.label.setAttribute(\"text\", \"value\", REMIX_LABEL);\n    this.updateSrc = async () => {\n      this.src = this.targetEl.components[\"media-loader\"].data.src;\n      try {\n        this.avatar = await fetchAvatar(idForAvatarUrl(this.src));\n        this.el.object3D.visible = this.avatar && this.avatar.allow_remixing && this.avatar.type === \"avatar_listing\";\n      } catch (e) {\n        console.error(e);\n        this.el.object3D.visible = false;\n      }\n    };\n\n    this.onClick = async () => {\n      if (this.copying || !this.avatar) return;\n\n      try {\n        this.copying = true;\n        this.label.setAttribute(\"text\", \"value\", \"Saving...\");\n\n        await remixAvatar(this.avatar.avatar_id, this.avatar.name);\n\n        this.label.setAttribute(\"text\", \"value\", \"Saved!\");\n      } catch (e) {\n        this.label.setAttribute(\"text\", \"value\", \"Error\");\n      }\n\n      setTimeout(() => {\n        this.label.setAttribute(\"text\", \"value\", REMIX_LABEL);\n        this.copying = false;\n      }, 2000);\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst AMMO_BODY_ATTRIBUTES = { type: \"kinematic\", collisionFilterMask: COLLISION_LAYERS.HANDS };\n\nexport const TRANSFORM_MODE = {\n  AXIS: \"axis\",\n  PUPPET: \"puppet\",\n  CURSOR: \"cursor\",\n  ALIGN: \"align\",\n  SCALE: \"scale\"\n};\n\nconst STEP_LENGTH = Math.PI / 10;\nconst CAMERA_WORLD_QUATERNION = new THREE.Quaternion();\nconst CAMERA_WORLD_POSITION = new THREE.Vector3();\nconst TARGET_WORLD_QUATERNION = new THREE.Quaternion();\nconst v = new THREE.Vector3();\nconst v2 = new THREE.Vector3();\nconst q = new THREE.Quaternion();\nconst q2 = new THREE.Quaternion();\n\nconst eps = 0.001;\nfunction qAlmostEquals(a, b) {\n  return (\n    Math.abs(a.x - b.x) < eps && Math.abs(a.y - b.y) < eps && Math.abs(a.z - b.z) < eps && Math.abs(a.w - b.w) < eps\n  );\n}\n\nAFRAME.registerComponent(\"transform-button\", {\n  schema: {\n    mode: {\n      type: \"string\",\n      oneof: Object.values(TRANSFORM_MODE),\n      default: TRANSFORM_MODE.CURSOR\n    },\n    axis: { type: \"vec3\", default: null }\n  },\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n    let leftHand, rightHand;\n\n    waitForDOMContentLoaded().then(() => {\n      leftHand = document.getElementById(\"player-left-controller\");\n      rightHand = document.getElementById(\"player-right-controller\");\n    });\n    this.onGrabStart = e => {\n      if (!leftHand || !rightHand) return;\n\n      if (!this.targetEl) {\n        return;\n      }\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) {\n        return;\n      }\n      if (this.targetEl.body) {\n        this.targetEl.setAttribute(\"body-helper\", AMMO_BODY_ATTRIBUTES);\n      }\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.startTransform(\n        this.targetEl.object3D,\n        e.object3D.el.id === \"right-cursor\"\n          ? rightHand.object3D\n          : e.object3D.el.id === \"left-cursor\"\n            ? leftHand.object3D\n            : e.object3D,\n        this.data\n      );\n    };\n    this.onGrabEnd = () => {\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.stopTransform();\n    };\n  },\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.onGrabEnd);\n  },\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-up\", this.onGrabEnd);\n  }\n});\n\nAFRAME.registerSystem(\"transform-selected-object\", {\n  init() {\n    this.target = null;\n    this.mode = null;\n    this.transforming = false;\n    this.axis = new THREE.Vector3();\n    this.store = window.APP.store;\n    this.startQ = new THREE.Quaternion();\n\n    this.dxStore = 0;\n    this.dxApplied = 0;\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n    this.raycasters = {};\n\n    this.puppet = {\n      initialControllerOrientation: new THREE.Quaternion(),\n      initialControllerOrientation_inverse: new THREE.Quaternion(),\n      initialObjectOrientation: new THREE.Quaternion(),\n      currentControllerOrientation: new THREE.Quaternion(),\n      controllerOrientationDelta: new THREE.Quaternion()\n    };\n\n    this.planarInfo = {\n      plane: new THREE.Mesh(\n        new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n        new THREE.MeshBasicMaterial({\n          visible: false,\n          wireframe: true,\n          side: THREE.DoubleSide,\n          transparent: true,\n          opacity: 0.3\n        })\n      ),\n      normal: new THREE.Vector3(),\n      intersections: [],\n      previousPointOnPlane: new THREE.Vector3(),\n      currentPointOnPlane: new THREE.Vector3(),\n      deltaOnPlane: new THREE.Vector3(),\n      finalProjectedVec: new THREE.Vector3()\n    };\n    this.el.object3D.add(this.planarInfo.plane);\n  },\n\n  stopTransform: (function() {\n    const q = new THREE.Quaternion();\n    const PI_AROUND_Y = new THREE.Quaternion(0, 1, 0, 0);\n    const pInv = new THREE.Quaternion();\n    return function stopTransform() {\n      this.transforming = false;\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\n        this.target.getWorldQuaternion(q);\n        if (qAlmostEquals(q, this.startQ)) {\n          q.multiply(PI_AROUND_Y);\n          this.target.parent.getWorldQuaternion(pInv);\n          pInv.invert();\n          this.target.quaternion.copy(pInv).multiply(q);\n          this.target.matrixNeedsUpdate = true;\n        }\n      }\n    };\n  })(),\n\n  startPlaneCasting() {\n    const { plane, intersections, previousPointOnPlane } = this.planarInfo;\n\n    this.el.camera.getWorldQuaternion(CAMERA_WORLD_QUATERNION);\n    plane.quaternion.copy(CAMERA_WORLD_QUATERNION);\n    this.target.getWorldPosition(plane.position);\n    plane.matrixNeedsUpdate = true;\n    plane.updateMatrixWorld(true);\n\n    intersections.length = 0;\n    this.raycasters.right =\n      this.raycasters.right ||\n      document.getElementById(\"right-cursor-controller\").components[\"cursor-controller\"].raycaster;\n    this.raycasters.left =\n      this.raycasters.left ||\n      document.getElementById(\"left-cursor-controller\").components[\"cursor-controller\"].raycaster;\n    const raycaster = this.hand.el.id === \"player-left-controller\" ? this.raycasters.left : this.raycasters.right;\n    const far = raycaster.far;\n    raycaster.far = 1000;\n    plane.raycast(raycaster, intersections);\n    raycaster.far = far;\n    this.transforming = !!intersections[0];\n    if (!this.transforming) {\n      return;\n    }\n\n    previousPointOnPlane.copy(intersections[0].point);\n\n    this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n\n    v.set(0, 0, -1).applyQuaternion(CAMERA_WORLD_QUATERNION);\n    v2.set(0, 0, -1).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign = v.dot(v2) > 0 ? 1 : -1;\n\n    v.set(0, 1, 0); //.applyQuaternion(this.CAMERA_WORLD_QUATERNION);\n    v2.set(0, 1, 0).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign2 = v.dot(v2) > 0 ? 1 : -1;\n\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n    this.dxAll = 0;\n    this.dxStore = 0;\n    this.dxApplied = 0;\n  },\n\n  startTransform(target, hand, data) {\n    this.target = target;\n    this.hand = hand;\n    this.mode = data.mode;\n    this.transforming = true;\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.store.update({ activity: { hasRecentered: true } });\n      return;\n    } else {\n      this.store.update({ activity: { hasRotated: true } });\n    }\n\n    if (this.mode === TRANSFORM_MODE.CURSOR) {\n      this.target.getWorldQuaternion(this.startQ);\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.target.getWorldQuaternion(this.puppet.initialObjectOrientation);\n      this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation);\n      this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).invert();\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.axis.copy(data.axis);\n    }\n\n    this.startPlaneCasting();\n  },\n\n  puppetingTick() {\n    const {\n      currentControllerOrientation,\n      controllerOrientationDelta,\n      initialControllerOrientation_inverse,\n      initialObjectOrientation\n    } = this.puppet;\n    this.hand.getWorldQuaternion(currentControllerOrientation);\n    controllerOrientationDelta.copy(initialControllerOrientation_inverse).premultiply(currentControllerOrientation);\n    this.target.quaternion\n      .copy(initialObjectOrientation)\n      .premultiply(controllerOrientationDelta)\n      .premultiply(controllerOrientationDelta);\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  cursorAxisOrScaleTick() {\n    const {\n      plane,\n      normal,\n      intersections,\n      previousPointOnPlane,\n      currentPointOnPlane,\n      deltaOnPlane,\n      finalProjectedVec\n    } = this.planarInfo;\n    this.target.getWorldPosition(plane.position);\n    //    this.el.camera.getWorldQuaternion(plane.quaternion);\n    this.el.camera.getWorldPosition(v);\n    plane.matrixNeedsUpdate = true;\n    const cameraToPlaneDistance = v.sub(plane.position).length();\n\n    intersections.length = 0;\n    const raycaster = this.hand.el.id === \"player-left-controller\" ? this.raycasters.left : this.raycasters.right;\n    const far = raycaster.far;\n    raycaster.far = 1000;\n    plane.raycast(raycaster, intersections);\n    raycaster.far = far;\n    const intersection = intersections[0];\n    if (!intersection) return;\n\n    normal.set(0, 0, -1).applyQuaternion(plane.quaternion);\n\n    currentPointOnPlane.copy(intersection.point);\n    deltaOnPlane.copy(currentPointOnPlane).sub(previousPointOnPlane);\n    const SENSITIVITY = 10;\n    finalProjectedVec\n      .copy(deltaOnPlane)\n      .projectOnPlane(normal)\n      .applyQuaternion(q.copy(plane.quaternion).invert())\n      .multiplyScalar(SENSITIVITY / cameraToPlaneDistance);\n    if (this.mode === TRANSFORM_MODE.CURSOR) {\n      const modify = !AFRAME.scenes[0].systems.userinput.get(paths.actions.transformModifier);\n\n      this.dyAll = this.dyStore + finalProjectedVec.y;\n      this.dyApplied = modify ? this.dyAll : Math.round(this.dyAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dyStore = this.dyAll - this.dyApplied;\n\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = modify ? this.dxAll : Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\n        this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n        v.set(1, 0, 0).applyQuaternion(modify ? CAMERA_WORLD_QUATERNION : TARGET_WORLD_QUATERNION);\n        q.setFromAxisAngle(v, modify ? -this.dyApplied : this.sign2 * this.sign * -this.dyApplied);\n\n        if (modify) {\n          v.set(0, 1, 0).applyQuaternion(CAMERA_WORLD_QUATERNION);\n        } else {\n          v.set(0, 1, 0);\n        }\n        q2.setFromAxisAngle(v, this.dxApplied);\n\n        this.target.quaternion.premultiply(q).premultiply(q2);\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    } else if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      this.target.quaternion.multiply(q.setFromAxisAngle(this.axis, -this.sign * this.dxApplied));\n      this.target.matrixNeedsUpdate = true;\n    }\n\n    previousPointOnPlane.copy(currentPointOnPlane);\n  },\n\n  tick() {\n    if (!this.transforming) {\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.SCALE) {\n      return; // Taken care of by scale-button\n    }\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.el.camera.getWorldPosition(CAMERA_WORLD_POSITION);\n      this.target.lookAt(CAMERA_WORLD_POSITION);\n      this.transforming = false;\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.puppetingTick();\n      return;\n    }\n    this.cursorAxisOrScaleTick();\n  }\n});\n\nAFRAME.registerComponent(\"transform-button-selector\", {\n  tick() {\n    this.userinput = this.userinput || this.el.sceneEl.systems.userinput;\n    const hasHand = this.userinput.get(paths.actions.rightHand.pose) || this.userinput.get(paths.actions.leftHand.pose);\n    if (!hasHand) {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.CURSOR) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.CURSOR);\n      }\n    } else {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.PUPPET) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.PUPPET);\n      }\n    }\n  }\n});\n\nconst FORWARD = new THREE.Vector3(0, 0, 1);\nconst TWO_PI = 2 * Math.PI;\nAFRAME.registerComponent(\"visible-if-transforming\", {\n  schema: {\n    hand: { type: \"string\" }\n  },\n  init() {},\n  tick(t) {\n    const shouldBeVisible =\n      AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming &&\n      AFRAME.scenes[0].systems[\"transform-selected-object\"].hand.el.id.indexOf(this.data.hand) !== -1;\n    const visibleNeedsUpdate = this.el.getAttribute(\"visible\") !== shouldBeVisible;\n    if (visibleNeedsUpdate) {\n      this.el.setAttribute(\"visible\", AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming);\n    }\n\n    if (shouldBeVisible) {\n      this.el.object3D.quaternion.setFromAxisAngle(FORWARD, TWO_PI * Math.sin(t / 1000.0));\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n  }\n});\n","import { setMatrixWorld } from \"../utils/three-utils\";\nimport { TRANSFORM_MODE } from \"./transform-object-button\";\n\nconst calculatePlaneMatrix = (function() {\n  const planeMatrix = new THREE.Matrix4();\n  const planeUp = new THREE.Vector3();\n  const planeForward = new THREE.Vector3();\n  const planeRight = new THREE.Vector3();\n  const planePosition = new THREE.Vector3();\n  const camPosition = new THREE.Vector3();\n\n  return function calculatePlaneMatrix(camera, button) {\n    camera.updateMatrices();\n    camPosition.setFromMatrixPosition(camera.matrixWorld);\n    button.updateMatrices();\n    planePosition.setFromMatrixPosition(button.matrixWorld);\n    planeForward.subVectors(planePosition, camPosition);\n    planeForward.y = 0;\n    planeForward.normalize();\n    planeUp.set(0, 1, 0);\n    planeRight.crossVectors(planeForward, planeUp);\n    planeMatrix.makeBasis(planeRight, planeUp, planeForward.multiplyScalar(-1));\n    planeMatrix.elements[12] = planePosition.x;\n    planeMatrix.elements[13] = planePosition.y;\n    planeMatrix.elements[14] = planePosition.z;\n    return planeMatrix;\n  };\n})();\n\nconst planeForLeftCursor = new THREE.Mesh(\n  new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n  new THREE.MeshBasicMaterial({\n    visible: true,\n    wireframe: false,\n    side: THREE.DoubleSide,\n    transparent: true,\n    opacity: 0.3\n  })\n);\nconst planeForRightCursor = new THREE.Mesh(\n  new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n  new THREE.MeshBasicMaterial({\n    visible: true,\n    wireframe: false,\n    side: THREE.DoubleSide,\n    transparent: true,\n    opacity: 0.3\n  })\n);\n\nAFRAME.registerComponent(\"scale-button\", {\n  init() {\n    this.isScaling = false;\n    this.planeRotation = new THREE.Matrix4();\n    this.planeUp = new THREE.Vector3();\n    this.planeRight = new THREE.Vector3();\n    this.intersections = [];\n    this.initialIntersectionPoint = new THREE.Vector3();\n    this.intersectionPoint = new THREE.Vector3();\n    this.initialObjectScale = new THREE.Vector3();\n    this.desiredObjectScale = new THREE.Vector3();\n    this.deltaScale = new THREE.Vector3();\n    this.objectMatrix = new THREE.Matrix4();\n    this.dragVector = new THREE.Vector3();\n    this.currentObjectScale = new THREE.Vector3();\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n      this.objectToScale = networkedEl.object3D;\n    });\n    const camPosition = new THREE.Vector3();\n    const objectPosition = new THREE.Vector3();\n    const objectToCam = new THREE.Vector3();\n    this.startScaling = e => {\n      if (this.isScaling || !this.objectToScale) {\n        return;\n      }\n\n      if (!(NAF.utils.isMine(this.networkedEl) || NAF.utils.takeOwnership(this.networkedEl))) {\n        return;\n      }\n\n      if (!this.didGetObjectReferences) {\n        this.didGetObjectReferences = true;\n        this.leftEventer = document.getElementById(\"left-cursor\").object3D;\n        this.leftCursorController = document.getElementById(\"left-cursor-controller\");\n        this.leftRaycaster = this.leftCursorController.components[\"cursor-controller\"].raycaster;\n        this.rightCursorController = document.getElementById(\"right-cursor-controller\");\n        this.rightRaycaster = this.rightCursorController.components[\"cursor-controller\"].raycaster;\n        this.viewingCamera = document.getElementById(\"viewing-camera\").object3DMap.camera;\n      }\n      this.plane = e.object3D === this.leftEventer ? planeForLeftCursor : planeForRightCursor;\n      setMatrixWorld(this.plane, calculatePlaneMatrix(this.viewingCamera, this.el.object3D));\n      this.planeRotation.extractRotation(this.plane.matrixWorld);\n      this.planeUp.set(0, 1, 0).applyMatrix4(this.planeRotation);\n      this.planeRight.set(1, 0, 0).applyMatrix4(this.planeRotation);\n      this.raycaster = e.object3D === this.leftEventer ? this.leftRaycaster : this.rightRaycaster;\n      const intersection = this.raycastOnPlane();\n      if (!intersection) return;\n      this.isScaling = true;\n      this.initialIntersectionPoint.copy(intersection.point);\n      this.objectToScale.updateMatrices();\n      this.initialObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld);\n      this.initialDistanceToObject = objectToCam\n        .subVectors(\n          camPosition.setFromMatrixPosition(this.viewingCamera.matrixWorld),\n          objectPosition.setFromMatrixPosition(this.el.object3D.matrixWorld)\n        )\n        .length();\n      window.APP.store.update({ activity: { hasScaled: true } });\n\n      // TODO: Refactor transform-selected-object system so this isn't so awkward\n      this.transformSelectedObjectSystem =\n        this.transformSelectedObjectSystem || this.el.sceneEl.systems[\"transform-selected-object\"];\n      this.transformSelectedObjectSystem.transforming = true;\n      this.transformSelectedObjectSystem.mode = TRANSFORM_MODE.SCALE;\n      this.transformSelectedObjectSystem.target = this.objectToScale;\n      this.transformSelectedObjectSystem.hand =\n        e.object3D === this.leftEventer ? this.leftCursorController.object3D : this.rightCursorController.object3D;\n    };\n    this.endScaling = e => {\n      if (!this.isScaling) {\n        return;\n      }\n      if (\n        (e.object3D === this.leftEventer && this.raycaster === this.leftRaycaster) ||\n        (e.object3D !== this.leftEventer && this.raycaster === this.rightRaycaster)\n      ) {\n        this.isScaling = false;\n        this.transformSelectedObjectSystem =\n          this.transformSelectedObjectSystem || this.el.sceneEl.systems[\"transform-selected-object\"];\n        this.transformSelectedObjectSystem.transforming = false;\n      }\n    };\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.startScaling);\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.endScaling);\n  },\n  raycastOnPlane() {\n    this.intersections.length = 0;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    this.plane.raycast(this.raycaster, this.intersections);\n    this.raycaster.far = far;\n    return this.intersections[0];\n  },\n  tick() {\n    if (!this.isScaling) return;\n    const intersection = this.raycastOnPlane();\n    if (!intersection) return;\n    this.intersectionPoint.copy(intersection.point);\n    this.dragVector.subVectors(this.intersectionPoint, this.initialIntersectionPoint);\n    const dotFactor =\n      (this.dragVector.dot(this.planeUp) + this.dragVector.dot(this.planeRight)) / this.initialDistanceToObject;\n\n    let scaleFactor = 1;\n    if (dotFactor > 0) {\n      scaleFactor = 1 + dotFactor;\n    } else if (dotFactor < 0) {\n      scaleFactor = 1 / (1 + Math.abs(dotFactor));\n    }\n    this.desiredObjectScale.copy(this.initialObjectScale).multiplyScalar(scaleFactor);\n    this.objectToScale.updateMatrices();\n    this.currentObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld);\n    this.deltaScale.set(\n      this.desiredObjectScale.x / this.currentObjectScale.x,\n      this.desiredObjectScale.y / this.currentObjectScale.y,\n      this.desiredObjectScale.z / this.currentObjectScale.z\n    );\n    this.objectMatrix.copy(this.objectToScale.matrixWorld);\n    this.objectMatrix.scale(this.deltaScale);\n    setMatrixWorld(this.objectToScale, this.objectMatrix);\n  }\n});\n","export function getMeshes(collisionEntities) {\n  return collisionEntities\n    .map(function(entity) {\n      return entity.getObject3D(\"mesh\");\n    })\n    .filter(function(n) {\n      return n;\n    });\n}\n","import { cylinderTextureSrc } from \"./cylinder-texture\";\nimport { SOUND_TELEPORT_START, SOUND_TELEPORT_END } from \"../systems/sound-effects-system\";\nimport { getMeshes } from \"../utils/aframe-utils\";\n\nimport { textureLoader } from \"../utils/media-utils\";\n\nconst CYLINDER_TEXTURE = textureLoader.load(cylinderTextureSrc);\n\nfunction easeIn(t) {\n  return t * t;\n}\n\nfunction easeOutIn(t) {\n  if (t < 0.5) return 0.5 * ((t = t * 2 - 1) * t * t + 1);\n  return 0.5 * (t = t * 2 - 1) * t * t + 0.5;\n}\n\nconst UP = new THREE.Vector3(0, 1, 0);\n\nclass RayCurve extends THREE.Mesh {\n  constructor(numPoints, width) {\n    super(\n      new THREE.BufferGeometry(),\n      new THREE.MeshBasicMaterial({\n        side: THREE.DoubleSide,\n        toneMapped: false,\n        transparent: true\n      })\n    );\n\n    this.vertices = new Float32Array(numPoints * 3 * 6);\n    this.width = width;\n\n    this.geometry.setAttribute(\n      \"position\",\n      new THREE.BufferAttribute(this.vertices, 3).setUsage(THREE.DynamicDrawUsage)\n    );\n\n    this.frustumCulled = false;\n\n    this.direction = new THREE.Vector3();\n    this.numPoints = numPoints;\n  }\n\n  setDirection(direction) {\n    this.direction\n      .copy(direction)\n      .cross(UP)\n      .normalize()\n      .multiplyScalar(this.width / 2);\n  }\n\n  setWidth(width) {\n    this.width = width;\n  }\n\n  setPoint = (function() {\n    const A = new THREE.Vector3();\n    const B = new THREE.Vector3();\n    const C = new THREE.Vector3();\n    const D = new THREE.Vector3();\n\n    return function(i, P) {\n      let idx = 3 * 6 * i;\n\n      A.copy(P).add(this.direction);\n      B.copy(P).sub(this.direction);\n      C.set(\n        // Previous A\n        i === 0 ? A.x : this.vertices[idx - 3],\n        i === 0 ? A.y : this.vertices[idx - 2],\n        i === 0 ? A.z : this.vertices[idx - 1]\n      );\n      D.set(\n        // Previous B\n        i === 0 ? B.x : this.vertices[idx - 6],\n        i === 0 ? B.y : this.vertices[idx - 5],\n        i === 0 ? B.z : this.vertices[idx - 4]\n      );\n\n      //   A---P---B\n      //   | \\     |\n      //   |  \\    |\n      //   |   \\   |\n      //   |    \\  |\n      //   |     \\ |\n      //   |      \\|\n      //   C-------D\n      //   A'--P'--B' Previous P\n      //   | \\     |\n\n      this.vertices[idx++] = A.x;\n      this.vertices[idx++] = A.y;\n      this.vertices[idx++] = A.z;\n\n      this.vertices[idx++] = C.x;\n      this.vertices[idx++] = C.y;\n      this.vertices[idx++] = C.z;\n\n      this.vertices[idx++] = D.x;\n      this.vertices[idx++] = D.y;\n      this.vertices[idx++] = D.z;\n\n      this.vertices[idx++] = D.x;\n      this.vertices[idx++] = D.y;\n      this.vertices[idx++] = D.z;\n\n      this.vertices[idx++] = B.x;\n      this.vertices[idx++] = B.y;\n      this.vertices[idx++] = B.z;\n\n      this.vertices[idx++] = A.x;\n      this.vertices[idx++] = A.y;\n      this.vertices[idx++] = A.z;\n\n      this.geometry.attributes.position.needsUpdate = true;\n    };\n  })();\n}\n\nfunction parabolicCurve(p0, v0, t, out) {\n  out.x = p0.x + v0.x * t;\n  out.y = p0.y + v0.y * t - 4.9 * t * t;\n  out.z = p0.z + v0.z * t;\n  return out;\n}\n\nfunction isValidNormalsAngle(collisionNormal, referenceNormal, landingMaxAngle) {\n  const angleNormals = referenceNormal.angleTo(collisionNormal);\n  return THREE.MathUtils.RAD2DEG * angleNormals <= landingMaxAngle;\n}\n\nconst checkLineIntersection = (function() {\n  const direction = new THREE.Vector3();\n  return function checkLineIntersection(start, end, meshes, raycaster, referenceNormal, landingMaxAngle, hitPoint) {\n    direction.copy(end).sub(start);\n    const distance = direction.length();\n    raycaster.far = distance;\n    raycaster.set(start, direction.normalize());\n    const intersects = raycaster.intersectObjects(meshes, true);\n    if (intersects.length > 0 && isValidNormalsAngle(intersects[0].face.normal, referenceNormal, landingMaxAngle)) {\n      hitPoint.copy(intersects[0].point);\n      return true;\n    }\n    return false;\n  };\n})();\n\nconst MISS_OPACITY = 0.1;\nconst HIT_OPACITY = 0.3;\nconst MISS_COLOR = 0xff0000;\nconst HIT_COLOR = 0x99ff99;\nconst FORWARD = new THREE.Vector3(0, 0, -1);\nconst LANDING_NORMAL = new THREE.Vector3(0, 1, 0);\nconst MAX_LANDING_ANGLE = 45;\nconst DRAW_TIME_MS = 400;\nconst q = new THREE.Quaternion();\nconst vecHelper = new THREE.Vector3();\nconst v = new THREE.Vector3();\n\nlet uiRoot;\nAFRAME.registerComponent(\"teleporter\", {\n  schema: {\n    start: { type: \"string\" },\n    confirm: { type: \"string\" },\n    speed: { default: 12 },\n    collisionEntities: { default: \"\" },\n    hitCylinderColor: { type: \"color\", default: \"#99ff99\" },\n    hitCylinderRadius: { default: 0.25, min: 0 },\n    outerRadius: { default: 0.6, min: 0 },\n    hitCylinderHeight: { default: 0.3, min: 0 }\n  },\n\n  init() {\n    this.characterController = this.el.sceneEl.systems[\"hubs-systems\"].characterController;\n    this.isTeleporting = false;\n    this.rayCurve = new RayCurve(20, 0.025);\n    this.rayCurve.visible = false;\n    this.el.sceneEl.object3D.add(this.rayCurve);\n\n    this.p0 = new THREE.Vector3();\n    this.v0 = new THREE.Vector3();\n    this.parabola = Array.from(new Array(this.rayCurve.numPoints), () => new THREE.Vector3());\n    this.hit = false;\n    this.hitPoint = new THREE.Vector3();\n    this.meshes = [];\n    this.raycaster = new THREE.Raycaster();\n    this.rigWorldPosition = new THREE.Vector3();\n    this.newRigWorldPosition = new THREE.Vector3();\n    this.teleportOriginWorldPosition = new THREE.Vector3();\n\n    this.teleportEventDetail = {\n      oldPosition: this.rigWorldPosition,\n      newPosition: this.newRigWorldPosition,\n      hitPoint: this.hitPoint\n    };\n    this.prevHitHeight = 0;\n    this.direction = new THREE.Vector3();\n    this.hitEntity = this.createHitEntity();\n    this.hitEntity.visible = false;\n    this.el.sceneEl.object3D.add(this.hitEntity);\n    this.queryCollisionEntities();\n  },\n\n  queryCollisionEntities: function() {\n    this.collisionEntities = [].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities));\n    this.meshes = getMeshes(this.collisionEntities);\n  },\n\n  remove() {\n    this.stopPlayingTeleportSound();\n  },\n\n  stopPlayingTeleportSound() {\n    if (this.teleportingSound) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      sfx.stopSoundNode(this.teleportingSound.source);\n      this.teleportingSound = null;\n    }\n  },\n\n  tick(t, dt) {\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    const entered = this.el.sceneEl.is(\"entered\");\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n    if (!entered && !isGhost) return;\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const { start, confirm, speed } = this.data;\n    const object3D = this.el.object3D;\n\n    if (\n      !this.isTeleporting &&\n      userinput.get(start) &&\n      !this.characterController.isTeleportingDisabled &&\n      !window.APP.store.state.preferences.disableTeleporter\n    ) {\n      this.isTeleporting = true;\n      this.timeTeleporting = 0;\n      this.hit = false;\n      this.rayCurve.visible = true;\n      this.rayCurve.updateMatrixWorld();\n      this.rayCurve.material.opacity = MISS_OPACITY;\n      this.rayCurve.material.color.set(MISS_COLOR);\n      this.rayCurve.material.needsUpdate = true;\n      this.teleportingSound = sfx.playSoundLoopedWithGain(SOUND_TELEPORT_START);\n      if (this.teleportingSound) {\n        this.teleportingSound.gain.gain.value = 0.005;\n      }\n    }\n\n    if (!this.isTeleporting) {\n      return;\n    }\n    if (this.teleportingSound) {\n      this.teleportingSound.gain.gain.value = Math.min(0.025, this.teleportingSound.gain.gain.value + 0.00002 * dt);\n    }\n\n    if (userinput.get(confirm)) {\n      this.hitEntity.visible = false;\n      this.isTeleporting = false;\n      this.rayCurve.visible = false;\n\n      if (this.teleportingSound) {\n        this.stopPlayingTeleportSound();\n      }\n\n      if (!this.hit || this.timeTeleporting < DRAW_TIME_MS) {\n        return;\n      }\n\n      this.characterController.teleportTo(this.hitPoint);\n\n      sfx.playSoundOneShot(SOUND_TELEPORT_END);\n      return;\n    }\n\n    this.timeTeleporting += dt;\n    object3D.updateMatrixWorld();\n    object3D.matrixWorld.decompose(this.p0, q, vecHelper);\n    this.direction\n      .copy(FORWARD)\n      .applyQuaternion(q)\n      .normalize();\n    this.rayCurve.setDirection(this.direction);\n    this.el.object3D.updateMatrices();\n    const playerScale = v.setFromMatrixColumn(this.characterController.avatarPOV.object3D.matrixWorld, 1).length();\n    this.v0.copy(this.direction).multiplyScalar(speed * Math.sqrt(playerScale));\n\n    let collidedIndex = this.rayCurve.numPoints - 1;\n\n    this.hit = false;\n    this.parabola[0].copy(this.p0);\n    const timeSegment = 1 / (this.rayCurve.numPoints - 1);\n    for (let i = 1; i < this.rayCurve.numPoints; i++) {\n      const t = i * timeSegment;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.parabola[i].copy(vecHelper);\n\n      if (\n        checkLineIntersection(\n          this.parabola[i - 1],\n          this.parabola[i],\n          this.meshes,\n          this.raycaster,\n          LANDING_NORMAL,\n          MAX_LANDING_ANGLE,\n          this.hitPoint\n        )\n      ) {\n        this.hit = true;\n        collidedIndex = i;\n        break;\n      }\n    }\n    if (this.characterController.isTeleportingDisabled) {\n      this.hit = false;\n    }\n\n    const percentToDraw = this.timeTeleporting > DRAW_TIME_MS ? 1 : this.timeTeleporting / DRAW_TIME_MS;\n    const percentRaycasted = collidedIndex / (this.rayCurve.numPoints - 1);\n    const segmentT = (percentToDraw * percentRaycasted) / (this.rayCurve.numPoints - 1);\n\n    for (let i = 0; i < this.rayCurve.numPoints; i++) {\n      const t = i * segmentT;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.rayCurve.setPoint(i, vecHelper);\n    }\n\n    const color = this.hit ? HIT_COLOR : MISS_COLOR;\n    const opacity = this.hit && this.timeTeleporting >= DRAW_TIME_MS ? HIT_OPACITY : MISS_OPACITY;\n    this.rayCurve.material.color.set(color);\n    this.rayCurve.material.opacity = opacity;\n\n    this.hitEntity.visible = this.hit;\n    if (this.hit) {\n      this.hitEntity.position.copy(this.hitPoint);\n      this.hitEntity.matrixNeedsUpdate = true;\n\n      const dRadii = this.data.outerRadius - this.data.hitCylinderRadius;\n      const outerScale = (this.data.outerRadius - easeIn(percentToDraw) * dRadii) / this.data.outerRadius;\n      this.outerTorus.scale.set(outerScale, outerScale, 1);\n      this.outerTorus.matrixNeedsUpdate = true;\n\n      const hitEntityOpacity = HIT_OPACITY * easeOutIn(percentToDraw);\n      this.torus.material.opacity = hitEntityOpacity;\n      this.cylinder.material.opacity = hitEntityOpacity;\n    }\n  },\n\n  // TODO the use of toruses here is a bit wasteful.\n  createHitEntity() {\n    const data = this.data;\n\n    // Parent.\n    const hitEntity = new THREE.Group();\n\n    // Torus.\n    this.torus = new THREE.Mesh(\n      new THREE.TorusBufferGeometry(data.hitCylinderRadius, 0.01, 16, 18, 360 * THREE.MathUtils.DEG2RAD),\n      new THREE.MeshBasicMaterial({\n        color: data.hitCylinderColor,\n        side: THREE.DoubleSide,\n        transparent: true,\n        toneMapped: false,\n        depthTest: false\n      })\n    );\n    this.torus.rotation.x = 90 * THREE.MathUtils.DEG2RAD;\n    hitEntity.add(this.torus);\n\n    // Cylinder.\n    this.cylinder = new THREE.Mesh(\n      new THREE.CylinderBufferGeometry(\n        data.hitCylinderRadius,\n        data.hitCylinderRadius,\n        data.hitCylinderHeight,\n        16,\n        1,\n        true\n      ),\n      new THREE.MeshBasicMaterial({\n        color: data.hitCylinderColor,\n        side: THREE.DoubleSide,\n        map: CYLINDER_TEXTURE,\n        toneMapped: false,\n        transparent: true,\n        depthTest: false\n      })\n    );\n    this.cylinder.position.y = data.hitCylinderHeight / 2;\n    // UV's for THREE Geometries assume flipY\n    if (!CYLINDER_TEXTURE.flipY) {\n      this.cylinder.rotation.z = 180 * THREE.MathUtils.DEG2RAD;\n    }\n    hitEntity.add(this.cylinder);\n\n    // create another torus for animating when the hit destination is ready to go\n    this.outerTorus = new THREE.Mesh(\n      new THREE.TorusBufferGeometry(data.outerRadius, 0.01, 16, 18, 360 * THREE.MathUtils.DEG2RAD),\n      new THREE.MeshBasicMaterial({\n        color: data.hitCylinderColor,\n        side: THREE.DoubleSide,\n        opacity: HIT_OPACITY,\n        transparent: true,\n        depthTest: false\n      })\n    );\n    this.outerTorus.rotation.x = 90 * THREE.MathUtils.DEG2RAD;\n    hitEntity.add(this.outerTorus);\n\n    return hitEntity;\n  }\n});\n","export const cylinderTextureSrc =\n  \"data:image/png;base64,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\";\n","import { setMatrixWorld, affixToWorldUp } from \"../utils/three-utils\";\nconst rotate = new THREE.Matrix4().makeRotationY(Math.PI);\nconst translate = new THREE.Matrix4().makeTranslation(0, -0.25, 0);\nconst m = new THREE.Matrix4();\n\nAFRAME.registerComponent(\"inspect-pivot-offset-from-camera\", {\n  tick() {\n    const parent = this.el.object3D.parent;\n    parent.updateMatrices();\n    setMatrixWorld(\n      this.el.object3D,\n      affixToWorldUp(parent.matrixWorld, m)\n        .multiply(translate)\n        .multiply(rotate)\n    );\n  }\n});\n","import { SourceType, AudioType } from \"./audio-params\";\nimport { getCurrentAudioSettings, updateAudioSettings } from \"../update-audio-settings\";\nconst INFO_INIT_FAILED = \"Failed to initialize avatar-audio-source.\";\nconst INFO_NO_NETWORKED_EL = \"Could not find networked el.\";\nconst INFO_NO_OWNER = \"Networked component has no owner.\";\n\n// Chrome seems to require a MediaStream be attached to an AudioElement before AudioNodes work correctly\n// We don't want to do this in other browsers, particularly in Safari, which actually plays the audio despite\n// setting the volume to 0.\nconst SHOULD_CREATE_SILENT_AUDIO_ELS = /chrome/i.test(navigator.userAgent);\nfunction createSilentAudioEl(stream) {\n  const audioEl = new Audio();\n  audioEl.setAttribute(\"autoplay\", \"autoplay\");\n  audioEl.setAttribute(\"playsinline\", \"playsinline\");\n  audioEl.srcObject = stream;\n  audioEl.volume = 0; // we don't actually want to hear audio from this element\n  return audioEl;\n}\n\nasync function getOwnerId(el) {\n  const networkedEl = await NAF.utils.getNetworkedEntity(el).catch(e => {\n    console.error(INFO_INIT_FAILED, INFO_NO_NETWORKED_EL, e);\n  });\n  if (!networkedEl) {\n    return null;\n  }\n  return networkedEl.components.networked.data.owner;\n}\n\nasync function getMediaStream(el) {\n  const peerId = await getOwnerId(el);\n  if (!peerId) {\n    console.error(INFO_INIT_FAILED, INFO_NO_OWNER);\n    return null;\n  }\n  const stream = await APP.dialog.getMediaStream(peerId).catch(e => {\n    console.error(INFO_INIT_FAILED, `Error getting media stream for ${peerId}`, e);\n  });\n  if (!stream) {\n    return null;\n  }\n  return stream;\n}\n\nAFRAME.registerComponent(\"avatar-audio-source\", {\n  createAudio: async function() {\n    this.removeAudio();\n\n    this.isCreatingAudio = true;\n    const stream = await getMediaStream(this.el);\n    this.isCreatingAudio = false;\n    const isRemoved = !this.el.parentNode;\n    if (!stream || isRemoved) return;\n\n    APP.sourceType.set(this.el, SourceType.AVATAR_AUDIO_SOURCE);\n    const { audioType } = getCurrentAudioSettings(this.el);\n    const audioListener = this.el.sceneEl.audioListener;\n    let audio = this.el.getObject3D(this.attrName);\n    if (audioType === AudioType.PannerNode) {\n      audio = new THREE.PositionalAudio(audioListener);\n    } else {\n      audio = new THREE.Audio(audioListener);\n    }\n    // Default to being quiet so it fades in when volume is set by audio systems\n    audio.gain.gain.value = 0;\n\n    this.audioSystem.addAudio({ sourceType: SourceType.AVATAR_AUDIO_SOURCE, node: audio });\n\n    if (SHOULD_CREATE_SILENT_AUDIO_ELS) {\n      createSilentAudioEl(stream); // TODO: Do the audio els need to get cleaned up?\n    }\n\n    this.destination = audio.context.createMediaStreamDestination();\n    this.mediaStreamSource = audio.context.createMediaStreamSource(stream);\n    const destinationSource = audio.context.createMediaStreamSource(this.destination.stream);\n    this.mediaStreamSource.connect(this.destination);\n    audio.setNodeSource(destinationSource);\n    this.el.setObject3D(this.attrName, audio);\n    this.el.emit(\"sound-source-set\", { soundSource: destinationSource });\n\n    APP.audios.set(this.el, audio);\n    updateAudioSettings(this.el, audio);\n  },\n\n  removeAudio() {\n    const audio = this.el.getObject3D(this.attrName);\n    if (audio) {\n      this.audioSystem.removeAudio({ node: audio });\n      this.el.removeObject3D(this.attrName);\n    }\n  },\n\n  init() {\n    this.createAudio = this.createAudio.bind(this);\n\n    this.audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n    // We subscribe to audio stream notifications for this peer to update the audio source\n    // This could happen in case there is an ICE failure that requires a transport recreation.\n    APP.dialog.on(\"stream_updated\", this._onStreamUpdated, this);\n    this.createAudio();\n\n    let { disableLeftRightPanning, audioPanningQuality } = APP.store.state.preferences;\n    this.onPreferenceChanged = () => {\n      const newDisableLeftRightPanning = APP.store.state.preferences.disableLeftRightPanning;\n      const newAudioPanningQuality = APP.store.state.preferences.audioPanningQuality;\n\n      const shouldRecreateAudio = disableLeftRightPanning !== newDisableLeftRightPanning && !this.isCreatingAudio;\n      const shouldUpdateAudioSettings = audioPanningQuality !== newAudioPanningQuality;\n\n      disableLeftRightPanning = newDisableLeftRightPanning;\n      audioPanningQuality = newAudioPanningQuality;\n\n      if (shouldRecreateAudio) {\n        this.createAudio();\n      } else if (shouldUpdateAudioSettings) {\n        // updateAudioSettings() is called in this.createAudio()\n        // so no need to call it if shouldRecreateAudio is true.\n        const audio = this.el.getObject3D(this.attrName);\n        updateAudioSettings(this.el, audio);\n      }\n    };\n    APP.store.addEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.addEventListener(\"audio_type_changed\", this.createAudio);\n  },\n\n  async _onStreamUpdated(peerId, kind) {\n    const audio = this.el.getObject3D(this.attrName);\n    if (!audio) return;\n    const stream = audio.source.mediaStream;\n    if (!stream) return;\n\n    getOwnerId(this.el).then(async ownerId => {\n      if (ownerId === peerId && kind === \"audio\") {\n        // The audio stream for this peer has been updated\n        const newStream = await APP.dialog.getMediaStream(peerId, \"audio\").catch(e => {\n          console.error(INFO_INIT_FAILED, `Error getting media stream for ${peerId}`, e);\n        });\n\n        if (newStream) {\n          this.mediaStreamSource.disconnect();\n          this.mediaStreamSource = audio.context.createMediaStreamSource(newStream);\n          this.mediaStreamSource.connect(this.destination);\n        }\n      }\n    });\n  },\n\n  remove: function() {\n    APP.dialog.off(\"stream_updated\", this._onStreamUpdated);\n\n    window.APP.store.removeEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.removeEventListener(\"audio_type_changed\", this.createAudio);\n\n    APP.audios.delete(this.el);\n    APP.sourceType.delete(this.el);\n    APP.supplementaryAttenuation.delete(this.el);\n\n    this.removeAudio();\n  }\n});\n\nfunction createWhiteNoise(audioContext, gain) {\n  const bufferSize = 2 * audioContext.sampleRate,\n    noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate),\n    gainFilter = noiseBuffer.getChannelData(0);\n  for (let i = 0; i < bufferSize; i++) {\n    gainFilter[i] = (Math.random() * 2 - 1) * gain;\n  }\n\n  const whiteNoise = audioContext.createBufferSource();\n  whiteNoise.buffer = noiseBuffer;\n  whiteNoise.loop = true;\n  whiteNoise.start(0);\n  return whiteNoise;\n}\n\nconst tmpWorldPos = new THREE.Vector3();\n\n/**\n * @component zone-audio-source\n * This component looks for audio sources that get near it, keeping track\n * of them and making them available to other components. It currently only\n * supports avatars via the avatar-audio-source component, and only a single\n * source at a time, but this can easily be expanded in the future.\n */\nAFRAME.registerComponent(\"zone-audio-source\", {\n  schema: {\n    onlyMods: { default: true },\n    muteSelf: { default: true },\n\n    debug: { default: false }\n  },\n\n  init() {\n    const audioListener = this.el.sceneEl.audioListener;\n    const ctx = audioListener.context;\n    this.gainFilter = ctx.createGain();\n    if (this.data.debug) {\n      this.whiteNoise = createWhiteNoise(ctx, 0.01);\n      this.setInput(this.whiteNoise);\n    }\n\n    // TODO this should probably be using bounds similar to media-frames and trigger-volume.\n    // Doing the simple thing for now since we only support avatar audio sources currently\n    this.el.object3D.updateMatrixWorld();\n    const radius = this.el.object3D.matrixWorld.getMaxScaleOnAxis();\n    this.boundingRadiusSquared = radius * radius;\n\n    if (this.data.debug) {\n      this.el.setObject3D(\n        \"debug\",\n        new THREE.LineSegments(new THREE.WireframeGeometry(new THREE.SphereBufferGeometry(1, 10, 10)))\n      );\n    }\n  },\n\n  setInput(newInput) {\n    if (this.input) {\n      this.input.disconnect(this.gainFilter);\n      this.input = null;\n    }\n\n    if (newInput) {\n      newInput.connect(this.gainFilter);\n      this.input = newInput;\n    }\n  },\n\n  getGainFilter() {\n    return this.gainFilter;\n  },\n\n  tick() {\n    this.el.object3D.getWorldPosition(tmpWorldPos);\n    if (this.trackingEl) {\n      const distanceSquared = this.trackingEl.object3D.position.distanceToSquared(tmpWorldPos);\n      if (distanceSquared > this.boundingRadiusSquared) {\n        this.trackingEl = null;\n        this.setInput(this.whiteNoise);\n      }\n    } else {\n      const playerInfos = window.APP.componentRegistry[\"player-info\"];\n      for (let i = 0; i < playerInfos.length; i++) {\n        const playerInfo = playerInfos[i];\n        const avatar = playerInfo.el;\n\n        if (this.data.onlyMods && !playerInfo.can(\"amplify_audio\")) continue;\n\n        const distanceSquared = avatar.object3D.position.distanceToSquared(tmpWorldPos);\n        if (distanceSquared < this.boundingRadiusSquared) {\n          this.trackingEl = avatar;\n          if (this.data.muteSelf && this.trackingEl.id === \"avatar-rig\") {\n            // Don't emit your own audio\n            this.setInput(null);\n          } else {\n            getMediaStream(this.trackingEl).then(stream => {\n              const audioListener = this.el.sceneEl.audioListener;\n              const ctx = audioListener.context;\n              const node = ctx.createMediaStreamSource(stream);\n              this.setInput(node);\n            });\n          }\n        }\n      }\n    }\n  }\n});\n\n/**\n * @component audio-target\n * This component pulls audio from a \"source\" component and re-emits it.\n * Currently the audio can come from a zone-audio-source. A gain as well\n * as a random delay can be applied in addition to the standard positional\n * audio properties, to better simulate a real world speaker setup.\n */\nAFRAME.registerComponent(\"audio-target\", {\n  schema: {\n    minDelay: { default: 0.01 },\n    maxDelay: { default: 0.13 },\n    srcEl: { type: \"selector\" },\n    debug: { default: false }\n  },\n\n  init() {\n    this.audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n    this.createAudio();\n    // TODO this is to ensure targets and sources loaded at the same time don't have\n    // an order depndancy but this should be done in a more robust way\n    setTimeout(() => {\n      this.connectAudio();\n    }, 0);\n    this.el.setAttribute(\"audio-zone-source\");\n\n    this.createAudio = this.createAudio.bind(this);\n    this.el.addEventListener(\"audio_type_changed\", this.createAudio);\n  },\n\n  remove: function() {\n    APP.supplementaryAttenuation.delete(this.el);\n    APP.audios.delete(this.el);\n    APP.sourceType.delete(this.el);\n\n    this.removeAudio();\n\n    this.el.removeAttribute(\"audio-zone-source\");\n    this.el.removeEventListener(\"audio_type_changed\", this.createAudio);\n  },\n\n  createAudio: function() {\n    this.removeAudio();\n\n    APP.sourceType.set(this.el, SourceType.AUDIO_TARGET);\n    const audioListener = this.el.sceneEl.audioListener;\n    const { audioType } = getCurrentAudioSettings(this.el);\n    let audio = this.el.getObject3D(this.attrName);\n    if (audioType === AudioType.PannerNode) {\n      audio = new THREE.PositionalAudio(audioListener);\n    } else {\n      audio = new THREE.Audio(audioListener);\n    }\n    this.audioSystem.addAudio({ sourceType: SourceType.AVATAR_AUDIO_SOURCE, node: audio });\n\n    if (this.data.maxDelay > 0) {\n      const delayNode = audio.context.createDelay(this.data.maxDelay);\n      delayNode.delayTime.value = THREE.MathUtils.randFloat(this.data.minDelay, this.data.maxDelay);\n      audio.setFilters([delayNode]);\n    }\n\n    this.el.setObject3D(this.attrName, audio);\n    audio.matrixNeedsUpdate = true;\n    audio.updateMatrixWorld();\n\n    audio.updateMatrixWorld();\n    APP.audios.set(this.el, audio);\n    updateAudioSettings(this.el, audio);\n  },\n\n  connectAudio() {\n    const srcEl = this.data.srcEl;\n    const srcZone = srcEl && srcEl.components[\"zone-audio-source\"];\n    const node = srcZone && srcZone.getGainFilter();\n    if (node) {\n      const audio = this.el.getObject3D(this.attrName);\n      if (audio) {\n        audio.setNodeSource(node);\n      }\n    } else {\n      console.warn(`Failed to get audio from source for ${this.el.className}`, srcEl);\n    }\n  },\n\n  removeAudio() {\n    const audio = this.el.getObject3D(this.attrName);\n    if (audio) {\n      this.audioSystem.removeAudio({ node: this.audio });\n      this.el.removeObject3D(this.attrName);\n    }\n  }\n});\n","import { disposeTexture } from \"../utils/material-utils\";\nimport { createVideoOrAudioEl } from \"../utils/media-utils\";\nimport { findNode } from \"../utils/three-utils\";\nimport { Layers } from \"./layers\";\n\n/**\n * @component video-texture-source\n * This component is intended to be used on entities with a Camera Object3D as a child.\n * That camera is used to render the scene to a WebGLRenderTarget of the specified resolution\n * at a maximum of the specified frame rate. It will only render a frame if something sets\n * its textureNeedsUpdate property to true. Currently video-texture-target does this\n * whenever its material is used during the primary camera render (as in, it's in view).\n */\nAFRAME.registerComponent(\"video-texture-source\", {\n  schema: {\n    resolution: { type: \"vec2\", default: [1280, 720] },\n    fps: { default: 15 }\n  },\n\n  init() {\n    this.camera = findNode(this.el.object3D, n => n.isCamera);\n\n    this.camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n\n    if (!this.camera) {\n      console.warn(\"video-texture-source added to an entity without a camera\");\n      return;\n    }\n\n    this.camera.aspect = this.data.resolution[0] / this.data.resolution[1];\n\n    // TODO currently if a video-texture-source tries to render itself it will fail with a warning.\n    // If we want to support this we will need 2 render targets to swap back and forth.\n    this.renderTarget = new THREE.WebGLRenderTarget(this.data.resolution[0], this.data.resolution[1], {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n\n    const texture = this.renderTarget.texture;\n\n    // Since we are rendering directly to a texture we need to flip it vertically\n    // See https://github.com/mozilla/hubs/pull/4126#discussion_r610120237\n    texture.matrixAutoUpdate = false;\n    texture.matrix.scale(1, -1);\n    texture.matrix.translate(0, 1);\n\n    this.textureNeedsUpdate = false;\n  },\n\n  remove() {\n    disposeTexture(this.renderTarget.texture);\n    this.renderTarget.dispose();\n  },\n\n  tock(time) {\n    if (!this.renderTarget || !this.textureNeedsUpdate) return;\n\n    if (time < this.lastRenderTime + 1000 / this.data.fps) return;\n\n    // TODO handle hiding UI and showing first person head\n    // Once thats done also rework camrea-tool to use this to do its actual rendering\n\n    const sceneEl = this.el.sceneEl;\n    const renderer = this.renderer || sceneEl.renderer;\n\n    const tmpXRFlag = renderer.xr.enabled;\n    const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\n    delete sceneEl.object3D.onAfterRender;\n    renderer.xr.enabled = false;\n\n    // The entire scene graph matrices should already be updated\n    // in tick(). They don't need to be recomputed again in tock().\n    const tmpAutoUpdate = sceneEl.object3D.autoUpdate;\n    sceneEl.object3D.autoUpdate = false;\n\n    renderer.setRenderTarget(this.renderTarget);\n    renderer.render(sceneEl.object3D, this.camera);\n    renderer.setRenderTarget(null);\n\n    sceneEl.object3D.autoUpdate = tmpAutoUpdate;\n\n    renderer.xr.enabled = tmpXRFlag;\n    sceneEl.object3D.onAfterRender = tmpOnAfterRender;\n\n    this.lastRenderTime = time;\n    this.textureNeedsUpdate = false;\n  }\n});\n\n/**\n * @component video-texture-target\n * This component is intended to be used on entities with a mesh/skinned mesh Object3D\n * The component swaps the base color map on the mesh's material with a video texture\n * Currently the video texture can come from a webcam stream or a camera entity with\n * a video-texture-src component on it.\n */\nAFRAME.registerComponent(\"video-texture-target\", {\n  schema: {\n    src: { type: \"string\" },\n    // only used when `src` === \"el\"\n    srcEl: { type: \"selector\" },\n    targetBaseColorMap: { type: \"boolean\", default: true },\n    targetEmissiveMap: { type: \"boolean\", default: false }\n  },\n\n  getMaterial() {\n    return (\n      (this.el.object3DMap.skinnedmesh && this.el.object3DMap.skinnedmesh.material) ||\n      (this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) ||\n      this.el.object3D.material\n    );\n  },\n\n  init() {\n    // Make video-texture-target objects inivisible before rendering to the frame buffer\n    // Chromium checks for loops when drawing to a framebuffer so if we don't exclude the objects\n    // that are using that rendertarget's texture we get an error. Firefox does not check.\n    // https://chromium.googlesource.com/chromium/src/+/460cac969e2e9ac38a2611be1a32db0361d88bfb/gpu/command_buffer/service/gles2_cmd_decoder.cc#9516\n    this.el.object3D.traverse(o => {\n      o.layers.mask1 = o.layers.mask;\n      o.layers.set(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n    });\n\n    const material = this.getMaterial();\n\n    if (!material) {\n      console.warn(\"video-texture-target added to an entity without a material\");\n    }\n\n    this.originalMap = material && material.map;\n    this.originalEmissiveMap = material && material.emissiveMap;\n  },\n\n  update(prevData) {\n    const material = this.getMaterial();\n\n    if (!material) {\n      return;\n    }\n\n    const src = this.data.src;\n\n    // TODO it's pretty ugly to have these 2 unrelated code paths, it should probably be reworked such that both paths look more like the first branch\n    if (src === \"el\") {\n      if (prevData.srcEl === this.data.srcEl) return;\n\n      if (this.data.srcEl) {\n        const videoTextureSource = this.data.srcEl.components[\"video-texture-source\"];\n        const texture = videoTextureSource.renderTarget.texture;\n        this.applyTexture(texture);\n\n        // Bit of a hack here to only update the renderTarget when the screens are in view\n        material.map.isVideoTexture = true;\n        material.map.update = () => {\n          videoTextureSource.textureNeedsUpdate = true;\n        };\n      } else {\n        material.map = this.originalMap;\n        material.emissiveMap = this.originalEmissiveMap;\n        material.needsUpdate = true;\n      }\n    } else {\n      if (src && src.startsWith(\"hubs://\")) {\n        if (prevData.src === src) {\n          return;\n        }\n\n        const streamClientId = src.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\n\n        APP.dialog.getMediaStream(streamClientId, \"video\").then(stream => {\n          if (src !== this.data.src) {\n            // Prevent creating and loading video texture if the src changed while we were fetching the video stream.\n            return;\n          }\n\n          const video = createVideoOrAudioEl(\"video\");\n          video.srcObject = stream;\n\n          const texture = new THREE.VideoTexture(video);\n          texture.flipY = false;\n          texture.minFilter = THREE.LinearFilter;\n          texture.encoding = THREE.sRGBEncoding;\n\n          this.applyTexture(texture);\n        });\n      } else {\n        if (material.map && material.map !== this.originalMap) {\n          disposeTexture(material.map);\n        }\n\n        if (material.emissiveMap && material.emissiveMap !== this.originalEmissiveMap) {\n          disposeTexture(material.emissiveMap);\n        }\n\n        material.map = this.originalMap;\n        material.emissiveMap = this.originalEmissiveMap;\n\n        material.needsUpdate = true;\n      }\n    }\n  },\n\n  applyTexture(texture) {\n    const material = this.getMaterial();\n\n    // Copy texture settings from the original texture so that things like texture wrap settings are applied\n    const originalTexture = this.originalMap || this.originalEmissiveMap;\n\n    if (originalTexture) {\n      texture.wrapS = originalTexture.wrapS;\n      texture.wrapT = originalTexture.wrapT;\n    }\n\n    if (this.data.targetBaseColorMap) {\n      material.map = texture;\n    }\n\n    if (this.data.targetEmissiveMap) {\n      material.emissiveMap = texture;\n    }\n\n    material.needsUpdate = true;\n  },\n\n  remove() {\n    this.el.object3D.traverse(o => {\n      if (o.layers.mask1) {\n        o.layers.mask = o.layers.mask1;\n        delete o.layers.mask1;\n      }\n    });\n\n    // element sources can be shared and are expected to manage their own resources\n    if (this.data.src === \"el\") return;\n\n    const material = this.getMaterial();\n\n    if (material && material.map && material.map !== this.originalMap) {\n      disposeTexture(material.map);\n    }\n\n    if (material.emissiveMap && material.emissiveMap !== this.originalEmissiveMap) {\n      disposeTexture(material.emissiveMap);\n    }\n  }\n});\n","import { Reflector } from \"three/examples/jsm/objects/Reflector\";\n\nconst DEFAULT_MIRROR_GEOMETRY = new THREE.PlaneBufferGeometry();\nconst DEFAULT_TEXTURE_WIDTH = window.innerWidth * window.devicePixelRatio;\nconst DEFAULT_TEXTURE_HEIGHT = window.innerHeight * window.devicePixelRatio;\n\nimport { Layers } from \"./layers\";\n\n/**\n * Should need to entity that has geometry primitive\n *\n * @example\n * ```html\n * <a-plane mirror scale=\"5 5 5\" position=\"0 3 0\"></a-plane>\n * <a-circle mirror=\"color: #7f7f7f\" scale=\"5 5 5\" position=\"0 3 0\"></a-circle>\n * ```\n */\nAFRAME.registerComponent(\"mirror\", {\n  schema: {\n    color: { type: \"color\", default: \"#7f7f7f\" }\n  },\n\n  init() {\n    const geometry = this.el.object3DMap?.mesh?.geometry || DEFAULT_MIRROR_GEOMETRY;\n    const reflector = new Reflector(geometry, {\n      color: this.data.color,\n      textureWidth: DEFAULT_TEXTURE_WIDTH,\n      textureHeight: DEFAULT_TEXTURE_HEIGHT\n    });\n    this.el.setObject3D(\"mesh\", reflector);\n\n    // HACK the first time we render this, add the appropriate camera layers to the virtual camera\n    const originalOnBeforeRender = reflector.onBeforeRender;\n    reflector.onBeforeRender = function (renderer, scene, camera) {\n      const originalRender = renderer.render;\n      renderer.render = function (scene, camera) {\n        camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n        camera.layers.enable(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n        reflector.onBeforeRender = originalOnBeforeRender;\n        originalRender.call(renderer, scene, camera);\n      };\n      originalOnBeforeRender(renderer, scene, camera);\n      renderer.render = originalRender;\n    };\n  }\n});\n","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // Hash can't be overriden like the other elements, but needs to be preserved for things like deep linking waypoints\n  const hash = history.location.hash;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state, hash });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","import { isIOS } from \"./is-mobile\";\n\nconst { detect } = require(\"detect-browser\");\n\nconst browser = detect();\n\n// Precision on device detection is fuzzy -- we can sometimes know if a device is definitely\n// available, or definitely *not* available, and assume it may be available otherwise.\nexport const VR_DEVICE_AVAILABILITY = {\n  yes: \"yes\", // Implies VR can be launched into on this device immediately, in this browser\n  no: \"no\", // Implies this VR device is definitely not supported regardless of browser\n  maybe: \"maybe\" // Implies this device may support this VR platform, but may not be installed or in a compatible browser\n};\n\nfunction isMaybeGearVRCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\nfunction isMaybeDaydreamCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\n// Disallowed list of VR device name regex matchers that we do not want to consider as valid VR devices\n// that can be entered into as a \"generic\" entry flow.\nconst GENERIC_ENTRY_TYPE_DISALLOWED_DEVICES = [/cardboard/i];\n\n// Tries to determine VR entry compatibility regardless of the current browser.\n//\n// For each VR \"entry type\", returns VR_DEVICE_AVAILABILITY.yes if that type can be launched into directly from this browser\n// on this device, returns VR_DEVICE_AVAILABILITY.no if that type is known to not be possible to ever use on this device no matter what,\n// and VR_DEVICE_AVAILABILITY.maybe if the device potentially could support that type if a different browser was running, or if\n// the software was setup, an HMD was purchased, etc.\n//\n// When \"yes\" or \"maybe\", we should present the option. If \"maybe\", when chosen try to get them into a compatible browser.\n// Once in a compatible browser, we should assume it will work (if it doesn't, it's because they don't have the headset,\n// haven't installed the software, our guess about their phone was wrong, etc.)\n//\n// At the time of this writing there are the following VR \"entry types\" that will be validated by this method:\n//\n// - screen: Enter \"on-screen\" in 2D\n// - generic: Generic WebVR (platform/OS agnostic indicator if a general 'Enter VR' option should be presented.)\n// - daydream: Google Daydream\n// - gearvr: Oculus GearVR\n// - cardboard: Google Cardboard\n//\nexport async function getAvailableVREntryTypes() {\n  const ua = navigator.userAgent;\n  const isSamsungBrowser = browser.name === \"chrome\" && /SamsungBrowser/.test(ua);\n  const isMobile = AFRAME.utils.device.isMobile();\n  const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n  // This needs to be kept up-to-date with the latest browsers that can support VR and Hubs.\n  // Checking for navigator.getVRDisplays always passes b/c of polyfill.\n  const isWebVRCapableBrowser = window.hasNativeWebVRImplementation;\n  const isWebXRCapableBrowser = window.hasNativeWebXRImplementation;\n\n  const isDaydreamCapableBrowser = !!(isWebVRCapableBrowser && browser.name === \"chrome\" && !isSamsungBrowser);\n  const isIDevice = isIOS();\n  const isFirefoxBrowser = browser.name === \"firefox\";\n  const isUIWebView = typeof navigator.mediaDevices === \"undefined\";\n\n  const safari = isIDevice\n    ? !isUIWebView\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.maybe\n    : VR_DEVICE_AVAILABILITY.no;\n\n  const isCardboardCapableBrowser = !!(isMobile && !isIDevice && browser.name === \"chrome\" && !isSamsungBrowser);\n\n  let displays = [];\n  try {\n    // Skip getVRDisplays on desktop Chrome since the API is in a broken state there.\n    // See https://github.com/mozilla/hubs/issues/892\n    if (browser.name !== \"chrome\" || isMobile) {\n      // We pull the displays on non-WebVR capable mobile browsers so we can pick up cardboard.\n      displays = isWebVRCapableBrowser || isCardboardCapableBrowser ? await navigator.getVRDisplays() : [];\n    }\n  } catch (e) {\n    console.warn(\"navigator.getVRDisplays() failed\", e);\n  }\n\n  const isOculusBrowser = /Oculus/.test(ua);\n\n  const screen = isMobileVR\n    ? VR_DEVICE_AVAILABILITY.no\n    : isIDevice && isUIWebView\n      ? VR_DEVICE_AVAILABILITY.maybe\n      : VR_DEVICE_AVAILABILITY.yes;\n\n  // HACK -- we prompt the user to install firefox if they click the VR button on a non-WebVR compatible\n  // browser. Without this check if you have FF on Mac/Linux you'll get the confusing flow of having a\n  // VR button but then being asked to download FF.\n  const isNonWebVRFirefox = !isWebVRCapableBrowser && isFirefoxBrowser;\n  let generic = isMobile || isNonWebVRFirefox ? VR_DEVICE_AVAILABILITY.no : VR_DEVICE_AVAILABILITY.maybe;\n  let cardboard = VR_DEVICE_AVAILABILITY.no;\n\n  // We only consider GearVR support as \"maybe\" and never \"yes\". The only browser\n  // that will detect GearVR outside of VR is Samsung Internet, and we'd prefer to launch into Oculus\n  // Browser for now since Samsung Internet requires an additional WebVR installation + flag, so return \"maybe\".\n  //\n  // If we are in Oculus Browser (ie, we are literally wearing a GearVR) then return 'yes'.\n  let gearvr = VR_DEVICE_AVAILABILITY.no;\n  if (isMaybeGearVRCompatibleDevice(ua)) {\n    gearvr = isOculusBrowser ? VR_DEVICE_AVAILABILITY.yes : VR_DEVICE_AVAILABILITY.maybe;\n  }\n\n  // For daydream detection, we first check if they are on an Android compatible device, and assume they\n  // may support daydream *unless* this browser has WebVR capabilities, in which case we can do better.\n  let daydream =\n    isMaybeDaydreamCompatibleDevice(ua) && !isMobileVR ? VR_DEVICE_AVAILABILITY.maybe : VR_DEVICE_AVAILABILITY.no;\n\n  cardboard =\n    isCardboardCapableBrowser && displays.find(d => d.capabilities.canPresent && /cardboard/i.test(d.displayName))\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n  if (isWebVRCapableBrowser) {\n    // Generic is supported for allowed devices and presentable HMDs.\n    generic = displays.find(\n      d => d.capabilities.canPresent && !GENERIC_ENTRY_TYPE_DISALLOWED_DEVICES.find(r => r.test(d.displayName))\n    )\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n    // For daydream detection, in a WebVR browser we can increase confidence in daydream compatibility.\n    const hasDaydreamWebVRDevice = displays.find(d => /daydream/i.test(d.displayName));\n\n    if (hasDaydreamWebVRDevice) {\n      // If we detected daydream via WebVR\n      daydream = VR_DEVICE_AVAILABILITY.yes;\n      generic = VR_DEVICE_AVAILABILITY.no;\n    } else if (isDaydreamCapableBrowser) {\n      // If we didn't detect daydream in a daydream capable browser, we definitely can't run daydream at all.\n      daydream = VR_DEVICE_AVAILABILITY.no;\n    }\n  }\n\n  if (isWebXRCapableBrowser) {\n    generic = true;\n  }\n\n  return { screen, generic, gearvr, daydream, cardboard, safari };\n}\n\nexport const ONLY_SCREEN_AVAILABLE = {\n  screen: VR_DEVICE_AVAILABILITY.yes,\n  generic: VR_DEVICE_AVAILABILITY.no,\n  gearvr: VR_DEVICE_AVAILABILITY.no,\n  daydream: VR_DEVICE_AVAILABILITY.no,\n  cardboard: VR_DEVICE_AVAILABILITY.no,\n  safari: VR_DEVICE_AVAILABILITY.no\n};\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\nexport function canShare() {\n  // TODO, fix up when OB/FxR support sharing\n  return navigator.share && !isMobileVR;\n}\n\n/**\n * Wraps navigator.share with a fallback to twitter for unsupported browsers\n */\nexport function share(opts) {\n  if (canShare()) {\n    return navigator.share(opts);\n  } else {\n    const { title, url } = opts;\n    const width = 550;\n    const height = 420;\n    const left = (screen.width - width) / 2;\n    const top = (screen.height - height) / 2;\n    const params = `scrollbars=no,menubar=no,toolbar=no,status=no,width=${width},height=${height},top=${top},left=${left}`;\n    const tweetLink = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(\n      title\n    )}`;\n    window.open(tweetLink, \"_blank\", params);\n    return Promise.resolve();\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"interstitial\":\"ui-root__interstitial__Ic8QU\",\"ui\":\"ui-root__ui__DMhNQ\",\"no-default-button-style\":\"ui-root__no-default-button-style__OVVW8\",\"noDefaultButtonStyle\":\"ui-root__no-default-button-style__OVVW8\",\"avatar-editor\":\"ui-root__avatar-editor__VDEEJ\",\"avatarEditor\":\"ui-root__avatar-editor__VDEEJ\"};","// extracted by mini-css-extract-plugin\nexport default {\"hide-lg\":\"style-utils__hide-lg__rXFJz\",\"hideLg\":\"style-utils__hide-lg__rXFJz\",\"show-lg\":\"style-utils__show-lg__UpSEb\",\"showLg\":\"style-utils__show-lg__UpSEb\",\"margin-0\":\"style-utils__margin-0__KkfJM\",\"margin0\":\"style-utils__margin-0__KkfJM\",\"textError\":\"style-utils__textError__ySIF5\",\"2xs-margin-y\":\"style-utils__2xs-margin-y__dz6I9\",\"2XsMarginY\":\"style-utils__2xs-margin-y__dz6I9\",\"2xs-margin-r\":\"style-utils__2xs-margin-r__s05Qm\",\"2XsMarginR\":\"style-utils__2xs-margin-r__s05Qm\",\"2xs-margin-l\":\"style-utils__2xs-margin-l__a4wdt\",\"2XsMarginL\":\"style-utils__2xs-margin-l__a4wdt\",\"2xs-margin-bottom\":\"style-utils__2xs-margin-bottom__InDYJ\",\"2XsMarginBottom\":\"style-utils__2xs-margin-bottom__InDYJ\",\"2xs-margin-top\":\"style-utils__2xs-margin-top__ncUYG\",\"2XsMarginTop\":\"style-utils__2xs-margin-top__ncUYG\",\"2xs-padding\":\"style-utils__2xs-padding__Fy_1J\",\"2XsPadding\":\"style-utils__2xs-padding__Fy_1J\",\"2xs-wrap-margin\":\"style-utils__2xs-wrap-margin__s10xt\",\"2XsWrapMargin\":\"style-utils__2xs-wrap-margin__s10xt\",\"xs-margin-y\":\"style-utils__xs-margin-y__Ko8vB\",\"xsMarginY\":\"style-utils__xs-margin-y__Ko8vB\",\"xs-margin-r\":\"style-utils__xs-margin-r__YUwDE\",\"xsMarginR\":\"style-utils__xs-margin-r__YUwDE\",\"xs-margin-l\":\"style-utils__xs-margin-l__JFZpu\",\"xsMarginL\":\"style-utils__xs-margin-l__JFZpu\",\"xs-margin-bottom\":\"style-utils__xs-margin-bottom__THXKr\",\"xsMarginBottom\":\"style-utils__xs-margin-bottom__THXKr\",\"xs-margin-top\":\"style-utils__xs-margin-top__PHtKS\",\"xsMarginTop\":\"style-utils__xs-margin-top__PHtKS\",\"xs-padding\":\"style-utils__xs-padding__zn2Bm\",\"xsPadding\":\"style-utils__xs-padding__zn2Bm\",\"xs-wrap-margin\":\"style-utils__xs-wrap-margin__ud4Ol\",\"xsWrapMargin\":\"style-utils__xs-wrap-margin__ud4Ol\",\"sm-margin-y\":\"style-utils__sm-margin-y__qkaiv\",\"smMarginY\":\"style-utils__sm-margin-y__qkaiv\",\"sm-margin-r\":\"style-utils__sm-margin-r__wO0mi\",\"smMarginR\":\"style-utils__sm-margin-r__wO0mi\",\"sm-margin-l\":\"style-utils__sm-margin-l__ikRsW\",\"smMarginL\":\"style-utils__sm-margin-l__ikRsW\",\"sm-margin-bottom\":\"style-utils__sm-margin-bottom__sL7g3\",\"smMarginBottom\":\"style-utils__sm-margin-bottom__sL7g3\",\"sm-margin-top\":\"style-utils__sm-margin-top__sx7cP\",\"smMarginTop\":\"style-utils__sm-margin-top__sx7cP\",\"sm-padding\":\"style-utils__sm-padding__NGuEN\",\"smPadding\":\"style-utils__sm-padding__NGuEN\",\"sm-wrap-margin\":\"style-utils__sm-wrap-margin__KdMMC\",\"smWrapMargin\":\"style-utils__sm-wrap-margin__KdMMC\",\"md-margin-y\":\"style-utils__md-margin-y__HzmWb\",\"mdMarginY\":\"style-utils__md-margin-y__HzmWb\",\"md-margin-r\":\"style-utils__md-margin-r__DpiDI\",\"mdMarginR\":\"style-utils__md-margin-r__DpiDI\",\"md-margin-l\":\"style-utils__md-margin-l__DcpHY\",\"mdMarginL\":\"style-utils__md-margin-l__DcpHY\",\"md-margin-bottom\":\"style-utils__md-margin-bottom__u4Yw9\",\"mdMarginBottom\":\"style-utils__md-margin-bottom__u4Yw9\",\"md-margin-top\":\"style-utils__md-margin-top__wJzyR\",\"mdMarginTop\":\"style-utils__md-margin-top__wJzyR\",\"md-padding\":\"style-utils__md-padding__yDslX\",\"mdPadding\":\"style-utils__md-padding__yDslX\",\"md-wrap-margin\":\"style-utils__md-wrap-margin__Zq10k\",\"mdWrapMargin\":\"style-utils__md-wrap-margin__Zq10k\",\"lg-margin-y\":\"style-utils__lg-margin-y__f5CMV\",\"lgMarginY\":\"style-utils__lg-margin-y__f5CMV\",\"lg-margin-r\":\"style-utils__lg-margin-r__osZ3t\",\"lgMarginR\":\"style-utils__lg-margin-r__osZ3t\",\"lg-margin-l\":\"style-utils__lg-margin-l__UZ8fF\",\"lgMarginL\":\"style-utils__lg-margin-l__UZ8fF\",\"lg-margin-bottom\":\"style-utils__lg-margin-bottom__SuMJj\",\"lgMarginBottom\":\"style-utils__lg-margin-bottom__SuMJj\",\"lg-margin-top\":\"style-utils__lg-margin-top__TYCaC\",\"lgMarginTop\":\"style-utils__lg-margin-top__TYCaC\",\"lg-padding\":\"style-utils__lg-padding__mUNzR\",\"lgPadding\":\"style-utils__lg-padding__mUNzR\",\"lg-wrap-margin\":\"style-utils__lg-wrap-margin__cvqUC\",\"lgWrapMargin\":\"style-utils__lg-wrap-margin__cvqUC\",\"xl-margin-y\":\"style-utils__xl-margin-y__huAwr\",\"xlMarginY\":\"style-utils__xl-margin-y__huAwr\",\"xl-margin-r\":\"style-utils__xl-margin-r__TU7TF\",\"xlMarginR\":\"style-utils__xl-margin-r__TU7TF\",\"xl-margin-l\":\"style-utils__xl-margin-l__GOXHe\",\"xlMarginL\":\"style-utils__xl-margin-l__GOXHe\",\"xl-margin-bottom\":\"style-utils__xl-margin-bottom__kKLk8\",\"xlMarginBottom\":\"style-utils__xl-margin-bottom__kKLk8\",\"xl-margin-top\":\"style-utils__xl-margin-top__l08YH\",\"xlMarginTop\":\"style-utils__xl-margin-top__l08YH\",\"xl-padding\":\"style-utils__xl-padding__gDLaP\",\"xlPadding\":\"style-utils__xl-padding__gDLaP\",\"xl-wrap-margin\":\"style-utils__xl-wrap-margin__kSktP\",\"xlWrapMargin\":\"style-utils__xl-wrap-margin__kSktP\",\"flex-basis-10\":\"style-utils__flex-basis-10__JK7ed\",\"flexBasis10\":\"style-utils__flex-basis-10__JK7ed\",\"flex-basis-20\":\"style-utils__flex-basis-20__WYUCu\",\"flexBasis20\":\"style-utils__flex-basis-20__WYUCu\",\"flex-basis-30\":\"style-utils__flex-basis-30___o3Vd\",\"flexBasis30\":\"style-utils__flex-basis-30___o3Vd\",\"flex-basis-40\":\"style-utils__flex-basis-40__wf3lt\",\"flexBasis40\":\"style-utils__flex-basis-40__wf3lt\",\"flex-basis-50\":\"style-utils__flex-basis-50__Or9Ki\",\"flexBasis50\":\"style-utils__flex-basis-50__Or9Ki\",\"flex-basis-60\":\"style-utils__flex-basis-60__Vfos3\",\"flexBasis60\":\"style-utils__flex-basis-60__Vfos3\",\"flex-basis-70\":\"style-utils__flex-basis-70__R1zxM\",\"flexBasis70\":\"style-utils__flex-basis-70__R1zxM\",\"flex-basis-80\":\"style-utils__flex-basis-80__nZyZw\",\"flexBasis80\":\"style-utils__flex-basis-80__nZyZw\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Route } from \"react-router\";\n\n/**\n * A react-router Route that looks for a key/value pair in the state to render something.\n */\nclass StateRoute extends React.Component {\n  static propTypes = {\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    history: PropTypes.object\n  };\n\n  render() {\n    const { history, stateKey, stateValue, ...routeProps } = this.props;\n\n    if (\n      (!history.location.state && !stateValue) ||\n      (history.location.state &&\n        (history.location.state[stateKey] === stateValue || (!history.location.state[stateKey] && !stateValue)))\n    ) {\n      return <Route path=\"/\" {...routeProps} />;\n    }\n\n    return null;\n  }\n}\n\nexport default StateRoute;\n","const MIC_PRESENCE_VOLUME_THRESHOLD = 0.00001;\n\nexport const getMicrophonePresences = (() => {\n  const microphonePresences = new Map();\n  const sessionIds = [];\n  const currentSessionIds = [];\n  return function() {\n    if (!window.APP || !window.APP.componentRegistry) {\n      return null;\n    }\n\n    const sceneEl = AFRAME.scenes[0];\n\n    currentSessionIds.length = 0;\n\n    const playerInfos = window.APP.componentRegistry[\"player-info\"];\n    if (playerInfos) {\n      for (let i = 0; i < playerInfos.length; i++) {\n        const playerInfo = playerInfos[i];\n        const playerSessionId = playerInfo.playerSessionId;\n        let talking = false;\n        if (playerInfo.isLocalPlayerInfo) {\n          talking = sceneEl.systems[\"local-audio-analyser\"].volume > MIC_PRESENCE_VOLUME_THRESHOLD;\n        }\n        if (sessionIds.indexOf(playerSessionId) === -1) {\n          sessionIds.push(playerSessionId);\n        }\n        currentSessionIds.push(playerSessionId);\n        if (microphonePresences.has(playerSessionId)) {\n          const presence = microphonePresences.get(playerSessionId);\n          presence.muted = playerInfo.data.muted;\n          presence.talking = talking;\n        } else {\n          microphonePresences.set(playerSessionId, { muted: playerInfo.data.muted, talking });\n        }\n      }\n    }\n\n    const networkedAudioAnalysers = window.APP.componentRegistry[\"networked-audio-analyser\"];\n    if (networkedAudioAnalysers) {\n      for (let i = 0; i < networkedAudioAnalysers.length; i++) {\n        const networkedAudioAnalyser = networkedAudioAnalysers[i];\n        if (\n          microphonePresences.has(networkedAudioAnalyser.playerSessionId) &&\n          networkedAudioAnalyser.volume > MIC_PRESENCE_VOLUME_THRESHOLD\n        ) {\n          microphonePresences.get(networkedAudioAnalyser.playerSessionId).talking = true;\n        }\n      }\n    }\n\n    for (let i = sessionIds.length - 1; i >= 0; i--) {\n      const sessionId = sessionIds[i];\n      if (currentSessionIds.indexOf(sessionId) === -1) {\n        microphonePresences.delete(sessionId);\n        sessionIds.splice(i, 1);\n      }\n    }\n\n    return microphonePresences;\n  };\n})();\n","// extracted by mini-css-extract-plugin\nexport default {\"sidebar\":\"Sidebar__sidebar__KYENJ\",\"header\":\"Sidebar__header__zbsTL\",\"before-title\":\"Sidebar__before-title__SDmnu\",\"beforeTitle\":\"Sidebar__before-title__SDmnu\",\"after-title\":\"Sidebar__after-title__tQwef\",\"afterTitle\":\"Sidebar__after-title__tQwef\",\"content\":\"Sidebar__content__PP6Vz\",\"overflow-y\":\"Sidebar__overflow-y__iAkyO\",\"overflowY\":\"Sidebar__overflow-y__iAkyO\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Sidebar.scss\";\n\nexport function Sidebar({\n  title,\n  beforeTitle,\n  afterTitle,\n  children,\n  contentClassName,\n  className,\n  disableOverflowScroll\n}) {\n  return (\n    <div className={classNames(styles.sidebar, className)}>\n      {(title || beforeTitle || afterTitle) && (\n        <div className={styles.header}>\n          <div className={styles.beforeTitle}>{beforeTitle}</div>\n          <h5>{title}</h5>\n          <div className={styles.afterTitle}>{afterTitle}</div>\n        </div>\n      )}\n      <div className={classNames(styles.content, disableOverflowScroll ? \"\" : styles.overflowY, contentClassName)}>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nSidebar.propTypes = {\n  title: PropTypes.node,\n  beforeTitle: PropTypes.node,\n  afterTitle: PropTypes.node,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  contentClassName: PropTypes.string,\n  disableOverflowScroll: PropTypes.bool\n};\n\nSidebar.defaultProps = {\n  disableOverflowScroll: false\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"icon-button\":\"IconButton__icon-button__yRJAL\",\"iconButton\":\"IconButton__icon-button__yRJAL\",\"compact-sm\":\"IconButton__compact-sm__T7cFR\",\"compactSm\":\"IconButton__compact-sm__T7cFR\",\"lg\":\"IconButton__lg__CaPV3\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./IconButton.scss\";\nimport textInputStyles from \"./TextInput.scss\";\n\nexport const IconButton = memo(\n  forwardRef(({ className, as: ButtonComponent, compactSm, lg, children, ...rest }, ref) => {\n    const buttonProps = ButtonComponent === \"button\" ? { type: \"button\" } : {};\n\n    return (\n      <ButtonComponent\n        className={classNames(\n          styles.iconButton,\n          textInputStyles.iconButton,\n          { [styles.compactSm]: compactSm, [styles.lg]: lg },\n          className\n        )}\n        {...buttonProps}\n        {...rest}\n        ref={ref}\n      >\n        {children}\n      </ButtonComponent>\n    );\n  })\n);\n\nIconButton.propTypes = {\n  // compactSm makes the icon button shift to a vertical layout in the \"sm\" (mobile) breakpoint\n  compactSm: PropTypes.bool,\n  lg: PropTypes.bool,\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nIconButton.defaultProps = {\n  as: \"button\"\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"outer-wrapper\":\"TextInput__outer-wrapper__uRuYD\",\"outerWrapper\":\"TextInput__outer-wrapper__uRuYD\",\"input-wrapper\":\"TextInput__input-wrapper__uv7jY\",\"inputWrapper\":\"TextInput__input-wrapper__uv7jY\",\"before-input\":\"TextInput__before-input__PyF6b\",\"beforeInput\":\"TextInput__before-input__PyF6b\",\"after-input\":\"TextInput__after-input__gJzy3\",\"afterInput\":\"TextInput__after-input__gJzy3\",\"button\":\"TextInput__button__QrvX4\",\"icon-button\":\"TextInput__icon-button__GFPbS\",\"iconButton\":\"TextInput__icon-button__GFPbS\",\"disabled\":\"TextInput__disabled__tE3wE\",\"invalid\":\"TextInput__invalid__fgYQd\",\"text-input\":\"TextInput__text-input__HqvuV\",\"textInput\":\"TextInput__text-input__HqvuV\",\"invalid-icon\":\"TextInput__invalid-icon__CszSQ\",\"invalidIcon\":\"TextInput__invalid-icon__CszSQ\"};","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgClose = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17 17 3 3\",\n    stroke: \"currentColor\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17 3 3 17\",\n    stroke: \"currentColor\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgClose as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"lg\":\"CloseButton__lg__CMV4C\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as CloseIcon } from \"../icons/Close.svg\";\nimport styles from \"./CloseButton.scss\";\n\nexport function CloseButton({ lg, className, ...rest }) {\n  return (\n    <IconButton className={classNames({ [styles.lg]: lg }, className)} {...rest}>\n      <CloseIcon width={16} height={16} />\n    </IconButton>\n  );\n}\n\nCloseButton.propTypes = {\n  className: PropTypes.string,\n  lg: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"back-button\":\"BackButton__back-button__tGiDz\",\"backButton\":\"BackButton__back-button__tGiDz\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgChevronBack = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14 3-7 7 7 7\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgChevronBack as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./BackButton.scss\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as ChevronBackIcon } from \"../icons/ChevronBack.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function BackButton({ className, ...rest }) {\n  return (\n    <IconButton className={classNames(styles.backButton, className)} {...rest}>\n      <ChevronBackIcon />\n      <span>\n        <FormattedMessage id=\"back-button\" defaultMessage=\"Back\" />\n      </span>\n    </IconButton>\n  );\n}\n\nBackButton.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"button\":\"Button__button__SO7tb\",\"basic\":\"Button__basic__dX1eF\",\"transparent\":\"Button__transparent__Xwl1d\",\"primary\":\"Button__primary__V_Unf\",\"accept\":\"Button__accept__Vxz39\",\"cancel\":\"Button__cancel__fMd88\",\"accent1\":\"Button__accent1__YxQTQ\",\"accent2\":\"Button__accent2__csjI4\",\"accent3\":\"Button__accent3__lDoUQ\",\"accent4\":\"Button__accent4__rpZEP\",\"accent5\":\"Button__accent5__CtJzN\",\"accent6\":\"Button__accent6__f31oh\",\"sm\":\"Button__sm__SbzRJ\",\"lg\":\"Button__lg__W7ykj\",\"xl\":\"Button__xl__ppsaD\",\"thin\":\"Button__thin__QLHYO\",\"thick\":\"Button__thick__RwZJD\",\"signin\":\"Button__signin__dunbY\",\"landing\":\"Button__landing__zi2zl\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Button.scss\";\nimport textInputStyles from \"./TextInput.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport const presets = [\n  \"transparent\",\n  \"basic\",\n  \"primary\",\n  \"accept\",\n  \"cancel\",\n  \"accent1\",\n  \"accent2\",\n  \"accent3\",\n  \"accent4\",\n  \"accent5\",\n  \"accent6\",\n  \"landing\",\n  \"signin\"\n];\n\nexport const Button = memo(\n  forwardRef(({ as, sm, lg, xl, thin, thick, preset, className, children, ...rest }, ref) => {\n    const ButtonComponent = as;\n    const buttonProps = ButtonComponent === \"button\" ? { type: \"button\" } : {};\n\n    return (\n      <ButtonComponent\n        className={classNames(\n          styles.button,\n          textInputStyles.button,\n          styles[preset],\n          {\n            [styles.sm]: sm,\n            [styles.lg]: lg,\n            [styles.xl]: xl,\n            [styles.thin]: thin,\n            [styles.thick]: thick\n          },\n          className\n        )}\n        {...buttonProps}\n        {...rest}\n        ref={ref}\n      >\n        {children}\n      </ButtonComponent>\n    );\n  })\n);\n\nButton.propTypes = {\n  as: PropTypes.elementType,\n  preset: PropTypes.oneOf(presets),\n  className: PropTypes.string,\n  children: PropTypes.node,\n  sm: PropTypes.bool\n};\n\nButton.defaultProps = {\n  as: \"button\",\n  preset: \"basic\"\n};\n\nexport function NextButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.next\" defaultMessage=\"Next\" />\n    </Button>\n  );\n}\n\nexport function CancelButton(props) {\n  return (\n    <Button preset=\"cancel\" {...props}>\n      <FormattedMessage id=\"button.cancel\" defaultMessage=\"Cancel\" />\n    </Button>\n  );\n}\n\nexport function ContinueButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.continue\" defaultMessage=\"Continue\" />\n    </Button>\n  );\n}\n\nexport function AcceptButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.accept\" defaultMessage=\"Accept\" />\n    </Button>\n  );\n}\n\nexport function ApplyButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.apply\" defaultMessage=\"Apply\" />\n    </Button>\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"AvatarSettingsContent__content__Os6X7\",\"avatar-preview-container\":\"AvatarSettingsContent__avatar-preview-container__PmJlf\",\"avatarPreviewContainer\":\"AvatarSettingsContent__avatar-preview-container__PmJlf\"};","import React, { memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./InputField.scss\";\n\nexport const InputField = memo(\n  ({ id, htmlFor, label, error, description, className, fullWidth, children, ...rest }) => {\n    return (\n      <div className={classNames(styles.inputField, { [styles.fullWidth]: fullWidth }, className)} {...rest}>\n        {label && (\n          <label id={id} className={styles.label} htmlFor={htmlFor}>\n            {label}\n          </label>\n        )}\n        {children}\n        {error ? (\n          <small className={styles.error}>{error}</small>\n        ) : description ? (\n          <small className={styles.info}>{description}</small>\n        ) : (\n          undefined\n        )}\n      </div>\n    );\n  }\n);\n\nInputField.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  fullWidth: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"label\":\"InputField__label__gaP9K\",\"input-field\":\"InputField__input-field__L7dXt\",\"inputField\":\"InputField__input-field__L7dXt\",\"fullWidth\":\"InputField__fullWidth__BMV9Y\",\"error\":\"InputField__error__xVt9D\",\"info\":\"InputField__info__KHxQ_\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgWarning = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.343 17.43h13.314a1.25 1.25 0 0 0 1.1-1.842L11.102 3.223a1.25 1.25 0 0 0-2.202 0L2.242 15.588a1.25 1.25 0 0 0 1.1 1.842v0Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.776 7.632 10 12.398l.224-4.764a.225.225 0 0 0-.227-.234v0a.224.224 0 0 0-.221.232v0Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 15.517a.782.782 0 1 1 0-1.563.782.782 0 0 1 0 1.563Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgWarning as ReactComponent };","import screenfull from \"screenfull\";\nimport { showFullScreenIfWasFullScreen } from \"./fullscreen\";\nconst { detect } = require(\"detect-browser\");\n\nconst browser = detect();\nlet isExitingFullscreenDueToFocus = false;\n\n// Utility function that handles a bunch of incidental stuff related to text fields:\n//\n// - On non-mobile platforms, selects the value on focus\n// - If full screen, exits/enters full screen because of firefox full screen issues\nexport function handleTextFieldFocus(target) {\n  if (!window.AFRAME) return;\n  const isMobile = AFRAME.utils.device.isMobile();\n\n  if (screenfull.isFullscreen && !AFRAME.utils.device.isMobileVR() && browser.name === \"firefox\") {\n    // This will prevent focus, but its the only way to avoid getting into a\n    // weird \"firefox reports full screen but actually not\". You end up having to tap\n    // twice to ultimately get the focus.\n    //\n    // We need to keep track of a bit here so that we don't re-full screen when\n    // the text box is blurred by the browser.\n\n    isExitingFullscreenDueToFocus = true;\n    screenfull.exit().then(() => {\n      target.focus();\n    });\n  }\n\n  if (!isMobile) target.select();\n}\n\nexport function handleTextFieldBlur() {\n  // This is the incidental blur event when exiting fullscreen mode on mobile\n  if (isExitingFullscreenDueToFocus) {\n    isExitingFullscreenDueToFocus = false;\n    return;\n  }\n\n  showFullScreenIfWasFullScreen();\n}\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./TextInput.scss\";\nimport { ReactComponent as WarningIcon } from \"../icons/Warning.svg\";\nimport buttonStyles from \"./Button.scss\";\nimport iconButtonStyles from \"./IconButton.scss\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../../utils/focus-utils\";\n\nexport const TextInput = memo(\n  forwardRef(\n    (\n      {\n        id,\n        disabled,\n        invalid,\n        className,\n        beforeInput,\n        afterInput,\n        onFocus,\n        onBlur,\n        textInputStyles,\n        as: InputElement,\n        ...rest\n      },\n      ref\n    ) => {\n      // TODO: This is REALLY bad. We're overriding default behavior of text inputs to get a fullscreen behavior to work on Firefox.\n      // It also selects the contents of the text input which is not always something you want to do. If we can remove this, we absolutely should.\n      const handleFocus = e => {\n        handleTextFieldFocus(e.target);\n\n        if (onFocus) {\n          onFocus(e);\n        }\n      };\n\n      const handleBlur = e => {\n        handleTextFieldBlur();\n\n        if (onBlur) {\n          onBlur(e);\n        }\n      };\n\n      return (\n        <div\n          className={classNames(\n            styles.outerWrapper,\n            buttonStyles.inputGroup,\n            iconButtonStyles.inputGroup,\n            { [styles.invalid]: invalid, [styles.disabled]: disabled },\n            className\n          )}\n        >\n          <div className={styles.beforeInput}>{beforeInput}</div>\n          <div className={styles.inputWrapper}>\n            <InputElement\n              id={id}\n              className={classNames(styles.textInput, textInputStyles)}\n              disabled={disabled}\n              onFocus={handleFocus}\n              onBlur={handleBlur}\n              {...rest}\n              ref={ref}\n            />\n          </div>\n          <div className={styles.afterInput}>\n            {invalid && <WarningIcon className={styles.invalidIcon} />}\n            {afterInput}\n          </div>\n        </div>\n      );\n    }\n  )\n);\n\nTextInput.propTypes = {\n  id: PropTypes.string.isRequired,\n  disabled: PropTypes.bool,\n  invalid: PropTypes.bool,\n  className: PropTypes.string,\n  onChange: PropTypes.func,\n  beforeInput: PropTypes.node,\n  afterInput: PropTypes.node,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  textInputStyles: PropTypes.string,\n  as: PropTypes.elementType\n};\n\nTextInput.defaultProps = {\n  onChange: () => {},\n  as: \"input\"\n};\n","import { useState } from \"react\";\n\nconst idPrefix = \"id_\";\n\nlet nextId = 0;\n\n// Note: React 17 introduced the experimental unstable_useOpaqueIdentifier hook. We'll want to switch to this in the future.\nexport function useId() {\n  const [id] = useState(() => idPrefix + nextId++);\n  return id;\n}\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { TextInput } from \"./TextInput\";\nimport { useId } from \"./useId\";\n\nexport const TextInputField = memo(\n  forwardRef(({ className, error, description, inputClassName, label, fullWidth, ...rest }, ref) => {\n    const id = useId();\n    const labelId = useId();\n\n    return (\n      <InputField\n        id={labelId}\n        htmlFor={id}\n        className={className}\n        label={label}\n        error={error}\n        description={description}\n        fullWidth={fullWidth}\n      >\n        <TextInput id={id} ref={ref} className={inputClassName} {...rest} />\n      </InputField>\n    );\n  })\n);\n\nTextInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  fullWidth: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"column\":\"Column__column__ZuRI0\",\"xs-gap\":\"Column__xs-gap__PAIcR\",\"xsGap\":\"Column__xs-gap__PAIcR\",\"sm-gap\":\"Column__sm-gap__j3Pc1\",\"smGap\":\"Column__sm-gap__j3Pc1\",\"md-gap\":\"Column__md-gap__YLriB\",\"mdGap\":\"Column__md-gap__YLriB\",\"lg-gap\":\"Column__lg-gap__ferMl\",\"lgGap\":\"Column__lg-gap__ferMl\",\"xl-gap\":\"Column__xl-gap__mso6a\",\"xlGap\":\"Column__xl-gap__mso6a\",\"xs-padding\":\"Column__xs-padding__vnqZ1\",\"xsPadding\":\"Column__xs-padding__vnqZ1\",\"sm-padding\":\"Column__sm-padding__DvAmG\",\"smPadding\":\"Column__sm-padding__DvAmG\",\"md-padding\":\"Column__md-padding__k6ZWh\",\"mdPadding\":\"Column__md-padding__k6ZWh\",\"lg-padding\":\"Column__lg-padding__SlnQw\",\"lgPadding\":\"Column__lg-padding__SlnQw\",\"xl-padding\":\"Column__xl-padding__TOmJS\",\"xlPadding\":\"Column__xl-padding__TOmJS\",\"center\":\"Column__center__kI2HA\",\"center-vertical\":\"Column__center-vertical__Uzq_X\",\"centerVertical\":\"Column__center-vertical__Uzq_X\",\"center-md\":\"Column__center-md__fjQvr\",\"centerMd\":\"Column__center-md__fjQvr\",\"center-vertical-md\":\"Column__center-vertical-md__cpCgX\",\"centerVerticalMd\":\"Column__center-vertical-md__cpCgX\",\"grow\":\"Column__grow__DxOwX\",\"overflow\":\"Column__overflow__NUMaz\",\"margin-0-last-child\":\"Column__margin-0-last-child__aJIlP\",\"margin0LastChild\":\"Column__margin-0-last-child__aJIlP\"};","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Column.scss\";\n\nexport const Column = forwardRef(\n  (\n    { as: Component, lastChildMargin, className, gap, padding, center, centerMd, grow, overflow, children, ...rest },\n    ref\n  ) => {\n    const gapClass = gap === true ? styles.mdGap : styles[`${gap}Gap`];\n    const paddingClass = padding === true ? styles.lgPadding : styles[`${padding}Padding`];\n\n    return (\n      <Component\n        {...rest}\n        ref={ref}\n        className={classNames(\n          styles.column,\n          gapClass,\n          paddingClass,\n          {\n            [styles.center]: center === true || center === \"horizontal\" || center === \"both\",\n            [styles.centerVertical]: center === \"vertical\" || center === \"both\",\n            [styles.centerMd]: centerMd === true || centerMd === \"horizontal\" || centerMd === \"both\",\n            [styles.centerVerticalMd]: centerMd === \"vertical\" || centerMd === \"both\",\n            [styles.grow]: grow,\n            [styles.overflow]: overflow,\n            [styles.margin0LastChild]: lastChildMargin\n          },\n          className\n        )}\n      >\n        {children}\n      </Component>\n    );\n  }\n);\n\nColumn.propTypes = {\n  as: PropTypes.elementType,\n  className: PropTypes.string,\n  children: PropTypes.node,\n  gap: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  padding: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  centerMd: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  center: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  grow: PropTypes.bool,\n  lastChildMargin: PropTypes.bool,\n  overflow: PropTypes.bool\n};\n\nColumn.defaultProps = {\n  as: \"div\",\n  gap: \"md\",\n  center: false,\n  centerMd: false,\n  padding: false,\n  grow: false,\n  overflow: false,\n  lastChildMargin: true\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Button, AcceptButton } from \"../input/Button\";\nimport styles from \"./AvatarSettingsContent.scss\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function AvatarSettingsContent({\n  displayName,\n  displayNameInputRef,\n  disableDisplayNameInput,\n  onChangeDisplayName,\n  avatarPreview,\n  displayNamePattern,\n  onChangeAvatar,\n  ...rest\n}) {\n  return (\n    <Column as=\"form\" className={styles.content} {...rest}>\n      <TextInputField\n        disabled={disableDisplayNameInput}\n        label={<FormattedMessage id=\"avatar-settings-content.display-name-label\" defaultMessage=\"Display Name\" />}\n        value={displayName}\n        pattern={displayNamePattern}\n        spellCheck=\"false\"\n        required\n        onChange={onChangeDisplayName}\n        description={\n          <FormattedMessage\n            id=\"avatar-settings-content.display-name-description\"\n            defaultMessage=\"Alphanumerics, hyphens, underscores, and tildes. At least 3 characters, no more than 32\"\n          />\n        }\n        ref={displayNameInputRef}\n      />\n      <div className={styles.avatarPreviewContainer}>\n        {avatarPreview || <div />}\n        <Button type=\"button\" preset=\"basic\" onClick={onChangeAvatar}>\n          <FormattedMessage id=\"avatar-settings-content.change-avatar-button\" defaultMessage=\"Change Avatar\" />\n        </Button>\n      </div>\n      <AcceptButton preset=\"accept\" type=\"submit\" />\n    </Column>\n  );\n}\n\nAvatarSettingsContent.propTypes = {\n  className: PropTypes.string,\n  displayName: PropTypes.string,\n  displayNameInputRef: PropTypes.func,\n  disableDisplayNameInput: PropTypes.bool,\n  displayNamePattern: PropTypes.string,\n  onChangeDisplayName: PropTypes.func,\n  avatarPreview: PropTypes.node,\n  onChangeAvatar: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { BackButton } from \"../input/BackButton\";\nimport { AvatarSettingsContent } from \"./AvatarSettingsContent\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function AvatarSettingsSidebar({ className, showBackButton, onBack, onClose, ...rest }) {\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"avatar-settings-sidebar.title\" defaultMessage=\"Avatar Settings\" />}\n      beforeTitle={showBackButton ? <BackButton onClick={onBack} /> : <CloseButton onClick={onClose} />}\n      className={className}\n    >\n      <AvatarSettingsContent {...rest} />\n    </Sidebar>\n  );\n}\n\nAvatarSettingsSidebar.propTypes = {\n  showBackButton: PropTypes.bool,\n  className: PropTypes.string,\n  onBack: PropTypes.func,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"modal\":\"Modal__modal__kXfrn\",\"header\":\"Modal__header__Y8MjO\",\"before-title\":\"Modal__before-title___noRj\",\"beforeTitle\":\"Modal__before-title___noRj\",\"after-title\":\"Modal__after-title__i3h06\",\"afterTitle\":\"Modal__after-title__i3h06\",\"content\":\"Modal__content__qgHt_\",\"sm-fullscreen\":\"Modal__sm-fullscreen__XA0fq\",\"smFullscreen\":\"Modal__sm-fullscreen__XA0fq\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Modal.scss\";\n\nexport function Modal({\n  title,\n  titleNode,\n  beforeTitle,\n  afterTitle,\n  children,\n  contentClassName,\n  className,\n  disableFullscreen\n}) {\n  return (\n    <div className={classNames(styles.modal, { [styles.smFullscreen]: !disableFullscreen }, className)}>\n      {(title || beforeTitle || afterTitle) && (\n        <div className={styles.header}>\n          <div className={styles.beforeTitle}>{beforeTitle}</div>\n          {titleNode ? titleNode : <h5>{title}</h5>}\n          <div className={styles.afterTitle}>{afterTitle}</div>\n        </div>\n      )}\n      <div className={classNames(styles.content, contentClassName)}>{children}</div>\n    </div>\n  );\n}\n\nModal.propTypes = {\n  title: PropTypes.node,\n  titleNode: PropTypes.node,\n  beforeTitle: PropTypes.node,\n  afterTitle: PropTypes.node,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  contentClassName: PropTypes.string,\n  disableFullscreen: PropTypes.bool\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { BackButton } from \"../input/BackButton\";\nimport { AvatarSettingsContent } from \"./AvatarSettingsContent\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function AvatarSetupModal({ className, onBack, ...rest }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"avatar-setup-sidebar.title\" defaultMessage=\"Avatar Setup\" />}\n      beforeTitle={<BackButton onClick={onBack} />}\n      className={className}\n    >\n      <AvatarSettingsContent {...rest} />\n    </Modal>\n  );\n}\n\nAvatarSetupModal.propTypes = {\n  className: PropTypes.string,\n  onBack: PropTypes.func\n};\n","import cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBAFormat;\n  return texture;\n}\n","export const createImageBitmap =\n  window.createImageBitmap ||\n  async function(data) {\n    return new Promise(resolve => {\n      // https://dev.to/nektro/createimagebitmap-polyfill-for-safari-and-edge-228\n      // https://gist.github.com/MonsieurV/fb640c29084c171b4444184858a91bc7\n\n      let srcUrl;\n      if (data instanceof Blob) {\n        srcUrl = URL.createObjectURL(data);\n      } else {\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        canvas.width = data.width;\n        canvas.height = data.height;\n        ctx.putImageData(data, 0, 0);\n        srcUrl = canvas.toDataURL();\n      }\n      const img = document.createElement(\"img\");\n\n      img.addEventListener(\"load\", () => resolve(img));\n\n      img.src = srcUrl;\n    });\n  };\n\nexport function disposeImageBitmap(imageBitmap) {\n  if (imageBitmap instanceof HTMLImageElement && imageBitmap.src.startsWith(\"blob:\")) {\n    URL.revokeObjectURL(imageBitmap.src);\n  } else {\n    imageBitmap.close && imageBitmap.close();\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"preview\":\"avatar-preview__preview__Exp7B\"};","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport { getColorSchemePref } from \"../utils/get-color-scheme-pref\";\nimport classNames from \"classnames\";\n\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\n\nimport { createDefaultEnvironmentMap } from \"../components/environment-map\";\nimport { loadGLTF } from \"../components/gltf-model-plus\";\nimport { disposeNode, findNode } from \"../utils/three-utils\";\nimport { ensureAvatarMaterial, MAT_NAME } from \"../utils/avatar-utils\";\nimport { createImageBitmap, disposeImageBitmap } from \"../utils/image-bitmap-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport styles from \"../assets/stylesheets/avatar-preview.scss\";\n\nconst TEXTURE_PROPS = {\n  base_map: [\"map\"],\n  emissive_map: [\"emissiveMap\"],\n  normal_map: [\"normalMap\"],\n  orm_map: [\"aoMap\", \"roughnessMap\", \"metalnessMap\"]\n};\n\nconst ALL_MAPS = Object.keys(TEXTURE_PROPS);\n\n// This should match our aframe renderer=\"antialias: true; colorManagement: true; sortObjects: true;\n// physicallyCorrectLights: true; webgl2: true; multiview: false;\"\nfunction createRenderer(canvas, alpha = false, useDevicePixelRatio = true) {\n  const context = canvas.getContext(\"webgl2\", {\n    alpha,\n    depth: true,\n    antialias: true,\n    premultipliedAlpha: true,\n    preserveDrawingBuffer: false,\n    powerPreference: \"default\"\n  });\n\n  const renderer = new THREE.WebGLRenderer({ alpha, canvas, context, forceWebVR: true });\n  renderer.outputEncoding = THREE.sRGBEncoding;\n  renderer.physicallyCorrectLights = true;\n  if (useDevicePixelRatio) {\n    renderer.setPixelRatio(window.devicePixelRatio);\n  }\n  return renderer;\n}\n\nconst createImageBitmapFromURL = url =>\n  fetch(url)\n    .then(r => r.blob())\n    .then(createImageBitmap);\n\nconst ORBIT_ANGLE = new THREE.Euler(-30 * THREE.MathUtils.DEG2RAD, 30 * THREE.MathUtils.DEG2RAD, 0);\nconst DEFAULT_MARGIN = 1;\n\nfunction fitBoxInFrustum(camera, box, center, margin = DEFAULT_MARGIN) {\n  const halfYExtents = Math.max(box.max.y - center.y, center.y - box.min.y);\n  const halfVertFOV = THREE.MathUtils.degToRad(camera.fov / 2);\n  camera.position.set(0, 0, (halfYExtents / Math.tan(halfVertFOV) + box.max.z) * margin);\n  camera.position.applyEuler(ORBIT_ANGLE);\n  camera.position.add(center);\n  camera.lookAt(center);\n}\n\nfunction getThemeBackground() {\n  const currentTheme = APP?.store?.state?.preferences?.theme;\n  const themes = window.APP_CONFIG?.theme?.themes;\n  const currentThemeObject = themes?.find(t => t.id === currentTheme) || getColorSchemePref();\n  const previewBackgroundColor = new THREE.Color(currentThemeObject?.variables[\"background3-color\"] || 0xeaeaea);\n  return previewBackgroundColor;\n}\n\nclass AvatarPreview extends Component {\n  static propTypes = {\n    avatarGltfUrl: PropTypes.string,\n    className: PropTypes.string,\n    onGltfLoaded: PropTypes.func\n  };\n  constructor(props) {\n    super(props);\n    this.state = { loading: true, error: null };\n    this.avatar = null;\n    this.imageBitmaps = {};\n    this.mounted = false;\n  }\n\n  componentDidMount = () => {\n    this.scene = new THREE.Scene();\n\n    this.camera = new THREE.PerspectiveCamera(55, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 1000);\n    this.controls = new OrbitControls(this.camera, this.canvas);\n    this.controls.screenSpacePanning = true;\n    this.controls.enableKeys = true;\n\n    const light = new THREE.DirectionalLight(0xf7f6ef, 1);\n    light.position.set(0, 10, 10);\n    this.scene.add(light);\n    this.scene.add(new THREE.HemisphereLight(0xb1e3ff, 0xb1e3ff, 2.5));\n\n    this.loadId = 0;\n\n    this.camera.position.set(-0.2, 0.5, 0.5);\n    this.camera.matrixAutoUpdate = true;\n\n    this.controls.target.set(0, 0.45, 0);\n    this.controls.update();\n\n    if (this.props.avatarGltfUrl) {\n      this.loadCurrentAvatarGltfUrl();\n    }\n\n    const clock = new THREE.Clock();\n\n    this.snapshotCanvas = document.createElement(\"canvas\");\n    this.snapshotCanvas.width = 720;\n    this.snapshotCanvas.height = 1280;\n    this.snapshotCamera = new THREE.PerspectiveCamera(55, 720 / 1280, 0.1, 1000);\n    this.snapshotCamera.matrixAutoUpdate = true;\n    this.snapshotRenderer = createRenderer(this.snapshotCanvas, true, false);\n    this.snapshotRenderer.setClearAlpha(0);\n\n    this.previewRenderer = createRenderer(this.canvas);\n    this.previewRenderer.setClearColor(getThemeBackground());\n    this.previewRenderer.setAnimationLoop(() => {\n      const dt = clock.getDelta();\n      this.mixer && this.mixer.update(dt);\n      this.previewRenderer.render(this.scene, this.camera);\n    });\n    window.addEventListener(\"resize\", this.resize);\n    this.resize();\n\n    this.mounted = true;\n  };\n\n  resize = () => {\n    const width = this.canvas.parentElement.offsetWidth;\n    const height = this.canvas.parentElement.offsetHeight;\n    this.previewRenderer.setSize(width, height);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  };\n\n  setAvatar = avatar => {\n    if (!avatar) return;\n    this.avatar = avatar;\n    this.scene.add(avatar);\n    this.resetCamera();\n    this.setState({ error: null, loading: false });\n  };\n\n  resetCamera = (() => {\n    const box = new THREE.Box3();\n    const center = new THREE.Vector3();\n    return () => {\n      box.setFromObject(this.avatar);\n      box.getCenter(center);\n\n      // Shift the center vertically in order to frame the avatar nicely.\n      center.y = (box.max.y - box.min.y) * 0.6 + box.min.y;\n\n      fitBoxInFrustum(this.camera, box, center);\n      fitBoxInFrustum(this.snapshotCamera, box, center, 0.7);\n\n      this.controls.target.copy(center);\n      this.controls.update();\n    };\n  })();\n\n  componentWillUnmount = () => {\n    this.mounted = false;\n\n    // Gotta be particularly careful about disposing things here since we will likely create many avatar\n    // previews during a session and Chrome will eventually discard the oldest webgl context if we leak\n    // contexts by holding on to them directly or indirectly.\n\n    this.scene && this.scene.traverse(disposeNode);\n    if (this.previewRenderer) {\n      this.previewRenderer.dispose();\n    }\n    if (this.snapshotRenderer) {\n      this.snapshotRenderer.dispose();\n    }\n    if (this.controls) {\n      this.controls.dispose();\n      this.controls.domElement = null;\n    }\n\n    Object.values(this.imageBitmaps).forEach(img => disposeImageBitmap(img));\n    window.removeEventListener(\"resize\", this.resize);\n  };\n\n  componentDidUpdate = async oldProps => {\n    if (oldProps.avatarGltfUrl !== this.props.avatarGltfUrl) {\n      if (this.avatar) {\n        this.scene.remove(this.avatar);\n        this.avatar = null;\n      }\n      if (this.props.avatarGltfUrl) {\n        this.setState({ error: null, loading: true });\n        await this.loadCurrentAvatarGltfUrl();\n      }\n    }\n    this.applyMaps(oldProps, this.props);\n  };\n\n  async loadCurrentAvatarGltfUrl() {\n    const newLoadId = ++this.loadId;\n    const url = proxiedUrlFor(this.props.avatarGltfUrl);\n    const gltf = await this.loadPreviewAvatar(url);\n    // If we had started loading another avatar while we were loading this one, throw this one away\n    if (!this.mounted || newLoadId !== this.loadId) return;\n    if (gltf && this.props.onGltfLoaded) this.props.onGltfLoaded(gltf);\n    this.setAvatar(gltf.scene);\n  }\n\n  applyMaps(oldProps, newProps) {\n    return Promise.all(\n      ALL_MAPS.map(mapName => {\n        const applyMap = this.applyMapToPreview.bind(this, mapName);\n        if (oldProps[mapName] != newProps[mapName]) {\n          if (newProps[mapName] instanceof File) {\n            return createImageBitmap(newProps[mapName]).then(applyMap);\n          } else if (newProps[mapName]) {\n            return createImageBitmapFromURL(newProps[mapName]).then(applyMap);\n          } else {\n            return this.revertMap(mapName);\n          }\n        }\n      })\n    );\n  }\n\n  loadPreviewAvatar = async avatarGltfUrl => {\n    let gltf;\n    try {\n      gltf = await loadGLTF(avatarGltfUrl, \"model/gltf\", null, ensureAvatarMaterial);\n    } catch (e) {\n      console.error(\"Failed to load avatar preview\", e);\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    if (!this.mounted) return;\n\n    // TODO Check for \"Bot_Skinned\" here is a hack for legacy avatars which only has a name one of the MOZ_alt_material nodes\n    this.previewMesh = findNode(\n      gltf.scene,\n      n => (n.isMesh && n.material && n.material.name === MAT_NAME) || n.name === \"Bot_Skinned\"\n    );\n\n    if (!this.previewMesh) {\n      console.error(\"Failed to find avatar preview mesh\");\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    const idleAnimation = gltf.animations && gltf.animations.find(({ name }) => name === \"idle_eyes\");\n    if (idleAnimation) {\n      this.mixer = new THREE.AnimationMixer(gltf.scene);\n      const action = this.mixer.clipAction(idleAnimation);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.idleAnimationAction = action;\n    }\n\n    gltf.scene.traverse(node => {\n      // Camera in preview is pretty tight, and skinned meshes tend to have poor bounding boxes\n      if (node.isSkinnedMesh) {\n        node.frustumCulled = false;\n      }\n\n      // We delete onUpdate here to opt out of the auto texture cleanup after GPU upload.\n      if (node.material) {\n        const removeOnUpdate = p => node.material[p] && delete node.material[p].onUpdate;\n        TEXTURE_PROPS[\"base_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"emissive_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"normal_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"orm_map\"].forEach(removeOnUpdate);\n      }\n    });\n\n    const { material } = this.previewMesh;\n    if (material) {\n      const getImage = p => material[p] && material[p].image;\n      this.originalMaps = {\n        base_map: TEXTURE_PROPS[\"base_map\"].map(getImage),\n        emissive_map: TEXTURE_PROPS[\"emissive_map\"].map(getImage),\n        normal_map: TEXTURE_PROPS[\"normal_map\"].map(getImage),\n        orm_map: TEXTURE_PROPS[\"orm_map\"].map(getImage)\n      };\n\n      const dependencies = [\n        this.applyMaps({}, this.props) // Apply initial maps\n      ];\n\n      // Low and medium quality materials don't use environment maps\n      if (window.APP.store.state.preferences.materialQualitySetting === \"high\") {\n        dependencies.push(\n          // TODO apply environment map to secondary materials as well\n          createDefaultEnvironmentMap().then(t => {\n            this.previewMesh.material.envMap = t;\n            this.previewMesh.material.needsUpdate = true;\n          })\n        );\n      }\n\n      await Promise.all(dependencies);\n    } else {\n      this.originalMaps = {};\n    }\n\n    return gltf;\n  };\n\n  applyMapToPreview = (name, image) => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    this.imageBitmaps[name] = image;\n    TEXTURE_PROPS[name].forEach(prop => {\n      const texture = this.previewMesh.material[prop];\n\n      // Low quality materials are missing normal maps\n      if (prop === \"normalMap\" && window.APP.store.state.preferences.materialQualitySetting === \"low\") {\n        return;\n      }\n\n      // Medium Quality materials are missing metalness and roughness maps\n      if (\n        (prop === \"roughnessMap\" || prop === \"metalnessMap\") &&\n        window.APP.store.state.preferences.materialQualitySetting !== \"high\"\n      ) {\n        return;\n      }\n\n      texture.image = image;\n      texture.needsUpdate = true;\n    });\n  };\n\n  revertMap = name => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    delete this.imageBitmaps[name];\n    this.originalMaps[name].forEach((bm, i) => {\n      const texture = this.previewMesh.material[TEXTURE_PROPS[name][i]];\n\n      if (texture) {\n        texture.image = bm;\n        texture.needsUpdate = true;\n      }\n    });\n  };\n\n  snapshot = () => {\n    return new Promise(resolve => {\n      if (this.idleAnimationAction) this.idleAnimationAction.stop();\n      this.snapshotCamera.position.copy(this.camera.position);\n      this.snapshotCamera.rotation.copy(this.camera.rotation);\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\n      this.snapshotCanvas.toBlob(blob => {\n        if (this.idleAnimationAction) this.idleAnimationAction.play();\n        resolve(blob);\n      });\n    });\n  };\n\n  render() {\n    return (\n      <div className={classNames(styles.preview, this.props.className)}>\n        {!this.props.avatarGltfUrl ||\n          (this.state.loading && !this.state.error && (\n            <div className=\"loader\">\n              <div className=\"loader-center\" />\n            </div>\n          ))}\n        {this.props.avatarGltfUrl && this.state.error && !this.state.loading && (\n          <div className=\"error\">\n            <img\n              src=\"../assets/images/warning_icon.png\"\n              srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n              className=\"error-icon\"\n            />\n            <FormattedMessage\n              id=\"avatar-preview.loading-failed\"\n              defaultMessage=\"Loading failed{linebreak}Please choose another avatar\"\n              values={{ linebreak: <br /> }}\n            />\n          </div>\n        )}\n        <canvas ref={c => (this.canvas = c)} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarPreview, { forwardRef: true });\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { fetchAvatar } from \"../utils/avatar-utils\";\nimport { replaceHistoryState } from \"../utils/history\";\nimport { AvatarSettingsSidebar } from \"./room/AvatarSettingsSidebar\";\nimport { AvatarSetupModal } from \"./room/AvatarSetupModal\";\nimport AvatarPreview from \"./avatar-preview\";\n\nexport default class ProfileEntryPanel extends Component {\n  static propTypes = {\n    containerType: PropTypes.oneOf([\"sidebar\", \"modal\"]),\n    displayNameOverride: PropTypes.string,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    messages: PropTypes.object,\n    finished: PropTypes.func,\n    history: PropTypes.object,\n    avatarId: PropTypes.string,\n    onClose: PropTypes.func,\n    onBack: PropTypes.func,\n    showBackButton: PropTypes.bool\n  };\n\n  static defaultProps = {\n    containerType: \"modal\"\n  };\n\n  state = {\n    avatarId: null,\n    displayName: null,\n    avatar: null\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStateFromProfile();\n    if (props.avatarId) {\n      this.state.avatarId = props.avatarId;\n    }\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.scene = document.querySelector(\"a-scene\");\n  }\n\n  getStateFromProfile = () => {\n    const { displayName, avatarId } = this.props.store.state.profile;\n    return { displayName, avatarId };\n  };\n\n  storeUpdated = () => this.setState(this.getStateFromProfile());\n\n  saveStateAndFinish = e => {\n    e && e.preventDefault();\n\n    const { displayName } = this.props.store.state.profile;\n    const { hasChangedName } = this.props.store.state.activity;\n\n    const hasChangedNowOrPreviously = hasChangedName || this.state.displayName !== displayName;\n    this.props.store.update({\n      activity: {\n        hasChangedName: hasChangedNowOrPreviously,\n        hasAcceptedProfile: true\n      },\n      profile: {\n        displayName: this.state.displayName,\n        avatarId: this.state.avatarId\n      }\n    });\n    this.props.finished();\n    this.scene.emit(\"avatar_updated\");\n  };\n\n  stopPropagation = e => {\n    e.stopPropagation();\n  };\n\n  setAvatarFromMediaResult = ({ detail: { entry, selectAction } }) => {\n    if ((entry.type !== \"avatar\" && entry.type !== \"avatar_listing\") || selectAction !== \"use\") return;\n\n    this.setState({ avatarId: entry.id });\n    // Replace history state with the current avatar id since this component gets destroyed when we open the\n    // avatar editor and we want the back button to work. We read the history state back via the avatarId prop.\n    // We read the current state key from history since it could be \"overlay\" or \"entry_step\".\n    replaceHistoryState(this.props.history, this.props.history.location.state.key, \"profile\", { avatarId: entry.id });\n  };\n\n  componentDidMount() {\n    if (this.nameInput) {\n      // stop propagation so that avatar doesn't move when wasd'ing during text input.\n      this.nameInput.addEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.addEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    // This handles editing avatars in the entry_step, since this component remains mounted with the same avatarId\n    this.scene.addEventListener(\"action_avatar_saved\", this.refetchAvatar);\n\n    this.refetchAvatar();\n  }\n\n  componentDidUpdate(_prevProps, prevState) {\n    if (prevState.avatarId !== this.state.avatarId) {\n      this.refetchAvatar();\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    if (this.nameInput) {\n      this.nameInput.removeEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.removeEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    this.scene.removeEventListener(\"action_avatar_saved\", this.refetchAvatar);\n  }\n\n  refetchAvatar = async () => {\n    const avatar = await fetchAvatar(this.state.avatarId);\n    if (this.state.avatarId !== avatar.avatar_id) return; // This is an old result, ignore it\n    this.setState({ avatar });\n  };\n\n  render() {\n    const avatarSettingsProps = {\n      displayNameInputRef: inp => (this.nameInput = inp),\n      disableDisplayNameInput: !!this.props.displayNameOverride,\n      displayName: this.props.displayNameOverride ? this.props.displayNameOverride : this.state.displayName,\n      displayNamePattern: this.props.store.schema.definitions.profile.properties.displayName.pattern,\n      onChangeDisplayName: e => this.setState({ displayName: e.target.value }),\n      avatarPreview: <AvatarPreview avatarGltfUrl={this.state.avatar && this.state.avatar.gltf_url} />,\n      onChangeAvatar: e => {\n        e.preventDefault();\n        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\", \"use\");\n      },\n      onSubmit: this.saveStateAndFinish,\n      onClose: this.props.onClose,\n      onBack: this.props.onBack\n    };\n\n    if (this.props.containerType === \"sidebar\") {\n      return <AvatarSettingsSidebar {...avatarSettingsProps} showBackButton={this.props.showBackButton} />;\n    }\n\n    return <AvatarSetupModal {...avatarSettingsProps} />;\n  }\n}\n","import { EventTarget } from \"event-target-shim\";\nimport configs from \"../utils/configs\";\nimport { getReticulumFetchUrl, fetchReticulumAuthenticated, hasReticulumServer } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\n\nconst EMPTY_RESULT = { entries: [], meta: {} };\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  twitch: \"twitch\",\n  favorites: \"favorites\"\n};\n\nconst desiredSources = [\"sketchfab\", \"videos\", \"scenes\", \"avatars\", \"gifs\", \"images\"];\nconst availableSources = desiredSources.filter(source => {\n  const apiSource = URL_SOURCE_TO_TO_API_SOURCE[source];\n  return configs.integration(apiSource);\n});\nexport const SOURCES = availableSources;\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\",\n  favorites: \"my-favorites\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\", \"similar_to\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n    const locationSearchParams = new URLSearchParams(location.search);\n    const isMy = locationSearchParams.get(\"filter\") && locationSearchParams.get(\"filter\").startsWith(\"my-\");\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      source = isMy ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    let fetch = true;\n\n    if (source === \"avatars\" || source === \"scenes\" || source === \"favorites\") {\n      if (isMy) {\n        if (window.APP.store.credentialsAccountId) {\n          searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n        } else {\n          fetch = false; // Don't fetch my-* if not signed in\n        }\n      }\n    }\n\n    const path = `/api/v1/media/search?${searchParams.toString()}`;\n    const url = getReticulumFetchUrl(path);\n    if (this.lastSavedUrl === url) return;\n\n    this.isFetching = true;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    const result = fetch ? await fetchReticulumAuthenticated(path) : EMPTY_RESULT;\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result && this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.isFetching = false;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    searchParams.delete(\"similar_to\");\n    searchParams.delete(\"similar_name\");\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav, keepSelectAction) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n    searchParams.delete(\"similar_to\");\n    searchParams.delete(\"similar_name\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    if (!keepSelectAction) {\n      searchParams.delete(\"selectAction\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n\n    this._stashedParams = {};\n    this._stashedSource = null;\n\n    const source = this.getUrlMediaSource(location);\n\n    // HACK for now do not stash favorite search, since that ends up being a source\n    // we do not reveal in the media browser UX. Revisit the rules here when we have a\n    // proper favorites browser. Then, we should have two separate stashes.\n    if (source === \"favorites\") return;\n    this._stashedSource = source;\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = (source, selectAction) => {\n    this._sourceNavigate(source, true, false, selectAction);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams, selectAction) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (selectAction) {\n      searchParams.set(\"selectAction\", selectAction);\n    }\n\n    if (hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const result = await fetchReticulumAuthenticated(`/api/v1/media/search?${searchParams.toString()}`);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { useForm } from \"react-hook-form\";\nimport { ApplyButton } from \"../input/Button\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Column } from \"../layout/Column\";\n\nexport function AvatarUrlModal({ onSubmit, onClose }) {\n  const { handleSubmit, register } = useForm();\n  return (\n    <Modal title=\"Custom Avatar URL\" beforeTitle={<CloseButton onClick={onClose} />}>\n      <Column as=\"form\" padding center onSubmit={handleSubmit(onSubmit)}>\n        <TextInputField\n          name=\"url\"\n          label={<FormattedMessage id=\"avatar-url-modal.avatar-url-label\" defaultMessage=\"Avatar GLB URL\" />}\n          placeholder=\"https://example.com/avatar.glb\"\n          type=\"url\"\n          required\n          ref={register}\n          description={\n            <a href=\"https://hubs.mozilla.com/docs/intro-avatars.html\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <FormattedMessage\n                id=\"avatar-url-modal.custom-avatar-docs-link\"\n                defaultMessage=\"Learn more about custom avatars\"\n              />\n            </a>\n          }\n        />\n        <ApplyButton type=\"submit\" />\n      </Column>\n    </Modal>\n  );\n}\n\nAvatarUrlModal.propTypes = {\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AvatarUrlModal } from \"./AvatarUrlModal\";\n\nexport function AvatarUrlModalContainer({ store, scene, onClose }) {\n  const onSubmit = useCallback(\n    ({ url }) => {\n      store.update({ profile: { ...store.state.profile, ...{ avatarId: url } } });\n      scene.emit(\"avatar_updated\");\n      onClose();\n    },\n    [store, scene, onClose]\n  );\n\n  return <AvatarUrlModal onSubmit={onSubmit} onClose={onClose} />;\n}\n\nAvatarUrlModalContainer.propTypes = {\n  store: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { useForm } from \"react-hook-form\";\nimport { Button } from \"../input/Button\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Column } from \"../layout/Column\";\n\nexport function SceneUrlModal({ enableSpoke, editorName, onValidateUrl, onSubmit, onClose }) {\n  const { isSubmitting, handleSubmit, register, errors } = useForm();\n  return (\n    <Modal\n      title={<FormattedMessage id=\"scene-url-modal.title\" defaultMessage=\"Custom Scene URL\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column as=\"form\" padding center onSubmit={handleSubmit(onSubmit)}>\n        <p>\n          {enableSpoke ? (\n            <FormattedMessage\n              id=\"scene-url-modal.message-with-spoke\"\n              defaultMessage=\"Paste a URL to a {editorName} scene or a URL to a <glblink>GLB</glblink>.\"\n              values={{\n                editorName: (\n                  <a href=\"/spoke\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {editorName}\n                  </a>\n                ),\n                // eslint-disable-next-line react/display-name\n                glblink: chunks => (\n                  <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          ) : (\n            <FormattedMessage\n              id=\"scene-url-modal.message\"\n              defaultMessage=\"Paste a URL to a scene or a URL to a <glblink>GLB</glblink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                glblink: chunks => (\n                  <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          )}\n        </p>\n        <TextInputField\n          name=\"url\"\n          label={<FormattedMessage id=\"scene-url-modal.url-input\" defaultMessage=\"Scene URL\" />}\n          placeholder=\"https://example.com/scene.glb\"\n          type=\"url\"\n          required\n          ref={register({ validate: onValidateUrl })}\n          error={errors.url && errors.url.message}\n        />\n        <Button type=\"submit\" preset=\"accept\" disabled={isSubmitting}>\n          <FormattedMessage id=\"scene-url-modal.change-scene-button\" defaultMessage=\"Change Scene\" />\n        </Button>\n        {enableSpoke && (\n          <>\n            <p>\n              <FormattedMessage\n                id=\"scene-url-modal.create-in-spoke\"\n                defaultMessage=\"Or, create a new scene using {editorName}.\"\n                values={{ editorName }}\n              />\n            </p>\n            <Button as=\"a\" preset=\"primary\" href=\"/spoke/new\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <FormattedMessage\n                id=\"scene-url-modal.new-spoke-project-button\"\n                defaultMessage=\"Launch {editorName}\"\n                values={{ editorName }}\n              />\n            </Button>\n          </>\n        )}\n      </Column>\n    </Modal>\n  );\n}\n\nSceneUrlModal.propTypes = {\n  enableSpoke: PropTypes.bool,\n  editorName: PropTypes.string,\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func,\n  onValidateUrl: PropTypes.isRequired\n};\n","import { isLocalHubsSceneUrl, proxiedUrlFor } from \"../utils/media-url-utils\";\n\nexport async function isValidGLB(url) {\n  return fetch(url).then(async r => {\n    const reader = r.body.getReader();\n    let header = \"\";\n    function readChunk({ done, value }) {\n      header += String.fromCharCode.apply(null, value.slice(0, 4));\n      if (!done && header.length < 4) {\n        return reader.read().then(readChunk);\n      } else {\n        reader.cancel();\n      }\n    }\n    await reader.read().then(readChunk);\n    return header.startsWith(\"glTF\");\n  });\n}\n\nexport async function isValidSceneUrl(url) {\n  if (url.trim() === \"\") return false;\n  if (!url.startsWith(\"http\")) return false;\n  if (await isLocalHubsSceneUrl(url)) {\n    return true;\n  } else {\n    return isValidGLB(proxiedUrlFor(url));\n  }\n}\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAttach = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.44 7.5v5.62a1.565 1.565 0 0 0 3.131 0l.005-7.366A2.656 2.656 0 0 0 7.9 3.274a2.654 2.654 0 0 0-1.631 2.48v7.415a3.73 3.73 0 1 0 7.46 0V6.24\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgAttach as ReactComponent };","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { SceneUrlModal } from \"./SceneUrlModal\";\nimport configs from \"../../utils/configs\";\nimport { isValidSceneUrl } from \"../../utils/scene-url-utils\";\nimport { useIntl } from \"react-intl\";\n\nexport function SceneUrlModalContainer({ hubChannel, onClose }) {\n  const intl = useIntl();\n\n  const onValidateUrl = useCallback(\n    async url => {\n      const valid = await isValidSceneUrl(url.trim());\n      return valid || intl.formatMessage(\"scene-url-modal.invalid-scene-url\");\n    },\n    [intl]\n  );\n\n  const onSubmit = useCallback(\n    ({ url }) => {\n      hubChannel.updateScene(url);\n      onClose();\n    },\n    [hubChannel, onClose]\n  );\n\n  return (\n    <SceneUrlModal\n      enableSpoke={configs.feature(\"enable_spoke\")}\n      editorName={configs.translation(\"editor-name\")}\n      onValidateUrl={onValidateUrl}\n      onSubmit={onSubmit}\n      onClose={onClose}\n    />\n  );\n}\n\nSceneUrlModalContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"hidden\":\"ObjectUrlModal__hidden__Y3SS9\",\"url-input\":\"ObjectUrlModal__url-input__uq6pp\",\"urlInput\":\"ObjectUrlModal__url-input__uq6pp\"};","import React, { useCallback, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { useForm } from \"react-hook-form\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as AttachIcon } from \"../icons/Attach.svg\";\nimport styles from \"./ObjectUrlModal.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function ObjectUrlModal({ showModelCollectionLink, modelCollectionUrl, onSubmit, onClose }) {\n  const { handleSubmit, register, watch, setValue } = useForm();\n\n  useEffect(\n    () => {\n      register(\"url\");\n    },\n    [register]\n  );\n\n  const file = watch(\"file\");\n  const hasFile = file && file.length > 0;\n  const fileName = hasFile ? file[0].name : undefined;\n\n  const onClear = useCallback(\n    () => {\n      if (hasFile) {\n        setValue(\"file\", undefined);\n      } else {\n        setValue(\"url\", \"\");\n      }\n    },\n    [hasFile, setValue]\n  );\n\n  const onChange = useCallback(\n    e => {\n      if (hasFile) {\n        return;\n      }\n\n      setValue(\"url\", e.target.value);\n    },\n    [hasFile, setValue]\n  );\n\n  const url = watch(\"url\", \"\");\n\n  const showCloseButton = hasFile || url.length > 0;\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"object-url-modal.title\" defaultMessage=\"Custom Object\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column as=\"form\" padding center onSubmit={handleSubmit(onSubmit)}>\n        <p>\n          {showModelCollectionLink ? (\n            <FormattedMessage\n              id=\"object-url-modal.message-with-collection\"\n              defaultMessage=\"Upload or paste a URL to an image, video, model, or scene. Models can be found on <sketchfablink>Sketchfab</sketchfablink> or our <collectionlink>collection</collectionlink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                sketchfablink: chunks => (\n                  <a\n                    href=\"https://sketchfab.com/search?features=downloadable&type=models\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {chunks}\n                  </a>\n                ),\n                // eslint-disable-next-line react/display-name\n                collectionlink: chunks => (\n                  <a href={modelCollectionUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          ) : (\n            <FormattedMessage\n              id=\"object-url-modal.message\"\n              defaultMessage=\"Upload or paste a URL to an image, video, model, or scene. Models can be found on <sketchfablink>Sketchfab</sketchfablink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                sketchfablink: chunks => (\n                  <a\n                    href=\"https://sketchfab.com/search?features=downloadable&type=models\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          )}\n        </p>\n        <TextInputField\n          name=\"url\"\n          label={<FormattedMessage id=\"object-url-modal.url-field-label\" defaultMessage=\"Object URL or File\" />}\n          placeholder=\"https://example.com/avatar.glb\"\n          type={hasFile ? \"text\" : \"url\"}\n          value={fileName || url || \"\"}\n          onChange={onChange}\n          afterInput={\n            <>\n              {showCloseButton && <CloseButton onClick={onClear} />}\n              <IconButton\n                as=\"label\"\n                className={classNames({ [styles.hidden]: showCloseButton }, styles.urlInput)}\n                htmlFor=\"file\"\n              >\n                <AttachIcon />\n                <input id=\"file\" className={styles.hidden} name=\"file\" type=\"file\" ref={register} />\n              </IconButton>\n            </>\n          }\n          description={\n            <FormattedMessage\n              id=\"object-url-modal.url-field-description\"\n              defaultMessage=\"Accepts glb, png, jpg, gif, mp4, and mp3 files\"\n            />\n          }\n        />\n        <Button type=\"submit\" preset=\"accept\">\n          <FormattedMessage id=\"object-url-modal.create-object-button\" defaultMessage=\"Create Object\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nObjectUrlModal.propTypes = {\n  isMobile: PropTypes.bool,\n  showModelCollectionLink: PropTypes.bool,\n  modelCollectionUrl: PropTypes.string,\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ObjectUrlModal } from \"./ObjectUrlModal\";\nimport configs from \"../../utils/configs\";\nimport ducky from \"../../assets/models/DuckyMesh.glb\";\n\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\nexport function ObjectUrlModalContainer({ scene, onClose }) {\n  const onSubmit = useCallback(\n    ({ file, url }) => {\n      scene.emit(\"add_media\", (file && file.length > 0 && file[0]) || url || ducky);\n      onClose();\n    },\n    [scene, onClose]\n  );\n\n  return (\n    <ObjectUrlModal\n      isMobile={isMobile}\n      showModelCollectionLink={configs.feature(\"show_model_collection_link\")}\n      modelCollectionUrl={configs.link(\"model_collection\", \"https://sketchfab.com/mozillareality\")}\n      onSubmit={onSubmit}\n      onClose={onClose}\n    />\n  );\n}\n\nObjectUrlModalContainer.propTypes = {\n  scene: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"search-icon\":\"MediaBrowser__search-icon__Gdgj7\",\"searchIcon\":\"MediaBrowser__search-icon__Gdgj7\",\"favorite-icon\":\"MediaBrowser__favorite-icon__eqtGN\",\"favoriteIcon\":\"MediaBrowser__favorite-icon__eqtGN\",\"button-nav\":\"MediaBrowser__button-nav__CWlpf\",\"buttonNav\":\"MediaBrowser__button-nav__CWlpf\",\"facets-nav\":\"MediaBrowser__facets-nav__RUwKx\",\"facetsNav\":\"MediaBrowser__facets-nav__RUwKx\",\"content\":\"MediaBrowser__content__TrMq2\",\"pager\":\"MediaBrowser__pager__Dknao\",\"pager-button\":\"MediaBrowser__pager-button__LZzwc\",\"pagerButton\":\"MediaBrowser__pager-button__LZzwc\",\"no-results\":\"MediaBrowser__no-results__wzxlX\",\"noResults\":\"MediaBrowser__no-results__wzxlX\"};","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSearch = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.636 2.5a6.136 6.136 0 1 0 0 12.273 6.136 6.136 0 0 0 0-12.272Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.214 13.214 17.5 17.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgSearch as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgStar = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.39 18.75a.625.625 0 0 1-.366-.118L10 14.99l-5.024 3.642a.625.625 0 0 1-.959-.706l1.96-5.803L.899 8.64A.625.625 0 0 1 1.25 7.5h6.265l1.89-5.819a.625.625 0 0 1 1.19 0l1.89 5.82h6.265a.624.624 0 0 1 .354 1.141l-5.08 3.48 1.958 5.802a.624.624 0 0 1-.591.826Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgStar as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgArrowForward = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.469 4.375 16.094 10l-5.625 5.625\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.313 10H3.905\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgArrowForward as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgArrowBack = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.531 15.625 3.906 10l5.625-5.625\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.688 10h11.406\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgArrowBack as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"fullscreen-layout\":\"FullscreenLayout__fullscreen-layout___gfL2\",\"fullscreenLayout\":\"FullscreenLayout__fullscreen-layout___gfL2\",\"header\":\"FullscreenLayout__header__Xwco1\",\"header-left\":\"FullscreenLayout__header-left__plGaP\",\"headerLeft\":\"FullscreenLayout__header-left__plGaP\",\"header-center\":\"FullscreenLayout__header-center__LLG8s\",\"headerCenter\":\"FullscreenLayout__header-center__LLG8s\",\"header-right\":\"FullscreenLayout__header-right__xewse\",\"headerRight\":\"FullscreenLayout__header-right__xewse\",\"content\":\"FullscreenLayout__content__sEnvy\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./FullscreenLayout.scss\";\n\nexport function FullscreenLayout({ className, headerLeft, headerCenter, headerRight, contentClassName, children }) {\n  return (\n    <div className={classNames(styles.fullscreenLayout, className)}>\n      <div className={styles.header}>\n        <div className={styles.headerLeft}>{headerLeft}</div>\n        <div className={styles.headerCenter}>{headerCenter}</div>\n        <div className={styles.headerRight}>{headerRight}</div>\n      </div>\n      <div className={classNames(styles.content, contentClassName)}>{children}</div>\n    </div>\n  );\n}\n\nFullscreenLayout.propTypes = {\n  className: PropTypes.string,\n  headerLeft: PropTypes.node,\n  headerCenter: PropTypes.node,\n  headerRight: PropTypes.node,\n  contentClassName: PropTypes.string,\n  children: PropTypes.node\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"media-grid\":\"MediaGrid__media-grid__CTSyf\",\"mediaGrid\":\"MediaGrid__media-grid__CTSyf\",\"sm\":\"MediaGrid__sm__UglLx\",\"center\":\"MediaGrid__center__sJRuA\",\"variable-width\":\"MediaGrid__variable-width__IrH79\",\"variableWidth\":\"MediaGrid__variable-width__IrH79\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./MediaGrid.scss\";\n\nexport function MediaGrid({ children, className, center, isVariableWidth, sm, ...rest }) {\n  return (\n    <div\n      className={classNames(\n        styles.mediaGrid,\n        { [styles.center]: center, [styles.variableWidth]: isVariableWidth, [styles.sm]: sm },\n        className\n      )}\n      {...rest}\n    >\n      {children}\n    </div>\n  );\n}\n\nMediaGrid.propTypes = {\n  center: PropTypes.bool,\n  isVariableWidth: PropTypes.bool,\n  sm: PropTypes.bool,\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./MediaBrowser.scss\";\nimport { ReactComponent as SearchIcon } from \"../icons/Search.svg\";\nimport { ReactComponent as StarIcon } from \"../icons/Star.svg\";\nimport { ReactComponent as CloseIcon } from \"../icons/Close.svg\";\nimport { ReactComponent as ArrowForwardIcon } from \"../icons/ArrowForward.svg\";\nimport { ReactComponent as ArrowBackIcon } from \"../icons/ArrowBack.svg\";\nimport { FormattedMessage, defineMessages, useIntl } from \"react-intl\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { IconButton } from \"../input/IconButton\";\nimport { FullscreenLayout } from \"../layout/FullscreenLayout\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { MediaGrid } from \"./MediaGrid\";\n\nconst navTitleMessages = defineMessages({\n  youtube: { id: \"media-browser.nav_title.youtube\", defaultMessage: \"YouTube\" },\n  videos: { id: \"media-browser.nav_title.videos\", defaultMessage: \"Videos\" },\n  images: { id: \"media-browser.nav_title.images\", defaultMessage: \"Images\" },\n  gifs: { id: \"media-browser.nav_title.gifs\", defaultMessage: \"GIFs\" },\n  scenes: { id: \"media-browser.nav_title.scenes\", defaultMessage: \"Scenes\" },\n  avatars: { id: \"media-browser.nav_title.avatars\", defaultMessage: \"Avatars\" },\n  sketchfab: { id: \"media-browser.nav_title.sketchfab\", defaultMessage: \"Sketchfab\" },\n  twitch: { id: \"media-browser.nav_title.twitch\", defaultMessage: \"Twitch\" }\n});\n\nexport function MediaBrowser({\n  onClose,\n  browserRef,\n  searchInputRef,\n  autoFocusSearch,\n  searchPlaceholder,\n  searchDescription,\n  onSearchKeyDown,\n  onClearSearch,\n  mediaSources,\n  selectedSource,\n  onSelectSource,\n  activeFilter,\n  facets,\n  onSelectFacet,\n  query,\n  onChangeQuery,\n  headerRight,\n  hasNext,\n  hasPrevious,\n  onNextPage,\n  onPreviousPage,\n  noResultsMessage,\n  children\n}) {\n  const intl = useIntl();\n\n  return (\n    <FullscreenLayout\n      headerLeft={\n        <IconButton onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      }\n      headerCenter={\n        <>\n          {selectedSource === \"favorites\" ? (\n            <>\n              <StarIcon className={styles.favoriteIcon} />\n              <h3>\n                <FormattedMessage id=\"media-browser.favorites-header\" defaultMessage=\"Favorite Rooms\" />\n              </h3>\n            </>\n          ) : (\n            <TextInputField\n              value={query}\n              onChange={onChangeQuery}\n              autoFocus={autoFocusSearch}\n              ref={searchInputRef}\n              placeholder={searchPlaceholder}\n              onKeyDown={onSearchKeyDown}\n              beforeInput={<SearchIcon className={styles.searchIcon} />}\n              afterInput={\n                <IconButton onClick={onClearSearch}>\n                  <CloseIcon height={16} width={16} />\n                </IconButton>\n              }\n              description={searchDescription}\n            />\n          )}\n        </>\n      }\n      headerRight={headerRight}\n    >\n      {mediaSources && (\n        <div className={styles.buttonNav}>\n          {mediaSources.map(source => (\n            <Button\n              sm\n              key={source}\n              preset={selectedSource === source ? \"primary\" : \"transparent\"}\n              onClick={() => onSelectSource(source)}\n            >\n              {intl.formatMessage(navTitleMessages[source])}\n            </Button>\n          ))}\n        </div>\n      )}\n      {facets && (\n        <div className={classNames(styles.buttonNav, styles.facetsNav)}>\n          {facets.map((facet, i) => (\n            <Button\n              sm\n              key={i}\n              preset={activeFilter === facet.params.filter ? \"primary\" : \"transparent\"}\n              onClick={() => onSelectFacet(facet)}\n            >\n              {facet.text}\n            </Button>\n          ))}\n        </div>\n      )}\n      <div className={styles.content}>\n        <Column grow ref={browserRef}>\n          {children ? (\n            <MediaGrid\n              isVariableWidth={selectedSource === \"gifs\" || selectedSource === \"images\"}\n              sm={selectedSource === \"avatars\"}\n            >\n              {children}\n            </MediaGrid>\n          ) : (\n            <div className={styles.noResults}>{noResultsMessage}</div>\n          )}\n          {(hasNext || hasPrevious) && (\n            <div className={styles.pager}>\n              <button type=\"button\" className={styles.pagerButton} disabled={!hasPrevious} onClick={onPreviousPage}>\n                <ArrowBackIcon />\n              </button>\n              <button type=\"button\" className={styles.pagerButton} disabled={!hasNext} onClick={onNextPage}>\n                <ArrowForwardIcon />\n              </button>\n            </div>\n          )}\n        </Column>\n      </div>\n    </FullscreenLayout>\n  );\n}\n\nMediaBrowser.propTypes = {\n  onClose: PropTypes.func,\n  browserRef: PropTypes.any,\n  searchInputRef: PropTypes.any,\n  autoFocusSearch: PropTypes.bool,\n  searchPlaceholder: PropTypes.string,\n  searchDescription: PropTypes.node,\n  onSearchKeyDown: PropTypes.func,\n  onClearSearch: PropTypes.func,\n  mediaSources: PropTypes.array,\n  selectedSource: PropTypes.string,\n  onSelectSource: PropTypes.func,\n  activeFilter: PropTypes.string,\n  facets: PropTypes.array,\n  onSelectFacet: PropTypes.func,\n  query: PropTypes.string,\n  onChangeQuery: PropTypes.func,\n  headerRight: PropTypes.node,\n  hasNext: PropTypes.bool,\n  hasPrevious: PropTypes.bool,\n  onNextPage: PropTypes.func,\n  onPreviousPage: PropTypes.func,\n  noResultsMessage: PropTypes.node,\n  children: PropTypes.node\n};\n\nMediaBrowser.defaultProps = {\n  noResultsMessage: \"No Results\"\n};\n","var _g, _defs;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgUpload = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#a)\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.5 14.367h2.969c2.148 0 3.906-1.14 3.906-3.265s-2.07-3.183-3.75-3.266C15.278 4.514 12.852 2.492 10 2.492c-2.695 0-4.431 1.79-5 3.563C2.656 6.278.625 7.769.625 10.21c0 2.442 2.11 4.156 4.688 4.156H7.5\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.5 9.992-2.5-2.5-2.5 2.5\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 17.509V8.117\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"a\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 20,\n    height: 20,\n    fill: \"#fff\"\n  })))));\n};\n\nexport { SvgUpload as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLink = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M4.851 11.038a2.906 2.906 0 1 0 4.11 4.11l1.768-1.768a.844.844 0 0 1 1.194 1.193l-1.768 1.768a4.594 4.594 0 1 1-6.497-6.496l1.768-1.768A.844.844 0 0 1 6.619 9.27l-1.768 1.768Zm3.227-4.42a.844.844 0 0 1 0-1.193l1.767-1.767a4.594 4.594 0 0 1 6.497 6.496l-1.768 1.768a.844.844 0 1 1-1.193-1.193l1.768-1.768a2.906 2.906 0 0 0-4.11-4.11L9.27 6.619a.844.844 0 0 1-1.193 0Zm-1.236 5.345a.844.844 0 0 0 1.194 1.193l5.176-5.176a.844.844 0 0 0-1.193-1.194l-5.177 5.177Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgLink as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPeople = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.703 6.563c-.114 1.588-1.293 2.812-2.578 2.812s-2.466-1.223-2.578-2.812c-.117-1.653 1.03-2.813 2.578-2.813 1.548 0 2.695 1.19 2.578 2.813Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125 11.875c-2.546 0-4.994 1.264-5.607 3.727-.081.326.123.648.458.648h10.299c.335 0 .538-.322.458-.648-.614-2.502-3.062-3.727-5.608-3.727Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.812 7.264C7.721 8.532 6.77 9.53 5.742 9.53c-1.026 0-1.98-.998-2.07-2.267C3.578 5.944 4.505 5 5.742 5c1.237 0 2.164.968 2.07 2.264Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.047 11.954c-.705-.324-1.482-.448-2.305-.448-2.031 0-3.988 1.01-4.478 2.977-.065.26.098.517.366.517h4.386\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgPeople as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"media-tile\":\"MediaTiles__media-tile__E0HUl\",\"mediaTile\":\"MediaTiles__media-tile__E0HUl\",\"thumbnail-container\":\"MediaTiles__thumbnail-container__MKVU6\",\"thumbnailContainer\":\"MediaTiles__thumbnail-container__MKVU6\",\"create-tile-content\":\"MediaTiles__create-tile-content__M88Bh\",\"createTileContent\":\"MediaTiles__create-tile-content__M88Bh\",\"tall\":\"MediaTiles__tall__yGWZ7\",\"wide\":\"MediaTiles__wide__dHsYw\",\"thumbnail-link\":\"MediaTiles__thumbnail-link__gdkAW\",\"thumbnailLink\":\"MediaTiles__thumbnail-link__gdkAW\",\"tile-actions\":\"MediaTiles__tile-actions__7omsl\",\"tileActions\":\"MediaTiles__tile-actions__7omsl\",\"tile-action\":\"MediaTiles__tile-action__Ja6k2\",\"tileAction\":\"MediaTiles__tile-action__Ja6k2\",\"member-count\":\"MediaTiles__member-count__vcGmo\",\"memberCount\":\"MediaTiles__member-count__vcGmo\",\"favorite-icon\":\"MediaTiles__favorite-icon__D2eKH\",\"favoriteIcon\":\"MediaTiles__favorite-icon__D2eKH\",\"info\":\"MediaTiles__info__A_JN6\",\"description\":\"MediaTiles__description____teU\",\"create-tile\":\"MediaTiles__create-tile__wPgMb\",\"createTile\":\"MediaTiles__create-tile__wPgMb\"};","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAdd = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 4.375v11.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.625 10H4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgAdd as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPen = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.024 18.125H1.875v-2.148L13.99 3.832 16.17 6.01 4.024 18.125Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.63 5.547 14.453 3.37l1.237-1.197c.19-.193.484-.298.755-.298a1.011 1.011 0 0 1 .72.298l.664.664a1.01 1.01 0 0 1 .296.718c0 .273-.106.564-.298.756L16.63 5.547Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgPen as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDuplicate = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.898 5H7.227C5.997 5 5 5.996 5 7.226v8.672c0 1.23.997 2.227 2.227 2.227h8.671c1.23 0 2.227-.997 2.227-2.227V7.226c0-1.23-.997-2.226-2.227-2.226Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14.98 5 .02-.938a2.194 2.194 0 0 0-2.188-2.188H4.376a2.507 2.507 0 0 0-2.5 2.5v8.438a2.194 2.194 0 0 0 2.188 2.187H5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.563 8.437v6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.688 11.562h-6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgDuplicate as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHelp = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2a8 8 0 1 0 0 16 8 8 0 0 0 0-16Z\",\n    stroke: \"currentColor\",\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.454 7.56s.039-.796.89-1.48c.505-.407 1.11-.525 1.656-.533.497-.007.94.076 1.206.202.454.216 1.34.745 1.34 1.868 0 1.182-.773 1.718-1.654 2.309-.88.59-1.12 1.231-1.12 1.893\",\n    stroke: \"currentColor\",\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.855 14.844a.786.786 0 1 0 0-1.57.786.786 0 0 0 0 1.57Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgHelp as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgExternalLink = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15 8.749v7.188a1.563 1.563 0 0 1-1.563 1.562H4.063A1.563 1.563 0 0 1 2.5 15.937V6.562a1.562 1.562 0 0 1 1.563-1.563h6.542\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125 2.5H17.5v4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.75 11.248 8.438-8.437\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgExternalLink as ReactComponent };","import React, { useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FormattedMessage, FormattedRelativeTime, useIntl } from \"react-intl\";\nimport styles from \"./MediaTiles.scss\";\nimport { ReactComponent as PeopleIcon } from \"../icons/People.svg\";\nimport { ReactComponent as StarIcon } from \"../icons/Star.svg\";\nimport { ReactComponent as AddIcon } from \"../icons/Add.svg\";\nimport { ReactComponent as PenIcon } from \"../icons/Pen.svg\";\nimport { ReactComponent as DuplicateIcon } from \"../icons/Duplicate.svg\";\nimport { ReactComponent as SearchIcon } from \"../icons/Search.svg\";\nimport { ReactComponent as HelpIcon } from \"../icons/Help.svg\";\nimport { ReactComponent as ExternalLinkIcon } from \"../icons/ExternalLink.svg\";\n\nconst PUBLISHER_FOR_ENTRY_TYPE = {\n  sketchfab_model: \"Sketchfab\",\n  twitch_stream: \"Twitch\"\n};\n\nfunction useThumbnailSize(isImage, isAvatar, imageAspect) {\n  return useMemo(\n    () => {\n      let imageHeight = 220;\n      if (isAvatar) imageHeight = Math.floor(imageHeight * 1.5);\n\n      // Aspect ratio can vary per image if its an image result. Avatars are a taller portrait aspect, o/w assume 720p\n      let imageWidth;\n      if (isImage) {\n        imageWidth = Math.floor(Math.max(imageAspect * imageHeight, imageHeight * 0.85));\n      } else if (isAvatar) {\n        imageWidth = Math.floor((9 / 16) * imageHeight);\n      } else {\n        imageWidth = Math.floor(Math.max((16 / 9) * imageHeight, imageHeight * 0.85));\n      }\n\n      return [imageWidth, imageHeight];\n    },\n    [isImage, isAvatar, imageAspect]\n  );\n}\n\nfunction useThumbnail(entry, processThumbnailUrl) {\n  const isImage = entry.type.endsWith(\"_image\");\n  const isAvatar = entry.type === \"avatar\" || entry.type === \"avatar_listing\";\n  const imageAspect = entry.images.preview.width / entry.images.preview.height;\n\n  const [thumbnailWidth, thumbnailHeight] = useThumbnailSize(isImage, isAvatar, imageAspect);\n\n  const thumbnailUrl = useMemo(\n    () => {\n      return processThumbnailUrl\n        ? processThumbnailUrl(entry, thumbnailWidth, thumbnailHeight)\n        : entry.images.preview.url;\n    },\n    [entry, thumbnailWidth, thumbnailHeight, processThumbnailUrl]\n  );\n\n  return [thumbnailUrl, thumbnailWidth, thumbnailHeight];\n}\n\nfunction BaseTile({ as: TileComponent, className, name, description, tall, wide, children, ...rest }) {\n  let additionalProps;\n\n  if (TileComponent === \"div\") {\n    additionalProps = {\n      tabIndex: \"0\",\n      role: \"button\"\n    };\n  }\n\n  return (\n    <TileComponent\n      className={classNames(styles.mediaTile, { [styles.tall]: tall, [styles.wide]: wide }, className)}\n      {...additionalProps}\n      {...rest}\n    >\n      <div className={styles.thumbnailContainer}>{children}</div>\n      {(name || description) && (\n        <div className={styles.info}>\n          <b>{name}</b>\n          {description && <small className={styles.description}>{description}</small>}\n        </div>\n      )}\n    </TileComponent>\n  );\n}\n\nBaseTile.propTypes = {\n  as: PropTypes.elementType,\n  className: PropTypes.string,\n  name: PropTypes.string,\n  description: PropTypes.node,\n  children: PropTypes.node,\n  tall: PropTypes.bool,\n  wide: PropTypes.bool\n};\n\nBaseTile.defaultProps = {\n  as: \"div\"\n};\n\nfunction TileAction({ className, children, ...rest }) {\n  return (\n    <button type=\"button\" className={classNames(styles.tileAction, className)} {...rest}>\n      {children}\n    </button>\n  );\n}\n\nTileAction.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function CreateTile({ label, type, ...rest }) {\n  return (\n    <BaseTile className={styles.createTile} wide={type === \"scene\"} tall={type === \"avatar\"} {...rest}>\n      <div className={styles.createTileContent}>\n        <AddIcon width={48} height={48} />\n        <p>{label}</p>\n      </div>\n    </BaseTile>\n  );\n}\n\nCreateTile.propTypes = {\n  label: PropTypes.node,\n  type: PropTypes.string\n};\n\nexport function MediaTile({ entry, processThumbnailUrl, onClick, onEdit, onShowSimilar, onCopy, onInfo, ...rest }) {\n  const intl = useIntl();\n  const creator = entry.attributions && entry.attributions.creator;\n  const publisherName =\n    (entry.attributions && entry.attributions.publisher && entry.attributions.publisher.name) ||\n    PUBLISHER_FOR_ENTRY_TYPE[entry.type];\n\n  const [thumbnailUrl, thumbnailWidth, thumbnailHeight] = useThumbnail(entry, processThumbnailUrl);\n\n  return (\n    <BaseTile\n      wide={entry.type === \"scene\" || entry.type === \"scene_listing\" || entry.type === \"room\"}\n      tall={entry.type === \"avatar\" || entry.type === \"avatar_listing\"}\n      name={entry.name}\n      description={\n        <>\n          {creator && creator.name === undefined && <span>{creator}</span>}\n          {creator && creator.name && !creator.url && <span>{creator.name}</span>}\n          {creator &&\n            creator.name &&\n            creator.url && (\n              <a href={creator.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                {creator.name}\n              </a>\n            )}\n          {publisherName && (\n            <>\n              <a href={entry.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                <ExternalLinkIcon /> {publisherName}\n              </a>\n            </>\n          )}\n          {entry.last_activated_at && (\n            <small>\n              <FormattedMessage\n                id=\"media-tile.joined-room\"\n                defaultMessage=\"Joined {relativeTime}\"\n                values={{\n                  relativeTime: (\n                    <FormattedRelativeTime\n                      updateIntervalInSeconds={10}\n                      value={(new Date(entry.last_activated_at).getTime() - Date.now()) / 1000}\n                    />\n                  )\n                }}\n              />\n            </small>\n          )}\n        </>\n      }\n      {...rest}\n    >\n      <a className={styles.thumbnailLink} href={entry.url} rel=\"noreferrer noopener\" onClick={onClick}>\n        {entry.images.preview.type === \"mp4\" ? (\n          <video\n            muted\n            autoPlay\n            playsInline\n            loop\n            src={thumbnailUrl}\n            alt={entry.name}\n            width={thumbnailWidth}\n            height={thumbnailHeight}\n          />\n        ) : (\n          <img src={thumbnailUrl} alt={entry.name} width={thumbnailWidth} height={thumbnailHeight} />\n        )}\n      </a>\n      {entry.favorited && <StarIcon className={styles.favoriteIcon} />}\n      {entry.member_count !== undefined && (\n        <div className={styles.memberCount}>\n          <PeopleIcon /> <span>{entry.member_count}</span>\n        </div>\n      )}\n      <div className={styles.tileActions}>\n        {entry.type === \"avatar\" && (\n          <TileAction\n            title={intl.formatMessage({ id: \"media-tile.action.edit-avatar\", defaultMessage: \"Edit avatar\" })}\n            onClick={onEdit}\n          >\n            <PenIcon />\n          </TileAction>\n        )}\n        {entry.type === \"scene\" &&\n          entry.project_id && (\n            <TileAction\n              onClick={onEdit}\n              title={intl.formatMessage({ id: \"media-tile.action.edit-scene\", defaultMessage: \"Edit scene\" })}\n            >\n              <PenIcon />\n            </TileAction>\n          )}\n        {entry.type === \"avatar_listing\" && (\n          <TileAction\n            title={intl.formatMessage({\n              id: \"media-tile.action.show-similar-avatars\",\n              defaultMessage: \"Show similar avatars\"\n            })}\n            onClick={onShowSimilar}\n          >\n            <SearchIcon />\n          </TileAction>\n        )}\n        {entry.type === \"avatar_listing\" &&\n          entry.allow_remixing && (\n            <TileAction\n              title={intl.formatMessage({\n                id: \"media-tile.action.copy-avatar\",\n                defaultMessage: \"Copy to my avatars\"\n              })}\n              onClick={onCopy}\n            >\n              <DuplicateIcon />\n            </TileAction>\n          )}\n        {entry.type === \"scene_listing\" &&\n          entry.allow_remixing && (\n            <TileAction\n              title={intl.formatMessage({\n                id: \"media-tile.action.copy-scene\",\n                defaultMessage: \"Copy to my scenes\"\n              })}\n              onClick={onCopy}\n            >\n              <DuplicateIcon />\n            </TileAction>\n          )}\n        {entry.type === \"room\" &&\n          onInfo &&\n          entry.description && (\n            <TileAction\n              title={intl.formatMessage({\n                id: \"media-tile.action.room-info\",\n                defaultMessage: \"Room info\"\n              })}\n              onClick={onInfo}\n            >\n              <HelpIcon />\n            </TileAction>\n          )}\n      </div>\n    </BaseTile>\n  );\n}\n\nMediaTile.propTypes = {\n  entry: PropTypes.object.isRequired,\n  processThumbnailUrl: PropTypes.func,\n  onClick: PropTypes.func,\n  onEdit: PropTypes.func,\n  onShowSimilar: PropTypes.func,\n  onCopy: PropTypes.func,\n  onInfo: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function LegalMessage({ termsUrl, privacyUrl }) {\n  const toslink = useCallback(\n    chunks => (\n      <a rel=\"noopener noreferrer\" target=\"_blank\" href={termsUrl}>\n        {chunks}\n      </a>\n    ),\n    [termsUrl]\n  );\n\n  const privacylink = useCallback(\n    chunks => (\n      <a rel=\"noopener noreferrer\" target=\"_blank\" href={privacyUrl}>\n        {chunks}\n      </a>\n    ),\n    [privacyUrl]\n  );\n\n  if (termsUrl && privacyUrl) {\n    return (\n      <FormattedMessage\n        id=\"legal-message.tos-and-privacy\"\n        defaultMessage=\"By proceeding, you agree to the <toslink>terms of use</toslink> and <privacylink>privacy notice</privacylink>.\"\n        values={{\n          toslink,\n          privacylink\n        }}\n      />\n    );\n  }\n\n  if (termsUrl && !privacyUrl) {\n    return (\n      <FormattedMessage\n        id=\"legal-message.tos\"\n        defaultMessage=\"By proceeding, you agree to the <toslink>terms of use</toslink>.\"\n        values={{\n          toslink\n        }}\n      />\n    );\n  }\n\n  if (!termsUrl && privacyUrl) {\n    return (\n      <FormattedMessage\n        id=\"legal-message.privacy\"\n        defaultMessage=\"By proceeding, you agree to the <privacylink>privacy notice</privacylink>.\"\n        values={{\n          privacylink\n        }}\n      />\n    );\n  }\n\n  return null;\n}\n\nLegalMessage.propTypes = {\n  termsUrl: PropTypes.string,\n  privacyUrl: PropTypes.string\n};\n","import React, { useCallback, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Modal } from \"../modal/Modal\";\nimport { FormattedMessage, useIntl, defineMessages } from \"react-intl\";\nimport { CancelButton, NextButton, ContinueButton } from \"../input/Button\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { Column } from \"../layout/Column\";\nimport { LegalMessage } from \"./LegalMessage\";\n\nexport const SignInStep = {\n  submit: \"submit\",\n  waitForVerification: \"waitForVerification\",\n  complete: \"complete\"\n};\n\nexport const SignInMessages = defineMessages({\n  pin: {\n    id: \"sign-in-modal.signin-message.pin\",\n    defaultMessage: \"You'll need to sign in to pin objects.\"\n  },\n  unpin: {\n    id: \"sign-in-modal.signin-message.unpin\",\n    defaultMessage: \"You'll need to sign in to un-pin objects.\"\n  },\n  changeScene: {\n    id: \"sign-in-modal.signin-message.change-scene\",\n    defaultMessage: \"You'll need to sign in to change the scene.\"\n  },\n  roomSettings: {\n    id: \"sign-in-modal.signin-message.room-settings\",\n    defaultMessage: \"You'll need to sign in to change the room's settings.\"\n  },\n  closeRoom: {\n    id: \"sign-in-modal.signin-message.close-room\",\n    defaultMessage: \"You'll need to sign in to close the room.\"\n  },\n  muteUser: {\n    id: \"sign-in-modal.signin-message.mute-user\",\n    defaultMessage: \"You'll need to sign in to mute other users.\"\n  },\n  kickUser: {\n    id: \"sign-in-modal.signin-message.kick-user\",\n    defaultMessage: \"You'll need to sign in to kick other users.\"\n  },\n  addOwner: {\n    id: \"sign-in-modal.signin-message.add-owner\",\n    defaultMessage: \"You'll need to sign in to assign moderators.\"\n  },\n  removeOwner: {\n    id: \"sign-in-modal.signin-message.remove-owner\",\n    defaultMessage: \"You'll need to sign in to assign moderators.\"\n  },\n  createAvatar: {\n    id: \"sign-in-modal.signin-message.create-avatar\",\n    defaultMessage: \"You'll need to sign in to create avatars.\"\n  },\n  remixAvatar: {\n    id: \"sign-in-modal.signin-message.remix-avatar\",\n    defaultMessage: \"You'll need to sign in to remix avatars.\"\n  },\n  remixScene: {\n    id: \"sign-in-modal.signin-message.remix-scene\",\n    defaultMessage: \"You'll need to sign in to remix scenes.\"\n  },\n  favoriteRoom: {\n    id: \"sign-in-modal.signin-message.favorite-room\",\n    defaultMessage: \"You'll need to sign in to add this room to your favorites.\"\n  },\n  favoriteRooms: {\n    id: \"sign-in-modal.signin-message.favorite-rooms\",\n    defaultMessage: \"You'll need to sign in to add favorite rooms.\"\n  },\n  tweet: {\n    id: \"sign-in-modal.signin-message.tweet\",\n    defaultMessage: \"You'll need to sign in to send tweets.\"\n  }\n});\n\nexport function SubmitEmail({ onSubmitEmail, initialEmail, privacyUrl, termsUrl, message }) {\n  const intl = useIntl();\n\n  const [email, setEmail] = useState(initialEmail);\n\n  const onSubmitForm = useCallback(\n    e => {\n      e.preventDefault();\n      onSubmitEmail(email);\n    },\n    [onSubmitEmail, email]\n  );\n\n  const onChangeEmail = useCallback(\n    e => {\n      setEmail(e.target.value);\n    },\n    [setEmail]\n  );\n\n  return (\n    <Column center padding as=\"form\" onSubmit={onSubmitForm}>\n      <p>\n        {message ? (\n          intl.formatMessage(message)\n        ) : (\n          <FormattedMessage id=\"sign-in-modal.prompt\" defaultMessage=\"Please Sign In\" />\n        )}\n      </p>\n      <TextInputField\n        name=\"email\"\n        type=\"email\"\n        required\n        value={email}\n        onChange={onChangeEmail}\n        placeholder=\"example@example.com\"\n      />\n      <p>\n        <small>\n          <LegalMessage termsUrl={termsUrl} privacyUrl={privacyUrl} />\n        </small>\n      </p>\n      <NextButton type=\"submit\" />\n    </Column>\n  );\n}\n\nSubmitEmail.defaultProps = {\n  initialEmail: \"\"\n};\n\nSubmitEmail.propTypes = {\n  message: PropTypes.object,\n  termsUrl: PropTypes.string,\n  privacyUrl: PropTypes.string,\n  initialEmail: PropTypes.string,\n  onSubmitEmail: PropTypes.func.isRequired\n};\n\nexport function WaitForVerification({ email, onCancel, showNewsletterSignup }) {\n  return (\n    <Column center padding>\n      <FormattedMessage\n        id=\"sign-in-modal.wait-for-verification\"\n        defaultMessage=\"<p>Email sent to {email}!</p><p>To continue, click on the link in the email using your phone, tablet, or PC.</p><p>No email? You may not be able to create an account.</p>\"\n        // eslint-disable-next-line react/display-name\n        values={{ email, p: chunks => <p>{chunks}</p> }}\n      />\n      {showNewsletterSignup && (\n        <p>\n          <small>\n            <FormattedMessage\n              id=\"sign-in-modal.newsletter-signup-question\"\n              defaultMessage=\"Want Hubs news sent to your inbox?\"\n            />\n            <br />\n            <a href=\"https://eepurl.com/gX_fH9\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <FormattedMessage id=\"sign-in-modal.newsletter-signup-link\" defaultMessage=\"Subscribe for updates\" />\n            </a>\n          </small>\n        </p>\n      )}\n      <CancelButton onClick={onCancel} />\n    </Column>\n  );\n}\n\nWaitForVerification.propTypes = {\n  showNewsletterSignup: PropTypes.bool,\n  email: PropTypes.string.isRequired,\n  onCancel: PropTypes.func.isRequired\n};\n\nexport function SignInComplete({ message, onContinue }) {\n  const intl = useIntl();\n\n  return (\n    <Column center padding>\n      <p>\n        <b>\n          {message ? (\n            intl.formatMessage(message)\n          ) : (\n            <FormattedMessage id=\"sign-in-modal.complete\" defaultMessage=\"You are now signed in.\" />\n          )}\n        </b>\n      </p>\n      <ContinueButton onClick={onContinue} />\n    </Column>\n  );\n}\n\nSignInComplete.propTypes = {\n  message: PropTypes.string,\n  onContinue: PropTypes.func.isRequired\n};\n\nexport function SignInModal({ closeable, onClose, children, ...rest }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"sign-in-modal.title\" defaultMessage=\"Sign In\" />}\n      beforeTitle={closeable && <CloseButton onClick={onClose} />}\n      {...rest}\n    >\n      {children}\n    </Modal>\n  );\n}\n\nSignInModal.propTypes = {\n  closeable: PropTypes.bool,\n  onClose: PropTypes.func,\n  children: PropTypes.node\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage, defineMessages } from \"react-intl\";\nimport configs from \"../utils/configs\";\nimport { pushHistoryPath, pushHistoryState, sluglessPath } from \"../utils/history\";\nimport { SOURCES } from \"../storage/media-search-store\";\nimport { showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport { AvatarUrlModalContainer } from \"./room/AvatarUrlModalContainer\";\nimport { SceneUrlModalContainer } from \"./room/SceneUrlModalContainer\";\nimport { ObjectUrlModalContainer } from \"./room/ObjectUrlModalContainer\";\nimport { MediaBrowser } from \"./room/MediaBrowser\";\nimport { IconButton } from \"./input/IconButton\";\nimport { ReactComponent as UploadIcon } from \"./icons/Upload.svg\";\nimport { ReactComponent as LinkIcon } from \"./icons/Link.svg\";\nimport { remixAvatar } from \"../utils/avatar-utils\";\nimport { fetchReticulumAuthenticated, getReticulumFetchUrl } from \"../utils/phoenix-utils\";\nimport { proxiedUrlFor, scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\nimport { CreateTile, MediaTile } from \"./room/MediaTiles\";\nimport { SignInMessages } from \"./auth/SignInModal\";\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst PRIVACY_POLICY_LINKS = {\n  videos: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  images: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  gifs: \"https://tenor.com/legal-privacy\",\n  sketchfab: \"https://sketchfab.com/privacy\",\n  youtube: \"https://policies.google.com/privacy\",\n  twitch: \"https://www.twitch.tv/p/legal/privacy-policy/\"\n};\n\nconst DEFAULT_FACETS = {\n  sketchfab: [\n    { text: \"Featured\", params: { filter: \"featured\" } },\n    { text: \"Animals\", params: { filter: \"animals-pets\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art-abstract\" } },\n    { text: \"Vehicles\", params: { filter: \"cars-vehicles\" } },\n    { text: \"Characters\", params: { filter: \"characters-creatures\" } },\n    { text: \"Culture\", params: { filter: \"cultural-heritage-history\" } },\n    { text: \"Gadgets\", params: { filter: \"electronics-gadgets\" } },\n    { text: \"Fashion\", params: { filter: \"fashion-style\" } },\n    { text: \"Food\", params: { filter: \"food-drink\" } },\n    { text: \"Furniture\", params: { filter: \"furniture-home\" } },\n    { text: \"Music\", params: { filter: \"music\" } },\n    { text: \"Nature\", params: { filter: \"nature-plants\" } },\n    { text: \"News\", params: { filter: \"news-politics\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Places\", params: { filter: \"places-travel\" } },\n    { text: \"Science\", params: { filter: \"science-technology\" } },\n    { text: \"Sports\", params: { filter: \"sports-fitness\" } },\n    { text: \"Weapons\", params: { filter: \"weapons-military\" } }\n  ],\n  avatars: [\n    { text: \"Featured\", params: { filter: \"featured\" } },\n    { text: \"My Avatars\", params: { filter: \"my-avatars\" } },\n    { text: \"Newest\", params: { filter: \"\" } }\n  ],\n  favorites: [],\n  scenes: [{ text: \"Featured\", params: { filter: \"featured\" } }, { text: \"My Scenes\", params: { filter: \"my-scenes\" } }]\n};\n\nconst poweredByMessages = defineMessages({\n  images: {\n    id: \"media-browser.powered_by.images\",\n    defaultMessage: \"Search by Bing\"\n  },\n  videos: {\n    id: \"media-browser.powered_by.videos\",\n    defaultMessage: \"Search by Bing\"\n  },\n  youtube: {\n    id: \"media-browser.powered_by.youtube\",\n    defaultMessage: \"Search by Google\"\n  },\n  gifs: {\n    id: \"media-browser.powered_by.gifs\",\n    defaultMessage: \"Search by Tenor\"\n  },\n  sketchfab: {\n    id: \"media-browser.powered_by.sketchfab\",\n    defaultMessage: \"Search by Sketchfab\"\n  },\n  twitch: {\n    id: \"media-browser.powered_by.twitch\",\n    defaultMessage: \"Search by Twitch\"\n  },\n  scenes: {\n    id: \"media-browser.powered_by.scenes\",\n    defaultMessage: \"Made with {editorName}\"\n  }\n});\n\nconst customObjectMessages = defineMessages({\n  object: {\n    id: \"media-browser.add_custom_object\",\n    defaultMessage: \"Custom URL or File\"\n  },\n  scene: {\n    id: \"media-browser.add_custom_scene\",\n    defaultMessage: \"Custom Scene\"\n  },\n  avatar: {\n    id: \"media-browser.add_custom_avatar\",\n    defaultMessage: \"Avatar GLB URL\"\n  }\n});\n\nconst searchPlaceholderMessages = defineMessages({\n  scenes: { id: \"media-browser.search-placeholder.scenes\", defaultMessage: \"Search Scenes...\" },\n  avatars: { id: \"media-browser.search-placeholder.avatars\", defaultMessage: \"Search Avatars...\" },\n  videos: { id: \"media-browser.search-placeholder.videos\", defaultMessage: \"Search for Videos...\" },\n  images: { id: \"media-browser.search-placeholder.images\", defaultMessage: \"Search for Images...\" },\n  youtube: { id: \"media-browser.search-placeholder.youtube\", defaultMessage: \"Search for Youtube videos...\" },\n  gifs: { id: \"media-browser.search-placeholder.gifs\", defaultMessage: \"Search for GIFs...\" },\n  twitch: { id: \"media-browser.search-placeholder.twitch\", defaultMessage: \"Search for Twitch streams...\" },\n  sketchfab: { id: \"media-browser.search-placeholder.sketchfab\", defaultMessage: \"Search Sketchfab Models...\" },\n  default: { id: \"media-browser.search-placeholder.default\", defaultMessage: \"Search...\" }\n});\n\nconst emptyMessages = defineMessages({\n  favorites: {\n    id: \"media-browser.empty.favorites\",\n    defaultMessage: \"You don't have any favorites. Click a ⭐ to add to your favorites.\"\n  },\n  default: {\n    id: \"media-browser.empty.default\",\n    defaultMessage: \"No results. Try entering a new search above.\"\n  }\n});\n\n// TODO: Migrate to use MediaGrid and media specific components like RoomTile\nclass MediaBrowserContainer extends Component {\n  static propTypes = {\n    mediaSearchStore: PropTypes.object,\n    history: PropTypes.object,\n    intl: PropTypes.object,\n    hubChannel: PropTypes.object,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    performConditionalSignIn: PropTypes.func,\n    showNonHistoriedDialog: PropTypes.func.isRequired,\n    scene: PropTypes.object.isRequired,\n    store: PropTypes.object.isRequired\n  };\n\n  state = { query: \"\", facets: [], showNav: true, selectNextResult: false, clearStashedQueryOnClose: false };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStoreAndHistoryState(props);\n    this.props.mediaSearchStore.addEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.addEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  componentDidMount() {}\n\n  componentWillUnmount() {\n    this.props.mediaSearchStore.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.removeEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  storeUpdated = () => {\n    const newState = this.getStoreAndHistoryState(this.props);\n    this.setState(newState);\n\n    if (this.state.selectNextResult) {\n      if (newState.result && newState.result.entries.length > 0) {\n        this.selectEntry(newState.result.entries[0]);\n      } else {\n        this.close();\n      }\n    }\n  };\n\n  sourceChanged = () => {\n    if (this.inputRef && !isMobile && !isMobileVR) {\n      this.inputRef.focus();\n    }\n  };\n\n  getUrlSource = searchParams =>\n    searchParams.get(\"media_source\") || sluglessPath(this.props.history.location).substring(7);\n\n  getStoreAndHistoryState = props => {\n    const searchParams = new URLSearchParams(props.history.location.search);\n    const result = props.mediaSearchStore.result;\n\n    const newState = { result, query: this.state.query || searchParams.get(\"q\") || \"\" };\n    const urlSource = this.getUrlSource(searchParams);\n    newState.showNav = !!(searchParams.get(\"media_nav\") !== \"false\");\n    newState.selectAction = searchParams.get(\"selectAction\") || \"spawn\";\n\n    if (result && result.suggestions && result.suggestions.length > 0) {\n      newState.facets = result.suggestions.map(s => {\n        return { text: s, params: { q: s } };\n      });\n    } else {\n      newState.facets = DEFAULT_FACETS[urlSource] || [];\n    }\n\n    return newState;\n  };\n\n  handleQueryUpdated = (query, forceNow) => {\n    this.setState({ result: null });\n\n    if (this._sendQueryTimeout) {\n      clearTimeout(this._sendQueryTimeout);\n      this._sendQueryTimeout = null;\n    }\n\n    if (forceNow) {\n      this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n    } else {\n      // Don't update search on every keystroke, but buffer for some ms.\n      this._sendQueryTimeout = setTimeout(() => {\n        // Drop filter for now, so entering text drops into \"search all\" mode\n        this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n        this._sendQueryTimeout = null;\n      }, 500);\n    }\n\n    this.setState({ query });\n  };\n\n  handleEntryClicked = (evt, entry) => {\n    evt.preventDefault();\n\n    if (!entry.lucky_query) {\n      this.selectEntry(entry);\n    } else {\n      // Entry has a pointer to another \"i'm feeling lucky\" query -- used for trending videos\n      //\n      // Also, mark the browser to clear the stashed query on close, since this is a temporary\n      // query we are running to get the result we want.\n      this.setState({ clearStashedQueryOnClose: true });\n      this.handleQueryUpdated(entry.lucky_query, true);\n    }\n  };\n\n  onShowSimilar = (id, name) => {\n    this.handleFacetClicked({ params: { similar_to: id, similar_name: name } });\n  };\n\n  selectEntry = entry => {\n    if (!this.props.onMediaSearchResultEntrySelected) return;\n    this.props.onMediaSearchResultEntrySelected(entry, this.state.selectAction);\n    this.close();\n  };\n\n  handleSourceClicked = source => {\n    this.props.mediaSearchStore.sourceNavigate(source);\n  };\n\n  handleFacetClicked = facet => {\n    this.setState({ query: \"\" }, () => {\n      const searchParams = this.getSearchClearedSearchParams(true, true, true);\n\n      for (const [k, v] of Object.entries(facet.params)) {\n        searchParams.set(k, v);\n      }\n\n      pushHistoryPath(this.props.history, this.props.history.location.pathname, searchParams.toString());\n    });\n  };\n\n  getSearchClearedSearchParams = (keepSource, keepNav, keepSelectAction) => {\n    return this.props.mediaSearchStore.getSearchClearedSearchParams(\n      this.props.history.location,\n      keepSource,\n      keepNav,\n      keepSelectAction\n    );\n  };\n\n  pushExitMediaBrowserHistory = (stashLastSearchParams = true) => {\n    this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history, stashLastSearchParams);\n  };\n\n  showCustomMediaDialog = source => {\n    const { scene, store, hubChannel } = this.props;\n    const isAvatarApiType = source === \"avatars\";\n    this.pushExitMediaBrowserHistory(!isAvatarApiType);\n\n    if (source === \"scenes\") {\n      this.props.showNonHistoriedDialog(SceneUrlModalContainer, { hubChannel });\n    } else if (isAvatarApiType) {\n      this.props.showNonHistoriedDialog(AvatarUrlModalContainer, { scene, store });\n    } else {\n      this.props.showNonHistoriedDialog(ObjectUrlModalContainer, { scene });\n    }\n  };\n\n  close = () => {\n    showFullScreenIfWasFullScreen();\n    const urlSource = this.getUrlSource(new URLSearchParams(this.props.history.location.search));\n    this.pushExitMediaBrowserHistory(urlSource !== \"avatars\" && urlSource !== \"favorites\");\n    if (this.state.clearStashedQueryOnClose) {\n      this.props.mediaSearchStore.clearStashedQuery();\n    }\n  };\n\n  handlePager = delta => {\n    this.setState({ result: null });\n    this.props.mediaSearchStore.pageNavigate(delta);\n    this.browserDiv.scrollTop = 0;\n  };\n\n  handleCopyAvatar = (e, entry) => {\n    e.preventDefault();\n\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      async () => {\n        await remixAvatar(entry.id, entry.name);\n        this.handleFacetClicked({ params: { filter: \"my-avatars\" } });\n      },\n      SignInMessages.remixAvatar\n    );\n  };\n\n  handleCopyScene = async (e, entry) => {\n    e.preventDefault();\n\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      async () => {\n        await fetchReticulumAuthenticated(\"/api/v1/scenes\", \"POST\", {\n          parent_scene_id: entry.id\n        });\n        this.handleFacetClicked({ params: { filter: \"my-scenes\" } });\n      },\n      SignInMessages.remixScene\n    );\n  };\n\n  onCreateAvatar = () => {\n    window.dispatchEvent(new CustomEvent(\"action_create_avatar\"));\n  };\n\n  processThumbnailUrl = (entry, thumbnailWidth, thumbnailHeight) => {\n    if (entry.images.preview.type === \"mp4\") {\n      return proxiedUrlFor(entry.images.preview.url);\n    } else {\n      return scaledThumbnailUrlFor(entry.images.preview.url, thumbnailWidth, thumbnailHeight);\n    }\n  };\n\n  render() {\n    const intl = this.props.intl;\n    const searchParams = new URLSearchParams(this.props.history.location.search);\n    const urlSource = this.getUrlSource(searchParams);\n    const isSceneApiType = urlSource === \"scenes\";\n    const isFavorites = urlSource === \"favorites\";\n    const showCustomOption =\n      !isFavorites && (!isSceneApiType || this.props.hubChannel.canOrWillIfCreator(\"update_hub\"));\n    const entries = (this.state.result && this.state.result.entries) || [];\n    const hideSearch = urlSource === \"favorites\";\n    const showEmptyStringOnNoResult = urlSource !== \"avatars\" && urlSource !== \"scenes\";\n\n    const facets = this.state.facets && this.state.facets.length > 0 ? this.state.facets : undefined;\n\n    // Don't render anything if we just did a feeling lucky query and are waiting on result.\n    if (this.state.selectNextResult) return <div />;\n    const handleCustomClicked = urlSource => {\n      const isAvatarApiType = urlSource === \"avatars\";\n      if (isAvatarApiType) {\n        this.showCustomMediaDialog(urlSource);\n      } else {\n        this.props.performConditionalSignIn(\n          () => !isSceneApiType || this.props.hubChannel.can(\"update_hub\"),\n          () => this.showCustomMediaDialog(urlSource),\n          SignInMessages.changeScene\n        );\n      }\n    };\n\n    const activeFilter =\n      searchParams.get(\"filter\") || (searchParams.get(\"similar_to\") && \"similar\") || (!searchParams.get(\"q\") && \"\");\n\n    const meta = this.state.result && this.state.result.meta;\n    const hasNext = !!(meta && meta.next_cursor);\n    const hasPrevious = !!searchParams.get(\"cursor\");\n\n    const customObjectType =\n      this.state.result && isSceneApiType ? \"scene\" : urlSource === \"avatars\" ? \"avatar\" : \"object\";\n\n    let searchDescription;\n\n    if (!hideSearch && urlSource !== \"scenes\" && urlSource !== \"avatars\" && urlSource !== \"favorites\") {\n      searchDescription = (\n        <>\n          {poweredByMessages[urlSource] ? intl.formatMessage(poweredByMessages[urlSource]) : \"\"}\n          {poweredByMessages[urlSource] && PRIVACY_POLICY_LINKS[urlSource] ? \" | \" : \"\"}\n          {PRIVACY_POLICY_LINKS[urlSource] && (\n            <a href={PRIVACY_POLICY_LINKS[urlSource]} target=\"_blank\" rel=\"noreferrer noopener\">\n              <FormattedMessage id=\"media-browser.privacy_policy\" defaultMessage=\"Privacy Policy\" />\n            </a>\n          )}\n        </>\n      );\n    } else if (urlSource === \"scenes\") {\n      searchDescription = (\n        <>\n          {configs.feature(\"enable_spoke\") && (\n            <>\n              {intl.formatMessage(poweredByMessages.scenes, {\n                editorName: (\n                  <a href=\"/spoke\" target=\"_blank\" rel=\"noreferrer noopener\">\n                    {configs.translation(\"editor-name\")}\n                  </a>\n                )\n              })}\n            </>\n          )}\n          {configs.feature(\"enable_spoke\") && configs.feature(\"show_issue_report_link\") && \" | \"}\n          {configs.feature(\"show_issue_report_link\") && (\n            <a\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              href={configs.link(\"issue_report\", \"https://hubs.mozilla.com/docs/help.html\")}\n            >\n              <FormattedMessage id=\"media-browser.report-issue\" defaultMessage=\"Report Issue\" />\n            </a>\n          )}\n        </>\n      );\n    }\n\n    return (\n      <MediaBrowser\n        browserRef={r => (this.browserDiv = r)}\n        onClose={this.close}\n        searchInputRef={r => (this.inputRef = r)}\n        autoFocusSearch={!isMobile && !isMobileVR}\n        query={this.state.query}\n        onChangeQuery={e => this.handleQueryUpdated(e.target.value)}\n        onSearchKeyDown={e => {\n          if (e.key === \"Enter\" && e.ctrlKey) {\n            if (entries.length > 0 && !this._sendQueryTimeout) {\n              this.handleEntryClicked(e, entries[0]);\n            } else if (this.state.query.trim() !== \"\") {\n              this.handleQueryUpdated(this.state.query, true);\n              this.setState({ selectNextResult: true });\n            } else {\n              this.close();\n            }\n          } else if (e.key === \"Escape\" || (e.key === \"Enter\" && isMobile)) {\n            e.target.blur();\n          }\n        }}\n        onClearSearch={() => this.handleQueryUpdated(\"\", true)}\n        mediaSources={urlSource === \"favorites\" ? undefined : SOURCES}\n        selectedSource={urlSource}\n        onSelectSource={this.handleSourceClicked}\n        activeFilter={activeFilter}\n        facets={facets}\n        onSelectFacet={this.handleFacetClicked}\n        searchPlaceholder={\n          searchPlaceholderMessages[urlSource]\n            ? intl.formatMessage(searchPlaceholderMessages[urlSource])\n            : intl.formatMessage(searchPlaceholderMessages.default)\n        }\n        searchDescription={searchDescription}\n        headerRight={\n          showCustomOption && (\n            <IconButton lg onClick={() => handleCustomClicked(urlSource)}>\n              {[\"scenes\", \"avatars\"].includes(urlSource) ? <LinkIcon /> : <UploadIcon />}\n              <p>{intl.formatMessage(customObjectMessages[customObjectType])}</p>\n            </IconButton>\n          )\n        }\n        hasNext={hasNext}\n        hasPrevious={hasPrevious}\n        onNextPage={() => this.handlePager(1)}\n        onPreviousPage={() => this.handlePager(-1)}\n        noResultsMessage={\n          emptyMessages[urlSource]\n            ? intl.formatMessage(emptyMessages[urlSource])\n            : intl.formatMessage(emptyMessages.default)\n        }\n      >\n        {this.props.mediaSearchStore.isFetching ||\n        this._sendQueryTimeout ||\n        entries.length > 0 ||\n        !showEmptyStringOnNoResult ? (\n          <>\n            {urlSource === \"avatars\" && (\n              <CreateTile\n                type=\"avatar\"\n                onClick={this.onCreateAvatar}\n                label={<FormattedMessage id=\"media-browser.create-avatar\" defaultMessage=\"Create Avatar\" />}\n              />\n            )}\n            {urlSource === \"scenes\" &&\n              configs.feature(\"enable_spoke\") && (\n                <CreateTile\n                  as=\"a\"\n                  href=\"/spoke/new\"\n                  rel=\"noopener noreferrer\"\n                  target=\"_blank\"\n                  type=\"scene\"\n                  label={\n                    <FormattedMessage\n                      id=\"media-browser.create-scene\"\n                      defaultMessage=\"Create Scene with {editorName}\"\n                      values={{ editorName: configs.translation(\"editor-name\") }}\n                    />\n                  }\n                />\n              )}\n            {entries.map((entry, idx) => {\n              const isAvatar = entry.type === \"avatar\" || entry.type === \"avatar_listing\";\n              const isScene = entry.type === \"scene\" || entry.type === \"scene_listing\";\n              const onShowSimilar =\n                entry.type === \"avatar_listing\"\n                  ? e => {\n                      e.preventDefault();\n                      this.onShowSimilar(entry.id, entry.name);\n                    }\n                  : undefined;\n\n              let onEdit;\n\n              if (entry.type === \"avatar\") {\n                onEdit = e => {\n                  e.preventDefault();\n                  pushHistoryState(this.props.history, \"overlay\", \"avatar-editor\", { avatarId: entry.id });\n                };\n              } else if (entry.type === \"scene\") {\n                onEdit = e => {\n                  e.preventDefault();\n                  const spokeProjectUrl = getReticulumFetchUrl(`/spoke/projects/${entry.project_id}`);\n                  window.open(spokeProjectUrl);\n                };\n              }\n\n              let onCopy;\n\n              if (isAvatar) {\n                onCopy = e => this.handleCopyAvatar(e, entry);\n              } else if (isScene) {\n                onCopy = e => this.handleCopyScene(e, entry);\n              }\n\n              return (\n                <MediaTile\n                  key={`${entry.id}_${idx}`}\n                  entry={entry}\n                  processThumbnailUrl={this.processThumbnailUrl}\n                  onClick={e => this.handleEntryClicked(e, entry)}\n                  onEdit={onEdit}\n                  onShowSimilar={onShowSimilar}\n                  onCopy={onCopy}\n                />\n              );\n            })}\n          </>\n        ) : null}\n      </MediaBrowser>\n    );\n  }\n}\n\nexport default injectIntl(MediaBrowserContainer);\n","import { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\n// this component is currently just being used for its componentDidMount\n// TODO migrate render from ui-root.js renderEntryStartPanel()\nexport default class EntryStartPanel extends Component {\n  static propTypes = {\n    entering: PropTypes.bool,\n    onEnteringCanceled: PropTypes.func\n  };\n\n  componentDidMount() {\n    if (this.props.entering) {\n      this.props.onEnteringCanceled();\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n","import configs from \"../utils/configs\";\n\nexport default function IfFeature(props) {\n  return (configs.feature(props.name) && props.children) || null;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { defineMessage, FormattedMessage, injectIntl } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faCloudUploadAlt } from \"@fortawesome/free-solid-svg-icons/faCloudUploadAlt\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport configs from \"../utils/configs\";\nimport IfFeature from \"./if-feature\";\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport { upload } from \"../utils/media-utils\";\nimport { ensureAvatarMaterial } from \"../utils/avatar-utils\";\n\nimport AvatarPreview from \"./avatar-preview\";\nimport styles from \"../assets/stylesheets/avatar-editor.scss\";\n\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\n\nconst delistAvatarInfoMessage = defineMessage({\n  id: \"avatar-editor.delist-avatar-info\",\n  defaultMessage:\n    \"Other users already using this avatar will still be able to use it, but it will be removed from 'My Avatars' and search results.\"\n});\n\nconst AVATARS_API = \"/api/v1/avatars\";\n\nconst defaultEditors = [\n  {\n    name: \"Quilt\",\n    url: \"https://tryquilt.io/?gltf=$AVATAR_GLTF\"\n  }\n];\nconst useAllowedEditors = true;\nconst allowedEditors = [\n  ...defaultEditors,\n  {\n    name: \"Skindex Editor\",\n    url: \"https://www.minecraftskins.com/skin-editor\"\n  },\n  {\n    name: \"MinecraftSkins.net Editor\",\n    url: \"https://www.minecraftskins.net/skineditor\"\n  }\n];\n\nconst fetchAvatar = async avatarId => {\n  const { avatars } = await fetchReticulumAuthenticated(`${AVATARS_API}/${avatarId}`);\n  return avatars[0];\n};\n\n// GLTFLoader plugin for splitting glTF and bin from glb.\nclass GLTFBinarySplitterPlugin {\n  constructor(parser) {\n    this.parser = parser;\n    this.gltf = null;\n    this.bin = null;\n  }\n\n  beforeRoot() {\n    const parser = this.parser;\n    const { body } = parser.extensions.KHR_binary_glTF;\n    const content = JSON.stringify(ensureAvatarMaterial(parser.json));\n\n    this.gltf = new File([content], \"file.gltf\", {\n      type: \"model/gltf\"\n    });\n    this.bin = new File([body], \"file.bin\", {\n      type: \"application/octet-stream\"\n    });\n\n    // This plugin just wants to split gltf and bin from glb and\n    // doesn't want to start the parse. But glTF loader plugin API\n    // doesn't have an ability to cancel the parse. So overriding\n    // parser.json with very light glTF data as workaround.\n    parser.json = { asset: { version: \"2.0\" } };\n  }\n\n  afterRoot(result) {\n    result.files = result.files || {};\n    result.files.gltf = this.gltf;\n    result.files.bin = this.bin;\n  }\n}\n\nclass AvatarEditor extends Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    onSave: PropTypes.func,\n    onClose: PropTypes.func,\n    hideDelete: PropTypes.bool,\n    debug: PropTypes.bool,\n    className: PropTypes.string,\n    intl: PropTypes.object.isRequired\n  };\n\n  state = {\n    baseAvatarResults: [],\n    editorLinks: defaultEditors,\n    previewGltfUrl: null\n  };\n\n  constructor(props) {\n    super(props);\n    this.inputFiles = {};\n  }\n\n  componentDidMount = async () => {\n    if (this.props.avatarId) {\n      const avatar = await fetchAvatar(this.props.avatarId);\n      avatar.creatorAttribution = (avatar.attributions && avatar.attributions.creator) || \"\";\n      Object.assign(this.inputFiles, avatar.files);\n      this.setState({ avatar, previewGltfUrl: avatar.base_gltf_url });\n    } else {\n      const { entries } = await fetchReticulumAuthenticated(`/api/v1/media/search?filter=base&source=avatar_listings`);\n      const baseAvatarResults = entries.map(e => ({ id: e.id, name: e.name, gltfs: e.gltfs, images: e.images }));\n      if (baseAvatarResults.length) {\n        const randomAvatarResult = baseAvatarResults[Math.floor(Math.random() * baseAvatarResults.length)];\n        this.setState({\n          baseAvatarResults,\n          avatar: {\n            name: \"My Avatar\",\n            files: {},\n            base_gltf_url: randomAvatarResult.gltfs.base,\n            parent_avatar_listing_id: randomAvatarResult.id\n          },\n          previewGltfUrl: randomAvatarResult.gltfs.avatar\n        });\n      } else {\n        this.setState({\n          avatar: {\n            name: \"My Avatar\",\n            files: {}\n          }\n        });\n      }\n    }\n  };\n\n  createOrUpdateAvatar = avatar => {\n    return fetchReticulumAuthenticated(\n      avatar.avatar_id ? `${AVATARS_API}/${avatar.avatar_id}` : AVATARS_API,\n      avatar.avatar_id ? \"PUT\" : \"POST\",\n      { avatar }\n    ).then(({ avatars }) => avatars[0]);\n  };\n\n  uploadAvatar = async e => {\n    e.preventDefault();\n\n    if (this.inputFiles.glb && this.inputFiles.glb instanceof File) {\n      const gltfLoader = new GLTFLoader().register(parser => new GLTFBinarySplitterPlugin(parser));\n      const gltfUrl = URL.createObjectURL(this.inputFiles.glb);\n      const onProgress = console.log;\n\n      await new Promise((resolve, reject) => {\n        // GLTFBinarySplitterPlugin saves gltf and bin in gltf.files\n        gltfLoader.load(\n          gltfUrl,\n          result => {\n            this.inputFiles.gltf = result.files.gltf;\n            this.inputFiles.bin = result.files.bin;\n            resolve(result);\n          },\n          onProgress,\n          reject\n        );\n      });\n\n      URL.revokeObjectURL(gltfUrl);\n    }\n\n    this.inputFiles.thumbnail = new File([await this.preview.snapshot()], \"thumbnail.png\", {\n      type: \"image/png\"\n    });\n\n    const filesToUpload = [\"gltf\", \"bin\", \"base_map\", \"emissive_map\", \"normal_map\", \"orm_map\", \"thumbnail\"].filter(\n      k => this.inputFiles[k] === null || this.inputFiles[k] instanceof File\n    );\n\n    this.setState({ uploading: true });\n\n    const fileUploads = await Promise.all(filesToUpload.map(f => this.inputFiles[f] && upload(this.inputFiles[f])));\n    const avatar = {\n      ...this.state.avatar,\n      attributions: {\n        creator: this.state.avatar.creatorAttribution\n      },\n      files: fileUploads\n        .map((resp, i) => [filesToUpload[i], resp && [resp.file_id, resp.meta.access_token, resp.meta.promotion_token]])\n        .reduce((o, [k, v]) => ({ ...o, [k]: v }), {})\n    };\n\n    await this.createOrUpdateAvatar(avatar);\n\n    this.setState({ uploading: false });\n\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  deleteAvatar = async e => {\n    e.preventDefault();\n    await fetchReticulumAuthenticated(`${AVATARS_API}/${this.state.avatar.avatar_id}`, \"DELETE\");\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  fileField = (name, label, accept, disabled = false, title) => (\n    <div className={classNames(\"file-input-row\", { disabled })} key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\" />\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[name] = file;\n          URL.revokeObjectURL(this.state.previewGltfUrl);\n          const previewGltfUrl = URL.createObjectURL(this.inputFiles.glb);\n          this.setState({\n            previewGltfUrl,\n            avatar: {\n              ...this.state.avatar,\n              files: {\n                ...this.state.avatar.files,\n                [name]: URL.createObjectURL(file)\n              }\n            }\n          });\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n            URL.revokeObjectURL(this.state.avatar.files[name]);\n            this.setState(\n              {\n                avatar: {\n                  ...this.state.avatar,\n                  files: {\n                    ...this.state.avatar.files,\n                    [name]: null\n                  }\n                }\n              },\n              () => this.setState({ previewGltfUrl: this.getPreviewUrl() })\n            );\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  mapField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\">\n          {this.state.avatar.files[name] ? (\n            <img src={this.state.avatar.files[name]} />\n          ) : (\n            <FontAwesomeIcon icon={faCloudUploadAlt} />\n          )}\n        </div>\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[name] = file;\n          URL.revokeObjectURL(this.state.avatar.files[name]);\n          this.setState({\n            avatar: {\n              ...this.state.avatar,\n              files: {\n                ...this.state.avatar.files,\n                [name]: URL.createObjectURL(file)\n              }\n            }\n          });\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n            URL.revokeObjectURL(this.state.avatar.files[name]);\n            this.setState({\n              avatar: {\n                ...this.state.avatar,\n                files: {\n                  ...this.state.avatar.files,\n                  [name]: null\n                }\n              }\n            });\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  textField = (name, placeholder, disabled, required) => (\n    <div className=\"text-field-container\">\n      <label htmlFor={`#avatar-${name}`}>{placeholder}</label>\n      <input\n        id={`avatar-${name}`}\n        type=\"text\"\n        disabled={disabled}\n        required={required}\n        placeholder={placeholder}\n        className=\"text-field\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  // Return the gltf for the selected base avatar, the locally modified glb, or the avatar's base_gltf_url\n  getPreviewUrl = baseSid => {\n    if (baseSid) {\n      const avatarResult = this.state.baseAvatarResults.find(a => a.id === baseSid);\n      if (avatarResult) return avatarResult.gltfs.avatar;\n    }\n\n    return this.inputFiles.glb ? URL.createObjectURL(this.inputFiles.glb) : this.state.avatar.base_gltf_url;\n  };\n\n  selectListingField = (propName, placeholder) => (\n    <div className=\"select-container\">\n      <label htmlFor={`#avatar-${propName}`}>{placeholder}</label>\n      <select\n        id={`avatar-${propName}`}\n        value={this.state.avatar[propName] || \"\"}\n        onChange={async e => {\n          const sid = e.target.value;\n          this.setState({ avatar: { ...this.state.avatar, [propName]: sid }, previewGltfUrl: this.getPreviewUrl(sid) });\n        }}\n        placeholder={placeholder}\n        className=\"select\"\n      >\n        {this.state.baseAvatarResults.map(a => (\n          <option key={a.id} value={a.id}>\n            {a.name}\n          </option>\n        ))}\n        <option value=\"\">\n          <FormattedMessage id=\"avatar-editor.custom-avatar-option\" defaultMessage=\"Custom GLB...\" />\n        </option>\n      </select>\n      <img\n        className=\"arrow\"\n        src=\"../assets/images/dropdown_arrow.png\"\n        srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n      />\n    </div>\n  );\n\n  selectListingGrid = (propName, placeholder) => (\n    <div className=\"select-grid-container\">\n      <label htmlFor={`#avatar-${propName}`}>{placeholder}</label>\n      <div className=\"select-grid\">\n        {this.state.baseAvatarResults.map(a => (\n          <div\n            onClick={() =>\n              this.setState({\n                avatar: { ...this.state.avatar, [propName]: a.id },\n                previewGltfUrl: this.getPreviewUrl(a.id)\n              })\n            }\n            key={a.id}\n            className={classNames(\"item\", { selected: a.id === this.state.avatar[propName] })}\n            style={{ paddingBottom: `${(a.images.preview.width / a.images.preview.height) * 100}%` }}\n          >\n            <img src={a.images.preview.url} />\n          </div>\n        ))}\n      </div>\n      <input\n        id=\"avatar-file_glb\"\n        type=\"file\"\n        accept=\"model/gltf+binary,.glb\"\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[\"glb\"] = file;\n          URL.revokeObjectURL(this.state.avatar.files[\"glb\"]);\n          this.setState({\n            avatar: {\n              ...this.state.avatar,\n              [propName]: \"\",\n              files: {\n                ...this.state.avatar.files,\n                glb: URL.createObjectURL(file)\n              }\n            },\n            previewGltfUrl: this.getPreviewUrl(\"\")\n          });\n        }}\n      />\n      <label\n        htmlFor=\"avatar-file_glb\"\n        className={classNames(\"item\", \"custom\", { selected: \"\" === this.state.avatar[propName] })}\n      >\n        <FormattedMessage\n          id=\"avatar-editor.upload-custom-avatar-button\"\n          defaultMessage=\"{icon} Custom GLB\"\n          values={{ icon: <FontAwesomeIcon icon={faCloudUploadAlt} /> }}\n        />\n      </label>\n    </div>\n  );\n\n  textarea = (name, placeholder, disabled) => (\n    <div>\n      <textarea\n        id={`avatar-${name}`}\n        disabled={disabled}\n        placeholder={placeholder}\n        className=\"textarea\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  checkbox = (name, title, children, disabled) => (\n    <div className=\"checkbox-container\" title={title}>\n      <input\n        id={`avatar-${name}`}\n        type=\"checkbox\"\n        className=\"checkbox\"\n        disabled={disabled}\n        checked={!!this.state.avatar[name]}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.checked } })}\n      />\n      <label htmlFor={`#avatar-${name}`}>{children}</label>\n    </div>\n  );\n\n  handleGltfLoaded = gltf => {\n    const ext = gltf.parser.json.extensions && gltf.parser.json.extensions[\"MOZ_hubs_avatar\"];\n    let editorLinks = (ext && ext.editors) || defaultEditors;\n    if (useAllowedEditors) {\n      editorLinks = editorLinks.filter(e => allowedEditors.some(w => w.name === e.name && w.url === e.url));\n    }\n    this.setState({ editorLinks });\n  };\n\n  render() {\n    const { debug, intl } = this.props;\n    const { avatar } = this.state;\n\n    return (\n      <div className={classNames(styles.avatarEditor, this.props.className)}>\n        {this.props.onClose && (\n          <a className=\"close-button\" onClick={this.props.onClose}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </a>\n        )}\n        {!this.state.avatar ? (\n          <div className=\"loader\">\n            <div className=\"loader-center\" />\n          </div>\n        ) : (\n          <form onSubmit={this.uploadAvatar} className=\"center\">\n            {this.textField(\"name\", \"Name\", false, true)}\n            <div className=\"split\">\n              <div className=\"form-body\">\n                {debug &&\n                  this.textField(\n                    \"avatar_id\",\n                    intl.formatMessage({ id: \"avatar-editor.field.avatar-id\", defaultMessage: \"Avatar ID\" }),\n                    true\n                  )}\n                {debug &&\n                  this.textField(\n                    \"parent_avatar_id\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.parent-avatar-id\",\n                      defaultMessage: \"Parent Avatar ID\"\n                    })\n                  )}\n                {debug &&\n                  this.textField(\n                    \"parent_avatar_listing_id\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.parent-avatar-listing-id\",\n                      defaultMessage: \"Parent Avatar Listing ID\"\n                    })\n                  )}\n                {debug &&\n                  this.textarea(\n                    \"description\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.description\",\n                      defaultMessage: \"Description\"\n                    })\n                  )}\n                {!this.props.avatarId &&\n                  this.selectListingGrid(\n                    \"parent_avatar_listing_id\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.model\",\n                      defaultMessage: \"Model\"\n                    })\n                  )}\n\n                <label>\n                  <FormattedMessage id=\"avatar-editor.skin-section\" defaultMessage=\"Skin\" />\n                </label>\n                {this.mapField(\n                  \"base_map\",\n                  intl.formatMessage({\n                    id: \"avatar-editor.field.base-map\",\n                    defaultMessage: \"Base Map\"\n                  }),\n                  \"image/*\"\n                )}\n                <details>\n                  <summary>\n                    <FormattedMessage id=\"avatar-editor.advanced-section\" defaultMessage=\"Advanced\" />\n                  </summary>\n                  {this.mapField(\n                    \"emissive_map\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.emissive-map\",\n                      defaultMessage: \"Emissive Map\"\n                    }),\n                    \"image/*\"\n                  )}\n                  {this.mapField(\n                    \"normal_map\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.normal-map\",\n                      defaultMessage: \"Normal Map\"\n                    }),\n                    \"image/*\"\n                  )}\n                  {this.mapField(\n                    \"orm_map\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.orm-map\",\n                      defaultMessage: \"ORM Map\"\n                    }),\n                    \"image/*\",\n                    false,\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.orm-map-info\",\n                      defaultMessage: \"Occlussion (r), Roughness (g), Metallic (b)\"\n                    })\n                  )}\n                </details>\n\n                <label>\n                  <FormattedMessage id=\"avatar-editor.share-settings\" defaultMessage=\"Share Settings\" />\n                </label>\n                {this.checkbox(\n                  \"allow_promotion\",\n                  intl.formatMessage(\n                    {\n                      id: \"avatar-editor.field.allow-promotion\",\n                      defaultMessage: \"Allow {companyName} to promote your avatar, and show it in search results.\"\n                    },\n                    { companyName: configs.translation(\"company-name\") }\n                  ),\n                  <span>\n                    <FormattedMessage\n                      id=\"avatar-editor.field.allow-promotion-checkbox\"\n                      defaultMessage=\"Allow <a>Promotion</a>\"\n                      values={{\n                        a: chunks => (\n                          <a\n                            href={configs.link(\"promotion\", \"https://github.com/mozilla/hubs/blob/master/PROMOTION.md\")}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            {chunks}\n                          </a>\n                        )\n                      }}\n                    />\n                  </span>\n                )}\n                {this.checkbox(\n                  \"allow_remixing\",\n                  intl.formatMessage({\n                    id: \"avatar-editor.field.allow-remixing\",\n                    defaultMessage: \"Allow others to edit and re-publish your avatar as long as they give you credit.\"\n                  }),\n                  <span>\n                    <FormattedMessage\n                      id=\"avatar-editor.field.allow-remixing-checkbox\"\n                      defaultMessage=\"Allow <a>Remixing</a> <license>(under <licenselink>CC-BY 3.0</licenselink>)</license>\"\n                      values={{\n                        a: chunks => (\n                          <a\n                            href={configs.link(\"remixing\", \"https://github.com/mozilla/hubs/blob/master/REMIXING.md\")}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            {chunks}\n                          </a>\n                        ),\n                        license: chunks => <span className=\"license\">{chunks}</span>,\n                        licenselink: chunks => (\n                          <a\n                            href=\"https://creativecommons.org/licenses/by/3.0/\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            {chunks}\n                          </a>\n                        )\n                      }}\n                    />\n                  </span>\n                )}\n                {this.textField(\n                  \"creatorAttribution\",\n                  intl.formatMessage({\n                    id: \"avatar-editor.field.creator-attribution\",\n                    defaultMessage: \"Attribution (optional)\"\n                  }),\n                  false,\n                  false\n                )}\n                {/* {this.mapField(\"ao_map\", \"AO Map\", \"images/\\*\", true)} */}\n                {/* {this.mapField(\"metallic_map\", \"Metallic Map\", \"image/\\*\", true)} */}\n                {/* {this.mapField(\"roughness_map\", \"Roughness Map\", \"image/\\*\", true)} */}\n              </div>\n              <AvatarPreview\n                className=\"preview\"\n                avatarGltfUrl={this.state.previewGltfUrl}\n                onGltfLoaded={this.handleGltfLoaded}\n                {...this.inputFiles}\n                ref={p => (this.preview = p)}\n              />\n            </div>\n            <div className=\"info\">\n              <IfFeature name=\"show_avatar_editor_link\">\n                <p>\n                  <FormattedMessage\n                    id=\"avatar-editor.external-editor-info\"\n                    defaultMessage=\"Create a custom skin for this avatar:\"\n                  />{\" \"}\n                  {this.state.editorLinks.map(({ name, url }) => (\n                    <a\n                      key={name}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      href={url.replace(\"$AVATAR_GLTF\", encodeURIComponent(this.state.previewGltfUrl))}\n                    >\n                      {name}\n                    </a>\n                  ))}\n                </p>\n              </IfFeature>\n              <IfFeature name=\"show_avatar_pipelines_link\">\n                <p>\n                  <FormattedMessage\n                    id=\"avatar-editor.info\"\n                    defaultMessage=\"Find more custom avatar resources <a>here</a>\"\n                    values={{\n                      a: chunks => (\n                        <a\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          href=\"https://github.com/MozillaReality/hubs-avatar-pipelines\"\n                        >\n                          {chunks}\n                        </a>\n                      )\n                    }}\n                  />\n                </p>\n              </IfFeature>\n            </div>\n            <div>\n              <button disabled={this.state.uploading} className=\"form-submit\" type=\"submit\">\n                {this.state.uploading ? (\n                  <FormattedMessage id=\"avatar-editor.submit-button.uploading\" defaultMessage=\"Uploading...\" />\n                ) : (\n                  <FormattedMessage id=\"avatar-editor.submit-button.save\" defaultMessage=\"Save\" />\n                )}\n              </button>\n            </div>\n            {!this.props.hideDelete && (\n              <div className=\"delete-avatar\">\n                {this.state.confirmDelete ? (\n                  <span>\n                    <FormattedMessage\n                      id=\"avatar-editor.delete-avatar.confirmation-prompt\"\n                      defaultMessage=\"Are you sure?\"\n                    />{\" \"}\n                    <a onClick={this.deleteAvatar}>\n                      <FormattedMessage id=\"avatar-editor.delete-avatar.confirm\" defaultMessage=\"yes\" />\n                    </a>{\" \"}\n                    /{\" \"}\n                    <a onClick={() => this.setState({ confirmDelete: false })}>\n                      <FormattedMessage id=\"avatar-editor.delete-avatar.cancel\" defaultMessage=\"no\" />\n                    </a>\n                  </span>\n                ) : (\n                  <a\n                    onClick={() => this.setState({ confirmDelete: true })}\n                    title={avatar.has_listings ? intl.formatMessage(delistAvatarInfoMessage) : \"\"}\n                  >\n                    {avatar.has_listings ? (\n                      <FormattedMessage id=\"avatar-editor.delist-avatar-button\" defaultMessage=\"Delist Avatar\" />\n                    ) : (\n                      <FormattedMessage id=\"avatar-editor.delete-avatar-button\" defaultMessage=\"Delete Avatar\" />\n                    )}\n                  </a>\n                )}\n              </div>\n            )}\n          </form>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarEditor);\n","// extracted by mini-css-extract-plugin\nexport default {\"avatar-editor\":\"avatar-editor__avatar-editor___imLb\",\"avatarEditor\":\"avatar-editor__avatar-editor___imLb\",\"no-default-button-style\":\"avatar-editor__no-default-button-style__lSVD9\",\"noDefaultButtonStyle\":\"avatar-editor__no-default-button-style__lSVD9\"};","// extracted by mini-css-extract-plugin\nexport default {\"nav-item\":\"preferences-screen__nav-item__VrLF0\",\"navItem\":\"preferences-screen__nav-item__VrLF0\",\"dropdown\":\"preferences-screen__dropdown__LrsA3\",\"section-title\":\"preferences-screen__section-title__J4cDt\",\"sectionTitle\":\"preferences-screen__section-title__J4cDt\",\"refresh-prompt\":\"preferences-screen__refresh-prompt__pwOTs\",\"refreshPrompt\":\"preferences-screen__refresh-prompt__pwOTs\",\"preference-label\":\"preferences-screen__preference-label__aHcLt\",\"preferenceLabel\":\"preferences-screen__preference-label__aHcLt\",\"max-resolution-preference-item\":\"preferences-screen__max-resolution-preference-item__OIo2v\",\"maxResolutionPreferenceItem\":\"preferences-screen__max-resolution-preference-item__OIo2v\",\"preferences-panel\":\"preferences-screen__preferences-panel__POWVM\",\"preferencesPanel\":\"preferences-screen__preferences-panel__POWVM\",\"refresh-now-button\":\"preferences-screen__refresh-now-button__ZxJGS\",\"refreshNowButton\":\"preferences-screen__refresh-now-button__ZxJGS\",\"reset-to-default-button\":\"preferences-screen__reset-to-default-button__MuW_X\",\"resetToDefaultButton\":\"preferences-screen__reset-to-default-button__MuW_X\",\"close-button\":\"preferences-screen__close-button__WOdhQ\",\"closeButton\":\"preferences-screen__close-button__WOdhQ\",\"no-default-button-style\":\"preferences-screen__no-default-button-style__LQMg7\",\"noDefaultButtonStyle\":\"preferences-screen__no-default-button-style__LQMg7\",\"nav-container\":\"preferences-screen__nav-container__JV3iZ\",\"navContainer\":\"preferences-screen__nav-container__JV3iZ\",\"nav\":\"preferences-screen__nav__KROCu\",\"selected\":\"preferences-screen__selected__cPwAz\",\"vertical\":\"preferences-screen__vertical__dX9ns\",\"horizontal\":\"preferences-screen__horizontal__r4r_J\",\"list-item\":\"preferences-screen__list-item__TotHO\",\"listItem\":\"preferences-screen__list-item__TotHO\",\"column\":\"preferences-screen__column__FGH5c\",\"row\":\"preferences-screen__row__kOhFR\",\"row-right\":\"preferences-screen__row-right__PIhoB\",\"rowRight\":\"preferences-screen__row-right__PIhoB\",\"row-center\":\"preferences-screen__row-center__uGrVH\",\"rowCenter\":\"preferences-screen__row-center__uGrVH\",\"warn-icon\":\"preferences-screen__warn-icon__Xbh58\",\"warnIcon\":\"preferences-screen__warn-icon__Xbh58\",\"warn-icon-placeholder\":\"preferences-screen__warn-icon-placeholder__rMpBA\",\"warnIconPlaceholder\":\"preferences-screen__warn-icon-placeholder__rMpBA\",\"control-with-default\":\"preferences-screen__control-with-default__k5ChU\",\"controlWithDefault\":\"preferences-screen__control-with-default__k5ChU\",\"toast\":\"preferences-screen__toast__l7Z5F\",\"reset-to-default-button-placeholder\":\"preferences-screen__reset-to-default-button-placeholder__zZzKp\",\"resetToDefaultButtonPlaceholder\":\"preferences-screen__reset-to-default-button-placeholder__zZzKp\",\"flex\":\"preferences-screen__flex__YLsBQ\",\"icon\":\"preferences-screen__icon__IUXoU\",\"content-container\":\"preferences-screen__content-container__ab7sK\",\"contentContainer\":\"preferences-screen__content-container__ab7sK\",\"scrolling-content\":\"preferences-screen__scrolling-content__QX5E3\",\"scrollingContent\":\"preferences-screen__scrolling-content__QX5E3\",\"checkbox-placeholder\":\"preferences-screen__checkbox-placeholder__txAun\",\"checkboxPlaceholder\":\"preferences-screen__checkbox-placeholder__txAun\",\"section\":\"preferences-screen__section__EydJA\",\"dropdown-arrow\":\"preferences-screen__dropdown-arrow__ot2ZP\",\"dropdownArrow\":\"preferences-screen__dropdown-arrow__ot2ZP\",\"number-with-range\":\"preferences-screen__number-with-range__zjW7r\",\"numberWithRange\":\"preferences-screen__number-with-range__zjW7r\",\"number-in-number-with-range\":\"preferences-screen__number-in-number-with-range__j8wRT\",\"numberInNumberWithRange\":\"preferences-screen__number-in-number-with-range__j8wRT\"};","import { EventEmitter } from \"eventemitter3\";\nimport { MediaDevicesEvents, PermissionStatus, MediaDevices, NO_DEVICE_ID } from \"./media-devices-utils\";\nimport { detectOS, detect } from \"detect-browser\";\nimport { isIOS as detectIOS } from \"./is-mobile\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isIOS = detectIOS();\n\n// This is a list of regexes that match the microphone labels of HMDs.\n//\n// If entering VR mode, and if any of these regexes match an audio device,\n// the user will be prevented from entering VR until one of those devices is\n// selected as the microphone.\n//\n// Note that this doesn't have to be exhaustive: if no devices match any regex\n// then we rely upon the user to select the proper mic.\nconst HMD_MIC_REGEXES = [/\\Wvive\\W/i, /\\Wrift\\W/i];\n\nconst audioOutputSelectEnabled = \"sinkId\" in HTMLMediaElement.prototype;\n\n// Subsequest calls to getUserMedia throw an exception and return a muted track so we disable mic selection for the moment.\n// Safari 15+\nconst detectedOS = detectOS(navigator.userAgent);\nconst browser = detect();\nconst audioInputSelectEnabled = !([\"iOS\", \"Mac OS\"].includes(detectedOS) && [\"safari\", \"ios\"].includes(browser.name));\n\nexport default class MediaDevicesManager extends EventEmitter {\n  constructor(scene, store, audioSystem) {\n    super();\n\n    this._scene = scene;\n    this._store = store;\n    this._micDevices = [];\n    this._videoDevices = [];\n    this._outputDevices = [];\n    this._deviceId = null;\n    this._audioTrack = null;\n    this.audioSystem = audioSystem;\n    this._mediaStream = audioSystem.outboundStream;\n    this._permissionsStatus = {\n      [MediaDevices.MICROPHONE]: PermissionStatus.PROMPT,\n      [MediaDevices.SPEAKERS]: PermissionStatus.PROMPT,\n      [MediaDevices.CAMERA]: PermissionStatus.PROMPT,\n      [MediaDevices.SCREEN]: PermissionStatus.PROMPT\n    };\n\n    this.onDeviceChange = this.onDeviceChange.bind(this);\n    navigator.mediaDevices.addEventListener(\"devicechange\", this.onDeviceChange);\n  }\n\n  static get isAudioOutputSelectEnabled() {\n    return audioOutputSelectEnabled;\n  }\n\n  static get isAudioInputSelectEnabled() {\n    return audioInputSelectEnabled;\n  }\n\n  get deviceId() {\n    return this._deviceId;\n  }\n\n  set deviceId(deviceId) {\n    this._deviceId = deviceId;\n  }\n\n  get audioTrack() {\n    return this._audioTrack;\n  }\n\n  set audioTrack(audioTrack) {\n    this._audioTrack = audioTrack;\n  }\n\n  get defaultInputDeviceId() {\n    return this._micDevices.length > 0 ? this._micDevices[0].value : NO_DEVICE_ID;\n  }\n\n  get defaultOutputDeviceId() {\n    return this._outputDevices.length > 0 ? this._outputDevices[0].value : NO_DEVICE_ID;\n  }\n\n  get defaultVideoDeviceId() {\n    return this._videoDevices.length > 0 ? this._videoDevices[0].value : NO_DEVICE_ID;\n  }\n\n  get micDevicesOptions() {\n    return this._micDevices.length > 0 ? this._micDevices : [{ value: NO_DEVICE_ID, label: \"None\" }];\n  }\n\n  get videoDevicesOptions() {\n    return this._videoDevices.length > 0 ? this._videoDevices : [{ value: NO_DEVICE_ID, label: \"None\" }];\n  }\n\n  get outputDevicesOptions() {\n    return this._outputDevices.length > 0 ? this._outputDevices : [{ value: NO_DEVICE_ID, label: \"None\" }];\n  }\n\n  get mediaStream() {\n    return this._mediaStream;\n  }\n\n  set mediaStream(mediaStream) {\n    this._mediaStream = mediaStream;\n  }\n\n  get selectedMicLabel() {\n    return this.micLabelForAudioTrack(this.audioTrack);\n  }\n\n  get selectedMicDeviceId() {\n    return MediaDevicesManager.isAudioInputSelectEnabled &&\n      this._permissionsStatus[MediaDevices.MICROPHONE] !== PermissionStatus.GRANTED\n      ? NO_DEVICE_ID\n      : this.deviceIdForMicDeviceLabel(this.selectedMicLabel);\n  }\n\n  get selectedSpeakersDeviceId() {\n    const { preferredSpeakers } = this._store.state.preferences;\n    const exists = this._outputDevices.some(device => {\n      return device.value === preferredSpeakers;\n    });\n    return exists ? preferredSpeakers : this.defaultOutputDeviceId;\n  }\n\n  get isMicShared() {\n    return this.audioTrack !== null && this.getPermissionsStatus(MediaDevices.MICROPHONE) === PermissionStatus.GRANTED;\n  }\n\n  get isVideoShared() {\n    return this._mediaStream?.getVideoTracks().length > 0;\n  }\n\n  get isWebcamShared() {\n    return this._mediaStream.getVideoTracks().some(track => {\n      track[\"_hubs_contentHint\"] === MediaDevices.CAMERA;\n    });\n  }\n\n  get isScreenShared() {\n    return this._mediaStream.getVideoTracks().some(track => {\n      track[\"_hubs_contentHint\"] === MediaDevices.SCREEN;\n    });\n  }\n\n  set micEnabled(enabled) {\n    APP.dialog.enableMicrophone(enabled);\n  }\n\n  get isMicEnabled() {\n    return APP.dialog.isMicEnabled;\n  }\n\n  toggleMic() {\n    APP.dialog.toggleMicrophone();\n  }\n\n  getPermissionsStatus(type) {\n    return this._permissionsStatus[type];\n  }\n\n  onDeviceChange = () => {\n    this.fetchMediaDevices().then(() => {\n      this.changeAudioOutput(this.selectedSpeakersDeviceId);\n      this.emit(MediaDevicesEvents.DEVICE_CHANGE, null);\n    });\n  };\n\n  updatePermissions() {\n    const micStatus = this._micDevices.length === 0 ? PermissionStatus.PROMPT : PermissionStatus.GRANTED;\n    this._permissionsStatus[MediaDevices.MICROPHONE] = micStatus;\n    this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n      mediaDevice: MediaDevices.MICROPHONE,\n      status: micStatus\n    });\n    const videoStatus = this._videoDevices.length === 0 ? PermissionStatus.PROMPT : PermissionStatus.GRANTED;\n    this._permissionsStatus[MediaDevices.CAMERA] = videoStatus;\n    this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n      mediaDevice: MediaDevices.CAMERA,\n      status: videoStatus\n    });\n    const speakersStatus = this._micDevices.length === 0 ? PermissionStatus.PROMPT : PermissionStatus.GRANTED;\n    this._permissionsStatus[MediaDevices.SPEAKERS] = speakersStatus;\n    this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n      mediaDevice: MediaDevices.SPEAKERS,\n      status: speakersStatus\n    });\n  }\n\n  async fetchMediaDevices() {\n    console.log(\"Fetching media devices\");\n    return new Promise(resolve => {\n      navigator.mediaDevices.enumerateDevices().then(mediaDevices => {\n        mediaDevices = mediaDevices.filter(d => d.label !== \"\");\n        this._micDevices = mediaDevices\n          .filter(d => d.deviceId !== \"default\" && d.kind === \"audioinput\")\n          .map(d => ({ value: d.deviceId, label: d.label || `Mic Device (${d.deviceId.substring(0, 9)})` }));\n        this._videoDevices = mediaDevices\n          .filter(d => d.deviceId !== \"default\" && d.kind === \"videoinput\")\n          .map(d => ({ value: d.deviceId, label: d.label || `Camera Device (${d.deviceId.substring(0, 9)})` }));\n        if (MediaDevicesManager.isAudioOutputSelectEnabled) {\n          this._outputDevices = mediaDevices\n            .filter(d => d.deviceId !== \"default\" && d.kind === \"audiooutput\")\n            .map(d => ({ value: d.deviceId, label: d.label || `Audio Output (${d.deviceId.substring(0, 9)})` }));\n        }\n        this.updatePermissions();\n        resolve();\n      });\n    });\n  }\n\n  changeAudioOutput(deviceId) {\n    this._store.update({ preferences: { preferredSpeakers: deviceId } });\n  }\n\n  async startMicShare({ deviceId, unmute, updatePrefs = true }) {\n    if (this.isMicShared && this.selectedMicDeviceId === deviceId) return;\n    console.log(\"Starting microphone sharing\");\n\n    if (!deviceId) {\n      const { preferredMic } = this._store.state.preferences;\n      deviceId = preferredMic !== NO_DEVICE_ID ? preferredMic : undefined;\n    }\n    let constraints = { audio: {} };\n    if (deviceId) {\n      constraints = { audio: { deviceId: { ideal: [deviceId] } } };\n    }\n\n    const result = await this._startMicShare(constraints);\n\n    await this.fetchMediaDevices();\n\n    // we should definitely have an audioTrack at this point unless they denied mic access\n    if (this.audioTrack) {\n      const micDeviceId = this.deviceIdForMicDeviceLabel(this.micLabelForAudioTrack(this.audioTrack));\n      if (micDeviceId) {\n        if (updatePrefs) {\n          this._store.update({\n            preferences: {\n              preferredMic: micDeviceId,\n              preferredSpeakers: this.selectedSpeakersDeviceId\n            }\n          });\n        }\n        console.log(`Selected input device: ${this.micLabelForDeviceId(micDeviceId)}`);\n      }\n    } else {\n      console.log(\"No available audio tracks\");\n    }\n\n    await APP.dialog.setLocalMediaStream(this._mediaStream);\n\n    if (unmute) {\n      APP.dialog.enableMicrophone(true);\n    }\n\n    if (result) {\n      this._permissionsStatus[MediaDevices.MICROPHONE] = PermissionStatus.GRANTED;\n      this._scene.emit(MediaDevicesEvents.MIC_SHARE_STARTED);\n      this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n        mediaDevice: MediaDevices.MICROPHONE,\n        status: PermissionStatus.GRANTED\n      });\n    } else {\n      this._permissionsStatus[MediaDevices.MICROPHONE] = PermissionStatus.DENIED;\n      this._scene.emit(MediaDevicesEvents.MIC_SHARE_ENDED);\n      this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n        mediaDevice: MediaDevices.MICROPHONE,\n        status: PermissionStatus.DENIED\n      });\n    }\n\n    return result;\n  }\n\n  async _startMicShare(constraints = { audio: {} }) {\n    if (this.audioTrack) {\n      this.audioTrack.stop();\n    }\n\n    constraints.audio.echoCancellation = !this._store.state.preferences.disableEchoCancellation;\n    constraints.audio.noiseSuppression = !this._store.state.preferences.disableNoiseSuppression;\n    constraints.audio.autoGainControl = !this._store.state.preferences.disableAutoGainControl;\n\n    try {\n      console.log(\"Adding microphone media stream\");\n      const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n      this.audioSystem.addStreamToOutboundAudio(\"microphone\", newStream);\n      this.audioTrack = newStream.getAudioTracks()[0];\n      this.audioTrack.addEventListener(\"ended\", async () => {\n        this._scene.emit(MediaDevicesEvents.MIC_SHARE_ENDED);\n        this.startMicShare({ unmute: this.isMicEnabled });\n      });\n\n      if (/Oculus/.test(navigator.userAgent)) {\n        // HACK Oculus Browser 6 seems to randomly end the microphone audio stream. This re-creates it.\n        // Note the ended event will only fire if some external event ends the stream, not if we call stop().\n        const recreateAudioStream = async () => {\n          console.warn(\n            \"Oculus Browser 6 bug hit: Audio stream track ended without calling stop. Recreating audio stream.\"\n          );\n\n          const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n          this.audioTrack = newStream.getAudioTracks()[0];\n\n          this.audioSystem.addStreamToOutboundAudio(\"microphone\", newStream);\n\n          this._scene.emit(MediaDevicesEvents.MIC_SHARE_STARTED);\n\n          this.audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n        };\n\n        this.audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n      }\n\n      return true;\n    } catch (e) {\n      // Error fetching audio track, most likely a permission denial.\n      console.error(\"Error during getUserMedia: \", e);\n      this.audioTrack = null;\n      return false;\n    }\n  }\n\n  async stopMicShare() {\n    this.audioSystem.removeStreamFromOutboundAudio(\"microphone\");\n\n    this.audioTrack?.stop();\n    this.audioTrack = null;\n\n    await APP.dialog.setLocalMediaStream(this._mediaStream);\n    APP.dialog.enableMicrophone(false);\n  }\n\n  async startVideoShare({ isDisplayMedia, target, success, error }) {\n    let newStream;\n    let videoTrackAdded = false;\n\n    try {\n      if (isDisplayMedia) {\n        newStream = await navigator.mediaDevices.getDisplayMedia({\n          video: {\n            // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n            // other than your current monitor that has a different aspect ratio.\n            width: 720 * (screen.width / screen.height),\n            height: 720,\n            frameRate: 30\n          },\n          audio: {\n            echoCancellation: window.APP.store.state.preferences.disableEchoCancellation === true ? false : true,\n            noiseSuppression: window.APP.store.state.preferences.disableNoiseSuppression === true ? false : true,\n            autoGainControl: window.APP.store.state.preferences.disableAutoGainControl === true ? false : true\n          }\n        });\n      } else {\n        newStream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: isIOS ? { max: 1280 } : { max: 1280, ideal: 720 },\n            frameRate: 30\n          }\n          //TODO: Capture audio from camera?\n        });\n      }\n\n      const videoTracks = newStream ? newStream.getVideoTracks() : [];\n      if (videoTracks.length > 0) {\n        videoTrackAdded = true;\n\n        newStream.getVideoTracks().forEach(track => {\n          // Ideally we would use track.contentHint but it seems to be read-only in Chrome so we just add a custom property\n          track[\"_hubs_contentHint\"] = isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA;\n          track.addEventListener(\"ended\", async () => {\n            this._scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n          });\n          this._mediaStream.addTrack(track);\n        });\n\n        if (newStream && newStream.getAudioTracks().length > 0) {\n          this.audioSystem.addStreamToOutboundAudio(\"screenshare\", newStream);\n        }\n\n        await APP.dialog.setLocalMediaStream(this._mediaStream);\n\n        const mediaDevice = isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA;\n        this._permissionsStatus[mediaDevice] = PermissionStatus.GRANTED;\n        this._scene.emit(MediaDevicesEvents.VIDEO_SHARE_STARTED);\n        this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, { mediaDevice, status: PermissionStatus.GRANTED });\n      }\n    } catch (e) {\n      error(e);\n      const mediaDevice = isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA;\n      this._permissionsStatus[mediaDevice] = PermissionStatus.DENIED;\n      this._scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, { mediaDevice, status: PermissionStatus.DENIED });\n      return;\n    }\n\n    success(isDisplayMedia, videoTrackAdded, target);\n  }\n\n  async stopVideoShare() {\n    if (!this._mediaStream) return;\n\n    for (const track of this._mediaStream.getVideoTracks()) {\n      track.stop(); // Stop video track to remove the \"Stop screen sharing\" bar right away.\n      this._mediaStream.removeTrack(track);\n    }\n\n    this.audioSystem.removeStreamFromOutboundAudio(\"screenshare\");\n\n    await APP.dialog.setLocalMediaStream(this._mediaStream);\n  }\n\n  async shouldShowHmdMicWarning() {\n    if (isMobile || AFRAME.utils.device.isMobileVR()) return false;\n    if (!this.state.enterInVR) return false;\n    if (!this.hasHmdMicrophone()) return false;\n\n    return !HMD_MIC_REGEXES.find(r => this.selectedMicLabel.match(r));\n  }\n\n  micLabelForAudioTrack(audioTrack) {\n    const label = (audioTrack && audioTrack.label) || \"\";\n    if (label.indexOf(\"Default - \") < 0) {\n      return label;\n    } else {\n      return label.substring(10);\n    }\n  }\n\n  deviceIdForMicDeviceLabel(label) {\n    return this._micDevices.filter(d => d.label === label).map(d => d.value)[0] || this.defaultInputDeviceId;\n  }\n\n  deviceIdForSpeakersDeviceLabel(label) {\n    return this._outputDevices.filter(d => d.label === label).map(d => d.value)[0] || this.defaultOutputDeviceId;\n  }\n\n  micLabelForDeviceId(deviceId) {\n    return this._micDevices.filter(d => d.value === deviceId).map(d => d.label)[0];\n  }\n\n  speakersLabelForDeviceId(deviceId) {\n    return this._outputDevices.filter(d => d.value === deviceId).map(d => d.label)[0];\n  }\n\n  hasHmdMicrophone() {\n    return !!this.state._micDevices.find(d => HMD_MIC_REGEXES.find(r => d.label.match(r)));\n  }\n\n  videoDeviceIdForMicLabel(label) {\n    return this._videoDevices.filter(d => d.label === label).map(d => d.value)[0];\n  }\n\n  videoLabelForDeviceId(deviceId) {\n    return this._videoDevices.filter(d => d.value === deviceId).map(d => d.label)[0];\n  }\n}\n","import React, { memo, useRef, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Slider.scss\";\n\nfunction getLinearGradientCSS(ratio, leftColor, rightColor) {\n  return [\n    \"-webkit-gradient(\",\n    \"linear, \",\n    \"left top, \",\n    \"right top, \",\n    \"color-stop(\" + ratio + \", \" + leftColor + \"), \",\n    \"color-stop(\" + ratio + \", \" + rightColor + \")\",\n    \")\"\n  ].join(\"\");\n}\n\nfunction updateGradient(el, min, max) {\n  if (el) {\n    const ratio = ((parseFloat(el.value) - min) / (max - min)).toFixed(2);\n    el.style.backgroundImage = getLinearGradientCSS(ratio, styles.trackColor, \"transparent\");\n  }\n}\n\nexport const Slider = memo(({ min, max, step, value, onChange, disabled, className, ...rest }) => {\n  const inputRef = useRef();\n\n  useEffect(() => {\n    updateGradient(inputRef.current, min, max);\n  });\n\n  return (\n    <div className={classNames(styles.numberWithRange, className)}>\n      <div className={classNames(styles.rangeSlider)} disabled={disabled}>\n        <input\n          ref={inputRef}\n          type=\"range\"\n          step={step}\n          min={min}\n          max={max}\n          value={value}\n          disabled={disabled}\n          onChange={e => {\n            value === undefined && updateGradient(inputRef.current, min, max);\n            if (onChange) {\n              onChange(parseFloat(e.target.value));\n            }\n          }}\n          {...rest}\n        />\n      </div>\n    </div>\n  );\n});\n\nSlider.propTypes = {\n  min: PropTypes.number,\n  max: PropTypes.number,\n  step: PropTypes.number,\n  value: PropTypes.number,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  className: PropTypes.string\n};\n\nSlider.defaultProps = {\n  min: 0,\n  max: 100,\n  step: 1,\n  disabled: false\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"trackColor\":\"var(--primary-color)\",\"number-with-range\":\"Slider__number-with-range__juQDz\",\"numberWithRange\":\"Slider__number-with-range__juQDz\",\"range-slider\":\"Slider__range-slider__LYMXh\",\"rangeSlider\":\"Slider__range-slider__LYMXh\"};","// What this screen-orientation-utils does are\n// 1. Hide the screen orientation API difference across browsers\n//    ScreenOrientation API should be used but Safari doesn't support it yet.\n//    Instead deprecated window.orientation and orientationchange event\n//    need to be used on Safari for now.\n// 2. Manage maxResolution preferences values based on the screen orientation\n\nimport { isIOS as detectIOS } from \"./is-mobile\";\n\nconst isIOS = detectIOS();\n\nexport const addOrientationChangeListener = (callback, useCapture = false) => {\n  if (typeof ScreenOrientation !== \"undefined\") {\n    screen.orientation.addEventListener(\"change\", callback, useCapture);\n  } else {\n    window.addEventListener(\"orientationchange\", callback, useCapture);\n  }\n};\n\nexport const removeOrientationChangeListener = (callback, useCapture = false) => {\n  if (typeof ScreenOrientation !== \"undefined\") {\n    screen.orientation.removeEventListener(\"change\", callback, useCapture);\n  } else {\n    window.removeEventListener(\"orientationchange\", callback, useCapture);\n  }\n};\n\nconst getAngle = () => {\n  return typeof ScreenOrientation !== \"undefined\" ? screen.orientation.angle : window.orientation;\n};\n\nconst isNaturalOrientation = () => {\n  return getAngle() % 180 === 0;\n};\n\n// Return the screen width in CSS pixels based on the current screen orientation\nconst getScreenWidth = () => {\n  // Is seems screen.width value is based on the natural screen orientation on iOS\n  // while it is based on the current screen orientation on Android (and other devices?).\n  if (isIOS) {\n    return isNaturalOrientation() ? screen.width : screen.height;\n  }\n  return screen.width;\n};\n\n// Return the screen height in CSS pixels based on the current screen orientation\nconst getScreenHeight = () => {\n  // Is seems screen.height value is based on the natural screen orientation on iOS\n  // while it is based on the current screen orientation on Android (and other devices?).\n  if (isIOS) {\n    return isNaturalOrientation() ? screen.height : screen.width;\n  }\n  return screen.height;\n};\n\n// Physical pixels screen resolution width\n// (screen.width * window.devicePixelRatio) seems to be too huge and\n// can cause bad performance impact. So use CSS pixels screen width\n// (screen.width) by default for now.\nconst getDefaultMaxResolutionWidth = () => {\n  return getScreenWidth();\n};\n\n// See the comment above\nconst getDefaultMaxResolutionHeight = () => {\n  return getScreenHeight();\n};\n\n// Return the screen resolution width in physical pixels based on the current screen orientation\nexport const getScreenResolutionWidth = () => {\n  return getScreenWidth() * window.devicePixelRatio;\n};\n\n// Return the screen resolution height in physical pixels based on the current screen orientation\nexport const getScreenResolutionHeight = () => {\n  return getScreenHeight() * window.devicePixelRatio;\n};\n\n// Take width and height based on the current screen orientation and\n// store them based on natural orientation.\n// Width and height paremeters must be in physical pixels.\nexport const setMaxResolution = (store, width, height) => {\n  store.update({\n    preferences: {\n      maxResolutionWidth: isNaturalOrientation() ? width : height,\n      maxResolutionHeight: isNaturalOrientation() ? height : width\n    }\n  });\n};\n\n// Return max resolution width in physical pixels\n// based on the current screen orientation\nexport const getMaxResolutionWidth = store => {\n  const preferences = store.state.preferences;\n  const width = isNaturalOrientation() ? preferences.maxResolutionWidth : preferences.maxResolutionHeight;\n  return width !== undefined ? width : getDefaultMaxResolutionWidth();\n};\n\n// Return max resolution height in physical pixels\n// based on the current screen orientation\nexport const getMaxResolutionHeight = store => {\n  const preferences = store.state.preferences;\n  const height = isNaturalOrientation() ? preferences.maxResolutionHeight : preferences.maxResolutionWidth;\n  return height !== undefined ? height : getDefaultMaxResolutionHeight();\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faUndo } from \"@fortawesome/free-solid-svg-icons/faUndo\";\nimport { faExclamationTriangle } from \"@fortawesome/free-solid-svg-icons/faExclamationTriangle\";\nimport { FormattedMessage, injectIntl, useIntl, defineMessages } from \"react-intl\";\nimport styles from \"../assets/stylesheets/preferences-screen.scss\";\nimport { AVAILABLE_LOCALES } from \"../assets/locales/locale_config\";\nimport { themes } from \"./styles/theme\";\nimport MediaDevicesManager from \"../utils/media-devices-manager\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\nimport { Slider } from \"./input/Slider\";\nimport {\n  addOrientationChangeListener,\n  removeOrientationChangeListener,\n  getMaxResolutionWidth,\n  getMaxResolutionHeight,\n  getScreenResolutionWidth,\n  getScreenResolutionHeight,\n  setMaxResolution\n} from \"../utils/screen-orientation-utils\";\n\nexport const CLIPPING_THRESHOLD_MIN = 0.0;\nexport const CLIPPING_THRESHOLD_MAX = 0.1;\nexport const CLIPPING_THRESHOLD_STEP = 0.001;\nexport const GLOBAL_VOLUME_MIN = 0;\nexport const GLOBAL_VOLUME_MAX = 200;\nexport const GLOBAL_VOLUME_STEP = 5;\n\nfunction WarnIcon() {\n  return (\n    <i className={styles.flex}>\n      <FontAwesomeIcon className={styles.warnIcon} icon={faExclamationTriangle} />\n    </i>\n  );\n}\n\nfunction ResetToDefaultButton({ onClick }) {\n  const intl = useIntl();\n  const title = intl.formatMessage({\n    id: \"preferences-screen.reset-to-default\",\n    defaultMessage: \"Reset preference to default\"\n  });\n\n  return (\n    <button className={styles.noDefaultButtonStyle} title={title} aria-label={title} onClick={onClick}>\n      <i className={styles.flex}>\n        <FontAwesomeIcon className={classNames(styles.resetToDefaultButton)} icon={faUndo} />\n      </i>\n    </button>\n  );\n}\nResetToDefaultButton.propTypes = {\n  onClick: PropTypes.func\n};\nfunction ResetToDefaultButtonPlaceholder() {\n  return <div className={styles.resetToDefaultButtonPlaceholder} />;\n}\n\nfunction sanitize(s) {\n  s = s.replace(/[^0-9.]/g, \"\");\n  const split = s.split(\".\");\n  if (split.length > 1) {\n    return `${split.shift()}.${split.join(\"\")}`;\n  } else {\n    return s;\n  }\n}\nfunction countDigits(s) {\n  const split = s.split(\".\"); // Assume input is sanitized.\n  return (split.length > 1 && split[1].length) || 0;\n}\n\nexport class NumberRangeSelector extends Component {\n  // TODO: Simplify this component.\n  //       This component got a bit complicated when I tried to make sure that the number of digits\n  //       shown to the user was correct in all cases. The cases I have in mind are:\n  //         - User drags slider. Should use step and digits props.\n  //         - User clicks \"reset to default\" button. Should use step and digits props again.\n  //         - User enters text in the text box. Should display however many digits they type. (Maybe it shouldn't?)\n  //       We also take into account the difference between stored value and displayed value. The display string\n  //       may not match the stored value due to rounding-when-presenting or when nothing is stored (and the default value is displayed).\n  static propTypes = {\n    min: PropTypes.number,\n    max: PropTypes.number,\n    step: PropTypes.number,\n    digits: PropTypes.number,\n    store: PropTypes.object,\n    storeKey: PropTypes.string,\n    setValue: PropTypes.func\n  };\n  state = {\n    isFocused: false,\n    displayValue: \"\",\n    digitsFromUser: 0\n  };\n  constructor(props) {\n    super(props);\n    this.storeUpdated = this.storeUpdated.bind(this);\n  }\n\n  storeUpdated() {\n    if (!this.state.isFocused) {\n      const digits = Math.max(this.state.digitsFromUser, this.props.digits);\n      this.setState({ displayValue: this.props.store.state.preferences[this.props.storeKey].toFixed(digits) });\n    }\n    this.forceUpdate();\n  }\n\n  componentDidMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.setState({ displayValue: this.props.store.state.preferences[this.props.storeKey].toFixed(this.props.digits) });\n  }\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n  }\n\n  render() {\n    return (\n      <div className={classNames(styles.numberWithRange)}>\n        <div className={classNames(styles.numberInNumberWithRange)}>\n          <input\n            type=\"text\"\n            value={this.state.displayValue}\n            onClick={e => {\n              e.target.focus();\n              e.target.select();\n            }}\n            onBlur={e => {\n              const sanitizedInput = sanitize(e.target.value);\n              const numberOrReset = isNaN(parseFloat(sanitizedInput)) ? undefined : parseFloat(sanitizedInput);\n              this.setState({\n                displayValue:\n                  numberOrReset === undefined\n                    ? this.props.store.state.preferences[this.props.storeKey].toFixed(this.props.digits)\n                    : Math.min(Math.max(this.props.min, numberOrReset), this.props.max).toFixed(this.props.digits),\n                isFocused: false\n              });\n            }}\n            onFocus={() => {\n              this.setState({ isFocused: true });\n            }}\n            onChange={e => {\n              const sanitizedInput = sanitize(e.target.value);\n              const numberOrReset = isNaN(parseFloat(sanitizedInput)) ? undefined : parseFloat(sanitizedInput);\n              const finalValue = Math.min(Math.max(this.props.min, numberOrReset), this.props.max);\n              this.setState({\n                displayValue: numberOrReset === undefined ? \"\" : finalValue,\n                digitsFromUser: countDigits(sanitizedInput)\n              });\n              this.props.setValue(\n                numberOrReset === undefined\n                  ? parseFloat(this.props.store.state.preferences[this.props.storeKey])\n                  : finalValue\n              );\n            }}\n          />\n        </div>\n        <Slider\n          step={this.props.step}\n          min={this.props.min}\n          max={this.props.max}\n          value={this.props.store.state.preferences[this.props.storeKey]}\n          onChange={value => {\n            const num = value.toFixed(this.props.digits);\n            this.setState({ displayValue: num, digitsFromUser: 0 });\n            this.props.setValue(parseFloat(num));\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nfunction CheckboxPlaceholder() {\n  return <div className={styles.checkboxPlaceholder} />;\n}\nfunction BooleanPreference({ store, storeKey, setValue }) {\n  const value = store.state.preferences[storeKey];\n  return (\n    <input\n      tabIndex=\"0\"\n      type=\"checkbox\"\n      checked={value}\n      onChange={() => {\n        setValue(!value);\n      }}\n    />\n  );\n}\nBooleanPreference.propTypes = {\n  store: PropTypes.object,\n  storeKey: PropTypes.string,\n  setValue: PropTypes.func\n};\n\nfunction MapCountPreference({ store, storeKey, defaultValue, text }) {\n  const storedPref = store.state.preferences[storeKey];\n  const value = storedPref ? Object.keys(storedPref).length : defaultValue;\n  return (\n    <span className={styles.preferenceLabel}>\n      {value} {text}\n    </span>\n  );\n}\nMapCountPreference.propTypes = {\n  store: PropTypes.object,\n  storeKey: PropTypes.string,\n  defaultValue: PropTypes.number,\n  text: PropTypes.string\n};\n\nclass Select extends React.Component {\n  static propTypes = {\n    children: PropTypes.node.isRequired,\n    value: PropTypes.string,\n    onChange: PropTypes.func\n  };\n\n  render() {\n    return (\n      <div className={styles.dropdown}>\n        <select value={this.props.value} tabIndex=\"0\" onChange={this.props.onChange}>\n          {this.props.children}\n        </select>\n        <img\n          className={styles.dropdownArrow}\n          src=\"../assets/images/dropdown_arrow.png\"\n          srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n        />\n      </div>\n    );\n  }\n}\n\nclass PreferenceSelect extends React.Component {\n  static propTypes = {\n    options: PropTypes.array,\n    store: PropTypes.object,\n    storeKey: PropTypes.string,\n    setValue: PropTypes.func,\n    onChanged: PropTypes.func\n  };\n  constructor() {\n    super();\n  }\n  render() {\n    const options = this.props.options.map(({ text, value }, i) => {\n      return (\n        <option key={`option_${this.props.storeKey}_${i}`} value={value}>\n          {text}\n        </option>\n      );\n    });\n    return (\n      <Select\n        value={this.props.store.state.preferences[this.props.storeKey]}\n        onChange={e => {\n          this.props.setValue(e.target.value);\n          this.props.onChanged && this.props.onChanged(e.target.value);\n        }}\n      >\n        {options}\n      </Select>\n    );\n  }\n}\n\nexport const PREFERENCE_LIST_ITEM_TYPE = {\n  CHECK_BOX: 1,\n  SELECT: 2,\n  NUMBER_WITH_RANGE: 3,\n  MAX_RESOLUTION: 4,\n  MAP_COUNT: 5\n};\n\nexport class MaxResolutionPreferenceItem extends Component {\n  static propTypes = {\n    store: PropTypes.object\n  };\n\n  onOrientationChange = () => {\n    // Width and height should be swapped on screen orientation change\n    // then need to update.\n    this.forceUpdate();\n  };\n\n  componentDidMount() {\n    addOrientationChangeListener(this.onOrientationChange);\n  }\n\n  componentWillUnmount() {\n    removeOrientationChangeListener(this.onOrientationChange);\n  }\n\n  render() {\n    const onChange = multiplier => {\n      setMaxResolution(\n        this.props.store,\n        Math.floor(getScreenResolutionWidth() * multiplier),\n        Math.floor(getScreenResolutionHeight() * multiplier)\n      );\n    };\n    return (\n      <div className={classNames(styles.maxResolutionPreferenceItem)}>\n        <input\n          tabIndex=\"0\"\n          type=\"number\"\n          step=\"1\"\n          min=\"0\"\n          value={getMaxResolutionWidth(this.props.store)}\n          readOnly={true}\n        />\n        &nbsp;{\"x\"}&nbsp;\n        <input\n          tabIndex=\"0\"\n          type=\"number\"\n          step=\"1\"\n          min=\"0\"\n          value={getMaxResolutionHeight(this.props.store)}\n          readOnly={true}\n        />\n        &nbsp;\n        <Slider\n          step={0.1}\n          min={0.1}\n          max={1.0}\n          value={getMaxResolutionWidth(this.props.store) / getScreenResolutionWidth()}\n          onChange={onChange}\n        />\n      </div>\n    );\n  }\n}\nfunction ListItem({ children, disabled, indent }) {\n  return <div className={classNames(styles.listItem, { disabled, indent })}>{children}</div>;\n}\nListItem.propTypes = {\n  children: PropTypes.node.isRequired,\n  disabled: PropTypes.bool,\n  indent: PropTypes.bool\n};\n\nconst preferenceLabels = defineMessages({\n  preferredCamera: {\n    id: \"preferences-screen.preference.preferred-camera\",\n    defaultMessage: \"Preferred camera\"\n  },\n  preferredMic: {\n    id: \"preferences-screen.preference.preferred-mic\",\n    defaultMessage: \"Preferred mic\"\n  },\n  preferredSpeakers: {\n    id: \"preferences-screen.preference.preferred-speakers\",\n    defaultMessage: \"Preferred speakers\"\n  },\n  globalVoiceVolume: {\n    id: \"preferences-screen.preference.global-voice-volume\",\n    defaultMessage: \"Incoming Voice Volume\"\n  },\n  globalMediaVolume: {\n    id: \"preferences-screen.preference.global-media-volume\",\n    defaultMessage: \"Media Volume\"\n  },\n  globalSFXVolume: {\n    id: \"preferences-screen.preference.global-sfx-volume\",\n    defaultMessage: \"SFX Volume\"\n  },\n  avatarVoiceLevels: {\n    id: \"preferences-screen.preference.avatar-volumes\",\n    defaultMessage: \"Stored avatar volumes\"\n  },\n  disableSoundEffects: {\n    id: \"preferences-screen.preference.disable-sound-effects\",\n    defaultMessage: \"Disable Sound Effects\"\n  },\n  disableEchoCancellation: {\n    id: \"preferences-screen.preference.disable-echo-cancellation\",\n    defaultMessage: \"Disable microphone echo cancellation\"\n  },\n  disableNoiseSuppression: {\n    id: \"preferences-screen.preference.disable-noise-suppression\",\n    defaultMessage: \"Disable microphone noise supression\"\n  },\n  disableAutoGainControl: {\n    id: \"preferences-screen.preference.disable-auto-gain-control\",\n    defaultMessage: \"Disable microphone automatic gain control\"\n  },\n  snapRotationDegrees: {\n    id: \"preferences-screen.preference.snap-rotation-degrees\",\n    defaultMessage: \"Rotation per snap (in degrees)\"\n  },\n  disableMovement: {\n    id: \"preferences-screen.preference.disable-movement\",\n    defaultMessage: \"Disable movement\"\n  },\n  disableBackwardsMovement: {\n    id: \"preferences-screen.preference.disable-backwards-movement\",\n    defaultMessage: \"Disable backwards movement\"\n  },\n  disableStrafing: {\n    id: \"preferences-screen.preference.disable-strafing\",\n    defaultMessage: \"Disable strafing\"\n  },\n  disableTeleporter: {\n    id: \"preferences-screen.preference.disable-teleporter\",\n    defaultMessage: \"Disable teleporter\"\n  },\n  movementSpeedModifier: {\n    id: \"preferences-screen.preference.movement-speed-modifier\",\n    defaultMessage: \"Movement speed modifier\"\n  },\n  enableOnScreenJoystickLeft: {\n    id: \"preferences-screen.preference.enable-on-screen-joystick-left\",\n    defaultMessage: \"Enable left on-screen joystick for moving around\"\n  },\n  enableOnScreenJoystickRight: {\n    id: \"preferences-screen.preference.enable-on-screen-joystick-right\",\n    defaultMessage: \"Enable right on-screen joystick for looking around\"\n  },\n  enableGyro: {\n    id: \"preferences-screen.preference.enable-gyro\",\n    defaultMessage: \"Enable gyroscope (when supported by browser/device)\"\n  },\n  invertTouchscreenCameraMove: {\n    id: \"preferences-screen.preference.invert-touchscreen-camera-move\",\n    defaultMessage: \"Invert direction of camera movement for touchscreens\"\n  },\n  locale: {\n    id: \"preferences-screen.preference.locale\",\n    defaultMessage: \"Language\"\n  },\n  animateWaypointTransitions: {\n    id: \"preferences-screen.preference.animate-waypoint-transitions\",\n    defaultMessage: \"Animate waypoint transitions\"\n  },\n  showFPSCounter: {\n    id: \"preferences-screen.preference.show-fps-counter\",\n    defaultMessage: \"Show FPS Counter\"\n  },\n  maxResolution: {\n    id: \"preferences-screen.preference.max-resolution\",\n    defaultMessage: \"Max Resolution\"\n  },\n  materialQualitySetting: {\n    id: \"preferences-screen.preference.material-quality-setting\",\n    defaultMessage: \"Material quality\"\n  },\n  enableDynamicShadows: {\n    id: \"preferences-screen.preference.enable-dynamic-shadows\",\n    defaultMessage: \"Enable Real-time Shadows\"\n  },\n  disableAutoPixelRatio: {\n    id: \"preferences-screen.preference.disable-auto-pixel-ratio\",\n    defaultMessage: \"Disable automatic pixel ratio adjustments\"\n  },\n  allowMultipleHubsInstances: {\n    id: \"preferences-screen.preference.allow-multiple-hubs-instances\",\n    defaultMessage: \"Disable auto-exit when multiple hubs instances are open\"\n  },\n  disableIdleDetection: {\n    id: \"preferences-screen.preference.disable-idle-detection\",\n    defaultMessage: \"Disable auto-exit when idle or backgrounded\"\n  },\n  preferMobileObjectInfoPanel: {\n    id: \"preferences-screen.preference.prefer-mobile-object-info-panel\",\n    defaultMessage: \"Prefer Mobile Object Info Panel\"\n  },\n  showRtcDebugPanel: {\n    id: \"preferences-screen.preference.show-rtc-debug-panel\",\n    defaultMessage: \"Show RTC Panel\"\n  },\n  showAudioDebugPanel: {\n    id: \"preferences-screen.preference.show-audio-debug-panel\",\n    defaultMessage: \"Show Audio Debug Panel\"\n  },\n  audioPanningQuality: {\n    id: \"preferences-screen.preference.audio-panning-quality\",\n    defaultMessage: \"Panning quality\"\n  },\n  enableAudioClipping: {\n    id: \"preferences-screen.preference.enable-audio-clipping\",\n    defaultMessage: \"Enable Audio Clipping\"\n  },\n  audioClippingThreshold: {\n    id: \"preferences-screen.preference.audio-clipping-threshold\",\n    defaultMessage: \"Audio Clipping Threshold\"\n  },\n  theme: {\n    id: \"preferences-screen.preference.theme\",\n    defaultMessage: \"Theme\"\n  },\n  fastRoomSwitching: {\n    id: \"preferences-screen.preference.fast-room-switching\",\n    defaultMessage: \"Enable Fast Room Switching\"\n  },\n  lazyLoadSceneMedia: {\n    id: \"preferences-screen.preference.lazy-load-scene-media\",\n    defaultMessage: \"Enable Scene Media Lazy Loading\"\n  },\n  disableLeftRightPanning: {\n    id: \"preferences-screen.preference.disable-panning\",\n    defaultMessage: \"Disable audio left/right panning\"\n  },\n  cursorSize: {\n    id: \"preferences-screen.preference.cursor-size\",\n    defaultMessage: \"Cursor Size\"\n  },\n  nametagVisibility: {\n    id: \"preferences-screen.preference.nametag-visibility\",\n    defaultMessage: \"Show Nametag\"\n  },\n  nametagVisibilityDistance: {\n    id: \"preferences-screen.preference.nametag-visibility-distance\",\n    defaultMessage: \"Nametag visibility distance\"\n  }\n});\n\nclass PreferenceListItem extends Component {\n  static propTypes = {\n    intl: PropTypes.object,\n    store: PropTypes.object,\n    storeKey: PropTypes.string,\n    setValue: PropTypes.func,\n    itemProps: PropTypes.object\n  };\n  componentDidMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    window.addEventListener(\"locale-updated\", this.storeUpdated);\n  }\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    window.removeEventListener(\"locale-updated\", this.storeUpdated);\n  }\n\n  storeUpdated = () => {\n    this.forceUpdate();\n  };\n\n  render() {\n    const intl = this.props.intl;\n    const isCheckbox = this.props.itemProps.prefType === PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX;\n    const isSmallScreen = window.innerWidth < 600;\n    const label = (\n      <span className={styles.preferenceLabel}>{intl.formatMessage(preferenceLabels[this.props.storeKey])}</span>\n    );\n    const prefSchema = this.props.store.schema.definitions.preferences.properties;\n    const hasPref =\n      this.props.itemProps.prefType === PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION\n        ? this.props.store.state.preferences.maxResolutionWidth !== undefined ||\n          this.props.store.state.preferences.maxResolutionHeight !== undefined\n        : this.props.store.state.preferences[this.props.storeKey] !== prefSchema[this.props.storeKey].default;\n    const resetToDefault = hasPref ? (\n      <ResetToDefaultButton\n        onClick={() => {\n          switch (this.props.itemProps.prefType) {\n            case PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION:\n              this.props.store.update({\n                preferences: {\n                  maxResolutionWidth: undefined,\n                  maxResolutionHeight: undefined\n                }\n              });\n              break;\n            default:\n              this.props.setValue(prefSchema[this.props.storeKey].default);\n              break;\n          }\n          this.forceUpdate();\n        }}\n      />\n    ) : (\n      <ResetToDefaultButtonPlaceholder />\n    );\n\n    const disabled =\n      (this.props.itemProps.disableIfTrue && this.props.store.state.preferences[this.props.itemProps.disableIfTrue]) ||\n      (this.props.itemProps.disableIfFalse && !this.props.store.state.preferences[this.props.itemProps.disableIfFalse]);\n    const indent = this.props.itemProps.disableIfTrue || this.props.itemProps.disableIfFalse;\n\n    if (isCheckbox) {\n      return (\n        <ListItem disabled={disabled} indent={indent}>\n          <div className={styles.row}>\n            <Control itemProps={this.props.itemProps} store={this.props.store} setValue={this.props.setValue} />\n            {label}\n            <div className={styles.rowRight}>{resetToDefault}</div>\n          </div>\n        </ListItem>\n      );\n    } else if (isSmallScreen) {\n      return (\n        <ListItem disabled={disabled} indent={indent}>\n          <div className={styles.column}>\n            <div className={styles.row}>\n              {<CheckboxPlaceholder />}\n              {label}\n            </div>\n            <div className={styles.row}>\n              <div className={styles.rowCenter}>\n                <Control itemProps={this.props.itemProps} store={this.props.store} setValue={this.props.setValue} />\n              </div>\n              <div className={styles.rowRight}>{resetToDefault}</div>\n            </div>\n          </div>\n        </ListItem>\n      );\n    }\n    return (\n      <ListItem disabled={disabled} indent={indent}>\n        <div className={styles.row}>\n          {<CheckboxPlaceholder />}\n          {label}\n          <div className={styles.rowRight}>\n            <Control itemProps={this.props.itemProps} store={this.props.store} setValue={this.props.setValue} />\n          </div>\n          <div className={styles.rowRight}>{resetToDefault}</div>\n        </div>\n      </ListItem>\n    );\n  }\n}\n\nconst IntlPreferenceListItem = injectIntl(PreferenceListItem);\n\nconst CATEGORY_AUDIO = 0;\nconst CATEGORY_CONTROLS = 1;\nconst CATEGORY_MISC = 2;\nconst CATEGORY_MOVEMENT = 3;\nconst CATEGORY_TOUCHSCREEN = 4;\nconst CATEGORY_ACCESSIBILITY = 5;\nconst TOP_LEVEL_CATEGORIES = [CATEGORY_AUDIO, CATEGORY_CONTROLS, CATEGORY_MISC];\nconst categoryNames = defineMessages({\n  [CATEGORY_AUDIO]: { id: \"preferences-screen.category.audio\", defaultMessage: \"Audio\" },\n  [CATEGORY_CONTROLS]: { id: \"preferences-screen.category.controls\", defaultMessage: \"Controls\" },\n  [CATEGORY_MISC]: { id: \"preferences-screen.category.misc\", defaultMessage: \"Misc\" },\n  [CATEGORY_MOVEMENT]: { id: \"preferences-screen.category.movement\", defaultMessage: \"Movement\" },\n  [CATEGORY_TOUCHSCREEN]: { id: \"preferences-screen.category.touchscreen\", defaultMessage: \"Touchscreen\" },\n  [CATEGORY_ACCESSIBILITY]: { id: \"preferences-screen.category.accessibility\", defaultMessage: \"Accessibility\" }\n});\n\nfunction NavItem({ ariaLabel, title, onClick, selected }) {\n  return (\n    <button\n      aria-label={ariaLabel}\n      className={classNames(styles.navItem, { [styles.selected]: selected })}\n      onClick={onClick}\n    >\n      {title}\n    </button>\n  );\n}\nNavItem.propTypes = {\n  ariaLabel: PropTypes.string,\n  title: PropTypes.string,\n  onClick: PropTypes.func,\n  selected: PropTypes.bool\n};\nfunction CloseButton({ onClick }) {\n  const intl = useIntl();\n  return (\n    <button\n      autoFocus\n      aria-label={intl.formatMessage({\n        id: \"preferences-screen.close-button\",\n        defaultMessage: \"Close Preferences Menu\"\n      })}\n      className={classNames(styles.closeButton)}\n      onClick={onClick}\n    >\n      <i className={styles.flex}>\n        <FontAwesomeIcon className={styles.icon} icon={faTimes} />\n      </i>\n    </button>\n  );\n}\nCloseButton.propTypes = {\n  onClick: PropTypes.func\n};\n\nconst controlType = new Map([\n  [PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, BooleanPreference],\n  [PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION, MaxResolutionPreferenceItem],\n  [PREFERENCE_LIST_ITEM_TYPE.SELECT, PreferenceSelect],\n  [PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE, NumberRangeSelector],\n  [PREFERENCE_LIST_ITEM_TYPE.MAP_COUNT, MapCountPreference]\n]);\n\nfunction Control({ itemProps, store, setValue }) {\n  const ControlType = controlType.get(itemProps.prefType);\n  return <ControlType {...{ store, storeKey: itemProps.key, setValue, ...itemProps }} />;\n}\nControl.propTypes = {\n  itemProps: PropTypes.object,\n  store: PropTypes.object,\n  setValue: PropTypes.func\n};\n\nfunction createItem(itemProps, store) {\n  const setValue = v => {\n    if (itemProps.promptForRefresh) {\n      store.update({ preferences: { [itemProps.key]: v, shouldPromptForRefresh: true } });\n    } else {\n      store.update({ preferences: { [itemProps.key]: v } });\n    }\n  };\n  return (\n    <IntlPreferenceListItem\n      key={itemProps.key}\n      itemProps={itemProps}\n      store={store}\n      storeKey={itemProps.key}\n      setValue={setValue}\n      onChanged={itemProps.onChanged}\n    />\n  );\n}\n\nfunction Section({ name, items }, i) {\n  return (\n    <div key={`section-${i}`} className={styles.section}>\n      {name && <div className={styles.sectionTitle}>{name}</div>}\n      {items}\n    </div>\n  );\n}\nSection.propTypes = {\n  name: PropTypes.string,\n  items: PropTypes.node.isRequired\n};\n\nclass Nav extends Component {\n  render() {\n    const { children } = this.props;\n    return (\n      <div className={styles.navContainer}>\n        <div className={classNames(styles.nav)}>{children}</div>\n      </div>\n    );\n  }\n}\nNav.propTypes = {\n  children: PropTypes.node.isRequired,\n  selected: PropTypes.number\n};\n\nclass RefreshPrompt extends React.Component {\n  static propTypes = {\n    reportHeight: PropTypes.func\n  };\n  constructor() {\n    super();\n    this.ref = React.createRef();\n  }\n  componentDidMount() {\n    this.props.reportHeight(window.getComputedStyle(this.ref.current).height);\n  }\n\n  render() {\n    return (\n      <div ref={this.ref} className={styles.toast}>\n        <div className={styles.row}>\n          <WarnIcon />\n          <div className={styles.refreshPrompt}>\n            <FormattedMessage\n              id=\"preferences-screen.prompt-for-refresh\"\n              defaultMessage=\"Your preferences are saved, but some of your changes will not take effect until you refresh the page.\"\n            />\n          </div>\n          <div className={styles.warnIconPlaceholder} />\n        </div>\n        <button\n          className={styles.refreshNowButton}\n          onClick={() => {\n            const href = location.href;\n            location.href = href;\n          }}\n        >\n          <FormattedMessage id=\"preferences-screen.refresh-now\" defaultMessage=\"Refresh Now\" />\n        </button>\n      </div>\n    );\n  }\n}\n\nclass PreferencesScreen extends Component {\n  static propTypes = {\n    intl: PropTypes.object,\n    onClose: PropTypes.func,\n    store: PropTypes.object,\n    scene: PropTypes.object\n  };\n\n  constructor() {\n    // TODO: When this component is recreated it clears its state.\n    // This happens several times as the page is loading.\n    // We should either avoid remounting or persist the category somewhere besides state.\n    super();\n\n    this.storeUpdated = this.storeUpdated.bind(this);\n\n    this.mediaDevicesManager = APP.mediaDevicesManager;\n\n    this.state = {\n      category: CATEGORY_AUDIO,\n      toastHeight: \"150px\",\n      preferredMic: {\n        key: \"preferredMic\",\n        prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n        options: [{ value: \"none\", text: \"None\" }]\n      },\n      preferredCamera: {\n        key: \"preferredCamera\",\n        prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n        options: [{ value: \"none\", text: \"None\" }]\n      },\n      ...(MediaDevicesManager.isAudioOutputSelectEnabled && {\n        preferredSpeakers: {\n          key: \"preferredSpeakers\",\n          prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n          options: [{ value: \"none\", text: \"None\" }]\n        }\n      })\n    };\n  }\n\n  onMediaDevicesUpdated = () => {\n    const currentSpeakers = this.mediaDevicesManager.selectedSpeakersDeviceId;\n    if (this.props.store.state.preferences.preferredSpeakers !== currentSpeakers) {\n      this.props.store.update({\n        preferences: { preferredSpeakers: currentSpeakers }\n      });\n    }\n    this.updateMediaDevices();\n  };\n\n  updateMediaDevices = () => {\n    // Audio devices update\n    const micOptions = this.mediaDevicesManager.micDevicesOptions.map(device => ({\n      value: device.value,\n      text: device.label\n    }));\n    const preferredMic = { ...this.state.preferredMic };\n    preferredMic.options = micOptions;\n\n    const speakersOptions = this.mediaDevicesManager.outputDevicesOptions.map(device => ({\n      value: device.value,\n      text: device.label\n    }));\n    const preferredSpeakers = { ...this.state.preferredSpeakers };\n    preferredSpeakers.options = speakersOptions?.length > 0 ? speakersOptions : [{ value: \"none\", text: \"None\" }];\n\n    // Video devices update\n    const videoOptions = this.mediaDevicesManager.videoDevicesOptions.map(device => ({\n      value: device.value,\n      text: device.label\n    }));\n    const preferredCamera = { ...this.state.preferredCamera };\n    preferredCamera.options = [\n      {\n        value: \"user\",\n        text: this.props.intl.formatMessage({\n          id: \"preferences-screen.preferred-camera.user-facing\",\n          defaultMessage: \"User-Facing\"\n        })\n      },\n      {\n        value: \"environment\",\n        text: this.props.intl.formatMessage({\n          id: \"preferences-screen.preferred-camera.environment\",\n          defaultMessage: \"Environment\"\n        })\n      },\n      {\n        value: \"default\",\n        text: this.props.intl.formatMessage({\n          id: \"preferences-screen.preferred-camera.default\",\n          defaultMessage: \"Default\"\n        })\n      }\n    ];\n    preferredCamera.options.push(...videoOptions);\n\n    // Update media devices state\n    this.setState({\n      preferredMic,\n      preferredSpeakers,\n      preferredCamera\n    });\n  };\n\n  componentDidMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.mediaDevicesManager.on(MediaDevicesEvents.DEVICE_CHANGE, this.onMediaDevicesUpdated);\n\n    this.mediaDevicesManager.fetchMediaDevices().then(this.updateMediaDevices);\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.mediaDevicesManager.off(MediaDevicesEvents.DEVICE_CHANGE, this.onMediaDevicesUpdated);\n  }\n\n  storeUpdated() {\n    const { preferredMic } = this.props.store.state.preferences;\n    if (preferredMic !== this.mediaDevicesManager.selectedMicDeviceId) {\n      this.mediaDevicesManager.startMicShare({ updatePrefs: false }).then(this.updateMediaDevices);\n    }\n  }\n\n  createSections() {\n    const intl = this.props.intl;\n\n    const browserDefault = intl.formatMessage({\n      id: \"preferences-screen.browser-default\",\n      defaultMessage: \"Browser Default\"\n    });\n\n    const availableLocales = [\n      {\n        value: \"browser\",\n        text: browserDefault\n      }\n    ];\n\n    for (const locale in AVAILABLE_LOCALES) {\n      availableLocales.push({ value: locale, text: AVAILABLE_LOCALES[locale] });\n    }\n\n    const availableThemes = [\n      {\n        value: null,\n        text: browserDefault\n      }\n    ];\n\n    for (const { id, name } of themes) {\n      availableThemes.push({\n        value: id,\n        text: name\n      });\n    }\n\n    const DEFINITIONS = new Map([\n      [\n        CATEGORY_TOUCHSCREEN,\n        [\n          {\n            key: \"enableOnScreenJoystickLeft\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"enableOnScreenJoystickRight\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"enableGyro\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"invertTouchscreenCameraMove\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          }\n        ]\n      ],\n      [\n        CATEGORY_MOVEMENT,\n        [\n          {\n            key: \"snapRotationDegrees\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 0,\n            max: 90,\n            step: 5,\n            digits: 0\n          },\n          {\n            key: \"disableMovement\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableBackwardsMovement\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableStrafing\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableTeleporter\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"movementSpeedModifier\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 0,\n            max: 2,\n            step: 0.1,\n            digits: 1\n          }\n        ]\n      ],\n      [\n        CATEGORY_AUDIO,\n        [\n          ...(MediaDevicesManager.isAudioInputSelectEnabled ? [this.state.preferredMic] : []),\n          ...(MediaDevicesManager.isAudioOutputSelectEnabled ? [this.state.preferredSpeakers] : []),\n          {\n            key: \"globalVoiceVolume\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: GLOBAL_VOLUME_MIN,\n            max: GLOBAL_VOLUME_MAX,\n            step: GLOBAL_VOLUME_STEP,\n            digits: 0\n          },\n          {\n            key: \"globalMediaVolume\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: GLOBAL_VOLUME_MIN,\n            max: GLOBAL_VOLUME_MAX,\n            step: GLOBAL_VOLUME_STEP,\n            digits: 0\n          },\n          {\n            key: \"globalSFXVolume\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 0,\n            max: 200,\n            step: 5,\n            digits: 0\n          },\n          {\n            key: \"avatarVoiceLevels\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.MAP_COUNT,\n            defaultValue: 0,\n            text: intl.formatMessage({\n              id: \"preferences-screen.preference.avatar-volumes.entries\",\n              defaultMessage: \"Entries\"\n            })\n          },\n          {\n            key: \"disableSoundEffects\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableEchoCancellation\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            promptForRefresh: true\n          },\n          {\n            key: \"disableNoiseSuppression\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            promptForRefresh: true\n          },\n          {\n            key: \"disableAutoGainControl\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            promptForRefresh: true\n          },\n          {\n            key: \"enableAudioClipping\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"audioClippingThreshold\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: CLIPPING_THRESHOLD_MIN,\n            max: CLIPPING_THRESHOLD_MAX,\n            step: CLIPPING_THRESHOLD_STEP,\n            digits: 3\n          },\n          {\n            key: \"showAudioDebugPanel\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"audioPanningQuality\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: [\n              {\n                value: \"High\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.audio-panning-quality.high\",\n                  defaultMessage: \"High\"\n                })\n              },\n              {\n                value: \"Low\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.audio-panning-quality.low\",\n                  defaultMessage: \"Low\"\n                })\n              }\n            ]\n          }\n        ]\n      ],\n      [\n        CATEGORY_MISC,\n        [\n          {\n            key: \"locale\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: availableLocales\n          },\n          {\n            key: \"theme\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: availableThemes\n          },\n          { key: \"maxResolution\", prefType: PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION },\n          {\n            key: \"nametagVisibility\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: [\n              {\n                value: \"showAll\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-all\",\n                  defaultMessage: \"Always\"\n                })\n              },\n              {\n                value: \"showNone\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-none\",\n                  defaultMessage: \"Never\"\n                })\n              },\n              {\n                value: \"showFrozen\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-frozen\",\n                  defaultMessage: \"Only in Frozen state\"\n                })\n              },\n              {\n                value: \"showSpeaking\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-speaking\",\n                  defaultMessage: \"Only speaking\"\n                })\n              },\n              {\n                value: \"showClose\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-close\",\n                  defaultMessage: \"Close to me\"\n                })\n              }\n            ]\n          },\n          {\n            key: \"nametagVisibilityDistance\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 1,\n            max: 20,\n            step: 1,\n            digits: 2\n          },\n          this.state.preferredCamera,\n          {\n            key: \"materialQualitySetting\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: [\n              {\n                value: \"low\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.material-quality-setting.low\",\n                  defaultMessage: \"Low\"\n                })\n              },\n              {\n                value: \"medium\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.material-quality-setting.medium\",\n                  defaultMessage: \"Medium\"\n                })\n              },\n              {\n                value: \"high\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.material-quality-setting.high\",\n                  defaultMessage: \"High\"\n                })\n              }\n            ],\n            promptForRefresh: true\n          },\n          {\n            key: \"enableDynamicShadows\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            defaultBool: false\n          },\n          {\n            key: \"disableAutoPixelRatio\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"allowMultipleHubsInstances\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableIdleDetection\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"fastRoomSwitching\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"lazyLoadSceneMedia\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"preferMobileObjectInfoPanel\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"animateWaypointTransitions\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"showFPSCounter\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"showRtcDebugPanel\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"cursorSize\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 1,\n            max: 5,\n            step: 0.5,\n            digits: 1\n          }\n        ]\n      ],\n      [\n        CATEGORY_ACCESSIBILITY,\n        [\n          {\n            key: \"disableLeftRightPanning\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          }\n        ]\n      ]\n    ]);\n\n    const toItem = itemProps => createItem(itemProps, this.props.store);\n\n    const items = new Map();\n\n    for (const [category, definitions] of DEFINITIONS) {\n      items.set(category, definitions.map(toItem));\n    }\n\n    return new Map([\n      [\n        CATEGORY_AUDIO,\n        [\n          { items: items.get(CATEGORY_AUDIO) },\n          {\n            name: intl.formatMessage(categoryNames[CATEGORY_ACCESSIBILITY]),\n            items: items.get(CATEGORY_ACCESSIBILITY)\n          }\n        ]\n      ],\n      [\n        CATEGORY_CONTROLS,\n        [\n          {\n            name: intl.formatMessage(categoryNames[CATEGORY_MOVEMENT]),\n            items: items.get(CATEGORY_MOVEMENT)\n          },\n          {\n            name: intl.formatMessage(categoryNames[CATEGORY_TOUCHSCREEN]),\n            items: items.get(CATEGORY_TOUCHSCREEN)\n          }\n        ]\n      ],\n      [CATEGORY_MISC, [{ items: items.get(CATEGORY_MISC) }]]\n    ]);\n  }\n\n  render() {\n    const intl = this.props.intl;\n    const shouldPromptForRefresh = this.props.store.state.preferences.shouldPromptForRefresh;\n\n    return (\n      <div className={classNames(styles.preferencesPanel)}>\n        {shouldPromptForRefresh && (\n          <RefreshPrompt\n            reportHeight={toastHeight => {\n              this.setState({ toastHeight });\n            }}\n          />\n        )}\n        <CloseButton onClick={this.props.onClose} />\n        <Nav selected={this.state.category}>\n          {TOP_LEVEL_CATEGORIES.map(category => (\n            <NavItem\n              key={`category-${category}-header`}\n              title={intl.formatMessage(categoryNames[category])}\n              onClick={() => {\n                this.setState({ category });\n              }}\n              ariaLabel={intl.formatMessage(\n                { id: \"preferences-screen.select-category \", defaultMessage: \"Select category {categoryName}\" },\n                {\n                  categoryName: intl.formatMessage(categoryNames[category])\n                }\n              )}\n              selected={category === this.state.category}\n            />\n          ))}\n        </Nav>\n        <div className={styles.contentContainer}>\n          <div className={styles.scrollingContent}>\n            {this.createSections()\n              .get(this.state.category)\n              .map(Section)}\n            {shouldPromptForRefresh && (\n              <div\n                style={{\n                  width: \"100%\",\n                  minHeight: `${this.state.toastHeight}`\n                }}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(PreferencesScreen);\n","var _path, _path2, _path3, _path4, _path5, _path6, _path7;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgWand = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.838 5.213 5.213 7.838l3.052 3.052 2.625-2.625-3.053-3.052Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.774 9.149-2.625 2.625 6.945 6.976 2.656-2.656-6.976-6.945Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.375 6.875H1.25v1.25h3.125v-1.25Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m3.525 2.642-.883.884 2.21 2.21.883-.884-2.21-2.21Z\",\n    fill: \"currentColor\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.125 1.25h-1.25v3.125h1.25V1.25Z\",\n    fill: \"currentColor\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.48 2.643-2.21 2.21.884.883 2.21-2.21-.884-.883Z\",\n    fill: \"currentColor\"\n  })), _path7 || (_path7 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m4.851 9.27-2.21 2.21.884.884 2.21-2.21-.884-.883Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgWand as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"presence-log\":\"presence-log__presence-log__N2qcN\",\"presenceLog\":\"presence-log__presence-log__N2qcN\",\"presence-log-entry\":\"presence-log__presence-log-entry__B1Gmn\",\"presenceLogEntry\":\"presence-log__presence-log-entry__B1Gmn\",\"no-default-button-style\":\"presence-log__no-default-button-style__SFuhd\",\"noDefaultButtonStyle\":\"presence-log__no-default-button-style__SFuhd\",\"message-body\":\"presence-log__message-body__EuHp_\",\"messageBody\":\"presence-log__message-body__EuHp_\",\"message-body-multi\":\"presence-log__message-body-multi__uaZ1g\",\"messageBodyMulti\":\"presence-log__message-body-multi__uaZ1g\",\"message-body-mono\":\"presence-log__message-body-mono__woLab\",\"messageBodyMono\":\"presence-log__message-body-mono__woLab\",\"message-wrap\":\"presence-log__message-wrap__u8cOw\",\"messageWrap\":\"presence-log__message-wrap__u8cOw\",\"message-wrap-multi\":\"presence-log__message-wrap-multi__RPiQs\",\"messageWrapMulti\":\"presence-log__message-wrap-multi__RPiQs\",\"message-source\":\"presence-log__message-source__wGuLz\",\"messageSource\":\"presence-log__message-source__wGuLz\",\"message-source-link\":\"presence-log__message-source-link__Zfm2J\",\"messageSourceLink\":\"presence-log__message-source-link__Zfm2J\",\"icon-button\":\"presence-log__icon-button___bvVv\",\"iconButton\":\"presence-log__icon-button___bvVv\",\"spawn-message\":\"presence-log__spawn-message__UaMSn\",\"spawnMessage\":\"presence-log__spawn-message__UaMSn\",\"share\":\"presence-log__share__gExy1\",\"media\":\"presence-log__media__aJYo6\",\"mediaBody\":\"presence-log__mediaBody__qwTs6\",\"expired\":\"presence-log__expired__bAkfz\",\"presence-log-entry-with-button\":\"presence-log__presence-log-entry-with-button__fVJLP\",\"presenceLogEntryWithButton\":\"presence-log__presence-log-entry-with-button__fVJLP\",\"presence-log-in-room\":\"presence-log__presence-log-in-room__PDH5T\",\"presenceLogInRoom\":\"presence-log__presence-log-in-room__PDH5T\",\"presence-log-spawn\":\"presence-log__presence-log-spawn__DNGWz\",\"presenceLogSpawn\":\"presence-log__presence-log-spawn__DNGWz\",\"presence-log-entry-one-line\":\"presence-log__presence-log-entry-one-line__wy36n\",\"presenceLogEntryOneLine\":\"presence-log__presence-log-entry-one-line__wy36n\",\"presence-log-emoji\":\"presence-log__presence-log-emoji__KfOnt\",\"presenceLogEmoji\":\"presence-log__presence-log-emoji__KfOnt\",\"emoji\":\"presence-log__emoji__i7U3Q\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgChat = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.418 14.844c.046-.171-.057-.409-.155-.58-.03-.052-.063-.101-.099-.149a7.805 7.805 0 0 1-1.289-4.297c-.014-4.385 3.622-7.943 8.118-7.943 3.921 0 7.194 2.717 7.96 6.323.114.534.172 1.08.172 1.626 0 4.391-3.496 8.005-7.992 8.005-.715 0-1.68-.18-2.206-.327a14.835 14.835 0 0 1-1.187-.395 1.215 1.215 0 0 0-.906.014l-2.65.957a.623.623 0 0 1-.182.047.373.373 0 0 1-.374-.38.618.618 0 0 1 .023-.129l.767-2.772Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgChat as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSend = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m18.617 8.871-.007-.003-16.682-6.92a.92.92 0 0 0-.868.085.963.963 0 0 0-.435.804v4.426a.937.937 0 0 0 .762.92l9.1 1.683a.157.157 0 0 1 0 .307l-9.1 1.682a.937.937 0 0 0-.762.92v4.426a.921.921 0 0 0 .414.77.936.936 0 0 0 .888.08l16.682-6.88.008-.003a1.25 1.25 0 0 0 0-2.297Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgSend as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgReaction = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.188 10a.937.937 0 1 0 0-1.875.937.937 0 0 0 0 1.875Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.002 15.001c-1.774 0-3.266-1.153-3.739-2.728a.312.312 0 0 1 .306-.397h6.863a.314.314 0 0 1 .311.254.311.311 0 0 1-.006.143c-.468 1.575-1.96 2.728-3.735 2.728Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.813 10a.937.937 0 1 0 0-1.875.937.937 0 0 0 0 1.875Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.125a8.125 8.125 0 1 0 0-16.25 8.125 8.125 0 0 0 0 16.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgReaction as ReactComponent };","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport TextareaAutosize from \"react-textarea-autosize\";\nimport { TextInput } from \"./TextInput\";\nimport styles from \"./TextAreaInput.scss\";\n\nexport const TextAreaInput = forwardRef(({ className, ...rest }, ref) => (\n  <TextInput className={classNames(styles.textarea, className)} {...rest} as={TextareaAutosize} ref={ref} />\n));\n\nTextAreaInput.propTypes = {\n  className: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"textarea\":\"TextAreaInput__textarea__y2MAr\"};","// extracted by mini-css-extract-plugin\nexport default {\"toolbar-button\":\"ToolbarButton__toolbar-button__KIJB6\",\"toolbarButton\":\"ToolbarButton__toolbar-button__KIJB6\",\"icon-container\":\"ToolbarButton__icon-container__ZEf9E\",\"iconContainer\":\"ToolbarButton__icon-container__ZEf9E\",\"large\":\"ToolbarButton__large__YDjpA\",\"basic\":\"ToolbarButton__basic__PsM2Y\",\"transparent\":\"ToolbarButton__transparent___w9hR\",\"selected\":\"ToolbarButton__selected__SxJqz\",\"primary\":\"ToolbarButton__primary__J7WCr\",\"accept\":\"ToolbarButton__accept__Hfn1R\",\"cancel\":\"ToolbarButton__cancel__qYLZw\",\"accent1\":\"ToolbarButton__accent1__dcxpI\",\"accent2\":\"ToolbarButton__accent2__OuGAI\",\"accent3\":\"ToolbarButton__accent3__JwDT5\",\"accent4\":\"ToolbarButton__accent4__BXXtS\",\"accent5\":\"ToolbarButton__accent5__bvBvH\",\"status-indicator\":\"ToolbarButton__status-indicator__Zgtiz\",\"statusIndicator\":\"ToolbarButton__status-indicator__Zgtiz\",\"status-enabled\":\"ToolbarButton__status-enabled__cSFwX\",\"statusEnabled\":\"ToolbarButton__status-enabled__cSFwX\",\"status-disabled\":\"ToolbarButton__status-disabled__djo6Z\",\"statusDisabled\":\"ToolbarButton__status-disabled__djo6Z\",\"status-unread\":\"ToolbarButton__status-unread__HdEKL\",\"statusUnread\":\"ToolbarButton__status-unread__HdEKL\",\"status-recording\":\"ToolbarButton__status-recording__JMGuh\",\"statusRecording\":\"ToolbarButton__status-recording__JMGuh\",\"left\":\"ToolbarButton__left__xOpwY\",\"middle\":\"ToolbarButton__middle__h7pkJ\",\"right\":\"ToolbarButton__right__e8lxT\"};","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ToolbarButton.scss\";\n\nexport const presets = [\n  \"basic\",\n  \"transparent\",\n  \"accept\",\n  \"cancel\",\n  \"accent1\",\n  \"accent2\",\n  \"accent3\",\n  \"accent4\",\n  \"accent5\"\n];\n\nexport const types = [\"none\", \"left\", \"middle\", \"right\"];\n\nexport const statusColors = [\"recording\", \"unread\", \"enabled\", \"disabled\"];\n\nexport const ToolbarButton = forwardRef(\n  (\n    { preset, className, iconContainerClassName, children, icon, label, selected, large, statusColor, type, ...rest },\n    ref\n  ) => {\n    return (\n      <button\n        ref={ref}\n        className={classNames(\n          styles.toolbarButton,\n          styles[preset],\n          styles[type],\n          { [styles.selected]: selected, [styles.large]: large },\n          className\n        )}\n        {...rest}\n      >\n        <div className={classNames(styles.iconContainer, iconContainerClassName)} aria-hidden=\"true\">\n          {icon}\n          {statusColor && <div className={classNames(styles.statusIndicator, styles[\"status-\" + statusColor])} />}\n          {children}\n        </div>\n        {label && <label>{label}</label>}\n      </button>\n    );\n  }\n);\n\nToolbarButton.propTypes = {\n  icon: PropTypes.node,\n  label: PropTypes.node,\n  selected: PropTypes.bool,\n  preset: PropTypes.oneOf(presets),\n  statusColor: PropTypes.oneOf(statusColors),\n  large: PropTypes.bool,\n  className: PropTypes.string,\n  iconContainerClassName: PropTypes.string,\n  children: PropTypes.node,\n  type: PropTypes.oneOf(types)\n};\n\nToolbarButton.defaultProps = {\n  preset: \"basic\"\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"popover\":\"Popover__popover__TDiHP\",\"content\":\"Popover__content__yKFMS\",\"arrow\":\"Popover__arrow__adu2d\",\"header\":\"Popover__header__GLZCv\",\"arrow-bg\":\"Popover__arrow-bg__J95GS\",\"arrowBg\":\"Popover__arrow-bg__J95GS\",\"arrow-border\":\"Popover__arrow-border__CRbKU\",\"arrowBorder\":\"Popover__arrow-border__CRbKU\",\"fullscreen\":\"Popover__fullscreen__pXsPm\",\"fullscreen-body\":\"Popover__fullscreen-body__Lu_fI\",\"fullscreenBody\":\"Popover__fullscreen-body__Lu_fI\"};","import React, { useState, useCallback, useEffect } from \"react\";\n// Note react-popper-2 is just an alias to react-popper@2.2.3 because storybook is depending on an old version.\n// https://github.com/storybookjs/storybook/issues/10982\nimport { usePopper } from \"react-popper-2\";\nimport styles from \"./Popover.scss\";\nimport { createPortal } from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport { useCssBreakpoints } from \"react-use-css-breakpoints\";\nimport classNames from \"classnames\";\nimport { CloseButton } from \"../input/CloseButton\";\n\nfunction PopoverArrow({ arrowClass }) {\n  return (\n    <svg width=\"25\" height=\"11\" viewBox=\"0 0 25 11\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        d=\"M1 1L11.1176 9.51209C11.8908 10.1626 13.1092 10.1626 13.8824 9.51209L24 1\"\n        strokeWidth=\"2\"\n        className={classNames(styles.arrowBg, arrowClass)}\n      />\n      <path\n        d=\"M11.1176 9.51209L1 1H24L13.8824 9.51209C13.1092 10.1626 11.8908 10.1626 11.1176 9.51209Z\"\n        className={classNames(styles.arrowBorder, arrowClass)}\n      />\n      <path d=\"M0 1H25\" strokeWidth=\"2\" className={classNames(styles.arrowBg, arrowClass)} />\n    </svg>\n  );\n}\n\nPopoverArrow.propTypes = {\n  arrowClass: PropTypes.string\n};\n\nexport function Popover({\n  content: Content,\n  children,\n  title,\n  showHeader,\n  placement,\n  offsetSkidding,\n  offsetDistance,\n  initiallyVisible,\n  disableFullscreen,\n  isVisible,\n  onChangeVisible,\n  popoverApiRef,\n  popoverClass,\n  arrowClass\n}) {\n  const [_visible, _setVisible] = useState(initiallyVisible);\n  const visible = isVisible === undefined ? _visible : isVisible;\n  const setVisible = onChangeVisible || _setVisible;\n  const [referenceElement, setReferenceElement] = useState(null);\n  const [popperElement, setPopperElement] = useState(null);\n  const [arrowElement, setArrowElement] = useState(null);\n  const {\n    styles: { popper: popperStyles, arrow: arrowStyles },\n    attributes\n  } = usePopper(referenceElement, popperElement, {\n    placement,\n    modifiers: [\n      { name: \"arrow\", options: { element: arrowElement } }, // https://popper.js.org/docs/v2/modifiers/arrow/\n      { name: \"offset\", options: { offset: [offsetSkidding, offsetDistance] } } // https://popper.js.org/docs/v2/modifiers/offset/\n    ]\n  });\n  const breakpoint = useCssBreakpoints();\n  const fullscreen = !disableFullscreen && (breakpoint === \"sm\" || breakpoint === \"md\");\n  const openPopover = useCallback(() => setVisible(true), [setVisible]);\n  const closePopover = useCallback(() => setVisible(false), [setVisible]);\n  const togglePopover = useCallback(() => setVisible(visible => !visible), [setVisible]);\n\n  useEffect(\n    () => {\n      if (!popoverApiRef) {\n        return;\n      }\n\n      popoverApiRef.current = {\n        openPopover,\n        closePopover,\n        togglePopover\n      };\n    },\n    [popoverApiRef, openPopover, closePopover, togglePopover]\n  );\n\n  useEffect(\n    () => {\n      const onClick = e => {\n        if (\n          (referenceElement && referenceElement.contains(e.target)) ||\n          (popperElement && popperElement.contains(e.target))\n        ) {\n          return;\n        }\n\n        setVisible(false);\n      };\n\n      const onKeyDown = e => {\n        if (e.key === \"Escape\") {\n          setVisible(false);\n        }\n      };\n\n      if (visible) {\n        window.addEventListener(\"mousedown\", onClick);\n        window.addEventListener(\"keydown\", onKeyDown);\n      }\n\n      return () => {\n        window.removeEventListener(\"mousedown\", onClick);\n        window.removeEventListener(\"keydown\", onKeyDown);\n      };\n    },\n    [visible, popperElement, referenceElement, setVisible]\n  );\n\n  useEffect(\n    () => {\n      if (visible && fullscreen) {\n        document.body.classList.add(styles.fullscreenBody);\n      } else {\n        document.body.classList.remove(styles.fullscreenBody);\n      }\n\n      return () => {\n        document.body.classList.remove(styles.fullscreenBody);\n      };\n    },\n    [fullscreen, visible]\n  );\n\n  return (\n    <>\n      {children({\n        togglePopover,\n        openPopover,\n        closePopover,\n        popoverVisible: visible,\n        triggerRef: setReferenceElement\n      })}\n      {visible &&\n        createPortal(\n          <div\n            ref={setPopperElement}\n            className={classNames(styles.popover, { [styles.fullscreen]: fullscreen }, popoverClass)}\n            style={fullscreen ? undefined : popperStyles}\n            {...attributes.popper}\n          >\n            {showHeader && (\n              <div className={styles.header}>\n                <CloseButton onClick={closePopover} />\n                <h5>{title}</h5>\n              </div>\n            )}\n            <div className={styles.content}>\n              {typeof Content === \"function\" ? (\n                <Content fullscreen={fullscreen} closePopover={closePopover} />\n              ) : (\n                Content\n              )}\n            </div>\n            {!fullscreen && (\n              <div ref={setArrowElement} className={styles.arrow} style={arrowStyles}>\n                <PopoverArrow arrowClass={arrowClass} />\n              </div>\n            )}\n          </div>,\n          document.body\n        )}\n    </>\n  );\n}\n\nPopover.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  placement: PropTypes.string,\n  title: PropTypes.node.isRequired,\n  children: PropTypes.func.isRequired,\n  content: PropTypes.oneOfType([PropTypes.func, PropTypes.node]),\n  disableFullscreen: PropTypes.bool,\n  popoverApiRef: PropTypes.object,\n  popoverClass: PropTypes.string\n};\n\nPopover.defaultProps = {\n  initiallyVisible: false,\n  placement: \"auto\",\n  offsetSkidding: 0,\n  offsetDistance: 8,\n  showHeader: true\n};\n","import React from \"react\";\nimport { Picker } from \"emoji-mart\";\n// Twitter emoji sheets downloaded from unpkg.com provided by https://github.com/missive/emoji-mart\nimport emojiIcons16 from \"../../assets/images/emoji-picker-16.png\";\nimport emojiIcons20 from \"../../assets/images/emoji-picker-20.png\";\nimport emojiIcons32 from \"../../assets/images/emoji-picker-32.png\";\nimport emojiIcons64 from \"../../assets/images/emoji-picker-64.png\";\n\nimport \"./EmojiPicker.scss\";\n\nconst iconSheet = {\n  16: emojiIcons16,\n  20: emojiIcons20,\n  32: emojiIcons32,\n  64: emojiIcons64\n};\n\nexport function EmojiPicker(props) {\n  return (\n    <Picker\n      title=\"Pick an emoji!\"\n      color=\"var(--tab-highlight-color)\"\n      // eslint-disable-next-line no-unused-vars\n      backgroundImageFn={(set, sheetSize) => iconSheet[sheetSize]}\n      {...props}\n    />\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"chat-input-container\":\"ChatSidebar__chat-input-container__qF2Zv\",\"chatInputContainer\":\"ChatSidebar__chat-input-container__qF2Zv\",\"message-list\":\"ChatSidebar__message-list__Q_K_C\",\"messageList\":\"ChatSidebar__message-list__Q_K_C\",\"message-group\":\"ChatSidebar__message-group__wD2L8\",\"messageGroup\":\"ChatSidebar__message-group__wD2L8\",\"message-group-label\":\"ChatSidebar__message-group-label__gTBLt\",\"messageGroupLabel\":\"ChatSidebar__message-group-label__gTBLt\",\"message-group-messages\":\"ChatSidebar__message-group-messages__MOpe3\",\"messageGroupMessages\":\"ChatSidebar__message-group-messages__MOpe3\",\"message-bubble\":\"ChatSidebar__message-bubble__sAPXL\",\"messageBubble\":\"ChatSidebar__message-bubble__sAPXL\",\"sent\":\"ChatSidebar__sent__jodlK\",\"emoji\":\"ChatSidebar__emoji__kotP2\",\"media\":\"ChatSidebar__media__wLlyB\",\"monospace\":\"ChatSidebar__monospace__yFz0r\",\"system-message\":\"ChatSidebar__system-message__ujKWH\",\"systemMessage\":\"ChatSidebar__system-message__ujKWH\",\"chat-input-icon\":\"ChatSidebar__chat-input-icon__sTSAw\",\"chatInputIcon\":\"ChatSidebar__chat-input-icon__sTSAw\",\"chat-input-warning\":\"ChatSidebar__chat-input-warning__OzrS4\",\"chatInputWarning\":\"ChatSidebar__chat-input-warning__OzrS4\",\"warning-border\":\"ChatSidebar__warning-border__KeF28\",\"warningBorder\":\"ChatSidebar__warning-border__KeF28\",\"warning-text-color\":\"ChatSidebar__warning-text-color__wNwfr\",\"warningTextColor\":\"ChatSidebar__warning-text-color__wNwfr\",\"chat-input-text-area-styles\":\"ChatSidebar__chat-input-text-area-styles__oPn7w\",\"chatInputTextAreaStyles\":\"ChatSidebar__chat-input-text-area-styles__oPn7w\"};","import React from \"react\";\nimport Linkify from \"react-linkify\";\nimport { toArray as toEmojis } from \"react-emoji-render\";\n\nconst emojiRegex = /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|[\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|[\\ud83c[\\ude32-\\ude3a]|[\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/;\n\nexport const MAX_MESSAGE_LENGTH = 750;\n\nexport function formatMessageBody(body, { emojiClassName } = {}) {\n  // Support wrapping text in ` to get monospace, and multiline.\n  const bodyLength = body.length >= MAX_MESSAGE_LENGTH ? MAX_MESSAGE_LENGTH : body.length;\n  const monospace = body.startsWith(\"`\") && body.endsWith(\"`\");\n  const cleanedBody = (monospace ? body.substring(1, bodyLength - 1) : body.substring(0, bodyLength)).trim();\n\n  const messages = cleanedBody.split(\"\\n\").map((message, i) => (\n    <p key={i}>\n      <Linkify properties={{ target: \"_blank\", rel: \"noopener referrer\" }}>\n        {toEmojis(message, { className: emojiClassName })}\n      </Linkify>\n    </p>\n  ));\n\n  const multiline = messages.length > 1;\n\n  let emoji = false;\n\n  if (messages.length === 1) {\n    const emojiComponents = toEmojis(cleanedBody);\n\n    emoji =\n      emojiComponents.length === 1 &&\n      emojiComponents[0].props &&\n      emojiComponents[0].props.children.match &&\n      emojiComponents[0].props.children.match(emojiRegex);\n  }\n\n  return {\n    formattedBody: <>{messages}</>,\n    multiline,\n    monospace,\n    emoji\n  };\n}\n","import React, { useEffect, useRef, forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { ReactComponent as WandIcon } from \"../icons/Wand.svg\";\nimport { ReactComponent as AttachIcon } from \"../icons/Attach.svg\";\nimport { ReactComponent as ChatIcon } from \"../icons/Chat.svg\";\nimport { ReactComponent as SendIcon } from \"../icons/Send.svg\";\nimport { ReactComponent as ReactionIcon } from \"../icons/Reaction.svg\";\nimport { IconButton } from \"../input/IconButton\";\nimport { TextAreaInput } from \"../input/TextAreaInput\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { Popover } from \"../popover/Popover\";\nimport { EmojiPicker } from \"./EmojiPicker\";\nimport styles from \"./ChatSidebar.scss\";\nimport { formatMessageBody } from \"../../utils/chat-message\";\nimport { FormattedMessage, useIntl, defineMessages, FormattedRelativeTime } from \"react-intl\";\n\nexport function SpawnMessageButton(props) {\n  return (\n    <IconButton className={styles.chatInputIcon} {...props}>\n      <WandIcon />\n    </IconButton>\n  );\n}\n\nexport function SendMessageButton(props) {\n  return (\n    <IconButton className={styles.chatInputIcon} {...props}>\n      <SendIcon />\n    </IconButton>\n  );\n}\n\n// Memoize EmojiPickerPopoverButton since we don't want it re-rendering\n// the EmojiPicker unnecessarily.\nexport const EmojiPickerPopoverButton = React.memo(({ onSelectEmoji }) => {\n  // We're using a ref here, since we don't want to re-render anything, but we\n  // do want to know if the Shift key is down when an emoji is selected.\n  const shiftKeyDown = useRef(false);\n\n  useEffect(() => {\n    const onKeyDown = e => {\n      if (e.key === \"Shift\") shiftKeyDown.current = true;\n    };\n    const onKeyUp = e => {\n      if (e.key === \"Shift\") shiftKeyDown.current = false;\n    };\n\n    window.addEventListener(\"keydown\", onKeyDown);\n    window.addEventListener(\"keyup\", onKeyUp);\n\n    return () => {\n      window.removeEventListener(\"keydown\", onKeyDown);\n      window.removeEventListener(\"keyup\", onKeyUp);\n    };\n  }, []);\n\n  return (\n    <Popover\n      title=\"\"\n      content={({ closePopover }) => (\n        <EmojiPicker\n          onSelect={emoji => {\n            const keepPickerOpen = shiftKeyDown.current;\n            onSelectEmoji({ emoji, pickerRemainedOpen: keepPickerOpen });\n            // Keep the picker open if the Shift key was held down to allow\n            // for multiple emoji selections.\n            if (!keepPickerOpen) closePopover();\n          }}\n        />\n      )}\n      placement=\"top\"\n      offsetDistance={28}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <IconButton ref={triggerRef} className={styles.chatInputIcon} selected={popoverVisible} onClick={togglePopover}>\n          <ReactionIcon />\n        </IconButton>\n      )}\n    </Popover>\n  );\n});\n\nEmojiPickerPopoverButton.propTypes = {\n  onSelectEmoji: PropTypes.func.isRequired\n};\n\nexport function MessageAttachmentButton(props) {\n  return (\n    <>\n      <IconButton as=\"label\" className={styles.chatInputIcon}>\n        <AttachIcon />\n        <input type=\"file\" {...props} />\n      </IconButton>\n    </>\n  );\n}\n\nexport function ChatLengthWarning({ messageLength, maxLength }) {\n  return (\n    <p\n      className={classNames(styles.chatInputWarning, {\n        [styles.warningTextColor]: messageLength > maxLength\n      })}\n    >\n      <FormattedMessage id=\"chat-message-input.warning-max-characters\" defaultMessage=\"Max characters\" />\n      {` (${messageLength}/${maxLength})`}\n    </p>\n  );\n}\n\nChatLengthWarning.propTypes = {\n  messageLength: PropTypes.number,\n  maxLength: PropTypes.number\n};\n\nexport const ChatInput = forwardRef(({ warning, isOverMaxLength, ...props }, ref) => {\n  const intl = useIntl();\n\n  return (\n    <div className={styles.chatInputContainer}>\n      <TextAreaInput\n        ref={ref}\n        textInputStyles={styles.chatInputTextAreaStyles}\n        className={classNames({ [styles.warningBorder]: isOverMaxLength })}\n        placeholder={intl.formatMessage({ id: \"chat-sidebar.input.placeholder\", defaultMessage: \"Message...\" })}\n        {...props}\n      />\n      {warning}\n    </div>\n  );\n});\n\nChatInput.propTypes = {\n  onSpawn: PropTypes.func,\n  warning: PropTypes.node,\n  isOverMaxLength: PropTypes.bool\n};\n\nconst enteredMessages = defineMessages({\n  room: { id: \"chat-sidebar.system-message.entered-room\", defaultMessage: \"{name} entered the room.\" },\n  lobby: { id: \"chat-sidebar.system-message.entered-lobby\", defaultMessage: \"{name} entered the lobby.\" }\n});\n\nconst joinedMessages = defineMessages({\n  lobby: { id: \"chat-sidebar.system-message.joined-lobby\", defaultMessage: \"{name} joined the lobby.\" },\n  room: { id: \"chat-sidebar.system-message.joined-room\", defaultMessage: \"{name} joined the room.\" }\n});\n\nexport const LogMessageType = {\n  roomEntryRequired: \"roomEntryRequired\",\n  flyModeDisabled: \"flyModeDisabled\",\n  flyModeEnabled: \"flyModeEnabled\",\n  unauthorizedSceneChange: \"unauthorizedSceneChange\",\n  invalidSceneUrl: \"invalidSceneUrl\",\n  unauthorizedRoomRename: \"unauthorizedRoomRename\",\n  captureUnavailable: \"captureUnavailable\",\n  captureStopped: \"captureStopped\",\n  captureStarted: \"captureStarted\",\n  captureAlreadyStopped: \"captureAlreadyStopped\",\n  captureAlreadyRunning: \"captureAlreadyRunning\",\n  positionalAudioEnabled: \"positionalAudioEnabled\",\n  positionalAudioDisabled: \"positionalAudioDisabled\",\n  setAudioNormalizationFactor: \"setAudioNormalizationFactor\",\n  audioNormalizationDisabled: \"audioNormalizationDisabled\",\n  audioNormalizationNaN: \"audioNormalizationNaN\",\n  invalidAudioNormalizationRange: \"invalidAudioNormalizationRange\",\n  audioSuspended: \"audioSuspended\",\n  audioResumed: \"audioResumed\",\n  joinFailed: \"joinFailed\",\n  avatarChanged: \"avatarChanged\"\n};\n\nconst logMessages = defineMessages({\n  [LogMessageType.roomEntryRequired]: {\n    id: \"chat-sidebar.log-message.room-entry-required\",\n    defaultMessage: \"You must enter the room to use this command.\"\n  },\n  [LogMessageType.flyModeDisabled]: {\n    id: \"chat-sidebar.log-message.fly-mode-disabled\",\n    defaultMessage: \"Fly mode disabled.\"\n  },\n  [LogMessageType.flyModeEnabled]: {\n    id: \"chat-sidebar.log-message.fly-mode-enabled\",\n    defaultMessage: \"Fly mode enabled.\"\n  },\n  [LogMessageType.unauthorizedSceneChange]: {\n    id: \"chat-sidebar.log-message.unauthorized-scene-change\",\n    defaultMessage: \"You do not have permission to change the scene.\"\n  },\n  [LogMessageType.invalidSceneUrl]: {\n    id: \"chat-sidebar.log-message.invalid-scene-url\",\n    defaultMessage: \"This URL does not point to a scene or valid GLB.\"\n  },\n  [LogMessageType.unauthorizedRoomRename]: {\n    id: \"chat-sidebar.log-message.unauthorized-room-rename\",\n    defaultMessage: \"You do not have permission to rename this room.\"\n  },\n  [LogMessageType.captureUnavailable]: {\n    id: \"chat-sidebar.log-message.capture-unavailable\",\n    defaultMessage: \"Capture unavailable.\"\n  },\n  [LogMessageType.captureStopped]: {\n    id: \"chat-sidebar.log-message.capture-stopped\",\n    defaultMessage: \"Capture stopped.\"\n  },\n  [LogMessageType.captureStarted]: {\n    id: \"chat-sidebar.log-message.capture-started\",\n    defaultMessage: \"Capture started.\"\n  },\n  [LogMessageType.captureAlreadyStopped]: {\n    id: \"chat-sidebar.log-message.capture-already-stopped\",\n    defaultMessage: \"Capture already stopped.\"\n  },\n  [LogMessageType.captureAlreadyRunning]: {\n    id: \"chat-sidebar.log-message.capture-already-running\",\n    defaultMessage: \"Capture already running.\"\n  },\n  [LogMessageType.positionalAudioEnabled]: {\n    id: \"chat-sidebar.log-message.positional-audio-enabled\",\n    defaultMessage: \"Positional audio enabled.\"\n  },\n  [LogMessageType.positionalAudioDisabled]: {\n    id: \"chat-sidebar.log-message.positional-audio-disabled\",\n    defaultMessage: \"Positional audio disabled.\"\n  },\n  [LogMessageType.setAudioNormalizationFactor]: {\n    id: \"chat-sidebar.log-message.set-audio-normalization-factor\",\n    defaultMessage: \"audioNormalization factor is set to {factor}.\"\n  },\n  [LogMessageType.audioNormalizationDisabled]: {\n    id: \"chat-sidebar.log-message.audio-normalization-disabled\",\n    defaultMessage: \"audioNormalization is disabled.\"\n  },\n  [LogMessageType.audioNormalizationNaN]: {\n    id: \"chat-sidebar.log-message.audio-normalization-nan\",\n    defaultMessage: \"audioNormalization command needs a valid number parameter.\"\n  },\n  [LogMessageType.invalidAudioNormalizationRange]: {\n    id: \"chat-sidebar.log-message.invalid-audio-normalization-range\",\n    defaultMessage:\n      \"audioNormalization command needs a base volume number between 0 [no normalization] and 255. Default is 0. The recommended value is 4, if you would like to enable normalization.\"\n  },\n  [LogMessageType.audioSuspended]: {\n    id: \"chat-sidebar.log-message.audio-suspended\",\n    defaultMessage: \"Audio has been suspended, click somewhere in the room to resume the audio.\"\n  },\n  [LogMessageType.audioResumed]: {\n    id: \"chat-sidebar.log-message.audio-resumed\",\n    defaultMessage: \"Audio has been resumed.\"\n  },\n  [LogMessageType.joinFailed]: {\n    id: \"chat-sidebar.log-message.join-failed\",\n    defaultMessage: \"Failed to join room: {message}\"\n  },\n  [LogMessageType.avatarChanged]: {\n    id: \"chat-sidebar.log-message.avatar-changed\",\n    defaultMessage: \"Your avatar has been changed.\"\n  }\n});\n\n// TODO: use react-intl's defineMessages to get proper extraction\nexport function formatSystemMessage(entry, intl) {\n  switch (entry.type) {\n    case \"join\":\n      return intl.formatMessage(joinedMessages[entry.presence], { name: <b>{entry.name}</b> });\n    case \"entered\":\n      return intl.formatMessage(enteredMessages[entry.presence], { name: <b>{entry.name}</b> });\n    case \"leave\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.leave\"\n          defaultMessage=\"{name} left.\"\n          values={{ name: <b>{entry.name}</b> }}\n        />\n      );\n    case \"display_name_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.name-change\"\n          defaultMessage=\"{oldName} is now known as {newName}\"\n          values={{ oldName: <b>{entry.oldName}</b>, newName: <b>{entry.newName}</b> }}\n        />\n      );\n    case \"scene_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.scene-change\"\n          defaultMessage=\"{name} changed the scene to {sceneName}\"\n          values={{ name: <b>{entry.name}</b>, sceneName: <b>{entry.sceneName}</b> }}\n        />\n      );\n    case \"hub_name_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.hub-name-change\"\n          defaultMessage=\"{name} changed the name of the room to {hubName}\"\n          values={{ name: <b>{entry.name}</b>, hubName: <b>{entry.hubName}</b> }}\n        />\n      );\n    case \"hub_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.hub-change\"\n          defaultMessage=\"You are now in {hubName}\"\n          values={{ hubName: <b>{entry.hubName}</b> }}\n        />\n      );\n    case \"log\":\n      return intl.formatMessage(logMessages[entry.messageType], entry.props);\n    default:\n      return null;\n  }\n}\n\nexport function SystemMessage(props) {\n  const intl = useIntl();\n\n  return (\n    <li className={classNames(styles.messageGroup, styles.systemMessage)}>\n      {props.showLineBreak && <hr />}\n      <p className={styles.messageGroupLabel}>\n        <i>{formatSystemMessage(props, intl)}</i>\n        <span>\n          <FormattedRelativeTime updateIntervalInSeconds={10} value={(props.timestamp - Date.now()) / 1000} />\n        </span>\n      </p>\n    </li>\n  );\n}\n\nSystemMessage.propTypes = {\n  timestamp: PropTypes.any,\n  showLineBreak: PropTypes.bool\n};\n\nfunction MessageBubble({ media, monospace, emoji, children }) {\n  return (\n    <div\n      className={classNames(styles.messageBubble, {\n        [styles.media]: media,\n        [styles.emoji]: emoji,\n        [styles.monospace]: monospace\n      })}\n    >\n      {children}\n    </div>\n  );\n}\n\nMessageBubble.propTypes = {\n  media: PropTypes.bool,\n  monospace: PropTypes.bool,\n  emoji: PropTypes.oneOfType([PropTypes.bool, PropTypes.array]),\n  children: PropTypes.node\n};\n\nfunction getMessageComponent(message) {\n  switch (message.type) {\n    case \"chat\": {\n      const { formattedBody, monospace, emoji } = formatMessageBody(message.body);\n      return (\n        <MessageBubble key={message.id} monospace={monospace} emoji={emoji}>\n          {formattedBody}\n        </MessageBubble>\n      );\n    }\n    case \"video\":\n      return (\n        <MessageBubble key={message.id} media>\n          <video controls src={message.body.src} />\n        </MessageBubble>\n      );\n    case \"image\":\n    case \"photo\":\n      return (\n        <MessageBubble key={message.id} media>\n          <img src={message.body.src} />\n        </MessageBubble>\n      );\n    default:\n      return null;\n  }\n}\n\nexport function ChatMessageGroup({ sent, sender, timestamp, messages }) {\n  return (\n    <li className={classNames(styles.messageGroup, { [styles.sent]: sent })}>\n      <p className={styles.messageGroupLabel}>\n        {sender} | <FormattedRelativeTime updateIntervalInSeconds={10} value={(timestamp - Date.now()) / 1000} />\n      </p>\n      <ul className={styles.messageGroupMessages}>{messages.map(message => getMessageComponent(message))}</ul>\n    </li>\n  );\n}\n\nChatMessageGroup.propTypes = {\n  sent: PropTypes.bool,\n  sender: PropTypes.string,\n  timestamp: PropTypes.any,\n  messages: PropTypes.array\n};\n\nexport const ChatMessageList = forwardRef(({ children, ...rest }, ref) => (\n  <ul {...rest} className={styles.messageList} ref={ref}>\n    {children}\n  </ul>\n));\n\nChatMessageList.propTypes = {\n  children: PropTypes.node\n};\n\nexport function ChatSidebar({ onClose, children, ...rest }) {\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"chat-sidebar.title\" defaultMessage=\"Chat\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n      contentClassName={styles.content}\n      disableOverflowScroll\n      {...rest}\n    >\n      {children}\n    </Sidebar>\n  );\n}\n\nChatSidebar.propTypes = {\n  onClose: PropTypes.func,\n  onScrollList: PropTypes.func,\n  children: PropTypes.node,\n  listRef: PropTypes.func\n};\n\nexport function ChatToolbarButton(props) {\n  return (\n    <ToolbarButton\n      {...props}\n      icon={<ChatIcon />}\n      preset=\"accent4\"\n      label={<FormattedMessage id=\"chat-toolbar-button\" defaultMessage=\"Chat\" />}\n    />\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport html2canvas from \"html2canvas\";\nimport { coerceToUrl } from \"../utils/media-utils\";\nimport { formatMessageBody } from \"../utils/chat-message\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\n\nconst textureLoader = new HubsTextureLoader();\n\nconst CHAT_MESSAGE_TEXTURE_SIZE = 1024;\n\nconst messageBodyDom = (body, from, fromSessionId, onViewProfile, emojiClassName) => {\n  const { formattedBody, multiline, monospace, emoji } = formatMessageBody(body, { emojiClassName });\n  const wrapStyle = multiline ? styles.messageWrapMulti : styles.messageWrap;\n  const messageBodyClasses = {\n    [styles.messageBody]: true,\n    [styles.messageBodyMulti]: multiline,\n    [styles.messageBodyMono]: monospace\n  };\n  const includeClientLink = onViewProfile && fromSessionId && history && NAF.clientId !== fromSessionId;\n  const onFromClick = includeClientLink ? () => onViewProfile(fromSessionId) : () => {};\n\n  const content = (\n    <div className={wrapStyle}>\n      {from && (\n        <div\n          onClick={onFromClick}\n          className={classNames({ [styles.messageSource]: true, [styles.messageSourceLink]: includeClientLink })}\n        >\n          {from}:\n        </div>\n      )}\n      <div className={classNames(messageBodyClasses)}>{formattedBody}</div>\n    </div>\n  );\n\n  return { content, multiline, emoji };\n};\n\nfunction renderChatMessage(body, from, allowEmojiRender) {\n  const { content, emoji, multiline } = messageBodyDom(body, from, null, null, styles.emoji);\n  const isEmoji = allowEmojiRender && emoji;\n  const el = document.createElement(\"div\");\n  el.setAttribute(\"class\", `${styles.presenceLog} ${styles.presenceLogSpawn}`);\n  document.body.appendChild(el);\n\n  const entryDom = (\n    <div\n      className={classNames({\n        [styles.presenceLogEntry]: !isEmoji,\n        [styles.presenceLogEntryOneLine]: !isEmoji && !multiline,\n        [styles.presenceLogEmoji]: isEmoji\n      })}\n    >\n      {content}\n    </div>\n  );\n\n  return new Promise((resolve, reject) => {\n    ReactDOM.render(entryDom, el, () => {\n      const width = el.offsetWidth;\n      const height = el.offsetHeight;\n      const ratio = height / width;\n      const scale = (CHAT_MESSAGE_TEXTURE_SIZE * Math.min(1.0, 1.0 / ratio)) / el.offsetWidth;\n      html2canvas(el, { backgroundColor: null, scale, logging: false })\n        .then(canvas => {\n          canvas.toBlob(blob => resolve([blob, width, height]), \"image/png\");\n          el.remove();\n        })\n        .catch(reject);\n    });\n  });\n}\n\nexport async function createInWorldLogMessage({ name, type, body }) {\n  if (type !== \"chat\") return;\n\n  const [blob, width, height] = await renderChatMessage(body, name, false);\n  const entity = document.createElement(\"a-entity\");\n  const meshEntity = document.createElement(\"a-entity\");\n\n  document.querySelector(\"a-scene\").appendChild(entity);\n\n  entity.appendChild(meshEntity);\n  entity.setAttribute(\"class\", \"ui\");\n  entity.setAttribute(\"is-remote-hover-target\", {});\n  entity.setAttribute(\"follow-in-fov\", {\n    target: \"#avatar-pov-node\",\n    offset: { x: 0, y: 0.0, z: -0.8 }\n  });\n\n  const blobUrl = URL.createObjectURL(blob);\n\n  meshEntity.setAttribute(\"animation__float\", {\n    property: \"position\",\n    dur: 10000,\n    from: { x: 0, y: 0, z: 0 },\n    to: { x: 0, y: 0.05, z: -0.05 },\n    easing: \"easeOutQuad\"\n  });\n\n  entity.setAttribute(\"animation__spawn\", {\n    property: \"scale\",\n    dur: 200,\n    from: { x: 0.1, y: 0.1, z: 0.1 },\n    to: { x: 1, y: 1, z: 1 },\n    easing: \"easeOutElastic\"\n  });\n\n  meshEntity.setAttribute(\"animation__opacity\", {\n    property: \"meshMaterial.opacity\",\n    isRawProperty: true,\n    delay: 3000,\n    dur: 8000,\n    from: 1.0,\n    to: 0.0,\n    easing: \"easeInQuad\"\n  });\n\n  meshEntity.addEventListener(\"animationcomplete__opacity\", () => {\n    entity.parentNode.removeChild(entity);\n  });\n\n  textureLoader.load(blobUrl, texture => {\n    const material = new THREE.MeshBasicMaterial();\n    material.transparent = true;\n    material.map = texture;\n    material.generateMipmaps = false;\n    material.needsUpdate = true;\n\n    const geometry = createPlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n    const mesh = new THREE.Mesh(geometry, material);\n    meshEntity.setObject3D(\"mesh\", mesh);\n    meshEntity.meshMaterial = material;\n    const scaleFactor = 400;\n    meshEntity.object3DMap.mesh.scale.set(width / scaleFactor, height / scaleFactor, 1);\n  });\n}\n\nexport async function spawnChatMessage(body, from) {\n  if (body.length === 0) return;\n\n  try {\n    const url = new URL(coerceToUrl(body));\n    if (url.host) {\n      document.querySelector(\"a-scene\").emit(\"add_media\", body);\n      return;\n    }\n  } catch (e) {\n    // Ignore parse error\n  }\n\n  // If not a URL, spawn as a text bubble\n\n  const [blob] = await renderChatMessage(body, from, true);\n  document.querySelector(\"a-scene\").emit(\"add_media\", new File([blob], \"message.png\", { type: \"image/png\" }));\n}\n\nexport default function ChatMessage(props) {\n  const { content } = messageBodyDom(props.body, props.name, props.sessionId, props.onViewProfile);\n\n  return (\n    <div className={props.className}>\n      {props.maySpawn && (\n        <button\n          className={classNames(styles.iconButton, styles.spawnMessage)}\n          onClick={() => spawnChatMessage(props.body)}\n        />\n      )}\n      {content}\n    </div>\n  );\n}\n\nChatMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.string,\n  sessionId: PropTypes.string,\n  className: PropTypes.string,\n  onViewProfile: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport configs from \"../utils/configs\";\nimport classNames from \"classnames\";\n\nimport { share } from \"../utils/share\";\nimport { getLandingPageForPhoto } from \"../utils/phoenix-utils\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nexport default function PhotoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const intl = useIntl();\n\n  const landingPageUrl = getLandingPageForPhoto(url);\n\n  const onShareClicked = share.bind(null, {\n    url: landingPageUrl,\n    title: intl.formatMessage(\n      {\n        id: \"photo-message.default-tweet\",\n        defaultMessage: \"Taken in {shareHashtag}\"\n      },\n      {\n        shareHashtag: configs.translation(\"share-hashtag\"),\n        url: `https://${configs.SHORTLINK_DOMAIN}/${hubId}`\n      }\n    )\n  });\n\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <FormattedMessage\n          id=\"photo-message.body\"\n          defaultMessage=\"{name} took a <a>photo</a>.\"\n          values={{\n            name: <b>{name}</b>,\n            // eslint-disable-next-line react/display-name\n            a: chunks => (\n              <b>\n                <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {chunks}\n                </a>\n              </b>\n            )\n          }}\n        />\n      </div>\n      <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={url} />\n      </a>\n    </div>\n  );\n}\nPhotoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../utils/configs\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nimport { share } from \"../utils/share\";\n\nexport default function VideoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const intl = useIntl();\n\n  const onShareClicked = share.bind(null, {\n    url: url,\n    title: intl.formatMessage(\n      {\n        id: \"video-message.default-tweet\",\n        defaultMessage: \"Taken in {shareHashtag}\"\n      },\n      {\n        shareHashtag: configs.translation(\"share-hashtag\"),\n        url: `https://${configs.SHORTLINK_DOMAIN}/${hubId}`\n      }\n    )\n  });\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <FormattedMessage\n          id=\"video-message.body\"\n          defaultMessage=\"{name} took a <a>video</a>.\"\n          values={{\n            name: <b>{name}</b>,\n            // eslint-disable-next-line react/display-name\n            a: chunks => (\n              <b>\n                <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {chunks}\n                </a>\n              </b>\n            )\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\nVideoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\n\nfunction spawnImage(url) {\n  document.querySelector(\"a-scene\").emit(\"add_media\", url);\n}\n\nexport default function ImageMessage({ name, body: { src: url }, className, maySpawn }) {\n  return (\n    <div className={className}>\n      {maySpawn && (\n        <button className={classNames(styles.iconButton, styles.spawnMessage)} onClick={() => spawnImage(url)} />\n      )}\n      <div className={styles.mediaBody}>{name && <div className={styles.messageSource}>{name}:</div>}</div>\n      <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={proxiedUrlFor(url)} />\n      </a>\n    </div>\n  );\n}\n\nImageMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { injectIntl } from \"react-intl\";\nimport { formatSystemMessage } from \"./room/ChatSidebar\";\n\nimport ChatMessage from \"./chat-message\";\nimport PhotoMessage from \"./photo-message\";\nimport VideoMessage from \"./video-message\";\nimport ImageMessage from \"./image-message\";\nimport { getPresenceContextForSession } from \"../utils/phoenix-utils\";\n\nclass PresenceLog extends Component {\n  static propTypes = {\n    entries: PropTypes.array,\n    inRoom: PropTypes.bool,\n    hubId: PropTypes.string,\n    history: PropTypes.object,\n    presences: PropTypes.object,\n    onViewProfile: PropTypes.func,\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  domForEntry = e => {\n    const entryClasses = {\n      [styles.presenceLogEntry]: true,\n      [styles.presenceLogEntryWithButton]: (e.type === \"chat\" || e.type === \"image\") && e.maySpawn,\n      [styles.presenceLogChat]: e.type === \"chat\",\n      [styles.expired]: !!e.expired\n    };\n\n    const presenceContext = e.sessionId ? getPresenceContextForSession(this.props.presences, e.sessionId) : {};\n    const isBot = !!presenceContext.discord;\n\n    switch (e.type) {\n      case \"chat\":\n        return (\n          <ChatMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            sessionId={e.sessionId}\n            includeFromLink={this.props.inRoom && !isBot}\n            history={this.props.history}\n            onViewProfile={this.props.onViewProfile}\n          />\n        );\n      case \"image\":\n        return (\n          <ImageMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n          />\n        );\n      case \"photo\":\n        return (\n          <PhotoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      case \"video\":\n        return (\n          <VideoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      default: {\n        const systemMessage = formatSystemMessage(e, this.props.intl);\n\n        return (\n          systemMessage && (\n            <div key={e.key} className={classNames(entryClasses)}>\n              <div>{systemMessage}</div>\n            </div>\n          )\n        );\n      }\n    }\n  };\n\n  render() {\n    const presenceClasses = {\n      [styles.presenceLog]: true,\n      [styles.presenceLogInRoom]: this.props.inRoom\n    };\n\n    return <div className={classNames(presenceClasses)}>{this.props.entries.map(this.domForEntry)}</div>;\n  }\n}\n\nexport default injectIntl(PresenceLog);\n","// extracted by mini-css-extract-plugin\nexport default {\"no-default-button-style\":\"preload-overlay__no-default-button-style__qzAb1\",\"noDefaultButtonStyle\":\"preload-overlay__no-default-button-style__qzAb1\",\"treatment\":\"preload-overlay__treatment__RIl_g\",\"screenshot\":\"preload-overlay__screenshot__Xr31g\",\"hub-name\":\"preload-overlay__hub-name__Te1Hl\",\"hubName\":\"preload-overlay__hub-name__Te1Hl\",\"main-panel\":\"preload-overlay__main-panel__OtC9B\",\"mainPanel\":\"preload-overlay__main-panel__OtC9B\",\"logo\":\"preload-overlay__logo__PTRso\"};","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport configs from \"../utils/configs\";\nimport styles from \"../assets/stylesheets/preload-overlay.scss\";\nimport { Button } from \"./input/Button\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nexport default class PreloadOverlay extends Component {\n  static propTypes = {\n    hubName: PropTypes.string,\n    hubScene: PropTypes.object,\n    baseUrl: PropTypes.string,\n    onLoadClicked: PropTypes.func\n  };\n\n  render() {\n    const loadButtonText = <FormattedMessage id=\"preload-overlay.load-button\" defaultMessage=\"Load Room\" />;\n\n    return (\n      <div className={styles.treatment}>\n        <div className={styles.screenshot}>\n          {this.props.hubScene && <img className={styles.screenshot} src={this.props.hubScene.screenshot_url} />}\n        </div>\n        <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className={styles.logo}>\n          <img\n            src={configs.image(\"logo\")}\n            alt={<FormattedMessage id=\"preload-overlay.logo-alt\" defaultMessage=\"Logo\" />}\n          />\n        </a>\n        <div className={styles.mainPanel}>\n          <div className={styles.hubName}>{this.props.hubName}</div>\n          {this.props.onLoadClicked &&\n            (!isMobile ? (\n              <Button preset=\"primary\" onClick={this.props.onLoadClicked}>\n                {loadButtonText}\n              </Button>\n            ) : (\n              <Button preset=\"primary\" as=\"a\" href={this.props.baseUrl} target=\"_blank\" rel=\"noreferrer noopener\">\n                {loadButtonText}\n              </Button>\n            ))}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\n\nconst useCanvas = (draw, color, xData, yData, options = {}) => {\n  const canvasRef = React.useRef(null);\n\n  useEffect(\n    () => {\n      const canvas = canvasRef.current;\n      const context = canvas.getContext(options.context || \"2d\");\n      let animationFrameId;\n      const render = () => {\n        draw(context, xData, yData, color);\n        animationFrameId = window.requestAnimationFrame(render);\n      };\n      render();\n      return () => {\n        window.cancelAnimationFrame(animationFrameId);\n      };\n    },\n    [options.context, xData, yData, color, draw]\n  );\n  return canvasRef;\n};\n\nfunction drawFunc(ctx, xData, yData, color) {\n  const xSum = xData.reduce((a, b) => a + b, 0);\n  const xRatio = ctx.canvas.width / xSum;\n\n  const yMax = Math.max.apply(Math, yData);\n  const yRatio = ctx.canvas.height / yMax;\n\n  xData = xData.map(x => x * xRatio);\n  yData = yData.map(y => y * yRatio);\n\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n  ctx.fillStyle = color;\n  ctx.strokeStyle = color;\n  ctx.lineWidth = 1;\n  let x0 = 0;\n  for (let i = 0; i < xData.length; i++) {\n    const x1 = x0 + xData[i];\n    const y0 = ctx.canvas.height - yData[i];\n    const y1 = ctx.canvas.height - (i === 0 ? yData[i] : i === yData.length - 1 ? yData[i] : yData[i + 1]);\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.lineTo(x1, y1);\n    ctx.lineTo(x1, ctx.canvas.height);\n    ctx.lineTo(x0, ctx.canvas.height);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n    x0 = x1;\n  }\n}\n\nexport const DataGraph = props => {\n  const { options, data, color, xAxis, yAxis, ...rest } = props;\n  const { context } = options;\n\n  const xData = data.map(d => d[xAxis]);\n  const yData = data.map(d => d[yAxis]);\n  const canvasRef = useCanvas(drawFunc, color, xData, yData, { context });\n\n  return <canvas ref={canvasRef} {...rest} />;\n};\n\nDataGraph.propTypes = {\n  options: PropTypes.object,\n  data: PropTypes.array,\n  xAxis: PropTypes.string,\n  yAxis: PropTypes.string,\n  color: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"rtc-tile-text\":\"Prop__rtc-tile-text__mbi_m\",\"rtcTileText\":\"Prop__rtc-tile-text__mbi_m\",\"rtc-value-text\":\"Prop__rtc-value-text__ZiJ0n\",\"rtcValueText\":\"Prop__rtc-value-text__ZiJ0n\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Prop.scss\";\n\nexport function CreatePropsFromData(data) {\n  const props = [];\n  for (const property in data) {\n    let value = data[property];\n    if (typeof value === \"number\" && !!(value % 1)) {\n      value = value.toFixed(2);\n      props.push(<Prop key={property} propKey={property} propValue={value} />);\n    } else if (typeof value === \"object\") {\n      props.push(<Prop key={property} propKey={property} propValue={\"-\"} />);\n      props.push(CreatePropsFromData(value));\n    } else {\n      props.push(<Prop key={property} propKey={property} propValue={value} />);\n    }\n  }\n\n  return props;\n}\n\nexport function Prop({ propKey, propValue }) {\n  return (\n    (propKey !== undefined &&\n      propValue !== undefined && (\n        <p className={classNames(styles.rtcTileText)}>\n          {`${propKey}: `}\n          <span className={classNames(styles.rtcValueText)}>{`${propValue}`}</span>\n        </p>\n      )) ||\n    null\n  );\n}\n\nProp.propTypes = {\n  propKey: PropTypes.string,\n  propValue: PropTypes.any\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"data-tile\":\"DataPanel__data-tile__aO6Kk\",\"dataTile\":\"DataPanel__data-tile__aO6Kk\",\"data-tile-title\":\"DataPanel__data-tile-title__wcIIC\",\"dataTileTitle\":\"DataPanel__data-tile-title__wcIIC\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { DataGraph } from \"./DataGraph.js\";\nimport { Prop, CreatePropsFromData } from \"./Prop.js\";\nimport styles from \"./DataPanel.scss\";\n\nexport function DataPanel({\n  graphData,\n  speed,\n  width,\n  height,\n  data,\n  xAxis,\n  yAxis,\n  title,\n  children,\n  color,\n  backgroundColor\n}) {\n  return (\n    <div className={classNames(styles.dataTile)} style={{ backgroundColor: backgroundColor }}>\n      <p className={classNames(styles.dataTileTitle)}>{title}</p>\n      {graphData && (\n        <div\n          style={{\n            position: \"relative\",\n            width: width || \"auto\",\n            height: height || \"auto\",\n            alignSelf: \"center\",\n            flex: \"0 0 auto\"\n          }}\n        >\n          <DataGraph\n            width={width || \"auto\"}\n            height={height || \"auto\"}\n            options={{ context: \"2d\" }}\n            data={graphData}\n            color={color || \"rgb(0, 0, 255)\"}\n            xAxis={xAxis}\n            yAxis={yAxis}\n          />\n        </div>\n      )}\n      {speed && <Prop propKey={`speed`} propValue={`${speed} Kb/sec`} />}\n      {CreatePropsFromData(data)}\n      {children}\n    </div>\n  );\n}\n\nDataPanel.propTypes = {\n  graphData: PropTypes.array,\n  speed: PropTypes.string,\n  data: PropTypes.object,\n  xAxis: PropTypes.string,\n  yAxis: PropTypes.string,\n  title: PropTypes.node,\n  children: PropTypes.node,\n  width: PropTypes.string,\n  height: PropTypes.string,\n  color: PropTypes.string,\n  backgroundColor: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"border-tile\":\"CollapsiblePanel__border-tile__a8dvp\",\"borderTile\":\"CollapsiblePanel__border-tile__a8dvp\",\"borderless-tile\":\"CollapsiblePanel__borderless-tile__bGn8c\",\"borderlessTile\":\"CollapsiblePanel__borderless-tile__bGn8c\",\"rtc-debug-panel-root\":\"CollapsiblePanel__rtc-debug-panel-root__sv8yl\",\"rtcDebugPanelRoot\":\"CollapsiblePanel__rtc-debug-panel-root__sv8yl\",\"rtc-status-container\":\"CollapsiblePanel__rtc-status-container__PEFgl\",\"rtcStatusContainer\":\"CollapsiblePanel__rtc-status-container__PEFgl\",\"status-container-middle\":\"CollapsiblePanel__status-container-middle__sP73q\",\"statusContainerMiddle\":\"CollapsiblePanel__status-container-middle__sP73q\",\"rtc-status-container-right\":\"CollapsiblePanel__rtc-status-container-right__bjrWb\",\"rtcStatusContainerRight\":\"CollapsiblePanel__rtc-status-container-right__bjrWb\",\"rtc-status-container-left\":\"CollapsiblePanel__rtc-status-container-left__r_pIO\",\"rtcStatusContainerLeft\":\"CollapsiblePanel__rtc-status-container-left__r_pIO\",\"rtc-log-container\":\"CollapsiblePanel__rtc-log-container__l_VBn\",\"rtcLogContainer\":\"CollapsiblePanel__rtc-log-container__l_VBn\",\"rtc-log-time\":\"CollapsiblePanel__rtc-log-time__znjRS\",\"rtcLogTime\":\"CollapsiblePanel__rtc-log-time__znjRS\",\"rtc-log-text\":\"CollapsiblePanel__rtc-log-text__YHbuu\",\"rtcLogText\":\"CollapsiblePanel__rtc-log-text__YHbuu\",\"rtc-log-msg\":\"CollapsiblePanel__rtc-log-msg__cMtQV\",\"rtcLogMsg\":\"CollapsiblePanel__rtc-log-msg__cMtQV\",\"rtc-log-tag\":\"CollapsiblePanel__rtc-log-tag__54VIM\",\"rtcLogTag\":\"CollapsiblePanel__rtc-log-tag__54VIM\",\"rtc-log-msg-container\":\"CollapsiblePanel__rtc-log-msg-container__DH5QR\",\"rtcLogMsgContainer\":\"CollapsiblePanel__rtc-log-msg-container__DH5QR\",\"collapse-button\":\"CollapsiblePanel__collapse-button__V1F4E\",\"collapseButton\":\"CollapsiblePanel__collapse-button__V1F4E\",\"log-button\":\"CollapsiblePanel__log-button__lrG2X\",\"logButton\":\"CollapsiblePanel__log-button__lrG2X\",\"collapsible-content\":\"CollapsiblePanel__collapsible-content__fpjed\",\"collapsibleContent\":\"CollapsiblePanel__collapsible-content__fpjed\",\"collapsible-content-root\":\"CollapsiblePanel__collapsible-content-root__RX7yn\",\"collapsibleContentRoot\":\"CollapsiblePanel__collapsible-content-root__RX7yn\",\"collapsible-header\":\"CollapsiblePanel__collapsible-header__ushjh\",\"collapsibleHeader\":\"CollapsiblePanel__collapsible-header__ushjh\",\"collapsible-right-buttons\":\"CollapsiblePanel__collapsible-right-buttons__HwlGL\",\"collapsibleRightButtons\":\"CollapsiblePanel__collapsible-right-buttons__HwlGL\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { CreatePropsFromData } from \"./Prop.js\";\nimport styles from \"./CollapsiblePanel.scss\";\n\nfunction collapse(evt) {\n  evt.target.classList.toggle(\"collapsed\");\n  evt.target.parentElement?.nextSibling?.classList.toggle(\"collapsed\");\n  return evt.target.parentElement?.nextSibling?.classList.contains(\"collapsed\");\n}\n\nfunction openLink(url) {\n  const win = window.open(url, \"_blank\");\n  win.focus();\n}      \n\nexport function CollapsiblePanel({\n  title,\n  border,\n  row,\n  wrap,\n  grow,\n  url,\n  isRoot,\n  children,\n  data,\n  collapsed,\n  onCollapse,\n  backgroundColor,\n  clear,\n  download\n}) {\n  const rootClassName = classNames(border ? styles.borderTile : styles.borderlessTile);\n  const rootStyle = {\n    flexGrow: grow ? 1 : 0,\n    backgroundColor\n  };\n  const contentClassName = classNames(\n    isRoot\n      ? `${styles.collapsibleContentRoot} ${(!!collapsed && \"collapsed\") || \"\"}`\n      : `${styles.collapsibleContent} ${(!!collapsed && \"collapsed\") || \"\"}`\n  );\n  const buttonClassName = classNames(`${styles.collapseButton} ${(!!collapsed && \"collapsed\") || \"\"}`);\n  const contentStyle = {\n    flexFlow: (row ? \"row \" : \"column \") + (wrap ? \"wrap\" : \"nowrap\")\n  };\n  return (\n    <div className={rootClassName} style={rootStyle}>\n      <div className={styles.collapsibleHeader}>\n        {title && (\n          <button\n            className={classNames(buttonClassName)}\n            onClick={evt => {\n              const isCollapsed = collapse(evt);\n              onCollapse && onCollapse(title, isCollapsed);\n            }}\n          >\n            {title}\n          </button>\n        )}\n         {url && (\n          <button className={classNames(styles.logButton)} onClick={() => openLink(url)}>\n            ?\n          </button>\n        )}\n        {(clear || download) && (\n          <div className={styles.collapsibleRightButtons}>\n            {download && (\n              <button className={classNames(styles.logButton)} onClick={download}>\n                &#x2193;\n              </button>\n            )}\n            {clear && (\n              <button className={classNames(styles.logButton)} onClick={clear}>\n                &#xd7;\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n      <div className={contentClassName} style={contentStyle}>\n        {CreatePropsFromData(data)}\n        {children}\n      </div>\n    </div>\n  );\n}\n\nCollapsiblePanel.propTypes = {\n  children: PropTypes.node,\n  title: PropTypes.node,\n  border: PropTypes.bool,\n  row: PropTypes.bool,\n  grow: PropTypes.bool,\n  wrap: PropTypes.bool,\n  url: PropTypes.string,\n  isRoot: PropTypes.bool,\n  data: PropTypes.object,\n  collapsed: PropTypes.bool,\n  onCollapse: PropTypes.func,\n  backgroundColor: PropTypes.string,\n  clear: PropTypes.func,\n  download: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"border-tile\":\"RtcDebugPanel__border-tile__AYdEt\",\"borderTile\":\"RtcDebugPanel__border-tile__AYdEt\",\"borderless-tile\":\"RtcDebugPanel__borderless-tile__DhsGP\",\"borderlessTile\":\"RtcDebugPanel__borderless-tile__DhsGP\",\"rtc-debug-panel-root\":\"RtcDebugPanel__rtc-debug-panel-root__ZBgNt\",\"rtcDebugPanelRoot\":\"RtcDebugPanel__rtc-debug-panel-root__ZBgNt\",\"rtc-status-container\":\"RtcDebugPanel__rtc-status-container__yb_6A\",\"rtcStatusContainer\":\"RtcDebugPanel__rtc-status-container__yb_6A\",\"status-container-middle\":\"RtcDebugPanel__status-container-middle__GkH1i\",\"statusContainerMiddle\":\"RtcDebugPanel__status-container-middle__GkH1i\",\"rtc-status-container-right\":\"RtcDebugPanel__rtc-status-container-right__v2TQx\",\"rtcStatusContainerRight\":\"RtcDebugPanel__rtc-status-container-right__v2TQx\",\"rtc-status-container-left\":\"RtcDebugPanel__rtc-status-container-left__i_75b\",\"rtcStatusContainerLeft\":\"RtcDebugPanel__rtc-status-container-left__i_75b\",\"rtc-log-container\":\"RtcDebugPanel__rtc-log-container__adAUM\",\"rtcLogContainer\":\"RtcDebugPanel__rtc-log-container__adAUM\",\"rtc-log-time\":\"RtcDebugPanel__rtc-log-time__JSSve\",\"rtcLogTime\":\"RtcDebugPanel__rtc-log-time__JSSve\",\"rtc-log-text\":\"RtcDebugPanel__rtc-log-text__WPd7j\",\"rtcLogText\":\"RtcDebugPanel__rtc-log-text__WPd7j\",\"rtc-log-msg\":\"RtcDebugPanel__rtc-log-msg__XJZu8\",\"rtcLogMsg\":\"RtcDebugPanel__rtc-log-msg__XJZu8\",\"rtc-log-tag\":\"RtcDebugPanel__rtc-log-tag__Yt0hz\",\"rtcLogTag\":\"RtcDebugPanel__rtc-log-tag__Yt0hz\",\"rtc-log-msg-container\":\"RtcDebugPanel__rtc-log-msg-container___MEx7\",\"rtcLogMsgContainer\":\"RtcDebugPanel__rtc-log-msg-container___MEx7\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgCaretDown = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m3.828 7.424 5.46 6.372a.938.938 0 0 0 1.424 0l5.46-6.372a.938.938 0 0 0-.712-1.548H4.538c-.8 0-1.233.94-.71 1.548Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgCaretDown as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"audio-debug-container\":\"AudioDebugPanel__audio-debug-container__mQfQs\",\"audioDebugContainer\":\"AudioDebugPanel__audio-debug-container__mQfQs\",\"audio-debug-row\":\"AudioDebugPanel__audio-debug-row__GxFlz\",\"audioDebugRow\":\"AudioDebugPanel__audio-debug-row__GxFlz\",\"prop-text\":\"AudioDebugPanel__prop-text__xSaPY\",\"propText\":\"AudioDebugPanel__prop-text__xSaPY\",\"value-text\":\"AudioDebugPanel__value-text__KkK4W\",\"valueText\":\"AudioDebugPanel__value-text__KkK4W\"};","// extracted by mini-css-extract-plugin\nexport default {\"select-input\":\"SelectInputField__select-input__Q9wMN\",\"selectInput\":\"SelectInputField__select-input__Q9wMN\",\"dropdown-button\":\"SelectInputField__dropdown-button__E2fNK\",\"dropdownButton\":\"SelectInputField__dropdown-button__E2fNK\",\"dropdown\":\"SelectInputField__dropdown__wN7x4\",\"open\":\"SelectInputField__open__B7Ur0\",\"dropdown-item\":\"SelectInputField__dropdown-item__lLzp4\",\"dropdownItem\":\"SelectInputField__dropdown-item__lLzp4\",\"highlighted-item\":\"SelectInputField__highlighted-item__BhcUo\",\"highlightedItem\":\"SelectInputField__highlighted-item__BhcUo\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport classNames from \"classnames\";\nimport styles from \"./SelectInputField.scss\";\nimport { ReactComponent as CaretDownIcon } from \"../icons/CaretDown.svg\";\nimport { useSelect } from \"downshift\";\nimport { FormattedMessage } from \"react-intl\";\n\nfunction getItemValue(item) {\n  return typeof item === \"object\" ? item.value : item;\n}\n\nfunction getSelectedItem(value, options) {\n  const selectedItemValue = getItemValue(value);\n\n  if (options.length > 0 && typeof options[0] === \"object\") {\n    return options.find(item => item.value === selectedItemValue);\n  }\n\n  return selectedItemValue;\n}\n\nfunction getItemLabel(item) {\n  return typeof item === \"object\" ? item.label || item.value : item;\n}\n\nexport function SelectInputField({\n  className,\n  error,\n  description,\n  inputClassName,\n  buttonClassName,\n  label,\n  onChange,\n  value,\n  options,\n  fullWidth,\n  ...rest\n}) {\n  const {\n    isOpen,\n    selectedItem,\n    getToggleButtonProps,\n    getMenuProps,\n    getLabelProps,\n    highlightedIndex,\n    getItemProps\n  } = useSelect({\n    items: options,\n    selectedItem: getSelectedItem(value, options),\n    ...rest,\n    onSelectedItemChange: ({ selectedItem }) => {\n      if (onChange) {\n        onChange(getItemValue(selectedItem));\n      }\n    }\n  });\n\n  const selectedItemLabel = getItemLabel(selectedItem);\n\n  return (\n    <InputField\n      {...getLabelProps()}\n      className={className}\n      label={label}\n      error={error}\n      description={description}\n      fullWidth={fullWidth}\n    >\n      <div className={classNames(styles.selectInput, { [styles.open]: isOpen }, inputClassName)}>\n        <button\n          className={classNames(styles.dropdownButton, buttonClassName)}\n          type=\"button\"\n          {...getToggleButtonProps()}\n        >\n          <span>\n            {selectedItemLabel !== undefined ? (\n              selectedItemLabel\n            ) : (\n              <FormattedMessage id=\"select-input-field.placeholder\" defaultMessage=\"Select...\" />\n            )}\n          </span>\n          <CaretDownIcon />\n        </button>\n        {options.length > 0 && (\n          <ul {...getMenuProps()} className={styles.dropdown}>\n            {isOpen &&\n              options.map((item, index) => (\n                <li\n                  className={classNames(styles.dropdownItem, { [styles.highlightedItem]: highlightedIndex === index })}\n                  key={getItemValue(item)}\n                  {...getItemProps({ item, index })}\n                >\n                  {getItemLabel(item)}\n                </li>\n              ))}\n          </ul>\n        )}\n      </div>\n    </InputField>\n  );\n}\n\nSelectInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  buttonClassName: PropTypes.string,\n  value: PropTypes.any,\n  options: PropTypes.arrayOf(\n    PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.number,\n      PropTypes.shape({\n        // id: PropTypes.string.isRequired,\n        label: PropTypes.string,\n        value: PropTypes.any.isRequired\n      })\n    ])\n  ).isRequired,\n  onChange: PropTypes.func,\n  fullWidth: PropTypes.bool\n};\n\nSelectInputField.defaultProps = {\n  options: []\n};\n","import React, { useCallback, useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport styles from \"./AudioDebugPanel.scss\";\nimport { CollapsiblePanel } from \".//CollapsiblePanel\";\nimport classNames from \"classnames\";\nimport {\n  CLIPPING_THRESHOLD_MIN,\n  CLIPPING_THRESHOLD_MAX,\n  CLIPPING_THRESHOLD_STEP,\n  GLOBAL_VOLUME_MIN,\n  GLOBAL_VOLUME_MAX,\n  GLOBAL_VOLUME_STEP\n} from \"../../react-components/preferences-screen\";\nimport { SelectInputField } from \"../input/SelectInputField\";\nimport { DISTANCE_MODEL_OPTIONS, DistanceModelType, SourceType } from \"../../components/audio-params\";\nimport { getCurrentAudioSettingsForSourceType, updateAudioSettings } from \"../../update-audio-settings\";\n\nconst ROLLOFF_MIN = 0.0;\nconst ROLLOFF_MAX = 20.0;\nconst ROLLOFF_STEP = 0.5;\nconst ROLLOFF_LIN_MIN = 0.0;\nconst ROLLOFF_LIN_MAX = 1.0;\nconst ROLLOFF_LIN_STEP = 0.01;\nconst DISTANCE_MIN = 1.0;\nconst DISTANCE_MAX = 100.0;\nconst DISTANCE_STEP = 1.0;\nconst ANGLE_MIN = 0.0;\nconst ANGLE_MAX = 360.0;\nconst ANGLE_STEP = 1.0;\nconst GAIN_MIN = 0.0;\nconst GAIN_MAX = 1.0;\nconst GAIN_STEP = 0.1;\n\nfunction SelectProperty({ defaultValue, options, onChange, children }) {\n  const [value, setValue] = useState(defaultValue);\n  return (\n    <div className={classNames(styles.audioDebugRow)}>\n      <span style={{ flex: \"none\", padEnd: \"10px\" }}>{children}</span>\n      <SelectInputField\n        value={value}\n        options={options}\n        onChange={newValue => {\n          setValue(newValue);\n          onChange(newValue);\n        }}\n      />\n    </div>\n  );\n}\n\nSelectProperty.propTypes = {\n  defaultValue: PropTypes.string,\n  options: PropTypes.array,\n  onChange: PropTypes.func,\n  children: PropTypes.node\n};\n\nfunction SliderProperty({ defaultValue, step, min, max, onChange, children }) {\n  return (\n    <div className={classNames(styles.audioDebugRow)}>\n      <span style={{ flex: \"none\", padEnd: \"10px\" }}>{children}</span>\n      <input\n        type=\"range\"\n        step={step}\n        min={min}\n        max={max}\n        value={defaultValue}\n        onChange={e => {\n          const parsedValue = parseFloat(e.target.value);\n          onChange(parsedValue);\n        }}\n      />\n      <span className={classNames(styles.valueText)}>{defaultValue}</span>\n    </div>\n  );\n}\n\nSliderProperty.propTypes = {\n  defaultValue: PropTypes.number,\n  step: PropTypes.number,\n  min: PropTypes.number,\n  max: PropTypes.number,\n  onChange: PropTypes.func,\n  children: PropTypes.node\n};\n\nfunction getPrefs() {\n  return {\n    enableAudioClipping: APP.store.state.preferences.enableAudioClipping,\n    audioClippingThreshold: APP.store.state.preferences.audioClippingThreshold,\n    globalVoiceVolume: APP.store.state.preferences.globalVoiceVolume,\n    globalMediaVolume: APP.store.state.preferences.globalMediaVolume,\n    globalSFXVolume: APP.store.state.preferences.globalSFXVolume\n  };\n}\n\nexport function AudioDebugPanel({ isNarrow, collapsed, onCollapsed }) {\n  const [mediaSettings, setMediaSettings] = useState(getCurrentAudioSettingsForSourceType(SourceType.MEDIA_VIDEO));\n  const [avatarSettings, setAvatarSettings] = useState(\n    getCurrentAudioSettingsForSourceType(SourceType.AVATAR_AUDIO_SOURCE)\n  );\n\n  const onSettingChange = (sourceType, newSetting) => {\n    const settings = Object.assign({}, APP.audioDebugPanelOverrides.get(sourceType), newSetting);\n    APP.audioDebugPanelOverrides.set(sourceType, settings);\n    if (sourceType === SourceType.MEDIA_VIDEO) {\n      setMediaSettings(getCurrentAudioSettingsForSourceType(SourceType.MEDIA_VIDEO));\n    } else {\n      setAvatarSettings(getCurrentAudioSettingsForSourceType(SourceType.AVATAR_AUDIO_SOURCE));\n    }\n    for (const [el, audio] of APP.audios.entries()) {\n      updateAudioSettings(el, audio);\n    }\n  };\n\n  const [preferences, setPreferences] = useState(getPrefs());\n  const onPreferencesUpdated = useCallback(\n    () => {\n      setPreferences(getPrefs());\n    },\n    [setPreferences]\n  );\n  useEffect(\n    () => {\n      onPreferencesUpdated();\n      APP.store.addEventListener(\"statechanged\", onPreferencesUpdated);\n      return () => {\n        APP.store.removeEventListener(\"statechanged\", onPreferencesUpdated);\n        APP.audioDebugPanelOverrides.delete(SourceType.MEDIA_VIDEO);\n        APP.audioDebugPanelOverrides.delete(SourceType.AVATAR_AUDIO_SOURCE);\n        for (const [el, audio] of APP.audios.entries()) {\n          updateAudioSettings(el, audio);\n        }\n      };\n    },\n    [onPreferencesUpdated]\n  );\n\n  return (\n    <div\n      className={classNames(styles.audioDebugContainer)}\n      style={{\n        height: isNarrow && !collapsed && \"80%\",\n        maxHeight: isNarrow && !collapsed && \"80%\"\n      }}\n    >\n      <CollapsiblePanel\n        title={<FormattedMessage id=\"audio-debug-panel.audio-debug-title\" defaultMessage=\"Audio Debug\" />}\n        isRoot\n        border\n        collapsed={collapsed}\n        onCollapse={onCollapsed}\n      >\n        <CollapsiblePanel\n          title={<FormattedMessage id=\"audio-debug-panel.audio-debug-global-title\" defaultMessage=\"Globals\" />}\n          border\n          grow\n        >\n          <div style={{ display: \"flex\", alignItems: \"center\" }}>\n            <input\n              tabIndex=\"0\"\n              type=\"checkbox\"\n              checked={preferences.enableAudioClipping}\n              onChange={() => {\n                APP.store.update({\n                  preferences: {\n                    enableAudioClipping: !preferences.enableAudioClipping\n                  }\n                });\n              }}\n              style={{ marginLeft: \"10px\" }}\n            />\n            <SliderProperty\n              defaultValue={preferences.audioClippingThreshold}\n              step={CLIPPING_THRESHOLD_STEP}\n              min={CLIPPING_THRESHOLD_MIN}\n              max={CLIPPING_THRESHOLD_MAX}\n              onChange={value => {\n                APP.store.update({\n                  preferences: {\n                    audioClippingThreshold: value\n                  }\n                });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.global.clippingThreshold\" defaultMessage=\"Clipping\" />\n              </p>\n            </SliderProperty>\n          </div>\n          <SliderProperty\n            defaultValue={preferences.globalVoiceVolume}\n            step={GLOBAL_VOLUME_STEP}\n            min={GLOBAL_VOLUME_MIN}\n            max={GLOBAL_VOLUME_MAX}\n            onChange={value => {\n              APP.store.update({\n                preferences: {\n                  globalVoiceVolume: value\n                }\n              });\n            }}\n          >\n            <p className={classNames(styles.propText)}>\n              <FormattedMessage id=\"audio-debug-view.global.voiceVolume\" defaultMessage=\"Voice Volume\" />\n            </p>\n          </SliderProperty>\n          <SliderProperty\n            defaultValue={preferences.globalMediaVolume}\n            step={GLOBAL_VOLUME_STEP}\n            min={GLOBAL_VOLUME_MIN}\n            max={GLOBAL_VOLUME_MAX}\n            onChange={value => {\n              APP.store.update({\n                preferences: {\n                  globalMediaVolume: value\n                }\n              });\n            }}\n          >\n            <p className={classNames(styles.propText)}>\n              <FormattedMessage id=\"audio-debug-view.global.mediaVolume\" defaultMessage=\"Media Volume\" />\n            </p>\n          </SliderProperty>\n          <SliderProperty\n            defaultValue={preferences.globalSFXVolume}\n            step={GLOBAL_VOLUME_STEP}\n            min={GLOBAL_VOLUME_MIN}\n            max={GLOBAL_VOLUME_MAX}\n            onChange={value => {\n              APP.store.update({\n                preferences: {\n                  globalSFXVolume: value\n                }\n              });\n            }}\n          >\n            <p className={classNames(styles.propText)}>\n              <FormattedMessage id=\"audio-debug-view.global.sfxVolume\" defaultMessage=\"SFX Volume\" />\n            </p>\n          </SliderProperty>\n        </CollapsiblePanel>\n        <div style={{ display: \"flex\" }}>\n          <CollapsiblePanel\n            title={<FormattedMessage id=\"audio-debug-panel.audio-debug-avatar-title\" defaultMessage=\"Avatar\" />}\n            border\n            grow\n          >\n            <SelectProperty\n              defaultValue={avatarSettings.distanceModel}\n              options={DISTANCE_MODEL_OPTIONS}\n              onChange={value => {\n                const newSetting = { distanceModel: value };\n                if (value === DistanceModelType.Linear && avatarSettings.rolloffFactor > 1.0) {\n                  newSetting.rolloffFactor = 1.0;\n                }\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, newSetting);\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.distanceModel\" defaultMessage=\"Distance Model\" />\n              </p>\n            </SelectProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.rolloffFactor}\n              step={avatarSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_STEP : ROLLOFF_STEP}\n              min={avatarSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MIN : ROLLOFF_MIN}\n              max={avatarSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MAX : ROLLOFF_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { rolloffFactor: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.rolloffFactor\" defaultMessage=\"Rolloff\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.refDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { refDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.refDistance\" defaultMessage=\"Ref Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.maxDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { maxDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.maxDistance\" defaultMessage=\"Max Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.coneInnerAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { coneInnerAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.innerAngle\" defaultMessage=\"Inner Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.coneOuterAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { coneOuterAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.outerAngle\" defaultMessage=\"Outer Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.coneOuterGain}\n              step={GAIN_STEP}\n              min={GAIN_MIN}\n              max={GAIN_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { coneOuterGain: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.outerGain\" defaultMessage=\"Outer Gain\" />\n              </p>\n            </SliderProperty>\n          </CollapsiblePanel>\n          <CollapsiblePanel\n            title={<FormattedMessage id=\"audio-debug-panel.audio-debug-media-title\" defaultMessage=\"Media\" />}\n            border\n            grow\n          >\n            <SelectProperty\n              defaultValue={mediaSettings.distanceModel}\n              options={DISTANCE_MODEL_OPTIONS}\n              onChange={value => {\n                const newSetting = { distanceModel: value };\n                if (value === DistanceModelType.Linear && mediaSettings.rolloffFactor > 1.0) {\n                  newSetting.rolloffFactor = 1.0;\n                }\n                onSettingChange(SourceType.MEDIA_VIDEO, newSetting);\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.distanceModel\" defaultMessage=\"Distance Model\" />\n              </p>\n            </SelectProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.rolloffFactor}\n              step={mediaSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_STEP : ROLLOFF_STEP}\n              min={mediaSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MIN : ROLLOFF_MIN}\n              max={mediaSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MAX : ROLLOFF_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { rolloffFactor: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.rolloffFactor\" defaultMessage=\"Rolloff\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.refDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { refDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.refDistance\" defaultMessage=\"Ref Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.maxDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { maxDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.maxDistance\" defaultMessage=\"Max Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.coneInnerAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { coneInnerAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.innerAngle\" defaultMessage=\"Inner Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.coneOuterAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { coneOuterAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.outerAngle\" defaultMessage=\"Outer Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.coneOuterGain}\n              step={GAIN_STEP}\n              min={GAIN_MIN}\n              max={GAIN_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { coneOuterGain: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.outerGain\" defaultMessage=\"Outer Gain\" />\n              </p>\n            </SliderProperty>\n          </CollapsiblePanel>\n        </div>\n      </CollapsiblePanel>\n    </div>\n  );\n}\n\nAudioDebugPanel.propTypes = {\n  isNarrow: PropTypes.bool,\n  collapsed: PropTypes.bool,\n  onCollapsed: PropTypes.func,\n  children: PropTypes.node\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { DataPanel } from \"./DataPanel.js\";\nimport { CollapsiblePanel } from \"./CollapsiblePanel.js\";\nimport { Button } from \"../input/Button.js\";\nimport styles from \"./RtcDebugPanel.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport { AudioDebugPanel } from \"./AudioDebugPanel\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nconst TransportType = {\n  SEND: \"send_transport\",\n  RECEIVE: \"receive_transport\"\n};\n\nconst StatsType = {\n  INBOUND_RTP: \"inbound-rtp\",\n  OUTBOUND_RTP: \"outbound-rtp\",\n  LOCAL_CANDIDATE: \"local-candidate\",\n  REMOTE_CANDIDATE: \"remote-candidate\",\n  CANDIDATE_PAIR: \"candidate-pair\",\n  TRANSPORT: \"transport\"\n};\n\nconst ERROR_COLOR = \"#8b1c00\";\nconst STATS_REFRESH_TIME = 2000;\nconst PRODUCERS_KEY = \"producers\";\nconst CONSUMERS_KEY = \"consumers\";\nconst MEDIASOUP_DOC_BASE_URL = \"https://mediasoup.org/documentation/v3/libmediasoupclient/api/\";\nconst MDN_DOC_BASE_URL = \"https://developer.mozilla.org/en-US/docs/Web/API/\";\n\nconst MessageButtonStyle = {\n  width: \"auto\",\n  alignSelf: \"center\",\n  margin: \"5px\",\n  padding: \"4px 18px\",\n  fontSize: \"12px\",\n  minWidth: \"120px\"\n};\n\nconst isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\n\nfunction capitalize(str) {\n  return str ? str.replace(/\\b\\w/g, c => c.toUpperCase()) : \"\";\n}\n\nfunction download(filename, text) {\n  const element = document.createElement(\"a\");\n  element.setAttribute(\"href\", \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text));\n  element.setAttribute(\"download\", filename);\n\n  element.style.display = \"none\";\n  document.body.appendChild(element);\n\n  element.click();\n\n  document.body.removeChild(element);\n}\n\nexport function PanelMessageButton({ children, ...rest }) {\n  return (\n    <Button {...rest} style={MessageButtonStyle}>\n      {children}\n    </Button>\n  );\n}\n\nPanelMessageButton.propTypes = {\n  children: PropTypes.node\n};\n\nfunction TrackStatsPanel({ title, data, xAxis, yAxis, stats }) {\n  const props = {\n    id: data.id,\n    opened: data.opened,\n    paused: data.paused,\n    kind: data.kind,\n    codec: data.codec\n  };\n  if (data.kind === \"video\") {\n    (data.spatialLayer !== undefined || data.temporalLayer !== undefined) &&\n      (props[\"currentLayers\"] = `S[${data.spatialLayer}] T[${data.temporalLayer}]`);\n    data.score != undefined &&\n      (props[\"score\"] = `S[${data.score?.score}] P[${data.score?.producerScore}][${data.score?.producerScores}]`);\n    data.frameRate != undefined && (props[\"frameRate\"] = `${data.frameRate}`);\n    data.width != undefined && (props[\"width\"] = `${data.width}`);\n    data.height != undefined && (props[\"height\"] = `${data.height}`);\n  }\n\n  const backgroundColor = !data.opened || !stats?.speed ? ERROR_COLOR : null;\n  return (\n    <DataPanel title={title} data={props} backgroundColor={backgroundColor}>\n      {data?.track && (\n        <DataPanel\n          key={data.id}\n          data={data.track}\n          title={<FormattedMessage id=\"rtc-debug-panel.track-panel-title\" defaultMessage=\"Track\" />}\n        />\n      )}\n      {stats && (\n        <DataPanel\n          key={stats.rtpStats?.id}\n          graphData={stats.graph.slice()}\n          width={\"120px\"}\n          height={\"50px\"}\n          color={\"green\"}\n          speed={stats.speed}\n          data={stats.rtpStats}\n          xAxis={xAxis}\n          yAxis={yAxis}\n          title={<FormattedMessage id=\"rtc-debug-panel.stats-panel-title\" defaultMessage=\"Stats\" />}\n        />\n      )}\n    </DataPanel>\n  );\n}\n\nTrackStatsPanel.propTypes = {\n  title: PropTypes.node,\n  data: PropTypes.object,\n  xAxis: PropTypes.string,\n  yAxis: PropTypes.string,\n  stats: PropTypes.object,\n  backgroundColor: PropTypes.string\n};\n\nfunction TransportPanel({ title, data, candidates, producers, consumers, isButtonEnabled, onRestart }) {\n  const error = producers?.some(producer => {\n    return !producer.props?.data?.opened || !producer.props?.stats?.speed;\n  });\n  const backgroundColor = error ? ERROR_COLOR : null;\n  return (\n    <CollapsiblePanel key={title} title={title} border url={`${MEDIASOUP_DOC_BASE_URL}#Transport`} data={data}>\n      <PanelMessageButton onClick={onRestart} disabled={!isButtonEnabled} preset=\"accept\">\n        <FormattedMessage id=\"rtc-debug-panel.restart-ice-button\" defaultMessage=\"Restart ICE\" />\n      </PanelMessageButton>\n      <CollapsiblePanel\n        key={`Candidates`}\n        title={<FormattedMessage id=\"rtc-debug-panel.local-candidates-panel-title\" defaultMessage=\"Candidates\" />}\n        row\n        url={`${MDN_DOC_BASE_URL}RTCIceCandidate`}\n        border\n        backgroundColor={candidates?.length === 0 && data?.state === \"connected\" && data?.opened ? ERROR_COLOR : null}\n      >\n        {(candidates?.length && candidates) || (\n          <p className={classNames(styles.rtcLogMsg)}>\n            <FormattedMessage id=\"rtc-debug-panel.local-no-candidates-message\" defaultMessage=\"No Candidates\" />\n          </p>\n        )}\n      </CollapsiblePanel>\n      {(producers?.length && (\n        <CollapsiblePanel\n          key={`Local producers`}\n          title={<FormattedMessage id=\"rtc-debug-panel.local-producers-panel-title\" defaultMessage=\"Local Producers\" />}\n          row\n          url={`${MEDIASOUP_DOC_BASE_URL}#Producer`}\n          border\n          collapsed\n          backgroundColor={backgroundColor}\n        >\n          {producers}\n        </CollapsiblePanel>\n      )) ||\n        null}\n      {consumers || null}\n    </CollapsiblePanel>\n  );\n}\n\nTransportPanel.propTypes = {\n  candidates: PropTypes.array,\n  producers: PropTypes.array,\n  consumers: PropTypes.array,\n  data: PropTypes.object,\n  onRestart: PropTypes.func,\n  title: PropTypes.node,\n  isButtonEnabled: PropTypes.bool\n};\n\nfunction SignalingPanel({ data, onConnect, onDisconnect }) {\n  return (\n    <CollapsiblePanel\n      title={<FormattedMessage id=\"rtc-debug-panel.signaling-panel-title\" defaultMessage=\"Signaling\" />}\n      border\n      data={data}\n    >\n      <PanelMessageButton\n        onClick={() => {\n          if (data.connected) {\n            onDisconnect();\n          } else {\n            onConnect();\n          }\n        }}\n        disabled={false}\n        preset=\"accept\"\n      >\n        {data.connected ? (\n          <FormattedMessage id=\"rtc-debug-panel.disconnect-signaling-button\" defaultMessage=\"Disconnect\" />\n        ) : (\n          <FormattedMessage id=\"rtc-debug-panel.connect-signaling-button\" defaultMessage=\"Connect\" />\n        )}\n      </PanelMessageButton>\n    </CollapsiblePanel>\n  );\n}\n\nSignalingPanel.propTypes = {\n  data: PropTypes.object,\n  onConnect: PropTypes.func,\n  onDisconnect: PropTypes.func\n};\n\nexport default class RtcDebugPanel extends Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    store: PropTypes.object,\n    scene: PropTypes.object,\n    intl: PropTypes.object,\n    presences: PropTypes.object,\n    history: PropTypes.object,\n    sessionId: PropTypes.string,\n    showRtcDebug: PropTypes.bool,\n    showAudioDebug: PropTypes.bool\n  };\n\n  constructor() {\n    super();\n\n    this.state = {\n      log: [],\n      collapsed: { Local: false, Log: isMobile, Remote: true, Audio: true }\n    };\n  }\n\n  componentDidMount() {\n    this.props.scene.addEventListener(\"rtc_event\", this.logEvent);\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.runStats(true);\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"rtc_event\", this.logEvent);\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.runStats(false);\n  }\n\n  logEvent = e => {\n    const currentLog = this.state.log.slice(-200) || [];\n    currentLog.push(e.detail);\n    this.setState({\n      log: currentLog\n    });\n  };\n\n  storeUpdated = () => {\n    const showPanel = this.props.store.state.preferences.showRtcDebugPanel;\n    this.setState({ showPanel: showPanel });\n  };\n\n  getDeviceData() {\n    let result = {};\n    const device = APP.dialog._mediasoupDevice;\n    if (device) {\n      result[\"loaded\"] = !device._closed ? true : false;\n      result[\"codecs\"] = device._recvRtpCapabilities?.codecs.map(\n        codec => \"[\" + codec.mimeType + \"/\" + codec.clockRate + \"]\"\n      );\n      result = {\n        ...result,\n        ...APP.dialog.downlinkBwe\n      };\n    }\n    return result;\n  }\n\n  async getCandidatesData(peer) {\n    const result = {};\n    const stats = await peer.getStats();\n    let selectedCandidatePairId = null;\n    if (!isFirefox) {\n      for (const data of stats.values()) {\n        if (data[\"type\"] === StatsType.TRANSPORT) {\n          selectedCandidatePairId = data[\"selectedCandidatePairId\"];\n        }\n      }\n    }\n    for (const data of stats.values()) {\n      if (data[\"type\"] === StatsType.CANDIDATE_PAIR) {\n        const candidatePair = data;\n        let isCandidate = false;\n        if (isFirefox) {\n          isCandidate = candidatePair && candidatePair[\"selected\"] && candidatePair[\"state\"] === \"succeeded\";\n        } else {\n          isCandidate = candidatePair[\"id\"] === selectedCandidatePairId;\n        }\n        if (isCandidate) {\n          for (const values of stats.values()) {\n            if (candidatePair[\"localCandidateId\"] === values[\"id\"]) {\n              result[StatsType.LOCAL_CANDIDATE] = values;\n            } else if (candidatePair[\"remoteCandidateId\"] === values[\"id\"]) {\n              result[StatsType.REMOTE_CANDIDATE] = values;\n            }\n          }\n        }\n      }\n    }\n    return result;\n  }\n\n  async getTransportData(type) {\n    const result = {};\n    let transport;\n    if (type === TransportType.SEND) {\n      transport = APP.dialog._sendTransport;\n    } else if (type === TransportType.RECEIVE) {\n      transport = APP.dialog._recvTransport;\n    }\n    const opened = (transport && !transport._closed && true) || false;\n    result[\"opened\"] = opened;\n    if (transport) {\n      result[\"state\"] = opened ? transport._connectionState : \"closed\";\n      result[\"id\"] = transport._id;\n      result[PRODUCERS_KEY] = [];\n      result[CONSUMERS_KEY] = [];\n      transport._producers.forEach(producer => {\n        result[PRODUCERS_KEY].push(this.getProducerConsumerData(producer));\n      });\n      transport._consumers.forEach(consumer => {\n        result[CONSUMERS_KEY].push(this.getProducerConsumerData(consumer));\n      });\n      opened && (result[\"candidates\"] = await this.getCandidatesData(transport));\n    }\n    return result;\n  }\n\n  profileFromPresence([, data]) {\n    const meta = data.metas[data.metas.length - 1];\n    return meta.profile;\n  }\n\n  profileFromConsumer(consumer) {\n    return Object.entries(this.props.presences || {})\n      .filter(([k]) => k === consumer._appData.peerId)\n      .map(this.profileFromPresence)\n      .shift();\n  }\n\n  getProducerConsumerData(peer) {\n    const result = {};\n    result[\"opened\"] = !peer._closed;\n    if (peer) {\n      const profile = Object.entries(this.props.presences || {})\n        .filter(([k]) => k === peer._appData.peerId)\n        .map(this.profileFromPresence)\n        .shift();\n      result[\"id\"] = peer._id;\n      result[\"paused\"] = peer._paused;\n      result[\"track\"] = this.getTrackData(peer);\n      result[\"kind\"] = peer._kind || result[\"track\"].kind;\n      result[\"codec\"] = peer.rtpParameters.codecs[0].mimeType.split(\"/\")[1];\n      result[\"name\"] = profile ? profile.displayName : \"N/A\";\n      result[\"peerId\"] = peer._appData.peerId;\n\n      const stats = APP.dialog.consumerStats[peer._id];\n      if (result[\"kind\"] === \"video\" && stats) {\n        result[\"spatialLayer\"] = stats[\"spatialLayer\"];\n        result[\"temporalLayer\"] = stats[\"temporalLayer\"];\n        result[\"score\"] = stats[\"score\"];\n      }\n    }\n    return result;\n  }\n\n  getTrackData(owner) {\n    const result = {};\n    result[\"id\"] = owner._track.id;\n    result[\"enabled\"] = (owner._track !== null && owner._track.enabled && true) || false;\n    result[\"kind\"] = owner._track.kind;\n    result[\"muted\"] = owner._track.muted;\n    result[\"state\"] = owner._track.readyState;\n    return result;\n  }\n\n  getSignalingData() {\n    return { connected: APP.dialog._protoo && APP.dialog._protoo.connected };\n  }\n\n  async getServerData() {\n    return await APP.dialog.getServerStats();\n  }\n\n  async getRtpStatsData(peer, type) {\n    const result = {};\n    const stats = await peer.getStats();\n    for (const data of stats.values()) {\n      if (data[\"type\"] === type) {\n        return data;\n      }\n    }\n    return result;\n  }\n\n  getGraphData(id, stats) {\n    let lastStats = this.state.statsData?.[id]?.last;\n    const bytesSent = stats?.bytesSent || 0;\n    const bytesReceived = stats?.bytesReceived || 0;\n    const packetsSent = stats?.packetsSent || 0;\n    const packetsReceived = stats?.packetsReceived || 0;\n    const timestamp = stats?.timestamp || 0;\n    const bytesSentDelta = bytesSent - lastStats?.bytesSent || 0;\n    const bytesReceivedDelta = bytesReceived - lastStats?.bytesReceived || 0;\n    const packetsSentDelta = packetsSent - lastStats?.packetsSent || 0;\n    const packetsReceivedDelta = packetsReceived - lastStats?.packetsReceived || 0;\n    const timeDelta = timestamp - lastStats?.timestamp || 0;\n    let graphData = this.state.statsData?.[id]?.graph;\n    if (!graphData) {\n      const data = new Array(20);\n      data.fill({\n        bytesSent: 0,\n        bytesReceived: 0,\n        packetsSent: 0,\n        packetsReceived: 0,\n        timeDelta: 0\n      });\n      graphData = data;\n    }\n    graphData.shift();\n    graphData.push({\n      bytesSent: bytesSentDelta,\n      bytesReceived: bytesReceivedDelta,\n      packetsSent: packetsSentDelta,\n      packetsReceived: packetsReceivedDelta,\n      timeDelta: timeDelta\n    });\n    lastStats = {\n      bytesSent,\n      bytesReceived,\n      packetsSent,\n      packetsReceived,\n      timestamp\n    };\n    return {\n      lastStats: lastStats,\n      graphData: graphData\n    };\n  }\n\n  /**\n   * @param {string} id Peer id.\n   * @param {string} key Stats key to use for generating the speed value.\n   */\n  getPeerSpeed(id, key) {\n    let speed = \"0.00\";\n    const graphData = this.state.statsData?.[id]?.graph;\n    if (graphData) {\n      const lastData = graphData[graphData.length - 1];\n      if (lastData) {\n        speed = ((lastData[key] / 1024) * (1 / (lastData.timeDelta / 1000)) || 0).toFixed(2);\n      }\n    }\n\n    return speed;\n  }\n\n  /**\n   * Starts/stops the execution of a perioding data updating task. Every time this is executed all the debugging panel data is\n   * gathered and the component state is updated to reflect the new data.\n   * @param {bool} running Sets the running state for this task, true starts the tas, false stops it.\n   */\n  async runStats(running) {\n    if (running && this.state) {\n      const taskId = setInterval(() => {\n        (async () => {\n          try {\n            const deviceData = this.getDeviceData();\n            const serverData = this.state.collapsed.Remote ? {} : await this.getServerData();\n            const signalingData = this.getSignalingData();\n\n            // Tranports data\n            const transportsData = {};\n            transportsData[TransportType.SEND] = await this.getTransportData(TransportType.SEND);\n            transportsData[TransportType.RECEIVE] = await this.getTransportData(TransportType.RECEIVE);\n\n            // Populate graph, speed and stats data\n            const statsData = {};\n            if (APP.dialog._micProducer) {\n              const id = APP.dialog._micProducer.id;\n              const peer = APP.dialog._micProducer;\n              const speedData = this.getPeerSpeed(id, \"bytesSent\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.OUTBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n            if (APP.dialog._cameraProducer) {\n              const id = APP.dialog._cameraProducer.id;\n              const peer = APP.dialog._cameraProducer;\n              const speedData = this.getPeerSpeed(id, \"bytesSent\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.OUTBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n            if (APP.dialog._shareProducer) {\n              const id = APP.dialog._shareProducer.id;\n              const peer = APP.dialog._shareProducer;\n              const speedData = this.getPeerSpeed(id, \"bytesSent\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.OUTBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n            for (const consumer of APP.dialog._consumers) {\n              const id = consumer[0];\n              const peer = consumer[1];\n              const speedData = this.getPeerSpeed(id, \"bytesReceived\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.INBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n\n            // Update state\n            this.setState({\n              signalingData,\n              serverData,\n              deviceData,\n              statsData,\n              transportsData\n            });\n          } catch (e) {\n            console.log(`Run Stats error: ${e}`);\n          }\n        })();\n      }, STATS_REFRESH_TIME);\n      this.setState({ taskId: taskId });\n    } else {\n      clearInterval(this.state.taskId);\n    }\n  }\n\n  restartSendICE = () => {\n    APP.dialog.restartSendICE();\n  };\n\n  restartRecvICE = () => {\n    APP.dialog.restartRecvICE();\n  };\n\n  connectSignaling = () => {\n    APP.dialog.connect({\n      serverUrl: APP.dialog._serverUrl,\n      roomId: APP.dialog._roomId,\n      joinToken: APP.hubChannel.token,\n      serverParams: APP.dialog._serverParams,\n      scene: APP.dialog.scene,\n      clientId: APP.dialog._clientId,\n      forceTcp: APP.dialog._forceTcp,\n      forceTurn: APP.dialog._forceTurn,\n      iceTransportPolicy: APP.dialog._iceTransportPolicy\n    });\n  };\n\n  disconnectSignaling = () => {\n    APP.dialog.disconnect();\n  };\n\n  colorForLevel = level => {\n    switch (level) {\n      case \"error\":\n        return \"red\";\n      case \"warn\":\n        return \"orange\";\n      default:\n        return \"white\";\n    }\n  };\n\n  createLogMsgs = () => {\n    const logLines = [];\n    this.state.log\n      ?.slice()\n      .reverse()\n      .forEach((log, index) => {\n        logLines.push(<span key={index << 2} className={classNames(styles.rtcLogTime)}>{`[${log.time}] `}</span>);\n        logLines.push(\n          <span key={(index << 2) | 0x01} className={classNames(styles.rtcLogTag)}>{`[${log.tag}] `}</span>\n        );\n        logLines.push(\n          <span\n            key={(index << 2) | 0x02}\n            className={classNames(styles.rtcLogMsg)}\n            style={{ color: this.colorForLevel(log.level) }}\n          >\n            {log.msg}\n          </span>\n        );\n        logLines.push(<br key={(index << 2) | 0x03} />);\n      });\n    return logLines;\n  };\n\n  createLog = () => {\n    const logLines = [];\n    this.state.log\n      ?.slice()\n      .reverse()\n      .forEach(log => {\n        logLines.push(`[${log.time}] [${log.tag}] ${log.msg}`);\n      });\n    return logLines.join(\"\\r\");\n  };\n\n  createCandidates(candidates) {\n    const components = [];\n    if (candidates) {\n      candidates[StatsType.LOCAL_CANDIDATE] &&\n        components.push(\n          <DataPanel\n            key={StatsType.LOCAL_CANDIDATE}\n            data={candidates[StatsType.LOCAL_CANDIDATE]}\n            title={\n              <FormattedMessage id=\"rtc-debug-panel.local-candidate-panel-title\" defaultMessage=\"Local Candidate\" />\n            }\n          />\n        );\n      candidates[StatsType.REMOTE_CANDIDATE] &&\n        components.push(\n          <DataPanel\n            key={StatsType.REMOTE_CANDIDATE}\n            data={candidates[StatsType.REMOTE_CANDIDATE]}\n            title={\n              <FormattedMessage id=\"rtc-debug-panel.remote-candidate-panel-title\" defaultMessage=\"Remote Candidate\" />\n            }\n          />\n        );\n    }\n    return components;\n  }\n\n  createProducers(producers = [], stats) {\n    return producers.map(producer => {\n      return (\n        <TrackStatsPanel\n          key={producer.id}\n          title={\n            <FormattedMessage\n              id=\"rtc-debug-panel.producer-panel-title\"\n              defaultMessage=\"{kind} Producer\"\n              values={{ kind: capitalize(producer?.kind) }}\n            />\n          }\n          data={producer}\n          xAxis={\"timeDelta\"}\n          yAxis={\"bytesSent\"}\n          stats={stats[producer.id]}\n        />\n      );\n    });\n  }\n\n  createConsumers(consumers, stats) {\n    const reducedConsumers =\n      consumers?.reduce((map, consumer) => {\n        map[consumer.peerId] = map[consumer.peerId] || {};\n        map[consumer.peerId][\"name\"] = consumer.name;\n        map[consumer.peerId][\"peerId\"] = consumer.peerId;\n        map[consumer.peerId][\"consumers\"] = map[consumer.peerId][\"consumers\"] || [];\n        map[consumer.peerId][\"consumers\"].push(consumer);\n        return map;\n      }, []) || [];\n    const components = [];\n    for (const [, reducedConsumer] of Object.entries(reducedConsumers)) {\n      const consumerPanels = reducedConsumer.consumers.map(consumer => {\n        return (\n          <TrackStatsPanel\n            key={consumer.id}\n            title={\n              <FormattedMessage\n                id=\"rtc-debug-panel.consumer-panel-title\"\n                defaultMessage=\"{kind} Consumer\"\n                values={{ kind: capitalize(consumer?.kind) }}\n              />\n            }\n            data={consumer}\n            xAxis={\"timeDelta\"}\n            yAxis={\"bytesReceived\"}\n            stats={stats[consumer.id]}\n          />\n        );\n      });\n      const error = reducedConsumer?.consumers?.some(consumer => {\n        return !consumer.opened || !stats[consumer.id]?.speed;\n      });\n      const backgroundColor = error ? ERROR_COLOR : null;\n      components.push(\n        <CollapsiblePanel\n          key={reducedConsumer.name}\n          title={reducedConsumer.name}\n          url={`${MEDIASOUP_DOC_BASE_URL}#Consumer`}\n          data={{ peerId: reducedConsumer.peerId }}\n          border\n          collapsed\n          backgroundColor={backgroundColor}\n        >\n          <CollapsiblePanel row>{consumerPanels}</CollapsiblePanel>\n        </CollapsiblePanel>\n      );\n    }\n    return components;\n  }\n\n  createRemoteTransports(data) {\n    const transports = [];\n    if (data) {\n      for (const transportId in data) {\n        const transport = data[transportId];\n        const producers = [];\n        if (transport?.producers) {\n          for (const producerId in transport.producers) {\n            const stats = transport.producers[producerId];\n            stats.forEach((stat, index) => {\n              producers.push(\n                <DataPanel\n                  key={`${producerId}${index}`}\n                  data={stat}\n                  title={\n                    <FormattedMessage\n                      id=\"rtc-debug-panel.producer-transport-stats-title\"\n                      defaultMessage=\"{kind} Stats\"\n                      values={{ kind: capitalize(stat.kind) }}\n                    />\n                  }\n                />\n              );\n            });\n          }\n        }\n        const consumers = [];\n        if (transport?.consumers) {\n          for (const consumerId in transport.consumers) {\n            const stats = transport.consumers[consumerId];\n            stats.forEach((stat, index) => {\n              consumers.push(\n                <DataPanel\n                  key={`${consumerId}${index}`}\n                  data={stat}\n                  title={\n                    <FormattedMessage\n                      id=\"rtc-debug-panel.consumer-transport-stats-title\"\n                      defaultMessage=\"{kind} Stats\"\n                      values={{ kind: capitalize(stat.kind) }}\n                    />\n                  }\n                />\n              );\n            });\n          }\n        }\n        transports.push(\n          <CollapsiblePanel\n            key={transportId}\n            title={`${transport.name} Transport`}\n            url={`${MDN_DOC_BASE_URL}RTCStatsReport`}\n            data={{ id: transportId }}\n            border\n          >\n            {(producers?.length && (\n              <CollapsiblePanel\n                key={`producers`}\n                title={\n                  <FormattedMessage\n                    id=\"rtc-debug-panel.producer-transport-stats-panel-title\"\n                    defaultMessage=\"Producer Stats\"\n                  />\n                }\n                row\n                wrap\n                url={`${MDN_DOC_BASE_URL}RTCStatsReport`}\n                border\n              >\n                {producers}\n              </CollapsiblePanel>\n            )) ||\n              null}\n            {(consumers?.length && (\n              <CollapsiblePanel\n                key={`consumers`}\n                title={\n                  <FormattedMessage\n                    id=\"rtc-debug-panel.consumer-transport-stats-panel-title\"\n                    defaultMessage=\"Consumer Stats\"\n                  />\n                }\n                row\n                wrap\n                url={`${MDN_DOC_BASE_URL}RTCStatsReport`}\n                border\n              >\n                {consumers}\n              </CollapsiblePanel>\n            )) ||\n              null}\n          </CollapsiblePanel>\n        );\n      }\n    }\n    return transports;\n  }\n\n  onCollapse = (id, isCollapsed) => {\n    const title = id?.props[\"defaultMessage\"];\n    const collapsed = { ...this.state.collapsed };\n    if (isMobile || window.innerWidth < 500) {\n      for (const key of Object.keys(collapsed)) {\n        if (title === key) {\n          collapsed[key] = isCollapsed;\n        } else {\n          if (!isCollapsed) {\n            collapsed[key] = true;\n          }\n        }\n      }\n    } else {\n      collapsed[title] = isCollapsed;\n    }\n    this.setState({\n      collapsed\n    });\n  };\n\n  render() {\n    const { signalingData, serverData, statsData, deviceData, transportsData, collapsed } = this.state;\n    const isNarrow = isMobile || window.innerWidth < 500;\n    return (\n      <div>\n        <div className={classNames(styles.rtcDebugPanelRoot)}>\n          <div\n            className={classNames(styles.rtcStatusContainerLeft)}\n            style={{\n              height: isNarrow && !collapsed.Local && \"80%\",\n              maxHeight: isNarrow && !collapsed.Local && \"80%\"\n            }}\n          >\n            {this.props.showRtcDebug && (\n              <CollapsiblePanel\n                title={<FormattedMessage id=\"rtc-debug-panel.local-panel-title\" defaultMessage=\"Local\" />}\n                isRoot\n                border\n                grow\n                collapsed={collapsed.Local}\n                onCollapse={this.onCollapse}\n              >\n                {deviceData && (\n                  <CollapsiblePanel\n                    title={<FormattedMessage id=\"rtc-debug-panel.device-panel-title\" defaultMessage=\"Device\" />}\n                    border\n                    url={`${MEDIASOUP_DOC_BASE_URL}#Device`}\n                    data={deviceData}\n                  />\n                )}\n                {signalingData && (\n                  <SignalingPanel\n                    data={signalingData}\n                    onConnect={this.connectSignaling}\n                    onDisconnect={this.disconnectSignaling}\n                  />\n                )}\n                <div style={{ display: \"flex\", flexFlow: \"column\" }}>\n                  <TransportPanel\n                    title={\n                      <FormattedMessage\n                        id=\"rtc-debug-panel.send-transport-panel-title\"\n                        defaultMessage=\"Send Transport\"\n                      />\n                    }\n                    data={{\n                      id: transportsData?.[TransportType.SEND]?.id,\n                      opened: transportsData?.[TransportType.SEND]?.opened,\n                      state: transportsData?.[TransportType.SEND]?.state\n                    }}\n                    candidates={this.createCandidates(transportsData?.[TransportType.SEND]?.candidates)}\n                    producers={this.createProducers(transportsData?.[TransportType.SEND]?.producers, statsData)}\n                    onRestart={this.restartSendICE}\n                    isButtonEnabled={transportsData?.[TransportType.SEND]?.opened}\n                  />\n                </div>\n                <div style={{ display: \"flex\", flexFlow: \"column\" }}>\n                  <TransportPanel\n                    title={\n                      <FormattedMessage\n                        id=\"rtc-debug-panel.receive-transport-panel-title\"\n                        defaultMessage=\"Receive Transport\"\n                      />\n                    }\n                    data={{\n                      id: transportsData?.[TransportType.RECEIVE]?.id,\n                      opened: transportsData?.[TransportType.RECEIVE]?.opened,\n                      state: transportsData?.[TransportType.RECEIVE]?.state\n                    }}\n                    candidates={this.createCandidates(transportsData?.[TransportType.RECEIVE]?.candidates)}\n                    consumers={this.createConsumers(transportsData?.[TransportType.RECEIVE]?.consumers, statsData)}\n                    onRestart={this.restartRecvICE}\n                    isButtonEnabled={transportsData?.[TransportType.RECEIVE]?.opened}\n                  />\n                </div>\n              </CollapsiblePanel>\n            )}\n          </div>\n          <div className={classNames(styles.statusContainerMiddle)}>\n            {this.props.showAudioDebug && (\n              <AudioDebugPanel isNarrow collapsed={collapsed.Audio} onCollapsed={this.onCollapse} />\n            )}\n            {this.props.showRtcDebug && (\n              <div\n                className={classNames(styles.rtcLogContainer)}\n                style={{\n                  height: isNarrow && !collapsed.Log && \"80%\",\n                  maxHeight: isNarrow && !collapsed.Log && \"80%\"\n                }}\n              >\n                <CollapsiblePanel\n                  title={<FormattedMessage id=\"rtc-debug-panel.log-panel-title\" defaultMessage=\"Log\" />}\n                  isRoot\n                  border\n                  grow\n                  collapsed={collapsed.Log}\n                  onCollapse={this.onCollapse}\n                  clear={() => {\n                    this.setState({\n                      log: []\n                    });\n                  }}\n                  download={() => {\n                    download(\"rtc_log.txt\", this.createLog());\n                  }}\n                >\n                  <p className={classNames(styles.rtcLogMsgContainer)}>{this.createLogMsgs()}</p>\n                </CollapsiblePanel>\n              </div>\n            )}\n          </div>\n          <div\n            className={classNames(styles.rtcStatusContainerRight)}\n            style={{\n              height: isNarrow && !collapsed.Remote && \"80%\",\n              maxHeight: isNarrow && !collapsed.Remote && \"80%\"\n            }}\n          >\n            {this.props.showRtcDebug && (\n              <CollapsiblePanel\n                title={<FormattedMessage id=\"rtc-debug-panel.remote-panel-title\" defaultMessage=\"Remote\" />}\n                isRoot\n                border\n                grow\n                collapsed={collapsed.Remote}\n                onCollapse={this.onCollapse}\n              >\n                {this.createRemoteTransports(serverData)}\n              </CollapsiblePanel>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","export default function maskEmail(email) {\n  if (!email) return \"\";\n  const emailParts = email.split(\"@\");\n  const emailIdentity = emailParts[0];\n  const emailDomain = emailParts[1];\n  const truncatedIdentity = emailIdentity.substring(0, Math.min(emailIdentity.length, 3));\n  return `${truncatedIdentity}...@${emailDomain}`;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"loading-screen-layout\":\"LoadingScreenLayout__loading-screen-layout__Tybb0\",\"loadingScreenLayout\":\"LoadingScreenLayout__loading-screen-layout__Tybb0\",\"center\":\"LoadingScreenLayout__center__HTsFi\",\"logo\":\"LoadingScreenLayout__logo__r1f8O\",\"bottom\":\"LoadingScreenLayout__bottom__Ivx3e\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHmcLogo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 666.667,\n    height: 266.667,\n    viewBox: \"0 0 500 200\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M283.6 96.7c-4.3 17.5-8 32.6-8.2 33.5-.5 1.6.3 1.8 7.5 1.8 4.5 0 8.1-.2 8.1-.5 0-1.3 6.1-29 6.5-29.4.7-.6.2-1.3 9.6 14.7 7.4 12.6 8.5 14.1 9.7 12.5.7-.9 4.4-7.5 8.3-14.5 3.9-7 7.4-12.8 7.8-12.8.4 0 2.3 6.6 4.2 14.7l3.5 14.8 8.1.3 8 .3-8.1-33c-4.4-18.2-8.4-33.1-8.7-33.1-.3 0-5.7 8.4-11.9 18.6-6.3 10.2-11.7 18.7-12 18.9-.3.2-5.9-8.4-12.5-19.1-6.5-10.7-11.9-19.4-12-19.4-.1 0-3.7 14.3-7.9 31.7z\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M364 71v6h17c9.4 0 17 .2 17 .5 0 .2-8.1 12.4-18 26.9-9.9 14.5-18 26.7-18 27 0 .3 14.2.6 31.5.6H425v-12h-18c-12.1 0-18-.4-18-1.1 0-.6 1.1-2.5 2.3-4.2 1.3-1.8 9.4-13.7 18-26.5L425 65h-61v6z\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M261 75.5c0 .8-.4 1.5-1 1.5-.5 0-1.2 1.1-1.6 2.5-.3 1.4-1 2.5-1.4 2.5-1.8 0-1.7 4.6.2 8.3 2.9 5.7 2.2 14.9-1.4 20.5-3.3 4.9-11.4 9.2-17.3 9.2-6 0-14-4.3-17.3-9.3-2.3-3.5-2.7-5.1-2.7-11.4 0-4-.1-7.3-.2-7.3s-1.4 3.9-2.9 8.7c-1.5 4.9-3.7 10.9-4.9 13.5l-2.3 4.7 4.5 4.5c4.9 5 12.7 9.2 18.9 10.2 4.1.6 4.2.5 4.9-2.5.9-4 2.5-4 2.5 0 0 3.1 0 3.2 4.4 2.7 9.9-1.1 21.9-9.5 26.4-18.5 5-9.8 5.2-20.5.6-30.4-3.6-7.6-9.4-13.5-9.4-9.4z\"\n  })));\n};\n\nexport { SvgHmcLogo as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport configs from \"../../utils/configs\";\nimport { ReactComponent as HmcLogo } from \"../icons/HmcLogo.svg\";\nimport { isHmc } from \"../../utils/isHmc\";\nimport { useLogo } from \"../styles/theme\";\n\nexport function AppLogo({ className, forceConfigurableLogo }) {\n  const logo = useLogo();\n  if (isHmc() && !forceConfigurableLogo) {\n    return <HmcLogo className=\"hmc-logo\" />;\n  } else {\n    return <img className={className} alt={configs.translation(\"app-name\")} src={logo} />;\n  }\n}\n\nAppLogo.propTypes = {\n  className: PropTypes.string,\n  forceConfigurableLogo: PropTypes.bool\n};\n","import configs from \"./configs\";\n\nexport function isHmc() {\n  // We use show_cloud as a proxy for whether we are running on HMC versus Hubs Cloud,\n  // since show_cloud is an internal config that is typically only enabled on HMC.\n  return configs.feature(\"show_cloud\");\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./LoadingScreenLayout.scss\";\nimport { Column } from \"../layout/Column\";\nimport { AppLogo } from \"../misc/AppLogo\";\n\nexport function LoadingScreenLayout({ center, bottom }) {\n  return (\n    <div className={styles.loadingScreenLayout}>\n      <Column center padding gap=\"lg\" className={styles.center}>\n        <AppLogo className={styles.logo} />\n        {center}\n      </Column>\n      {bottom && (\n        <Column center className={styles.bottom}>\n          {bottom}\n        </Column>\n      )}\n    </div>\n  );\n}\n\nLoadingScreenLayout.propTypes = {\n  center: PropTypes.node,\n  bottom: PropTypes.node\n};\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSpinner = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 70,\n    height: 70,\n    viewBox: \"0 0 70 70\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.284 57.665A32.14 32.14 0 0 1 3.39 40.032a32.311 32.311 0 0 1 3.065-19.547A31.861 31.861 0 0 1 20.307 6.49a31.414 31.414 0 0 1 19.349-3.096m18.06 8.94a32.14 32.14 0 0 1 8.894 17.634 32.311 32.311 0 0 1-3.065 19.548A31.86 31.86 0 0 1 49.693 63.51a31.413 31.413 0 0 1-19.348 3.096\",\n    stroke: \"currentColor\",\n    strokeWidth: 6\n  })));\n};\n\nexport { SvgSpinner as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"spinner\":\"Spinner__spinner__jvUtq\"};","import React from \"react\";\nimport { ReactComponent as SpinnerSvg } from \"./Spinner.svg\";\nimport styles from \"./Spinner.scss\";\n\nexport function Spinner() {\n  return <SpinnerSvg className={styles.spinner} />;\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { LoadingScreenLayout } from \"../layout/LoadingScreenLayout\";\nimport { Spinner } from \"../misc/Spinner\";\nimport { useRandomMessageTransition } from \"./useRandomMessageTransition\";\nexport function LoadingScreen({ message, infoMessages }) {\n  const infoMessage = useRandomMessageTransition(infoMessages);\n  return (\n    <LoadingScreenLayout\n      center={\n        <>\n          <Spinner />\n          <p>{message}</p>\n        </>\n      }\n      bottom={\n        <>\n          <h3>{infoMessage.heading}</h3>\n          <p>{infoMessage.message}</p>\n        </>\n      }\n    />\n  );\n}\n\nLoadingScreen.propTypes = {\n  message: PropTypes.node,\n  infoMessages: PropTypes.arrayOf(\n    PropTypes.shape({\n      heading: PropTypes.node.isRequired,\n      message: PropTypes.node.isRequired\n    })\n  )\n};\n\nLoadingScreen.defaultProps = {\n  infoMessages: []\n};\n","import { useEffect, useState, useRef, useCallback } from \"react\";\n\nexport function useRandomMessageTransition(messages, transitionDelay = 5000) {\n  const messageTimeoutRef = useRef();\n  const [index, setIndex] = useState(Math.round(Math.random() * (messages.length - 1)));\n\n  const queueNextMessage = useCallback(\n    () => {\n      messageTimeoutRef.current = setTimeout(() => {\n        setIndex(currentIndex => (currentIndex + 1) % messages.length);\n        queueNextMessage();\n      }, transitionDelay);\n    },\n    [setIndex, messages, transitionDelay]\n  );\n\n  useEffect(\n    () => {\n      queueNextMessage();\n\n      return () => {\n        clearTimeout(messageTimeoutRef.current);\n      };\n    },\n    [queueNextMessage]\n  );\n\n  return messages[index];\n}\n","import { useEffect, useReducer, useRef, useCallback } from \"react\";\nimport { useIntl, defineMessages } from \"react-intl\";\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"object-loading\":\n      return { ...state, objectCount: state.objectCount + 1, messageKey: \"loadingObjects\" };\n    case \"object-loaded\":\n      return { ...state, loadedCount: state.loadedCount + 1 };\n    case \"all-objects-loaded\":\n      return {\n        ...state,\n        allObjectsLoaded: true,\n        loading: !(state.environmentLoaded && state.networkConnected),\n        messageKey: state.environmentLoaded ? \"enteringRoom\" : \"loadingObjects\"\n      };\n    case \"environment-loaded\": {\n      const loaded = state.lazyLoadMedia\n        ? state.networkConnected && state.dialogConnected\n        : state.allObjectsLoaded && state.networkConnected && state.dialogConnected;\n      return {\n        ...state,\n        environmentLoaded: true,\n        loading: !loaded,\n        messageKey: state.lazyLoadMedia\n          ? loaded\n            ? \"enteringRoom\"\n            : \"connectingScene\"\n          : loaded\n            ? \"enteringRoom\"\n            : \"loadingObjects\"\n      };\n    }\n    case \"network-connected\":\n      return {\n        ...state,\n        networkConnected: true,\n        loading: state.lazyLoadMedia\n          ? !(state.environmentLoaded && state.dialogConnected)\n          : !(state.environmentLoaded && state.allObjectsLoaded && state.dialogConnected)\n      };\n    case \"dialog-connected\":\n      return {\n        ...state,\n        dialogConnected: true,\n        loading: state.lazyLoadMedia\n          ? !(state.environmentLoaded && state.networkConnected)\n          : !(state.environmentLoaded && state.allObjectsLoaded && state.networkConnected)\n      };\n  }\n}\n\n// defineMessages informs babel-plugin-react-intl what i18n data can be stripped/embedded when bundling.\nconst messages = defineMessages({\n  default: {\n    id: \"loading-screen.default\",\n    description: \"The scene has started loading.\",\n    defaultMessage: \"Loading scene...\"\n  },\n  loadingObjects: {\n    id: \"loading-screen.loading-objects\",\n    description: \"The loading progress. How many objects have finished loading?\",\n    defaultMessage: \"Loading objects {loadedCount}/{objectCount}\"\n  },\n  connectingScene: {\n    id: \"loading-screen.connecting\",\n    description: \"The scene is loaded, we are waiting for the networked scene to be connected to enter.\",\n    defaultMessage: \"Connecting to the scene...\"\n  },\n  enteringRoom: {\n    id: \"loading-screen.entering-room\",\n    description:\n      \"Once the scene has finished loading, this message tells uses that they will be entering the room shortly.\",\n    defaultMessage: \"Entering room...\"\n  }\n});\n\nexport function useRoomLoadingState(sceneEl) {\n  // Holds the id of the current\n  const loadingTimeoutRef = useRef();\n  const lazyLoadMedia = APP.store.state.preferences.lazyLoadSceneMedia;\n\n  const [{ loading, messageKey, objectCount, loadedCount }, dispatch] = useReducer(reducer, {\n    loading: !sceneEl.is(\"loaded\"),\n    messageKey: \"default\",\n    objectCount: 0,\n    loadedCount: 0,\n    allObjectsLoaded: false,\n    environmentLoaded: false,\n    networkConnected: false,\n    dialogConnected: false,\n    lazyLoadMedia\n  });\n\n  const onObjectLoading = useCallback(\n    () => {\n      clearTimeout(loadingTimeoutRef.current);\n      dispatch({ type: \"object-loading\" });\n    },\n    [dispatch]\n  );\n\n  const onObjectLoaded = useCallback(\n    () => {\n      clearTimeout(loadingTimeoutRef.current);\n\n      dispatch({ type: \"object-loaded\" });\n\n      // Objects can start loading as a result of loading another object. Wait 1.5 seconds before calling\n      // all-objects-loaded to try to catch loading all objects.\n      // TODO: Determine a better way to ensure the object dependency chain has resolved, or switch to a\n      // progressive loading model where all objects don't have to be loaded to enter the room.\n      loadingTimeoutRef.current = setTimeout(() => {\n        dispatch({ type: \"all-objects-loaded\" });\n      }, 1500);\n    },\n    [dispatch]\n  );\n\n  const onEnvironmentLoaded = useCallback(\n    () => {\n      dispatch({ type: \"environment-loaded\" });\n    },\n    [dispatch]\n  );\n\n  const onNetworkConnected = useCallback(\n    () => {\n      dispatch({ type: \"network-connected\" });\n    },\n    [dispatch]\n  );\n\n  const onDialogConnected = useCallback(\n    () => {\n      dispatch({ type: \"dialog-connected\" });\n    },\n    [dispatch]\n  );\n\n  useEffect(\n    () => {\n      // Once the scene has loaded the dependencies to this hook will change,\n      // the event listeners will be removed, and we can prevent adding them again.\n      if (loading) {\n        if (!lazyLoadMedia) {\n          sceneEl.addEventListener(\"model-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"image-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"pdf-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"video-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"model-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"image-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"pdf-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"video-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"model-error\", onObjectLoaded);\n        }\n        sceneEl.addEventListener(\"environment-scene-loaded\", onEnvironmentLoaded);\n        sceneEl.addEventListener(\"didConnectToNetworkedScene\", onNetworkConnected);\n        sceneEl.addEventListener(\"didConnectToDialog\", onDialogConnected);\n      }\n\n      return () => {\n        if (!lazyLoadMedia) {\n          sceneEl.removeEventListener(\"model-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"image-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"pdf-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"video-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"model-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"image-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"pdf-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"video-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"model-error\", onObjectLoaded);\n        }\n        sceneEl.removeEventListener(\"environment-scene-loaded\", onEnvironmentLoaded);\n        sceneEl.removeEventListener(\"didConnectToNetworkedScene\", onNetworkConnected);\n        sceneEl.removeEventListener(\"didConnectToDialog\", onDialogConnected);\n      };\n    },\n    [\n      sceneEl,\n      loading,\n      onObjectLoaded,\n      onObjectLoading,\n      onEnvironmentLoaded,\n      onNetworkConnected,\n      onDialogConnected,\n      lazyLoadMedia\n    ]\n  );\n\n  const intl = useIntl();\n\n  const message = intl.formatMessage(messages[messageKey], {\n    // Never show a loaded count that's greater than the object count\n    loadedCount: Math.min(loadedCount, objectCount),\n    objectCount\n  });\n\n  useEffect(\n    () => {\n      if (!loading) {\n        // The loaded state on the scene signifies that the loading screen is no longer visible,\n        // the initial scene was loaded, and the network connection is established.\n        sceneEl.addState(\"loaded\");\n      }\n    },\n    [sceneEl, loading]\n  );\n\n  // Ensure timeout is cleared on unmount.\n  useEffect(() => {\n    () => {\n      clearTimeout(loadingTimeoutRef.current);\n    };\n  }, []);\n\n  return { loading, message };\n}\n","import React, { useEffect, useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useIntl } from \"react-intl\";\nimport { LoadingScreen } from \"./LoadingScreen\";\nimport { useRoomLoadingState } from \"./useRoomLoadingState\";\n\nexport function LoadingScreenContainer({ onLoaded, scene }) {\n  const intl = useIntl();\n\n  const { loading, message } = useRoomLoadingState(scene);\n\n  useEffect(\n    () => {\n      if (!loading) {\n        onLoaded();\n      }\n    },\n    [loading, onLoaded]\n  );\n\n  //TODO: Make these configurable\n  const infoMessages = useMemo(\n    () => [\n      {\n        heading: intl.formatMessage({ id: \"loading-screen.heading.tip\", defaultMessage: \"Tip:\" }),\n        message: intl.formatMessage({\n          id: \"loading-screen.message.keyboard-controls\",\n          defaultMessage: \"Press the Q & E keys to turn left and right.\"\n        })\n      },\n      {\n        heading: intl.formatMessage({ id: \"loading-screen.heading.whats-new\", defaultMessage: \"What's New?\" }),\n        message: intl.formatMessage(\n          {\n            id: \"loading-screen.message.whats-new\",\n            defaultMessage: \"You can now set the default locale in your preferences. <a>Read More</a>\"\n          },\n          {\n            // eslint-disable-next-line react/display-name\n            a: chunks => (\n              <a href=\"/whats-new\" target=\"_blank\">\n                {chunks}\n              </a>\n            )\n          }\n        )\n      }\n    ],\n    [intl]\n  );\n\n  return <LoadingScreen message={message} infoMessages={infoMessages} />;\n}\n\nLoadingScreenContainer.propTypes = {\n  scene: PropTypes.object.isRequired,\n  onLoaded: PropTypes.func.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"room-layout\":\"RoomLayout__room-layout__kTC2f\",\"roomLayout\":\"RoomLayout__room-layout__kTC2f\",\"main\":\"RoomLayout__main__YsUq9\",\"sidebar\":\"RoomLayout__sidebar__c3nxk\",\"viewport\":\"RoomLayout__viewport__UVY6l\",\"toolbar\":\"RoomLayout__toolbar__HAuuI\",\"modal-container\":\"RoomLayout__modal-container__Zn2lB\",\"modalContainer\":\"RoomLayout__modal-container__Zn2lB\",\"scene\":\"RoomLayout__scene__higS0\",\"object-focused\":\"RoomLayout__object-focused__w_gE0\",\"objectFocused\":\"RoomLayout__object-focused__w_gE0\",\"streaming\":\"RoomLayout__streaming__e4Nkj\"};","// extracted by mini-css-extract-plugin\nexport default {\"toolbar\":\"Toolbar__toolbar__YcMAi\",\"content\":\"Toolbar__content__fDPmA\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Toolbar.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\n\nexport function Toolbar({ className, left, center, right, ...rest }) {\n  return (\n    <div className={classNames(styles.toolbar, className)} {...rest}>\n      <div className={classNames(styles.content, styles.leftContent, styleUtils.showLg)}>{left}</div>\n      <div className={classNames(styles.content, styles.centerContent)}>{center}</div>\n      <div className={classNames(styles.content, styles.rightContent, styleUtils.showLg)}>{right}</div>\n    </div>\n  );\n}\n\nToolbar.propTypes = {\n  className: PropTypes.string,\n  left: PropTypes.node,\n  center: PropTypes.node,\n  right: PropTypes.node,\n  hideLeft: PropTypes.string,\n  hideRight: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./RoomLayout.scss\";\nimport { Toolbar } from \"./Toolbar\";\n\nexport function RoomLayout({\n  className,\n  viewportClassName,\n  sidebar,\n  sidebarClassName,\n  toolbarLeft,\n  toolbarCenter,\n  toolbarRight,\n  toolbarClassName,\n  modal,\n  viewport,\n  objectFocused,\n  streaming,\n  viewportRef,\n  ...rest\n}) {\n  return (\n    <div className={classNames(styles.roomLayout, { [styles.objectFocused]: objectFocused }, className)} {...rest}>\n      {sidebar && <div className={classNames(styles.sidebar, sidebarClassName)}>{sidebar}</div>}\n      <div className={classNames(styles.modalContainer, styles.viewport)}>{modal}</div>\n      {(toolbarLeft || toolbarCenter || toolbarRight) && (\n        <Toolbar\n          className={classNames(styles.main, styles.toolbar, toolbarClassName)}\n          left={toolbarLeft}\n          center={toolbarCenter}\n          right={toolbarRight}\n        />\n      )}\n      <div\n        className={classNames(styles.main, styles.viewport, { [styles.streaming]: streaming }, viewportClassName)}\n        ref={viewportRef}\n      >\n        {viewport}\n      </div>\n    </div>\n  );\n}\n\nRoomLayout.propTypes = {\n  className: PropTypes.string,\n  viewportClassName: PropTypes.string,\n  sidebar: PropTypes.node,\n  sidebarClassName: PropTypes.string,\n  toolbarLeft: PropTypes.node,\n  toolbarCenter: PropTypes.node,\n  toolbarRight: PropTypes.node,\n  toolbarClassName: PropTypes.string,\n  modal: PropTypes.node,\n  viewport: PropTypes.node,\n  objectFocused: PropTypes.bool,\n  streaming: PropTypes.bool,\n  viewportRef: PropTypes.any\n};\n","import React, { useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { RoomLayout } from \"../layout/RoomLayout\";\nimport { useResizeViewport } from \"./useResizeViewport\";\n\nexport function RoomLayoutContainer({ store, scene, ...rest }) {\n  const viewportRef = useRef();\n\n  useResizeViewport(viewportRef, store, scene);\n\n  return <RoomLayout viewportRef={viewportRef} {...rest} />;\n}\n\nRoomLayoutContainer.propTypes = {\n  store: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired\n};\n","import { useState, useEffect } from \"react\";\n// ResizeObserver not currently supported in Firefox Android\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport {\n  addOrientationChangeListener,\n  removeOrientationChangeListener,\n  getMaxResolutionWidth,\n  getMaxResolutionHeight\n} from \"../../utils/screen-orientation-utils\";\n\nfunction calculateRendererSize(canvasRect, maxResolution, isVR) {\n  if (isVR) {\n    return canvasRect;\n  }\n\n  // canvasRect values are CSS pixels based while\n  // maxResolution values are physical pixels based (CSS pixels * pixel ratio).\n  // Convert maxResolution values to CSS pixels based.\n  const pixelRatio = window.devicePixelRatio;\n  const maxWidth = maxResolution.width / pixelRatio;\n  const maxHeight = maxResolution.height / pixelRatio;\n\n  if (canvasRect.width <= maxWidth && canvasRect.height <= maxHeight) {\n    return canvasRect;\n  }\n\n  const conversionRatio = Math.min(maxWidth / canvasRect.width, maxHeight / canvasRect.height);\n\n  return {\n    width: Math.round(canvasRect.width * conversionRatio),\n    height: Math.round(canvasRect.height * conversionRatio)\n  };\n}\n\nexport function useResizeViewport(viewportRef, store, scene) {\n  const [maxResolution, setMaxResolution] = useState({\n    width: getMaxResolutionWidth(store),\n    height: getMaxResolutionHeight(store)\n  });\n\n  useEffect(\n    () => {\n      function onStoreChanged() {\n        setMaxResolution({\n          width: getMaxResolutionWidth(store),\n          height: getMaxResolutionHeight(store)\n        });\n      }\n\n      onStoreChanged();\n\n      store.addEventListener(\"statechanged\", onStoreChanged);\n\n      return () => {\n        store.removeEventListener(\"statechanged\", onStoreChanged);\n      };\n    },\n    [store]\n  );\n\n  useEffect(\n    () => {\n      const observer = new ResizeObserver(entries => {\n        const isPresenting = scene.renderer.xr.isPresenting;\n        const isVRPresenting = scene.renderer.xr.enabled && isPresenting;\n\n        // Do not update renderer, if a camera or a canvas have not been injected.\n        // In VR mode, three handles canvas resize based on the dimensions returned by\n        // the getEyeParameters function of the WebVR API. These dimensions are independent of\n        // the window size, therefore should not be overwritten with the window's width and\n        // height, // except when in fullscreen mode.\n        if (!scene.camera || !scene.canvas || (scene.is(\"vr-mode\") && (scene.isMobile || isVRPresenting))) {\n          return;\n        }\n\n        const canvasRect = entries[0].contentRect;\n\n        const rendererSize = calculateRendererSize(canvasRect, maxResolution, isVRPresenting);\n\n        const canvas = scene.canvas;\n        canvas.style.width = canvasRect.width + \"px\";\n        canvas.style.height = canvasRect.height + \"px\";\n\n        scene.renderer.setSize(rendererSize.width, rendererSize.height, false);\n\n        scene.camera.aspect = rendererSize.width / rendererSize.height;\n        scene.camera.updateProjectionMatrix();\n\n        // Resizing the canvas clears it, so render immediately after resize to prevent flicker.\n        scene.renderer.render(scene.object3D, scene.camera);\n\n        scene.emit(\"rendererresize\", null, false);\n      });\n\n      observer.observe(viewportRef.current);\n\n      return () => {\n        observer.disconnect();\n      };\n    },\n    [viewportRef, scene, maxResolution]\n  );\n\n  useEffect(\n    () => {\n      function onOrientationChange() {\n        setMaxResolution({\n          width: getMaxResolutionWidth(store),\n          height: getMaxResolutionHeight(store)\n        });\n      }\n\n      addOrientationChangeListener(onOrientationChange);\n\n      return () => {\n        removeOrientationChangeListener(onOrientationChange);\n      };\n    },\n    [store]\n  );\n}\n","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgEnter = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875 6.875V5.312A1.563 1.563 0 0 1 8.438 3.75h8.124a1.563 1.563 0 0 1 1.563 1.562v9.375a1.562 1.562 0 0 1-1.563 1.563H8.438a1.562 1.562 0 0 1-1.562-1.563v-1.562\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.625 13.125 13.75 10l-3.125-3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.875 10h11.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgEnter as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVr = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.714 4H2.033C1.466 4 1 4.466 1 5.033v9.506c0 .567.466 1.032 1.033 1.032h4.464c.557 0 1.043-.354 1.215-.88l1.063-3.18c.395-1.173 2.045-1.173 2.44 0l1.063 3.18c.172.526.668.88 1.225.88h4.464c.567 0 1.033-.465 1.033-1.032V5.286C19 4.577 18.423 4 17.714 4ZM6.477 11.471c-1.782.891-3.553-.87-2.663-2.662.152-.314.405-.567.72-.719 1.781-.89 3.553.87 2.662 2.662a1.643 1.643 0 0 1-.72.72Zm9 0c-1.782.891-3.553-.87-2.663-2.662.152-.314.405-.567.72-.719 1.781-.89 3.553.87 2.662 2.662a1.643 1.643 0 0 1-.72.72Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgVr as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgShow = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.987 4.375c-3.045 0-6.168 1.762-8.626 5.286a.625.625 0 0 0-.011.695c1.89 2.957 4.97 5.27 8.637 5.27 3.626 0 6.77-2.32 8.663-5.284a.63.63 0 0 0 0-.683c-1.896-2.93-5.064-5.284-8.663-5.284Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 13.125a3.125 3.125 0 1 0 0-6.25 3.125 3.125 0 0 0 0 6.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgShow as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSettings = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.84 9.464 16.823 9.3a.313.313 0 0 1-.258-.267c-.02-.125-.039-.25-.066-.371a.315.315 0 0 1 .152-.337l.902-.5a.314.314 0 0 0 .152-.388l-.156-.43a.31.31 0 0 0-.367-.195l-1.012.195a.313.313 0 0 1-.335-.16 7.177 7.177 0 0 0-.188-.329.319.319 0 0 1 .028-.372l.675-.779a.313.313 0 0 0 .012-.415l-.293-.351a.308.308 0 0 0-.41-.06l-.886.533a.312.312 0 0 1-.367-.035 8.649 8.649 0 0 0-.289-.243.312.312 0 0 1-.098-.356l.367-.966a.312.312 0 0 0-.126-.397l-.399-.23a.312.312 0 0 0-.406.086l-.65.814a.28.28 0 0 1-.332.097s-.218-.09-.383-.145a.312.312 0 0 1-.213-.3l.015-1.034a.315.315 0 0 0-.257-.329l-.453-.078a.315.315 0 0 0-.356.22l-.336.978a.312.312 0 0 1-.304.211h-.383a.315.315 0 0 1-.304-.211l-.336-.978a.315.315 0 0 0-.355-.22l-.453.078a.315.315 0 0 0-.258.33l.016 1.033a.312.312 0 0 1-.215.3c-.09.036-.285.11-.379.146-.109.039-.238.007-.343-.114l-.645-.795a.313.313 0 0 0-.406-.084l-.399.23a.31.31 0 0 0-.129.395l.368.967a.315.315 0 0 1-.098.355c-.098.079-.195.16-.29.243a.312.312 0 0 1-.366.035l-.873-.54a.312.312 0 0 0-.41.059l-.293.351a.313.313 0 0 0 .012.415l.675.78a.312.312 0 0 1 .027.371 3.948 3.948 0 0 0-.187.329.317.317 0 0 1-.336.16l-1.011-.195a.312.312 0 0 0-.367.195l-.156.43a.314.314 0 0 0 .152.387l.9.501a.31.31 0 0 1 .153.337c-.023.125-.047.247-.066.372a.316.316 0 0 1-.258.266l-1.019.164a.316.316 0 0 0-.277.31v.457a.307.307 0 0 0 .277.31l1.019.164a.312.312 0 0 1 .258.266c.02.125.039.25.066.372a.315.315 0 0 1-.152.336l-.902.502a.314.314 0 0 0-.153.387l.157.43a.31.31 0 0 0 .367.195l1.011-.195a.313.313 0 0 1 .336.16c.058.11.12.22.187.33a.319.319 0 0 1-.027.371l-.676.78a.313.313 0 0 0-.011.415l.292.351a.308.308 0 0 0 .41.06l.887-.533a.313.313 0 0 1 .367.035c.093.082.191.164.289.243a.313.313 0 0 1 .097.356l-.367.966a.312.312 0 0 0 .13.396l.398.23a.313.313 0 0 0 .405-.086l.656-.806c.082-.101.215-.144.32-.101.133.054.223.085.387.14a.313.313 0 0 1 .215.302l-.016 1.033a.315.315 0 0 0 .258.329l.453.078a.316.316 0 0 0 .355-.22l.336-.976a.313.313 0 0 1 .304-.211h.383a.315.315 0 0 1 .304.211l.336.977a.316.316 0 0 0 .356.219l.453-.078a.315.315 0 0 0 .257-.33l-.015-1.032a.312.312 0 0 1 .214-.302c.164-.055.274-.098.375-.137.102-.039.227-.039.325.082l.663.818a.312.312 0 0 0 .408.086l.398-.231a.31.31 0 0 0 .13-.396l-.368-.966a.315.315 0 0 1 .098-.357c.097-.078.195-.16.289-.242a.312.312 0 0 1 .367-.035l.883.534a.312.312 0 0 0 .41-.06l.293-.35a.312.312 0 0 0-.012-.416l-.676-.779a.312.312 0 0 1-.027-.372c.066-.105.129-.214.188-.328a.318.318 0 0 1 .335-.16l1.012.195a.312.312 0 0 0 .367-.196l.156-.43a.315.315 0 0 0-.152-.387l-.902-.5a.31.31 0 0 1-.153-.337c.024-.125.047-.247.067-.372a.315.315 0 0 1 .257-.266l1.02-.164a.316.316 0 0 0 .277-.31v-.458a.323.323 0 0 0-.284-.302ZM10 4.375A5.618 5.618 0 0 1 15.446 8.6a.626.626 0 0 1-.606.776h-4.111a.625.625 0 0 1-.544-.316L8.15 5.477a.625.625 0 0 1 .385-.914 5.74 5.74 0 0 1 1.467-.188ZM4.377 10A5.625 5.625 0 0 1 6.08 5.96a.625.625 0 0 1 .983.136l2.04 3.592a.625.625 0 0 1 0 .62L7.048 13.89a.625.625 0 0 1-.983.13A5.624 5.624 0 0 1 4.376 10ZM10 15.625a5.744 5.744 0 0 1-1.492-.193.626.626 0 0 1-.381-.916l2.054-3.576a.625.625 0 0 1 .542-.313h4.117a.625.625 0 0 1 .606.777A5.62 5.62 0 0 1 10 15.625Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgSettings as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"RoomEntryModal__content__w5f0z\",\"logo-container\":\"RoomEntryModal__logo-container__fYEi5\",\"logoContainer\":\"RoomEntryModal__logo-container__fYEi5\",\"room-name\":\"RoomEntryModal__room-name__z4FVW\",\"roomName\":\"RoomEntryModal__room-name__z4FVW\",\"buttons\":\"RoomEntryModal__buttons__NvzXp\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { ReactComponent as EnterIcon } from \"../icons/Enter.svg\";\nimport { ReactComponent as VRIcon } from \"../icons/VR.svg\";\nimport { ReactComponent as ShowIcon } from \"../icons/Show.svg\";\nimport { ReactComponent as SettingsIcon } from \"../icons/Settings.svg\";\nimport styles from \"./RoomEntryModal.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\nimport { useCssBreakpoints } from \"react-use-css-breakpoints\";\nimport { Column } from \"../layout/Column\";\nimport { AppLogo } from \"../misc/AppLogo\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function RoomEntryModal({\n  className,\n  roomName,\n  showJoinRoom,\n  onJoinRoom,\n  showEnterOnDevice,\n  onEnterOnDevice,\n  showSpectate,\n  onSpectate,\n  showOptions,\n  onOptions,\n  ...rest\n}) {\n  const breakpoint = useCssBreakpoints();\n  return (\n    <Modal className={classNames(styles.roomEntryModal, className)} disableFullscreen {...rest}>\n      <Column center className={styles.content}>\n        {breakpoint !== \"sm\" &&\n          breakpoint !== \"md\" && (\n            <div className={styles.logoContainer}>\n              <AppLogo />\n            </div>\n          )}\n        <div className={styles.roomName}>\n          <h5>\n            <FormattedMessage id=\"room-entry-modal.room-name-label\" defaultMessage=\"Room Name\" />\n          </h5>\n          <p>{roomName}</p>\n        </div>\n        <Column center className={styles.buttons}>\n          {showJoinRoom && (\n            <Button preset=\"accent4\" onClick={onJoinRoom}>\n              <EnterIcon />\n              <span>\n                <FormattedMessage id=\"room-entry-modal.join-room-button\" defaultMessage=\"Join Room\" />\n              </span>\n            </Button>\n          )}\n          {showEnterOnDevice && (\n            <Button preset=\"accent5\" onClick={onEnterOnDevice}>\n              <VRIcon />\n              <span>\n                <FormattedMessage id=\"room-entry-modal.enter-on-device-button\" defaultMessage=\"Enter On Device\" />\n              </span>\n            </Button>\n          )}\n          {showSpectate && (\n            <Button preset=\"accent2\" onClick={onSpectate}>\n              <ShowIcon />\n              <span>\n                <FormattedMessage id=\"room-entry-modal.spectate-button\" defaultMessage=\"Spectate\" />\n              </span>\n            </Button>\n          )}\n          {showOptions &&\n            breakpoint !== \"sm\" && (\n              <>\n                <hr className={styleUtils.showLg} />\n                <Button preset=\"transparent\" className={styleUtils.showLg} onClick={onOptions}>\n                  <SettingsIcon />\n                  <span>\n                    <FormattedMessage id=\"room-entry-modal.options-button\" defaultMessage=\"Options\" />\n                  </span>\n                </Button>\n              </>\n            )}\n        </Column>\n      </Column>\n    </Modal>\n  );\n}\n\nRoomEntryModal.propTypes = {\n  className: PropTypes.string,\n  roomName: PropTypes.string.isRequired,\n  showJoinRoom: PropTypes.bool,\n  onJoinRoom: PropTypes.func,\n  showEnterOnDevice: PropTypes.bool,\n  onEnterOnDevice: PropTypes.func,\n  showSpectate: PropTypes.bool,\n  onSpectate: PropTypes.func,\n  showOptions: PropTypes.bool,\n  onOptions: PropTypes.func\n};\n\nRoomEntryModal.defaultProps = {\n  showJoinRoom: true,\n  showEnterOnDevice: true,\n  showSpectate: true,\n  showOptions: true\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { ReactComponent as VRIcon } from \"../icons/VR.svg\";\nimport styles from \"./EnterOnDeviceModal.scss\";\nimport { BackButton } from \"../input/BackButton\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nexport function EnterOnDeviceModal({\n  className,\n  shortUrl,\n  loadingCode,\n  code,\n  headsetConnected,\n  unsupportedBrowser,\n  onEnterOnConnectedHeadset,\n  onBack,\n  ...rest\n}) {\n  const intl = useIntl();\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"enter-on-device-modal.title\" defaultMessage=\"Enter on Device\" />}\n      beforeTitle={<BackButton onClick={onBack} />}\n      className={className}\n      {...rest}\n    >\n      <Column center={loadingCode ? \"both\" : true} padding grow>\n        {loadingCode ? (\n          <b>\n            <FormattedMessage id=\"enter-on-device-modal.generating-code\" defaultMessage=\"Generating join code...\" />\n          </b>\n        ) : (\n          <>\n            <b>\n              <FormattedMessage id=\"enter-on-device-modal.heading\" defaultMessage=\"Enter on Wireless Headset / Phone\" />\n            </b>\n            <small>\n              <FormattedMessage\n                id=\"enter-on-device-modal.short-url-directions\"\n                defaultMessage=\"In your device's web browser, go to:\"\n              />\n            </small>\n            <div className={styles.shortUrlContainer}>{shortUrl}</div>\n            <small>\n              <FormattedMessage\n                id=\"enter-on-device-modal.code-directions\"\n                defaultMessage=\"Then, enter this one-time code:\"\n              />\n            </small>\n            <div className={styles.codeContainer}>\n              {code.split(\"\").map((char, i) => (\n                <div key={i} className={styles.codeLetter}>\n                  {char}\n                </div>\n              ))}\n            </div>\n            <strong>\n              <FormattedMessage\n                id=\"enter-on-device-modal.data-transfer\"\n                defaultMessage=\"Your account and avatar will be transferred to the device.\"\n              />\n            </strong>\n            <strong>\n              <FormattedMessage\n                id=\"enter-on-device-modal.keep-page-open\"\n                defaultMessage=\"Keep this page open to use this code.\"\n              />\n            </strong>\n            {headsetConnected && (\n              <>\n                <hr\n                  data-or-text={intl.formatMessage({ id: \"enter-on-device-modal.divider-label\", defaultMessage: \"or\" })}\n                />\n                <b>\n                  <FormattedMessage\n                    id=\"enter-on-device-modal.headset-connected-heading\"\n                    defaultMessage=\"Enter on Connected Headset\"\n                  />\n                </b>\n                {unsupportedBrowser ? (\n                  <>\n                    <small>\n                      <FormattedMessage\n                        id=\"enter-on-device-modal.unsupported-browser\"\n                        defaultMessage=\"WebVR isn't supported in this browser, to enter with Oculus or SteamVR, use Firefox.\"\n                      />\n                    </small>\n                    <Button\n                      as=\"a\"\n                      preset=\"accent2\"\n                      href=\"https://www.mozilla.org/firefox/\"\n                      target=\"_blank\"\n                      rel=\"noreferrer noopener\"\n                    >\n                      <span>\n                        <FormattedMessage\n                          id=\"enter-on-device-modal.download-firefox-button\"\n                          defaultMessage=\"Download Firefox\"\n                        />\n                      </span>\n                    </Button>\n                  </>\n                ) : (\n                  <>\n                    <small>\n                      <FormattedMessage\n                        id=\"enter-on-device-modal.headset-connected-message\"\n                        defaultMessage=\"You have a VR headset connected to this device.\"\n                      />\n                    </small>\n                    <Button preset=\"accent5\" onClick={onEnterOnConnectedHeadset}>\n                      <VRIcon />\n                      <span>\n                        <FormattedMessage id=\"enter-on-device-modal.enter-in-vr-button\" defaultMessage=\"Enter in VR\" />\n                      </span>\n                    </Button>\n                  </>\n                )}\n              </>\n            )}\n          </>\n        )}\n      </Column>\n    </Modal>\n  );\n}\n\nEnterOnDeviceModal.propTypes = {\n  className: PropTypes.string,\n  shortUrl: PropTypes.string.isRequired,\n  loadingCode: PropTypes.bool,\n  code: PropTypes.string,\n  headsetConnected: PropTypes.bool,\n  unsupportedBrowser: PropTypes.bool,\n  onEnterOnConnectedHeadset: PropTypes.func,\n  onBack: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"code-container\":\"EnterOnDeviceModal__code-container__RRgUe\",\"codeContainer\":\"EnterOnDeviceModal__code-container__RRgUe\",\"short-url-container\":\"EnterOnDeviceModal__short-url-container__tK_03\",\"shortUrlContainer\":\"EnterOnDeviceModal__short-url-container__tK_03\",\"code-letter\":\"EnterOnDeviceModal__code-letter__nSeNJ\",\"codeLetter\":\"EnterOnDeviceModal__code-letter__nSeNJ\"};","var _path, _rect, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgMicrophone = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 17.5h5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 8,\n    y: 8.7,\n    width: 4,\n    height: 0,\n    fill: \"#7ED320\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15 8.126v1.25c0 2.75-2.25 5-5 5s-5-2.25-5-5v-1.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 14.376v3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2.5A2.487 2.487 0 0 0 7.5 5v4.336c0 1.375 1.133 2.54 2.5 2.54s2.5-1.133 2.5-2.54V5c0-1.406-1.094-2.5-2.5-2.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgMicrophone as ReactComponent };","var _path, _rect, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgMicrophoneMuted = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 17.5h5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 8,\n    y: 8.7,\n    width: 4,\n    height: 0,\n    fill: \"#7ED320\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15 8.126v1.25c0 2.75-2.25 5-5 5s-5-2.25-5-5v-1.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 14.376v3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2.5A2.487 2.487 0 0 0 7.5 5v4.336c0 1.375 1.133 2.54 2.5 2.54s2.5-1.133 2.5-2.54V5c0-1.406-1.094-2.5-2.5-2.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.875 15.625 3.75 2.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgMicrophoneMuted as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVolumeOff = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.283 7.498h-2.72a.313.313 0 0 0-.313.313v4.375a.312.312 0 0 0 .312.312h2.721c.144 0 .284.05.396.142l3.573 2.93a.312.312 0 0 0 .498-.253V4.68a.313.313 0 0 0-.498-.252L9.68 7.357a.625.625 0 0 1-.396.141Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgVolumeOff as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgInfo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.688 2.502a7.188 7.188 0 1 0 0 14.376 7.188 7.188 0 0 0 0-14.376Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.594 8.594h1.25v4.532\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.125 13.281h3.437\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.687 5.08a1.016 1.016 0 1 0 0 2.03 1.016 1.016 0 0 0 0-2.03Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgInfo as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"MicSetupModal__content__HyAJG\",\"audio-check-container\":\"MicSetupModal__audio-check-container__DqNni\",\"audioCheckContainer\":\"MicSetupModal__audio-check-container__DqNni\",\"audio-io-container\":\"MicSetupModal__audio-io-container__p_zLQ\",\"audioIoContainer\":\"MicSetupModal__audio-io-container__p_zLQ\",\"icon-enabled\":\"MicSetupModal__icon-enabled__6YNrZ\",\"iconEnabled\":\"MicSetupModal__icon-enabled__6YNrZ\",\"icon-disabled\":\"MicSetupModal__icon-disabled__Ye6un\",\"iconDisabled\":\"MicSetupModal__icon-disabled__Ye6un\",\"icon-container\":\"MicSetupModal__icon-container__Cgq7i\",\"iconContainer\":\"MicSetupModal__icon-container__Cgq7i\",\"action-container\":\"MicSetupModal__action-container__h3C_p\",\"actionContainer\":\"MicSetupModal__action-container__h3C_p\",\"selection-container\":\"MicSetupModal__selection-container__inBu_\",\"selectionContainer\":\"MicSetupModal__selection-container__inBu_\",\"selection-input\":\"MicSetupModal__selection-input__mrlP_\",\"selectionInput\":\"MicSetupModal__selection-input__mrlP_\",\"popover\":\"MicSetupModal__popover__bua5Q\",\"popover-arrow\":\"MicSetupModal__popover-arrow__eaSQH\",\"popoverArrow\":\"MicSetupModal__popover-arrow__eaSQH\",\"popover-content\":\"MicSetupModal__popover-content__PsqFV\",\"popoverContent\":\"MicSetupModal__popover-content__PsqFV\",\"error-title\":\"MicSetupModal__error-title__ee_La\",\"errorTitle\":\"MicSetupModal__error-title__ee_La\",\"spinner-container\":\"MicSetupModal__spinner-container__Adr6x\",\"spinnerContainer\":\"MicSetupModal__spinner-container__Adr6x\",\"info-icon\":\"MicSetupModal__info-icon__Uu81j\",\"infoIcon\":\"MicSetupModal__info-icon__Uu81j\",\"level-bar\":\"MicSetupModal__level-bar__Qf5Gj\",\"levelBar\":\"MicSetupModal__level-bar__Qf5Gj\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ToggleInput.scss\";\n\nexport const ToggleInput = memo(\n  forwardRef(({ className, label, description, disabled, ...rest }, ref) => {\n    return (\n      <label className={classNames(styles.toggleInput, { [styles.disabled]: disabled }, className)}>\n        <input type=\"checkbox\" disabled={disabled} ref={ref} {...rest} />\n        <div className={classNames(styles.track)}>\n          <div className={styles.button} />\n        </div>\n        {label && (\n          <div className={styles.labelContainer}>\n            <p className={styles.label}>{label}</p>\n            {description && <p className={styles.description}>{description}</p>}\n          </div>\n        )}\n      </label>\n    );\n  })\n);\n\nToggleInput.propTypes = {\n  label: PropTypes.node,\n  description: PropTypes.node,\n  checked: PropTypes.bool,\n  disabled: PropTypes.bool,\n  className: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"toggle-input\":\"ToggleInput__toggle-input__ObbBV\",\"toggleInput\":\"ToggleInput__toggle-input__ObbBV\",\"track\":\"ToggleInput__track__EfEPA\",\"disabled\":\"ToggleInput__disabled__sDnmL\",\"label-container\":\"ToggleInput__label-container__uv2am\",\"labelContainer\":\"ToggleInput__label-container__uv2am\",\"label\":\"ToggleInput__label__kDiUc\",\"description\":\"ToggleInput__description__BoziI\",\"button\":\"ToggleInput__button__CHW2n\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { ReactComponent as MicrophoneIcon } from \"../icons/Microphone.svg\";\nimport { ReactComponent as MicrophoneMutedIcon } from \"../icons/MicrophoneMuted.svg\";\nimport { ReactComponent as VolumeOffIcon } from \"../icons/VolumeOff.svg\";\nimport { ReactComponent as InfoIcon } from \"../icons/Info.svg\";\nimport styles from \"./MicSetupModal.scss\";\nimport { BackButton } from \"../input/BackButton\";\nimport { SelectInputField } from \"../input/SelectInputField\";\nimport { ToggleInput } from \"../input/ToggleInput\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Popover } from \"../popover/Popover\";\nimport { PermissionStatus } from \"../../utils/media-devices-utils\";\nimport { Spinner } from \"../misc/Spinner\";\n\nexport function MicSetupModal({\n  className,\n  microphoneOptions,\n  onChangeMicrophone,\n  speakerOptions,\n  onChangeSpeaker,\n  isMicrophoneEnabled,\n  onPlaySound,\n  isMicrophoneMuted,\n  onChangeMicrophoneMuted,\n  onEnterRoom,\n  onBack,\n  permissionStatus,\n  isAudioInputSelectAvailable,\n  isAudioOutputSelectAvailable,\n  micLevelBar,\n  speakerLevelBar,\n  ...rest\n}) {\n  const iconStyle = isMicrophoneEnabled ? styles.iconEnabled : styles.iconDisabled;\n  return (\n    <Modal\n      title={<FormattedMessage id=\"mic-setup-modal.title\" defaultMessage=\"Microphone Setup\" />}\n      beforeTitle={<BackButton onClick={onBack} />}\n      className={className}\n      {...rest}\n    >\n      <Column center padding grow className={styles.content}>\n        <p>\n          <FormattedMessage\n            id=\"mic-setup-modal.check-mic\"\n            defaultMessage=\"Check your microphone and audio before entering.\"\n          />\n        </p>\n        <div className={styles.audioCheckContainer}>\n          <div className={styles.audioIoContainer}>\n            <div className={styles.iconContainer}>\n              <div>\n                {permissionStatus === PermissionStatus.PROMPT && (\n                  <div className={styles.spinnerContainer}>\n                    <Spinner />\n                  </div>\n                )}\n                {permissionStatus === PermissionStatus.GRANTED && isMicrophoneEnabled && !isMicrophoneMuted ? (\n                  <MicrophoneIcon className={iconStyle} />\n                ) : (\n                  <MicrophoneMutedIcon className={iconStyle} />\n                )}\n              </div>\n              {permissionStatus === PermissionStatus.GRANTED && <> {micLevelBar}</>}\n            </div>\n            <div className={styles.actionContainer}>\n              {permissionStatus === PermissionStatus.GRANTED ? (\n                <>\n                  <ToggleInput\n                    label={<FormattedMessage id=\"mic-setup-modal.mute-mic-toggle-v2\" defaultMessage=\"Mute\" />}\n                    checked={isMicrophoneMuted}\n                    onChange={onChangeMicrophoneMuted}\n                  />\n                  <Popover\n                    title=\"Info\"\n                    content={\n                      <Column className={styles.popoverContent}>\n                        <FormattedMessage\n                          id=\"mic-setup-modal.mute-mic-info\"\n                          defaultMessage=\"You can mute anytime after you enter the room\"\n                        />\n                      </Column>\n                    }\n                    placement=\"top\"\n                    showHeader={false}\n                    disableFullscreen\n                    popoverClass={styles.popover}\n                    arrowClass={styles.popoverArrow}\n                  >\n                    {({ openPopover, closePopover, triggerRef }) => (\n                      <div ref={triggerRef}>\n                        <InfoIcon className={styles.infoIcon} onMouseEnter={openPopover} onMouseLeave={closePopover} />\n                      </div>\n                    )}\n                  </Popover>\n                </>\n              ) : (\n                (permissionStatus === PermissionStatus.PROMPT && (\n                  <p>\n                    <FormattedMessage\n                      id=\"mic-setup-modal.mic-permission-prompt\"\n                      defaultMessage=\"Requesting access to your microphone...\"\n                    />\n                  </p>\n                )) ||\n                (permissionStatus === PermissionStatus.DENIED && (\n                  <p>\n                    <span className={styles.errorTitle}>\n                      <FormattedMessage\n                        id=\"mic-setup-modal.error-title\"\n                        defaultMessage=\"Microphone access was blocked.\"\n                        className={styles.errorTitle}\n                      />\n                    </span>{\" \"}\n                    <FormattedMessage\n                      id=\"mic-setup-modal.error-description\"\n                      defaultMessage=\"To talk in Hubs you will need to allow microphone access.\"\n                    />\n                  </p>\n                ))\n              )}\n            </div>\n            {permissionStatus === PermissionStatus.GRANTED &&\n              isAudioInputSelectAvailable && (\n                <div className={styles.selectionContainer}>\n                  <p style={{ alignSelf: \"start\" }}>\n                    <FormattedMessage id=\"mic-setup-modal.microphone-text\" defaultMessage=\"Microphone\" />\n                  </p>\n                  <SelectInputField\n                    className={styles.selectionInput}\n                    buttonClassName={styles.selectionInput}\n                    onChange={onChangeMicrophone}\n                    {...microphoneOptions}\n                  />\n                </div>\n              )}\n          </div>\n          <div className={styles.audioIoContainer}>\n            <div className={styles.iconContainer}>\n              <VolumeOffIcon className={styles.iconEnabled} style={{ marginRight: \"5px\" }} />\n              <> {speakerLevelBar} </>\n            </div>\n            <div className={styles.actionContainer}>\n              <Button preset=\"basic\" onClick={onPlaySound} sm>\n                <FormattedMessage id=\"mic-setup-modal.test-audio-button\" defaultMessage=\"Test Audio\" />\n              </Button>\n            </div>\n            {permissionStatus === PermissionStatus.GRANTED &&\n              isAudioOutputSelectAvailable && (\n                <div className={styles.selectionContainer}>\n                  <p style={{ alignSelf: \"start\" }}>\n                    <FormattedMessage id=\"mic-setup-modal.speakers-text\" defaultMessage=\"Speakers\" />\n                  </p>\n                  <SelectInputField\n                    onChange={onChangeSpeaker}\n                    className={styles.selectionInput}\n                    buttonClassName={styles.selectionInput}\n                    {...speakerOptions}\n                  />\n                </div>\n              )}\n          </div>\n        </div>\n        <Button preset=\"primary\" onClick={onEnterRoom}>\n          <FormattedMessage id=\"mic-setup-modal.enter-room-button\" defaultMessage=\"Enter Room\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nMicSetupModal.propTypes = {\n  className: PropTypes.string,\n  onPlaySound: PropTypes.func,\n  micLevelBar: PropTypes.node,\n  speakerLevelBar: PropTypes.node,\n  isMicrophoneEnabled: PropTypes.bool,\n  isMicrophoneMuted: PropTypes.bool,\n  onChangeMicrophoneMuted: PropTypes.func,\n  microphoneOptions: PropTypes.object,\n  onChangeMicrophone: PropTypes.func,\n  speakerOptions: PropTypes.object,\n  onChangeSpeaker: PropTypes.func,\n  onEnterRoom: PropTypes.func,\n  onBack: PropTypes.func,\n  permissionStatus: PropTypes.string,\n  isAudioInputSelectAvailable: PropTypes.bool,\n  isAudioOutputSelectAvailable: PropTypes.bool\n};\n\nMicSetupModal.defaultProps = {\n  permissionStatus: PermissionStatus.PROMPT\n};\n","import { useState, useEffect, useCallback } from \"react\";\nimport { MediaDevices, MediaDevicesEvents } from \"../../utils/media-devices-utils\";\n\nexport function useMicrophoneStatus(scene) {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [isMicMuted, setIsMicMuted] = useState(!mediaDevicesManager.isMicEnabled);\n  const [isMicEnabled, setIsMicEnabled] = useState(APP.mediaDevicesManager.isMicShared);\n  const [permissionStatus, setPermissionsStatus] = useState(\n    mediaDevicesManager.getPermissionsStatus(MediaDevices.MICROPHONE)\n  );\n\n  useEffect(\n    () => {\n      const onMicMutedStateChanged = ({ enabled }) => {\n        setIsMicMuted(!enabled);\n      };\n      APP.dialog.on(\"mic-state-changed\", onMicMutedStateChanged);\n\n      const onMicEnabled = () => {\n        setIsMicEnabled(true);\n      };\n      const onMicDisabled = () => {\n        setIsMicEnabled(false);\n      };\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n\n      const onPermissionsChanged = ({ mediaDevice, status }) => {\n        if (mediaDevice === MediaDevices.MICROPHONE) {\n          setPermissionsStatus(status);\n        }\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n\n      return () => {\n        APP.dialog.off(\"mic-state-changed\", onMicMutedStateChanged);\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n        mediaDevicesManager.off(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n      };\n    },\n    [setIsMicMuted, setIsMicEnabled, setPermissionsStatus, scene, mediaDevicesManager]\n  );\n\n  const toggleMute = useCallback(\n    () => {\n      if (mediaDevicesManager.isMicShared) {\n        mediaDevicesManager.toggleMic();\n      } else {\n        mediaDevicesManager.startMicShare({ unmute: true });\n      }\n    },\n    [mediaDevicesManager]\n  );\n\n  return {\n    isMicMuted,\n    toggleMute,\n    isMicEnabled,\n    permissionStatus\n  };\n}\n","import { useState, useEffect, useCallback } from \"react\";\nimport { MediaDevices, MediaDevicesEvents } from \"../../utils/media-devices-utils\";\n\nexport function useMicrophone(scene) {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [micDevices, setMicDevices] = useState({\n    value: mediaDevicesManager.selectedMicDeviceId,\n    options: mediaDevicesManager.micDevicesOptions\n  });\n\n  useEffect(\n    () => {\n      const onMicEnabled = () => {\n        setMicDevices({\n          value: mediaDevicesManager.selectedMicDeviceId,\n          options: mediaDevicesManager.micDevicesOptions\n        });\n      };\n      const onMicDisabled = () => {\n        setMicDevices({\n          value: mediaDevicesManager.selectedMicDeviceId,\n          options: mediaDevicesManager.micDevicesOptions\n        });\n      };\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n\n      const onPermissionsChanged = ({ mediaDevice }) => {\n        if (mediaDevice === MediaDevices.MICROPHONE) {\n          setMicDevices({\n            value: mediaDevicesManager.selectedMicDeviceId,\n            options: mediaDevicesManager.micDevicesOptions\n          });\n        }\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n\n      const onDeviceChange = () => {\n        setMicDevices({\n          value: mediaDevicesManager.selectedMicDeviceId,\n          options: mediaDevicesManager.micDevicesOptions\n        });\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n\n      setMicDevices({\n        value: mediaDevicesManager.selectedMicDeviceId,\n        options: mediaDevicesManager.micDevicesOptions\n      });\n\n      return () => {\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n        mediaDevicesManager.off(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n        mediaDevicesManager.off(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n      };\n    },\n    [setMicDevices, scene, mediaDevicesManager]\n  );\n\n  const micDeviceChanged = useCallback(\n    deviceId => {\n      setMicDevices({\n        value: mediaDevicesManager.selectedMicDeviceId,\n        options: mediaDevicesManager.micDevicesOptions\n      });\n      mediaDevicesManager.startMicShare({ deviceId });\n    },\n    [mediaDevicesManager]\n  );\n\n  return {\n    micDeviceChanged,\n    micDevices\n  };\n}\n","import { useRef, useCallback } from \"react\";\n\nexport function useSound({ scene, sound }) {\n  const sfxSystem = scene.systems[\"hubs-systems\"].soundEffectsSystem;\n  const analyserRef = useRef(scene.systems[\"hubs-systems\"].audioSystem.mixerAnalyser);\n\n  const playSound = useCallback(\n    () => {\n      sfxSystem.playSoundOneShot(sound).connect(analyserRef.current);\n    },\n    [sound, sfxSystem]\n  );\n\n  return { playSound };\n}\n","import { useState, useEffect, useCallback } from \"react\";\nimport { MediaDevices, MediaDevicesEvents } from \"../../utils/media-devices-utils\";\n\nexport function useSpeakers() {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [speakerDevices, setSpeakerDevices] = useState({\n    value: mediaDevicesManager.selectedSpeakersDeviceId,\n    options: mediaDevicesManager.outputDevicesOptions\n  });\n\n  useEffect(\n    () => {\n      const onPermissionsChanged = ({ mediaDevice }) => {\n        if (mediaDevice === MediaDevices.MICROPHONE) {\n          setSpeakerDevices({\n            value: mediaDevicesManager.selectedSpeakersDeviceId,\n            options: mediaDevicesManager.outputDevicesOptions\n          });\n        }\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n\n      const onDeviceChange = () => {\n        setSpeakerDevices({\n          value: mediaDevicesManager.selectedSpeakersDeviceId,\n          options: mediaDevicesManager.outputDevicesOptions\n        });\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n\n      setSpeakerDevices({\n        value: mediaDevicesManager.selectedSpeakersDeviceId,\n        options: mediaDevicesManager.outputDevicesOptions\n      });\n\n      return () => {\n        mediaDevicesManager.off(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n        mediaDevicesManager.off(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n      };\n    },\n    [setSpeakerDevices, mediaDevicesManager]\n  );\n\n  const speakerDeviceChanged = useCallback(\n    deviceId => {\n      mediaDevicesManager.changeAudioOutput(deviceId);\n      setSpeakerDevices({\n        value: mediaDevicesManager.selectedSpeakersDeviceId,\n        options: mediaDevicesManager.outputDevicesOptions\n      });\n    },\n    [mediaDevicesManager]\n  );\n\n  return {\n    speakerDeviceChanged,\n    speakerDevices\n  };\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"level-bar-container\":\"LevelBar__level-bar-container__mZX3P\",\"levelBarContainer\":\"LevelBar__level-bar-container__mZX3P\",\"level-bar-border\":\"LevelBar__level-bar-border__iciQ1\",\"levelBarBorder\":\"LevelBar__level-bar-border__iciQ1\",\"level-bar\":\"LevelBar__level-bar__AhD98\",\"levelBar\":\"LevelBar__level-bar__AhD98\"};","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./LevelBar.scss\";\n\nexport const LevelBar = forwardRef(({ className }, ref) => {\n  return (\n    <div className={classNames(styles.levelBarContainer, className)}>\n      <div className={styles.levelBarBorder} />\n      <div ref={ref} className={styles.levelBar} />\n    </div>\n  );\n});\n\nLevelBar.propTypes = {\n  className: PropTypes.string\n};\n","import { useEffect, useRef } from \"react\";\nimport MovingAverage from \"moving-average\";\n\nconst MIN_VOLUME_THRESHOLD = 0.08;\n\nconst calculateVolume = (analyser, levels) => {\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n  analyser.getByteTimeDomainData(levels);\n  let sum = 0;\n  for (let i = 0; i < levels.length; i++) {\n    const amplitude = (levels[i] - 128) / 128;\n    sum += amplitude * amplitude;\n  }\n  const currVolume = Math.sqrt(sum / levels.length);\n  return currVolume;\n};\n\nfunction updateVolume(analyser, meter) {\n  const newRawVolume = calculateVolume(analyser, meter.levels);\n\n  const newPerceivedVolume = Math.log(THREE.MathUtils.mapLinear(newRawVolume, 0, 1, 1, Math.E));\n\n  meter.volume = newPerceivedVolume < MIN_VOLUME_THRESHOLD ? 0 : newPerceivedVolume;\n\n  const s = meter.volume > meter.prevVolume ? 0.35 : 0.3;\n  meter.volume = s * meter.volume + (1 - s) * meter.prevVolume;\n  meter.prevVolume = meter.volume;\n}\n\nexport function useVolumeMeter({ analyser, update, updateRate = 50 }) {\n  const movingAvgRef = useRef();\n  const meterRef = useRef({ levels: [], volume: 0, prevVolume: 0, max: 0 });\n\n  useEffect(\n    () => {\n      if (!movingAvgRef.current) {\n        movingAvgRef.current = MovingAverage(updateRate * 2);\n      }\n\n      analyser.fftSize = 32;\n      meterRef.current.levels = new Uint8Array(analyser.fftSize);\n\n      let prevVolume = 0;\n      const timout = setInterval(() => {\n        updateVolume(analyser, meterRef.current);\n\n        meterRef.current.max = Math.max(meterRef.current.volume, meterRef.current.max);\n\n        // We use a moving average to smooth out the visual animation or else it would twitch too fast for\n        // the css renderer to keep up.\n        movingAvgRef.current.push(Date.now(), meterRef.current.volume);\n        const average = movingAvgRef.current.movingAverage();\n        const nextVolume = meterRef.current.max === 0 ? 0 : average / meterRef.current.max;\n        const volume = Math.max(Math.abs(prevVolume - nextVolume) > 0.05 ? nextVolume : prevVolume, 0.1);\n        prevVolume = volume;\n        update(volume);\n      }, updateRate);\n\n      return () => {\n        clearInterval(timout);\n      };\n    },\n    [analyser, update, updateRate]\n  );\n}\n","import React, { useRef, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./LevelBar.scss\";\nimport { LevelBar } from \"./LevelBar\";\nimport { useVolumeMeter } from \"../misc/useVolumeMeter\";\n\nexport const types = [\"mic\", \"mixer\"];\n\nexport function VolumeLevelBar({ scene, type, className }) {\n  const ref = useRef();\n  const update = useCallback(level => {\n    const node = ref.current;\n    if (node) {\n      const pct = level * 100;\n      if (node.clientWidth > node.clientHeight) {\n        node.style.clipPath = `polygon(0% 100%, ${pct}% 100%, ${pct}% 0%, 0% 0%)`;\n      } else {\n        node.style.clipPath = `polygon(0% 100%, 100% 100%, 100% ${100 - pct}%, 0% ${100 - pct}%)`;\n      }\n    }\n  }, []);\n  useVolumeMeter({\n    analyser:\n      type == \"mic\"\n        ? scene.systems[\"hubs-systems\"].audioSystem.outboundAnalyser\n        : scene.systems[\"hubs-systems\"].audioSystem.mixerAnalyser,\n    update\n  });\n  return <LevelBar ref={ref} className={classNames(styles.levelBarContainer, className)} />;\n}\n\nVolumeLevelBar.propTypes = {\n  scene: PropTypes.object.isRequired,\n  type: PropTypes.oneOf(types),\n  className: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { MicSetupModal } from \"./MicSetupModal\";\nimport { useMicrophoneStatus } from \"./useMicrophoneStatus\";\nimport { useMicrophone } from \"./useMicrophone\";\nimport { useSound } from \"./useSound\";\nimport { SOUND_SPEAKER_TONE } from \"../../systems/sound-effects-system\";\nimport { useSpeakers } from \"./useSpeakers\";\nimport { useCallback } from \"react\";\nimport { useState } from \"react\";\nimport MediaDevicesManager from \"../../utils/media-devices-manager\";\nimport { VolumeLevelBar } from \"../misc/VolumeLevelBar\";\nimport styles from \"./MicSetupModal.scss\";\n\nexport function MicSetupModalContainer({ scene, ...rest }) {\n  const { isMicEnabled, permissionStatus } = useMicrophoneStatus(scene);\n  const { micDeviceChanged, micDevices } = useMicrophone(scene);\n  const { speakerDeviceChanged, speakerDevices } = useSpeakers();\n  const { playSound } = useSound({\n    scene,\n    sound: SOUND_SPEAKER_TONE\n  });\n  const [isMicMutedOnEntry, setIsMicMutedOnEntry] = useState(APP.store.state.preferences[\"muteMicOnEntry\"]);\n  const onChangeMicrophoneMuted = useCallback(({ target: { checked: muted } }) => {\n    setIsMicMutedOnEntry(muted);\n    APP.store.update({\n      preferences: { muteMicOnEntry: muted }\n    });\n  }, []);\n\n  return (\n    <MicSetupModal\n      micLevelBar={<VolumeLevelBar scene={scene} type=\"mic\" className={styles.levelBar} />}\n      speakerLevelBar={<VolumeLevelBar scene={scene} type=\"mixer\" className={styles.levelBar} />}\n      onPlaySound={playSound}\n      isMicrophoneEnabled={isMicEnabled}\n      isMicrophoneMuted={isMicMutedOnEntry}\n      permissionStatus={permissionStatus}\n      microphoneOptions={micDevices}\n      speakerOptions={speakerDevices}\n      onChangeMicrophone={micDeviceChanged}\n      onChangeSpeaker={speakerDeviceChanged}\n      onChangeMicrophoneMuted={onChangeMicrophoneMuted}\n      isAudioInputSelectAvailable={MediaDevicesManager.isAudioInputSelectEnabled}\n      isAudioOutputSelectAvailable={MediaDevicesManager.isAudioOutputSelectEnabled}\n      {...rest}\n    />\n  );\n}\n\nMicSetupModalContainer.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"invite-popover\":\"InvitePopover__invite-popover__hQEWt\",\"invitePopover\":\"InvitePopover__invite-popover__hQEWt\"};","// extracted by mini-css-extract-plugin\nexport default {\"copy-button\":\"CopyableTextInputField__copy-button__KHz3G\",\"copyButton\":\"CopyableTextInputField__copy-button__KHz3G\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useClipboard } from \"use-clipboard-copy\";\nimport { TextInputField } from \"./TextInputField\";\nimport { Button } from \"./Button\";\nimport styles from \"./CopyableTextInputField.scss\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst copyLabelMessage = defineMessage({\n  id: \"copyable-text-input-field.copy-label\",\n  defaultMessage: \"Copy\"\n});\n\nconst copiedLabelMessage = defineMessage({\n  id: \"copyable-text-input-field.copied-label\",\n  defaultMessage: \"Copied\"\n});\n\nexport function CopyableTextInputField({ buttonPreset, ...rest }) {\n  const clipboard = useClipboard({\n    copiedTimeout: 600\n  });\n\n  const intl = useIntl();\n\n  const copyLabel = intl.formatMessage(copyLabelMessage);\n  const copiedLabel = intl.formatMessage(copiedLabelMessage);\n\n  // Use a dynamic width based on the content to account for i18n\n  const maxLabelLength = Math.max(copyLabel.length, copiedLabel.length);\n\n  return (\n    <TextInputField\n      ref={clipboard.target}\n      afterInput={\n        clipboard.isSupported() ? (\n          <Button\n            preset={buttonPreset}\n            onClick={clipboard.copy}\n            className={styles.copyButton}\n            style={{ width: `${maxLabelLength}ch` }} // ch is a unit representing the width of the 0 character\n          >\n            {clipboard.copied ? copiedLabel : copyLabel}\n          </Button>\n        ) : (\n          undefined\n        )\n      }\n      {...rest}\n    />\n  );\n}\n\nCopyableTextInputField.propTypes = {\n  buttonPreset: PropTypes.string\n};\n","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgInvite = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.563 3.751H3.438c-.863 0-1.563.7-1.563 1.562v9.375c0 .863.7 1.563 1.563 1.563h13.124c.863 0 1.563-.7 1.563-1.563V5.313c0-.862-.7-1.562-1.563-1.562Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.375 6.251 10 10.626l5.625-4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgInvite as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"room-permissions\":\"RoomSettingsSidebar__room-permissions__AoDPm\",\"roomPermissions\":\"RoomSettingsSidebar__room-permissions__AoDPm\",\"permissions-group\":\"RoomSettingsSidebar__permissions-group__u2KNv\",\"permissionsGroup\":\"RoomSettingsSidebar__permissions-group__u2KNv\",\"confirm-revoke-button\":\"RoomSettingsSidebar__confirm-revoke-button__i2XAf\",\"confirmRevokeButton\":\"RoomSettingsSidebar__confirm-revoke-button__i2XAf\"};","import React, { useState, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./RoomSettingsSidebar.scss\";\nimport { IconButton } from \"../input/IconButton\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { CopyableTextInputField } from \"../input/CopyableTextInputField\";\n\nexport function InviteLinkInputField({ fetchingInvite, inviteUrl, onRevokeInvite }) {\n  const intl = useIntl();\n\n  const [showRevokeConfirmation, setShowRevokeConfirmation] = useState(false);\n\n  const revokeInvite = useCallback(() => {\n    setShowRevokeConfirmation(true);\n  }, []);\n\n  const cancelConfirmRevokeInvite = useCallback(() => {\n    setShowRevokeConfirmation(false);\n  }, []);\n\n  const confirmRevokeInvite = useCallback(\n    () => {\n      onRevokeInvite();\n      setShowRevokeConfirmation(false);\n    },\n    [onRevokeInvite]\n  );\n\n  return (\n    <CopyableTextInputField\n      label={<FormattedMessage id=\"invite-link-input-field.label\" defaultMessage=\"Invite link\" />}\n      disabled={fetchingInvite}\n      value={\n        fetchingInvite\n          ? intl.formatMessage({\n              id: \"invite-link-input-field.generating-invite\",\n              defaultMessage: \"Generating invite...\"\n            })\n          : inviteUrl\n      }\n      buttonPreset=\"primary\"\n      description={\n        !fetchingInvite &&\n        (showRevokeConfirmation ? (\n          <>\n            <FormattedMessage id=\"invite-link-input-field.revoke-confirm\" defaultMessage=\"are you sure?\" />{\" \"}\n            <IconButton className={styles.confirmRevokeButton} onClick={confirmRevokeInvite}>\n              <FormattedMessage id=\"invite-link-input-field.revoke-confirm-yes\" defaultMessage=\"yes\" />\n            </IconButton>{\" \"}\n            /{\" \"}\n            <IconButton className={styles.confirmRevokeButton} onClick={cancelConfirmRevokeInvite}>\n              <FormattedMessage id=\"invite-link-input-field.revoke-confirm-no\" defaultMessage=\"no\" />\n            </IconButton>\n          </>\n        ) : (\n          <IconButton className={styles.confirmRevokeButton} onClick={revokeInvite}>\n            <FormattedMessage id=\"invite-link-input-field.revoke\" defaultMessage=\"revoke\" />\n          </IconButton>\n        ))\n      }\n      fullWidth\n    />\n  );\n}\n\nInviteLinkInputField.propTypes = {\n  fetchingInvite: PropTypes.bool,\n  inviteUrl: PropTypes.string,\n  onRevokeInvite: PropTypes.func.isRequired\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./InvitePopover.scss\";\nimport { CopyableTextInputField } from \"../input/CopyableTextInputField\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as InviteIcon } from \"../icons/Invite.svg\";\nimport { Column } from \"../layout/Column\";\nimport { InviteLinkInputField } from \"./InviteLinkInputField\";\nimport { FormattedMessage, defineMessage, useIntl } from \"react-intl\";\n\nfunction InvitePopoverContent({ url, embed, inviteRequired, fetchingInvite, inviteUrl, revokeInvite }) {\n  return (\n    <Column center padding grow gap=\"lg\" className={styles.invitePopover}>\n      {inviteRequired ? (\n        <>\n          <InviteLinkInputField fetchingInvite={fetchingInvite} inviteUrl={inviteUrl} onRevokeInvite={revokeInvite} />\n        </>\n      ) : (\n        <>\n          <CopyableTextInputField\n            label={<FormattedMessage id=\"invite-popover.room-link\" defaultMessage=\"Room Link\" />}\n            value={url}\n            buttonPreset=\"accent3\"\n          />\n          <CopyableTextInputField\n            label={<FormattedMessage id=\"invite-popover.embed-code\" defaultMessage=\"Embed Code\" />}\n            value={embed}\n            buttonPreset=\"accent5\"\n          />\n        </>\n      )}\n    </Column>\n  );\n}\n\nInvitePopoverContent.propTypes = {\n  url: PropTypes.string.isRequired,\n  embed: PropTypes.string.isRequired,\n  inviteRequired: PropTypes.bool,\n  fetchingInvite: PropTypes.bool,\n  inviteUrl: PropTypes.string,\n  revokeInvite: PropTypes.func\n};\n\nconst invitePopoverTitle = defineMessage({\n  id: \"invite-popover.title\",\n  defaultMessage: \"Invite\"\n});\n\nexport function InvitePopoverButton({\n  url,\n  embed,\n  initiallyVisible,\n  popoverApiRef,\n  inviteRequired,\n  fetchingInvite,\n  inviteUrl,\n  revokeInvite,\n  ...rest\n}) {\n  const intl = useIntl();\n  const title = intl.formatMessage(invitePopoverTitle);\n\n  return (\n    <Popover\n      title={title}\n      content={() => (\n        <InvitePopoverContent\n          url={url}\n          embed={embed}\n          inviteRequired={inviteRequired}\n          fetchingInvite={fetchingInvite}\n          inviteUrl={inviteUrl}\n          revokeInvite={revokeInvite}\n        />\n      )}\n      placement=\"top-start\"\n      offsetDistance={28}\n      initiallyVisible={initiallyVisible}\n      popoverApiRef={popoverApiRef}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<InviteIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n          {...rest}\n        />\n      )}\n    </Popover>\n  );\n}\n\nInvitePopoverButton.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  popoverApiRef: PropTypes.object,\n  ...InvitePopoverContent.propTypes\n};\n","import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { hubUrl } from \"../../utils/phoenix-utils\";\n\nexport function useInviteUrl(hubChannel, disabled = false) {\n  const [inviteId, setInviteId] = useState();\n\n  useEffect(\n    () => {\n      setInviteId(undefined);\n\n      if (disabled) {\n        return;\n      }\n\n      hubChannel\n        .fetchInvite()\n        .then(({ hub_invite_id }) => {\n          if (disabled) {\n            return;\n          }\n\n          setInviteId(hub_invite_id);\n        })\n        .catch(error => {\n          console.error(\"Error fetching invite\", error);\n        });\n    },\n    [hubChannel, disabled]\n  );\n\n  const revokeInvite = useCallback(\n    () => {\n      setInviteId(undefined);\n\n      if (disabled) {\n        return;\n      }\n\n      hubChannel\n        .revokeInvite(inviteId)\n        .then(({ hub_invite_id }) => {\n          if (disabled) {\n            return;\n          }\n\n          setInviteId(hub_invite_id);\n        })\n        .catch(error => {\n          console.error(\"Error revoking invite\", error);\n        });\n    },\n    [inviteId, hubChannel, disabled]\n  );\n\n  const inviteUrl = useMemo(\n    () => {\n      if (inviteId && !disabled) {\n        const url = hubUrl();\n        url.searchParams.set(\"hub_invite_id\", inviteId);\n        return url.toString();\n      }\n\n      return undefined;\n    },\n    [inviteId, disabled]\n  );\n\n  const fetchingInvite = !inviteId && !disabled;\n\n  return { fetchingInvite, inviteUrl, revokeInvite };\n}\n","import React, { useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { hubUrl } from \"../../utils/phoenix-utils\";\nimport { InvitePopoverButton } from \"./InvitePopover\";\nimport { handleExitTo2DInterstitial } from \"../../utils/vr-interstitial\";\nimport { useInviteUrl } from \"./useInviteUrl\";\n\nexport function InvitePopoverContainer({ hub, hubChannel, scene, ...rest }) {\n  // TODO: Move to Hub class\n  const shortUrl = `https://${configs.SHORTLINK_DOMAIN}`;\n  const url = `${shortUrl}/${hub.hub_id}`;\n  const embedUrl = hubUrl(hub.hub_id, { embed_token: hub.embed_token });\n  const embedText = `<iframe src=\"${embedUrl}\" style=\"width: 1024px; height: 768px;\" allow=\"microphone; camera; vr; speaker;\"></iframe>`;\n  const popoverApiRef = useRef();\n\n  // Handle clicking on the invite button while in VR.\n  useEffect(\n    () => {\n      function onInviteButtonClicked() {\n        handleExitTo2DInterstitial(true, () => {}).then(() => {\n          popoverApiRef.current.openPopover();\n        });\n      }\n\n      scene.addEventListener(\"action_invite\", onInviteButtonClicked);\n\n      return () => {\n        scene.removeEventListener(\"action_invite\", onInviteButtonClicked);\n      };\n    },\n    [scene, popoverApiRef]\n  );\n\n  const inviteRequired = hub.entry_mode === \"invite\";\n  const canGenerateInviteUrl = hubChannel.can(\"update_hub\");\n\n  const { fetchingInvite, inviteUrl, revokeInvite } = useInviteUrl(\n    hubChannel,\n    !inviteRequired || !canGenerateInviteUrl\n  );\n\n  if (inviteRequired && !canGenerateInviteUrl) {\n    return null;\n  }\n\n  return (\n    <InvitePopoverButton\n      inviteRequired={inviteRequired}\n      fetchingInvite={fetchingInvite}\n      inviteUrl={inviteUrl}\n      revokeInvite={revokeInvite}\n      url={url}\n      embed={embedText}\n      popoverApiRef={popoverApiRef}\n      {...rest}\n    />\n  );\n}\n\nInvitePopoverContainer.propTypes = {\n  hub: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"more-menu-popover\":\"MoreMenuPopover__more-menu-popover__isNqe\",\"moreMenuPopover\":\"MoreMenuPopover__more-menu-popover__isNqe\",\"more-menu-group-label\":\"MoreMenuPopover__more-menu-group-label__jynY8\",\"moreMenuGroupLabel\":\"MoreMenuPopover__more-menu-group-label__jynY8\",\"more-menu-item-list\":\"MoreMenuPopover__more-menu-item-list__Py2Fs\",\"moreMenuItemList\":\"MoreMenuPopover__more-menu-item-list__Py2Fs\",\"more-menu-item-target\":\"MoreMenuPopover__more-menu-item-target__AobaZ\",\"moreMenuItemTarget\":\"MoreMenuPopover__more-menu-item-target__AobaZ\",\"compact-button\":\"MoreMenuPopover__compact-button__n0DoJ\",\"compactButton\":\"MoreMenuPopover__compact-button__n0DoJ\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgMore = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 12.25a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 6a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgMore as ReactComponent };","import React, { createContext, useContext, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./MoreMenuPopover.scss\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as MoreIcon } from \"../icons/More.svg\";\nimport { useIntl, defineMessage } from \"react-intl\";\n\nfunction MoreMenuItem({ item, closePopover }) {\n  const Icon = item.icon;\n\n  return (\n    <li onClick={closePopover}>\n      {item.href ? (\n        <a\n          className={styles.moreMenuItemTarget}\n          href={item.href}\n          target={item.target || \"_blank\"}\n          rel=\"noopener noreferrer\"\n        >\n          <Icon />\n          <span>{item.label}</span>\n        </a>\n      ) : (\n        <button className={styles.moreMenuItemTarget} onClick={event => item.onClick(item, event)}>\n          <Icon />\n          <span>{item.label}</span>\n        </button>\n      )}\n    </li>\n  );\n}\n\nMoreMenuItem.propTypes = {\n  item: PropTypes.shape({\n    href: PropTypes.string,\n    target: PropTypes.string,\n    icon: PropTypes.elementType.isRequired,\n    label: PropTypes.node.isRequired,\n    onClick: PropTypes.func\n  }).isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n\nfunction MoreMenuGroup({ group, closePopover }) {\n  return (\n    <li>\n      <h1 className={styles.moreMenuGroupLabel}>{group.label}</h1>\n      <ul className={styles.moreMenuItemList}>\n        {group.items.map(item => <MoreMenuItem key={item.id} item={item} closePopover={closePopover} />)}\n      </ul>\n    </li>\n  );\n}\n\nMoreMenuGroup.propTypes = {\n  group: PropTypes.object.isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n\nfunction MoreMenuPopoverContent({ menu, closePopover }) {\n  return (\n    <div className={styles.moreMenuPopover}>\n      <ul>{menu.map(group => <MoreMenuGroup key={group.id} group={group} closePopover={closePopover} />)}</ul>\n    </div>\n  );\n}\n\nMoreMenuPopoverContent.propTypes = {\n  menu: PropTypes.array.isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n\n// The MoreMenuContext allows us to control the more menu popover visibility from the MoreMenuPopoverButton\n// and CompactMoreMenuButton.\nconst MoreMenuContext = createContext([false, () => {}]);\n\nexport function MoreMenuContextProvider({ initiallyVisible, children }) {\n  const context = useState(initiallyVisible || false);\n  return <MoreMenuContext.Provider value={context}>{children}</MoreMenuContext.Provider>;\n}\n\nMoreMenuContextProvider.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  children: PropTypes.node\n};\n\nconst moreMenuTitle = defineMessage({\n  id: \"more-menu-popover.title\",\n  defaultMessage: \"More\"\n});\n\nexport function MoreMenuPopoverButton({ menu }) {\n  const intl = useIntl();\n  const [visible, setVisible] = useContext(MoreMenuContext);\n  const title = intl.formatMessage(moreMenuTitle);\n\n  return (\n    <Popover\n      title={title}\n      content={props => <MoreMenuPopoverContent menu={menu} {...props} />}\n      placement=\"top-end\"\n      offsetDistance={28}\n      isVisible={visible}\n      onChangeVisible={setVisible}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<MoreIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n        />\n      )}\n    </Popover>\n  );\n}\n\nMoreMenuPopoverButton.propTypes = {\n  menu: PropTypes.array.isRequired\n};\n\n// The CompactMoreMenuButton is only shown in the small breakpoint.\n// We actually render the popover in the MoreMenuPopoverButton so that when resizing the window,\n// the popover positions itself relative to the correct element.\nexport function CompactMoreMenuButton({ className, ...rest }) {\n  const intl = useIntl();\n  const [, setVisible] = useContext(MoreMenuContext);\n\n  return (\n    <button\n      className={classNames(styles.compactButton, className)}\n      aria-label={intl.formatMessage(moreMenuTitle)}\n      onClick={e => {\n        // Stop event bubbling so we don't immediately close the popover by clicking outside it.\n        e.stopPropagation();\n        setVisible(true);\n      }}\n      {...rest}\n    >\n      <MoreIcon />\n    </button>\n  );\n}\n\nCompactMoreMenuButton.propTypes = {\n  className: PropTypes.string\n};\n","import React, { createContext, useCallback, useContext, useEffect, useState, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  ChatSidebar,\n  ChatMessageGroup,\n  SystemMessage,\n  ChatMessageList,\n  ChatInput,\n  MessageAttachmentButton,\n  SpawnMessageButton,\n  ChatToolbarButton,\n  SendMessageButton,\n  EmojiPickerPopoverButton,\n  ChatLengthWarning\n} from \"./ChatSidebar\";\nimport { useMaintainScrollPosition } from \"../misc/useMaintainScrollPosition\";\nimport { spawnChatMessage } from \"../chat-message\";\nimport { discordBridgesForPresences } from \"../../utils/phoenix-utils\";\nimport { useIntl } from \"react-intl\";\nimport { MAX_MESSAGE_LENGTH } from \"../../utils/chat-message\";\n\nconst ChatContext = createContext({ messageGroups: [], sendMessage: () => {} });\n\nlet uniqueMessageId = 0;\n\nconst NEW_MESSAGE_GROUP_TIMEOUT = 1000 * 60;\n\nfunction shouldCreateNewMessageGroup(messageGroups, newMessage, now) {\n  if (messageGroups.length === 0) {\n    return true;\n  }\n\n  const lastMessageGroup = messageGroups[messageGroups.length - 1];\n\n  if (lastMessageGroup.senderSessionId !== newMessage.sessionId) {\n    return true;\n  }\n\n  const lastMessage = lastMessageGroup.messages[lastMessageGroup.messages.length - 1];\n\n  return now - lastMessage.timestamp > NEW_MESSAGE_GROUP_TIMEOUT;\n}\n\nfunction processChatMessage(messageGroups, newMessage) {\n  const now = Date.now();\n  const { name, sent, sessionId, ...messageProps } = newMessage;\n\n  if (shouldCreateNewMessageGroup(messageGroups, newMessage, now)) {\n    return [\n      ...messageGroups,\n      {\n        id: uniqueMessageId++,\n        timestamp: now,\n        sent,\n        sender: name,\n        senderSessionId: sessionId,\n        messages: [{ id: uniqueMessageId++, timestamp: now, ...messageProps }]\n      }\n    ];\n  }\n\n  const lastMessageGroup = messageGroups.pop();\n  lastMessageGroup.messages = [\n    ...lastMessageGroup.messages,\n    { id: uniqueMessageId++, timestamp: now, ...messageProps }\n  ];\n\n  return [...messageGroups, { ...lastMessageGroup }];\n}\n\n// Returns the new message groups array when we receive a message.\n// If the message is ignored, we return the original message group array.\nfunction updateMessageGroups(messageGroups, newMessage) {\n  switch (newMessage.type) {\n    case \"join\":\n    case \"entered\":\n    case \"leave\":\n    case \"display_name_changed\":\n    case \"scene_changed\":\n    case \"hub_name_changed\":\n    case \"hub_changed\":\n    case \"log\":\n      return [\n        ...messageGroups,\n        {\n          id: uniqueMessageId++,\n          systemMessage: true,\n          timestamp: Date.now(),\n          ...newMessage\n        }\n      ];\n    case \"chat\":\n    case \"image\":\n    case \"photo\":\n    case \"video\":\n      return processChatMessage(messageGroups, newMessage);\n    default:\n      return messageGroups;\n  }\n}\n\nexport function ChatContextProvider({ messageDispatch, children }) {\n  const [messageGroups, setMessageGroups] = useState([]);\n  const [unreadMessages, setUnreadMessages] = useState(false);\n\n  useEffect(\n    () => {\n      function onReceiveMessage(event) {\n        const newMessage = event.detail;\n        setMessageGroups(messages => updateMessageGroups(messages, newMessage));\n\n        if (\n          newMessage.type === \"chat\" ||\n          newMessage.type === \"image\" ||\n          newMessage.type === \"photo\" ||\n          newMessage.type === \"video\"\n        ) {\n          setUnreadMessages(true);\n        }\n      }\n\n      if (messageDispatch) {\n        messageDispatch.addEventListener(\"message\", onReceiveMessage);\n      }\n\n      return () => {\n        if (messageDispatch) {\n          messageDispatch.removeEventListener(\"message\", onReceiveMessage);\n        }\n      };\n    },\n    [messageDispatch, setMessageGroups, setUnreadMessages]\n  );\n\n  const sendMessage = useCallback(\n    message => {\n      if (messageDispatch) {\n        messageDispatch.dispatch(message);\n      }\n    },\n    [messageDispatch]\n  );\n\n  const setMessagesRead = useCallback(\n    () => {\n      setUnreadMessages(false);\n    },\n    [setUnreadMessages]\n  );\n\n  return (\n    <ChatContext.Provider value={{ messageGroups, unreadMessages, sendMessage, setMessagesRead }}>\n      {children}\n    </ChatContext.Provider>\n  );\n}\n\nChatContextProvider.propTypes = {\n  children: PropTypes.node,\n  messageDispatch: PropTypes.object\n};\n\nexport function ChatSidebarContainer({ scene, canSpawnMessages, presences, occupantCount, inputEffect, onClose }) {\n  const { messageGroups, sendMessage, setMessagesRead } = useContext(ChatContext);\n  const [onScrollList, listRef, scrolledToBottom] = useMaintainScrollPosition(messageGroups);\n  const [message, setMessage] = useState(\"\");\n  const typingTimeoutRef = useRef();\n  const intl = useIntl();\n  const inputRef = useRef();\n\n  const onKeyDown = useCallback(\n    e => {\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault();\n        if (e.target.value.length <= MAX_MESSAGE_LENGTH) {\n          sendMessage(e.target.value);\n          setMessage(\"\");\n          // intentionally only doing this on \"enter\" press and not clicking of send button\n          if (e.target.value.startsWith(\"/\")) {\n            onClose();\n          }\n        }\n      } else if (e.key === \"Escape\") {\n        onClose();\n      }\n      clearTimeout(typingTimeoutRef.current);\n      typingTimeoutRef.current = setTimeout(() => window.APP.hubChannel.endTyping(), 500);\n      window.APP.hubChannel.beginTyping();\n    },\n    [sendMessage, setMessage, onClose]\n  );\n\n  const onSendMessage = useCallback(\n    () => {\n      sendMessage(message.substring(0, MAX_MESSAGE_LENGTH));\n      setMessage(\"\");\n    },\n    [message, sendMessage, setMessage]\n  );\n\n  const onSpawnMessage = () => {\n    spawnChatMessage(message);\n    setMessage(\"\");\n  };\n\n  const onUploadAttachments = useCallback(\n    e => {\n      // TODO: Right now there's no way to upload files to the chat only.\n      // When we add the place menu whcih will have an explicit button for uploading files,\n      // should we make this attach button only upload to chat?\n      for (const file of e.target.files) {\n        scene.emit(\"add_media\", file);\n      }\n    },\n    [scene]\n  );\n\n  const onSelectEmoji = useCallback(\n    ({ emoji, pickerRemainedOpen }) => {\n      setMessage(message => message + emoji.native);\n      // If the picker remained open, avoid selecting the input so that the\n      // user can keep picking emojis.\n      if (!pickerRemainedOpen) inputRef.current.select();\n    },\n    [setMessage, inputRef]\n  );\n\n  useEffect(() => inputEffect(inputRef.current), [inputEffect, inputRef]);\n\n  useEffect(\n    () => {\n      if (scrolledToBottom) {\n        setMessagesRead();\n      }\n    },\n    [messageGroups, scrolledToBottom, setMessagesRead]\n  );\n\n  const discordBridges = discordBridgesForPresences(presences);\n  const discordSnippet = discordBridges.map(ch => \"#\" + ch).join(\", \");\n  let placeholder;\n\n  if (occupantCount <= 1) {\n    if (discordBridges.length === 0) {\n      placeholder = intl.formatMessage({\n        id: \"chat-sidebar-container.input-placeholder.empty-room\",\n        defaultMessage: \"Nobody is here yet...\"\n      });\n    } else {\n      placeholder = intl.formatMessage(\n        {\n          id: \"chat-sidebar-container.input-placeholder.empty-room-bot\",\n          defaultMessage: \"Send message to {discordChannels}\"\n        },\n        { discordChannels: discordSnippet }\n      );\n    }\n  } else {\n    if (discordBridges.length === 0) {\n      placeholder = intl.formatMessage(\n        {\n          id: \"chat-sidebar-container.input-placeholder.occupants\",\n          defaultMessage:\n            \"{occupantCount, plural, one {Send message to one other...} other {Send message to {occupantCount} others...} }\"\n        },\n        { discordChannels: discordSnippet, occupantCount: occupantCount - 1 }\n      );\n    } else {\n      placeholder = intl.formatMessage(\n        {\n          id: \"chat-sidebar-container.input-placeholder.occupants-and-bot\",\n          defaultMessage:\n            \"{occupantCount, plural, one {Send message to one other and {discordChannels}...} other {Send message to {occupantCount} others and {discordChannels}...} }\"\n        },\n        { discordChannels: discordSnippet, occupantCount: occupantCount - 1 }\n      );\n    }\n  }\n\n  const isMobile = AFRAME.utils.device.isMobile();\n  const isOverMaxLength = message.length > MAX_MESSAGE_LENGTH;\n  return (\n    <ChatSidebar onClose={onClose}>\n      <ChatMessageList ref={listRef} onScroll={onScrollList}>\n        {messageGroups.map(({ id, systemMessage, ...rest }) => {\n          if (systemMessage) {\n            return <SystemMessage key={id} {...rest} />;\n          } else {\n            return <ChatMessageGroup key={id} {...rest} />;\n          }\n        })}\n      </ChatMessageList>\n      <ChatInput\n        id=\"chat-input\"\n        ref={inputRef}\n        onKeyDown={onKeyDown}\n        onChange={e => setMessage(e.target.value)}\n        placeholder={placeholder}\n        value={message}\n        isOverMaxLength={isOverMaxLength}\n        warning={\n          <>\n            {message.length + 50 > MAX_MESSAGE_LENGTH && (\n              <ChatLengthWarning messageLength={message.length} maxLength={MAX_MESSAGE_LENGTH} />\n            )}\n          </>\n        }\n        afterInput={\n          <>\n            {!isMobile && <EmojiPickerPopoverButton onSelectEmoji={onSelectEmoji} />}\n            {message.length === 0 && canSpawnMessages ? (\n              <MessageAttachmentButton onChange={onUploadAttachments} />\n            ) : (\n              <SendMessageButton onClick={onSendMessage} disabled={message.length === 0 || isOverMaxLength} />\n            )}\n            {canSpawnMessages && (\n              <SpawnMessageButton disabled={message.length === 0 || isOverMaxLength} onClick={onSpawnMessage} />\n            )}\n          </>\n        }\n      />\n    </ChatSidebar>\n  );\n}\n\nChatSidebarContainer.propTypes = {\n  canSpawnMessages: PropTypes.bool,\n  presences: PropTypes.object.isRequired,\n  occupantCount: PropTypes.number.isRequired,\n  scene: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  inputEffect: PropTypes.func.isRequired\n};\n\nexport function ChatToolbarButtonContainer(props) {\n  const { unreadMessages } = useContext(ChatContext);\n  return <ChatToolbarButton {...props} statusColor={unreadMessages ? \"unread\" : undefined} />;\n}\n","import { useRef, useEffect, useCallback, useState } from \"react\";\n\nexport function useMaintainScrollPosition(items) {\n  const listRef = useRef();\n  const [scrolledToBottom, setScrolledToBottom] = useState(true);\n\n  const onScrollList = useCallback(\n    e => {\n      const el = e.target;\n      setScrolledToBottom(el.scrollHeight - el.scrollTop === el.clientHeight);\n    },\n    [setScrolledToBottom]\n  );\n\n  useEffect(\n    () => {\n      if (scrolledToBottom) {\n        const el = listRef.current;\n\n        if (el.scrollTop !== el.scrollHeight) {\n          el.scrollTop = el.scrollHeight;\n        }\n      }\n    },\n    [items, scrolledToBottom]\n  );\n\n  return [onScrollList, listRef, scrolledToBottom];\n}\n","// eslint-disable-next-line no-unused-vars\nimport React, { Children } from \"react\";\n\nexport function joinChildren(children, renderSeparator) {\n  const result = Children.toArray(children).reduce(\n    (acc, child) =>\n      acc === null ? (\n        child\n      ) : (\n        <>\n          {acc}\n          {renderSeparator()}\n          {child}\n        </>\n      ),\n    null\n  );\n\n  return result;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"content-menu\":\"ContentMenu__content-menu__ihhYT\",\"contentMenu\":\"ContentMenu__content-menu__ihhYT\",\"content-menu-button\":\"ContentMenu__content-menu-button__I7_3d\",\"contentMenuButton\":\"ContentMenu__content-menu-button__I7_3d\",\"active\":\"ContentMenu__active__UBWaK\",\"separator\":\"ContentMenu__separator__x4GLA\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgObjects = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M9.152 1.791a1.466 1.466 0 0 1 1.449 0l3.424 1.948c.163.093.298.226.393.386.094.16.143.341.144.526v3.76c0 .037-.003.075-.007.113.17.028.334.086.485.171l3.423 1.948c.163.093.299.226.393.386.094.16.144.341.144.526v3.76c0 .184-.05.366-.144.526-.094.16-.229.293-.392.386l-3.424 1.948a1.468 1.468 0 0 1-1.449 0l-3.424-1.948A1.086 1.086 0 0 1 10 16.11a1.083 1.083 0 0 1-.166.117L6.41 18.175a1.468 1.468 0 0 1-1.45 0l-3.423-1.948a1.07 1.07 0 0 1-.393-.386A1.038 1.038 0 0 1 1 15.315v-3.76c0-.185.05-.366.144-.526.094-.16.23-.293.393-.386L4.96 8.695c.079-.044.161-.082.246-.111a1.033 1.033 0 0 1-.014-.173V4.65c0-.185.05-.366.144-.526.094-.16.23-.293.393-.386L9.152 1.79Zm.364 8.672L6.41 8.695a1.462 1.462 0 0 0-.477-.17.345.345 0 0 1-.02-.115V4.837l3.604 2.072v3.554Zm4.265-1.859c-.065.026-.13.056-.19.091l-3.354 1.908V6.91l3.604-2.072V8.41a.347.347 0 0 1-.06.194Zm-8.206.613a.73.73 0 0 0-.252.087L2.097 11.14l3.588 2.063 3.414-1.963-3.37-1.917a1.082 1.082 0 0 1-.154-.106Zm5.204 1.953 3.536 2.033 3.589-2.063-3.227-1.836a.732.732 0 0 0-.506-.08c-.045.036-.094.07-.146.099l-3.246 1.847Zm-.903-8.866a.732.732 0 0 0-.362.096L6.288 4.235 9.877 6.3l3.588-2.064L10.238 2.4a.732.732 0 0 0-.362-.096Zm-.246 13.01v-3.562l-3.585 2.061v3.754h.002l3.423-1.948a.356.356 0 0 0 .165-.206 1.034 1.034 0 0 1-.005-.098Zm.769.176a.35.35 0 0 1-.034-.077c.003-.033.005-.066.005-.098v-3.563l3.585 2.061v3.754h-.002l-3.423-1.948a.357.357 0 0 1-.131-.129Zm-5.074-1.677L1.72 11.741v3.574a.346.346 0 0 0 .178.304l3.424 1.947.002.001v-3.754Zm9.35 3.754h.002l3.424-1.948a.356.356 0 0 0 .178-.304V11.74l-3.603 2.072v3.754Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgObjects as ReactComponent };","import React from \"react\";\nimport className from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport { joinChildren } from \"../misc/joinChildren\";\nimport styles from \"./ContentMenu.scss\";\nimport { ReactComponent as ObjectsIcon } from \"../icons/Objects.svg\";\nimport { ReactComponent as PeopleIcon } from \"../icons/People.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function ContentMenuButton({ active, children, ...props }) {\n  return (\n    <button className={className(styles.contentMenuButton, { [styles.active]: active })} {...props}>\n      {children}\n    </button>\n  );\n}\n\nContentMenuButton.propTypes = {\n  children: PropTypes.node,\n  active: PropTypes.bool\n};\n\nexport function ObjectsMenuButton(props) {\n  return (\n    <ContentMenuButton {...props}>\n      <ObjectsIcon />\n      <span>\n        <FormattedMessage id=\"content-menu.objects-menu-button\" defaultMessage=\"Objects\" />\n      </span>\n    </ContentMenuButton>\n  );\n}\n\nexport function PeopleMenuButton(props) {\n  return (\n    <ContentMenuButton {...props}>\n      <PeopleIcon />\n      <span>\n        <FormattedMessage\n          id=\"content-menu.people-menu-button\"\n          defaultMessage=\"People ({presenceCount})\"\n          values={{ presenceCount: props.presencecount }}\n        />\n      </span>\n    </ContentMenuButton>\n  );\n}\nPeopleMenuButton.propTypes = {\n  presencecount: PropTypes.number\n};\n\nexport function ContentMenu({ children }) {\n  return <div className={styles.contentMenu}>{joinChildren(children, () => <div className={styles.separator} />)}</div>;\n}\n\nContentMenu.propTypes = {\n  children: PropTypes.node\n};\n","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgCamera = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m13.693 5.807-1.04-1.643a1.126 1.126 0 0 0-.856-.414H8.203c-.337 0-.637.159-.856.414l-1.04 1.643c-.22.256-.502.443-.838.443H3.125a1.25 1.25 0 0 0-1.25 1.25V15a1.25 1.25 0 0 0 1.25 1.25h13.75a1.25 1.25 0 0 0 1.25-1.25V7.5a1.25 1.25 0 0 0-1.25-1.25H14.57c-.338 0-.658-.187-.877-.443Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 13.75a3.125 3.125 0 1 0 0-6.25 3.125 3.125 0 0 0 0 6.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.844 6.171v-.86h-.938v.86\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgCamera as ReactComponent };","var _g, _defs;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAvatar = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#a)\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.688 3.75a1.563 1.563 0 1 0 0-3.126 1.563 1.563 0 0 0 0 3.125Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m7.785 11.547-1.187 6.727a.937.937 0 0 0 1.46.93.928.928 0 0 0 .38-.606l.82-4.683v.007s.203-1.27.683-1.27h.121c.489 0 .684 1.27.684 1.27v-.004l.82 4.684a.935.935 0 0 0 1.84-.328l-1.187-6.727-.192-1.16c-.113-.707-.164-1.86.02-2.332.156-.406.552-.555.906-.555h3.61a.937.937 0 0 0 0-1.875H3.438a.937.937 0 1 0 0 1.875H7.05c.36 0 .75.149.906.555.184.473.133 1.625.02 2.332l-.192 1.16Z\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"a\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 20,\n    height: 20,\n    fill: \"#fff\"\n  })))));\n};\n\nexport { SvgAvatar as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDelete = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m4.375 4.375.781 12.5c.037.723.563 1.25 1.25 1.25h7.188c.69 0 1.206-.527 1.25-1.25l.781-12.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.125 4.375h13.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 4.375V2.813a.935.935 0 0 1 .938-.938h3.124a.935.935 0 0 1 .938.938v1.562\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 6.876v8.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m7.188 6.876.312 8.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.813 6.876-.313 8.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgDelete as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgWarningCircle = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.5 10c0-4.14-3.36-7.5-7.5-7.5-4.14 0-7.5 3.36-7.5 7.5 0 4.14 3.36 7.5 7.5 7.5 4.14 0 7.5-3.36 7.5-7.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.776 6.487 10 11.25l.224-4.763a.223.223 0 0 0-.226-.235v0a.224.224 0 0 0-.222.235v0Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 14.371a.782.782 0 1 1 0-1.563.782.782 0 0 1 0 1.563Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgWarningCircle as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHome = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.125 8.28v9.22a.625.625 0 0 0 .625.625H7.5v-5.313a.937.937 0 0 1 .938-.937h3.124a.938.938 0 0 1 .938.937v5.313h3.75a.625.625 0 0 0 .625-.625V8.28\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m18.75 10-8.325-7.968c-.195-.206-.652-.209-.85 0L1.25 10\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.625 6.992V2.5H13.75v2.695\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgHome as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgTextDocument = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 8.643v7.608a1.875 1.875 0 0 1-1.875 1.875h-8.75A1.875 1.875 0 0 1 3.75 16.25V3.75a1.875 1.875 0 0 1 1.875-1.875h3.857c.332 0 .65.131.884.366l5.518 5.518c.234.234.366.552.366.883Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2.188v4.688a1.25 1.25 0 0 0 1.25 1.25h4.688\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875 11.25h6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875 14.376h6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgTextDocument as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6, _path7, _path8, _path9, _path10;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSupport = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.125a8.125 8.125 0 1 0 0-16.25 8.125 8.125 0 0 0 0 16.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 13.125a3.125 3.125 0 1 0 0-6.25 3.125 3.125 0 0 0 0 6.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.125 2.11.313 5.156\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.563 7.266.312-5.157\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.125 17.892.313-5.157\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.563 12.735.312 5.157\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path7 || (_path7 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m17.89 8.125-5.156.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path8 || (_path8 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.734 11.562 5.157.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path9 || (_path9 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m2.11 8.125 5.156.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path10 || (_path10 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m7.266 11.562-5.157.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgSupport as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgShield = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.09 4.39C14.597 3.763 13.153 3.3 10 1.875 6.847 3.3 5.403 3.763 1.91 4.39 1.277 14.42 9.398 17.883 10 18.125c.602-.242 8.723-3.706 8.09-13.735Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgShield as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDiscord = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.246 8.55c-.513 0-.918.45-.918 1 0 .549.414.999.918.999.513 0 .918-.45.918-1 .01-.548-.405-.998-.918-.998Zm3.285 0c-.513 0-.918.45-.918 1 0 .549.414.999.918.999.513 0 .918-.45.918-1 0-.548-.405-.998-.918-.998Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.905 1H3.845A1.85 1.85 0 0 0 2 2.854v12.168a1.85 1.85 0 0 0 1.845 1.854h10.206l-.477-1.665 1.152 1.071 1.089 1.008L17.75 19V2.854A1.85 1.85 0 0 0 15.905 1Zm-3.474 11.754s-.324-.387-.594-.729c1.179-.333 1.629-1.071 1.629-1.071a5.15 5.15 0 0 1-1.035.531c-.45.189-.882.315-1.305.387a6.305 6.305 0 0 1-2.331-.009 7.555 7.555 0 0 1-1.323-.387 5.274 5.274 0 0 1-.657-.306c-.027-.018-.054-.027-.081-.045-.018-.009-.027-.018-.036-.027-.162-.09-.252-.153-.252-.153s.432.72 1.575 1.062c-.27.342-.603.747-.603.747-1.989-.063-2.745-1.368-2.745-1.368 0-2.898 1.296-5.247 1.296-5.247 1.296-.972 2.529-.945 2.529-.945l.09.108c-1.62.468-2.367 1.179-2.367 1.179s.198-.108.531-.261c.963-.423 1.728-.54 2.043-.567.054-.009.099-.018.153-.018a7.336 7.336 0 0 1 4.527.846s-.711-.675-2.241-1.143l.126-.144s1.233-.027 2.529.945c0 0 1.296 2.349 1.296 5.247 0 0-.765 1.305-2.754 1.368Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgDiscord as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLeave = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.5 6.875V5.312a1.563 1.563 0 0 0-1.563-1.562h-7.5a1.562 1.562 0 0 0-1.562 1.562v9.375a1.562 1.562 0 0 0 1.563 1.563h7.5a1.562 1.562 0 0 0 1.562-1.563v-1.562\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16 6.875 19.125 10 16 13.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.46 10h10.665\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgLeave as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"person\":\"PeopleSidebar__person__hP26x\",\"moderator-icon\":\"PeopleSidebar__moderator-icon__ssMMu\",\"moderatorIcon\":\"PeopleSidebar__moderator-icon__ssMMu\",\"presence\":\"PeopleSidebar__presence__xlecK\"};","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDesktop = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.122 3H2.979C2.328 3 1.8 3.528 1.8 4.179v9.428c0 .651.528 1.179 1.179 1.179h14.143c.65 0 1.178-.528 1.178-1.179V4.18C18.3 3.528 17.772 3 17.122 3Z\",\n    stroke: \"currentColor\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.818 17.142-.295-2.357H8.577l-.295 2.357h3.536Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.175 17.142h-8.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.8 11.839v1.768a1.182 1.182 0 0 0 1.179 1.178h14.143a1.182 1.182 0 0 0 1.178-1.178v-1.768H1.8Zm8.25 2.357a.59.59 0 1 1 0-1.18.59.59 0 0 1 0 1.18Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgDesktop as ReactComponent };","var _g, _defs;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPhone = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#a)\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125.625h-6.25C5.839.625 5 1.465 5 2.5v15c0 1.035.84 1.875 1.875 1.875h6.25c1.036 0 1.875-.84 1.875-1.875v-15c0-1.036-.84-1.875-1.875-1.875Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875.625h.938a.312.312 0 0 1 .312.312.625.625 0 0 0 .625.625h2.5a.625.625 0 0 0 .625-.625.312.312 0 0 1 .313-.312h.937\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"a\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 20,\n    height: 20,\n    fill: \"#fff\"\n  })))));\n};\n\nexport { SvgPhone as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVolumeHigh = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.922 7.501H2.188a.312.312 0 0 0-.313.313v4.375a.313.313 0 0 0 .313.312h2.72a.623.623 0 0 1 .396.138l3.573 2.926a.313.313 0 0 0 .498-.251V4.689a.313.313 0 0 0-.498-.252L5.304 7.363a.586.586 0 0 1-.382.138Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.5 12.5c.38-.758.625-1.596.625-2.5 0-.918-.234-1.736-.625-2.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.375 14.374c.76-1.325 1.25-2.502 1.25-4.375 0-1.872-.469-3.036-1.25-4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 16.248c1.172-1.797 1.875-3.571 1.875-6.25 0-2.678-.703-4.414-1.875-6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgVolumeHigh as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVolumeMuted = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 16.876 2.5 3.126\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.75 5.349v1.32c0 .041.017.08.046.11l.937.938a.156.156 0 0 0 .267-.11V4.71a.958.958 0 0 0-.495-.849.934.934 0 0 0-1.024.092L7.234 4.974a.156.156 0 0 0-.012.232l.666.666a.156.156 0 0 0 .21.01l.652-.533Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.75 14.652 5.7 12.155a1.25 1.25 0 0 0-.792-.28H2.5v-3.75h1.981a.156.156 0 0 0 .11-.267l-.937-.937a.156.156 0 0 0-.11-.046H2.187a.937.937 0 0 0-.937.938v4.375a.937.937 0 0 0 .938.937h2.724l3.57 2.922a.934.934 0 0 0 1.392-.27.957.957 0 0 0 .126-.486v-1.96a.156.156 0 0 0-.046-.11l-.937-.937a.157.157 0 0 0-.24.023.157.157 0 0 0-.027.087v2.258Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.75 10c0-.959-.227-1.87-.693-2.783a.625.625 0 0 0-1.114.567c.375.734.557 1.46.557 2.217 0 .104-.004.21-.012.317a.312.312 0 0 0 .09.244l.768.769a.156.156 0 0 0 .264-.079c.093-.41.14-.83.14-1.252Z\",\n    fill: \"currentColor\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 10.001c0-2-.511-3.277-1.335-4.69a.625.625 0 0 0-1.08.63C14.573 7.206 15 8.276 15 10c0 .93-.129 1.675-.366 2.37a.313.313 0 0 0 .074.322l.655.655a.156.156 0 0 0 .255-.05c.4-.958.632-1.972.632-3.297Z\",\n    fill: \"currentColor\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.75 10c0-2.9-.789-4.73-1.973-6.586a.625.625 0 1 0-1.055.673C16.79 5.757 17.5 7.403 17.5 10c0 1.854-.348 3.208-.922 4.414a.156.156 0 0 0 .03.178l.697.697a.157.157 0 0 0 .25-.039c.839-1.647 1.195-3.258 1.195-5.25Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgVolumeMuted as ReactComponent };","var _style, _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHandRaised = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Layer_1\",\n    x: 0,\n    y: 0,\n    viewBox: \"0 0 1.025 0.782\",\n    xmlSpace: \"preserve\",\n    width: 20,\n    height: 20,\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _style || (_style = /*#__PURE__*/React.createElement(\"style\", {\n    type: \"text/css\",\n    id: \"style869\"\n  }, \".st0{fill:#ffd3b6}\")), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"st0\",\n    d: \"M220.8 196.584\",\n    id: \"path871\"\n  })), /*#__PURE__*/React.createElement(\"g\", {\n    id: \"g1059\",\n    transform: \"matrix(.05125 0 0 .05125 -14.217 -12.843)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    className: \"st0\",\n    d: \"M288.372 256.007\",\n    id: \"path1044\",\n    style: {\n      strokeWidth: 0.0389037\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M294.69 257.645c-.424-.378-1.361-.899-3.287.953-.358.342-.572.467-.844.762v-9.134c0-.591-.467-1.074-1.062-1.074-.596 0-1.078.483-1.078 1.074v5.419c0 .506-.654.549-.767.132v-6.465c0-.592-.466-1.074-1.062-1.074-.595 0-1.077.478-1.077 1.074v6.485c-.082.397-.665.381-.708-.047v-5.664a1.06 1.06 0 0 0-1.062-1.07c-.596 0-1.078.478-1.078 1.07v5.575c-.004.007-.004.02-.004.039 0 .486-.626.529-.74.136v-3.992a1.06 1.06 0 0 0-1.061-1.07c-.595 0-1.078.479-1.078 1.07v9.392a4.768 4.768 0 0 0 2.739 4.314v1.525c0 .591.482 1.074 1.074 1.074h4.295c.591 0 1.073-.483 1.073-1.074v-1.081a2.517 2.517 0 0 0 1.755-1.031.313.313 0 0 0 .031-.047c.035-.039.078-.109.128-.21.028-.047.051-.093.074-.144.494-1 1.623-3.708 3.646-5.458.416-.417.517-1.082.093-1.46z\",\n    id: \"path1046\",\n    style: {\n      strokeWidth: 0.0389037,\n      fill: \"#ffd469\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M288.726 266.013H285.4l.007-.007h-.871a4.774 4.774 0 0 1-2.027-.451v1.361c.194.102.38.168.54.168h5.373c.156 0 .339-.051.53-.133v-.949l-.226.012z\",\n    id: \"path1048\",\n    style: {\n      strokeWidth: 0.0389037,\n      fill: \"#ffb636\"\n    }\n  })));\n};\n\nexport { SvgHandRaised as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"list\":\"List__list__wrDsj\",\"list-item\":\"List__list-item__Wa7vr\",\"listItem\":\"List__list-item__Wa7vr\",\"list-item-content\":\"List__list-item-content__fiqda\",\"listItemContent\":\"List__list-item-content__fiqda\",\"button-list-item\":\"List__button-list-item__psIZ3\",\"buttonListItem\":\"List__button-list-item__psIZ3\",\"selected\":\"List__selected__TOa6J\"};","import React, { forwardRef } from \"react\";\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./List.scss\";\n\nexport const List = forwardRef(({ className, children, ...rest }, ref) => {\n  return (\n    <ul {...rest} className={classNames(styles.list, className)} ref={ref}>\n      {children}\n    </ul>\n  );\n});\n\nList.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function ListItem({ className, children, ...rest }) {\n  return (\n    <li {...rest} className={classNames(styles.listItem, styles.listItemContent, className)}>\n      {children}\n    </li>\n  );\n}\n\nListItem.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function ButtonListItem({ className, children, ...rest }) {\n  return (\n    <li className={styles.listItem}>\n      <button {...rest} className={classNames(styles.listItemContent, styles.buttonListItem, className)}>\n        {children}\n      </button>\n    </li>\n  );\n}\n\nButtonListItem.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./PeopleSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as StarIcon } from \"../icons/Star.svg\";\nimport { ReactComponent as DesktopIcon } from \"../icons/Desktop.svg\";\nimport { ReactComponent as DiscordIcon } from \"../icons/Discord.svg\";\nimport { ReactComponent as PhoneIcon } from \"../icons/Phone.svg\";\nimport { ReactComponent as VRIcon } from \"../icons/VR.svg\";\nimport { ReactComponent as VolumeOffIcon } from \"../icons/VolumeOff.svg\";\nimport { ReactComponent as VolumeHighIcon } from \"../icons/VolumeHigh.svg\";\nimport { ReactComponent as VolumeMutedIcon } from \"../icons/VolumeMuted.svg\";\nimport { ReactComponent as HandRaisedIcon } from \"../icons/HandRaised.svg\";\nimport { List, ButtonListItem } from \"../layout/List\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nfunction getDeviceLabel(ctx, intl) {\n  if (ctx) {\n    if (ctx.hmd) {\n      return intl.formatMessage({ id: \"people-sidebar.device-label.vr\", defaultMessage: \"VR\" });\n    } else if (ctx.discord) {\n      return intl.formatMessage({ id: \"people-sidebar.device-label.discord\", defaultMessage: \"Discord Bot\" });\n    } else if (ctx.mobile) {\n      return intl.formatMessage({ id: \"people-sidebar.device-label.mobile\", defaultMessage: \"Mobile\" });\n    }\n  }\n\n  return intl.formatMessage({ id: \"people-sidebar.device-label.desktop\", defaultMessage: \"Desktop\" });\n}\n\nfunction getDeviceIconComponent(ctx) {\n  if (ctx) {\n    if (ctx.hmd) {\n      return VRIcon;\n    } else if (ctx.discord) {\n      return DiscordIcon;\n    } else if (ctx.mobile) {\n      return PhoneIcon;\n    }\n  }\n\n  return DesktopIcon;\n}\n\nfunction getVoiceLabel(micPresence, intl) {\n  if (micPresence) {\n    if (micPresence.talking) {\n      return intl.formatMessage({ id: \"people-sidebar.voice-label.talking\", defaultMessage: \"Talking\" });\n    } else if (micPresence.muted) {\n      return intl.formatMessage({ id: \"people-sidebar.voice-label.muted\", defaultMessage: \"Muted\" });\n    }\n  }\n\n  return intl.formatMessage({ id: \"people-sidebar.voice-label.not-talking\", defaultMessage: \"Not Talking\" });\n}\n\nfunction getVoiceIconComponent(micPresence) {\n  if (micPresence) {\n    if (micPresence.muted) {\n      return VolumeMutedIcon;\n    } else if (micPresence.talking) {\n      return VolumeHighIcon;\n    }\n  }\n\n  return VolumeOffIcon;\n}\n\nfunction getPresenceMessage(presence, intl) {\n  switch (presence) {\n    case \"lobby\":\n      return intl.formatMessage({ id: \"people-sidebar.presence.in-lobby\", defaultMessage: \"In Lobby\" });\n    case \"room\":\n      return intl.formatMessage({ id: \"people-sidebar.presence.in-room\", defaultMessage: \"In Room\" });\n    case \"entering\":\n      return intl.formatMessage({ id: \"people-sidebar.presence.entering\", defaultMessage: \"Entering Room\" });\n    default:\n      return undefined;\n  }\n}\n\nfunction getPersonName(person, intl) {\n  const you = intl.formatMessage({\n    id: \"people-sidebar.person-name.you\",\n    defaultMessage: \"You\"\n  });\n\n  return person.profile.displayName + (person.isMe ? ` (${you})` : \"\");\n}\n\nexport function PeopleSidebar({ people, onSelectPerson, onClose, showMuteAll, onMuteAll }) {\n  const intl = useIntl();\n\n  return (\n    <Sidebar\n      title={\n        <FormattedMessage\n          id=\"people-sidebar.title\"\n          defaultMessage=\"People ({numPeople})\"\n          values={{ numPeople: people.length }}\n        />\n      }\n      beforeTitle={<CloseButton onClick={onClose} />}\n      afterTitle={\n        showMuteAll ? (\n          <IconButton onClick={onMuteAll}>\n            <FormattedMessage id=\"people-sidebar.mute-all-button\" defaultMessage=\"Mute All\" />\n          </IconButton>\n        ) : (\n          undefined\n        )\n      }\n    >\n      <List>\n        {people.map(person => {\n          const DeviceIcon = getDeviceIconComponent(person.context);\n          const VoiceIcon = getVoiceIconComponent(person.micPresence);\n\n          return (\n            <ButtonListItem\n              className={styles.person}\n              key={person.id}\n              type=\"button\"\n              onClick={e => onSelectPerson(person, e)}\n            >\n              {person.hand_raised && <HandRaisedIcon />}\n              {<DeviceIcon title={getDeviceLabel(person.context, intl)} />}\n              {!person.context.discord && VoiceIcon && <VoiceIcon title={getVoiceLabel(person.micPresence, intl)} />}\n              <p>{getPersonName(person, intl)}</p>\n              {person.roles.owner && (\n                <StarIcon\n                  title={intl.formatMessage({ id: \"people-sidebar.moderator-label\", defaultMessage: \"Moderator\" })}\n                  className={styles.moderatorIcon}\n                  width={12}\n                  height={12}\n                />\n              )}\n              <p className={styles.presence}>{getPresenceMessage(person.presence, intl)}</p>\n            </ButtonListItem>\n          );\n        })}\n      </List>\n    </Sidebar>\n  );\n}\n\nPeopleSidebar.propTypes = {\n  people: PropTypes.array,\n  onSelectPerson: PropTypes.func,\n  showMuteAll: PropTypes.bool,\n  onMuteAll: PropTypes.func,\n  onClose: PropTypes.func\n};\n\nPeopleSidebar.defaultProps = {\n  people: [],\n  onSelectPerson: () => {}\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button, CancelButton } from \"../input/Button\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Column } from \"../layout/Column\";\n\nexport function PromoteClientModal({ onClose, onConfirm, displayName }) {\n  return (\n    <Modal title=\"Promote User\" beforeTitle={<CloseButton onClick={onClose} />}>\n      <Column center padding>\n        <p>\n          <FormattedMessage\n            id=\"promote-client-modal.message\"\n            defaultMessage=\"Promoting a user will grant full access to room settings and moderation tools.{linebreak}Are you sure?\"\n            values={{ linebreak: <br /> }}\n          />\n        </p>\n        <Button preset=\"accept\" onClick={onConfirm}>\n          <FormattedMessage\n            id=\"promote-client-modal.confirm-prefix\"\n            defaultMessage=\"Yes, promote {name}\"\n            values={{ name: displayName }}\n          />\n        </Button>\n        <CancelButton preset=\"cancel\" onClick={onClose} />\n      </Column>\n    </Modal>\n  );\n}\n\nPromoteClientModal.propTypes = {\n  displayName: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"avatar-preview-container\":\"UserProfileSidebar__avatar-preview-container__K9Anq\",\"avatarPreviewContainer\":\"UserProfileSidebar__avatar-preview-container__K9Anq\",\"slider-container\":\"UserProfileSidebar__slider-container__yafCa\",\"sliderContainer\":\"UserProfileSidebar__slider-container__yafCa\",\"slider-input-container\":\"UserProfileSidebar__slider-input-container__q8fBZ\",\"sliderInputContainer\":\"UserProfileSidebar__slider-input-container__q8fBZ\"};","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { BackButton } from \"../input/BackButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport styles from \"./UserProfileSidebar.scss\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { Slider } from \"../input/Slider\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as VolumeHigh } from \"../icons/VolumeHigh.svg\";\nimport { ReactComponent as VolumeMuted } from \"../icons/VolumeMuted.svg\";\nimport useAvatarVolume from \"./useAvatarVolume\";\nimport { calcLevel, calcGainMultiplier, MAX_VOLUME_LABELS } from \"../../utils/avatar-volume-utils\";\n\nconst MIN = 0;\nconst MAX = MAX_VOLUME_LABELS - 1;\n\nexport function UserProfileSidebar({\n  className,\n  userId,\n  displayName,\n  identityName,\n  avatarPreview,\n  hasMicPresence,\n  isSignedIn,\n  canPromote,\n  onPromote,\n  canDemote,\n  onDemote,\n  isHidden,\n  onToggleHidden,\n  canMute,\n  isNetworkMuted,\n  onMute,\n  canKick,\n  onKick,\n  showBackButton,\n  onBack,\n  onClose,\n  ...rest\n}) {\n  const intl = useIntl();\n  const [multiplier, updateMultiplier, isMuted, updateMuted] = useAvatarVolume(userId);\n  const onLevelChanged = useCallback(\n    level => {\n      updateMultiplier(calcGainMultiplier(level));\n    },\n    [updateMultiplier]\n  );\n  const newLevel = calcLevel(multiplier);\n  return (\n    <Sidebar\n      title={identityName ? `${displayName} (${identityName})` : displayName}\n      beforeTitle={showBackButton ? <BackButton onClick={onBack} /> : <CloseButton onClick={onClose} />}\n      className={className}\n      {...rest}\n    >\n      <Column center padding>\n        <div className={styles.avatarPreviewContainer}>{avatarPreview || <div />}</div>\n        {hasMicPresence && (\n          <div className={styles.sliderContainer}>\n            <ToolbarButton\n              icon={isNetworkMuted || isMuted ? <VolumeMuted /> : <VolumeHigh />}\n              selected={isNetworkMuted || isMuted}\n              preset=\"accent4\"\n              style={{ display: \"block\" }}\n              onClick={() => {\n                updateMuted(!isMuted);\n              }}\n              disabled={isNetworkMuted}\n            />\n            <Slider\n              min={MIN}\n              max={MAX}\n              step={1}\n              value={newLevel}\n              onChange={onLevelChanged}\n              className={styles.sliderInputContainer}\n              disabled={isNetworkMuted || isMuted}\n            />\n          </div>\n        )}\n        {canPromote && (\n          <Button\n            preset=\"accept\"\n            disabled={!isSignedIn}\n            title={\n              isSignedIn\n                ? intl.formatMessage({ id: \"user-profile-sidebar.promote-button\", defaultMessage: \"Promote\" })\n                : intl.formatMessage(\n                    {\n                      id: \"user-profile-sidebar.promote-button-disabled-label\",\n                      defaultMessage: \"{displayName} is signed out.\"\n                    },\n                    { displayName }\n                  )\n            }\n            onClick={onPromote}\n          >\n            <FormattedMessage id=\"user-profile-sidebar.promote-button\" defaultMessage=\"Promote\" />\n          </Button>\n        )}\n        {canDemote && (\n          <Button\n            preset=\"cancel\"\n            disabled={!isSignedIn}\n            title={\n              isSignedIn\n                ? intl.formatMessage({ id: \"user-profile-sidebar.demote-button\", defaultMessage: \"Demote\" })\n                : intl.formatMessage(\n                    {\n                      id: \"user-profile-sidebar.demote-button-disabled-label\",\n                      defaultMessage: \"{displayName} is signed out.\"\n                    },\n                    { displayName }\n                  )\n            }\n            onClick={onDemote}\n          >\n            <FormattedMessage id=\"user-profile-sidebar.demote-button\" defaultMessage=\"Demote\" />\n          </Button>\n        )}\n        <Button onClick={onToggleHidden}>\n          {isHidden ? (\n            <FormattedMessage id=\"user-profile-sidebar.unhide-button\" defaultMessage=\"Unhide\" />\n          ) : (\n            <FormattedMessage id=\"user-profile-sidebar.hide-button\" defaultMessage=\"Hide\" />\n          )}\n        </Button>\n        {canMute && (\n          <Button preset=\"cancel\" onClick={onMute}>\n            <FormattedMessage id=\"user-profile-sidebar.mute-button\" defaultMessage=\"Mute\" />\n          </Button>\n        )}\n        {canKick && (\n          <Button preset=\"cancel\" onClick={onKick}>\n            <FormattedMessage id=\"user-profile-sidebar.kick-button\" defaultMessage=\"Kick\" />\n          </Button>\n        )}\n      </Column>\n    </Sidebar>\n  );\n}\n\nUserProfileSidebar.propTypes = {\n  className: PropTypes.string,\n  userId: PropTypes.string,\n  displayName: PropTypes.string,\n  identityName: PropTypes.string,\n  avatarPreview: PropTypes.node,\n  hasMicPresence: PropTypes.bool,\n  isSignedIn: PropTypes.bool,\n  canPromote: PropTypes.bool,\n  onPromote: PropTypes.func,\n  canDemote: PropTypes.bool,\n  onDemote: PropTypes.func,\n  isHidden: PropTypes.bool,\n  onToggleHidden: PropTypes.func,\n  canMute: PropTypes.bool,\n  isNetworkMuted: PropTypes.bool,\n  onMute: PropTypes.func,\n  canKick: PropTypes.bool,\n  onKick: PropTypes.func,\n  showBackButton: PropTypes.bool,\n  onBack: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import { useCallback, useEffect, useState } from \"react\";\nimport { getPlayerInfo } from \"../../utils/component-utils\";\n\nexport default function useAvatarVolume(sessionId, onMultiplierChanged) {\n  const playerInfo = getPlayerInfo(sessionId);\n  const controlsEl = playerInfo?.el.querySelector(\"[avatar-volume-controls]\");\n  const controls = controlsEl?.components[\"avatar-volume-controls\"];\n  const [multiplier, setMultiplier] = useState(0);\n  const [isMuted, setIsMuted] = useState(false);\n\n  const onMultiplierUpdated = useCallback(\n    ({ detail: { gainMultiplier } }) => {\n      setMultiplier(gainMultiplier);\n      onMultiplierChanged && onMultiplierChanged(gainMultiplier);\n    },\n    [onMultiplierChanged]\n  );\n\n  const updateMultiplier = useCallback(\n    gainMultiplier => {\n      if (!controls) return;\n      setMultiplier(gainMultiplier);\n      controls.updateGainMultiplier(gainMultiplier, true);\n    },\n    [controls]\n  );\n\n  const onLocalMutedUpdated = useCallback(({ detail: { muted } }) => {\n    setIsMuted(muted);\n  }, []);\n\n  const updateMuted = useCallback(\n    muted => {\n      if (!controls) return;\n      setIsMuted(!!muted);\n      controls.updateLocalMuted(!!muted, true);\n    },\n    [controls]\n  );\n\n  useEffect(\n    () => {\n      if (!controlsEl) return;\n      controlsEl.addEventListener(\"gain_multiplier_updated\", onMultiplierUpdated);\n      controlsEl.addEventListener(\"local_muted_updated\", onLocalMutedUpdated);\n\n      const gainMultiplier = APP.gainMultipliers.get(controls.audioEl);\n      onMultiplierUpdated({ detail: { gainMultiplier } });\n      const isLocalMuted = APP.mutedState.has(controls.audioEl);\n      setIsMuted(isLocalMuted);\n\n      return () => {\n        controlsEl.removeEventListener(\"gain_multiplier_updated\", onMultiplierUpdated);\n        controlsEl.removeEventListener(\"local_muted_updated\", onLocalMutedUpdated);\n      };\n    },\n    [controls, controlsEl, onMultiplierUpdated, onLocalMutedUpdated]\n  );\n\n  return [multiplier, updateMultiplier, isMuted, updateMuted];\n}\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { PromoteClientModal } from \"./PromoteClientModal\";\nimport { getAvatarThumbnailUrl } from \"../../utils/avatar-utils\";\nimport { UserProfileSidebar } from \"./UserProfileSidebar.js\";\nimport { SignInMessages } from \"../auth/SignInModal\";\n\nexport function UserProfileSidebarContainer({\n  user,\n  hubChannel,\n  performConditionalSignIn,\n  showBackButton,\n  onBack,\n  onClose,\n  onCloseDialog,\n  showNonHistoriedDialog\n}) {\n  const [avatarThumbnailUrl, setAvatarThumbnailUrl] = useState();\n\n  const {\n    id: userId,\n    profile: { displayName, identityName, avatarId },\n    roles\n  } = user;\n  const mayKick = hubChannel.canOrWillIfCreator(\"kick_users\");\n  const hasMicPresence = !!user.micPresence;\n  const isNetworkMuted = user.micPresence?.muted;\n  const mayMute = !isNetworkMuted && hubChannel.canOrWillIfCreator(\"mute_users\");\n  const [isOwner, setIsOwner] = useState(!!roles.owner);\n  const isCreator = !!roles.creator;\n  const isSignedIn = !!roles.signed_in;\n  const mayAddOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && !isOwner && !isCreator;\n  const mayRemoveOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && isOwner && !isCreator;\n  const [isHidden, setIsHidden] = useState(hubChannel.isHidden(user.id));\n\n  useEffect(\n    () => {\n      if (avatarId) {\n        getAvatarThumbnailUrl(avatarId).then(avatarThumbnailUrl => setAvatarThumbnailUrl(avatarThumbnailUrl));\n      }\n    },\n    [avatarId, setAvatarThumbnailUrl, user]\n  );\n\n  const addOwner = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"update_roles\"),\n        async () => {\n          showNonHistoriedDialog(PromoteClientModal, {\n            displayName,\n            onConfirm: async () => {\n              setIsOwner(true);\n              await hubChannel.addOwner(userId);\n              onCloseDialog();\n            }\n          });\n        },\n        SignInMessages.addOwner\n      );\n    },\n    [performConditionalSignIn, hubChannel, showNonHistoriedDialog, userId, onCloseDialog, displayName]\n  );\n\n  const removeOwner = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"update_roles\"),\n        async () => {\n          setIsOwner(false);\n          await hubChannel.removeOwner(userId);\n        },\n        SignInMessages.removeOwner\n      );\n    },\n    [performConditionalSignIn, hubChannel, userId]\n  );\n\n  const toggleHidden = useCallback(\n    () => {\n      if (isHidden) {\n        hubChannel.unhide(userId);\n      } else {\n        hubChannel.hide(userId);\n      }\n\n      setIsHidden(!isHidden);\n    },\n    [isHidden, userId, hubChannel]\n  );\n\n  const mute = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"mute_users\"),\n        async () => await hubChannel.mute(userId),\n        SignInMessages.muteUser\n      );\n    },\n    [performConditionalSignIn, hubChannel, userId]\n  );\n\n  const kick = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"kick_users\"),\n        async () => await hubChannel.kick(userId),\n        SignInMessages.kickUser\n      );\n\n      if (onClose) {\n        onClose();\n      } else if (onBack) {\n        onBack();\n      }\n    },\n    [performConditionalSignIn, hubChannel, userId, onClose, onBack]\n  );\n\n  return (\n    <UserProfileSidebar\n      userId={user.id}\n      displayName={displayName}\n      identityName={identityName}\n      avatarPreview={<img src={avatarThumbnailUrl} />}\n      isSignedIn={isSignedIn}\n      canPromote={mayAddOwner}\n      onPromote={addOwner}\n      canDemote={mayRemoveOwner}\n      onDemote={removeOwner}\n      isHidden={isHidden}\n      onToggleHidden={toggleHidden}\n      canMute={mayMute}\n      isNetworkMuted={isNetworkMuted}\n      onMute={mute}\n      canKick={mayKick}\n      onKick={kick}\n      showBackButton={showBackButton}\n      onClose={onClose}\n      onBack={onBack}\n      hasMicPresence={hasMicPresence}\n    />\n  );\n}\n\nUserProfileSidebarContainer.propTypes = {\n  user: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object,\n  performConditionalSignIn: PropTypes.func,\n  showBackButton: PropTypes.bool,\n  onBack: PropTypes.func,\n  onClose: PropTypes.func,\n  onCloseDialog: PropTypes.func.isRequired,\n  showNonHistoriedDialog: PropTypes.func\n};\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { PeopleSidebar } from \"./PeopleSidebar\";\nimport { getMicrophonePresences } from \"../../utils/microphone-presence\";\nimport ProfileEntryPanel from \"../profile-entry-panel\";\nimport { UserProfileSidebarContainer } from \"./UserProfileSidebarContainer\";\n\nexport function userFromPresence(sessionId, presence, micPresences, mySessionId) {\n  const meta = presence.metas[presence.metas.length - 1];\n  const micPresence = micPresences.get(sessionId);\n  return { id: sessionId, isMe: mySessionId === sessionId, micPresence, ...meta };\n}\n\nfunction usePeopleList(presences, mySessionId, micUpdateFrequency = 500) {\n  const [people, setPeople] = useState([]);\n\n  useEffect(\n    () => {\n      let timeout;\n\n      function updateMicrophoneState() {\n        const micPresences = getMicrophonePresences();\n\n        setPeople(\n          Object.entries(presences).map(([id, presence]) => {\n            return userFromPresence(id, presence, micPresences, mySessionId);\n          })\n        );\n\n        timeout = setTimeout(updateMicrophoneState, micUpdateFrequency);\n      }\n\n      updateMicrophoneState();\n\n      return () => {\n        clearTimeout(timeout);\n      };\n    },\n    [presences, micUpdateFrequency, setPeople, mySessionId]\n  );\n\n  return people;\n}\n\nfunction PeopleListContainer({ hubChannel, people, onSelectPerson, onClose }) {\n  const onMuteAll = useCallback(\n    () => {\n      for (const person of people) {\n        if (person.presence === \"room\" && person.permissions && !person.permissions.mute_users) {\n          hubChannel.mute(person.id);\n        }\n      }\n    },\n    [people, hubChannel]\n  );\n\n  return (\n    <PeopleSidebar\n      people={people}\n      onSelectPerson={onSelectPerson}\n      onClose={onClose}\n      onMuteAll={onMuteAll}\n      showMuteAll={hubChannel.can(\"mute_users\")}\n    />\n  );\n}\n\nPeopleListContainer.propTypes = {\n  onSelectPerson: PropTypes.func.isRequired,\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  people: PropTypes.array.isRequired\n};\n\nexport function PeopleSidebarContainer({\n  hubChannel,\n  presences,\n  mySessionId,\n  displayNameOverride,\n  store,\n  mediaSearchStore,\n  performConditionalSignIn,\n  onCloseDialog,\n  showNonHistoriedDialog,\n  onClose\n}) {\n  const people = usePeopleList(presences, mySessionId);\n  const [selectedPersonId, setSelectedPersonId] = useState(null);\n  const selectedPerson = people.find(person => person.id === selectedPersonId);\n  const setSelectedPerson = useCallback(\n    person => {\n      setSelectedPersonId(person.id);\n    },\n    [setSelectedPersonId]\n  );\n\n  if (selectedPerson) {\n    if (selectedPerson.id === mySessionId) {\n      return (\n        <ProfileEntryPanel\n          containerType=\"sidebar\"\n          displayNameOverride={displayNameOverride}\n          store={store}\n          mediaSearchStore={mediaSearchStore}\n          finished={() => setSelectedPersonId(null)}\n          history={history}\n          showBackButton\n          onBack={() => setSelectedPersonId(null)}\n        />\n      );\n    } else {\n      return (\n        <UserProfileSidebarContainer\n          user={selectedPerson}\n          hubChannel={hubChannel}\n          performConditionalSignIn={performConditionalSignIn}\n          showBackButton\n          onBack={() => setSelectedPersonId(null)}\n          onCloseDialog={onCloseDialog}\n          showNonHistoriedDialog={showNonHistoriedDialog}\n        />\n      );\n    }\n  }\n\n  return (\n    <PeopleListContainer onSelectPerson={setSelectedPerson} onClose={onClose} hubChannel={hubChannel} people={people} />\n  );\n}\n\nPeopleSidebarContainer.propTypes = {\n  displayNameOverride: PropTypes.string,\n  store: PropTypes.object.isRequired,\n  mediaSearchStore: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object.isRequired,\n  history: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  mySessionId: PropTypes.string.isRequired,\n  presences: PropTypes.object.isRequired,\n  performConditionalSignIn: PropTypes.func.isRequired,\n  onCloseDialog: PropTypes.func.isRequired,\n  showNonHistoriedDialog: PropTypes.func.isRequired\n};\n","import { faVideo } from \"@fortawesome/free-solid-svg-icons/faVideo\";\nimport { faMusic } from \"@fortawesome/free-solid-svg-icons/faMusic\";\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\nimport { faNewspaper } from \"@fortawesome/free-solid-svg-icons/faNewspaper\";\nimport { faQuestion } from \"@fortawesome/free-solid-svg-icons/faQuestion\";\nimport { faCube } from \"@fortawesome/free-solid-svg-icons/faCube\";\n\nexport const SORT_ORDER_VIDEO = 0;\nexport const SORT_ORDER_AUDIO = 1;\nexport const SORT_ORDER_IMAGE = 2;\nexport const SORT_ORDER_PDF = 3;\nexport const SORT_ORDER_MODEL = 4;\nexport const SORT_ORDER_UNIDENTIFIED = 5;\n\nexport function mediaSortOrder(el) {\n  if (el.components[\"media-video\"] && el.components[\"media-video\"].data.contentType.startsWith(\"audio/\")) {\n    return SORT_ORDER_AUDIO;\n  }\n  if (el.components[\"media-video\"]) return SORT_ORDER_VIDEO;\n  if (el.components[\"media-image\"]) return SORT_ORDER_IMAGE;\n  if (el.components[\"media-pdf\"]) return SORT_ORDER_PDF;\n  if (el.components[\"gltf-model-plus\"]) return SORT_ORDER_MODEL;\n  return SORT_ORDER_UNIDENTIFIED;\n}\n\nexport function mediaSort(el1, el2) {\n  return mediaSortOrder(el1) - mediaSortOrder(el2);\n}\n\nexport const DISPLAY_IMAGE = new Map([\n  [SORT_ORDER_VIDEO, faVideo],\n  [SORT_ORDER_AUDIO, faMusic],\n  [SORT_ORDER_IMAGE, faImage],\n  [SORT_ORDER_PDF, faNewspaper],\n  [SORT_ORDER_UNIDENTIFIED, faQuestion],\n  [SORT_ORDER_MODEL, faCube]\n]);\n\nconst SORT_ORDER_TO_TYPE = {\n  [SORT_ORDER_VIDEO]: \"video\",\n  [SORT_ORDER_AUDIO]: \"audio\",\n  [SORT_ORDER_IMAGE]: \"image\",\n  [SORT_ORDER_PDF]: \"pdf\",\n  [SORT_ORDER_MODEL]: \"model\"\n};\n\nexport function getMediaType(el) {\n  const order = mediaSortOrder(el);\n  return SORT_ORDER_TO_TYPE[order];\n}\n","import React, { useState, useEffect, useContext, createContext, useCallback, Children, cloneElement } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { mediaSort, getMediaType } from \"../../utils/media-sorting.js\";\n\nfunction getDisplayString(el) {\n  // Having a listed-media component does not guarantee the existence of a media-loader component,\n  // so don't crash if there isn't one.\n  const url = (el.components[\"media-loader\"] && el.components[\"media-loader\"].data.src) || \"\";\n  const split = url.split(\"/\");\n  const resourceName = split[split.length - 1].split(\"?\")[0];\n  let httpIndex = -1;\n  for (let i = 0; i < split.length; i++) {\n    if (split[i].indexOf(\"http\") !== -1) {\n      httpIndex = i;\n    }\n  }\n\n  let host = \"\";\n  let lessHost = \"\";\n  if (httpIndex !== -1 && split.length > httpIndex + 3) {\n    host = split[httpIndex + 2];\n    const hostSplit = host.split(\".\");\n    if (hostSplit.length > 1) {\n      lessHost = `${hostSplit[hostSplit.length - 2]}.${hostSplit[hostSplit.length - 1]}`;\n    }\n  }\n\n  const firstPart =\n    url.indexOf(\"sketchfab.com\") !== -1 ? \"Sketchfab\" : url.indexOf(\"youtube.com\") !== -1 ? \"YouTube\" : lessHost;\n\n  return `${firstPart} ... ${resourceName.substr(0, 4)}`;\n}\n\nconst ObjectListContext = createContext({\n  objects: [],\n  focusedObject: null,\n  selectedObject: null,\n  focusObject: () => {},\n  unfocusObject: () => {},\n  inspectObject: () => {},\n  uninspectObject: () => {}\n});\n\nfunction handleInspect(scene, object, callback) {\n  const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n\n  callback(object);\n\n  if (object.el.object3D !== cameraSystem.inspectable) {\n    if (cameraSystem.inspectable) {\n      cameraSystem.uninspect(false);\n    }\n\n    cameraSystem.inspect(object.el, 1.5, false);\n  }\n}\n\nfunction handleDeselect(scene, object, callback) {\n  const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n\n  callback(null);\n\n  cameraSystem.uninspect(false);\n\n  if (object) {\n    cameraSystem.inspect(object.el, 1.5, false);\n  }\n}\n\nexport function ObjectListProvider({ scene, children }) {\n  const [objects, setObjects] = useState([]);\n  const [focusedObject, setFocusedObject] = useState(null); // The object currently shown in the viewport\n  const [selectedObject, setSelectedObject] = useState(null); // The object currently selected in the object list\n  const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n  const [lightsEnabled, setLightsEnabled] = useState(cameraSystem.lightsEnabled);\n\n  useEffect(\n    () => {\n      function updateMediaEntities() {\n        const objects = scene.systems[\"listed-media\"].els.sort(mediaSort).map(el => ({\n          id: el.object3D.id,\n          name: getDisplayString(el),\n          type: getMediaType(el),\n          el\n        }));\n\n        setObjects(objects);\n      }\n\n      let timeout;\n\n      function onListedMediaChanged() {\n        // HACK: The listed-media component exists before the media-loader component does, in cases where an entity is created from a network template because of an incoming message, so don't updateMediaEntities right away.\n        // Sorry in advance for the day this comment is out of date.\n        timeout = setTimeout(() => updateMediaEntities(), 0);\n      }\n\n      scene.addEventListener(\"listed_media_changed\", onListedMediaChanged);\n\n      updateMediaEntities();\n\n      return () => {\n        scene.removeEventListener(\"listed_media_changed\", updateMediaEntities);\n        clearTimeout(timeout);\n      };\n    },\n    [scene, setObjects]\n  );\n\n  useEffect(\n    () => {\n      function onInspectTargetChanged() {\n        const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n\n        const inspectedEl = cameraSystem.inspectable && cameraSystem.inspectable.el;\n\n        if (inspectedEl) {\n          const object = objects.find(o => o.el === inspectedEl);\n\n          if (object) {\n            setSelectedObject(object);\n          } else {\n            setSelectedObject({\n              id: inspectedEl.object3D.id,\n              name: getDisplayString(inspectedEl),\n              type: getMediaType(inspectedEl),\n              el: inspectedEl\n            });\n          }\n        } else {\n          setSelectedObject(null);\n        }\n      }\n\n      scene.addEventListener(\"inspect-target-changed\", onInspectTargetChanged);\n\n      return () => {\n        scene.removeEventListener(\"inspect-target-changed\", onInspectTargetChanged);\n      };\n    },\n    [scene, setSelectedObject, objects]\n  );\n\n  useEffect(\n    () => {\n      function onLightsChanged() {\n        const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n        setLightsEnabled(cameraSystem.lightsEnabled);\n      }\n\n      scene.addEventListener(\"inspect-lights-changed\", onLightsChanged);\n\n      return () => {\n        scene.removeEventListener(\"inspect-lights-changed\", onLightsChanged);\n      };\n    },\n    [scene]\n  );\n\n  const selectObject = useCallback(object => handleInspect(scene, object, setSelectedObject), [\n    scene,\n    setSelectedObject\n  ]);\n\n  const deselectObject = useCallback(() => handleDeselect(scene, focusedObject, setSelectedObject), [\n    scene,\n    setSelectedObject,\n    focusedObject\n  ]);\n\n  const focusObject = useCallback(object => handleInspect(scene, object, setFocusedObject), [scene, setFocusedObject]);\n\n  const unfocusObject = useCallback(() => handleDeselect(scene, selectedObject, setFocusedObject), [\n    scene,\n    setFocusedObject,\n    selectedObject\n  ]);\n\n  const selectNextObject = useCallback(\n    () => {\n      const curObjIdx = objects.indexOf(selectedObject);\n\n      if (curObjIdx !== -1) {\n        const nextObjIdx = (curObjIdx + 1) % objects.length;\n        selectObject(objects[nextObjIdx]);\n      }\n    },\n    [selectObject, objects, selectedObject]\n  );\n\n  const selectPrevObject = useCallback(\n    () => {\n      const curObjIdx = objects.indexOf(selectedObject);\n\n      if (curObjIdx !== -1) {\n        const nextObjIdx = curObjIdx === 0 ? objects.length - 1 : curObjIdx - 1;\n        selectObject(objects[nextObjIdx]);\n      }\n    },\n    [selectObject, objects, selectedObject]\n  );\n\n  const toggleLights = useCallback(\n    () => {\n      const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n      cameraSystem.toggleLights();\n    },\n    [scene]\n  );\n\n  const context = {\n    objects,\n    activeObject: focusedObject || selectedObject,\n    focusedObject,\n    selectedObject,\n    focusObject,\n    unfocusObject,\n    selectObject,\n    deselectObject,\n    selectPrevObject,\n    selectNextObject,\n    toggleLights,\n    lightsEnabled\n  };\n\n  // Note: If we move ui-root to a functional component and use hooks,\n  // we can use the useObjectList hook instead of cloneElement.\n\n  return (\n    <ObjectListContext.Provider value={context}>\n      {Children.map(children, child => cloneElement(child, { ...context }))}\n    </ObjectListContext.Provider>\n  );\n}\n\nObjectListProvider.propTypes = {\n  scene: PropTypes.object.isRequired,\n  children: PropTypes.node\n};\n\nexport function useObjectList() {\n  return useContext(ObjectListContext);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"object\":\"ObjectsSidebar__object__sVTgg\",\"no-objects\":\"ObjectsSidebar__no-objects__R4i8v\",\"noObjects\":\"ObjectsSidebar__no-objects__R4i8v\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgObject = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.5 13.336v-6.67a1.25 1.25 0 0 0-.62-1.079l-5.938-3.455a1.873 1.873 0 0 0-1.885 0L3.121 5.587A1.25 1.25 0 0 0 2.5 6.666v6.67a1.25 1.25 0 0 0 .62 1.08l5.938 3.455a1.875 1.875 0 0 0 1.885 0l5.937-3.456a1.249 1.249 0 0 0 .62-1.079Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.695 6.016 10 10.313l7.305-4.297\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.125v-7.812\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgObject as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgImage = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 3.125H3.75c-1.035 0-1.875.84-1.875 1.875v10c0 1.036.84 1.875 1.875 1.875h12.5c1.036 0 1.875-.839 1.875-1.874V5c0-1.036-.84-1.876-1.875-1.876Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125 8.125a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.875 13.116 8.334 9.581a1.25 1.25 0 0 0-1.714-.05l-4.745 4.218\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.75 16.875 4.818-4.818a1.25 1.25 0 0 1 1.684-.078l2.873 2.396\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgImage as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVideo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14.64 12.061 3.231 2.275a.625.625 0 0 0 .879-.572v-7.53a.625.625 0 0 0-.879-.57l-3.23 2.274a.625.625 0 0 0-.266.51v3.102a.624.624 0 0 0 .265.511Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.469 14.998H3.28a2.037 2.037 0 0 1-2.031-2.03V7.03a2.037 2.037 0 0 1 2.031-2.031h7.207A2.019 2.019 0 0 1 12.5 7.01v5.956a2.037 2.037 0 0 1-2.031 2.031Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgVideo as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAudio = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 8.516V8.28c0-.58.39-1.054.947-1.195l6.82-1.823a.782.782 0 0 1 .983.753v.86\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 11.559v3.125c0 .543-.349 1-.86 1.171l-.859.313c-1.011.34-2.031-.407-2.031-1.484a1.304 1.304 0 0 1 .898-1.25l1.993-.71c.51-.171.859-.622.859-1.165Zm0 0V2.264a.392.392 0 0 0-.492-.375l-7.79 2.094a.644.644 0 0 0-.468.625v8.828c0 .543-.349 1-.86 1.172l-2.03.703c-.543.183-.86.672-.86 1.25 0 1.077 1.036 1.818 2.031 1.484l.86-.312c.51-.172.859-.628.859-1.172v-3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgAudio as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ObjectsSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { ButtonListItem } from \"../layout/List\";\nimport listStyles from \"../layout/List.scss\";\nimport { ReactComponent as ObjectIcon } from \"../icons/Object.svg\";\nimport { ReactComponent as ImageIcon } from \"../icons/Image.svg\";\nimport { ReactComponent as VideoIcon } from \"../icons/Video.svg\";\nimport { ReactComponent as AudioIcon } from \"../icons/Audio.svg\";\nimport { ReactComponent as TextDocumentIcon } from \"../icons/TextDocument.svg\";\nimport { defineMessages, FormattedMessage, useIntl } from \"react-intl\";\n\nfunction getObjectIcon(type) {\n  switch (type) {\n    case \"video\":\n      return VideoIcon;\n    case \"audio\":\n      return AudioIcon;\n    case \"image\":\n      return ImageIcon;\n    case \"pdf\":\n      return TextDocumentIcon;\n    case \"model\":\n    default:\n      return ObjectIcon;\n  }\n}\n\nconst objectTypeNames = defineMessages({\n  video: { id: \"objects-sidebar.object-type.video\", defaultMessage: \"Video\" },\n  audio: { id: \"objects-sidebar.object-type.audio\", defaultMessage: \"Audio\" },\n  image: { id: \"objects-sidebar.object-type.image\", defaultMessage: \"Image\" },\n  pdf: { id: \"objects-sidebar.object-type.pdf\", defaultMessage: \"PDF\" },\n  model: { id: \"objects-sidebar.object-type.model\", defaultMessage: \"Model\" },\n  default: { id: \"objects-sidebar.object-type.default\", defaultMessage: \"Object\" }\n});\n\nexport function ObjectsSidebarItem({ selected, object, ...rest }) {\n  const intl = useIntl();\n  const ObjectTypeIcon = getObjectIcon(object.type);\n\n  return (\n    <ButtonListItem\n      {...rest}\n      className={classNames(styles.object, { [listStyles.selected]: selected })}\n      type=\"button\"\n      aria-label={intl.formatMessage(\n        { id: \"objects-sidebar.object-label\", defaultMessage: \"{objectType}: {objectName}\" },\n        {\n          objectType: intl.formatMessage(objectTypeNames[object.type] || objectTypeNames.default),\n          objectName: object.name\n        }\n      )}\n    >\n      <ObjectTypeIcon />\n      <p>{object.name}</p>\n    </ButtonListItem>\n  );\n}\n\nObjectsSidebarItem.propTypes = {\n  selected: PropTypes.bool,\n  object: PropTypes.shape({\n    id: PropTypes.any.isRequired,\n    name: PropTypes.string.isRequired,\n    type: PropTypes.string\n  })\n};\n\nexport function NoObjects({ canAddObjects }) {\n  return (\n    <li className={styles.noObjects}>\n      <p>\n        <FormattedMessage id=\"objects-sidebar.no-objects\" defaultMessage=\"There are no objects in the room.\" />\n      </p>\n      {canAddObjects && (\n        <p>\n          <FormattedMessage id=\"objects-sidebar.place-menu-tip\" defaultMessage=\"Use the place menu to add objects.\" />\n        </p>\n      )}\n    </li>\n  );\n}\n\nNoObjects.propTypes = {\n  canAddObjects: PropTypes.bool\n};\n\nexport function ObjectsSidebar({ children, objectCount, onClose }) {\n  return (\n    <Sidebar\n      title={\n        <FormattedMessage\n          id=\"objects-sidebar.title\"\n          defaultMessage=\"Objects ({objectCount})\"\n          values={{ objectCount }}\n        />\n      }\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <ul>{children}</ul>\n    </Sidebar>\n  );\n}\n\nObjectsSidebar.propTypes = {\n  objectCount: PropTypes.number.isRequired,\n  children: PropTypes.node,\n  onClose: PropTypes.func\n};\n\nObjectsSidebar.defaultProps = {\n  objectCount: 0\n};\n","import React, { useCallback, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { NoObjects, ObjectsSidebar, ObjectsSidebarItem } from \"./ObjectsSidebar\";\nimport { List } from \"../layout/List\";\nimport { useObjectList } from \"./useObjectList\";\n\nexport function ObjectsSidebarContainer({ onClose, hubChannel }) {\n  const listRef = useRef();\n  const { objects, selectedObject, selectObject, unfocusObject, focusObject } = useObjectList();\n\n  const onUnfocusListItem = useCallback(\n    e => {\n      if (e.relatedTarget === listRef.current || !listRef.current.contains(e.relatedTarget)) {\n        unfocusObject();\n      }\n    },\n    [unfocusObject, listRef]\n  );\n\n  return (\n    <ObjectsSidebar objectCount={objects.length} onClose={onClose}>\n      {objects.length > 0 ? (\n        <List ref={listRef}>\n          {objects.map(object => (\n            <ObjectsSidebarItem\n              selected={selectedObject === object}\n              object={object}\n              key={object.id}\n              onClick={() => selectObject(object)}\n              onMouseOver={() => focusObject(object)}\n              onFocus={() => focusObject(object)}\n              onMouseOut={onUnfocusListItem}\n              onBlur={onUnfocusListItem}\n            />\n          ))}\n        </List>\n      ) : (\n        <NoObjects canAddObjects={hubChannel.can(\"spawn_and_move_media\")} />\n      )}\n    </ObjectsSidebar>\n  );\n}\n\nObjectsSidebarContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"back-button\":\"ObjectMenu__back-button__ICMWs\",\"backButton\":\"ObjectMenu__back-button__ICMWs\",\"lights-button\":\"ObjectMenu__lights-button__fapNn\",\"lightsButton\":\"ObjectMenu__lights-button__fapNn\",\"object-menu-container\":\"ObjectMenu__object-menu-container__ot90K\",\"objectMenuContainer\":\"ObjectMenu__object-menu-container__ot90K\",\"object-menu\":\"ObjectMenu__object-menu__IKHRK\",\"objectMenu\":\"ObjectMenu__object-menu__IKHRK\",\"header\":\"ObjectMenu__header__Rbudi\",\"close-button\":\"ObjectMenu__close-button__WCIkA\",\"closeButton\":\"ObjectMenu__close-button__WCIkA\",\"lights-header-button\":\"ObjectMenu__lights-header-button__Cowoe\",\"lightsHeaderButton\":\"ObjectMenu__lights-header-button__Cowoe\",\"menu\":\"ObjectMenu__menu__CAJfI\",\"object-menu-button\":\"ObjectMenu__object-menu-button__TEFnB\",\"objectMenuButton\":\"ObjectMenu__object-menu-button__TEFnB\",\"separator\":\"ObjectMenu__separator__rZsbV\",\"pagination\":\"ObjectMenu__pagination__tAo_e\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLightbulb = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.25 18.125h-2.5a.625.625 0 1 0 0 1.25h2.5a.625.625 0 0 0 0-1.25Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.875 16.25h-3.75a.625.625 0 0 0 0 1.25h3.75a.625.625 0 1 0 0-1.25Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.43 2.449A6.214 6.214 0 0 0 10 .625a6.235 6.235 0 0 0-6.25 6.25c0 1.821.698 3.525 1.914 4.674l.17.16c.704.657 1.666 1.558 1.666 2.354V15a.625.625 0 0 0 .625.625h.938a.313.313 0 0 0 .312-.312v-4.578a.313.313 0 0 0-.2-.291 5.104 5.104 0 0 1-1.022-.561.625.625 0 1 1 .726-1.016c.289.205.845.508 1.121.508s.832-.304 1.122-.508a.625.625 0 0 1 .725 1.016 5.102 5.102 0 0 1-1.022.56.313.313 0 0 0-.2.291v4.579a.313.313 0 0 0 .313.312h.937A.625.625 0 0 0 12.5 15v-.937c0-.777.952-1.677 1.646-2.335l.192-.182c1.251-1.194 1.912-2.811 1.912-4.67a6.216 6.216 0 0 0-1.82-4.427Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgLightbulb as ReactComponent };","var _path, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLightbulbOutline = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.875 15v-.937c0-1.133 1.232-2.204 2.031-2.969 1.127-1.077 1.719-2.523 1.719-4.218A5.595 5.595 0 0 0 10 1.25a5.61 5.61 0 0 0-5.625 5.625c0 1.634.618 3.179 1.719 4.218.795.75 2.031 1.825 2.031 2.97V15\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.75 18.75h2.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.125 16.875h3.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 15v-5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.484 9.375S10.644 10 10 10s-1.484-.625-1.484-.625\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgLightbulbOutline as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { joinChildren } from \"../misc/joinChildren\";\nimport styles from \"./ObjectMenu.scss\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as CloseIcon } from \"../icons/Close.svg\";\nimport { ReactComponent as ChevronBackIcon } from \"../icons/ChevronBack.svg\";\nimport { ReactComponent as ArrowBackIcon } from \"../icons/ArrowBack.svg\";\nimport { ReactComponent as ArrowForwardIcon } from \"../icons/ArrowForward.svg\";\nimport { ReactComponent as LightbulbIcon } from \"../icons/Lightbulb.svg\";\nimport { ReactComponent as LightbulbOutlineIcon } from \"../icons/LightbulbOutline.svg\";\n\nexport function ObjectMenuButton({ children, className, ...rest }) {\n  return (\n    <IconButton compactSm className={classNames(styles.objectMenuButton, className)} {...rest}>\n      {children}\n    </IconButton>\n  );\n}\n\nObjectMenuButton.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function ObjectMenu({\n  children,\n  title,\n  onClose,\n  onBack,\n  onPrevObject,\n  onNextObject,\n  currentObjectIndex,\n  objectCount,\n  onToggleLights,\n  lightsEnabled\n}) {\n  return (\n    <>\n      <IconButton className={styles.backButton} onClick={onBack}>\n        <ChevronBackIcon width={24} height={24} />\n      </IconButton>\n      <IconButton className={styles.lightsButton} onClick={onToggleLights}>\n        {lightsEnabled ? (\n          <LightbulbOutlineIcon title=\"Turn Lights Off\" width={24} height={24} />\n        ) : (\n          <LightbulbIcon title=\"Turn Lights On\" width={24} height={24} />\n        )}\n      </IconButton>\n      <div className={styles.objectMenuContainer}>\n        <div className={styles.objectMenu}>\n          <div className={styles.header}>\n            <IconButton className={styles.closeButton} onClick={onClose}>\n              <CloseIcon width={16} height={16} />\n            </IconButton>\n            <h5>{title}</h5>\n            <IconButton className={styles.lightsHeaderButton} onClick={onToggleLights}>\n              {lightsEnabled ? (\n                <LightbulbOutlineIcon title=\"Turn Lights Off\" width={16} height={16} />\n              ) : (\n                <LightbulbIcon title=\"Turn Lights On\" width={16} height={16} />\n              )}\n            </IconButton>\n          </div>\n          <div className={styles.menu}>{joinChildren(children, () => <div className={styles.separator} />)}</div>\n        </div>\n        <div className={styles.pagination}>\n          <IconButton onClick={onPrevObject}>\n            <ArrowBackIcon width={24} height={24} />\n          </IconButton>\n          <p>\n            {currentObjectIndex + 1}/{objectCount}\n          </p>\n          <IconButton onClick={onNextObject}>\n            <ArrowForwardIcon width={24} height={24} />\n          </IconButton>\n        </div>\n      </div>\n    </>\n  );\n}\n\nObjectMenu.propTypes = {\n  currentObjectIndex: PropTypes.number.isRequired,\n  objectCount: PropTypes.number.isRequired,\n  onPrevObject: PropTypes.func,\n  onNextObject: PropTypes.func,\n  children: PropTypes.node,\n  title: PropTypes.node,\n  onClose: PropTypes.func,\n  onBack: PropTypes.func,\n  onToggleLights: PropTypes.func,\n  lightsEnabled: PropTypes.bool\n};\n","export function removeNetworkedObject(scene, targetEl) {\n  if (!NAF.utils.isMine(targetEl) && !NAF.utils.takeOwnership(targetEl)) return;\n\n  targetEl.setAttribute(\"animation__remove\", {\n    property: \"scale\",\n    dur: 200,\n    to: { x: 0.01, y: 0.01, z: 0.01 },\n    easing: \"easeInQuad\"\n  });\n\n  targetEl.addEventListener(\"animationcomplete\", () => {\n    scene.systems[\"hubs-systems\"].cameraSystem.uninspect();\n    NAF.utils.takeOwnership(targetEl);\n    targetEl.parentNode.removeChild(targetEl);\n  });\n}\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPin = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 22,\n    height: 22,\n    viewBox: \"0 0 22 22\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M10.463 12.668a.751.751 0 0 1-.07.08l-5.08 5.081a.75.75 0 1 1-1.061-1.06l5.08-5.081a.758.758 0 0 1 .081-.07l-.386-.386-2.536-2.537a1.12 1.12 0 0 1-.331-.8c0-.266.092-.542.285-.753a4.598 4.598 0 0 1 3.593-1.516h.193a2.74 2.74 0 0 0 2.739-2.739v-.67c0-.304.119-.589.33-.8a1.143 1.143 0 0 1 1.608 0l5.68 5.68c.211.21.33.495.33.799 0 .625-.514 1.14-1.13 1.14h-.67a2.74 2.74 0 0 0-2.74 2.738V11.986a4.995 4.995 0 0 1-1.47 3.528 1.143 1.143 0 0 1-1.608 0l-2.536-2.546-.3-.3Zm-.486-5.544.03.002h.224a4.24 4.24 0 0 0 4.233-4.032L18.91 7.54a4.24 4.24 0 0 0-4.031 4.234V11.986c0 .798-.28 1.574-.787 2.197l-2.266-2.273-.001-.002-1.737-1.737-2.276-2.275a3.098 3.098 0 0 1 2.165-.772Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgPin as ReactComponent };","import { useEffect, useState, useCallback, useMemo } from \"react\";\nimport { removeNetworkedObject } from \"../../utils/removeNetworkedObject\";\nimport { rotateInPlaceAroundWorldUp, affixToWorldUp } from \"../../utils/three-utils\";\nimport { getPromotionTokenForFile } from \"../../utils/media-utils\";\nimport { hasComponent } from \"bitecs\";\nimport { Pinnable, Pinned, Static } from \"../../bit-components\";\n\nfunction getPinnedState(el) {\n  return !!(hasComponent(APP.world, Pinnable, el.eid) && hasComponent(APP.world, Pinned, el.eid));\n}\n\nexport function isMe(object) {\n  return object.el.id === \"avatar-rig\";\n}\n\nexport function isPlayer(object) {\n  return !!object.el.components[\"networked-avatar\"];\n}\n\nexport function getObjectUrl(object) {\n  const mediaLoader = object.el.components[\"media-loader\"];\n\n  const url =\n    mediaLoader && ((mediaLoader.data.mediaOptions && mediaLoader.data.mediaOptions.href) || mediaLoader.data.src);\n\n  if (url && !url.startsWith(\"hubs://\")) {\n    return url;\n  }\n\n  return null;\n}\n\nexport function usePinObject(hubChannel, scene, object) {\n  const [isPinned, setIsPinned] = useState(getPinnedState(object.el));\n\n  const pinObject = useCallback(\n    () => {\n      const el = object.el;\n      if (!NAF.utils.isMine(el) && !NAF.utils.takeOwnership(el)) return;\n      window.APP.pinningHelper.setPinned(el, true);\n    },\n    [object]\n  );\n\n  const unpinObject = useCallback(\n    () => {\n      const el = object.el;\n      if (!NAF.utils.isMine(el) && !NAF.utils.takeOwnership(el)) return;\n      window.APP.pinningHelper.setPinned(el, false);\n    },\n    [object]\n  );\n\n  const togglePinned = useCallback(\n    () => {\n      if (isPinned) {\n        unpinObject();\n      } else {\n        pinObject();\n      }\n    },\n    [isPinned, pinObject, unpinObject]\n  );\n\n  useEffect(\n    () => {\n      const el = object.el;\n\n      function onPinStateChanged() {\n        setIsPinned(getPinnedState(el));\n      }\n      el.addEventListener(\"pinned\", onPinStateChanged);\n      el.addEventListener(\"unpinned\", onPinStateChanged);\n      setIsPinned(getPinnedState(el));\n      return () => {\n        el.removeEventListener(\"pinned\", onPinStateChanged);\n        el.removeEventListener(\"unpinned\", onPinStateChanged);\n      };\n    },\n    [object]\n  );\n\n  const el = object.el;\n\n  let userOwnsFile = false;\n\n  if (el.components[\"media-loader\"]) {\n    const { fileIsOwned, fileId } = el.components[\"media-loader\"].data;\n    userOwnsFile = fileIsOwned || (fileId && getPromotionTokenForFile(fileId));\n  }\n\n  const canPin = !!(\n    scene.is(\"entered\") &&\n    !isPlayer(object) &&\n    !hasComponent(APP.world, Static, el.eid) &&\n    hubChannel.can(\"pin_objects\") &&\n    userOwnsFile\n  );\n\n  return { canPin, isPinned, togglePinned, pinObject, unpinObject };\n}\n\nexport function useGoToSelectedObject(scene, object) {\n  const goToSelectedObject = useCallback(\n    () => {\n      const viewingCamera = document.getElementById(\"viewing-camera\");\n      const targetMatrix = new THREE.Matrix4();\n      const translation = new THREE.Matrix4();\n      viewingCamera.object3DMap.camera.updateMatrices();\n      targetMatrix.copy(viewingCamera.object3DMap.camera.matrixWorld);\n      affixToWorldUp(targetMatrix, targetMatrix);\n      translation.makeTranslation(0, -1.6, 0.15);\n      targetMatrix.multiply(translation);\n      rotateInPlaceAroundWorldUp(targetMatrix, Math.PI, targetMatrix);\n\n      scene.systems[\"hubs-systems\"].characterController.enqueueWaypointTravelTo(targetMatrix, true, {\n        willDisableMotion: false,\n        willDisableTeleporting: false,\n        snapToNavMesh: false,\n        willMaintainInitialOrientation: false\n      });\n    },\n    [scene]\n  );\n\n  const uiRoot = useMemo(() => document.getElementById(\"ui-root\"), []);\n  const isSpectating = uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n  const canGoTo = !isSpectating && !isPlayer(object);\n\n  return { canGoTo, goToSelectedObject };\n}\n\nexport function useRemoveObject(hubChannel, scene, object) {\n  const removeObject = useCallback(\n    () => {\n      removeNetworkedObject(scene, object.el);\n    },\n    [scene, object]\n  );\n\n  const el = object.el;\n\n  const canRemoveObject = !!(\n    scene.is(\"entered\") &&\n    !isPlayer(object) &&\n    !getPinnedState(el) &&\n    !hasComponent(APP.world, Static, el.eid) &&\n    hubChannel.can(\"spawn_and_move_media\")\n  );\n\n  return { removeObject, canRemoveObject };\n}\n\nexport function useHideAvatar(hubChannel, avatarEl) {\n  const hideAvatar = useCallback(\n    () => {\n      if (avatarEl.components.networked) {\n        const clientId = avatarEl.components.networked.data.owner;\n\n        if (clientId && clientId !== NAF.clientId) {\n          hubChannel.hide(clientId);\n        }\n      }\n    },\n    [hubChannel, avatarEl]\n  );\n\n  return hideAvatar;\n}\n","var _path, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgGoTo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.274 18.84-2.218-4.482-1.753-2.242a2.844 2.844 0 0 1-.396-1.447V5.624h.612a1.57 1.57 0 0 1 1.572 1.571v7.163\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.996 11.446v-2.91s1.456-2.912 2.911-2.912\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14.457 10.719-2.582-1.696\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m6.661 18.684 2.09-3.06\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.09 4.169a1.455 1.455 0 1 0 0-2.911 1.455 1.455 0 0 0 0 2.91Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgGoTo as ReactComponent };","var _path, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHide = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.875 17.5a.623.623 0 0 1-.442-.183L2.683 3.567a.625.625 0 0 1 .884-.883l13.75 13.75a.624.624 0 0 1-.442 1.066Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.987 15c-1.62 0-3.184-.48-4.646-1.426-1.33-.859-2.528-2.09-3.464-3.554v-.003c.779-1.116 1.632-2.06 2.548-2.821a.078.078 0 0 0 .006-.115l-.779-.777a.078.078 0 0 0-.105-.005C2.573 7.12 1.67 8.126.848 9.304a1.247 1.247 0 0 0-.025 1.388c1.032 1.615 2.36 2.975 3.84 3.932 1.665 1.08 3.458 1.626 5.324 1.626a9.34 9.34 0 0 0 2.96-.491.079.079 0 0 0 .05-.096.079.079 0 0 0-.02-.034l-.842-.842a.156.156 0 0 0-.15-.04A8 8 0 0 1 9.987 15Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M19.173 9.32C18.14 7.722 16.8 6.364 15.296 5.393c-1.663-1.075-3.5-1.643-5.31-1.643a8.88 8.88 0 0 0-2.925.5.078.078 0 0 0-.03.13l.843.842a.156.156 0 0 0 .151.039A7.532 7.532 0 0 1 9.987 5c1.59 0 3.147.485 4.63 1.445 1.356.875 2.569 2.105 3.507 3.555a.005.005 0 0 1 0 .006 12.136 12.136 0 0 1-2.505 2.84.078.078 0 0 0-.023.089c.004.01.01.02.017.027l.777.777a.078.078 0 0 0 .106.005 13.42 13.42 0 0 0 2.681-3.066 1.258 1.258 0 0 0-.004-1.358Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 6.25c-.281 0-.561.03-.835.093a.078.078 0 0 0-.039.132l4.398 4.397a.078.078 0 0 0 .132-.039A3.75 3.75 0 0 0 10 6.249Z\",\n    fill: \"currentColor\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.476 9.128a.078.078 0 0 0-.132.039 3.75 3.75 0 0 0 4.492 4.492.077.077 0 0 0 .059-.054.078.078 0 0 0-.02-.078l-4.4-4.4Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgHide as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ObjectMenu, ObjectMenuButton } from \"./ObjectMenu\";\nimport { useObjectList } from \"./useObjectList\";\nimport {\n  usePinObject,\n  useRemoveObject,\n  useGoToSelectedObject,\n  getObjectUrl,\n  isPlayer,\n  isMe,\n  useHideAvatar\n} from \"./object-hooks\";\nimport { ReactComponent as PinIcon } from \"../icons/Pin.svg\";\nimport { ReactComponent as LinkIcon } from \"../icons/Link.svg\";\nimport { ReactComponent as GoToIcon } from \"../icons/GoTo.svg\";\nimport { ReactComponent as DeleteIcon } from \"../icons/Delete.svg\";\nimport { ReactComponent as AvatarIcon } from \"../icons/Avatar.svg\";\nimport { ReactComponent as HideIcon } from \"../icons/Hide.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nfunction MyMenuItems({ onOpenProfile }) {\n  return (\n    <ObjectMenuButton onClick={onOpenProfile}>\n      <AvatarIcon />\n      <span>\n        <FormattedMessage id=\"object-menu.edit-avatar-button\" defaultMessage=\"Edit Avatar\" />\n      </span>\n    </ObjectMenuButton>\n  );\n}\n\nMyMenuItems.propTypes = {\n  onOpenProfile: PropTypes.func.isRequired\n};\n\nfunction PlayerMenuItems({ hubChannel, activeObject, deselectObject }) {\n  const hideAvatar = useHideAvatar(hubChannel, activeObject.el);\n\n  return (\n    <ObjectMenuButton\n      onClick={() => {\n        deselectObject();\n        hideAvatar();\n      }}\n    >\n      <HideIcon />\n      <span>\n        <FormattedMessage id=\"object-menu.hide-avatar-button\" defaultMessage=\"Hide\" />\n      </span>\n    </ObjectMenuButton>\n  );\n}\n\nPlayerMenuItems.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  activeObject: PropTypes.object.isRequired,\n  deselectObject: PropTypes.func.isRequired\n};\n\nfunction ObjectMenuItems({ hubChannel, scene, activeObject, deselectObject, onGoToObject }) {\n  const { canPin, isPinned, togglePinned } = usePinObject(hubChannel, scene, activeObject);\n  const { canRemoveObject, removeObject } = useRemoveObject(hubChannel, scene, activeObject);\n  const { canGoTo, goToSelectedObject } = useGoToSelectedObject(scene, activeObject);\n  const url = getObjectUrl(activeObject);\n\n  return (\n    <>\n      <ObjectMenuButton disabled={!canPin} onClick={togglePinned}>\n        <PinIcon />\n        <span>\n          {isPinned ? (\n            <FormattedMessage id=\"object-menu.unpin-object-button\" defaultMessage=\"Unpin\" />\n          ) : (\n            <FormattedMessage id=\"object-menu.pin-object-button\" defaultMessage=\"Pin\" />\n          )}\n        </span>\n      </ObjectMenuButton>\n      {/* {url && (\n        <ObjectMenuButton as=\"a\" href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n          <LinkIcon />\n          <span>\n            <FormattedMessage id=\"object-menu.object-link-button\" defaultMessage=\"Link\" />\n          </span>\n        </ObjectMenuButton>\n      )} */}\n      <ObjectMenuButton\n        disabled={!canGoTo}\n        onClick={() => {\n          goToSelectedObject();\n          deselectObject();\n          onGoToObject();\n        }}\n      >\n        <GoToIcon />\n        <span>\n          <FormattedMessage id=\"object-menu.view-object-button\" defaultMessage=\"View\" />\n        </span>\n      </ObjectMenuButton>\n      <ObjectMenuButton\n        disabled={!canRemoveObject}\n        onClick={() => {\n          removeObject();\n          deselectObject();\n        }}\n      >\n        <DeleteIcon />\n        <span>\n          <FormattedMessage id=\"object-menu.delete-object-button\" defaultMessage=\"Delete\" />\n        </span>\n      </ObjectMenuButton>\n    </>\n  );\n}\n\nObjectMenuItems.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  activeObject: PropTypes.object.isRequired,\n  deselectObject: PropTypes.func.isRequired,\n  onGoToObject: PropTypes.func.isRequired\n};\n\nexport function ObjectMenuContainer({ hubChannel, scene, onOpenProfile, onGoToObject }) {\n  const {\n    objects,\n    activeObject,\n    deselectObject,\n    selectNextObject,\n    selectPrevObject,\n    toggleLights,\n    lightsEnabled\n  } = useObjectList();\n\n  let menuItems;\n\n  if (isMe(activeObject)) {\n    menuItems = <MyMenuItems onOpenProfile={onOpenProfile} />;\n  } else if (isPlayer(activeObject)) {\n    menuItems = <PlayerMenuItems hubChannel={hubChannel} activeObject={activeObject} deselectObject={deselectObject} />;\n  } else {\n    menuItems = (\n      <ObjectMenuItems\n        hubChannel={hubChannel}\n        scene={scene}\n        activeObject={activeObject}\n        deselectObject={deselectObject}\n        onGoToObject={onGoToObject}\n      />\n    );\n  }\n\n  return (\n    <ObjectMenu\n      title={<FormattedMessage id=\"object-menu.title\" defaultMessage=\"Object\" />}\n      currentObjectIndex={objects.indexOf(activeObject)}\n      objectCount={objects.length}\n      onClose={deselectObject}\n      onBack={deselectObject}\n      onNextObject={selectNextObject}\n      onPrevObject={selectPrevObject}\n      onToggleLights={toggleLights}\n      lightsEnabled={lightsEnabled}\n    >\n      {menuItems}\n    </ObjectMenu>\n  );\n}\n\nObjectMenuContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  onOpenProfile: PropTypes.func.isRequired,\n  onGoToObject: PropTypes.func.isRequired\n};\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgGif = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M3.25 15.375a1.125 1.125 0 0 1-1.125-1.125v-9c0-.621.504-1.125 1.125-1.125h13.5c.621 0 1.125.504 1.125 1.125v9c0 .621-.504 1.125-1.125 1.125H3.25ZM1 14.25a2.25 2.25 0 0 0 2.25 2.25h13.5A2.25 2.25 0 0 0 19 14.25v-9A2.25 2.25 0 0 0 16.75 3H3.25A2.25 2.25 0 0 0 1 5.25v9Zm7.958-2.558c-.204.244-.492.434-.865.57-.373.133-.786.2-1.239.2-.476 0-.894-.103-1.254-.31a2.105 2.105 0 0 1-.83-.906c-.194-.395-.294-.86-.299-1.393v-.374c0-.55.092-1.024.276-1.424.186-.403.453-.71.8-.922.35-.214.76-.32 1.228-.32.652 0 1.162.156 1.53.468.367.31.585.761.653 1.356H7.855c-.05-.315-.162-.546-.336-.692-.171-.146-.408-.219-.71-.219-.385 0-.679.145-.88.435-.201.29-.303.72-.306 1.291v.352c0 .576.11 1.012.329 1.306.219.295.54.442.963.442.425 0 .729-.09.91-.272v-.948H6.794v-.834h2.164v2.194Zm2.126.695H9.951V6.888h1.133v5.499Zm2.187-2.247h2.175v-.914H13.27v-1.42h2.447v-.918h-3.58v5.499h1.133V10.14Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgGif as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgScene = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 1.874a8.125 8.125 0 1 0 0 16.25 8.125 8.125 0 0 0 0-16.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 1.874C7.73 1.874 5.599 5.512 5.599 10s2.132 8.125 4.4 8.125c2.27 0 4.402-3.638 4.402-8.125S12.268 1.874 10 1.874Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.583 4.583C6.077 5.643 7.958 6.276 10 6.276c2.043 0 3.923-.633 5.417-1.693\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.417 15.417c-1.494-1.06-3.374-1.693-5.417-1.693-2.042 0-3.923.633-5.417 1.693\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 1.874v16.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.125 9.999H1.875\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgScene as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"button-grid-popover\":\"ButtonGridPopover__button-grid-popover__udJ1S\",\"buttonGridPopover\":\"ButtonGridPopover__button-grid-popover__udJ1S\",\"fullscreen\":\"ButtonGridPopover__fullscreen__kypKC\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport styles from \"./ButtonGridPopover.scss\";\n\nexport function ButtonGridPopover({ fullscreen, items, closePopover }) {\n  return (\n    <div className={classNames(styles.buttonGridPopover, { [styles.fullscreen]: fullscreen })}>\n      {items.map(item => {\n        const Icon = item.icon;\n        return (\n          <ToolbarButton\n            key={item.id}\n            icon={<Icon />}\n            preset={item.color}\n            onClick={() => {\n              if (item.onSelect) {\n                item.onSelect(item);\n              }\n\n              closePopover();\n            }}\n            label={item.label}\n            selected={item.selected}\n          />\n        );\n      })}\n    </div>\n  );\n}\n\nButtonGridPopover.propTypes = {\n  fullscreen: PropTypes.bool,\n  items: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      icon: PropTypes.elementType.isRequired,\n      color: PropTypes.string,\n      label: PropTypes.element.isRequired,\n      onSelect: PropTypes.func\n    })\n  ).isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ButtonGridPopover } from \"../popover/ButtonGridPopover\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ObjectIcon } from \"../icons/Object.svg\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst placePopoverTitle = defineMessage({\n  id: \"place-popover.title\",\n  defaultMessage: \"Place\"\n});\n\nexport function PlacePopoverButton({ items }) {\n  const intl = useIntl();\n  const filteredItems = items.filter(item => !!item);\n\n  // The button is removed if you can't place anything.\n  if (filteredItems.length === 0) {\n    return null;\n  }\n\n  const title = intl.formatMessage(placePopoverTitle);\n\n  return (\n    <Popover\n      title={title}\n      content={props => <ButtonGridPopover items={filteredItems} {...props} />}\n      placement=\"top\"\n      offsetDistance={28}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<ObjectIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n          preset=\"accent3\"\n        />\n      )}\n    </Popover>\n  );\n}\n\nPlacePopoverButton.propTypes = {\n  items: PropTypes.array.isRequired\n};\n","import React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ReactComponent as PenIcon } from \"../icons/Pen.svg\";\nimport { ReactComponent as CameraIcon } from \"../icons/Camera.svg\";\n// import { ReactComponent as TextIcon } from \"../icons/Text.svg\";\n// import { ReactComponent as LinkIcon } from \"../icons/Link.svg\";\nimport { ReactComponent as GIFIcon } from \"../icons/GIF.svg\";\nimport { ReactComponent as ObjectIcon } from \"../icons/Object.svg\";\nimport { ReactComponent as AvatarIcon } from \"../icons/Avatar.svg\";\nimport { ReactComponent as SceneIcon } from \"../icons/Scene.svg\";\nimport { ReactComponent as UploadIcon } from \"../icons/Upload.svg\";\nimport { PlacePopoverButton } from \"./PlacePopover\";\nimport { ObjectUrlModalContainer } from \"./ObjectUrlModalContainer\";\nimport configs from \"../../utils/configs\";\nimport { FormattedMessage } from \"react-intl\";\nimport { anyEntityWith } from \"../../utils/bit-utils\";\nimport { MyCameraTool } from \"../../bit-components\";\n\nexport function PlacePopoverContainer({ scene, mediaSearchStore, showNonHistoriedDialog, hubChannel }) {\n  const [items, setItems] = useState([]);\n\n  useEffect(\n    () => {\n      function updateItems() {\n        const hasActiveCamera = !!anyEntityWith(APP.world, MyCameraTool);\n        const hasActivePen = !!scene.systems[\"pen-tools\"].getMyPen();\n\n        let nextItems = [\n          hubChannel.can(\"spawn_drawing\") && {\n            id: \"pen\",\n            icon: PenIcon,\n            color: \"accent5\",\n            label: <FormattedMessage id=\"place-popover.item-type.pen\" defaultMessage=\"Pen\" />,\n            onSelect: () => scene.emit(\"penButtonPressed\"),\n            selected: hasActivePen\n          },\n          hubChannel.can(\"spawn_camera\") && {\n            id: \"camera\",\n            icon: CameraIcon,\n            color: \"accent5\",\n            label: <FormattedMessage id=\"place-popover.item-type.camera\" defaultMessage=\"Camera\" />,\n            onSelect: () => scene.emit(\"action_toggle_camera\"),\n            selected: hasActiveCamera\n          }\n        ];\n\n        if (hubChannel.can(\"spawn_and_move_media\")) {\n          nextItems = [\n            ...nextItems,\n            // TODO: Create text/link dialog\n            // { id: \"text\", icon: TextIcon, color: \"blue\", label: \"Text\" },\n            // { id: \"link\", icon: LinkIcon, color: \"blue\", label: \"Link\" },\n            configs.integration(\"tenor\") && {\n              id: \"gif\",\n              icon: GIFIcon,\n              color: \"accent2\",\n              label: <FormattedMessage id=\"place-popover.item-type.gif\" defaultMessage=\"GIF\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"gifs\")\n            },\n            configs.integration(\"sketchfab\") && {\n              id: \"model\",\n              icon: ObjectIcon,\n              color: \"accent2\",\n              label: <FormattedMessage id=\"place-popover.item-type.model\" defaultMessage=\"3D Model\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"sketchfab\")\n            },\n            {\n              id: \"avatar\",\n              icon: AvatarIcon,\n              color: \"accent1\",\n              label: <FormattedMessage id=\"place-popover.item-type.avatar\" defaultMessage=\"Avatar\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"avatars\")\n            },\n            {\n              id: \"scene\",\n              icon: SceneIcon,\n              color: \"accent1\",\n              label: <FormattedMessage id=\"place-popover.item-type.scene\" defaultMessage=\"Scene\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"scenes\")\n            },\n            // TODO: Launch system file prompt directly\n            {\n              id: \"upload\",\n              icon: UploadIcon,\n              color: \"accent3\",\n              label: <FormattedMessage id=\"place-popover.item-type.upload\" defaultMessage=\"Upload\" />,\n              onSelect: () => showNonHistoriedDialog(ObjectUrlModalContainer, { scene })\n            }\n          ];\n        }\n\n        setItems(nextItems);\n      }\n\n      hubChannel.addEventListener(\"permissions_updated\", updateItems);\n\n      updateItems();\n\n      function onSceneStateChange(event) {\n        if (event.detail === \"camera\" || event.detail === \"pen\") {\n          updateItems();\n        }\n      }\n\n      scene.addEventListener(\"stateadded\", onSceneStateChange);\n      scene.addEventListener(\"stateremoved\", onSceneStateChange);\n\n      return () => {\n        hubChannel.removeEventListener(\"permissions_updated\", updateItems);\n        scene.removeEventListener(\"stateadded\", onSceneStateChange);\n        scene.removeEventListener(\"stateremoved\", onSceneStateChange);\n      };\n    },\n    [hubChannel, mediaSearchStore, showNonHistoriedDialog, scene]\n  );\n\n  return <PlacePopoverButton items={items} />;\n}\n\nPlacePopoverContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  mediaSearchStore: PropTypes.object.isRequired,\n  showNonHistoriedDialog: PropTypes.func.isRequired\n};\n","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgShare = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.545 4H2.555C1.863 4 1.3 4.562 1.3 5.255v8.114c0 .694.562 1.256 1.256 1.256h14.989c.693 0 1.255-.562 1.255-1.255V5.255C18.8 4.562 18.238 4 17.545 4Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M5.05 16.502h10\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.697 9.325 10.123 6.75 7.55 9.325\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.123 11.415V6.752\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgShare as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ButtonGridPopover } from \"../popover/ButtonGridPopover\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ShareIcon } from \"../icons/Share.svg\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst sharePopoverTitle = defineMessage({\n  id: \"share-popover.title\",\n  defaultMessage: \"Share\"\n});\n\nexport function SharePopoverButton({ items }) {\n  const intl = useIntl();\n  const title = intl.formatMessage(sharePopoverTitle);\n\n  const filteredItems = items.filter(item => !!item);\n\n  // The button is removed if you can't share anything.\n  if (filteredItems.length === 0) {\n    return null;\n  }\n\n  const activeItem = filteredItems.find(item => item.active);\n\n  // If there's one item to share (your smartphone camera), or an item is active (recording), then only show that button.\n  if (filteredItems.length === 1 || activeItem) {\n    const item = filteredItems[0];\n    const Icon = item.icon;\n    return (\n      <ToolbarButton\n        icon={<Icon />}\n        onClick={() => {\n          if (item.onSelect) {\n            item.onSelect(item);\n          }\n        }}\n        label={title}\n        preset=\"accent5\"\n        statusColor={activeItem && \"recording\"}\n      />\n    );\n  }\n\n  return (\n    <Popover\n      title={title}\n      content={props => <ButtonGridPopover items={filteredItems} {...props} />}\n      placement=\"top\"\n      offsetDistance={28}\n      disableFullscreen\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<ShareIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n          preset=\"accent5\"\n        />\n      )}\n    </Popover>\n  );\n}\n\nSharePopoverButton.propTypes = {\n  items: PropTypes.array.isRequired\n};\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ReactComponent as VideoIcon } from \"../icons/Video.svg\";\nimport { ReactComponent as DesktopIcon } from \"../icons/Desktop.svg\";\nimport { ReactComponent as AvatarIcon } from \"../icons/Avatar.svg\";\nimport { SharePopoverButton } from \"./SharePopover\";\nimport { FormattedMessage } from \"react-intl\";\nimport useAvatar from \"./useAvatar\";\nimport { MediaDevicesEvents, MediaDevices } from \"../../utils/media-devices-utils\";\n\nfunction useShare(scene, hubChannel) {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [sharingSource, setSharingSource] = useState(null);\n  const [canShareCamera, setCanShareCamera] = useState(false);\n  const [canShareScreen, setCanShareScreen] = useState(false);\n  const [canShareCameraToAvatar, setCanShareCameraToAvatar] = useState(false);\n  const { hasVideoTextureTarget } = useAvatar();\n\n  useEffect(\n    () => {\n      function onShareVideoEnabled(event) {\n        setSharingSource(event.detail.source);\n      }\n\n      function onShareVideoDisabled() {\n        setSharingSource(null);\n      }\n\n      function onPermissionsUpdated() {\n        const canShareMedia = hubChannel.can(\"spawn_and_move_media\");\n\n        if (canShareMedia) {\n          navigator.mediaDevices\n            .enumerateDevices()\n            .then(devices => {\n              const hasCamera = devices.some(device => device.kind === \"videoinput\");\n              setCanShareCamera(hasCamera);\n              setCanShareCameraToAvatar(hasCamera && hasVideoTextureTarget);\n            })\n            .catch(() => {\n              setCanShareCamera(false);\n              setCanShareCameraToAvatar(false);\n            });\n\n          setCanShareScreen(!!navigator.mediaDevices.getDisplayMedia);\n        } else {\n          setCanShareScreen(false);\n          setCanShareCamera(false);\n          setCanShareCameraToAvatar(false);\n        }\n      }\n\n      scene.addEventListener(\"share_video_enabled\", onShareVideoEnabled);\n      scene.addEventListener(\"share_video_disabled\", onShareVideoDisabled);\n      // TODO: Show share error dialog\n      scene.addEventListener(\"share_video_failed\", onShareVideoDisabled);\n      hubChannel.addEventListener(\"permissions_updated\", onPermissionsUpdated);\n\n      onPermissionsUpdated();\n\n      // We currently only support sharing one video stream at the same time\n      setSharingSource(\n        mediaDevicesManager.isVideoShared\n          ? mediaDevicesManager.isWebcamShared\n            ? MediaDevices.CAMERA\n            : MediaDevices.SCREEN\n          : null\n      );\n\n      return () => {\n        scene.removeEventListener(\"share_video_enabled\", onShareVideoEnabled);\n        scene.removeEventListener(\"share_video_disabled\", onShareVideoDisabled);\n        scene.removeEventListener(\"share_video_failed\", onShareVideoDisabled);\n        hubChannel.removeEventListener(\"permissions_updated\", onPermissionsUpdated);\n      };\n    },\n    [scene, hubChannel, hasVideoTextureTarget, mediaDevicesManager]\n  );\n\n  const toggleShareCamera = useCallback(\n    () => {\n      if (sharingSource) {\n        scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      } else {\n        scene.emit(\"action_share_camera\");\n      }\n    },\n    [scene, sharingSource]\n  );\n\n  const toggleShareScreen = useCallback(\n    () => {\n      if (sharingSource) {\n        scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      } else {\n        scene.emit(\"action_share_screen\");\n      }\n    },\n    [scene, sharingSource]\n  );\n\n  const toggleShareCameraToAvatar = useCallback(\n    () => {\n      if (sharingSource) {\n        scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      } else {\n        scene.emit(\"action_share_camera\", { target: \"avatar\" });\n      }\n    },\n    [scene, sharingSource]\n  );\n\n  return {\n    sharingSource,\n    canShareCamera,\n    canShareCameraToAvatar,\n    canShareScreen,\n    toggleShareCamera,\n    toggleShareCameraToAvatar,\n    toggleShareScreen\n  };\n}\n\nexport function SharePopoverContainer({ scene, hubChannel }) {\n  const {\n    sharingSource,\n    canShareCamera,\n    toggleShareCamera,\n    canShareScreen,\n    toggleShareScreen,\n    canShareCameraToAvatar,\n    toggleShareCameraToAvatar\n  } = useShare(scene, hubChannel);\n\n  const items = [\n    canShareCamera && {\n      id: \"camera\",\n      icon: VideoIcon,\n      color: \"accent5\",\n      label: <FormattedMessage id=\"share-popover.source.camera\" defaultMessage=\"Camera\" />,\n      onSelect: toggleShareCamera,\n      active: sharingSource === MediaDevices.CAMERA\n    },\n    canShareScreen && {\n      id: \"screen\",\n      icon: DesktopIcon,\n      color: \"accent5\",\n      label: <FormattedMessage id=\"share-popover.source.screen\" defaultMessage=\"Screen\" />,\n      onSelect: toggleShareScreen,\n      active: sharingSource === MediaDevices.SCREEN\n    },\n    canShareCameraToAvatar && {\n      id: \"camera-to-avatar\",\n      icon: AvatarIcon,\n      color: \"accent5\",\n      label: <FormattedMessage id=\"share-popover.source.avatar-camera\" defaultMessage=\"Avatar Camera\" />,\n      onSelect: toggleShareCameraToAvatar,\n      active: sharingSource === \"camera-to-avatar\"\n    }\n  ];\n\n  return <SharePopoverButton items={items} />;\n}\n\nSharePopoverContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired\n};\n","import { useState, useEffect } from \"react\";\n\nexport default function useAvatar() {\n  const [state, setState] = useState({ hasVideoTextureTarget: false });\n\n  useEffect(() => {\n    const avatarModelEl = document.querySelector(\"#avatar-rig .model\");\n\n    function onAvatarModelLoaded() {\n      const hasVideoTextureTarget = !!avatarModelEl.querySelector(\"[video-texture-target]\");\n      setState({ hasVideoTextureTarget });\n    }\n\n    onAvatarModelLoaded();\n\n    avatarModelEl.addEventListener(\"model-loaded\", onAvatarModelLoaded);\n\n    return () => {\n      avatarModelEl.removeEventListener(\"model-loaded\", onAvatarModelLoaded);\n    };\n  }, []);\n\n  return state;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"audio-toolbar-popover\":\"AudioPopover__audio-toolbar-popover__tZfFp\",\"audioToolbarPopover\":\"AudioPopover__audio-toolbar-popover__tZfFp\",\"selection-input\":\"AudioPopover__selection-input__jyQyN\",\"selectionInput\":\"AudioPopover__selection-input__jyQyN\",\"buttons-container\":\"AudioPopover__buttons-container__PFwbt\",\"buttonsContainer\":\"AudioPopover__buttons-container__PFwbt\",\"icon-enabled\":\"AudioPopover__icon-enabled__LKt6O\",\"iconEnabled\":\"AudioPopover__icon-enabled__LKt6O\",\"icon-disabled\":\"AudioPopover__icon-disabled__dqi0K\",\"iconDisabled\":\"AudioPopover__icon-disabled__dqi0K\",\"arrow-button\":\"AudioPopover__arrow-button__rlPlJ\",\"arrowButton\":\"AudioPopover__arrow-button__rlPlJ\",\"arrow-button-selected\":\"AudioPopover__arrow-button-selected__vHFuE\",\"arrowButtonSelected\":\"AudioPopover__arrow-button-selected__vHFuE\",\"level-bar\":\"AudioPopover__level-bar__WlJAN\",\"levelBar\":\"AudioPopover__level-bar__WlJAN\"};","// extracted by mini-css-extract-plugin\nexport default {\"flex-row\":\"Row__flex-row__kHRrv\",\"flexRow\":\"Row__flex-row__kHRrv\",\"space-between\":\"Row__space-between__vh9wm\",\"spaceBetween\":\"Row__space-between__vh9wm\",\"sm-breakpoint-column\":\"Row__sm-breakpoint-column__ErhgV\",\"smBreakpointColumn\":\"Row__sm-breakpoint-column__ErhgV\",\"md-breakpoint-column\":\"Row__md-breakpoint-column__Tr6kD\",\"mdBreakpointColumn\":\"Row__md-breakpoint-column__Tr6kD\",\"no-flex-wrap\":\"Row__no-flex-wrap__kfuaV\",\"noFlexWrap\":\"Row__no-flex-wrap__kfuaV\",\"2xs-children-margin-r\":\"Row__2xs-children-margin-r__f7nyn\",\"2XsChildrenMarginR\":\"Row__2xs-children-margin-r__f7nyn\",\"xs-children-margin-r\":\"Row__xs-children-margin-r__Sy1dQ\",\"xsChildrenMarginR\":\"Row__xs-children-margin-r__Sy1dQ\",\"sm-children-margin-r\":\"Row__sm-children-margin-r__aUOJn\",\"smChildrenMarginR\":\"Row__sm-children-margin-r__aUOJn\",\"md-children-margin-r\":\"Row__md-children-margin-r__QLh3b\",\"mdChildrenMarginR\":\"Row__md-children-margin-r__QLh3b\",\"lg-children-margin-r\":\"Row__lg-children-margin-r__vJ1JM\",\"lgChildrenMarginR\":\"Row__lg-children-margin-r__vJ1JM\",\"xl-children-margin-r\":\"Row__xl-children-margin-r__EW_z3\",\"xlChildrenMarginR\":\"Row__xl-children-margin-r__EW_z3\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./Row.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\nimport classNames from \"classnames\";\n\nexport const Row = ({\n  children,\n  padding,\n  gap,\n  spaceBetween,\n  breakpointColumn,\n  topMargin,\n  flexClassName,\n  flexBasis,\n  noWrap = false,\n  childrenMarginR,\n  className\n}) => {\n  const paddingClass = padding === true ? styleUtils.lgPadding : styleUtils[`${padding}Padding`];\n  const gapClass = gap === true ? styleUtils.mdGap : styleUtils[`${gap}Gap`];\n  const breakpointColumnClass = breakpointColumn === true ? \"\" : styles[`${breakpointColumn}BreakpointColumn`];\n  const topMarginClass = topMargin ? styleUtils[`${topMargin}WrapMargin`] : \"\";\n  const flexBasisClass = flexBasis ? styleUtils[`flexBasis${flexBasis}`] : \"\";\n  const childrenMarginRClass = childrenMarginR ? styles[`${childrenMarginR}ChildrenMarginR`] : \"\";\n\n  return (\n    <div className={classNames(paddingClass, gapClass, className)}>\n      <div\n        className={classNames(\n          styles.flexRow,\n          breakpointColumnClass,\n          topMarginClass,\n          childrenMarginRClass,\n          {\n            [styles.spaceBetween]: spaceBetween,\n            [styles.noFlexWrap]: noWrap\n          },\n          flexClassName,\n          flexBasisClass\n        )}\n      >\n        {children}\n      </div>\n    </div>\n  );\n};\n\nRow.propTypes = {\n  children: PropTypes.node,\n  padding: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  gap: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  topMargin: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  breakpointColumn: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  childrenMarginR: PropTypes.string,\n  spaceBetween: PropTypes.bool,\n  className: PropTypes.string,\n  flexClassName: PropTypes.string,\n  flexBasis: PropTypes.oneOf([10, 20, 30, 40, 50, 60, 70, 80, 90]),\n  noWrap: PropTypes.bool\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./Divider.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\nimport classNames from \"classnames\";\n\nexport const Divider = ({ margin = false }) => {\n  const marginClass = margin === false ? \"\" : styleUtils[`${margin}MarginY`];\n  return <div className={classNames(styles.divider, marginClass)} />;\n};\n\nDivider.propTypes = {\n  margin: PropTypes.oneOf([\"xs\", \"sm\", \"md\", \"lg\", \"xl\"])\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"divider\":\"Divider__divider___idW6\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./AudioPopover.scss\";\nimport { ReactComponent as MicrophoneIcon } from \"../icons/Microphone.svg\";\nimport { ReactComponent as MicrophoneMutedIcon } from \"../icons/MicrophoneMuted.svg\";\nimport { ReactComponent as VolumeOff } from \"../icons/VolumeOff.svg\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\nimport { SelectInputField } from \"../input/SelectInputField\";\nimport { Row } from \"../layout/Row\";\nimport { ToggleInput } from \"../input/ToggleInput\";\nimport { Divider } from \"../layout/Divider\";\nimport { Button } from \"../input/Button\";\n\nexport const AudioPopoverContent = ({\n  micLevelBar,\n  speakerLevelBar,\n  microphoneOptions,\n  onChangeMicrophone,\n  isMicrophoneEnabled,\n  isMicrophoneMuted,\n  onChangeMicrophoneMuted,\n  speakerOptions,\n  onChangeSpeaker,\n  onPlaySound,\n  isAudioInputSelectAvailable,\n  isAudioOutputSelectAvailable\n}) => {\n  const iconStyle = isMicrophoneEnabled ? styles.iconEnabled : styles.iconDisabled;\n  return (\n    <Column padding grow gap=\"lg\" className={styles.audioToolbarPopover}>\n      <p style={{ alignSelf: \"start\" }}>\n        <FormattedMessage id=\"mic-setup-modal.microphone-text\" defaultMessage=\"Microphone\" />\n      </p>\n      {isAudioInputSelectAvailable && (\n        <SelectInputField\n          className={styles.selectionInput}\n          buttonClassName={styles.selectionInput}\n          onChange={onChangeMicrophone}\n          {...microphoneOptions}\n        />\n      )}\n      <Row noWrap>\n        {isMicrophoneEnabled && !isMicrophoneMuted ? (\n          <MicrophoneIcon className={iconStyle} style={{ marginRight: \"12px\" }} />\n        ) : (\n          <MicrophoneMutedIcon className={iconStyle} style={{ marginRight: \"12px\" }} />\n        )}\n        <> {micLevelBar}</>\n      </Row>\n      <Row nowrap>\n        <ToggleInput\n          label={<FormattedMessage id=\"mic-setup-modal.mute-mic-toggle-v2\" defaultMessage=\"Mute\" />}\n          checked={isMicrophoneMuted}\n          onChange={onChangeMicrophoneMuted}\n        />\n      </Row>\n      <Divider />\n      <p style={{ alignSelf: \"start\" }}>\n        <FormattedMessage id=\"mic-setup-modal.speakers-text\" defaultMessage=\"Speakers\" />\n      </p>\n      {isAudioOutputSelectAvailable && (\n        <SelectInputField\n          className={styles.selectionInput}\n          buttonClassName={styles.selectionInput}\n          onChange={onChangeSpeaker}\n          {...speakerOptions}\n        />\n      )}\n      <Row noWrap>\n        <VolumeOff className={iconStyle} style={{ marginRight: \"12px\" }} />\n        <> {speakerLevelBar} </>\n      </Row>\n      <Button preset=\"basic\" onClick={onPlaySound} sm>\n        <FormattedMessage id=\"mic-setup-modal.test-audio-button\" defaultMessage=\"Test Audio\" />\n      </Button>\n    </Column>\n  );\n};\n\nAudioPopoverContent.propTypes = {\n  micLevelBar: PropTypes.node,\n  speakerLevelBar: PropTypes.node,\n  isSoundPlaying: PropTypes.bool,\n  onPlaySound: PropTypes.func,\n  isMicrophoneEnabled: PropTypes.bool,\n  isMicrophoneMuted: PropTypes.bool,\n  onChangeMicrophoneMuted: PropTypes.func,\n  microphoneOptions: PropTypes.object,\n  onChangeMicrophone: PropTypes.func,\n  speakerOptions: PropTypes.object,\n  onChangeSpeaker: PropTypes.func,\n  isAudioInputSelectAvailable: PropTypes.bool,\n  isAudioOutputSelectAvailable: PropTypes.bool\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AudioPopoverContent } from \"./AudioPopoverContent\";\nimport { useMicrophone } from \"./useMicrophone\";\nimport { useSpeakers } from \"./useSpeakers\";\nimport { useSound } from \"./useSound\";\nimport { SOUND_SPEAKER_TONE } from \"../../systems/sound-effects-system\";\nimport { useMicrophoneStatus } from \"./useMicrophoneStatus\";\nimport MediaDevicesManager from \"../../utils/media-devices-manager\";\nimport { VolumeLevelBar } from \"../misc/VolumeLevelBar\";\nimport styles from \"./AudioPopover.scss\";\n\nexport const AudioPopoverContentContainer = ({ scene }) => {\n  const { isMicMuted, toggleMute, isMicEnabled } = useMicrophoneStatus(scene);\n  const { micDeviceChanged, micDevices } = useMicrophone(scene);\n  const { speakerDeviceChanged, speakerDevices } = useSpeakers();\n  const { playSound } = useSound({\n    scene,\n    sound: SOUND_SPEAKER_TONE\n  });\n  return (\n    <AudioPopoverContent\n      micLevelBar={<VolumeLevelBar scene={scene} type=\"mic\" className={styles.levelBar} />}\n      speakerLevelBar={<VolumeLevelBar scene={scene} type=\"mixer\" className={styles.levelBar} />}\n      microphoneOptions={micDevices}\n      onChangeMicrophone={micDeviceChanged}\n      isMicrophoneEnabled={isMicEnabled}\n      isMicrophoneMuted={isMicMuted}\n      onChangeMicrophoneMuted={toggleMute}\n      speakerOptions={speakerDevices}\n      onChangeSpeaker={speakerDeviceChanged}\n      onPlaySound={playSound}\n      isAudioInputSelectAvailable={MediaDevicesManager.isAudioInputSelectEnabled}\n      isAudioOutputSelectAvailable={MediaDevicesManager.isAudioOutputSelectEnabled}\n    />\n  );\n};\n\nAudioPopoverContentContainer.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgArrow = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 10,\n    viewBox: \"0 0 16 10\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.25 8.375 8 1.625l6.75 6.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgArrow as ReactComponent };","import React, { useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./AudioPopover.scss\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ArrowIcon } from \"../icons/Arrow.svg\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst invitePopoverTitle = defineMessage({\n  id: \"audio-toolbar-popover.title\",\n  defaultMessage: \"Audio Settings\"\n});\n\nexport const AudioPopoverButton = ({ initiallyVisible, content, micButton }) => {\n  const intl = useIntl();\n  const title = intl.formatMessage(invitePopoverTitle);\n  const popoverApiRef = useRef();\n\n  return (\n    <Popover\n      title={title}\n      content={content}\n      placement=\"top-start\"\n      offsetDistance={28}\n      initiallyVisible={initiallyVisible}\n      popoverApiRef={popoverApiRef}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <div className={styles.buttonsContainer}>\n          <ToolbarButton\n            ref={triggerRef}\n            icon={<ArrowIcon />}\n            preset=\"basic\"\n            selected={popoverVisible}\n            onClick={togglePopover}\n            type={\"left\"}\n            className={popoverVisible ? styles.arrowButton : styles.arrowButtonSelected}\n            title={\"Audio Settings\"}\n          />\n          {micButton}\n        </div>\n      )}\n    </Popover>\n  );\n};\n\nAudioPopoverButton.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  content: PropTypes.element,\n  micButton: PropTypes.element\n};\n","import React, { useCallback, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { useVolumeMeter } from \"../misc/useVolumeMeter\";\n\nexport function ToolbarMicButton({ scene, ...rest }) {\n  const ref = useRef();\n  const setRef = node => {\n    if (node) {\n      ref.current = node.querySelector(\"rect\");\n    }\n  };\n  const update = useCallback(level => {\n    const rect = ref.current;\n    if (rect) {\n      if (level <= 0.1) {\n        rect.setAttribute(\"height\", 0);\n      } else if (level < 0.3) {\n        rect.setAttribute(\"y\", 8);\n        rect.setAttribute(\"height\", 4);\n      } else {\n        rect.setAttribute(\"y\", 4);\n        rect.setAttribute(\"height\", 8);\n      }\n    }\n  }, []);\n  useVolumeMeter({\n    analyser: scene.systems[\"hubs-systems\"].audioSystem.outboundAnalyser,\n    update\n  });\n  return (\n    <ToolbarButton\n      ref={setRef}\n      label={<FormattedMessage id=\"voice-button-container.label\" defaultMessage=\"Voice\" />}\n      preset=\"basic\"\n      type={\"right\"}\n      {...rest}\n    />\n  );\n}\n\nToolbarMicButton.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AudioPopoverButton } from \"./AudioPopoverButton\";\nimport { useMicrophoneStatus } from \"./useMicrophoneStatus\";\nimport { ToolbarMicButton } from \"../input/ToolbarMicButton\";\nimport { ReactComponent as MicrophoneIcon } from \"../icons/Microphone.svg\";\nimport { ReactComponent as MicrophoneMutedIcon } from \"../icons/MicrophoneMuted.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport const AudioPopoverButtonContainer = ({ scene, initiallyVisible, content }) => {\n  const { isMicMuted, toggleMute, isMicEnabled } = useMicrophoneStatus(scene);\n  return (\n    <AudioPopoverButton\n      initiallyVisible={initiallyVisible}\n      content={content}\n      micButton={\n        <ToolbarMicButton\n          scene={scene}\n          icon={isMicMuted || !isMicEnabled ? <MicrophoneMutedIcon /> : <MicrophoneIcon />}\n          label={<FormattedMessage id=\"voice-button-container.label\" defaultMessage=\"Voice\" />}\n          preset=\"basic\"\n          onClick={toggleMute}\n          statusColor={isMicMuted || !isMicEnabled ? \"disabled\" : \"enabled\"}\n          type={\"right\"}\n        />\n      }\n      onChangeMicrophoneMuted={toggleMute}\n    />\n  );\n};\n\nAudioPopoverButtonContainer.propTypes = {\n  scene: PropTypes.object.isRequired,\n  initiallyVisible: PropTypes.bool,\n  content: PropTypes.element\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AudioPopoverContentContainer } from \"./AudioPopoverContentContainer\";\nimport { AudioPopoverButtonContainer } from \"./AudioPopoverButtonContainer\";\n\nexport const AudioPopoverContainer = ({ scene }) => {\n  return <AudioPopoverButtonContainer scene={scene} content={<AudioPopoverContentContainer scene={scene} />} />;\n};\n\nAudioPopoverContainer.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"image-grid-popover\":\"ImageGridPopover__image-grid-popover__vLSbg\",\"imageGridPopover\":\"ImageGridPopover__image-grid-popover__vLSbg\",\"fullscreen\":\"ImageGridPopover__fullscreen__XUMU4\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ImageGridPopover.scss\";\n\nexport function ImageGridPopover({ fullscreen, items, closePopover }) {\n  return (\n    <div className={classNames(styles.imageGridPopover, { [styles.fullscreen]: fullscreen })}>\n      {items.map(item => {\n        return (\n          <img\n            key={item.id}\n            // crossOrigin: \"anonymous\" is a workaround for CORS error on Chrome. See #4400\n            crossOrigin=\"anonymous\"\n            src={item.src}\n            alt={item.label}\n            onClick={() => {\n              if (item.onSelect) {\n                item.onSelect(item);\n              }\n              \n              closePopover();\n            }}\n          />\n        );  \n      })}\n    </div>\n  );\n}\n\nImageGridPopover.propTypes = {\n  fullscreen: PropTypes.bool,\n  items: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      src: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n      onSelect: PropTypes.func\n    })\n  ).isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"reaction-button\":\"ReactionButton__reaction-button__vpr7k\",\"reactionButton\":\"ReactionButton__reaction-button__vpr7k\",\"active\":\"ReactionButton__active__EANmD\"};","import React from \"react\";\nimport className from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./ReactionButton.scss\";\nimport { ReactComponent as HandRaisedIcon } from \"../icons/HandRaised.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function ReactionButton({ active, children, ...props }) {\n  return (\n    <button className={className(styles.reactionButton, { [styles.active]: active })} {...props}>\n      {children}\n    </button>\n  );\n}\n\nReactionButton.propTypes = {\n  children: PropTypes.node,\n  active: PropTypes.bool\n};\n\nexport function HandRaisedButton({ active, ...props }) {\n  return (\n    <ReactionButton active={active} {...props}>\n      <HandRaisedIcon width=\"42px\" height=\"42px\" />\n      <p>\n        {active ? (\n          <FormattedMessage id=\"reaction-popover.lower-hand\" defaultMessage=\"Lower Hand\" />\n        ) : (\n          <FormattedMessage id=\"reaction-popover.raise-hand\" defaultMessage=\"Raise Hand\" />\n        )}\n      </p>\n    </ReactionButton>\n  );\n}\n\nHandRaisedButton.propTypes = {\n  active: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"label\":\"ReactionPopover__label__DVF6P\",\"popover\":\"ReactionPopover__popover__Bu0zs\"};","import React, { useCallback, useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ImageGridPopover } from \"../popover/ImageGridPopover\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ReactionIcon } from \"../icons/Reaction.svg\";\nimport { ReactComponent as HandRaisedIcon } from \"../icons/HandRaised.svg\";\nimport { defineMessage, FormattedMessage, useIntl } from \"react-intl\";\nimport { Column } from \"../layout/Column\";\nimport { Row } from \"../layout/Row\";\nimport { HandRaisedButton } from \"./ReactionButton\";\nimport styles from \"./ReactionPopover.scss\";\nimport { Button } from \"../input/Button\";\n\nconst reactionPopoverTitle = defineMessage({\n  id: \"reaction-popover.title\",\n  defaultMessage: \"React\"\n});\n\nfunction ReactionPopoverContent({ items, presence, onToggleHandRaised, ...rest }) {\n  return (\n    <Column padding=\"sm\" grow gap=\"sm\">\n      <Row noWrap>\n        <ImageGridPopover items={items} {...rest} />\n      </Row>\n      <Row>\n        <label className={styles.label}>\n          <FormattedMessage id=\"reaction-popover.action\" defaultMessage=\"Actions\" />\n        </label>\n      </Row>\n      <Row nowrap>\n        <HandRaisedButton active={presence.hand_raised} onClick={onToggleHandRaised} />\n      </Row>\n    </Column>\n  );\n}\n\nReactionPopoverContent.propTypes = {\n  items: PropTypes.array.isRequired,\n  presence: PropTypes.object,\n  onToggleHandRaised: PropTypes.func\n};\n\nfunction TooltipPopoverContent({ onToggleHandRaised }) {\n  return (\n    <Row nowrap className={styles.popover}>\n      <Column padding=\"xs\" grow gap=\"xs\">\n        <FormattedMessage id=\"reaction-popover.hand-raised-warning\" defaultMessage=\"Your hand is raised\" />\n      </Column>\n      <Column padding=\"xs\" grow gap=\"xs\">\n        <Button sm thin preset={\"primary\"} onClick={onToggleHandRaised}>\n          <FormattedMessage id=\"reaction-popover.lower-hand\" defaultMessage=\"Lower Hand\" />\n        </Button>\n      </Column>\n    </Row>\n  );\n}\n\nTooltipPopoverContent.propTypes = {\n  onToggleHandRaised: PropTypes.func\n};\n\nexport function ReactionPopoverButton({ items, presence, onToggleHandRaised }) {\n  const [isReactionsVisible, setIsReactionsVisible] = useState(false);\n  const [isTooltipVisible, setIsTooltipVisible] = useState(false);\n  const intl = useIntl();\n  const title = intl.formatMessage(reactionPopoverTitle);\n  const popoverApiRef = useRef();\n\n  const onTooltipHandLowered = useCallback(\n    () => {\n      setIsTooltipVisible(false);\n      onToggleHandRaised();\n    },\n    [onToggleHandRaised]\n  );\n\n  return (\n    <Popover\n      title={title}\n      content={props => {\n        return isTooltipVisible ? (\n          <TooltipPopoverContent onToggleHandRaised={onTooltipHandLowered} />\n        ) : (\n          <ReactionPopoverContent\n            items={items}\n            presence={presence}\n            onToggleHandRaised={onToggleHandRaised}\n            {...props}\n          />\n        );\n      }}\n      placement=\"top\"\n      offsetDistance={28}\n      popoverApiRef={popoverApiRef}\n      showHeader={!isTooltipVisible}\n      isVisible={isReactionsVisible || isTooltipVisible}\n      onChangeVisible={visible => {\n        if (!visible) {\n          setIsReactionsVisible(false);\n          setIsTooltipVisible(presence.hand_raised);\n        }\n      }}\n      disableFullscreen={isTooltipVisible}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={\n            presence.hand_raised ? (\n              <HandRaisedIcon width=\"32px\" height=\"32px\" style={{ marginLeft: \"5px\" }} />\n            ) : (\n              <ReactionIcon />\n            )\n          }\n          selected={popoverVisible}\n          onClick={() => {\n            setIsReactionsVisible(!isReactionsVisible);\n            if (presence.hand_raised) {\n              setIsTooltipVisible(!isTooltipVisible);\n            } else {\n              setIsTooltipVisible(false);\n              togglePopover();\n            }\n          }}\n          label={title}\n          preset=\"accent2\"\n        />\n      )}\n    </Popover>\n  );\n}\n\nReactionPopoverButton.propTypes = {\n  items: PropTypes.array.isRequired,\n  presence: PropTypes.object,\n  onToggleHandRaised: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useState, useEffect } from \"react\";\nimport { ReactionPopoverButton } from \"./ReactionPopover\";\nimport { spawnEmojiInFrontOfUser, emojis } from \"../../components/emoji\";\nimport { defineMessages, useIntl } from \"react-intl\";\n\nconst emojiLabels = defineMessages({\n  smile: { id: \"reaction-popover.emoji-label.smile\", defaultMessage: \"Smile\" },\n  laugh: { id: \"reaction-popover.emoji-label.laugh\", defaultMessage: \"Laugh\" },\n  clap: { id: \"reaction-popover.emoji-label.clap\", defaultMessage: \"Clap\" },\n  heart: { id: \"reaction-popover.emoji-label.heart\", defaultMessage: \"Heart\" },\n  wave: { id: \"reaction-popover.emoji-label.wave\", defaultMessage: \"Wave\" },\n  angry: { id: \"reaction-popover.emoji-label.angry\", defaultMessage: \"Angry\" },\n  cry: { id: \"reaction-popover.emoji-label.cry\", defaultMessage: \"Cry\" }\n});\n\nfunction usePresence(scene, initialPresence) {\n  const [presence, setPresence] = useState(initialPresence);\n\n  const onPresenceUpdate = ({ detail: presence }) => {\n    if (presence.sessionId === NAF.clientId) setPresence(presence);\n  };\n  useEffect(\n    () => {\n      scene.addEventListener(\"presence_updated\", onPresenceUpdate);\n      return () => scene.removeEventListener(\"presence_updated\", onPresenceUpdate);\n    },\n    [scene]\n  );\n\n  return presence;\n}\n\nexport function ReactionPopoverContainer({ scene, initialPresence }) {\n  const intl = useIntl();\n  const presence = usePresence(scene, initialPresence);\n\n  const items = emojis.map(emoji => ({\n    src: emoji.particleEmitterConfig.src,\n    onSelect: spawnEmojiInFrontOfUser,\n    label: intl.formatMessage(emojiLabels[emoji.id]),\n    ...emoji\n  }));\n\n  const onToggleHandRaised = useCallback(\n    () => {\n      if (presence.hand_raised) {\n        window.APP.hubChannel.lowerHand();\n      } else {\n        window.APP.hubChannel.raiseHand();\n      }\n    },\n    [presence]\n  );\n\n  return <ReactionPopoverButton items={items} presence={presence} onToggleHandRaised={onToggleHandRaised} />;\n}\n\nReactionPopoverContainer.propTypes = {\n  scene: PropTypes.object,\n  initialPresence: PropTypes.object\n};\n","import React from \"react\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function SafariMicModal() {\n  return (\n    <Modal title={<FormattedMessage id=\"safari-mic-modal.title\" defaultMessage=\"Microphone Access Required\" />}>\n      <Column center padding>\n        <FormattedMessage\n          id=\"safari-mic-modal.message\"\n          defaultMessage=\"<p>Hubs requires microphone permissions in Safari.</p><p>Please reload and allow microphone access to continue.</p>\"\n          values={{\n            // eslint-disable-next-line react/display-name\n            p: chunks => <p>{chunks}</p>\n          }}\n        />\n        <Button preset=\"accept\" onClick={() => location.reload()}>\n          <FormattedMessage id=\"safari-mic-modal.reload-button\" defaultMessage=\"Reload\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { SignInModal, SignInStep, SubmitEmail, WaitForVerification, SignInComplete } from \"./SignInModal\";\nimport { TERMS, PRIVACY } from \"../../constants\";\n\n// TODO: Migrate to use AuthContext\nexport function RoomSignInModalContainer({ onClose, step, onSubmitEmail, message, onContinue }) {\n  const [cachedEmail, setCachedEmail] = useState();\n\n  return (\n    <SignInModal onClose={onClose} closeable>\n      {step === SignInStep.submit && (\n        <SubmitEmail\n          onSubmitEmail={email => {\n            setCachedEmail(email);\n            onSubmitEmail(email);\n          }}\n          initialEmail={cachedEmail}\n          termsUrl={configs.link(\"terms_of_use\", TERMS)}\n          showTerms={configs.feature(\"show_terms\")}\n          privacyUrl={configs.link(\"privacy_notice\", PRIVACY)}\n          showPrivacy={configs.feature(\"show_privacy\")}\n          message={message}\n        />\n      )}\n      {step === SignInStep.waitForVerification && (\n        <WaitForVerification\n          onCancel={onClose}\n          email={cachedEmail}\n          showNewsletterSignup={configs.feature(\"show_newsletter_signup\")}\n        />\n      )}\n      {step === SignInStep.complete && <SignInComplete message={message} onContinue={onContinue} />}\n    </SignInModal>\n  );\n}\n\nRoomSignInModalContainer.propTypes = {\n  onClose: PropTypes.func,\n  onSubmitEmail: PropTypes.func,\n  step: PropTypes.string,\n  message: PropTypes.object,\n  onContinue: PropTypes.func\n};\n","  import React from \"react\";\n  import { useIntl, defineMessages, FormattedMessage } from \"react-intl\";\n  import PropTypes, { func } from \"prop-types\";\n  import { Modal } from \"../modal/Modal\";\n  import { CloseButton } from \"../input/CloseButton\";\n  import { Button } from \"../input/Button\";\n  import { Column } from \"../layout/Column\";\n\n  export const LeaveReason = {\n    leaveRoom: \"leaveRoom\",\n    joinRoom: \"joinRoom\",\n    createRoom: \"createRoom\"\n  };\n\n  const reasonMessages = defineMessages({\n    [LeaveReason.leaveRoom]: {\n      id: \"leave-room-modal.leave-room.message\",\n      defaultMessage: \"Are you sure you want to leave the room?\"\n    },\n    [LeaveReason.joinRoom]: {\n      id: \"leave-room-modal.join-room.message\",\n      defaultMessage: \"Joining a new room will leave this one. Are you sure?\"\n    },\n    [LeaveReason.createRoom]: {\n      id: \"leave-room-modal.create-room.message\",\n      defaultMessage: \"Creating a new room will leave this one. Are you sure?\"\n    }\n  });\n\n  const confirmationMessages = defineMessages({\n    [LeaveReason.leaveRoom]: {\n      id: \"leave-room-modal.leave-room.confirm\",\n      defaultMessage: \"Leave Room\"\n    },\n    [LeaveReason.joinRoom]: {\n      id: \"leave-room-modal.join-room.confirm\",\n      defaultMessage: \"Join Room\"\n    },\n    [LeaveReason.createRoom]: {\n      id: \"leave-room-modal.create-room.confirm\",\n      defaultMessage: \"Leave and Create Room\"\n    }\n  });\n\n  export function LeaveRoomModal({ reason, destinationUrl, onClose }) {\n    console.log(destinationUrl);\n    const intl = useIntl();\n\n    return (   \n      <Modal\n        title={<FormattedMessage id=\"leave-room-modal.title\" defaultMessage=\"Leave Room\" />}\n        beforeTitle={<CloseButton onClick={onClose} />}\n      >\n        <Column padding center centerMd=\"both\" grow>\n          <p>{intl.formatMessage(reasonMessages[reason])}</p>\n          <Button as=\"a\" preset=\"cancel\" href=\"http://nztoverse.com\" rel=\"noopener noreferrer\">\n            {intl.formatMessage(confirmationMessages[reason])}\n          </Button>\n        </Column>\n      </Modal>\n    );\n  }\n\n  LeaveRoomModal.propTypes = {\n    reason: PropTypes.string,\n    destinationUrl: PropTypes.string,\n    onClose: PropTypes.func\n  };","// extracted by mini-css-extract-plugin\nexport default {\"section-title\":\"RoomSidebar__section-title__UFzx_\",\"sectionTitle\":\"RoomSidebar__section-title__UFzx_\",\"scene-screenshot-container\":\"RoomSidebar__scene-screenshot-container__wKUn4\",\"sceneScreenshotContainer\":\"RoomSidebar__scene-screenshot-container__wKUn4\",\"scene-screenshot-image\":\"RoomSidebar__scene-screenshot-image__BRWhJ\",\"sceneScreenshotImage\":\"RoomSidebar__scene-screenshot-image__BRWhJ\",\"scene-info\":\"RoomSidebar__scene-info__S3PYs\",\"sceneInfo\":\"RoomSidebar__scene-info__S3PYs\",\"scene-name\":\"RoomSidebar__scene-name__cvlSk\",\"sceneName\":\"RoomSidebar__scene-name__cvlSk\",\"scene-creator\":\"RoomSidebar__scene-creator__xT9wM\",\"sceneCreator\":\"RoomSidebar__scene-creator__xT9wM\",\"attribution\":\"RoomSidebar__attribution__2GZFa\",\"attribution-name\":\"RoomSidebar__attribution-name__cdndd\",\"attributionName\":\"RoomSidebar__attribution-name__cdndd\",\"attribution-author\":\"RoomSidebar__attribution-author__tlmWS\",\"attributionAuthor\":\"RoomSidebar__attribution-author__tlmWS\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./RoomSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { InputField } from \"../input/InputField\";\nimport { IconButton } from \"../input/IconButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nfunction SceneAttribution({ attribution }) {\n  const intl = useIntl();\n\n  const unknown = intl.formatMessage({ id: \"room-sidebar.unknown\", defaultMessage: \"unknown\" });\n\n  const name = attribution.name || attribution.title || unknown;\n  const author = attribution.author || unknown;\n\n  if (attribution.url) {\n    const source = attribution.url.includes(\"sketchfab.com\") ? \"Sketchfab\" : null;\n\n    return (\n      <li className={styles.attribution}>\n        <div className={styles.attributionName}>\n          <a href={attribution.url} target=\"_blank\" rel=\"noopener noreferrer\">\n            {name}\n          </a>\n        </div>\n        <div className={styles.attributionAuthor}>\n          {source ? (\n            <FormattedMessage\n              id=\"room-sidebar.scene-attribution-with-source\"\n              defaultMessage=\"by {author} on {source}\"\n              values={{\n                author,\n                source\n              }}\n            />\n          ) : (\n            <FormattedMessage\n              id=\"room-sidebar.scene-attribution\"\n              defaultMessage=\"by {author}\"\n              values={{\n                author\n              }}\n            />\n          )}\n        </div>\n      </li>\n    );\n  } else if (attribution.author) {\n    return (\n      <li className={styles.attribution}>\n        <div className={styles.attributionName}>{name}</div>\n        <div className={styles.attributionAuthor}>\n          <FormattedMessage\n            id=\"room-sidebar.scene-attribution\"\n            defaultMessage=\"by {author}\"\n            values={{\n              author\n            }}\n          />\n        </div>\n      </li>\n    );\n  } else {\n    return null;\n  }\n}\n\n// To assist with content control, we avoid displaying scene links to users who are not the scene\n// creator, unless the scene is remixable or promotable.\nfunction allowDisplayOfSceneLink(accountId, scene) {\n  return scene && ((accountId && scene.account_id === accountId) || scene.allow_promotion || scene.allow_remixing);\n}\n\nexport function SceneInfo({ accountId, scene, showAttributions, canChangeScene, onChangeScene }) {\n  const changeSceneButton = canChangeScene && (\n    <Button preset=\"primary\" onClick={onChangeScene}>\n      <FormattedMessage id=\"room-sidebar.scene-info.change-scene-button\" defaultMessage=\"Change Scene\" />\n    </Button>\n  );\n  if (!scene) return changeSceneButton;\n  const showSceneLink = allowDisplayOfSceneLink(accountId, scene);\n  const attributions = (scene.attributions && scene.attributions.content) || [];\n  const creator = scene.attributions && scene.attributions.creator;\n\n  const filteredAttributionElements = attributions\n    .filter(a => a.url || a.author)\n    .map((attribution, i) => <SceneAttribution attribution={attribution} key={i} />);\n\n  return (\n    <>\n      <h2 className={styles.sectionTitle}>\n        <FormattedMessage id=\"room-sidebar.scene-info.title\" defaultMessage=\"Scene\" />\n      </h2>\n      <div className={styles.sceneScreenshotContainer}>\n        {showSceneLink ? (\n          <a href={scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n            <img className={styles.sceneScreenshotImage} src={scene.screenshot_url} />\n          </a>\n        ) : (\n          <img className={styles.sceneScreenshotImage} src={scene.screenshot_url} />\n        )}\n      </div>\n      <div className={styles.sceneInfo}>\n        {showSceneLink ? (\n          <b className={styles.sceneName}>\n            <a href={scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n              {scene.name}\n            </a>\n          </b>\n        ) : (\n          <b className={styles.sceneName}>{scene.name}</b>\n        )}\n        <div className={styles.sceneCreator}>\n          <FormattedMessage\n            id=\"room-sidebar.scene-info.scene-creator\"\n            defaultMessage=\"by {creator}\"\n            values={{ creator }}\n          />\n        </div>\n      </div>\n      {showAttributions &&\n        filteredAttributionElements.length > 0 && (\n          <InputField\n            label={<FormattedMessage id=\"room-sidebar.scene-info.attributions\" defaultMessage=\"Attributions\" />}\n          >\n            <ul className={styles.attributions}>{filteredAttributionElements}</ul>\n          </InputField>\n        )}\n      {changeSceneButton}\n    </>\n  );\n}\n\nexport function RoomSidebar({ room, accountId, onClose, canEdit, onEdit, onChangeScene }) {\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"room-sidebar.title\" defaultMessage=\"Room\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n      afterTitle={\n        canEdit && (\n          <IconButton onClick={onEdit}>\n            <FormattedMessage id=\"room-sidebar.edit-button\" defaultMessage=\"Edit\" />\n          </IconButton>\n        )\n      }\n    >\n      <Column padding>\n        <InputField label={<FormattedMessage id=\"room-sidebar.room-name\" defaultMessage=\"Name\" />}>\n          {room.name}\n        </InputField>\n        {room.description && (\n          <InputField label={<FormattedMessage id=\"room-sidebar.room-description\" defaultMessage=\"Description\" />}>\n            {room.description}\n          </InputField>\n        )}\n        <SceneInfo\n          accountId={accountId}\n          scene={room.scene}\n          showAttributions\n          canChangeScene={canEdit}\n          onChangeScene={onChangeScene}\n        />\n      </Column>\n    </Sidebar>\n  );\n}\n\nRoomSidebar.propTypes = {\n  accountId: PropTypes.string,\n  room: PropTypes.object.isRequired,\n  onClose: PropTypes.func,\n  canEdit: PropTypes.bool,\n  onEdit: PropTypes.func,\n  onChangeScene: PropTypes.func\n};\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { useId } from \"./useId\";\nimport { TextAreaInput } from \"./TextAreaInput\";\n\nexport const TextAreaInputField = memo(\n  forwardRef(({ className, error, description, inputClassName, label, fullWidth, ...rest }, ref) => {\n    const id = useId();\n    const labelId = useId();\n\n    return (\n      <InputField\n        id={labelId}\n        htmlFor={id}\n        className={className}\n        label={label}\n        error={error}\n        description={description}\n        fullWidth={fullWidth}\n      >\n        <TextAreaInput id={id} ref={ref} className={inputClassName} {...rest} />\n      </InputField>\n    );\n  })\n);\n\nTextAreaInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  fullWidth: PropTypes.bool\n};\n","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./RadioInput.scss\";\n\nexport function RadioInputContainer({ className, children, ...rest }) {\n  return (\n    <div className={classNames(styles.radioInput, className)} {...rest}>\n      {children}\n    </div>\n  );\n}\n\nRadioInputContainer.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport const RadioInputOption = forwardRef(({ label, description, className, labelClassName, ...rest }, ref) => (\n  <label className={classNames(styles.option, className)}>\n    <input className={styles.input} type=\"radio\" ref={ref} {...rest} />\n    <div className={classNames(styles.content, labelClassName)}>\n      <span className={styles.label}>{label}</span>\n      {description && <span className={styles.description}>{description}</span>}\n    </div>\n  </label>\n));\n\nRadioInputOption.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node.isRequired,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"radio-input\":\"RadioInput__radio-input__mNUNn\",\"radioInput\":\"RadioInput__radio-input__mNUNn\",\"option\":\"RadioInput__option__MLMdX\",\"input\":\"RadioInput__input__Ehhbt\",\"content\":\"RadioInput__content__gNy40\",\"label\":\"RadioInput__label__63PKv\",\"description\":\"RadioInput__description__NxZVE\"};","import React, { memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { RadioInputContainer, RadioInputOption as _RadioInputOption } from \"./RadioInput\";\n\nexport const RadioInputField = memo(\n  ({ className, error, description, inputClassName, label, children, fullWidth, ...rest }) => {\n    return (\n      <InputField className={className} label={label} error={error} description={description} fullWidth={fullWidth}>\n        <RadioInputContainer className={inputClassName} {...rest}>\n          {children}\n        </RadioInputContainer>\n      </InputField>\n    );\n  }\n);\n\nRadioInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  children: PropTypes.node,\n  fullWidth: PropTypes.bool\n};\n\nexport const RadioInputOption = _RadioInputOption;\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./NumericInput.scss\";\nimport { TextInput } from \"./TextInput\";\n\nexport const NumericInput = memo(\n  forwardRef(({ className, afterInput, ...rest }, ref) => {\n    return (\n      <TextInput\n        inputMode=\"numeric\"\n        {...rest}\n        type=\"number\"\n        className={classNames(styles.numericInput, className)}\n        ref={ref}\n        afterInput={afterInput}\n      />\n    );\n  })\n);\n\nNumericInput.propTypes = {\n  afterInput: PropTypes.node,\n  className: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"numeric-input\":\"NumericInput__numeric-input__wvn7B\",\"numericInput\":\"NumericInput__numeric-input__wvn7B\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { useId } from \"./useId\";\nimport { NumericInput } from \"./NumericInput\";\n\nexport const NumericInputField = memo(\n  forwardRef(({ className, error, description, inputClassName, label, fullWidth, ...rest }, ref) => {\n    const id = useId();\n    const labelId = useId();\n\n    return (\n      <InputField\n        id={labelId}\n        htmlFor={id}\n        className={className}\n        label={label}\n        error={error}\n        description={description}\n        fullWidth={fullWidth}\n      >\n        <NumericInput id={id} ref={ref} className={inputClassName} {...rest} />\n      </InputField>\n    );\n  })\n);\n\nNumericInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  fullWidth: PropTypes.bool\n};\n","import React, { useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useForm } from \"react-hook-form\";\nimport styles from \"./RoomSettingsSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { InputField } from \"../input/InputField\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { ApplyButton } from \"../input/Button\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { TextAreaInputField } from \"../input/TextAreaInputField\";\nimport { ToggleInput } from \"../input/ToggleInput\";\nimport { RadioInputField, RadioInputOption } from \"../input/RadioInputField\";\nimport { NumericInputField } from \"../input/NumericInputField\";\nimport { BackButton } from \"../input/BackButton\";\nimport { SceneInfo } from \"./RoomSidebar\";\nimport { Column } from \"../layout/Column\";\nimport { InviteLinkInputField } from \"./InviteLinkInputField\";\n\nexport function RoomSettingsSidebar({\n  showBackButton,\n  accountId,\n  room,\n  fetchingInvite,\n  inviteUrl,\n  onRevokeInvite,\n  maxRoomSize,\n  showPublicRoomSetting,\n  onSubmit,\n  onClose,\n  canChangeScene,\n  onChangeScene\n}) {\n  const intl = useIntl();\n  const { handleSubmit, register, watch, errors, setValue } = useForm({\n    defaultValues: room\n  });\n\n  const entryMode = watch(\"entry_mode\");\n  const spawnAndMoveMedia = watch(\"member_permissions.spawn_and_move_media\");\n\n  useEffect(\n    () => {\n      if (!spawnAndMoveMedia) {\n        setValue(\"member_permissions.spawn_camera\", false, { shouldDirty: true });\n        setValue(\"member_permissions.pin_objects\", false, { shouldDirty: true });\n      }\n    },\n    [spawnAndMoveMedia, setValue]\n  );\n\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"room-settings-sidebar.title\" defaultMessage=\"Room Settings\" />}\n      beforeTitle={showBackButton ? <BackButton onClick={onClose} /> : <CloseButton onClick={onClose} />}\n    >\n      <Column padding as=\"form\" onSubmit={handleSubmit(onSubmit)}>\n        <SceneInfo\n          accountId={accountId}\n          scene={room.scene}\n          canChangeScene={canChangeScene}\n          onChangeScene={onChangeScene}\n        />\n        <TextInputField\n          name=\"name\"\n          type=\"text\"\n          required\n          autoComplete=\"off\"\n          placeholder={intl.formatMessage({\n            id: \"room-settings-sidebar.name-placeholder\",\n            defaultMessage: \"Room name\"\n          })}\n          minLength={1}\n          maxLength={64}\n          label={<FormattedMessage id=\"room-settings-sidebar.name\" defaultMessage=\"Room Name\" />}\n          ref={register}\n          error={errors.name}\n          fullWidth\n        />\n        <TextAreaInputField\n          name=\"description\"\n          autoComplete=\"off\"\n          placeholder={intl.formatMessage({\n            id: \"room-settings-sidebar.description-placeholder\",\n            defaultMessage: \"Room Description\"\n          })}\n          label={<FormattedMessage id=\"room-settings-sidebar.description\" defaultMessage=\"Room Description\" />}\n          minRows={3}\n          ref={register}\n          error={errors.description}\n          fullWidth\n        />\n        <NumericInputField\n          name=\"room_size\"\n          required\n          min={0}\n          max={maxRoomSize}\n          placeholder={intl.formatMessage({\n            id: \"room-settings-sidebar.room-size-placeholder\",\n            defaultMessage: \"Member Limit\"\n          })}\n          label={<FormattedMessage id=\"room-settings-sidebar.room-size\" defaultMessage=\"Room Size\" />}\n          ref={register}\n          error={errors.room_size}\n          fullWidth\n        />\n        <RadioInputField\n          label={<FormattedMessage id=\"room-settings-sidebar.room-access\" defaultMessage=\"Room Access\" />}\n          fullWidth\n        >\n          <RadioInputOption\n            name=\"entry_mode\"\n            value=\"allow\"\n            label={<FormattedMessage id=\"room-settings-sidebar.access-shared-link\" defaultMessage=\"Shared link\" />}\n            description={\n              <FormattedMessage\n                id=\"room-settings-sidebar.access-shared-link-description\"\n                defaultMessage=\"Only those with the link can join\"\n              />\n            }\n            ref={register}\n            error={errors.entry_mode}\n          />\n          <RadioInputOption\n            name=\"entry_mode\"\n            value=\"invite\"\n            label={<FormattedMessage id=\"room-settings-sidebar.access-invite\" defaultMessage=\"Invite only\" />}\n            description={\n              <FormattedMessage\n                id=\"room-settings-sidebar.access-invite-description\"\n                defaultMessage=\"Invite people with a link that can be revoked\"\n              />\n            }\n            ref={register}\n            error={errors.entry_mode}\n          />\n        </RadioInputField>\n        {entryMode === \"invite\" && (\n          <InviteLinkInputField fetchingInvite={fetchingInvite} inviteUrl={inviteUrl} onRevokeInvite={onRevokeInvite} />\n        )}\n        {showPublicRoomSetting && (\n          <ToggleInput\n            name=\"allow_promotion\"\n            label={<FormattedMessage id=\"room-settings-sidebar.access-public\" defaultMessage=\"Public\" />}\n            description={\n              <FormattedMessage\n                id=\"room-settings-sidebar.access-public-description\"\n                defaultMessage=\"Listed on the homepage\"\n              />\n            }\n            ref={register}\n          />\n        )}\n        <InputField\n          label={<FormattedMessage id=\"room-settings-sidebar.permissions\" defaultMessage=\"Room Member Permissions\" />}\n          fullWidth\n        >\n          <div className={styles.roomPermissions}>\n            <ToggleInput\n              name=\"member_permissions.spawn_and_move_media\"\n              label={\n                <FormattedMessage\n                  id=\"room-settings-sidebar.spawn-and-move-media\"\n                  defaultMessage=\"Create and move objects\"\n                />\n              }\n              ref={register}\n            />\n            <div className={styles.permissionsGroup}>\n              <ToggleInput\n                name=\"member_permissions.spawn_camera\"\n                label={<FormattedMessage id=\"room-settings-sidebar.spawn-camera\" defaultMessage=\"Create cameras\" />}\n                ref={register}\n                disabled={!spawnAndMoveMedia}\n              />\n              <ToggleInput\n                name=\"member_permissions.pin_objects\"\n                label={<FormattedMessage id=\"room-settings-sidebar.pin-objects\" defaultMessage=\"Pin objects\" />}\n                ref={register}\n                disabled={!spawnAndMoveMedia}\n              />\n            </div>\n            <ToggleInput\n              name=\"member_permissions.spawn_drawing\"\n              label={<FormattedMessage id=\"room-settings-sidebar.spawn-drawing\" defaultMessage=\"Create drawings\" />}\n              ref={register}\n            />\n            <ToggleInput\n              name=\"member_permissions.spawn_emoji\"\n              label={<FormattedMessage id=\"room-settings-sidebar.spawn-emoji\" defaultMessage=\"Create emoji\" />}\n              ref={register}\n            />\n            <ToggleInput\n              name=\"member_permissions.fly\"\n              label={<FormattedMessage id=\"room-settings-sidebar.fly\" defaultMessage=\"Allow flying\" />}\n              ref={register}\n            />\n          </div>\n        </InputField>\n        <ApplyButton type=\"submit\" />\n      </Column>\n    </Sidebar>\n  );\n}\n\nRoomSettingsSidebar.propTypes = {\n  accountId: PropTypes.string,\n  showBackButton: PropTypes.bool,\n  room: PropTypes.object.isRequired,\n  fetchingInvite: PropTypes.bool,\n  inviteUrl: PropTypes.string,\n  onRevokeInvite: PropTypes.func,\n  roomSize: PropTypes.number,\n  maxRoomSize: PropTypes.number,\n  showPublicRoomSetting: PropTypes.bool,\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func,\n  canChangeScene: PropTypes.bool,\n  onChangeScene: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { RoomSettingsSidebar } from \"./RoomSettingsSidebar\";\nimport configs from \"../../utils/configs\";\nimport { useInviteUrl } from \"./useInviteUrl\";\n\nexport function RoomSettingsSidebarContainer({ showBackButton, room, hubChannel, onChangeScene, onClose }) {\n  const maxRoomSize = configs.feature(\"max_room_size\");\n\n  const { fetchingInvite, inviteUrl, revokeInvite } = useInviteUrl(hubChannel);\n\n  const applyChanges = useCallback(\n    settings => {\n      hubChannel.updateHub(settings);\n      onClose();\n    },\n    [hubChannel, onClose]\n  );\n\n  return (\n    <RoomSettingsSidebar\n      showBackButton={showBackButton}\n      room={room}\n      fetchingInvite={fetchingInvite}\n      inviteUrl={inviteUrl}\n      onRevokeInvite={revokeInvite}\n      maxRoomSize={maxRoomSize}\n      showPublicRoomSetting={hubChannel.can(\"update_hub_promotion\")}\n      onSubmit={applyChanges}\n      canChangeScene\n      onChangeScene={onChangeScene}\n      onClose={onClose}\n    />\n  );\n}\n\nRoomSettingsSidebarContainer.propTypes = {\n  showBackButton: PropTypes.bool,\n  room: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onChangeScene: PropTypes.func\n};\n","import React from \"react\";\nimport { FormattedMessage, defineMessages, useIntl } from \"react-intl\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CancelButton } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\n\nexport const AutoExitReason = {\n  concurrentSession: \"concurrentSession\",\n  idle: \"idle\"\n};\n\nconst messages = defineMessages({\n  [AutoExitReason.concurrentSession]: {\n    id: \"auto-exit-warning-modal.reason.concurrent-session\",\n    defaultMessage: \"You have started another session.\"\n  },\n  [AutoExitReason.idle]: {\n    id: \"auto-exit-warning-modal.reason.idle\",\n    defaultMessage: \"You have been idle for too long.\"\n  }\n});\n\nexport function AutoExitWarningModal({ onCancel, reason, secondsRemaining }) {\n  const intl = useIntl();\n\n  return (\n    <Modal title=\"Warning\">\n      <Column padding center>\n        <b>\n          <FormattedMessage\n            id=\"auto-exit-warning-modal.message\"\n            defaultMessage=\"Auto-ending session in {secondsRemaining} seconds\"\n            values={{ secondsRemaining }}\n          />\n        </b>\n        <p>{intl.formatMessage(messages[reason])}</p>\n        <CancelButton onClick={onCancel} />\n      </Column>\n    </Modal>\n  );\n}\n\nAutoExitWarningModal.propTypes = {\n  reason: PropTypes.string.isRequired,\n  secondsRemaining: PropTypes.number.isRequired,\n  onCancel: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { defineMessages, FormattedMessage, useIntl } from \"react-intl\";\nimport { LoadingScreenLayout } from \"../layout/LoadingScreenLayout\";\nimport { Button } from \"../input/Button\";\n\nexport const ExitReason = {\n  exited: \"exited\",\n  closed: \"closed\",\n  denied: \"denied\",\n  disconnected: \"disconnected\",\n  left: \"left\",\n  full: \"full\",\n  sceneError: \"sceneError\",\n  connectError: \"connectError\",\n  versionMismatch: \"versionMismatch\"\n};\n\nconst messages = defineMessages({\n  [ExitReason.exited]: {\n    id: \"exited-room-screen.reason.exited\",\n    defaultMessage: \"Your session has ended. Refresh your browser to start a new one.\"\n  },\n  [ExitReason.closed]: {\n    id: \"exited-room-screen.reason.closed\",\n    defaultMessage: \"This room is no longer available.\"\n  },\n  [ExitReason.denied]: {\n    id: \"exited-room-screen.reason.denied\",\n    defaultMessage: \"You are not permitted to join this room. Please request permission from the room creator.\"\n  },\n  [ExitReason.disconnected]: {\n    id: \"exited-room-screen.reason.disconnected\",\n    defaultMessage: \"You have disconnected from the room. Refresh the page to try to reconnect.\"\n  },\n  [ExitReason.left]: {\n    id: \"exited-room-screen.reason.left\",\n    defaultMessage: \"You have left the room.\"\n  },\n  [ExitReason.full]: {\n    id: \"exited-room-screen.reason.full\",\n    defaultMessage: \"This room is full, please try again later.\"\n  },\n  [ExitReason.sceneError]: {\n    id: \"exited-room-screen.reason.scene-error\",\n    defaultMessage: \"The scene failed to load.\"\n  },\n  [ExitReason.connectError]: {\n    id: \"exited-room-screen.reason.connect-error\",\n    defaultMessage: \"Unable to connect to this room, please try again later.\"\n  },\n  [ExitReason.versionMismatch]: {\n    id: \"exited-room-screen.reason.version-mismatch\",\n    defaultMessage: \"The version you deployed is not available yet. Your browser will refresh in 5 seconds.\"\n  }\n});\n\nexport function ExitedRoomScreen({ reason, showTerms, termsUrl, showSourceLink }) {\n  const intl = useIntl();\n\n  let subtitle = null;\n  if (reason === ExitReason.closed) {\n    const contactEmail = intl.formatMessage({ id: \"contact-email\" });\n\n    subtitle = (\n      <>\n        <b>\n          <FormattedMessage\n            id=\"exited-room-screen.no-longer-available\"\n            defaultMessage=\"Sorry, this room is no longer available.\"\n          />\n        </b>\n        {showTerms && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.closed-room-tos\"\n              defaultMessage=\"A room may be closed by the room owner, or if we receive reports that it violates our <toslink>Terms of Use</toslink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                toslink: chunks => (\n                  <a target=\"_blank\" rel=\"noreferrer noopener\" href={termsUrl}>\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          </p>\n        )}\n        <p>\n          <FormattedMessage\n            id=\"exited-room-screen.contact-us\"\n            defaultMessage=\"If you have questions, contact us at {contactEmail}.\"\n            values={{ contactEmail: <a href={`mailto:${contactEmail}`}>{contactEmail}</a> }}\n          />\n        </p>\n        {showSourceLink && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.source-link\"\n              defaultMessage=\"If you'd like to run your own server, Hubs's source code is available on <a>GitHub</a>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => <a href=\"https://github.com/mozilla/hubs\">{chunks}</a>\n              }}\n            />\n          </p>\n        )}\n\n        <Button as=\"a\" preset=\"accept\" href=\"/\">\n          <FormattedMessage id=\"exited-room-screen.home-button\" defaultMessage=\"Back to Home\" />\n        </Button>\n      </>\n    );\n  } else {\n    const tcpUrl = new URL(document.location.toString());\n    const tcpParams = new URLSearchParams(tcpUrl.search);\n    tcpParams.set(\"force_tcp\", true);\n    tcpUrl.search = tcpParams.toString();\n\n    subtitle = (\n      <>\n        <b>{intl.formatMessage(messages[reason])}</b>\n\n        {reason === ExitReason.connectError && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.connect-tcp\"\n              defaultMessage=\"You can try <a>connecting via TCP</a>, which may work better on some networks.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => <a href={tcpUrl.toString()}>{chunks}</a>\n              }}\n            />\n          </p>\n        )}\n        {![ExitReason.left, ExitReason.disconnected, ExitReason.sceneError].includes(reason) && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.create-room\"\n              defaultMessage=\"You can also <a>create a new room</a>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => <a href=\"/\">{chunks}</a>\n              }}\n            />\n          </p>\n        )}\n\n        <Button as=\"a\" preset=\"accept\" href={window.location.href}>\n          <FormattedMessage id=\"exited-room-screen.refresh-page-button\" defaultMessage=\"Refresh Page\" />\n        </Button>\n      </>\n    );\n  }\n\n  return <LoadingScreenLayout center={subtitle} />;\n}\n\nExitedRoomScreen.propTypes = {\n  reason: PropTypes.string.isRequired,\n  showTerms: PropTypes.bool,\n  termsUrl: PropTypes.string,\n  showSourceLink: PropTypes.bool\n};\n\n","import React, { useState, useCallback } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button, CancelButton } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { TextInputField } from \"../input/TextInputField\";\n\nexport function CloseRoomModal({ roomName, onClose, onConfirm }) {\n  const [confirmText, setConfirmText] = useState(\"\");\n  const [showIsNotMatchError, setShowIsNotMatchError] = useState(false);\n\n  const onClickConfirm = useCallback(\n    () => {\n      if (confirmText.toLowerCase() === roomName.toLowerCase()) {\n        onConfirm();\n      } else {\n        setShowIsNotMatchError(true);\n      }\n    },\n    [onConfirm, confirmText, roomName]\n  );\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"close-room-modal.title\" defaultMessage=\"Close Room\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center centerMd=\"both\" grow>\n        <p>\n          <FormattedMessage\n            id=\"close-room-modal.message\"\n            defaultMessage=\"Closing this room will remove yourself and others from the room, shutting it down permanently.{linebreak}Are you sure? This action cannot be undone.\"\n            values={{ linebreak: <br /> }}\n          />\n        </p>\n        <p>\n          <FormattedMessage\n            id=\"close-room-modal.type-to-confirm\"\n            defaultMessage=\"Type room name to confirm: {roomName}\"\n            values={{ roomName: <b>{roomName}</b> }}\n          />\n        </p>\n        <TextInputField\n          label={<FormattedMessage id=\"close-room-modal.confirm-room-name-field\" defaultMessage=\"Confirm Room Name\" />}\n          onChange={e => setConfirmText(e.target.value)}\n          value={confirmText}\n          error={\n            showIsNotMatchError && (\n              <FormattedMessage id=\"close-room-modal.room-name-match-error\" defaultMessage=\"Room name does not match\" />\n            )\n          }\n        />\n        <Button preset=\"accept\" onClick={onClickConfirm}>\n          <FormattedMessage id=\"close-room-modal.confirm\" defaultMessage=\"Yes, Close Room\" />\n        </Button>\n        <CancelButton onClick={onClose} />\n      </Column>\n    </Modal>\n  );\n}\n\nCloseRoomModal.propTypes = {\n  roomName: PropTypes.string,\n  onConfirm: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function WebVRUnsupportedModal({ onClose }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"webvr-unsupported-modal.title\" defaultMessage=\"Enter in VR\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center>\n        <p>\n          <FormattedMessage\n            id=\"webvr-unsupported-modal.message\"\n            defaultMessage=\"WebVR isn't supported in this browser, to enter with Oculus or SteamVR, use Firefox.\"\n          />\n        </p>\n        <Button\n          as=\"a\"\n          preset=\"accent2\"\n          href=\"https://www.mozilla.org/firefox/\"\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n        >\n          <span>\n            <FormattedMessage id=\"webvr-unsupported-modal.download-firefox-button\" defaultMessage=\"Download Firefox\" />\n          </span>\n        </Button>\n        <p>\n          <small>\n            <FormattedMessage\n              id=\"webvr-unsupported-modal.webvr-rocks-link\"\n              defaultMessage=\"For a list of browsers with experimental VR support, visit <a>WebVR Rocks</a>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => (\n                  <a href=\"https://webvr.rocks\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          </small>\n        </p>\n      </Column>\n    </Modal>\n  );\n}\n\nWebVRUnsupportedModal.propTypes = {\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"media\":\"TweetEditorModal__media__LKb3w\",\"editor\":\"TweetEditorModal__editor__SVwvM\",\"editor-inner\":\"TweetEditorModal__editor-inner__N0yZn\",\"editorInner\":\"TweetEditorModal__editor-inner__N0yZn\",\"emoji-button\":\"TweetEditorModal__emoji-button__sdm3x\",\"emojiButton\":\"TweetEditorModal__emoji-button__sdm3x\",\"counter\":\"TweetEditorModal__counter__KuZoI\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport createEmojiPlugin from \"draft-js-emoji-plugin\";\nimport createHashtagPlugin from \"draft-js-hashtag-plugin\";\nimport createLinkifyPlugin from \"draft-js-linkify-plugin\";\nimport createCounterPlugin from \"draft-js-counter-plugin\";\nimport Editor from \"draft-js-plugins-editor\";\nimport \"draft-js-emoji-plugin/lib/plugin.css\";\nimport \"draft-js-hashtag-plugin/lib/plugin.css\";\nimport \"draft-js-linkify-plugin/lib/plugin.css\";\nimport \"draft-js-counter-plugin/lib/plugin.css\";\nimport styles from \"./TweetEditorModal.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst emojiPlugin = createEmojiPlugin();\nconst hashtagPlugin = createHashtagPlugin();\nconst linkifyPlugin = createLinkifyPlugin();\nconst counterPlugin = createCounterPlugin();\n\nexport function TweetEditorModal({\n  editorState,\n  editorRef,\n  sending,\n  mediaThumbnailUrl,\n  contentSubtype,\n  onClickEditor,\n  onChange,\n  onSend,\n  onClose\n}) {\n  const { EmojiSuggestions, EmojiSelect } = emojiPlugin;\n  const { CharCounter } = counterPlugin;\n\n  const tweetLength = editorState.getCurrentContent().getPlainText().length;\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"tweet-editor-modal.title\" defaultMessage=\"Tweet\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center>\n        <div className={styles.media}>\n          {contentSubtype && contentSubtype.startsWith(\"video\") ? (\n            <video src={mediaThumbnailUrl} width={450} height={255} controls />\n          ) : (\n            <img src={mediaThumbnailUrl} width={450} height={255} />\n          )}\n        </div>\n        <div className={styles.editor}>\n          <div className={styles.editorInner} onClick={onClickEditor}>\n            <Editor\n              ref={editorRef}\n              editorState={editorState}\n              onChange={onChange}\n              plugins={[emojiPlugin, hashtagPlugin, linkifyPlugin, counterPlugin]}\n            />\n          </div>\n\n          <div className={styles.emojiButton}>\n            <EmojiSelect />\n          </div>\n\n          <div className={styles.emojiSuggestions}>\n            <EmojiSuggestions />\n          </div>\n\n          {tweetLength > 200 && (\n            <div className={styles.counter}>\n              <CharCounter editorState={editorState} limit={280} /> / 280\n            </div>\n          )}\n        </div>\n        <Button preset=\"accent4\" disabled={sending || tweetLength > 280} onClick={onSend}>\n          {sending ? (\n            <FormattedMessage id=\"tweet-editor-modal.sending-tweet\" defaultMessage=\"Sending Tweet...\" />\n          ) : (\n            <FormattedMessage id=\"tweet-editor-modal.tweet-button\" defaultMessage=\"Tweet\" />\n          )}\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nTweetEditorModal.propTypes = {\n  editorRef: PropTypes.any,\n  editorState: PropTypes.object.isRequired,\n  onChange: PropTypes.func,\n  sending: PropTypes.bool,\n  mediaThumbnailUrl: PropTypes.string,\n  contentSubtype: PropTypes.string,\n  onClickEditor: PropTypes.func,\n  onSend: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useRef, useEffect, useState, useCallback, useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { TweetEditorModal } from \"./TweetEditorModal\";\nimport { Modifier, EditorState } from \"draft-js\";\nimport { createEditorStateWithText } from \"draft-js-plugins-editor\";\nimport { fetchReticulumAuthenticated } from \"../../utils/phoenix-utils\";\nimport { scaledThumbnailUrlFor } from \"../../utils/media-url-utils\";\n\n// Taken from draft-js-emoji\nconst addEmoji = (emoji, editorState) => {\n  const contentState = editorState.getCurrentContent();\n  const contentStateWithEntity = contentState.createEntity(\"emoji\", \"IMMUTABLE\", { emojiUnicode: emoji });\n  const entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n  const currentSelectionState = editorState.getSelection();\n\n  let emojiAddedContent;\n  let emojiEndPos = 0;\n  let blockSize = 0;\n\n  // in case text is selected it is removed and then the emoji is added\n  const afterRemovalContentState = Modifier.removeRange(contentState, currentSelectionState, \"backward\");\n\n  // deciding on the position to insert emoji\n  const targetSelection = afterRemovalContentState.getSelectionAfter();\n\n  emojiAddedContent = Modifier.insertText(afterRemovalContentState, targetSelection, emoji, null, entityKey);\n\n  emojiEndPos = targetSelection.getAnchorOffset();\n  const blockKey = targetSelection.getAnchorKey();\n  blockSize = contentState.getBlockForKey(blockKey).getLength();\n\n  // If the emoji is inserted at the end, a space is appended right after for\n  // a smooth writing experience.\n  if (emojiEndPos === blockSize) {\n    emojiAddedContent = Modifier.insertText(emojiAddedContent, emojiAddedContent.getSelectionAfter(), \" \");\n  }\n\n  const newEditorState = EditorState.push(editorState, emojiAddedContent, \"insert-emoji\");\n  return EditorState.forceSelection(newEditorState, emojiAddedContent.getSelectionAfter());\n};\n\nexport function TweetEditorModalContainer({ initialTweet, mediaUrl, contentSubtype, onClose }) {\n  const [editorState, setEditorState] = useState(() => createEditorStateWithText(initialTweet || \"\"));\n  const editorRef = useRef();\n\n  useEffect(() => {\n    // Other attempts at doing this resulted in no visible cursor or weird editor behavior:\n    setEditorState(editorState => addEmoji(\"🐤\", editorState));\n  }, []);\n\n  const [sending, setSending] = useState(false);\n\n  const sendTweet = useCallback(\n    async () => {\n      setSending(true);\n\n      try {\n        const body = editorState.getCurrentContent().getPlainText();\n        // For now assume url is a stored file media url\n        await fetchReticulumAuthenticated(\"/api/v1/twitter/tweets\", \"POST\", { media_stored_file_url: mediaUrl, body });\n      } catch (error) {\n        setSending(false);\n        console.error(error);\n      }\n\n      onClose();\n    },\n    [mediaUrl, editorState, onClose]\n  );\n\n  const mediaThumbnailUrl = useMemo(\n    () => {\n      return contentSubtype && !contentSubtype.startsWith(\"video\")\n        ? scaledThumbnailUrlFor(mediaUrl, 450, 255)\n        : mediaUrl;\n    },\n    [contentSubtype, mediaUrl]\n  );\n\n  return (\n    <TweetEditorModal\n      editorState={editorState}\n      editorRef={editorRef}\n      onClose={onClose}\n      sending={sending}\n      onSend={sendTweet}\n      onChange={setEditorState}\n      mediaThumbnailUrl={mediaThumbnailUrl}\n      contentSubtype={contentSubtype}\n    />\n  );\n}\n\nTweetEditorModalContainer.propTypes = {\n  mediaUrl: PropTypes.string,\n  contentSubtype: PropTypes.string,\n  initialTweet: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\n\nexport function TwitterOAuthModal({ appName, onConnect, onClose }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"twitter-oauth-modal.title\" defaultMessage=\"Connect to Twitter\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center centerMd=\"both\" grow>\n        <p>\n          <FormattedMessage\n            id=\"twitter-oauth-modal.message\"\n            defaultMessage=\"Connect to Twitter to send tweets from {appName}.\"\n            values={{ appName }}\n          />\n        </p>\n        <Button preset=\"accent4\" onClick={onConnect}>\n          <FormattedMessage id=\"twitter-oauth-modal.connect-button\" defaultMessage=\"Connect to Twitter\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nTwitterOAuthModal.propTypes = {\n  appName: PropTypes.string.isRequired,\n  onConnect: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useCallback, useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { TwitterOAuthModal } from \"./TwitterOAuthModal\";\nimport configs from \"../../utils/configs\";\n\nexport function TwitterOAuthModalContainer({ hubChannel, onConnected, onClose, isAdmin }) {\n  const popupRef = useRef();\n\n  const onConnect = useCallback(\n    async () => {\n      try {\n        if (popupRef.current) {\n          popupRef.current.close();\n        }\n\n        const url = await hubChannel.getTwitterOAuthURL();\n\n        const width = 600;\n        const height = 760;\n        const left = (window.innerWidth - width) / 2 + window.screenLeft;\n        const top = (window.innerHeight - height) / 2 + window.screenTop;\n\n        window.doingTwitterOAuth = true;\n\n        const popup = window.open(\n          url,\n          \"_blank\",\n          `resizable=yes,width=${width},height=${height},left=${left},top=${top}toolbar=no,titlebar=no,menubar=no,scrollbars=yes`\n        );\n        popup.focus();\n        popupRef.current = popup;\n      } catch (error) {\n        console.error(error);\n        if (error.message === \"twitter_api_error\" && isAdmin) {\n          console.warn(\n            \"Twitter might be misconfigured for Hubs Cloud. Check the docs here: https://hubs.mozilla.com/docs/hubs-cloud-third-party-integrations.html#twitter\"\n          );\n        }\n        onClose();\n      }\n    },\n    [hubChannel, isAdmin, onClose]\n  );\n\n  useEffect(\n    () => {\n      function onMessage({ data }) {\n        if (data === \"oauth-successful\") {\n          onConnected();\n          popupRef.current = null;\n          delete window.doingTwitterOAuth;\n          window.removeEventListener(\"message\", onMessage);\n        }\n      }\n\n      window.addEventListener(\"message\", onMessage);\n\n      return () => {\n        if (popupRef.current) {\n          popupRef.current.close();\n        }\n\n        delete window.doingTwitterOAuth;\n        window.removeEventListener(\"message\", onMessage);\n      };\n    },\n    [onConnected]\n  );\n\n  return <TwitterOAuthModal appName={configs.translation(\"app-name\")} onConnect={onConnect} onClose={onClose} />;\n}\n\nTwitterOAuthModalContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  onConnected: PropTypes.func.isRequired,\n  onClose: PropTypes.func,\n  isAdmin: PropTypes.bool\n};\n","import React, { useCallback, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { TweetEditorModalContainer } from \"./TweetEditorModalContainer\";\nimport { TwitterOAuthModalContainer } from \"./TwitterOAuthModalContainer\";\nimport configs from \"../../utils/configs\";\n\nexport function TweetModalContainer({ hubChannel, initialTweet, mediaUrl, contentSubtype, onClose, isAdmin }) {\n  const [canTweet, setCanTweet] = useState(hubChannel.can(\"tweet\"));\n\n  const onConnected = useCallback(() => {\n    setCanTweet(true);\n  }, []);\n\n  if (canTweet) {\n    return (\n      <TweetEditorModalContainer\n        initialTweet={initialTweet}\n        mediaUrl={mediaUrl}\n        contentSubtype={contentSubtype}\n        onClose={onClose}\n      />\n    );\n  } else {\n    return (\n      <TwitterOAuthModalContainer\n        appName={configs.translation(\"app-name\")}\n        hubChannel={hubChannel}\n        onConnected={onConnected}\n        onClose={onClose}\n        isAdmin={isAdmin}\n      />\n    );\n  }\n}\n\nTweetModalContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  initialTweet: PropTypes.string,\n  mediaUrl: PropTypes.string,\n  contentSubtype: PropTypes.string,\n  onClose: PropTypes.func,\n  isAdmin: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"tip\":\"Tip__tip__o5Hrk\",\"content\":\"Tip__content__ywfjP\",\"dismiss-button\":\"Tip__dismiss-button__kt5sA\",\"dismissButton\":\"Tip__dismiss-button__kt5sA\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Tip.scss\";\n\nexport function Tip({ className, children, onDismiss, dismissLabel, ...rest }) {\n  return (\n    <div className={classNames(styles.tip, className)} {...rest}>\n      <div className={styles.content}>{children}</div>\n      {onDismiss && (\n        <button className={styles.dismissButton} onClick={onDismiss}>\n          {dismissLabel}\n        </button>\n      )}\n    </div>\n  );\n}\n\nTip.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node,\n  onDismiss: PropTypes.func,\n  dismissLabel: PropTypes.node\n};\n","import React, { useCallback, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage, useIntl, defineMessages } from \"react-intl\";\nimport { Tip } from \"./Tip\";\nimport { useEffect } from \"react\";\nimport { discordBridgesForPresences, hasEmbedPresences } from \"../../utils/phoenix-utils\";\nimport configs from \"../../utils/configs\";\n\n// These keys are hardcoded in the input system to be based on the physical location on the keyboard rather than character\nlet moveKeys = \"W A S D\";\nlet turnLeftKey = \"Q\";\nlet turnRightKey = \"E\";\n\n// TODO The API to map from physical key to character is experimental. Depending on prospects of this getting wider\n// implimentation we may want to cook up our own polyfill based on observing key inputs\nif (window.navigator.keyboard !== undefined && window.navigator.keyboard.getLayoutMap) {\n  window.navigator.keyboard\n    .getLayoutMap()\n    .then(function(map) {\n      moveKeys = `${map.get(\"KeyW\") || \"W\"} ${map.get(\"KeyA\") || \"A\"} ${map.get(\"KeyS\") || \"S\"} ${map.get(\"KeyD\") ||\n        \"D\"}`.toUpperCase();\n      turnLeftKey = map.get(\"KeyQ\")?.toUpperCase();\n      turnRightKey = map.get(\"KeyE\")?.toUpperCase();\n    })\n    .catch(function(e) {\n      // This occurs on Chrome 93 when the Hubs page is in an iframe\n      console.warn(`Unable to remap keyboard: ${e}`);\n    });\n}\n\nconst onboardingMessages = defineMessages({\n  \"tips.mobile.look\": {\n    id: \"tips.mobile.look\",\n    defaultMessage: \"Welcome! 👋 Tap and drag to look around.\"\n  },\n  \"tips.mobile.locomotion\": {\n    id: \"tips.mobile.locomotion\",\n    defaultMessage: \"Great! To move, pinch with two fingers.\"\n  },\n  \"tips.mobile.invite\": {\n    id: \"tips.mobile.invite\",\n    defaultMessage: \"Use the Invite button in the bottom left to share this room.\"\n  },\n  \"tips.desktop.look\": {\n    id: \"tips.desktop.look\",\n    defaultMessage: \"Welcome to {appName}! Let's take a quick tour. 👋 Click and drag to look around.\"\n  },\n  \"tips.desktop.locomotion\": {\n    id: \"tips.desktop.locomotion\",\n    defaultMessage: \"Use the {moveKeys} keys to move. Hold shift to boost.\"\n  },\n  \"tips.desktop.turning\": {\n    id: \"tips.desktop.turning\",\n    defaultMessage: \"Perfect. Use the {turnLeftKey} and {turnRightKey} keys to rotate.\"\n  },\n  \"tips.desktop.invite\": {\n    id: \"tips.desktop.invite\",\n    defaultMessage: \"Nobody else is here. Use the invite button in the bottom left to share this room.\"\n  }\n});\n\nfunction OkDismissLabel() {\n  return <FormattedMessage id=\"tips.dismiss.ok\" defaultMessage=\"Ok\" />;\n}\n\nfunction SkipDismissLabel() {\n  return <FormattedMessage id=\"tips.dismiss.skip\" defaultMessage=\"Skip\" />;\n}\n\nexport function FullscreenTip(props) {\n  return (\n    <Tip {...props} dismissLabel={<OkDismissLabel />}>\n      <FormattedMessage id=\"tips.fullscreen\" defaultMessage=\"Entered fullscreen mode. Press Escape to show UI.\" />\n    </Tip>\n  );\n}\n\nexport function TipContainer({ hide, inLobby, inRoom, isStreaming, isEmbedded, scene, store, hubId, presences }) {\n  const intl = useIntl();\n  const [lobbyTipDismissed, setLobbyTipDismissed] = useState(false);\n  const [broadcastTipDismissed, setBroadcastTipDismissed] = useState(() =>\n    store.state.confirmedBroadcastedRooms.includes(hubId)\n  );\n  const [streamingTipDismissed, setStreamingTipDismissed] = useState(false);\n  const [embeddedTipDismissed, setEmbeddedTipDismissed] = useState(false);\n  const [onboardingTipId, setOnboardingTipId] = useState(null);\n\n  const onSkipOnboarding = useCallback(\n    () => {\n      scene.systems.tips.skipTips();\n    },\n    [scene]\n  );\n\n  useEffect(\n    () => {\n      function onSceneTipChanged({ detail: tipId }) {\n        setOnboardingTipId(tipId);\n      }\n\n      scene.addEventListener(\"tip-changed\", onSceneTipChanged);\n\n      setOnboardingTipId(scene.systems.tips.activeTip);\n    },\n    [scene]\n  );\n\n  const discordBridges = presences ? discordBridgesForPresences(presences) : [];\n  const isBroadcasting = discordBridges.length > 0;\n\n  // TODO: This only exists because we store local state in this component.\n  // If we move tip state to a context then we can remove this and not render this component at all.\n  if (hide) {\n    return null;\n  }\n\n  if (inLobby) {\n    if (lobbyTipDismissed) {\n      return null;\n    }\n\n    return (\n      <Tip onDismiss={() => setLobbyTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n        <FormattedMessage id=\"tips.lobby\" defaultMessage=\"You're in the lobby. Others cannot see or hear you.\" />\n      </Tip>\n    );\n  } else if (inRoom) {\n    if (onboardingTipId) {\n      return (\n        <Tip onDismiss={onSkipOnboarding} dismissLabel={<SkipDismissLabel />}>\n          {intl.formatMessage(onboardingMessages[onboardingTipId], {\n            appName: configs.translation(\"app-name\"),\n            moveKeys,\n            turnLeftKey,\n            turnRightKey\n          })}\n        </Tip>\n      );\n    }\n\n    if (isStreaming && !streamingTipDismissed) {\n      return (\n        <Tip onDismiss={() => setStreamingTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n          <FormattedMessage\n            id=\"tips.streaming\"\n            defaultMessage=\"Now broadcasting to the lobby. Exit streamer mode in the more menu when you're done.\"\n          />\n        </Tip>\n      );\n    }\n\n    if (isBroadcasting && !broadcastTipDismissed) {\n      return (\n        <Tip onDismiss={() => setBroadcastTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n          <FormattedMessage\n            id=\"tips.discord\"\n            defaultMessage=\"Chat in this room is being bridged to {broadcastTarget} on Discord.\"\n            values={{ broadcastTarget: discordBridges.map(channelName => \"#\" + channelName).join(\", \") }}\n          />\n        </Tip>\n      );\n    }\n\n    if ((isEmbedded || hasEmbedPresences(presences)) && !embeddedTipDismissed) {\n      return (\n        <Tip onDismiss={() => setEmbeddedTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n          <FormattedMessage\n            id=\"tips.embedded\"\n            defaultMessage=\"This room is embedded, so it may be visible to visitors on other websites.\"\n          />\n        </Tip>\n      );\n    }\n\n    return null;\n  }\n\n  return null;\n}\n\nTipContainer.propTypes = {\n  hide: PropTypes.bool,\n  inLobby: PropTypes.bool,\n  inRoom: PropTypes.bool,\n  isStreaming: PropTypes.bool,\n  isEmbedded: PropTypes.bool,\n  scene: PropTypes.object.isRequired,\n  store: PropTypes.object.isRequired,\n  hubId: PropTypes.string,\n  presences: PropTypes.object\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./SpectatingLabel.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function SpectatingLabel({ name }) {\n  return (\n    <div className={styles.label}>\n      <b>\n        <FormattedMessage id=\"spectating-label.label\" defaultMessage=\"Spectating\" />\n      </b>\n      <p>{name}</p>\n    </div>\n  );\n}\n\nSpectatingLabel.propTypes = {\n  name: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"label\":\"SpectatingLabel__label__xmRHK\"};","import React, { Component, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport copy from \"copy-to-clipboard\";\nimport { FormattedMessage } from \"react-intl\";\nimport screenfull from \"screenfull\";\n\nimport configs from \"../utils/configs\";\nimport { VR_DEVICE_AVAILABILITY } from \"../utils/vr-caps-detect\";\nimport { canShare } from \"../utils/share\";\nimport styles from \"../assets/stylesheets/ui-root.scss\";\nimport styleUtils from \"./styles/style-utils.scss\";\nimport { ReactAudioContext } from \"./wrap-with-audio\";\nimport {\n  pushHistoryState,\n  clearHistoryState,\n  popToBeginningOfHubHistory,\n  navigateToPriorPage,\n  sluglessPath\n} from \"../utils/history\";\nimport StateRoute from \"./state-route.js\";\nimport { getPresenceProfileForSession, hubUrl } from \"../utils/phoenix-utils\";\nimport { getMicrophonePresences } from \"../utils/microphone-presence\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\nimport { isIOS } from \"../utils/is-mobile\";\nimport { CAMERA_MODE_THIRD_PERSON_VIEW, CAMERA_MODE_FIRST_PERSON } from \"../systems/camera-system\";\n\nimport ProfileEntryPanel from \"./profile-entry-panel\";\nimport MediaBrowserContainer from \"./media-browser\";\n\nimport EntryStartPanel from \"./entry-start-panel.js\";\nimport AvatarEditor from \"./avatar-editor\";\nimport PreferencesScreen from \"./preferences-screen.js\";\nimport PresenceLog from \"./presence-log.js\";\nimport PreloadOverlay from \"./preload-overlay.js\";\nimport RTCDebugPanel from \"./debug-panel/RtcDebugPanel.js\";\nimport { showFullScreenIfAvailable, showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport { handleExitTo2DInterstitial, exit2DInterstitialAndEnterVR, isIn2DInterstitial } from \"../utils/vr-interstitial\";\nimport maskEmail from \"../utils/mask-email\";\n\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { LoadingScreenContainer } from \"./room/LoadingScreenContainer\";\n\nimport { RoomLayoutContainer } from \"./room/RoomLayoutContainer\";\nimport roomLayoutStyles from \"./layout/RoomLayout.scss\";\nimport { useAccessibleOutlineStyle } from \"./input/useAccessibleOutlineStyle\";\nimport { ToolbarButton } from \"./input/ToolbarButton\";\nimport { RoomEntryModal } from \"./room/RoomEntryModal\";\nimport { EnterOnDeviceModal } from \"./room/EnterOnDeviceModal\";\nimport { MicSetupModalContainer } from \"./room/MicSetupModalContainer\";\nimport { InvitePopoverContainer } from \"./room/InvitePopoverContainer\";\nimport { MoreMenuPopoverButton, CompactMoreMenuButton, MoreMenuContextProvider } from \"./room/MoreMenuPopover\";\nimport { ChatSidebarContainer, ChatContextProvider, ChatToolbarButtonContainer } from \"./room/ChatSidebarContainer\";\nimport { ContentMenu, PeopleMenuButton, ObjectsMenuButton } from \"./room/ContentMenu\";\nimport { ReactComponent as CameraIcon } from \"./icons/Camera.svg\";\nimport { ReactComponent as AvatarIcon } from \"./icons/Avatar.svg\";\nimport { ReactComponent as AddIcon } from \"./icons/Add.svg\";\nimport { ReactComponent as DeleteIcon } from \"./icons/Delete.svg\";\nimport { ReactComponent as FavoritesIcon } from \"./icons/Favorites.svg\";\nimport { ReactComponent as StarOutlineIcon } from \"./icons/StarOutline.svg\";\nimport { ReactComponent as StarIcon } from \"./icons/Star.svg\";\nimport { ReactComponent as SettingsIcon } from \"./icons/Settings.svg\";\nimport { ReactComponent as WarningCircleIcon } from \"./icons/WarningCircle.svg\";\nimport { ReactComponent as HomeIcon } from \"./icons/Home.svg\";\nimport { ReactComponent as TextDocumentIcon } from \"./icons/TextDocument.svg\";\nimport { ReactComponent as SupportIcon } from \"./icons/Support.svg\";\nimport { ReactComponent as ShieldIcon } from \"./icons/Shield.svg\";\nimport { ReactComponent as DiscordIcon } from \"./icons/Discord.svg\";\nimport { ReactComponent as VRIcon } from \"./icons/VR.svg\";\nimport { ReactComponent as LeaveIcon } from \"./icons/Leave.svg\";\nimport { ReactComponent as EnterIcon } from \"./icons/Enter.svg\";\nimport { ReactComponent as InviteIcon } from \"./icons/Invite.svg\";\nimport { PeopleSidebarContainer, userFromPresence } from \"./room/PeopleSidebarContainer\";\nimport { ObjectListProvider } from \"./room/useObjectList\";\nimport { ObjectsSidebarContainer } from \"./room/ObjectsSidebarContainer\";\nimport { ObjectMenuContainer } from \"./room/ObjectMenuContainer\";\nimport { useCssBreakpoints } from \"react-use-css-breakpoints\";\nimport { PlacePopoverContainer } from \"./room/PlacePopoverContainer\";\nimport { SharePopoverContainer } from \"./room/SharePopoverContainer\";\nimport { AudioPopoverContainer } from \"./room/AudioPopoverContainer\";\nimport { ReactionPopoverContainer } from \"./room/ReactionPopoverContainer\";\nimport { SafariMicModal } from \"./room/SafariMicModal\";\nimport { RoomSignInModalContainer } from \"./auth/RoomSignInModalContainer\";\nimport { SignInStep } from \"./auth/SignInModal\";\nimport { LeaveReason, LeaveRoomModal } from \"./room/LeaveRoomModal\";\nimport { RoomSidebar } from \"./room/RoomSidebar\";\nimport { RoomSettingsSidebarContainer } from \"./room/RoomSettingsSidebarContainer\";\nimport { AutoExitWarningModal, AutoExitReason } from \"./room/AutoExitWarningModal\";\nimport { ExitReason } from \"./room/ExitedRoomScreen\";\nimport { UserProfileSidebarContainer } from \"./room/UserProfileSidebarContainer\";\nimport { CloseRoomModal } from \"./room/CloseRoomModal\";\nimport { WebVRUnsupportedModal } from \"./room/WebVRUnsupportedModal\";\nimport { TweetModalContainer } from \"./room/TweetModalContainer\";\nimport { TipContainer, FullscreenTip } from \"./room/TipContainer\";\nimport { SpectatingLabel } from \"./room/SpectatingLabel\";\nimport { SignInMessages } from \"./auth/SignInModal\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\nimport { TERMS, PRIVACY } from \"../constants\";\n\nconst avatarEditorDebug = qsTruthy(\"avatarEditorDebug\");\n\nconst IN_ROOM_MODAL_ROUTER_PATHS = [\"/media\"];\nconst IN_ROOM_MODAL_QUERY_VARS = [\"media_source\"];\n\nconst LOBBY_MODAL_ROUTER_PATHS = [\"/media/scenes\", \"/media/avatars\", \"/media/favorites\"];\nconst LOBBY_MODAL_QUERY_VARS = [\"media_source\"];\nconst LOBBY_MODAL_QUERY_VALUES = [\"scenes\", \"avatars\", \"favorites\"];\n\nasync function grantedMicLabels() {\n  const mediaDevices = await navigator.mediaDevices.enumerateDevices();\n  return mediaDevices.filter(d => d.label && d.kind === \"audioinput\").map(d => d.label);\n}\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst AUTO_EXIT_TIMER_SECONDS = 10;\n\nclass UIRoot extends Component {\n  willCompileAndUploadMaterials = false;\n\n  static propTypes = {\n    enterScene: PropTypes.func,\n    exitScene: PropTypes.func,\n    onSendMessage: PropTypes.func,\n    disableAutoExitOnIdle: PropTypes.bool,\n    forcedVREntryType: PropTypes.string,\n    isBotMode: PropTypes.bool,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    scene: PropTypes.object,\n    authChannel: PropTypes.object,\n    hubChannel: PropTypes.object,\n    linkChannel: PropTypes.object,\n    hub: PropTypes.object,\n    availableVREntryTypes: PropTypes.object,\n    checkingForDeviceAvailability: PropTypes.bool,\n    environmentSceneLoaded: PropTypes.bool,\n    entryDisallowed: PropTypes.bool,\n    roomUnavailableReason: PropTypes.string,\n    hubIsBound: PropTypes.bool,\n    isSupportAvailable: PropTypes.bool,\n    presenceLogEntries: PropTypes.array,\n    presences: PropTypes.object,\n    sessionId: PropTypes.string,\n    subscriptions: PropTypes.object,\n    initialIsFavorited: PropTypes.bool,\n    showSignInDialog: PropTypes.bool,\n    signInMessage: PropTypes.object,\n    onContinueAfterSignIn: PropTypes.func,\n    showSafariMicDialog: PropTypes.bool,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    onAvatarSaved: PropTypes.func,\n    location: PropTypes.object,\n    history: PropTypes.object,\n    showInterstitialPrompt: PropTypes.bool,\n    onInterstitialPromptClicked: PropTypes.func,\n    performConditionalSignIn: PropTypes.func,\n    hide: PropTypes.bool,\n    showPreload: PropTypes.bool,\n    onPreloadLoadClicked: PropTypes.func,\n    embed: PropTypes.bool,\n    embedToken: PropTypes.string,\n    onLoaded: PropTypes.func,\n    activeObject: PropTypes.object,\n    selectedObject: PropTypes.object,\n    breakpoint: PropTypes.string\n  };\n\n  state = {\n    enterInVR: false,\n    entered: false,\n    entering: false,\n    dialog: null,\n    showShareDialog: false,\n    linkCode: null,\n    linkCodeCancel: null,\n    miniInviteActivated: false,\n\n    didConnectToNetworkedScene: false,\n    noMoreLoadingUpdates: false,\n    hideLoader: false,\n    showPrefs: false,\n    watching: false,\n    isStreaming: false,\n\n    waitingOnAudio: false,\n    audioTrackClone: null,\n\n    autoExitTimerStartedAt: null,\n    autoExitTimerInterval: null,\n    autoExitReason: null,\n    secondsRemainingBeforeAutoExit: Infinity,\n\n    signedIn: false,\n    videoShareMediaSource: null,\n    showVideoShareFailed: false,\n\n    objectInfo: null,\n    objectSrc: \"\",\n    sidebarId: null,\n    presenceCount: 0,\n    chatInputEffect: () => {}\n  };\n\n  constructor(props) {\n    super(props);\n\n    props.mediaSearchStore.setHistory(props.history);\n\n    // An exit handler that discards event arguments and can be cleaned up.\n    this.exitEventHandler = () => this.props.exitScene();\n    this.mediaDevicesManager = APP.mediaDevicesManager;\n  }\n\n  componentDidUpdate(prevProps) {\n    const { hubChannel, showSignInDialog } = this.props;\n    if (hubChannel) {\n      const { signedIn } = hubChannel;\n      if (signedIn !== this.state.signedIn) {\n        this.setState({ signedIn });\n      }\n    }\n    if (prevProps.showSignInDialog !== showSignInDialog) {\n      if (showSignInDialog) {\n        this.showContextualSignInDialog();\n      } else {\n        this.closeDialog();\n      }\n    }\n    if (!this.willCompileAndUploadMaterials && this.state.noMoreLoadingUpdates) {\n      this.willCompileAndUploadMaterials = true;\n      // We want to ensure that react and the browser have had the chance to render / update.\n      // See https://stackoverflow.com/a/34999925 , although our solution flipped setTimeout and requestAnimationFrame\n      window.requestAnimationFrame(() => {\n        window.setTimeout(() => {\n          if (!this.props.isBotMode) {\n            try {\n              this.props.scene.renderer.compile(this.props.scene.object3D, this.props.scene.camera);\n              this.props.scene.object3D.traverse(obj => {\n                if (!obj.material) {\n                  return;\n                }\n                const materials = Array.isArray(obj.material) ? obj.material : [obj.material];\n                for (const material of materials) {\n                  for (const prop in material) {\n                    if (material[prop] && material[prop].isTexture) {\n                      this.props.scene.renderer.initTexture(material[prop]);\n                    }\n                  }\n                }\n              });\n            } catch (e) {\n              console.error(e);\n              this.props.exitScene(ExitReason.sceneError); // https://github.com/mozilla/hubs/issues/1950\n            }\n          }\n\n          if (!this.state.hideLoader) {\n            this.setState({ hideLoader: true });\n          }\n        }, 0);\n      });\n    }\n\n    if (!this.props.selectedObject || !prevProps.selectedObject) {\n      const sceneEl = this.props.scene;\n\n      if (this.props.selectedObject) {\n        sceneEl.classList.add(roomLayoutStyles.sceneSmFullScreen);\n      } else {\n        sceneEl.classList.remove(roomLayoutStyles.sceneSmFullScreen);\n      }\n    }\n\n    if (this.state.presenceCount != this.occupantCount()) {\n      this.setState({ presenceCount: this.occupantCount() });\n    }\n  }\n\n  onConcurrentLoad = () => {\n    if (qsTruthy(\"allow_multi\") || this.props.store.state.preferences.allowMultipleHubsInstances) return;\n    this.startAutoExitTimer(AutoExitReason.concurrentSession);\n  };\n\n  onIdleDetected = () => {\n    if (\n      this.props.disableAutoExitOnIdle ||\n      this.state.isStreaming ||\n      this.props.store.state.preferences.disableIdleDetection\n    )\n      return;\n    this.startAutoExitTimer(AutoExitReason.idle);\n  };\n\n  onActivityDetected = () => {\n    if (this.state.autoExitTimerInterval) {\n      this.endAutoExitTimer();\n    }\n  };\n\n  componentDidMount() {\n    window.addEventListener(\"concurrentload\", this.onConcurrentLoad);\n    window.addEventListener(\"idle_detected\", this.onIdleDetected);\n    window.addEventListener(\"activity_detected\", this.onActivityDetected);\n    window.addEventListener(\"focus_chat\", this.onFocusChat);\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.showShareDialog) {\n        this.setState({ showShareDialog: false });\n      }\n    });\n\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.addEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.addEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.addEventListener(\"share_video_failed\", this.onShareVideoFailed);\n    this.props.scene.addEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.addEventListener(\"action_exit_watch\", () => {\n      if (this.state.hide) {\n        this.setState({ hide: false, hideUITip: false });\n      } else {\n        this.setState({ watching: false });\n      }\n    });\n    this.props.scene.addEventListener(\"action_toggle_ui\", () =>\n      this.setState({ hide: !this.state.hide, hideUITip: false })\n    );\n    this.props.scene.addEventListener(\"devicechange\", () => {\n      this.forceUpdate();\n    });\n\n    const scene = this.props.scene;\n\n    const unsubscribe = this.props.history.listen((location, action) => {\n      const state = location.state;\n\n      // If we just hit back into the entry flow, just go back to the page before the room landing page.\n      if (action === \"POP\" && state && state.entry_step && this.state.entered) {\n        unsubscribe();\n        navigateToPriorPage(this.props.history);\n        return;\n      }\n    });\n\n    // If we refreshed the page with any state history (eg if we were in the entry flow\n    // or had a modal/overlay open) just reset everything to the beginning of the flow by\n    // erasing all history that was accumulated for this room (including across refreshes.)\n    //\n    // We don't do this for the media browser case, since we want to be able to share\n    // links to the browser pages\n    if (this.props.history.location.state && !sluglessPath(this.props.history.location).startsWith(\"/media\")) {\n      popToBeginningOfHubHistory(this.props.history);\n    }\n\n    this.setState({\n      audioContext: {\n        playSound: sound => {\n          scene.emit(sound);\n        },\n        onMouseLeave: () => {\n          //          scene.emit(\"play_sound-hud_mouse_leave\");\n        }\n      }\n    });\n\n    if (this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\")) {\n      this.props.scene.addEventListener(\n        \"loading_finished\",\n        () => {\n          console.log(\"Loading has finished. Checking for forced room entry\");\n          setTimeout(() => this.handleForceEntry(), 1000);\n        },\n        { once: true }\n      );\n    }\n\n    this.playerRig = scene.querySelector(\"#avatar-rig\");\n\n    scene.addEventListener(\"action_media_tweet\", this.onTweet);\n  }\n\n  UNSAFE_componentWillMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.removeEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.removeEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.removeEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.removeEventListener(\"share_video_failed\", this.onShareVideoFailed);\n    this.props.scene.removeEventListener(\"action_media_tweet\", this.onTweet);\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    window.removeEventListener(\"concurrentload\", this.onConcurrentLoad);\n    window.removeEventListener(\"idle_detected\", this.onIdleDetected);\n    window.removeEventListener(\"activity_detected\", this.onActivityDetected);\n    window.removeEventListener(\"focus_chat\", this.onFocusChat);\n  }\n\n  storeUpdated = () => {\n    this.forceUpdate();\n  };\n\n  showContextualSignInDialog = () => {\n    const { signInMessage, authChannel, onContinueAfterSignIn } = this.props;\n    this.showNonHistoriedDialog(RoomSignInModalContainer, {\n      step: SignInStep.submit,\n      message: signInMessage,\n      onSubmitEmail: async email => {\n        const { authComplete } = await authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(RoomSignInModalContainer, {\n          step: SignInStep.waitForVerification,\n          onClose: onContinueAfterSignIn || this.closeDialog\n        });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.showNonHistoriedDialog(RoomSignInModalContainer, {\n          step: SignInStep.complete,\n          onClose: onContinueAfterSignIn || this.closeDialog,\n          onContinue: onContinueAfterSignIn || this.closeDialog\n        });\n      },\n      onClose: onContinueAfterSignIn || this.closeDialog\n    });\n  };\n\n  updateSubscribedState = () => {\n    const isSubscribed = this.props.subscriptions && this.props.subscriptions.isSubscribed();\n    this.setState({ isSubscribed });\n  };\n\n  toggleFavorited = () => {\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      () => {\n        const isFavorited = this.isFavorited();\n\n        this.props.hubChannel[isFavorited ? \"unfavorite\" : \"favorite\"]();\n        this.setState({ isFavorited: !isFavorited });\n      },\n      SignInMessages.favoriteRoom\n    );\n  };\n\n  isFavorited = () => {\n    return this.state.isFavorited !== undefined ? this.state.isFavorited : this.props.initialIsFavorited;\n  };\n\n  onLoadingFinished = () => {\n    console.log(\"UI root loading has finished\");\n    this.setState({ noMoreLoadingUpdates: true });\n    this.props.scene.emit(\"loading_finished\");\n\n    if (this.props.onLoaded) {\n      this.props.onLoaded();\n    }\n  };\n\n  onSceneLoaded = () => {\n    console.log(\"UI root scene has loaded\");\n    this.setState({ sceneLoaded: true });\n  };\n\n  onShareVideoEnabled = e => {\n    this.setState({ videoShareMediaSource: e.detail.source });\n  };\n\n  onShareVideoDisabled = () => {\n    this.setState({ videoShareMediaSource: null });\n  };\n\n  onShareVideoFailed = () => {\n    this.setState({ showVideoShareFailed: true });\n  };\n\n  shareVideo = mediaSource => {\n    this.props.scene.emit(`action_share_${mediaSource}`);\n  };\n\n  endShareVideo = () => {\n    this.props.scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n  };\n\n  spawnPen = () => {\n    this.props.scene.emit(\"penButtonPressed\");\n  };\n\n  onSubscribeChanged = async () => {\n    if (!this.props.subscriptions) return;\n\n    await this.props.subscriptions.toggle();\n    this.updateSubscribedState();\n  };\n\n  handleForceEntry = () => {\n    console.log(\"Forced entry type: \" + this.props.forcedVREntryType);\n\n    if (!this.props.forcedVREntryType) return;\n\n    if (this.props.forcedVREntryType.startsWith(\"daydream\")) {\n      this.enterDaydream();\n    } else if (this.props.forcedVREntryType.startsWith(\"vr\")) {\n      this.enterVR();\n    } else if (this.props.forcedVREntryType.startsWith(\"2d\")) {\n      this.enter2D();\n    }\n  };\n\n  startAutoExitTimer = autoExitReason => {\n    if (this.state.autoExitTimerInterval) return;\n\n    const autoExitTimerInterval = setInterval(() => {\n      let secondsRemainingBeforeAutoExit = Infinity;\n\n      if (this.state.autoExitTimerStartedAt) {\n        const secondsSinceStart = (new Date() - this.state.autoExitTimerStartedAt) / 1000;\n        secondsRemainingBeforeAutoExit = Math.max(0, Math.floor(AUTO_EXIT_TIMER_SECONDS - secondsSinceStart));\n      }\n\n      this.setState({ secondsRemainingBeforeAutoExit });\n      this.checkForAutoExit();\n    }, 500);\n\n    this.setState({ autoExitTimerStartedAt: new Date(), autoExitTimerInterval, autoExitReason });\n  };\n\n  checkForAutoExit = () => {\n    if (this.state.secondsRemainingBeforeAutoExit !== 0) return;\n    this.endAutoExitTimer();\n    this.props.exitScene();\n  };\n\n  isWaitingForAutoExit = () => {\n    return this.state.secondsRemainingBeforeAutoExit <= AUTO_EXIT_TIMER_SECONDS;\n  };\n\n  endAutoExitTimer = () => {\n    clearInterval(this.state.autoExitTimerInterval);\n    this.setState({\n      autoExitTimerStartedAt: null,\n      autoExitTimerInterval: null,\n      autoExitReason: null,\n      secondsRemainingBeforeAutoExit: Infinity\n    });\n  };\n\n  performDirectEntryFlow = async enterInVR => {\n    this.setState({ enterInVR, waitingOnAudio: true });\n\n    const hasGrantedMic = (await grantedMicLabels()).length > 0;\n\n    if (hasGrantedMic) {\n      if (!this.mediaDevicesManager.isMicShared) {\n        await this.mediaDevicesManager.startMicShare({});\n      }\n      this.beginOrSkipAudioSetup();\n    } else {\n      this.onRequestMicPermission();\n      this.pushHistoryState(\"entry_step\", \"audio\");\n    }\n\n    this.setState({ waitingOnAudio: false });\n  };\n\n  enter2D = async () => {\n    console.log(\"Entering in 2D mode\");\n    await this.performDirectEntryFlow(false);\n  };\n\n  enterVR = async () => {\n    console.log(\"Entering in VR mode\");\n    if (this.props.forcedVREntryType || this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.maybe) {\n      await this.performDirectEntryFlow(true);\n    } else {\n      this.showNonHistoriedDialog(WebVRUnsupportedModal);\n    }\n  };\n\n  enterDaydream = async () => {\n    console.log(\"Entering in Daydream mode\");\n    await this.performDirectEntryFlow(true);\n  };\n\n  onRequestMicPermission = async () => {\n    await this.mediaDevicesManager.startMicShare({});\n  };\n\n  beginOrSkipAudioSetup = () => {\n    const skipAudioSetup = this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\");\n    if (skipAudioSetup) {\n      console.log(`Skipping audio setup (forcedVREntryType = ${this.props.forcedVREntryType})`);\n      this.onAudioReadyButton();\n    } else {\n      console.log(`Starting audio setup`);\n      this.pushHistoryState(\"entry_step\", \"audio\");\n    }\n  };\n\n  shouldShowFullScreen = () => {\n    // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n    return (isMobile || AFRAME.utils.device.isMobileVR()) && !isIOS() && !this.state.enterInVR && screenfull.enabled;\n  };\n\n  onAudioReadyButton = async () => {\n    if (!this.state.enterInVR) {\n      await showFullScreenIfAvailable();\n    }\n\n    // Push the new history state before going into VR, otherwise menu button will take us back\n    clearHistoryState(this.props.history);\n\n    const muteOnEntry = this.props.store.state.preferences.muteMicOnEntry;\n    await this.props.enterScene(this.state.enterInVR, muteOnEntry);\n\n    this.setState({ entered: true, entering: false, showShareDialog: false });\n\n    if (this.mediaDevicesManager.isMicShared) {\n      console.log(`Using microphone: ${this.mediaDevicesManager.selectedMicLabel}`);\n    }\n\n    if (this.mediaDevicesManager.isVideoShared) {\n      console.log(\"Screen sharing enabled.\");\n    }\n  };\n\n  attemptLink = async () => {\n    this.pushHistoryState(\"entry_step\", \"device\");\n    const { code, cancel, onFinished } = await this.props.linkChannel.generateCode();\n    this.setState({ linkCode: code, linkCodeCancel: cancel });\n    onFinished.then(() => {\n      this.setState({ log: false, linkCode: null, linkCodeCancel: null });\n      this.props.exitScene();\n    });\n  };\n\n  toggleShareDialog = async () => {\n    this.props.store.update({ activity: { hasOpenedShare: true } });\n    this.setState({ showShareDialog: !this.state.showShareDialog });\n  };\n\n  closeDialog = () => {\n    if (this.state.dialog) {\n      this.setState({ dialog: null });\n    }\n\n    if (isIn2DInterstitial()) {\n      exit2DInterstitialAndEnterVR();\n    } else {\n      showFullScreenIfWasFullScreen();\n    }\n  };\n\n  showNonHistoriedDialog = (DialogClass, props = {}) => {\n    this.setState({\n      dialog: <DialogClass {...{ onClose: this.closeDialog, ...props }} />\n    });\n  };\n\n  toggleStreamerMode = () => {\n    const isStreaming = !this.state.isStreaming;\n    this.props.scene.systems[\"hubs-systems\"].characterController.fly = isStreaming;\n\n    if (isStreaming) {\n      this.props.hubChannel.beginStreaming();\n    } else {\n      this.props.hubChannel.endStreaming();\n    }\n\n    this.setState({ isStreaming });\n  };\n\n  renderDialog = (DialogClass, props = {}) => <DialogClass {...{ onClose: this.closeDialog, ...props }} />;\n\n  signOut = async () => {\n    await this.props.authChannel.signOut(this.props.hubChannel);\n    this.setState({ signedIn: false });\n  };\n\n  onMiniInviteClicked = () => {\n    const link = `https://${configs.SHORTLINK_DOMAIN}/${this.props.hub.hub_id}`;\n\n    this.setState({ miniInviteActivated: true });\n    setTimeout(() => {\n      this.setState({ miniInviteActivated: false });\n    }, 5000);\n\n    if (canShare()) {\n      navigator.share({ title: document.title, url: link });\n    } else {\n      copy(link);\n    }\n  };\n\n  sendMessage = msg => {\n    this.props.onSendMessage(msg);\n  };\n\n  occupantCount = () => {\n    return this.props.presences ? Object.entries(this.props.presences).length : 0;\n  };\n\n  hasEmbedPresence = () => {\n    if (!this.props.presences) {\n      return false;\n    } else {\n      for (const p of Object.values(this.props.presences)) {\n        for (const m of p.metas) {\n          if (m.context && m.context.embed) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  onTweet = ({ detail }) => {\n    handleExitTo2DInterstitial(true, () => {}).then(() => {\n      this.props.performConditionalSignIn(\n        () => this.props.hubChannel.signedIn,\n        () => {\n          this.showNonHistoriedDialog(TweetModalContainer, {\n            hubChannel: this.props.hubChannel,\n            isAdmin: configs.isAdmin(),\n            ...detail\n          });\n        },\n        SignInMessages.tweet\n      );\n    });\n  };\n\n  onChangeScene = () => {\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.can(\"update_hub\"),\n      () => {\n        showFullScreenIfAvailable();\n        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\", \"use\");\n      },\n      SignInMessages.changeScene\n    );\n  };\n\n  pushHistoryState = (k, v) => pushHistoryState(this.props.history, k, v);\n\n  setSidebar(sidebarId, otherState) {\n    this.setState({ sidebarId, chatInputEffect: () => {}, selectedUserId: null, ...otherState });\n  }\n\n  toggleSidebar(sidebarId, otherState) {\n    this.setState(({ sidebarId: curSidebarId }) => {\n      const nextSidebarId = curSidebarId === sidebarId ? null : sidebarId;\n\n      return {\n        sidebarId: nextSidebarId,\n        selectedUserId: null,\n        ...otherState\n      };\n    });\n  }\n\n  onFocusChat = e => {\n    this.setSidebar(\"chat\", {\n      chatInputEffect: input => {\n        input.focus();\n        input.value = e.detail.prefix;\n      }\n    });\n  };\n\n  renderInterstitialPrompt = () => {\n    return (\n      <div className={styles.interstitial} onClick={() => this.props.onInterstitialPromptClicked()}>\n        <div>\n          <FormattedMessage id=\"ui-root.interstitial-prompt\" defaultMessage=\"Continue\" />\n        </div>\n      </div>\n    );\n  };\n\n  renderBotMode = () => {\n    return (\n      <div className=\"loading-panel\">\n        <img className=\"loading-panel__logo\" src={configs.image(\"logo\")} />\n        <input type=\"file\" id=\"bot-audio-input\" accept=\"audio/*\" />\n        <input type=\"file\" id=\"bot-data-input\" accept=\"application/json\" />\n      </div>\n    );\n  };\n\n  onEnteringCanceled = () => {\n    this.props.hubChannel.sendEnteringCancelledEvent();\n    this.setState({ entering: false });\n  };\n\n  renderEntryStartPanel = () => {\n    const { hasAcceptedProfile, hasChangedName } = this.props.store.state.activity;\n    const promptForNameAndAvatarBeforeEntry = this.props.hubIsBound ? !hasAcceptedProfile : !hasChangedName;\n\n    // TODO: What does onEnteringCanceled do?\n    return (\n      <>\n        <RoomEntryModal\n          roomName={this.props.hub.name}\n          showJoinRoom={!this.state.waitingOnAudio && !this.props.entryDisallowed}\n          onJoinRoom={() => {\n            if (promptForNameAndAvatarBeforeEntry || !this.props.forcedVREntryType) {\n              this.setState({ entering: true });\n              this.props.hubChannel.sendEnteringEvent();\n\n              if (promptForNameAndAvatarBeforeEntry) {\n                this.pushHistoryState(\"entry_step\", \"profile\");\n              } else {\n                this.onRequestMicPermission();\n                this.pushHistoryState(\"entry_step\", \"audio\");\n              }\n            } else {\n              this.handleForceEntry();\n            }\n          }}\n          showEnterOnDevice={!this.state.waitingOnAudio && !this.props.entryDisallowed && !isMobileVR}\n          onEnterOnDevice={() => this.attemptLink()}\n          showSpectate={!this.state.waitingOnAudio}\n          onSpectate={() => this.setState({ watching: true })}\n          showOptions={this.props.hubChannel.canOrWillIfCreator(\"update_hub\")}\n          onOptions={() => {\n            this.props.performConditionalSignIn(\n              () => this.props.hubChannel.can(\"update_hub\"),\n              () => this.setSidebar(\"room-settings\"),\n              SignInMessages.roomSettings\n            );\n          }}\n        />\n        {!this.state.waitingOnAudio && (\n          <EntryStartPanel\n            hubChannel={this.props.hubChannel}\n            entering={this.state.entering}\n            onEnteringCanceled={this.onEnteringCanceled}\n          />\n        )}\n      </>\n    );\n  };\n\n  renderDevicePanel = () => {\n    return (\n      <EnterOnDeviceModal\n        shortUrl={configs.SHORTLINK_DOMAIN}\n        loadingCode={!this.state.linkCode}\n        code={this.state.linkCode}\n        headsetConnected={\n          this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no ||\n          this.props.availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no\n        }\n        unsupportedBrowser={this.props.availableVREntryTypes.generic === VR_DEVICE_AVAILABILITY.maybe}\n        onEnterOnConnectedHeadset={() => {\n          // TODO: This is bad. linkCodeCancel should be tied to component lifecycle not these callback methods.\n          this.state.linkCodeCancel();\n          this.setState({ linkCode: null, linkCodeCancel: null });\n          this.enterVR();\n        }}\n        onBack={() => {\n          if (this.state.linkCodeCancel) {\n            // If the back button is pressed rapidly\n            // (before link code generation finishes),\n            // linkCodeCancel will not be a function\n            // and attempting to call it will throw.\n            // TODO: If that happens it may be ideal to\n            // interrupt and cancel link code generation.\n            this.state.linkCodeCancel();\n          }\n          this.setState({ linkCode: null, linkCodeCancel: null });\n          this.props.history.goBack();\n        }}\n      />\n    );\n  };\n\n  renderAudioSetupPanel = () => {\n    // TODO: Show HMD mic not chosen warning\n    return (\n      <MicSetupModalContainer\n        scene={this.props.scene}\n        onEnterRoom={this.onAudioReadyButton}\n        onBack={() => this.props.history.goBack()}\n      />\n    );\n  };\n\n  isInModalOrOverlay = () => {\n    if (\n      this.state.entered &&\n      (IN_ROOM_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        IN_ROOM_MODAL_QUERY_VARS.find(x => new URLSearchParams(this.props.history.location.search).get(x)))\n    ) {\n      return true;\n    }\n\n    if (\n      !this.state.entered &&\n      (LOBBY_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        LOBBY_MODAL_QUERY_VARS.find(\n          (x, i) => new URLSearchParams(this.props.history.location.search).get(x) === LOBBY_MODAL_QUERY_VALUES[i]\n        ))\n    ) {\n      return true;\n    }\n\n    if (this.state.objectInfo && this.state.objectInfo.object3D) {\n      return true; // TODO: Get object info dialog to use history\n    }\n    if (this.state.sidebarId !== null) {\n      return true;\n    }\n\n    return !!(\n      (this.props.history &&\n        this.props.history.location.state &&\n        (this.props.history.location.state.modal || this.props.history.location.state.overlay)) ||\n      this.state.dialog\n    );\n  };\n\n  getSelectedUser() {\n    const selectedUserId = this.state.selectedUserId;\n    const presence = this.props.presences[selectedUserId];\n    const micPresences = getMicrophonePresences();\n    return userFromPresence(selectedUserId, presence, micPresences, this.props.sessionId);\n  }\n\n  render() {\n    const isGhost =\n      configs.feature(\"enable_lobby_ghosts\") && (this.state.watching || (this.state.hide || this.props.hide));\n    const hide = this.state.hide || this.props.hide;\n\n    const rootStyles = {\n      [styles.ui]: true,\n      \"ui-root\": true,\n      \"in-modal-or-overlay\": this.isInModalOrOverlay(),\n      isGhost,\n      hide\n    };\n    if (this.props.hide || this.state.hide) {\n      return (\n        <div className={classNames(rootStyles)}>\n          <RoomLayoutContainer\n            scene={this.props.scene}\n            store={this.props.store}\n            viewport={!this.state.hideUITip && <FullscreenTip onDismiss={() => this.setState({ hideUITip: true })} />}\n          />\n        </div>\n      );\n    }\n\n    if (this.props.showSafariMicDialog) {\n      return (\n        <div className={classNames(rootStyles)}>\n          <RoomLayoutContainer scene={this.props.scene} store={this.props.store} modal={<SafariMicModal />} />\n        </div>\n      );\n    }\n\n    const preload = this.props.showPreload;\n\n    const isLoading = !preload && !this.state.hideLoader;\n\n    if (isLoading && this.state.showPrefs) {\n      return (\n        <div>\n          <LoadingScreenContainer scene={this.props.scene} onLoaded={this.onLoadingFinished} />\n          <PreferencesScreen\n            onClose={() => {\n              this.setState({ showPrefs: false });\n            }}\n            store={this.props.store}\n            scene={this.props.scene}\n          />\n        </div>\n      );\n    }\n    if (this.props.isBotMode) return this.renderBotMode();\n    if (isLoading) {\n      return <LoadingScreenContainer scene={this.props.scene} onLoaded={this.onLoadingFinished} />;\n    }\n    if (this.state.showPrefs) {\n      return (\n        <PreferencesScreen\n          onClose={() => {\n            this.setState({ showPrefs: false });\n          }}\n          store={this.props.store}\n          scene={this.props.scene}\n        />\n      );\n    }\n\n    if (this.props.showInterstitialPrompt) return this.renderInterstitialPrompt();\n\n    const entered = this.state.entered;\n    const watching = this.state.watching;\n    const enteredOrWatching = entered || watching;\n    const showRtcDebugPanel = this.props.store.state.preferences.showRtcDebugPanel;\n    const showAudioDebugPanel = this.props.store.state.preferences.showAudioDebugPanel;\n    const displayNameOverride = this.props.hubIsBound\n      ? getPresenceProfileForSession(this.props.presences, this.props.sessionId).displayName\n      : null;\n\n    const enableSpectateVRButton =\n      configs.feature(\"enable_lobby_ghosts\") &&\n      isGhost &&\n      !hide &&\n      this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no;\n\n    const entryDialog =\n      this.props.availableVREntryTypes &&\n      !preload &&\n      (this.isWaitingForAutoExit() ? (\n        <AutoExitWarningModal\n          reason={this.state.autoExitReason}\n          secondsRemaining={this.state.secondsRemainingBeforeAutoExit}\n          onCancel={this.endAutoExitTimer}\n        />\n      ) : (\n        <>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"device\" history={this.props.history}>\n            {this.renderDevicePanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"audio\" history={this.props.history}>\n            {this.renderAudioSetupPanel()}\n          </StateRoute>\n          <StateRoute\n            stateKey=\"entry_step\"\n            stateValue=\"profile\"\n            history={this.props.history}\n            render={props => (\n              <ProfileEntryPanel\n                {...props}\n                containerType=\"modal\"\n                displayNameOverride={displayNameOverride}\n                finished={() => {\n                  if (this.props.forcedVREntryType) {\n                    this.pushHistoryState();\n                    this.handleForceEntry();\n                  } else {\n                    this.onRequestMicPermission();\n                    this.pushHistoryState(\"entry_step\", \"audio\");\n                  }\n                }}\n                showBackButton\n                onBack={() => this.pushHistoryState()}\n                store={this.props.store}\n                mediaSearchStore={this.props.mediaSearchStore}\n                avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n              />\n            )}\n          />\n          <StateRoute stateKey=\"entry_step\" stateValue=\"\" history={this.props.history}>\n            {this.renderEntryStartPanel()}\n          </StateRoute>\n        </>\n      ));\n\n    const presenceLogEntries = this.props.presenceLogEntries || [];\n\n    const mediaSource = this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location);\n\n    // Allow scene picker pre-entry, otherwise wait until entry\n    const showMediaBrowser =\n      mediaSource && ([\"scenes\", \"avatars\", \"favorites\"].includes(mediaSource) || this.state.entered);\n\n    const streaming = this.state.isStreaming;\n\n    const showObjectList = enteredOrWatching;\n\n    const streamer = getCurrentStreamer();\n    const streamerName = streamer && streamer.displayName;\n\n    const renderEntryFlow = (!enteredOrWatching && this.props.hub) || this.isWaitingForAutoExit();\n\n    const canCreateRoom = !configs.feature(\"disable_room_creation\") || configs.isAdmin();\n    const canCloseRoom = this.props.hubChannel && !!this.props.hubChannel.canOrWillIfCreator(\"close_hub\");\n    const isModerator = this.props.hubChannel && this.props.hubChannel.canOrWillIfCreator(\"kick_users\") && !isMobileVR;\n\n    const moreMenu = [\n      {\n        id: \"user\",\n        label: !this.state.signedIn ? (\n          <FormattedMessage id=\"more-menu.not-signed-in\" defaultMessage=\"You are not signed in\" />\n        ) : (\n          <FormattedMessage\n            id=\"more-menu.you-signed-in-as\"\n            defaultMessage=\"Signed in as: {email}\"\n            values={{ email: maskEmail(this.props.store.state.credentials.email) }}\n          />\n        ),\n        items: [\n          this.state.signedIn\n            ? {\n                id: \"sign-out\",\n                label: <FormattedMessage id=\"more-menu.sign-out\" defaultMessage=\"Sign Out\" />,\n                icon: LeaveIcon,\n                onClick: async () => {\n                  await this.props.authChannel.signOut(this.props.hubChannel);\n                  this.setState({ signedIn: false });\n                }\n              }\n            : {\n                id: \"sign-in\",\n                label: <FormattedMessage id=\"more-menu.sign-in\" defaultMessage=\"Sign In\" />,\n                icon: EnterIcon,\n                onClick: () => this.showContextualSignInDialog()\n              },\n          // canCreateRoom && {\n          //   id: \"create-room\",\n          //   label: <FormattedMessage id=\"more-menu.create-room\" defaultMessage=\"Create Room\" />,\n          //   icon: AddIcon,\n          //   onClick: () =>\n          //     this.showNonHistoriedDialog(LeaveRoomModal, {\n          //       destinationUrl: \"/\",\n          //       reason: LeaveReason.createRoom\n          //     })\n          // },\n          {\n            id: \"user-profile\",\n            label: <FormattedMessage id=\"more-menu.profile\" defaultMessage=\"Change Name & Avatar\" />,\n            icon: AvatarIcon,\n            onClick: () => this.setSidebar(\"profile\")\n          },\n          // {\n          //   id: \"favorite-rooms\",\n          //   label: <FormattedMessage id=\"more-menu.favorite-rooms\" defaultMessage=\"Favorite Rooms\" />,\n          //   icon: FavoritesIcon,\n          //   onClick: () =>\n          //     this.props.performConditionalSignIn(\n          //       () => this.props.hubChannel.signedIn,\n          //       () => {\n          //         showFullScreenIfAvailable();\n          //         this.props.mediaSearchStore.sourceNavigateWithNoNav(\"favorites\", \"use\");\n          //       },\n          //       SignInMessages.favoriteRooms\n          //     )\n          // },\n          {\n            id: \"preferences\",\n            label: <FormattedMessage id=\"more-menu.preferences\" defaultMessage=\"Preferences\" />,\n            icon: SettingsIcon,\n            onClick: () => this.setState({ showPrefs: true })\n          }\n        ].filter(item => item)\n      },\n      {\n        id: \"room\",\n        label: <FormattedMessage id=\"more-menu.room\" defaultMessage=\"Room\" />,\n        items: [\n          {\n            id: \"room-info\",\n            label: <FormattedMessage id=\"more-menu.room-info\" defaultMessage=\"Room Info and Settings\" />,\n            icon: HomeIcon,\n            onClick: () => this.setSidebar(\"room-info\")\n          },\n          (this.props.breakpoint === \"sm\" || this.props.breakpoint === \"md\") &&\n            (this.props.hub.entry_mode !== \"invite\" || this.props.hubChannel.can(\"update_hub\")) && \n            // {\n            //   id: \"invite\",\n            //   label: <FormattedMessage id=\"more-menu.invite\" defaultMessage=\"Invite\" />,\n            //   icon: InviteIcon,\n            //   onClick: () => this.props.scene.emit(\"action_invite\")\n            // },\n          // this.isFavorited()\n          //   ? {\n          //       id: \"unfavorite-room\",\n          //       label: <FormattedMessage id=\"more-menu.unfavorite-room\" defaultMessage=\"Unfavorite Room\" />,\n          //       icon: StarIcon,\n          //       onClick: () => this.toggleFavorited()\n          //     }\n          //   : {\n          //       id: \"favorite-room\",\n          //       label: <FormattedMessage id=\"more-menu.favorite-room\" defaultMessage=\"Favorite Room\" />,\n          //       icon: StarOutlineIcon,\n          //       onClick: () => this.toggleFavorited()\n          //     },\n          isModerator &&\n            entered && {\n              id: \"streamer-mode\",\n              label: streaming ? (\n                <FormattedMessage id=\"more-menu.exit-streamer-mode\" defaultMessage=\"Exit Streamer Mode\" />\n              ) : (\n                <FormattedMessage id=\"more-menu.enter-streamer-mode\" defaultMessage=\"Enter Streamer Mode\" />\n              ),\n              icon: CameraIcon,\n              onClick: () => this.toggleStreamerMode()\n            },\n          (this.props.breakpoint === \"sm\" || this.props.breakpoint === \"md\") &&\n            entered && {\n              id: \"leave-room\",\n              label: <FormattedMessage id=\"more-menu.enter-leave-room\" defaultMessage=\"Leave Room\" />,\n              icon: LeaveIcon,\n              onClick: () => {\n                this.showNonHistoriedDialog(LeaveRoomModal, {\n                  destinationUrl: \"/\",\n                  reason: LeaveReason.leaveRoom\n                });\n              }\n            },\n          canCloseRoom && {\n            id: \"close-room\",\n            label: <FormattedMessage id=\"more-menu.close-room\" defaultMessage=\"Close Room\" />,\n            icon: DeleteIcon,\n            onClick: () =>\n              this.props.performConditionalSignIn(\n                () => this.props.hubChannel.can(\"update_hub\"),\n                () => {\n                  this.showNonHistoriedDialog(CloseRoomModal, {\n                    roomName: this.props.hub.name,\n                    onConfirm: () => {\n                      this.props.hubChannel.closeHub();\n                    }\n                  });\n                },\n                SignInMessages.closeRoom\n              )\n          }\n        ].filter(item => item)\n      },\n      {\n        id: \"support\",\n        label: <FormattedMessage id=\"more-menu.support\" defaultMessage=\"Support\" />,\n        items: [\n          configs.feature(\"show_community_link\") && {\n            id: \"community\",\n            label: <FormattedMessage id=\"more-menu.community\" defaultMessage=\"Community\" />,\n            icon: DiscordIcon,\n            href: configs.link(\"community\", \"https://discord.gg/dFJncWwHun\")\n          },\n          configs.feature(\"show_issue_report_link\") && {\n            id: \"report-issue\",\n            label: <FormattedMessage id=\"more-menu.report-issue\" defaultMessage=\"Report Issue\" />,\n            icon: WarningCircleIcon,\n            href: configs.link(\"issue_report\", \"https://hubs.mozilla.com/docs/help.html\")\n          },\n          entered && {\n            id: \"start-tour\",\n            label: <FormattedMessage id=\"more-menu.start-tour\" defaultMessage=\"Start Tour\" />,\n            icon: SupportIcon,\n            onClick: () => this.props.scene.systems.tips.resetTips()\n          },\n          configs.feature(\"show_docs_link\") && {\n            id: \"help\",\n            label: <FormattedMessage id=\"more-menu.help\" defaultMessage=\"Help\" />,\n            icon: SupportIcon,\n            href: configs.link(\"docs\", \"https://hubs.mozilla.com/docs\")\n          },\n          configs.feature(\"show_controls_link\") && {\n            id: \"controls\",\n            label: <FormattedMessage id=\"more-menu.controls\" defaultMessage=\"Controls\" />,\n            icon: SupportIcon,\n            href: configs.link(\"controls\", \"https://hubs.mozilla.com/docs/hubs-controls.html\")\n          },\n          configs.feature(\"show_whats_new_link\") && {\n            id: \"whats-new\",\n            label: <FormattedMessage id=\"more-menu.whats-new\" defaultMessage=\"What's New\" />,\n            icon: SupportIcon,\n            href: \"/whats-new\"\n          },\n          configs.feature(\"show_terms\") && {\n            id: \"tos\",\n            label: <FormattedMessage id=\"more-menu.tos\" defaultMessage=\"Terms of Service\" />,\n            icon: TextDocumentIcon,\n            href: configs.link(\"terms_of_use\", TERMS)\n          },\n          configs.feature(\"show_privacy\") && {\n            id: \"privacy\",\n            label: <FormattedMessage id=\"more-menu.privacy\" defaultMessage=\"Privacy Notice\" />,\n            icon: ShieldIcon,\n            href: configs.link(\"privacy_notice\", PRIVACY)\n          }\n        ].filter(item => item)\n      }\n    ];\n\n    return (\n      <MoreMenuContextProvider>\n        <ReactAudioContext.Provider value={this.state.audioContext}>\n          <div className={classNames(rootStyles)}>\n            {preload &&\n              this.props.hub && (\n                <PreloadOverlay\n                  hubName={this.props.hub.name}\n                  hubScene={this.props.hub.scene}\n                  baseUrl={hubUrl(this.props.hub.hub_id).href}\n                  onLoadClicked={this.props.onPreloadLoadClicked}\n                />\n              )}\n            {!this.state.dialog && (\n              <StateRoute\n                stateKey=\"overlay\"\n                stateValue=\"avatar-editor\"\n                history={this.props.history}\n                render={props => (\n                  <AvatarEditor\n                    className={styles.avatarEditor}\n                    signedIn={this.state.signedIn}\n                    onSignIn={this.showContextualSignInDialog}\n                    onSave={() => {\n                      if (props.location.state.detail && props.location.state.detail.returnToProfile) {\n                        this.props.history.goBack();\n                      } else {\n                        this.props.history.goBack();\n                        // We are returning to the media browser. Trigger an update so that the filter switches to\n                        // my-avatars, now that we've saved an avatar.\n                        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\", \"use\");\n                      }\n                      this.props.onAvatarSaved();\n                    }}\n                    onClose={() => this.props.history.goBack()}\n                    store={this.props.store}\n                    debug={avatarEditorDebug}\n                    avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                    hideDelete={props.location.state.detail && props.location.state.detail.hideDelete}\n                  />\n                )}\n              />\n            )}\n            {!this.state.dialog &&\n              showMediaBrowser && (\n                <MediaBrowserContainer\n                  history={this.props.history}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  hubChannel={this.props.hubChannel}\n                  onMediaSearchResultEntrySelected={(entry, selectAction) => {\n                    if (entry.type === \"room\") {\n                      this.showNonHistoriedDialog(LeaveRoomModal, {\n                        destinationUrl: entry.url,\n                        reason: LeaveReason.joinRoom\n                      });\n                    } else {\n                      this.props.onMediaSearchResultEntrySelected(entry, selectAction);\n                    }\n                  }}\n                  performConditionalSignIn={this.props.performConditionalSignIn}\n                  showNonHistoriedDialog={this.showNonHistoriedDialog}\n                  store={this.props.store}\n                  scene={this.props.scene}\n                />\n              )}\n            {this.props.hub && (\n              <RoomLayoutContainer\n                scene={this.props.scene}\n                store={this.props.store}\n                objectFocused={!!this.props.selectedObject}\n                streaming={streaming}\n                viewport={\n                  <>\n                    {!this.state.dialog && renderEntryFlow ? entryDialog : undefined}\n                    {!this.props.selectedObject && <CompactMoreMenuButton />}\n                    {(!this.props.selectedObject ||\n                      (this.props.breakpoint !== \"sm\" && this.props.breakpoint !== \"md\")) && (\n                      <ContentMenu>\n                        {showObjectList && (\n                          <ObjectsMenuButton\n                            active={this.state.sidebarId === \"objects\"}\n                            onClick={() => this.toggleSidebar(\"objects\")}\n                          />\n                        )}\n                        <PeopleMenuButton\n                          active={this.state.sidebarId === \"people\"}\n                          onClick={() => this.toggleSidebar(\"people\")}\n                          presencecount={this.state.presenceCount}\n                        />\n                      </ContentMenu>\n                    )}\n                    {!entered && !streaming && !isMobile && streamerName && <SpectatingLabel name={streamerName} />}\n                    {this.props.activeObject && (\n                      <ObjectMenuContainer\n                        hubChannel={this.props.hubChannel}\n                        scene={this.props.scene}\n                        onOpenProfile={() => this.setSidebar(\"profile\")}\n                        onGoToObject={() => {\n                          if (this.props.breakpoint === \"sm\") {\n                            this.setSidebar(null);\n                          }\n                        }}\n                      />\n                    )}\n                    {this.state.sidebarId !== \"chat\" &&\n                      this.props.hub && (\n                        <PresenceLog\n                          inRoom={true}\n                          presences={this.props.presences}\n                          entries={presenceLogEntries}\n                          hubId={this.props.hub.hub_id}\n                          history={this.props.history}\n                          onViewProfile={sessionId => this.setSidebar(\"user\", { selectedUserId: sessionId })}\n                        />\n                      )}\n                    <TipContainer\n                      hide={this.props.activeObject}\n                      inLobby={watching}\n                      inRoom={entered}\n                      isEmbedded={this.props.embed}\n                      isStreaming={streaming}\n                      hubId={this.props.hub.hub_id}\n                      presences={this.props.presences}\n                      scene={this.props.scene}\n                      store={this.props.store}\n                    />\n                    {(showRtcDebugPanel || showAudioDebugPanel) && (\n                      <RTCDebugPanel\n                        history={this.props.history}\n                        store={window.APP.store}\n                        scene={this.props.scene}\n                        presences={this.props.presences}\n                        sessionId={this.props.sessionId}\n                        showRtcDebug={showRtcDebugPanel}\n                        showAudioDebug={showAudioDebugPanel}\n                      />\n                    )}\n                  </>\n                }\n                sidebar={\n                  this.state.sidebarId ? (\n                    <>\n                      {this.state.sidebarId === \"chat\" && (\n                        <ChatSidebarContainer\n                          presences={this.props.presences}\n                          occupantCount={this.occupantCount()}\n                          canSpawnMessages={entered && this.props.hubChannel.can(\"spawn_and_move_media\")}\n                          scene={this.props.scene}\n                          onClose={() => this.setSidebar(null)}\n                          inputEffect={this.state.chatInputEffect}\n                        />\n                      )}\n                      {this.state.sidebarId === \"objects\" && (\n                        <ObjectsSidebarContainer\n                          hubChannel={this.props.hubChannel}\n                          onClose={() => this.setSidebar(null)}\n                        />\n                      )}\n                      {this.state.sidebarId === \"people\" && (\n                        <PeopleSidebarContainer\n                          displayNameOverride={displayNameOverride}\n                          store={this.props.store}\n                          mediaSearchStore={this.props.mediaSearchStore}\n                          hubChannel={this.props.hubChannel}\n                          history={this.props.history}\n                          mySessionId={this.props.sessionId}\n                          presences={this.props.presences}\n                          onClose={() => this.setSidebar(null)}\n                          onCloseDialog={() => this.closeDialog()}\n                          showNonHistoriedDialog={this.showNonHistoriedDialog}\n                          performConditionalSignIn={this.props.performConditionalSignIn}\n                        />\n                      )}\n                      {this.state.sidebarId === \"profile\" && (\n                        <ProfileEntryPanel\n                          history={this.props.history}\n                          containerType=\"sidebar\"\n                          displayNameOverride={displayNameOverride}\n                          finished={() => this.setSidebar(null)}\n                          onClose={() => this.setSidebar(null)}\n                          store={this.props.store}\n                          mediaSearchStore={this.props.mediaSearchStore}\n                        />\n                      )}\n                      {this.state.sidebarId === \"user\" && (\n                        <UserProfileSidebarContainer\n                          user={this.getSelectedUser()}\n                          hubChannel={this.props.hubChannel}\n                          performConditionalSignIn={this.props.performConditionalSignIn}\n                          onClose={() => this.setSidebar(null)}\n                          onCloseDialog={() => this.closeDialog()}\n                          showNonHistoriedDialog={this.showNonHistoriedDialog}\n                        />\n                      )}\n                      {this.state.sidebarId === \"room-info\" && (\n                        <RoomSidebar\n                          accountId={this.props.sessionId}\n                          room={this.props.hub}\n                          canEdit={this.props.hubChannel.canOrWillIfCreator(\"update_hub\")}\n                          onEdit={() => {\n                            this.props.performConditionalSignIn(\n                              () => this.props.hubChannel.can(\"update_hub\"),\n                              () => this.setSidebar(\"room-info-settings\"),\n                              SignInMessages.roomSettings\n                            );\n                          }}\n                          onClose={() => this.setSidebar(null)}\n                          onChangeScene={this.onChangeScene}\n                        />\n                      )}\n                      {this.state.sidebarId === \"room-info-settings\" && (\n                        <RoomSettingsSidebarContainer\n                          room={this.props.hub}\n                          hubChannel={this.props.hubChannel}\n                          showBackButton\n                          onClose={() => this.setSidebar(\"room-info\")}\n                          onChangeScene={this.onChangeScene}\n                        />\n                      )}\n                      {this.state.sidebarId === \"room-settings\" && (\n                        <RoomSettingsSidebarContainer\n                          room={this.props.hub}\n                          accountId={this.props.sessionId}\n                          hubChannel={this.props.hubChannel}\n                          onClose={() => this.setSidebar(null)}\n                          onChangeScene={this.onChangeScene}\n                        />\n                      )}\n                    </>\n                  ) : (\n                    undefined\n                  )\n                }\n                modal={this.state.dialog}\n                toolbarLeft={\n                  <InvitePopoverContainer\n                    hub={this.props.hub}\n                    hubChannel={this.props.hubChannel}\n                    scene={this.props.scene}\n                  />\n                }\n                toolbarCenter={\n                  <>\n                    {watching && (\n                      <>\n                        <ToolbarButton\n                          icon={<EnterIcon />}\n                          label={<FormattedMessage id=\"toolbar.join-room-button\" defaultMessage=\"Join Room\" />}\n                          preset=\"accept\"\n                          onClick={() => this.setState({ watching: false })}\n                        />\n                        {enableSpectateVRButton && (\n                          <ToolbarButton\n                            icon={<VRIcon />}\n                            preset=\"accent5\"\n                            label={\n                              <FormattedMessage id=\"toolbar.spectate-in-vr-button\" defaultMessage=\"Spectate in VR\" />\n                            }\n                            onClick={() => this.props.scene.enterVR()}\n                          />\n                        )}\n                      </>\n                    )}\n                    {entered && (\n                      <>\n                        <AudioPopoverContainer scene={this.props.scene} />\n                        <SharePopoverContainer scene={this.props.scene} hubChannel={this.props.hubChannel} />\n                        <PlacePopoverContainer\n                          scene={this.props.scene}\n                          hubChannel={this.props.hubChannel}\n                          mediaSearchStore={this.props.mediaSearchStore}\n                          showNonHistoriedDialog={this.showNonHistoriedDialog}\n                        />\n                        {this.props.hubChannel.can(\"spawn_emoji\") && (\n                          <ReactionPopoverContainer\n                            scene={this.props.scene}\n                            initialPresence={getPresenceProfileForSession(this.props.presences, this.props.sessionId)}\n                          />\n                        )}\n                      </>\n                    )}\n                    <ChatToolbarButtonContainer onClick={() => this.toggleSidebar(\"chat\")} />\n                    {entered && (\n                      <ToolbarButton\n                        icon={<VRIcon />}\n                        label={<FormattedMessage id=\"toolbar.camera-view\" defaultMessage=\"3rd person view\" />}\n                        onClick={() => {\n                          const cameraMode = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode;\n\n                          if (cameraMode === CAMERA_MODE_FIRST_PERSON) {\n                            AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode = CAMERA_MODE_THIRD_PERSON_VIEW;\n                          }\n\n                          if (cameraMode === CAMERA_MODE_THIRD_PERSON_VIEW) {\n                            AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode = CAMERA_MODE_FIRST_PERSON;\n                          }\n                        }}\n                      />\n                    )}\n                    {entered &&\n                      isMobileVR && (\n                        <ToolbarButton\n                          className={styleUtils.hideLg}\n                          icon={<VRIcon />}\n                          preset=\"accept\"\n                          label={<FormattedMessage id=\"toolbar.enter-vr-button\" defaultMessage=\"Enter VR\" />}\n                          onClick={() => exit2DInterstitialAndEnterVR(true)}\n                        />\n                      )}\n                  </>\n                }\n                toolbarRight={\n                  <>\n                    {entered &&\n                      isMobileVR && (\n                        <ToolbarButton\n                          icon={<VRIcon />}\n                          preset=\"accept\"\n                          label={<FormattedMessage id=\"toolbar.enter-vr-button\" defaultMessage=\"Enter VR\" />}\n                          onClick={() => exit2DInterstitialAndEnterVR(true)}\n                        />\n                      )}\n                    {entered && (\n                      <ToolbarButton\n                        icon={<LeaveIcon />}\n                        label={<FormattedMessage id=\"toolbar.leave-room-button\" defaultMessage=\"Leave\" />}\n                        preset=\"cancel\"\n                        onClick={() => {\n                          this.showNonHistoriedDialog(LeaveRoomModal, {\n                            destinationUrl: \"/\",\n                            reason: LeaveReason.leaveRoom\n                          });\n                        }}\n                      />\n                    )}\n                    <MoreMenuPopoverButton menu={moreMenu} />\n                  </>\n                }\n              />\n            )}\n          </div>\n        </ReactAudioContext.Provider>\n      </MoreMenuContextProvider>\n    );\n  }\n}\n\nfunction UIRootHooksWrapper(props) {\n  useAccessibleOutlineStyle();\n  const breakpoint = useCssBreakpoints();\n\n  useEffect(\n    () => {\n      const el = document.getElementById(\"preload-overlay\");\n      el.classList.add(\"loaded\");\n\n      const sceneEl = props.scene;\n\n      sceneEl.classList.add(roomLayoutStyles.scene);\n\n      // Remove the preload overlay after the animation has finished.\n      const timeout = setTimeout(() => {\n        el.remove();\n      }, 500);\n\n      return () => {\n        clearTimeout(timeout);\n        sceneEl.classList.remove(roomLayoutStyles.scene);\n      };\n    },\n    [props.scene]\n  );\n\n  return (\n    <ChatContextProvider messageDispatch={props.messageDispatch}>\n      <ObjectListProvider scene={props.scene}>\n        <UIRoot breakpoint={breakpoint} {...props} />\n      </ObjectListProvider>\n    </ChatContextProvider>\n  );\n}\n\nUIRootHooksWrapper.propTypes = {\n  scene: PropTypes.object.isRequired,\n  messageDispatch: PropTypes.object,\n  store: PropTypes.object.isRequired\n};\n\nexport default UIRootHooksWrapper;\n","import { useEffect, useState } from \"react\";\n\n// The page is styled by default not to have any outlines on selected input elements.\n// When the user presses the tab key the keyboardUserClass is added to the body and all outlines are re-enabled.\n// The next time you click this keyboardUserClass will be removed, removing the outline styles.\n// This lets us provide a clean look for mouse users, while still maintaining accessibility for keyboard users.\nexport function useAccessibleOutlineStyle(keyboardUserClass = \"keyboard-user\") {\n  const [keyboardUser, setKeyboardUser] = useState(false);\n\n  useEffect(\n    () => {\n      function onMouseDown() {\n        if (keyboardUser) {\n          document.body.classList.remove(keyboardUserClass);\n          setKeyboardUser(false);\n        }\n      }\n\n      function onKeyDown(e) {\n        if (e.key === \"Tab\" && !keyboardUser) {\n          document.body.classList.add(keyboardUserClass);\n          setKeyboardUser(true);\n        }\n      }\n\n      window.addEventListener(\"keydown\", onKeyDown);\n      window.addEventListener(\"mousedown\", onMouseDown);\n\n      return () => {\n        window.removeEventListener(\"keydown\", onKeyDown);\n        window.removeEventListener(\"mousedown\", onMouseDown);\n      };\n    },\n    [keyboardUserClass, keyboardUser]\n  );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { ExitedRoomScreen } from \"./ExitedRoomScreen\";\nimport constants from \"../../constants\";\n\nexport function ExitedRoomScreenContainer({ reason }) {\n  return (\n    <ExitedRoomScreen\n      showTerms={configs.feature(\"show_terms\")}\n      termsUrl={configs.link(\"terms_of_use\", constants.TERMS)}\n      showSourceLink={configs.feature(\"show_source_link\")}\n      reason={reason}\n      contactEmail={configs.translation(\"contact-email\")}\n    />\n  );\n}\n\nExitedRoomScreenContainer.propTypes = {\n  reason: PropTypes.string.isRequired\n};\n","import uuid from \"uuid/v4\";\n\nexport default class AuthChannel {\n  constructor(store) {\n    this.store = store;\n    this.socket = null;\n    this._signedIn = !!this.store.state.credentials.token;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  get email() {\n    return this.store.state.credentials.email;\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  signOut = async hubChannel => {\n    if (hubChannel) {\n      await hubChannel.signOut();\n    }\n    this.store.update({ credentials: { token: null, email: null } });\n    await this.store.resetToRandomDefaultAvatar();\n    this._signedIn = false;\n  };\n\n  verifyAuthentication(authTopic, authToken, authPayload) {\n    const channel = this.socket.channel(authTopic);\n    return new Promise((resolve, reject) => {\n      channel.onError(() => {\n        channel.leave();\n        reject();\n      });\n\n      channel\n        .join()\n        .receive(\"ok\", () => {\n          channel.on(\"auth_credentials\", async ({ credentials: token, payload: payload }) => {\n            await this.handleAuthCredentials(payload.email, token);\n            resolve();\n          });\n\n          channel.push(\"auth_verified\", { token: authToken, payload: authPayload });\n        })\n        .receive(\"error\", reject);\n    });\n  }\n\n  async startAuthentication(email, hubChannel) {\n    const channel = this.socket.channel(`auth:${uuid()}`);\n    await new Promise((resolve, reject) =>\n      channel\n        .join()\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject)\n    );\n\n    const authComplete = new Promise(resolve =>\n      channel.on(\"auth_credentials\", async ({ credentials: token }) => {\n        await this.handleAuthCredentials(email, token, hubChannel);\n        resolve();\n      })\n    );\n\n    channel.push(\"auth_request\", { email, origin: \"hubs\" });\n\n    // Returning an object with the authComplete promise since we want the caller to wait for the above await but not\n    // for authComplete.\n    return { authComplete };\n  }\n\n  async handleAuthCredentials(email, token, hubChannel) {\n    this.store.update({ credentials: { email, token } });\n\n    if (hubChannel) {\n      await hubChannel.signIn(token);\n    }\n\n    this._signedIn = true;\n  }\n}\n","import jwtDecode from \"jwt-decode\";\nimport { EventTarget } from \"event-target-shim\";\nimport { Presence } from \"phoenix\";\nimport { migrateChannelToSocket, discordBridgesForPresences, migrateToChannel } from \"./phoenix-utils\";\nimport configs from \"./configs\";\n\nconst MS_PER_DAY = 1000 * 60 * 60 * 24;\nconst MS_PER_MONTH = 1000 * 60 * 60 * 24 * 30;\n\nfunction isSameMonth(da, db) {\n  return da.getFullYear() == db.getFullYear() && da.getMonth() == db.getMonth();\n}\n\nfunction isSameDay(da, db) {\n  return isSameMonth(da, db) && da.getDate() == db.getDate();\n}\n\n// Permissions that will be assumed if the user becomes the creator.\nconst HUB_CREATOR_PERMISSIONS = [\n  \"update_hub\",\n  \"update_hub_promotion\",\n  \"update_roles\",\n  \"close_hub\",\n  \"mute_users\",\n  \"kick_users\",\n  \"amplify_audio\"\n];\nconst VALID_PERMISSIONS = HUB_CREATOR_PERMISSIONS.concat([\n  \"tweet\",\n  \"spawn_camera\",\n  \"spawn_drawing\",\n  \"spawn_and_move_media\",\n  \"pin_objects\",\n  \"spawn_emoji\",\n  \"fly\"\n]);\n\nexport default class HubChannel extends EventTarget {\n  constructor(store, hubId) {\n    super();\n    this.store = store;\n    this.hubId = hubId;\n    this._signedIn = !!this.store.state.credentials.token;\n    this._permissions = {};\n    this._blockedSessionIds = new Set();\n\n    store.addEventListener(\"profilechanged\", this.sendProfileUpdate.bind(this));\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  // Returns true if this current session has the given permission.\n  can(permission) {\n    if (!VALID_PERMISSIONS.includes(permission)) throw new Error(`Invalid permission name: ${permission}`);\n    return this._permissions && this._permissions[permission];\n  }\n\n  userCan(clientId, permission) {\n    const presenceState = this.presence.state[clientId];\n    if (!presenceState) {\n      console.warn(`userCan: Had no presence state for ${clientId}`);\n      return false;\n    }\n\n    return !!presenceState.metas[0].permissions[permission];\n  }\n\n  // Returns true if the current session has the given permission, *or* will get the permission\n  // if they sign in and become the creator.\n  canOrWillIfCreator(permission) {\n    if (this._getCreatorAssignmentToken() && HUB_CREATOR_PERMISSIONS.includes(permission)) return true;\n    return this.can(permission);\n  }\n\n  canEnterRoom(hub) {\n    if (!hub) return false;\n    if (this.canOrWillIfCreator(\"update_hub\")) return true;\n\n    const roomEntrySlotCount = Object.values(this.presence.state).reduce((acc, { metas }) => {\n      const meta = metas[metas.length - 1];\n      const usingSlot = meta.presence === \"room\" || (meta.context && meta.context.entering);\n      return acc + (usingSlot ? 1 : 0);\n    }, 0);\n\n    // This now exists in room settings but a default is left here to support old reticulum servers\n    const DEFAULT_ROOM_SIZE = 24;\n    return roomEntrySlotCount < (hub.room_size !== undefined ? hub.room_size : DEFAULT_ROOM_SIZE);\n  }\n\n  // Migrates this hub channel to a new phoenix channel and presence\n  async migrateToSocket(socket, params) {\n    let presenceBindings;\n\n    // Unbind presence, and then set up bindings after reconnect\n    if (this.presence) {\n      presenceBindings = {\n        onJoin: this.presence.caller.onJoin,\n        onLeave: this.presence.caller.onLeave,\n        onSync: this.presence.caller.onSync\n      };\n\n      this.presence.onJoin(function() {});\n      this.presence.onLeave(function() {});\n      this.presence.onSync(function() {});\n    }\n\n    this.channel = await migrateChannelToSocket(this.channel, socket, params);\n    this.presence = new Presence(this.channel);\n\n    if (presenceBindings) {\n      this.presence.onJoin(presenceBindings.onJoin);\n      this.presence.onLeave(presenceBindings.onLeave);\n      this.presence.onSync(presenceBindings.onSync);\n    }\n  }\n\n  async migrateToHub(hubId) {\n    let presenceBindings;\n\n    const newChannel = this.channel.socket.channel(`hub:${hubId}`, APP.hubChannelParamsForPermsToken());\n    const data = await migrateToChannel(this.channel, newChannel);\n\n    if (this.presence) {\n      presenceBindings = {\n        onJoin: this.presence.caller.onJoin,\n        onLeave: this.presence.caller.onLeave,\n        onSync: this.presence.caller.onSync\n      };\n\n      this.presence.onJoin(function() {});\n      this.presence.onLeave(function() {});\n      this.presence.onSync(function() {});\n    }\n\n    this.channel = newChannel;\n    this.presence = new Presence(this.channel);\n    this.hubId = data.hubs[0].hub_id;\n\n    this.setPermissionsFromToken(data.perms_token);\n\n    if (presenceBindings) {\n      this.presence.onJoin(presenceBindings.onJoin);\n      this.presence.onLeave(presenceBindings.onLeave);\n      this.presence.onSync(presenceBindings.onSync);\n    }\n    return data;\n  }\n\n  setPermissionsFromToken = token => {\n    // Note: token is not verified.\n    this.token = token;\n    this._permissions = jwtDecode(token);\n    configs.setIsAdmin(this._permissions.postgrest_role === \"ret_admin\");\n    this.dispatchEvent(new CustomEvent(\"permissions_updated\"));\n\n    // Refresh the token 1 minute before it expires.\n    const nextRefresh = new Date(this._permissions.exp * 1000 - 60 * 1000) - new Date();\n    if (this.fetchPermissionsTimeout) {\n      clearTimeout(this.fetchPermissionsTimeout);\n    }\n    this.fetchPermissionsTimeout = setTimeout(this.fetchPermissions, nextRefresh);\n  };\n\n  sendEnteringEvent = async () => {\n    this.channel.push(\"events:entering\", {});\n  };\n\n  sendEnteringCancelledEvent = async () => {\n    this.channel.push(\"events:entering_cancelled\", {});\n  };\n\n  sendEnteredEvent = async () => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before room entry.\");\n      return;\n    }\n\n    let entryDisplayType = \"Screen\";\n\n    if (navigator.getVRDisplays) {\n      const vrDisplay = (await navigator.getVRDisplays()).find(d => d.isPresenting);\n\n      if (vrDisplay) {\n        entryDisplayType = vrDisplay.displayName;\n      }\n    }\n\n    const initialOccupantCount = this.presence\n      .list((key, presence) => {\n        return { key, entryState: presence.metas[presence.metas.length - 1].presence };\n      })\n      .filter(({ key, entryState }) => {\n        return key !== NAF.clientId && entryState === \"room\";\n      }).length;\n\n    const entryTimingFlags = this.getEntryTimingFlags();\n\n    const entryEvent = {\n      ...entryTimingFlags,\n      initialOccupantCount,\n      entryDisplayType,\n      userAgent: navigator.userAgent\n    };\n\n    this.channel.push(\"events:entered\", entryEvent);\n  };\n\n  beginStreaming() {\n    this.channel.push(\"events:begin_streaming\", {});\n  }\n\n  endStreaming() {\n    this.channel.push(\"events:end_streaming\", {});\n  }\n\n  beginRecording() {\n    this.channel.push(\"events:begin_recording\", {});\n  }\n\n  endRecording() {\n    this.channel.push(\"events:end_recording\", {});\n  }\n\n  raiseHand() {\n    this.channel.push(\"events:raise_hand\", {});\n  }\n\n  lowerHand() {\n    this.channel.push(\"events:lower_hand\", {});\n  }\n\n  beginTyping() {\n    this.channel.push(\"events:begin_typing\", {});\n  }\n\n  endTyping() {\n    this.channel.push(\"events:end_typing\", {});\n  }\n\n  getEntryTimingFlags = () => {\n    const entryTimingFlags = { isNewDaily: true, isNewMonthly: true, isNewDayWindow: true, isNewMonthWindow: true };\n    const storedLastEnteredAt = this.store.state.activity.lastEnteredAt;\n\n    if (!storedLastEnteredAt) {\n      return entryTimingFlags;\n    }\n\n    const now = new Date();\n    const lastEntered = new Date(storedLastEnteredAt);\n    const msSinceLastEntered = now - lastEntered;\n\n    // note that new daily and new monthly is based on client local time\n    entryTimingFlags.isNewDaily = !isSameDay(now, lastEntered);\n    entryTimingFlags.isNewMonthly = !isSameMonth(now, lastEntered);\n    entryTimingFlags.isNewDayWindow = msSinceLastEntered > MS_PER_DAY;\n    entryTimingFlags.isNewMonthWindow = msSinceLastEntered > MS_PER_MONTH;\n\n    return entryTimingFlags;\n  };\n\n  sendObjectSpawnedEvent = objectType => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before object spawn.\");\n      return;\n    }\n\n    const spawnEvent = {\n      object_type: objectType\n    };\n\n    this.channel.push(\"events:object_spawned\", spawnEvent);\n  };\n\n  sendProfileUpdate = () => {\n    this.channel.push(\"events:profile_updated\", { profile: this.store.state.profile });\n  };\n\n  updateScene = url => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_scene\", { url });\n  };\n\n  updateHub = settings => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_hub\", settings);\n  };\n\n  fetchInvite = () => {\n    return new Promise(resolve => this.channel.push(\"fetch_invite\", {}).receive(\"ok\", resolve));\n  };\n\n  revokeInvite = hubInviteId => {\n    return new Promise(resolve =>\n      this.channel.push(\"revoke_invite\", { hub_invite_id: hubInviteId }).receive(\"ok\", resolve)\n    );\n  };\n\n  closeHub = () => {\n    if (!this._permissions.close_hub) return \"unauthorized\";\n    this.channel.push(\"close_hub\", {});\n  };\n\n  subscribe = subscription => {\n    this.channel.push(\"subscribe\", { subscription });\n  };\n\n  // If true, will tell the server to not send us any NAF traffic\n  allowNAFTraffic = allow => {\n    this.channel.push(allow ? \"unblock_naf\" : \"block_naf\", {});\n  };\n\n  unsubscribe = subscription => {\n    return new Promise(resolve => this.channel.push(\"unsubscribe\", { subscription }).receive(\"ok\", resolve));\n  };\n\n  sendMessage = (body, type = \"chat\") => {\n    if (!body) return;\n    this.channel.push(\"message\", { body, type });\n  };\n\n  _getCreatorAssignmentToken = () => {\n    const creatorAssignmentTokenEntry =\n      this.store.state.creatorAssignmentTokens &&\n      this.store.state.creatorAssignmentTokens.find(t => t.hubId === this.hubId);\n\n    return creatorAssignmentTokenEntry && creatorAssignmentTokenEntry.creatorAssignmentToken;\n  };\n\n  signIn = token => {\n    return new Promise((resolve, reject) => {\n      const creator_assignment_token = this._getCreatorAssignmentToken();\n\n      this.channel\n        .push(\"sign_in\", { token, creator_assignment_token })\n        .receive(\"ok\", ({ perms_token }) => {\n          this.setPermissionsFromToken(perms_token);\n          this._signedIn = true;\n          resolve();\n        })\n        .receive(\"error\", err => {\n          if (err.reason === \"invalid_token\") {\n            console.warn(\"sign in failed\", err);\n            // Token expired or invalid TODO purge from storage if possible\n            resolve();\n          } else {\n            console.error(\"sign in failed\", err);\n            reject();\n          }\n        });\n    });\n  };\n\n  signOut = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"sign_out\")\n        .receive(\"ok\", async () => {\n          this._signedIn = false;\n          const params = this.channel.params();\n          delete params.auth_token;\n          delete params.perms_token;\n          await this.fetchPermissions();\n          resolve();\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getHost = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"get_host\")\n        .receive(\"ok\", res => {\n          resolve(res);\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getTwitterOAuthURL = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"oauth\", { type: \"twitter\" })\n        .receive(\"ok\", res => {\n          resolve(res.oauth_url);\n        })\n        .receive(\"error\", err => reject(new Error(err.reason)));\n    });\n  };\n\n  discordBridges = () => {\n    if (!this.presence || !this.presence.state) return [];\n    return discordBridgesForPresences(this.presence.state);\n  };\n\n  pin = (id, gltfNode, fileId, fileAccessToken, promotionToken) => {\n    const payload = { id, gltf_node: gltfNode };\n    if (fileId && promotionToken) {\n      payload.file_id = fileId;\n      payload.file_access_token = fileAccessToken;\n      payload.promotion_token = promotionToken;\n    }\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"pin\", payload)\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject);\n    });\n  };\n\n  unpin = (id, fileId) => {\n    const payload = { id };\n    if (fileId) {\n      payload.file_id = fileId;\n    }\n    this.channel.push(\"unpin\", payload);\n  };\n\n  fetchPermissions = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"refresh_perms_token\")\n        .receive(\"ok\", res => {\n          this.setPermissionsFromToken(res.perms_token);\n          resolve({ permsToken: res.perms_token, permissions: this._permissions });\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  mute = sessionId => this.channel.push(\"mute\", { session_id: sessionId });\n  addOwner = sessionId => this.channel.push(\"add_owner\", { session_id: sessionId });\n  removeOwner = sessionId => this.channel.push(\"remove_owner\", { session_id: sessionId });\n\n  hide = sessionId => {\n    NAF.connection.adapter.block(sessionId);\n    APP.dialog.block(sessionId);\n    this.channel.push(\"block\", { session_id: sessionId });\n    this._blockedSessionIds.add(sessionId);\n  };\n\n  unhide = sessionId => {\n    if (!this._blockedSessionIds.has(sessionId)) return;\n    NAF.connection.adapter.unblock(sessionId);\n    APP.dialog.unblock(sessionId);\n    NAF.connection.entities.completeSync(sessionId);\n    this.channel.push(\"unblock\", { session_id: sessionId });\n    this._blockedSessionIds.delete(sessionId);\n  };\n\n  isHidden = sessionId => this._blockedSessionIds.has(sessionId);\n\n  kick = async sessionId => {\n    APP.dialog.kick(sessionId);\n    this.channel.push(\"kick\", { session_id: sessionId });\n  };\n\n  requestSupport = () => this.channel.push(\"events:request_support\", {});\n  favorite = () => this.channel.push(\"favorite\", {});\n  unfavorite = () => this.channel.push(\"unfavorite\", {});\n\n  disconnect = () => {\n    if (this.channel) {\n      this.channel.socket.disconnect();\n    }\n  };\n}\n","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\n\nasync function deriveKey(privateKey, publicKey) {\n  return crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: publicKey },\n    privateKey,\n    { name: \"AES-CBC\", length: 256 },\n    true,\n    [\"encrypt\", \"decrypt\"]\n  );\n}\n\nasync function publicKeyToString(key) {\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\n}\n\nasync function stringToPublicKey(s) {\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\n\nfunction stringToArrayBuffer(s) {\n  const buf = new Uint8Array(s.length);\n\n  for (let i = 0; i < s.length; i++) {\n    buf[i] = s.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nfunction arrayBufferToString(b) {\n  const buf = new Uint8Array(b);\n  let s = \"\";\n\n  for (let i = 0; i < buf.byteLength; i++) {\n    s += String.fromCharCode(buf[i]);\n  }\n\n  return s;\n}\n\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\n\n// Requestor generates a public key and private key, and should send the public key to receiver.\nexport async function generateKeys() {\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  return { publicKeyString, privateKey: keyPair.privateKey };\n}\n\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\n  const iv = new Uint8Array(16);\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\n\n  const encryptedData = btoa(\n    arrayBufferToString(\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\n    )\n  );\n\n  return { publicKeyString, encryptedData };\n}\n\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\n  const iv = new Uint8Array(16);\n  const publicKey = await stringToPublicKey(publicKeyString);\n  const secret = await deriveKey(privateKey, publicKey);\n  const ciphertext = stringToArrayBuffer(atob(base64value));\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\n  return JSON.parse(arrayBufferToString(data));\n}\n","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\n\nconst LINK_ACTION_TIMEOUT = 10000;\n\nexport default class LinkChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  // Returns a promise that, when resolved, will forward an object with three keys:\n  //\n  // code: The code that was made available to use for link.\n  //\n  // cancel: A function that the caller can call to cancel the use of the code.\n  //\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\n  // because it was either successfully used by the remote device or it has expired\n  // (\"used\" or \"expired\" is passed to the callback).\n  generateCode = () => {\n    return new Promise(resolve => {\n      const onFinished = new Promise(finished => {\n        const step = () => {\n          const getLetter = () => \"ABCDEFGHI\"[Math.floor(Math.random() * 9)];\n          const code = `${getLetter()}${getLetter()}${getLetter()}${getLetter()}`;\n\n          // Only respond to one link_request in this channel.\n          let readyToSend = false;\n          let leftChannel = false;\n\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n\n          const leave = () => {\n            if (!leftChannel) channel.leave();\n            leftChannel = true;\n          };\n\n          const cancel = () => leave();\n\n          channel.on(\"link_expired\", () => finished(\"expired\"));\n\n          channel.on(\"presence_state\", state => {\n            if (readyToSend) return;\n\n            if (Object.keys(state).length > 0) {\n              // Code is in use by someone else, try a new one\n              step();\n            } else {\n              readyToSend = true;\n              resolve({ code, cancel, onFinished });\n            }\n          });\n\n          channel.on(\"link_request\", incoming => {\n            if (readyToSend) {\n              const data = { path: location.pathname };\n\n              // Copy profile data to link'ed device if it's been set.\n              if (this.store.state.activity.hasChangedName) {\n                data.profile = { ...this.store.state.profile };\n              }\n              data.credentials = { ...this.store.state.credentials };\n\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\n                ({ publicKeyString, encryptedData }) => {\n                  const payload = {\n                    target_session_id: incoming.reply_to_session_id,\n                    public_key: publicKeyString,\n                    data: encryptedData\n                  };\n\n                  if (!leftChannel) {\n                    channel.push(\"link_response\", payload);\n                  }\n\n                  leave();\n\n                  finished(\"used\");\n                  readyToSend = false;\n                }\n              );\n            }\n          });\n\n          channel.join().receive(\"error\", r => console.error(r));\n        };\n\n        step();\n      });\n    });\n  };\n\n  // Attempts to receive a link payload from a remote device using the given code.\n  //\n  // Promise rejects if the code is invalid or there is a problem with the channel.\n  // Promise resolves and passes payload of link source on successful link.\n  attemptLink = code => {\n    return new Promise((resolve, reject) => {\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n      let finished = false;\n\n      generateKeys().then(({ publicKeyString, privateKey }) => {\n        channel.on(\"presence_state\", state => {\n          const numOccupants = Object.keys(state).length;\n\n          if (numOccupants === 1) {\n            // Great, only sender is in topic, request link\n            channel.push(\"link_request\", {\n              reply_to_session_id: this.socket.params().session_id,\n              public_key: publicKeyString\n            });\n\n            setTimeout(() => {\n              if (finished) return;\n              channel.leave();\n              reject(new Error(\"no_response\"));\n            }, LINK_ACTION_TIMEOUT);\n          } else if (numOccupants === 0) {\n            // Nobody in this channel, probably a bad code.\n            channel.leave();\n            reject(new Error(\"failed\"));\n          } else {\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\n            channel.leave();\n            reject(new Error(\"in_use\"));\n          }\n        });\n\n        channel.on(\"link_response\", payload => {\n          finished = true;\n          channel.leave();\n\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\n        });\n\n        channel\n          .join()\n          .receive(\"ok\", data => (this.socket.params().session_id = data.session_id))\n          .receive(\"error\", r => console.error(r));\n      });\n    });\n  };\n}\n","import { isIOS as detectIOS } from \"./is-mobile\";\nconst isIOS = detectIOS();\n\n// TODO should we be using touch-action CSS for this?\nexport function disableiOSZoom() {\n  if (!isIOS) return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import { SHAPE, FIT } from \"three-ammo/constants\";\n\nfunction exceedsDensityThreshold(count, subtree) {\n  const bounds = subtree.boundingData;\n  const triangleThreshold = 1000;\n  const minimumVolume = 0.1;\n  const minimumTriangles = 100;\n  const dx = bounds[3] - bounds[0];\n  const dy = bounds[4] - bounds[1];\n  const dz = bounds[5] - bounds[2];\n  const volume = dx * dy * dz;\n\n  if (volume < minimumVolume) {\n    return false;\n  }\n\n  if (count < minimumTriangles) {\n    return false;\n  }\n\n  return count / volume > triangleThreshold;\n}\n\nfunction isHighDensity(subtree) {\n  if (subtree.continueGeneration) {\n    subtree.continueGeneration();\n  }\n  if (subtree.count) {\n    const result = exceedsDensityThreshold(subtree.count, subtree);\n    return result === true ? true : subtree.count;\n  } else {\n    const leftResult = isHighDensity(subtree.left);\n    if (leftResult === true) return true;\n    const rightResult = isHighDensity(subtree.right);\n    if (rightResult === true) return true;\n\n    const count = leftResult + rightResult;\n    const result = exceedsDensityThreshold(count, subtree);\n    return result === true ? true : count;\n  }\n}\n\nfunction isGeometryHighDensity(geo) {\n  const bvh = geo.boundsTree;\n  const roots = bvh._roots;\n  for (let i = 0; i < roots.length; ++i) {\n    return isHighDensity(roots[i]) === true;\n  }\n  return false;\n}\n\nexport const traverseMeshesAndAddShapes = (function() {\n  const shapePrefix = \"shape-helper__\";\n  const shapes = [];\n  return function(el) {\n    const meshRoot = el.object3DMap.mesh;\n    while (shapes.length > 0) {\n      const { id, entity } = shapes.pop();\n      entity.removeAttribute(id);\n    }\n\n    console.group(\"traverseMeshesAndAddShapes\");\n\n    if (document.querySelector([\"[shape-helper__trimesh]\", \"[shape-helper__heightfield]\"])) {\n      console.log(\"heightfield or trimesh found on scene\");\n    } else {\n      console.log(\"collision not found in scene\");\n\n      let isHighDensity = false;\n      meshRoot.traverse(o => {\n        if (\n          o.isMesh &&\n          (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\n          !o.name.startsWith(\"Floor_Plan\") &&\n          !o.name.startsWith(\"Ground_Plane\") &&\n          o.geometry.boundsTree\n        ) {\n          if (isGeometryHighDensity(o.geometry)) {\n            isHighDensity = true;\n            return;\n          }\n        }\n      });\n\n      let navMesh = null;\n\n      if (isHighDensity) {\n        console.log(\"mesh contains high triangle density region\");\n        navMesh = document.querySelector(\"[nav-mesh]\");\n      }\n\n      if (navMesh) {\n        console.log(`mesh density exceeded, using floor plan only`);\n        navMesh.setAttribute(shapePrefix + \"floorPlan\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL,\n          includeInvisible: true\n        });\n        shapes.push({ id: shapePrefix + \"floorPlan\", entity: navMesh });\n      } else if (!isHighDensity) {\n        el.setAttribute(shapePrefix + \"environment\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL\n        });\n        shapes.push({ id: shapePrefix + \"environment\", entity: el });\n        console.log(\"adding mesh shape for all visible meshes\");\n      } else {\n        el.setAttribute(shapePrefix + \"defaultFloor\", {\n          type: SHAPE.BOX,\n          margin: 0.01,\n          halfExtents: { x: 4000, y: 0.5, z: 4000 },\n          offset: { x: 0, y: -0.5, z: 0 },\n          fit: FIT.MANUAL\n        });\n        shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\n        console.log(\"adding default floor collision\");\n      }\n    }\n    console.groupEnd();\n  };\n})();\n","import { addComponent, removeComponent, defineQuery, hasComponent } from \"bitecs\";\nimport {\n  HoverButton,\n  HoveredHandLeft,\n  HoveredHandRight,\n  HoveredRemoteLeft,\n  HoveredRemoteRight,\n  Interacted,\n  SingleActionButton,\n  TextButton\n} from \"../bit-components\";\nimport { hasAnyComponent } from \"../utils/bit-utils\";\nimport { getThemeColor } from \"../utils/theme\";\nimport { CAMERA_MODE_INSPECT } from \"./camera-system\";\nimport { paths } from \"./userinput/paths\";\n\nfunction interact(world, entities, path, interactor) {\n  if (AFRAME.scenes[0].systems.userinput.get(path)) {\n    for (let i = 0; i < entities.length; i++) {\n      const eid = entities[i];\n      addComponent(world, Interacted, eid);\n\n      // TODO: New systems should not listen for this event\n      // Delete this when we're done interoping with old world systems\n      world.eid2obj.get(eid).dispatchEvent({\n        type: \"interact\",\n        object3D: interactor\n      });\n    }\n  }\n}\n\nconst interactedQuery = defineQuery([Interacted]);\nconst rightRemoteQuery = defineQuery([SingleActionButton, HoveredRemoteRight]);\nconst leftRemoteQuery = defineQuery([SingleActionButton, HoveredRemoteLeft]);\n\nfunction singleActionButtonSystem(world) {\n  // Clear the interactions from previous frames\n  const interactedEnts = interactedQuery(world);\n  for (let i = 0; i < interactedEnts.length; i++) {\n    const eid = interactedEnts[i];\n    removeComponent(world, Interacted, eid);\n  }\n\n  if (AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT) {\n    // TODO: Fix issue where button objects are \"visible\" but not on the inspect layer,\n    // which makes it so we can interact with them but cannot see them.\n    return;\n  }\n\n  const interactorSettings = AFRAME.scenes[0].systems.interaction.options;\n  interact(\n    world,\n    leftRemoteQuery(world),\n    paths.actions.cursor.left.grab,\n    interactorSettings.leftRemote.entity.object3D\n  );\n  interact(\n    world,\n    rightRemoteQuery(world),\n    paths.actions.cursor.right.grab,\n    interactorSettings.rightRemote.entity.object3D\n  );\n}\n\nexport const BUTTON_TYPES = {\n  DEFAULT: 0,\n  ACTION: 1\n};\n\nconst buttonStyles = {};\n// TODO these colors come from what we are doing in theme.js for aframe mixins but they seem fishy\nfunction applyTheme() {\n  buttonStyles[BUTTON_TYPES.DEFAULT] = {\n    color: new THREE.Color(0xffffff),\n    hoverColor: new THREE.Color(0xaaaaaa),\n    textColor: new THREE.Color(getThemeColor(\"action-color\")),\n    textHoverColor: new THREE.Color(getThemeColor(\"action-color-highlight\"))\n  };\n  buttonStyles[BUTTON_TYPES.ACTION] = {\n    color: new THREE.Color(getThemeColor(\"action-color\")),\n    hoverColor: new THREE.Color(getThemeColor(\"action-color-highlight\")),\n    textColor: new THREE.Color(0xffffff),\n    textHoverColor: new THREE.Color(0xffffff)\n  };\n}\nwindow.addEventListener(\"update_theme\", applyTheme);\napplyTheme();\n\nconst hoverComponents = [HoveredRemoteRight, HoveredRemoteLeft, HoveredHandRight, HoveredHandLeft];\n\nconst hoverButtonsQuery = defineQuery([HoverButton]);\nfunction hoverButtonSystem(world) {\n  hoverButtonsQuery(world).forEach(function(eid) {\n    const obj = world.eid2obj.get(eid);\n    const isHovered = hasAnyComponent(world, hoverComponents, eid);\n    const style = buttonStyles[HoverButton.type[eid]];\n    obj.material.color.copy(isHovered ? style.hoverColor : style.color);\n    if (hasComponent(world, TextButton, eid)) {\n      const lbl = world.eid2obj.get(TextButton.labelRef[eid]);\n      lbl.color = isHovered ? style.textHoverColor : style.textColor;\n    }\n  });\n}\n\nexport function buttonSystems(world) {\n  hoverButtonSystem(world);\n  singleActionButtonSystem(world);\n}\n","import { defineQuery, enterQuery, entityExists, exitQuery, hasComponent, Not } from \"bitecs\";\nimport { Object3DTag, Rigidbody, PhysicsShape, AEntity } from \"../bit-components\";\nimport { ACTIVATION_STATE, FIT, SHAPE } from \"three-ammo/constants\";\n// import { holdableButtonSystem } from \"./holdable-button-system\";\n\nconst rigidbodyQuery = defineQuery([Rigidbody, Object3DTag, Not(AEntity)]);\nconst rigidbodyEnteredQuery = enterQuery(rigidbodyQuery);\nconst rigidbodyExitedQuery = exitQuery(rigidbodyQuery);\nconst shapeExitQuery = exitQuery(defineQuery([PhysicsShape]));\n\nexport const RIGIDBODY_FLAGS = {\n  DISABLE_COLLISIONS: 1 << 0\n};\n\nexport const physicsCompatSystem = world => {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  const eids = rigidbodyEnteredQuery(world);\n  for (let i = 0; i < eids.length; i++) {\n    const eid = eids[i];\n\n    const obj = world.eid2obj.get(eid);\n\n    // TODO these are all hardcoded values, RigidBody should actually have (some of?) these properties\n    const bodyId = physicsSystem.addBody(obj, {\n      mass: 1,\n      gravity: { x: 0, y: Rigidbody.gravity[eid], z: 0 },\n      linearDamping: 0.01,\n      angularDamping: 0.01,\n      linearSleepingThreshold: 1.6,\n      angularSleepingThreshold: 2.5,\n      angularFactor: { x: 1, y: 1, z: 1 },\n      activationState: ACTIVATION_STATE.ACTIVE_TAG,\n      emitCollisionEvents: false,\n      scaleAutoUpdate: false,\n      type: \"kinematic\",\n      disableCollision: Rigidbody.flags[eid] & RIGIDBODY_FLAGS.DISABLE_COLLISIONS,\n      collisionFilterGroup: Rigidbody.collisionGroup[eid],\n      collisionFilterMask: Rigidbody.collisionMask[eid]\n    });\n    Rigidbody.bodyId[eid] = bodyId;\n\n    // TODO same deal for these, hardcoded, also we may want to support nested shapes\n    if (hasComponent(world, PhysicsShape, eid)) {\n      const halfExtents = PhysicsShape.halfExtents[eid];\n      PhysicsShape.bodyId[eid] = bodyId;\n      const shapeId = physicsSystem.addShapes(bodyId, obj, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        halfExtents: { x: halfExtents[0], y: halfExtents[1], z: halfExtents[2] },\n        margin: 0.01,\n        offset: { x: 0, y: 0, z: 0 },\n        orientation: { x: 0, y: 0, z: 0, w: 1 }\n      });\n      PhysicsShape.shapeId[eid] = shapeId;\n    }\n  }\n\n  {\n    const eids = shapeExitQuery(world);\n    for (let i = 0; i < eids.length; i++) {\n      const eid = eids[i];\n      physicsSystem.removeShapes(PhysicsShape.bodyId[eid], PhysicsShape.shapeId[eid]);\n    }\n  }\n\n  {\n    const eids = rigidbodyExitedQuery(world);\n    for (let i = 0; i < eids.length; i++) {\n      const eid = eids[i];\n      if (entityExists(world, eid) && hasComponent(world, PhysicsShape, eid)) {\n        physicsSystem.removeShapes(PhysicsShape.bodyId[eid], PhysicsShape.shapeId[eid]);\n        // The PhysicsShape is still on this entity!\n      }\n      physicsSystem.removeBody(Rigidbody.bodyId[eid]);\n    }\n  }\n\n  return world;\n};\n","import { addObject3DComponent } from \"../utils/jsx-entity\";\nimport { NetworkedMediaFrame, MediaFrame, Rigidbody, PhysicsShape, Networked } from \"../bit-components\";\nimport { addComponent, hasComponent } from \"bitecs\";\nimport { MediaType } from \"../utils/media-utils\";\nimport { COLLISION_LAYERS } from \"../constants\";\nimport { RIGIDBODY_FLAGS } from \"../systems/bit-physics\";\nimport { Layers } from \"../components/layers\";\n\nimport * as THREE from 'three';\n\nconst DEFAULTS = {\n  bounds: { x: 1, y: 1, z: 1 },\n  mediaType: \"all\"\n};\n\nexport function inflateMediaFrame(world, eid, componentProps) {\n  componentProps = Object.assign({}, DEFAULTS, componentProps);\n  const guide = new THREE.Mesh(\n    new THREE.BoxBufferGeometry(componentProps.bounds.x, componentProps.bounds.y, componentProps.bounds.z),\n    new THREE.ShaderMaterial({\n      uniforms: {\n        color: { value: new THREE.Color(0x2f80ed) }\n      },\n      vertexShader: `\n            varying vec2 vUv;\n            void main()\n            {\n              gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n              vUv = uv;\n            }\n          `,\n      fragmentShader: `\n            // adapted from https://www.shadertoy.com/view/Mlt3z8\n            float bayerDither2x2( vec2 v ) {\n              return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );\n            }\n            float bayerDither4x4( vec2 v ) {\n              vec2 P1 = mod( v, 2.0 );\n              vec2 P2 = mod( floor( 0.5  * v ), 2.0 );\n              return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );\n            }\n\n            varying vec2 vUv;\n            uniform vec3 color;\n            void main() {\n              float alpha = max(step(0.45, abs(vUv.x - 0.5)), step(0.45, abs(vUv.y - 0.5))) - 0.5;\n              if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;\n              gl_FragColor = vec4(color, 1.0);\n            }\n          `,\n      side: THREE.DoubleSide\n    })\n  );\n  guide.layers.set(Layers.CAMERA_LAYER_UI);\n  // TODO: This is a hack around the physics system addBody call requiring its body to have parent\n  guide.parent = new THREE.Group();\n  addObject3DComponent(world, eid, guide);\n  addComponent(world, MediaFrame, eid, true);\n  addComponent(world, NetworkedMediaFrame, eid, true);\n\n  if (!hasComponent(world, Networked, eid)) addComponent(world, Networked, eid);\n\n  MediaFrame.mediaType[eid] = {\n    all: MediaType.ALL,\n    \"all-2d\": MediaType.ALL_2D,\n    model: MediaType.MODEL,\n    image: MediaType.IMAGE,\n    video: MediaType.VIDEO,\n    pdf: MediaType.PDF\n  }[componentProps.mediaType];\n  MediaFrame.bounds[eid].set([componentProps.bounds.x, componentProps.bounds.y, componentProps.bounds.z]);\n\n  addComponent(world, Rigidbody, eid);\n  Rigidbody.collisionGroup[eid] = COLLISION_LAYERS.MEDIA_FRAMES;\n  Rigidbody.collisionMask[eid] = COLLISION_LAYERS.INTERACTABLES;\n  Rigidbody.flags[eid] = RIGIDBODY_FLAGS.DISABLE_COLLISIONS;\n  addComponent(world, PhysicsShape, eid);\n  PhysicsShape.halfExtents[eid].set([\n    componentProps.bounds.x / 2,\n    componentProps.bounds.y / 2,\n    componentProps.bounds.z / 2\n  ]);\n}\n\n","import { addComponent } from \"bitecs\";\nimport { Text as TroikaText } from \"troika-three-text\";\nimport { Text } from \"../bit-components\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\n\nconst THREE_SIDES = {\n  front: THREE.FrontSide,\n  back: THREE.BackSide,\n  double: THREE.DoubleSide\n};\n\nconst DEFAULTS = {\n  textAlign: \"center\",\n  anchorX: \"center\",\n  anchorY: \"middle\"\n};\n\nexport function inflateText(world, eid, componentProps) {\n  componentProps = Object.assign({}, DEFAULTS, componentProps);\n  addComponent(world, Text, eid);\n  const text = new TroikaText();\n  Object.entries(componentProps).forEach(([name, value]) => {\n    switch (name) {\n      case \"value\":\n        text.text = value;\n        break;\n      case \"side\":\n        text.material.side = THREE_SIDES[value];\n        break;\n      case \"opacity\":\n        text.material.side = value;\n        break;\n      case \"fontUrl\":\n        text.font = value;\n        break;\n      default:\n        text[name] = value;\n    }\n  });\n  text.sync();\n  addObject3DComponent(world, eid, text);\n}\n","import { addComponent, addEntity, hasComponent } from \"bitecs\";\nimport { preloadFont } from \"troika-three-text\";\nimport {\n  CameraTool,\n  CursorRaycastable,\n  DestroyAtExtremeDistance,\n  FloatyObject,\n  HandCollisionTarget,\n  Holdable,\n  HoldableButton,\n  HoverButton,\n  MakeKinematicOnRelease,\n  Networked,\n  NetworkedTransform,\n  Object3DTag,\n  OffersHandConstraint,\n  OffersRemoteConstraint,\n  PhysicsShape,\n  RemoteHoverTarget,\n  Rigidbody,\n  SingleActionButton,\n  TextButton\n} from \"../bit-components\";\nimport { inflateMediaFrame } from \"../inflators/media-frame\";\nimport { inflateModel } from \"../inflators/model\";\nimport { inflateSlice9 } from \"../inflators/slice9\";\nimport { inflateText } from \"../inflators/text\";\n\n// TODO we should do this in a more explicit spot for \"preloading\" during the loading screen\npreloadFont({ characters: \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_<()>[]|0123456789\" }, function() {});\n\nfunction isValidChild(child) {\n  if (child === undefined) {\n    console.warn(\"found undefined node\");\n    return false;\n  } else if (typeof child === \"string\") {\n    console.warn(\"found text node\", child);\n    return false;\n  }\n\n  return true;\n}\n\nconst reservedAttrs = [\"position\", \"rotation\", \"scale\", \"visible\", \"name\", \"layers\"];\n\nclass Ref {\n  constructor() {\n    this.current = null;\n  }\n}\nexport function createRef() {\n  return new Ref();\n}\nfunction resolveRef(world, ref) {\n  if (ref.current === null) {\n    ref.current = addEntity(world);\n  }\n  return ref.current;\n}\n\nexport function createElementEntity(tag, attrs, ...children) {\n  attrs = attrs || {};\n  if (typeof tag === \"function\") {\n    return tag(attrs, children);\n  } else if (tag === \"entity\") {\n    const outputAttrs = {};\n    const components = [];\n    let ref = null;\n\n    for (const attr in attrs) {\n      if (reservedAttrs.includes(attr)) {\n        outputAttrs[attr] = attrs[attr];\n      } else if (attr === \"ref\") {\n        ref = attrs[attr];\n      } else {\n        // if jsx transformed the attr into attr: true, change it to attr: {}.\n        components[attr] = attrs[attr] === true ? {} : attrs[attr];\n      }\n    }\n\n    return {\n      attrs: outputAttrs,\n      components,\n      children: children.flat().filter(isValidChild),\n      ref\n    };\n  } else {\n    throw new Error(\"invalid tag\", tag);\n  }\n}\n\nexport function addObject3DComponent(world, eid, obj) {\n  if (hasComponent(APP.world, Object3DTag, eid)) {\n    throw new Error(\"Tried to an object3D tag to an entity that already has one\");\n  }\n  addComponent(APP.world, Object3DTag, eid);\n  world.eid2obj.set(eid, obj);\n  obj.eid = eid;\n  return eid;\n}\n\n// TODO HACK gettting internal bitecs symbol, should expose an API to check a properties type\nconst $isEidType = Object.getOwnPropertySymbols(CameraTool.screenRef).find(s => s.description === \"isEidType\");\nconsole.log($isEidType);\n\nconst createDefaultInflator = (Component, defaults = {}) => {\n  return (world, eid, componentProps) => {\n    componentProps = Object.assign({}, defaults, componentProps);\n    addComponent(world, Component, eid, true);\n    Object.keys(componentProps).forEach(propName => {\n      const prop = Component[propName];\n      if (!prop) {\n        console.error(`${propName} is not a valid property of`, Component);\n        return;\n      }\n      const value = componentProps[propName];\n      prop[eid] = prop[$isEidType] ? resolveRef(world, value) : value;\n    });\n  };\n};\n\nconst inflators = {\n  \"cursor-raycastable\": createDefaultInflator(CursorRaycastable),\n  \"remote-hover-target\": createDefaultInflator(RemoteHoverTarget),\n  \"hand-collision-target\": createDefaultInflator(HandCollisionTarget),\n  \"offers-remote-constraint\": createDefaultInflator(OffersRemoteConstraint),\n  \"offers-hand-constraint\": createDefaultInflator(OffersHandConstraint),\n  \"single-action-button\": createDefaultInflator(SingleActionButton),\n  \"holdable-button\": createDefaultInflator(HoldableButton),\n  \"text-button\": createDefaultInflator(TextButton),\n  \"hover-button\": createDefaultInflator(HoverButton),\n  holdable: createDefaultInflator(Holdable),\n  rigidbody: createDefaultInflator(Rigidbody),\n  \"physics-shape\": createDefaultInflator(PhysicsShape),\n  \"floaty-object\": createDefaultInflator(FloatyObject),\n  \"make-kinematic-on-release\": createDefaultInflator(MakeKinematicOnRelease),\n  \"destroy-at-extreme-distance\": createDefaultInflator(DestroyAtExtremeDistance),\n  \"networked-transform\": createDefaultInflator(NetworkedTransform),\n  networked: createDefaultInflator(Networked),\n  \"camera-tool\": createDefaultInflator(CameraTool, { captureDurIdx: 1 }),\n\n  // inflators that create Object3Ds\n  \"media-frame\": inflateMediaFrame,\n  object3D: addObject3DComponent,\n  slice9: inflateSlice9,\n  text: inflateText,\n  model: inflateModel\n};\n\nexport function renderAsEntity(world, entityDef) {\n  const eid = entityDef.ref ? resolveRef(world, entityDef.ref) : addEntity(world);\n\n  Object.keys(entityDef.components).forEach(name => {\n    if (!inflators[name]) {\n      throw new Error(`Failed to inflate unknown component called ${name}`);\n    }\n\n    inflators[name](world, eid, entityDef.components[name]);\n  });\n\n  let obj = world.eid2obj.get(eid);\n  if (!obj) {\n    obj = new THREE.Group();\n    addObject3DComponent(world, eid, obj);\n  }\n\n  if (entityDef.attrs.position) {\n    obj.position.fromArray(entityDef.attrs.position);\n  }\n  if (entityDef.attrs.rotation) {\n    obj.rotation.fromArray(entityDef.attrs.rotation);\n  }\n  if (entityDef.attrs.scale) {\n    obj.scale.fromArray(entityDef.attrs.scale);\n  }\n  if (entityDef.attrs.name) {\n    obj.name = entityDef.attrs.name;\n  }\n  if (entityDef.attrs.layers !== undefined) {\n    obj.layers.mask = entityDef.attrs.layers;\n  }\n  if (entityDef.attrs.visible !== undefined) {\n    obj.visible = entityDef.attrs.visible;\n  }\n  entityDef.children.forEach(child => {\n    if (child.type === \"a-entity\") {\n      throw new Error(\"a-entity can only be children of a-entity\");\n    } else {\n      const childEid = renderAsEntity(world, child);\n      obj.add(world.eid2obj.get(childEid));\n    }\n  });\n  return eid;\n}\n","import { addComponent } from \"bitecs\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\nimport { Slice9 } from \"../bit-components\";\nimport { updateSlice9Geometry } from \"../update-slice9-geometry\";\n\nexport function inflateSlice9(world, eid, { size, insets, texture }) {\n  const geometry = new THREE.PlaneBufferGeometry(1, 1, 3, 3);\n  const material = new THREE.MeshBasicMaterial({ map: texture, transparent: true, toneMapped: false });\n  const obj = new THREE.Mesh(geometry, material);\n  addObject3DComponent(world, eid, obj);\n\n  addComponent(world, Slice9, eid);\n  Slice9.insets[eid].set(insets);\n  Slice9.size[eid].set(size);\n  updateSlice9Geometry(world, eid);\n}\n","import { Slice9 } from \"./bit-components\";\n\nexport function updateSlice9Geometry(world, eid) {\n  const geometry = world.eid2obj.get(eid).geometry;\n  const pos = geometry.attributes.position.array;\n  const uvs = geometry.attributes.uv.array;\n\n  const [width, height] = Slice9.size[eid];\n  const [top, bottom, left, right] = Slice9.insets[eid];\n\n  /*\n      0--1------------------------------2--3\n      |  |                              |  |\n      4--5------------------------------6--7\n      |  |                              |  |\n      |  |                              |  |\n      |  |                              |  |\n      8--9-----------------------------10--11\n      |  |                              |  |\n      12-13----------------------------14--15\n    */\n  function setPos(id, x, y) {\n    pos[3 * id] = x;\n    pos[3 * id + 1] = y;\n  }\n\n  function setUV(id, u, v) {\n    uvs[2 * id] = u;\n    uvs[2 * id + 1] = v;\n  }\n\n  // Update UVS\n  // TODO hardcoded\n  const textureHeight = 128;\n  const textureWidth = 128;\n\n  const uv = {\n    left: left / textureWidth,\n    right: right / textureWidth,\n    top: top / textureHeight,\n    bottom: bottom / textureHeight\n  };\n\n  setUV(1, uv.left, 1);\n  setUV(2, uv.right, 1);\n\n  setUV(4, 0, uv.bottom);\n  setUV(5, uv.left, uv.bottom);\n  setUV(6, uv.right, uv.bottom);\n  setUV(7, 1, uv.bottom);\n\n  setUV(8, 0, uv.top);\n  setUV(9, uv.left, uv.top);\n  setUV(10, uv.right, uv.top);\n  setUV(11, 1, uv.top);\n\n  setUV(13, uv.left, 0);\n  setUV(14, uv.right, 0);\n\n  // Update vertex positions\n  const w2 = width / 2;\n  const h2 = height / 2;\n  const leftPadded = -w2 + 0.1;\n  const rightPadded = w2 - 0.1;\n  const topPadded = h2 - 0.1;\n  const bottomPadded = -h2 + 0.1;\n\n  setPos(0, -w2, h2);\n  setPos(1, leftPadded, h2);\n  setPos(2, rightPadded, h2);\n  setPos(3, w2, h2);\n\n  setPos(4, -w2, topPadded);\n  setPos(5, leftPadded, topPadded);\n  setPos(6, rightPadded, topPadded);\n  setPos(7, w2, topPadded);\n\n  setPos(8, -w2, bottomPadded);\n  setPos(9, leftPadded, bottomPadded);\n  setPos(10, rightPadded, bottomPadded);\n  setPos(11, w2, bottomPadded);\n\n  setPos(13, leftPadded, -h2);\n  setPos(14, rightPadded, -h2);\n  setPos(12, -w2, -h2);\n  setPos(15, w2, -h2);\n\n  geometry.attributes.position.needsUpdate = true;\n  geometry.attributes.uv.needsUpdate = true;\n}\n","import { addComponent, addEntity } from \"bitecs\";\nimport { GLTFModel } from \"../bit-components\";\nimport { loadModel } from \"../components/gltf-model-plus\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\n\nexport function inflateModel(world, eid, { src }) {\n  const obj = new THREE.Group();\n  addObject3DComponent(world, eid, obj);\n  loadModel(src, null, true).then(gltf => {\n    // TODO inflating components and create animation mixers\n    const modelEid = addEntity(world);\n    addObject3DComponent(world, modelEid, gltf.scene);\n    addComponent(world, GLTFModel, modelEid);\n    gltf.scene.userData.gltfSrc = src;\n    obj.add(gltf.scene);\n  });\n}\n","/** @jsx createElementEntity */\n\nimport cameraModelSrc from \"../assets/camera_tool.glb\";\nimport buttonSrc from \"../assets/hud/button.9.png\";\nimport { loadModel } from \"../components/gltf-model-plus\";\nimport { Layers } from \"../components/layers\";\nimport { COLLISION_LAYERS } from \"../constants\";\nimport { BUTTON_TYPES } from \"../systems/single-action-button-system\";\nimport { createElementEntity, createRef } from \"../utils/jsx-entity\";\nimport { textureLoader } from \"../utils/media-utils\";\n\nconst buttonTexture = textureLoader.load(buttonSrc);\n\n// eslint-disable-next-line react/prop-types\nfunction Button({ text, width, height, texture = buttonTexture, type = BUTTON_TYPES.DEFAULT, ...props }) {\n  const labelRef = createRef();\n  return (\n    <entity\n      name=\"Button\"\n      slice9={{ size: [width, height], insets: [64, 66, 64, 66], texture }}\n      cursor-raycastable\n      remote-hover-target\n      hover-button={{ type }}\n      text-button={{ labelRef }}\n      single-action-button\n      layers={1 << Layers.CAMERA_LAYER_UI}\n      {...props}\n    >\n      <entity\n        ref={labelRef}\n        layers={1 << Layers.CAMERA_LAYER_UI}\n        text={{ value: text, color: \"#000000\", textAlign: \"center\", anchorX: \"center\", anchorY: \"middle\" }}\n        position={[0, 0, 0.01]}\n      />\n    </entity>\n  );\n}\n\n// eslint-disable-next-line react/prop-types\nfunction Label({ text, ...props }, ...children) {\n  const value = children.join(\"\\n\");\n  return <entity name=\"Label\" text={{ value, ...text }} layers={1 << Layers.CAMERA_LAYER_UI} {...props} />;\n}\n\nconst RENDER_WIDTH = 1280;\nconst RENDER_HEIGHT = 720;\n\n// Pre load and upload camera model, and intentionally never \"release\" it from the cache.\n// TODO we should do this in a more explicit spot for \"preloading\" during the loading screen\nloadModel(cameraModelSrc, null, true);\n\nexport function CameraPrefab() {\n  const snapMenuRef = createRef();\n\n  const snapRef = createRef();\n  const cancelRef = createRef();\n  const recVideoRef = createRef();\n  const button_next = createRef();\n  const button_prev = createRef();\n  const sndToggleRef = createRef();\n\n  const countdownLblRef = createRef();\n  const captureDurLblRef = createRef();\n\n  const screenRef = createRef();\n  const selfieScreenRef = createRef();\n\n  const screenMaterial = new THREE.MeshBasicMaterial({ toneMapped: false });\n\n  const width = 0.28;\n  const aspect = 1280 / 720;\n  const screenGeometry = new THREE.PlaneBufferGeometry(width, width / aspect);\n\n  const cameraRef = createRef();\n  const camera = new THREE.PerspectiveCamera(50, RENDER_WIDTH / RENDER_HEIGHT, 0.1, 30000);\n\n  camera.layers.enable(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n  camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n\n  const buttonHeight = 0.2;\n  const buttonScale = [0.4, 0.4, 0.4];\n  const smallButtonScale = [0.2, 0.2, 0.2];\n\n  const uiZ = 0.1;\n\n  return (\n    <entity\n      name=\"Camera Tool\"\n      networked\n      networked-transform\n      cursor-raycastable\n      remote-hover-target\n      hand-collision-target\n      offers-remote-constraint\n      offers-hand-constraint\n      make-kinematic-on-release\n      holdable\n      rigidbody={{ collisionGroup: COLLISION_LAYERS.INTERACTABLES, collisionMask: COLLISION_LAYERS.HANDS }}\n      physics-shape={{ halfExtents: [0.22, 0.14, 0.1] }}\n      camera-tool={{\n        snapRef,\n        cancelRef,\n        button_next,\n        button_prev,\n        screenRef,\n        selfieScreenRef,\n        cameraRef,\n        countdownLblRef,\n        captureDurLblRef,\n        recVideoRef,\n        snapMenuRef,\n        sndToggleRef\n      }}\n    >\n      <entity\n        name=\"Screen\"\n        object3D={new THREE.Mesh(screenGeometry, screenMaterial)}\n        ref={screenRef}\n        position={[0, 0, -0.042]}\n        rotation={[0, Math.PI, 0]}\n      />\n      <entity\n        name=\"Selfie Screen\"\n        ref={selfieScreenRef}\n        object3D={new THREE.Mesh(screenGeometry, screenMaterial)}\n        position={[0, 0.4, 0]}\n        scale={[-2, 2, 2]}\n      />\n\n      <entity name=\"Camera Model\" model={{ src: cameraModelSrc }} scale={[2, 2, 2]} />\n\n      <entity ref={cameraRef} object3D={camera} position={[0, 0, 0.05]} rotation={[0, Math.PI, 0]} />\n\n      <entity name=\"Snap Menu\" ref={snapMenuRef}>\n        <Label ref={countdownLblRef} position={[0, 0, uiZ + 0.002]} />\n        <Label ref={captureDurLblRef} position={[0, 0, uiZ + 0.002]} />\n\n        <Button\n          ref={cancelRef}\n          scale={buttonScale}\n          position={[0, 0.1, uiZ]}\n          width={0.4}\n          height={buttonHeight}\n          text={\"Cancel\"}\n        />\n        <Button\n          ref={snapRef}\n          scale={buttonScale}\n          position={[0, 0.1, uiZ]}\n          width={0.4}\n          height={buttonHeight}\n          type={BUTTON_TYPES.ACTION}\n          text={\"Photo\"}\n        />\n\n        <Button\n          ref={button_prev}\n          scale={smallButtonScale}\n          position={[-0.082, 0, uiZ]}\n          width={buttonHeight}\n          height={buttonHeight}\n          text={\"<\"}\n        />\n        <Button\n          ref={recVideoRef}\n          scale={buttonScale}\n          position={[0, -0.1, uiZ]}\n          width={0.4}\n          height={buttonHeight}\n          type={BUTTON_TYPES.ACTION}\n          text={\"Video\"}\n        />\n        <Button\n          ref={button_next}\n          scale={smallButtonScale}\n          position={[0.082, 0, uiZ]}\n          width={buttonHeight}\n          height={buttonHeight}\n          text={\">\"}\n        />\n\n        <Button\n          ref={sndToggleRef}\n          scale={smallButtonScale}\n          position={[0, -0.17, uiZ]}\n          width={0.6}\n          height={buttonHeight}\n          text={\"Sound OFF\"}\n        />\n      </entity>\n    </entity>\n  );\n}\n\nexport function CubeMediaFramePrefab() {\n  return (\n    <entity\n      name=\"Media Frame\"\n      networked\n      networked-transform\n      cursor-raycastable\n      remote-hover-target\n      hand-collision-target\n      offers-remote-constraint\n      offers-hand-constraint\n      floaty-object\n      destroy-at-extreme-distance\n      holdable\n      rigidbody={{\n        gravity: -9.8,\n        collisionGroup: COLLISION_LAYERS.INTERACTABLES,\n        collisionMask:\n          COLLISION_LAYERS.HANDS |\n          COLLISION_LAYERS.ENVIRONMENT |\n          COLLISION_LAYERS.INTERACTABLES |\n          COLLISION_LAYERS.AVATAR\n      }}\n      physics-shape={{ halfExtents: [0.5, 0.5, 0.5] }}\n      object3D={new THREE.Mesh(new THREE.BoxBufferGeometry(), new THREE.MeshStandardMaterial())}\n    >\n      <entity media-frame position={[0, 1, 0]} />\n    </entity>\n  );\n}\n","import { addComponent, defineQuery, enterQuery, exitQuery, hasComponent, removeComponent, removeEntity } from \"bitecs\";\nimport { AEntity, Networked, NetworkedMediaFrame, NetworkedTransform, Owned } from \"../bit-components\";\nimport { CameraPrefab, CubeMediaFramePrefab } from \"../network-prefabs/camera-tool\";\nimport { defineNetworkSchema } from \"../utils/bit-utils\";\nimport { renderAsEntity } from \"../utils/jsx-entity\";\n\nconst prefabs = new Map(\n  Object.entries({\n    camera: {\n      permission: \"spawn_camera\",\n      template: CameraPrefab\n    },\n    cube: {\n      template: CubeMediaFramePrefab\n    }\n  })\n);\n\nexport function takeOwnership(world, eid) {\n  // TODO we do this to have a single API for taking ownership of things in new code, but it obviously relies on NAF/AFrame\n  if (hasComponent(world, AEntity, eid)) {\n    const el = world.eid2obj.get(eid).el;\n    !NAF.utils.isMine(el) && NAF.utils.takeOwnership(el);\n  } else {\n    addComponent(world, Owned, eid);\n    Networked.lastOwnerTime[eid] = Math.max(NAF.connection.getServerTime(), Networked.lastOwnerTime[eid] + 1);\n    Networked.owner[eid] = APP.getSid(NAF.clientId);\n  }\n}\n\nconst createMessageDatas = new Map();\n\nexport function createNetworkedEntityFromRemote(world, prefabName, initialData, rootNid, creator, owner) {\n  const eid = renderAsEntity(world, prefabs.get(prefabName).template(initialData));\n  const obj = world.eid2obj.get(eid);\n\n  createMessageDatas.set(eid, { prefabName, initialData });\n\n  let i = 0;\n  obj.traverse(function(o) {\n    if (o.eid && hasComponent(world, Networked, o.eid)) {\n      const eid = o.eid;\n      Networked.id[eid] = APP.getSid(i === 0 ? rootNid : `${rootNid}.${i}`);\n      APP.world.nid2eid.set(Networked.id[eid], eid);\n      Networked.creator[eid] = APP.getSid(creator);\n      Networked.owner[eid] = APP.getSid(owner);\n      if (NAF.clientId === creator) takeOwnership(world, eid);\n      i += 1;\n    }\n  });\n\n  AFRAME.scenes[0].object3D.add(obj);\n  return eid;\n}\n\nfunction spawnAllowed(creator, prefabName) {\n  const perm = prefabs.get(prefabName).permission;\n  return !perm || APP.hubChannel.userCan(creator, perm);\n}\n\nexport function createNetworkedEntity(world, prefabName, initialData) {\n  if (!spawnAllowed(NAF.clientId, prefabName)) throw new Error(`You do not have permission to spawn ${prefabName}`);\n  const rootNid = NAF.utils.createNetworkId();\n  return createNetworkedEntityFromRemote(world, prefabName, initialData, rootNid, NAF.clientId, NAF.clientId);\n}\n\nconst networkedObjectsQuery = defineQuery([Networked]);\nconst ownedNetworkObjectsQuery = defineQuery([Networked, Owned]);\n\nconst schemas = new Map([\n  [NetworkedMediaFrame, defineNetworkSchema(NetworkedMediaFrame)],\n  [NetworkedTransform, defineNetworkSchema(NetworkedTransform)]\n]);\nconst networkableComponents = Array.from(schemas.keys());\n\nconst pendingMessages = [];\nconst pendingJoins = [];\nconst pendingParts = [];\n\n// TODO messaging, joining, and leaving should not be using NAF\nNAF.connection.subscribeToDataChannel(\"nn\", function(fromClientId, _dataType, data) {\n  data.fromClientId = fromClientId;\n  pendingMessages.push(data);\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  document.body.addEventListener(\"clientConnected\", function({ detail: { clientId } }) {\n    console.log(\"client joined\", clientId);\n    pendingJoins.push(APP.getSid(clientId));\n  });\n  document.body.addEventListener(\"clientDisconnected\", function({ detail: { clientId } }) {\n    console.log(\"client left\", clientId);\n    pendingParts.push(APP.getSid(clientId));\n  });\n});\n\nfunction messageFor(world, created, updated, deleted, isFullSync) {\n  const message = {\n    creates: [],\n    updates: [],\n    deletes: []\n  };\n\n  created.forEach(eid => {\n    const { prefabName, initialData } = createMessageDatas.get(eid);\n    message.creates.push([APP.getString(Networked.id[eid]), prefabName, initialData]);\n  });\n\n  updated.forEach(eid => {\n    const updateMessage = {\n      nid: APP.getString(Networked.id[eid]),\n      lastOwnerTime: Networked.lastOwnerTime[eid],\n      owner: APP.getString(Networked.owner[eid]), // This should always be NAF.clientId. If it's not, something bad happened\n      creator: APP.getString(Networked.creator[eid]),\n      componentIds: [],\n      data: []\n    };\n\n    for (let j = 0; j < networkableComponents.length; j++) {\n      const Component = networkableComponents[j];\n      if (hasComponent(world, Component, eid)) {\n        if (schemas.get(Component).serialize(world, eid, updateMessage.data, isFullSync)) {\n          updateMessage.componentIds.push(j);\n        }\n      }\n    }\n\n    // TODO: If the owner/lastOwnerTime changed, we need to send this updateMessage\n    if (updateMessage.componentIds.length) {\n      message.updates.push(updateMessage);\n    }\n  });\n\n  deleted.forEach(eid => {\n    // TODO: We are reading component data of a deleted entity here.\n    const nid = Networked.id[eid];\n    message.deletes.push(APP.getString(nid));\n  });\n\n  if (message.creates.length || message.updates.length || message.deletes.length) {\n    return message;\n  }\n\n  return null;\n}\n\nfunction isNetworkInstantiated(eid) {\n  return createMessageDatas.has(eid);\n}\n\nfunction isNetworkInstantiatedByMe(eid) {\n  return isNetworkInstantiated(eid) && Networked.creator[eid] === APP.getSid(NAF.clientId);\n}\n\nconst pendingUpdatesForNid = new Map();\n\nconst rcvEnteredNetworkedObjectsQuery = enterQuery(defineQuery([Networked]));\nexport function networkReceiveSystem(world) {\n  // When a user leaves:\n  // - locally delete all the entities that user network instantiated\n  // - everyone attempts to take ownership of any objects that user owned\n  {\n    const networkedObjects = networkedObjectsQuery(world);\n    pendingParts.forEach(partingClientId => {\n      networkedObjects\n        .filter(eid => isNetworkInstantiated(eid) && Networked.creator[eid] === partingClientId)\n        .forEach(eid => removeEntity(world, eid));\n\n      // ignore entities the parting user created as they were just deleted\n      networkedObjects\n        .filter(eid => Networked.owner[eid] === partingClientId && Networked.creator[eid] !== partingClientId)\n        .forEach(eid => takeOwnership(world, eid));\n    });\n    pendingParts.length = 0;\n  }\n\n  // If we were hanging onto updates for any newly created non network instantiated entities\n  // we can now apply them. Network instantiated entities are handled when processing creates.\n  rcvEnteredNetworkedObjectsQuery(world).forEach(eid => {\n    const nid = Networked.id[eid];\n    if (pendingUpdatesForNid.has(nid)) {\n      console.log(\"had pending updates for\", APP.getString(nid), pendingUpdatesForNid.get(nid));\n      pendingMessages.unshift({ creates: [], updates: pendingUpdatesForNid.get(nid), deletes: [] });\n      pendingUpdatesForNid.delete(nid);\n    }\n  });\n\n  for (let i = 0; i < pendingMessages.length; i++) {\n    const message = pendingMessages[i];\n\n    for (let j = 0; j < message.creates.length; j++) {\n      const [nidString, prefabName, initialData] = message.creates[j];\n      const creator = message.fromClientId;\n\n      const nid = APP.getSid(nidString);\n\n      if (world.deletedNids.has(nid)) {\n        // TODO we may need to allow this for reconnects\n        console.log(`Received a create message for an object I've already deleted. Skipping ${nidString}`);\n      } else if (world.nid2eid.has(nid)) {\n        console.log(`Received create message for object I already created. Skipping ${nidString}`);\n      } else if (!spawnAllowed(creator, prefabName)) {\n        // this should only ever happen if there is a bug or the sender is maliciously modified\n        console.log(`Received create from a user who does not have permission to spawn ${prefabName}`);\n        world.ignoredNids.add(nid); // TODO should we just use deletedNids for this?\n      } else {\n        const eid = createNetworkedEntityFromRemote(world, prefabName, initialData, nidString, creator, creator);\n        console.log(\"got create message for\", nidString, eid);\n\n        // If we were hanging onto updates for this nid we can now apply them. And they should be processed before other updates.\n        if (pendingUpdatesForNid.has(nid)) {\n          console.log(\"had pending updates for\", nidString, pendingUpdatesForNid.get(nid));\n          Array.prototype.unshift.apply(message.updates, pendingUpdatesForNid.get(nid));\n          pendingUpdatesForNid.delete(nid);\n        }\n      }\n    }\n\n    for (let j = 0; j < message.updates.length; j++) {\n      const updateMessage = message.updates[j];\n      const nid = APP.getSid(updateMessage.nid);\n\n      if (world.ignoredNids.has(nid)) {\n        console.log(`Ignoring update for ignored entity ${updateMessage.nid}`);\n        continue;\n      }\n\n      if (world.deletedNids.has(nid)) {\n        console.log(`Ignoring update for deleted entity ${updateMessage.nid}`);\n        continue;\n      }\n\n      if (!world.nid2eid.has(nid)) {\n        console.log(`Holding onto an update for ${updateMessage.nid} because we don't have it yet.`);\n        // TODO: What if we will NEVER be able to apply this update?\n        // TODO would be nice if we could squash these updates\n        const updates = pendingUpdatesForNid.get(nid) || [];\n        updates.push(updateMessage);\n        pendingUpdatesForNid.set(nid, updates);\n        console.log(pendingUpdatesForNid);\n        continue;\n      }\n\n      const eid = world.nid2eid.get(nid);\n\n      if (\n        Networked.lastOwnerTime[eid] > updateMessage.lastOwnerTime ||\n        (Networked.lastOwnerTime[eid] === updateMessage.lastOwnerTime &&\n          APP.getString(Networked.owner[eid]) < updateMessage.owner) // arbitrary (but consistent) tiebreak\n      ) {\n        console.log(\n          \"Received update from an old owner, skipping\",\n          updateMessage.nid,\n          Networked.lastOwnerTime[eid],\n          updateMessage.lastOwnerTime\n        );\n        continue;\n      }\n\n      if (hasComponent(world, Owned, eid)) {\n        if (updateMessage.owner === NAF.clientId) {\n          // TODO: Should it be valid that we can receive a message where we are told we are the owner now?\n          console.error(\"Got a message telling us we are the owner.\");\n        } else {\n          console.log(\"Lost ownership: \", updateMessage.nid);\n          removeComponent(world, Owned, eid);\n        }\n      }\n\n      Networked.lastOwnerTime[eid] = updateMessage.lastOwnerTime;\n      Networked.creator[eid] = APP.getSid(updateMessage.creator);\n      Networked.owner[eid] = APP.getSid(updateMessage.owner);\n\n      // TODO HACK simulating a buffer with a cursor using an array\n      updateMessage.data.cursor = 0;\n      for (let s = 0; s < updateMessage.componentIds.length; s++) {\n        const componentId = updateMessage.componentIds[s];\n        const schema = schemas.get(networkableComponents[componentId]);\n        schema.deserialize(world, eid, updateMessage.data);\n      }\n      delete updateMessage.data.cursor;\n    }\n\n    for (let j = 0; j < message.deletes.length; j += 1) {\n      const nid = APP.getSid(message.deletes[j]);\n      if (world.deletedNids.has(nid)) continue;\n\n      world.deletedNids.add(nid);\n      const eid = world.nid2eid.get(nid);\n      createMessageDatas.delete(eid);\n      world.nid2eid.delete(nid);\n      removeEntity(world, eid);\n\n      console.log(\"OK, deleting \", APP.getString(nid));\n    }\n  }\n\n  pendingMessages.length = 0;\n\n  // TODO If there's a scene owned object, we should take ownership of it\n}\n\nconst TICK_RATE = 1000 / 12;\nlet nextNetworkTick = 0;\n\nconst sendEnteredNetworkedObjectsQuery = enterQuery(networkedObjectsQuery);\nconst sendExitedNetworkedObjectsQuery = exitQuery(networkedObjectsQuery);\n\nexport function networkSendSystem(world) {\n  if (performance.now() < nextNetworkTick) return;\n  nextNetworkTick = performance.now() + TICK_RATE;\n\n  // Tell joining users about objects I network instantiated, and full updates for objects I own\n  {\n    if (pendingJoins.length) {\n      const message = messageFor(\n        world,\n        networkedObjectsQuery(world).filter(isNetworkInstantiatedByMe),\n        ownedNetworkObjectsQuery(world),\n        [],\n        true\n      );\n      if (message) {\n        pendingJoins.forEach(clientId => NAF.connection.sendDataGuaranteed(APP.getString(clientId), \"nn\", message));\n      }\n      pendingJoins.length = 0;\n    }\n  }\n\n  // Tell everyone about objects I created, objects I own, and objects that were deleted\n  {\n    const created = sendEnteredNetworkedObjectsQuery(world).filter(isNetworkInstantiatedByMe);\n    // TODO: Lots of people will send delete messages about the same object\n    const deleted = sendExitedNetworkedObjectsQuery(world).filter(eid => {\n      return !world.deletedNids.has(Networked.id[eid]) && isNetworkInstantiated(eid);\n    });\n\n    const message = messageFor(world, created, ownedNetworkObjectsQuery(world), deleted, false);\n    if (message) NAF.connection.broadcastDataGuaranteed(\"nn\", message);\n\n    deleted.forEach(eid => {\n      createMessageDatas.delete(eid);\n      world.deletedNids.add(Networked.id[eid]);\n      world.nid2eid.delete(Networked.id[eid]);\n    });\n  }\n}\n\n// TODO: Handle reconnect\n// TODO: Handle blocking/unblocking. Does this already work?\n","import \"./utils/configs\";\nimport { getAbsoluteHref } from \"./utils/media-url-utils\";\nimport { isValidSceneUrl } from \"./utils/scene-url-utils\";\nimport { spawnChatMessage } from \"./react-components/chat-message\";\nimport { SOUND_CHAT_MESSAGE, SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"./systems/sound-effects-system\";\nimport ducky from \"./assets/models/DuckyMesh.glb\";\nimport { EventTarget } from \"event-target-shim\";\nimport { ExitReason } from \"./react-components/room/ExitedRoomScreen\";\nimport { LogMessageType } from \"./react-components/room/ChatSidebar\";\nimport { createNetworkedEntity } from \"./systems/netcode\";\n\nlet uiRoot;\n// Handles user-entered messages\nexport default class MessageDispatch extends EventTarget {\n  constructor(scene, entryManager, hubChannel, remountUI, mediaSearchStore) {\n    super();\n    this.scene = scene;\n    this.entryManager = entryManager;\n    this.hubChannel = hubChannel;\n    this.remountUI = remountUI;\n    this.mediaSearchStore = mediaSearchStore;\n    this.presenceLogEntries = [];\n  }\n\n  addToPresenceLog(entry) {\n    entry.key = Date.now().toString();\n\n    this.presenceLogEntries.push(entry);\n    this.remountUI({ presenceLogEntries: this.presenceLogEntries });\n    if (entry.type === \"chat\" && this.scene.is(\"loaded\")) {\n      this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CHAT_MESSAGE);\n    }\n\n    // Fade out and then remove\n    setTimeout(() => {\n      entry.expired = true;\n      this.remountUI({ presenceLogEntries: this.presenceLogEntries });\n\n      setTimeout(() => {\n        this.presenceLogEntries.splice(this.presenceLogEntries.indexOf(entry), 1);\n        this.remountUI({ presenceLogEntries: this.presenceLogEntries });\n      }, 5000);\n    }, 20000);\n  }\n\n  receive(message) {\n    this.addToPresenceLog(message);\n    this.dispatchEvent(new CustomEvent(\"message\", { detail: message }));\n  }\n\n  log = (messageType, props) => {\n    this.receive({ type: \"log\", messageType, props });\n  };\n\n  dispatch = message => {\n    if (message.startsWith(\"/\")) {\n      const commandParts = message.substring(1).split(/\\s+/);\n      this.dispatchCommand(commandParts[0], ...commandParts.slice(1));\n      document.activeElement.blur(); // Commands should blur\n    } else {\n      this.hubChannel.sendMessage(message);\n    }\n  };\n\n  dispatchCommand = async (command, ...args) => {\n    const entered = this.scene.is(\"entered\");\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n\n    // TODO: Some of the commands below should be available without requiring room entry.\n    if (!entered && (!isGhost || command === \"duck\")) {\n      this.log(LogMessageType.roomEntryRequired);\n      return;\n    }\n\n    const avatarRig = document.querySelector(\"#avatar-rig\");\n    const scales = [0.0625, 0.125, 0.25, 0.5, 1.0, 1.5, 3, 5, 7.5, 12.5];\n    const curScale = avatarRig.object3D.scale;\n    let err;\n    let physicsSystem;\n    const captureSystem = this.scene.systems[\"capture-system\"];\n\n    switch (command) {\n      case \"fly\":\n        if (this.scene.systems[\"hubs-systems\"].characterController.fly) {\n          this.scene.systems[\"hubs-systems\"].characterController.enableFly(false);\n          this.log(LogMessageType.flyModeDisabled);\n        } else {\n          if (this.scene.systems[\"hubs-systems\"].characterController.enableFly(true)) {\n            this.log(LogMessageType.flyModeEnabled);\n          }\n        }\n        break;\n      case \"grow\":\n        for (let i = 0; i < scales.length; i++) {\n          if (scales[i] > curScale.x) {\n            avatarRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            avatarRig.object3D.matrixNeedsUpdate = true;\n            break;\n          }\n        }\n\n        break;\n      case \"shrink\":\n        for (let i = scales.length - 1; i >= 0; i--) {\n          if (curScale.x > scales[i]) {\n            avatarRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            avatarRig.object3D.matrixNeedsUpdate = true;\n            break;\n          }\n        }\n\n        break;\n      case \"leave\":\n        this.entryManager.exitScene();\n        this.remountUI({ roomUnavailableReason: ExitReason.left });\n        break;\n      case \"duck\":\n        spawnChatMessage(getAbsoluteHref(location.href, ducky));\n        if (Math.random() < 0.01) {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n        } else {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n        }\n        break;\n      case \"cube\": {\n        const avatarPov = document.querySelector(\"#avatar-pov-node\").object3D;\n        const eid = createNetworkedEntity(APP.world, \"cube\");\n        const obj = APP.world.eid2obj.get(eid);\n        obj.position.copy(avatarPov.localToWorld(new THREE.Vector3(0, 0, -1.5)));\n        obj.lookAt(avatarPov.getWorldPosition(new THREE.Vector3()));\n        break;\n      }\n      case \"debug\":\n        physicsSystem = document.querySelector(\"a-scene\").systems[\"hubs-systems\"].physicsSystem;\n        physicsSystem.setDebug(!physicsSystem.debugEnabled);\n        break;\n      case \"vrstats\":\n        document.getElementById(\"stats\").components[\"stats-plus\"].toggleVRStats();\n        break;\n      case \"scene\":\n        if (args[0]) {\n          if (await isValidSceneUrl(args[0])) {\n            err = this.hubChannel.updateScene(args[0]);\n            if (err === \"unauthorized\") {\n              this.log(LogMessageType.unauthorizedSceneChange);\n            }\n          } else {\n            this.log(LogMessageType.inalidSceneUrl);\n          }\n        } else if (this.hubChannel.canOrWillIfCreator(\"update_hub\")) {\n          this.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\", \"use\");\n        }\n\n        break;\n      case \"rename\":\n        err = this.hubChannel.rename(args.join(\" \"));\n        if (err === \"unauthorized\") {\n          this.log(LogMessageType.unauthorizedRoomRename);\n        }\n        break;\n      case \"capture\":\n        if (!captureSystem.available()) {\n          this.log(LogMessageType.captureUnavailable);\n          break;\n        }\n        if (args[0] === \"stop\") {\n          if (captureSystem.started()) {\n            captureSystem.stop();\n            this.log(LogMessageType.captureStopped);\n          } else {\n            this.log(LogMessageType.captureAlreadyStopped);\n          }\n        } else {\n          if (captureSystem.started()) {\n            this.log(LogMessageType.captureAlreadyRunning);\n          } else {\n            captureSystem.start();\n            this.log(LogMessageType.captureStarted);\n          }\n        }\n        break;\n      case \"audioNormalization\":\n        {\n          if (args.length === 1) {\n            const factor = Number(args[0]);\n            if (!isNaN(factor)) {\n              const effectiveFactor = Math.max(0.0, Math.min(255.0, factor));\n              window.APP.store.update({\n                preferences: { audioNormalization: effectiveFactor }\n              });\n              if (factor) {\n                this.log(LogMessageType.setAudioNormalizationFactor, { factor: effectiveFactor });\n              } else {\n                this.log(LogMessageType.audioNormalizationDisabled);\n              }\n            } else {\n              this.log(LogMessageType.audioNormalizationNaN);\n            }\n          } else {\n            this.log(LogMessageType.invalidAudioNormalizationRange);\n          }\n        }\n        break;\n    }\n  };\n}\n","import qsTruthy from \"./utils/qs_truthy\";\nimport nextTick from \"./utils/next-tick\";\nimport { hackyMobileSafariTest } from \"./utils/detect-touchscreen\";\nimport { SignInMessages } from \"./react-components/auth/SignInModal\";\nimport { createNetworkedEntity } from \"./systems/netcode\";\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isMobile = AFRAME.utils.device.isMobile();\nconst forceEnableTouchscreen = hackyMobileSafariTest();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isDebug = qsTruthy(\"debug\");\nconst qs = new URLSearchParams(location.search);\n\nimport { addMedia } from \"./utils/media-utils\";\nimport {\n  isIn2DInterstitial,\n  handleExitTo2DInterstitial,\n  exit2DInterstitialAndEnterVR,\n  forceExitFrom2DInterstitial\n} from \"./utils/vr-interstitial\";\nimport { ObjectContentOrigins } from \"./object-types\";\nimport { getAvatarSrc, getAvatarType } from \"./utils/avatar-utils\";\nimport { SOUND_ENTER_SCENE } from \"./systems/sound-effects-system\";\nimport { MediaDevices, MediaDevicesEvents } from \"./utils/media-devices-utils\";\nimport { addComponent, removeEntity } from \"bitecs\";\nimport { MyCameraTool } from \"./bit-components\";\nimport { anyEntityWith } from \"./utils/bit-utils\";\n\nexport default class SceneEntryManager {\n  constructor(hubChannel, authChannel, history) {\n    this.hubChannel = hubChannel;\n    this.authChannel = authChannel;\n    this.store = window.APP.store;\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n    this.scene = document.querySelector(\"a-scene\");\n    this.rightCursorController = document.getElementById(\"right-cursor-controller\");\n    this.leftCursorController = document.getElementById(\"left-cursor-controller\");\n    this.avatarRig = document.getElementById(\"avatar-rig\");\n    this._entered = false;\n    this.performConditionalSignIn = () => {};\n    this.history = history;\n  }\n\n  init = () => {\n    this.whenSceneLoaded(() => {\n      console.log(\"Scene is loaded so setting up controllers\");\n      this.rightCursorController.components[\"cursor-controller\"].enabled = false;\n      this.leftCursorController.components[\"cursor-controller\"].enabled = false;\n      this.mediaDevicesManager = APP.mediaDevicesManager;\n      this._setupBlocking();\n    });\n  };\n\n  hasEntered = () => {\n    return this._entered;\n  };\n\n  enterScene = async (enterInVR, muteOnEntry) => {\n    console.log(\"Entering scene...\");\n    document.getElementById(\"viewing-camera\").removeAttribute(\"scene-preview-camera\");\n\n    if (isDebug && NAF.connection.adapter.session) {\n      NAF.connection.adapter.session.options.verbose = true;\n    }\n\n    if (enterInVR) {\n      // This specific scene state var is used to check if the user went through the\n      // entry flow and chose VR entry, and is used to preempt VR mode on refreshes.\n      this.scene.addState(\"vr-entered\");\n\n      // HACK - A-Frame calls getVRDisplays at module load, we want to do it here to\n      // force gamepads to become live.\n      \"getVRDisplays\" in navigator && navigator.getVRDisplays();\n\n      await exit2DInterstitialAndEnterVR(true);\n    }\n\n    const waypointSystem = this.scene.systems[\"hubs-systems\"].waypointSystem;\n    waypointSystem.moveToSpawnPoint();\n\n    if (isMobile || forceEnableTouchscreen || qsTruthy(\"force_enable_touchscreen\")) {\n      this.avatarRig.setAttribute(\"virtual-gamepad-controls\", {});\n    }\n\n    this._setupPlayerRig();\n    this._setupKicking();\n    this._setupMedia();\n    this._setupCamera();\n\n    if (qsTruthy(\"offline\")) return;\n\n    this._spawnAvatar();\n\n    this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_ENTER_SCENE);\n\n    if (isBotMode) {\n      this._runBot();\n      this.scene.addState(\"entered\");\n      this.hubChannel.sendEnteredEvent();\n      return;\n    }\n\n    this.scene.classList.remove(\"hand-cursor\");\n    this.scene.classList.add(\"no-cursor\");\n\n    this.rightCursorController.components[\"cursor-controller\"].enabled = true;\n    this.leftCursorController.components[\"cursor-controller\"].enabled = true;\n    this._entered = true;\n\n    // Delay sending entry event telemetry until VR display is presenting.\n    (async () => {\n      while (enterInVR && !this.scene.renderer.xr.isPresenting) {\n        await nextTick();\n      }\n\n      this.hubChannel.sendEnteredEvent().then(() => {\n        this.store.update({ activity: { lastEnteredAt: new Date().toISOString() } });\n      });\n    })();\n\n    // Bump stored entry count after 30s\n    setTimeout(() => this.store.bumpEntryCount(), 30000);\n\n    this.scene.addState(\"entered\");\n\n    APP.mediaDevicesManager.micEnabled = !muteOnEntry;\n  };\n\n  whenSceneLoaded = callback => {\n    if (this.scene.hasLoaded) {\n      console.log(\"Scene already loaded so callback invoked directly\");\n      callback();\n    } else {\n      console.log(\"Scene not yet loaded so callback is deferred\");\n      this.scene.addEventListener(\"loaded\", callback);\n    }\n  };\n\n  enterSceneWhenLoaded = (enterInVR, muteOnEntry) => {\n    this.whenSceneLoaded(() => this.enterScene(enterInVR, muteOnEntry));\n  };\n\n  exitScene = () => {\n    this.scene.exitVR();\n    if (APP.dialog && APP.dialog.localMediaStream) {\n      APP.dialog.localMediaStream.getTracks().forEach(t => t.stop());\n    }\n    if (this.hubChannel) {\n      this.hubChannel.disconnect();\n    }\n    if (this.scene.renderer) {\n      this.scene.renderer.setAnimationLoop(null); // Stop animation loop, TODO A-Frame should do this\n    }\n    this.scene.parentNode.removeChild(this.scene);\n  };\n\n  _setupPlayerRig = () => {\n    this._setPlayerInfoFromProfile();\n\n    // Explict user action changed avatar or updated existing avatar.\n    this.scene.addEventListener(\"avatar_updated\", () => this._setPlayerInfoFromProfile(true));\n\n    // Store updates can occur to avatar id in cases like error, auth reset, etc.\n    this.store.addEventListener(\"statechanged\", () => this._setPlayerInfoFromProfile());\n\n    const avatarScale = parseInt(qs.get(\"avatar_scale\"), 10);\n    if (avatarScale) {\n      this.avatarRig.setAttribute(\"scale\", { x: avatarScale, y: avatarScale, z: avatarScale });\n    }\n  };\n\n  _setPlayerInfoFromProfile = async (force = false) => {\n    const avatarId = this.store.state.profile.avatarId;\n    if (!force && this._lastFetchedAvatarId === avatarId) return; // Avoid continually refetching based upon state changing\n\n    this._lastFetchedAvatarId = avatarId;\n    const avatarSrc = await getAvatarSrc(avatarId);\n\n    this.avatarRig.setAttribute(\"player-info\", { avatarSrc, avatarType: getAvatarType(avatarId) });\n  };\n\n  _setupKicking = () => {\n    // This event is only received by the kicker\n    document.body.addEventListener(\"kicked\", ({ detail }) => {\n      const { clientId: kickedClientId } = detail;\n      const { entities } = NAF.connection.entities;\n      for (const id in entities) {\n        const entity = entities[id];\n        if (NAF.utils.getCreator(entity) !== kickedClientId) continue;\n\n        if (entity.components.networked.data.persistent) {\n          NAF.utils.takeOwnership(entity);\n          window.APP.pinningHelper.unpinElement(entity);\n          entity.parentNode.removeChild(entity);\n        } else {\n          NAF.entities.removeEntity(id);\n        }\n      }\n    });\n  };\n\n  _setupBlocking = () => {\n    document.body.addEventListener(\"blocked\", ev => {\n      NAF.connection.entities.removeEntitiesOfClient(ev.detail.clientId);\n    });\n\n    document.body.addEventListener(\"unblocked\", ev => {\n      NAF.connection.entities.completeSync(ev.detail.clientId, true);\n    });\n  };\n\n  _setupMedia = () => {\n    const offset = { x: 0, y: 0, z: -1.5 };\n    const spawnMediaInfrontOfPlayer = (src, contentOrigin) => {\n      if (!this.hubChannel.can(\"spawn_and_move_media\")) return;\n      const { entity, orientation } = addMedia(\n        src,\n        \"#interactable-media\",\n        contentOrigin,\n        null,\n        !(src instanceof MediaStream),\n        true\n      );\n      orientation.then(or => {\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#avatar-pov-node\",\n          offset,\n          orientation: or\n        });\n      });\n\n      return entity;\n    };\n\n    this.scene.addEventListener(\"add_media\", e => {\n      const contentOrigin = e.detail instanceof File ? ObjectContentOrigins.FILE : ObjectContentOrigins.URL;\n\n      spawnMediaInfrontOfPlayer(e.detail, contentOrigin);\n    });\n\n    this.scene.addEventListener(\"object_spawned\", e => {\n      this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType);\n    });\n\n    this.scene.addEventListener(\"action_spawn\", () => {\n      handleExitTo2DInterstitial(false, () => window.APP.mediaSearchStore.pushExitMediaBrowserHistory());\n      window.APP.mediaSearchStore.sourceNavigateToDefaultSource();\n    });\n\n    this.scene.addEventListener(\"action_kick_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"kick_users\"),\n        async () => await window.APP.hubChannel.kick(clientId),\n        SignInMessages.kickUser\n      );\n    });\n\n    this.scene.addEventListener(\"action_mute_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"mute_users\"),\n        () => window.APP.hubChannel.mute(clientId),\n        SignInMessages.muteUser\n      );\n    });\n\n    this.scene.addEventListener(\"action_vr_notice_closed\", () => forceExitFrom2DInterstitial());\n\n    document.addEventListener(\"paste\", e => {\n      if (\n        (e.target.matches(\"input, textarea\") || e.target.contentEditable === \"true\") &&\n        document.activeElement === e.target\n      )\n        return;\n\n      // Never paste into scene if dialog is open\n      const uiRoot = document.querySelector(\".ui-root\");\n      if (uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\")) return;\n\n      const url = e.clipboardData.getData(\"text\");\n      const files = e.clipboardData.files && e.clipboardData.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.CLIPBOARD);\n        }\n      }\n    });\n\n    document.addEventListener(\"dragover\", e => e.preventDefault());\n\n    let lastDebugScene;\n    document.addEventListener(\"drop\", e => {\n      e.preventDefault();\n\n      if (qsTruthy(\"debugLocalScene\")) {\n        URL.revokeObjectURL(lastDebugScene);\n        const url = URL.createObjectURL(e.dataTransfer.files[0]);\n        this.hubChannel.updateScene(url);\n        lastDebugScene = url;\n        return;\n      }\n\n      let url = e.dataTransfer.getData(\"url\");\n\n      if (!url) {\n        // Sometimes dataTransfer text contains a valid URL, so try for that.\n        try {\n          url = new URL(e.dataTransfer.getData(\"text\")).href;\n        } catch (e) {\n          // Nope, not this time.\n        }\n      }\n\n      const files = e.dataTransfer.files;\n\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.FILE);\n        }\n      }\n    });\n\n    let currentVideoShareEntity;\n    let isHandlingVideoShare = false;\n\n    const shareSuccess = (isDisplayMedia, isVideoTrackAdded, target) => {\n      isHandlingVideoShare = false;\n\n      if (isVideoTrackAdded) {\n        if (target === \"avatar\") {\n          this.avatarRig.setAttribute(\"player-info\", { isSharingAvatarCamera: true });\n        } else {\n          currentVideoShareEntity = spawnMediaInfrontOfPlayer(this.mediaDevicesManager.mediaStream, undefined);\n          // Wire up custom removal event which will stop the stream.\n          currentVideoShareEntity.setAttribute(\n            \"emit-scene-event-on-remove\",\n            `event:${MediaDevicesEvents.VIDEO_SHARE_ENDED}`\n          );\n        }\n\n        this.scene.emit(\"share_video_enabled\", { source: isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA });\n        this.scene.addState(\"sharing_video\");\n      }\n    };\n\n    const shareError = error => {\n      console.error(error);\n      isHandlingVideoShare = false;\n      this.scene.emit(\"share_video_failed\");\n    };\n\n    this.scene.addEventListener(\"action_share_camera\", event => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n      this.mediaDevicesManager.startVideoShare({\n        isDisplayMedia: false,\n        target: event.detail?.target,\n        success: shareSuccess,\n        error: shareError\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_screen\", () => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n      this.mediaDevicesManager.startVideoShare({\n        isDisplayMedia: true,\n        target: null,\n        success: shareSuccess,\n        error: shareError\n      });\n    });\n\n    this.scene.addEventListener(MediaDevicesEvents.VIDEO_SHARE_ENDED, async () => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      if (currentVideoShareEntity && currentVideoShareEntity.parentNode) {\n        NAF.utils.takeOwnership(currentVideoShareEntity);\n        currentVideoShareEntity.parentNode.removeChild(currentVideoShareEntity);\n      }\n\n      await this.mediaDevicesManager.stopVideoShare();\n      currentVideoShareEntity = null;\n\n      this.avatarRig.setAttribute(\"player-info\", { isSharingAvatarCamera: false });\n      this.scene.emit(\"share_video_disabled\");\n      this.scene.removeState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    });\n\n    this.scene.addEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, async () => {\n      await this.mediaDevicesManager.stopMicShare();\n    });\n\n    this.scene.addEventListener(\"action_selected_media_result_entry\", async e => {\n      // TODO spawn in space when no rights\n      const { entry, selectAction } = e.detail;\n      if (selectAction !== \"spawn\") return;\n\n      const delaySpawn = isIn2DInterstitial() && !isMobileVR;\n      await exit2DInterstitialAndEnterVR();\n\n      // If user has HMD lifted up or gone through interstitial, delay spawning for now. eventually show a modal\n      if (delaySpawn) {\n        setTimeout(() => {\n          spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\n        }, 3000);\n      } else {\n        spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\n      }\n    });\n\n    this.mediaSearchStore.addEventListener(\"media-exit\", () => {\n      exit2DInterstitialAndEnterVR();\n    });\n  };\n\n  _setupCamera = () => {\n    this.scene.addEventListener(\"action_toggle_camera\", () => {\n      const myCam = anyEntityWith(APP.world, MyCameraTool);\n      if (myCam) {\n        removeEntity(APP.world, myCam);\n        this.scene.removeState(\"camera\");\n      } else {\n        const avatarPov = document.querySelector(\"#avatar-pov-node\").object3D;\n        const eid = createNetworkedEntity(APP.world, \"camera\");\n        addComponent(APP.world, MyCameraTool, eid);\n\n        const obj = APP.world.eid2obj.get(eid);\n        obj.position.copy(avatarPov.localToWorld(new THREE.Vector3(0, 0, -1.5)));\n        obj.lookAt(avatarPov.getWorldPosition(new THREE.Vector3()));\n\n        this.scene.addState(\"camera\");\n      }\n    });\n  };\n\n  _spawnAvatar = () => {\n    this.avatarRig.setAttribute(\"networked\", \"template: #remote-avatar; attachTemplateToLocal: false;\");\n    this.avatarRig.setAttribute(\"networked-avatar\", \"\");\n    this.avatarRig.emit(\"entered\");\n  };\n\n  _runBot = async () => {\n    const audioEl = document.createElement(\"audio\");\n    let audioInput;\n    let dataInput;\n\n    // Wait for startup to render form\n    do {\n      audioInput = document.querySelector(\"#bot-audio-input\");\n      dataInput = document.querySelector(\"#bot-data-input\");\n      await nextTick();\n    } while (!audioInput || !dataInput);\n\n    const getAudio = () => {\n      audioEl.loop = true;\n      audioEl.muted = false;\n      audioEl.crossorigin = \"anonymous\";\n      audioEl.src = URL.createObjectURL(audioInput.files[0]);\n      document.body.appendChild(audioEl);\n    };\n\n    if (audioInput.files && audioInput.files.length > 0) {\n      getAudio();\n    } else {\n      audioInput.onchange = getAudio;\n    }\n\n    const camera = document.querySelector(\"#avatar-pov-node\");\n    const leftController = document.querySelector(\"#player-left-controller\");\n    const rightController = document.querySelector(\"#player-right-controller\");\n    const getRecording = () => {\n      fetch(URL.createObjectURL(dataInput.files[0]))\n        .then(resp => resp.json())\n        .then(recording => {\n          camera.setAttribute(\"replay\", \"\");\n          camera.components[\"replay\"].poses = recording.camera.poses;\n\n          leftController.setAttribute(\"replay\", \"\");\n          leftController.components[\"replay\"].poses = recording.left.poses;\n          leftController.removeAttribute(\"visibility-by-path\");\n          leftController.removeAttribute(\"track-pose\");\n          leftController.setAttribute(\"visible\", true);\n\n          rightController.setAttribute(\"replay\", \"\");\n          rightController.components[\"replay\"].poses = recording.right.poses;\n          rightController.removeAttribute(\"visibility-by-path\");\n          rightController.removeAttribute(\"track-pose\");\n          rightController.setAttribute(\"visible\", true);\n        });\n    };\n\n    if (dataInput.files && dataInput.files.length > 0) {\n      getRecording();\n    } else {\n      dataInput.onchange = getRecording;\n    }\n\n    await new Promise(resolve => audioEl.addEventListener(\"canplay\", resolve));\n\n    const audioStream = audioEl.captureStream\n      ? audioEl.captureStream()\n      : audioEl.mozCaptureStream\n        ? audioEl.mozCaptureStream()\n        : null;\n\n    if (audioStream) {\n      let audioVolume = Number(qs.get(\"audio_volume\") || \"1.0\");\n      if (isNaN(audioVolume)) {\n        audioVolume = 1.0;\n      }\n      const audioContext = THREE.AudioContext.getContext();\n      const audioSource = audioContext.createMediaStreamSource(audioStream);\n      const audioDestination = audioContext.createMediaStreamDestination();\n      const gainNode = audioContext.createGain();\n      audioSource.connect(gainNode);\n      gainNode.connect(audioDestination);\n      gainNode.gain.value = audioVolume;\n      this.mediaDevicesManager.mediaStream.addTrack(audioDestination.stream.getAudioTracks()[0]);\n    }\n\n    const connect = async () => {\n      await APP.dialog.setLocalMediaStream(this.mediaDevicesManager.mediaStream);\n      audioEl.play();\n    };\n    if (APP.dialog._sendTransport) {\n      connect();\n    } else {\n      this.scene.addEventListener(\"didConnectToDialog\", connect);\n    }\n  };\n}\n","import nextTick from \"./utils/next-tick.js\";\nconst INIT_TIMEOUT_MS = 5000;\n\n// Manages web push subscriptions\n//\nfunction urlBase64ToUint8Array(base64String) {\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, \"+\").replace(/_/g, \"/\");\n\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n}\n\nexport default class Subscriptions {\n  constructor(hubId) {\n    this.hubId = hubId;\n  }\n\n  register() {\n    if (navigator.serviceWorker) {\n      try {\n        navigator.serviceWorker\n          .register(\"/hub.service.js\")\n          .then(() => {\n            navigator.serviceWorker.ready\n              .then(registration => this.setRegistration(registration))\n              .catch(e => this.setRegistrationFailed(e));\n          })\n          .catch(e => this.setRegistrationFailed(e));\n      } catch (e) {\n        this.setRegistrationFailed(e);\n      }\n    } else {\n      this.setRegistrationFailed(\"Not supported\");\n    }\n  }\n\n  setHubChannel = hubChannel => {\n    this.hubChannel = hubChannel;\n  };\n\n  setRegistration = registration => {\n    console.log(\"Service worker registered\");\n    this.registration = registration;\n  };\n\n  setRegistrationFailed = e => {\n    console.error(\"Service worker registration failed\", e);\n    this.registration = null;\n  };\n\n  setVapidPublicKey = vapidPublicKey => {\n    this.vapidPublicKey = vapidPublicKey;\n  };\n\n  setSubscribed = isSubscribed => {\n    this._isSubscribed = isSubscribed;\n  };\n\n  isSubscribed = () => {\n    return this._isSubscribed;\n  };\n\n  getCurrentEndpoint = async () => {\n    if (!navigator.serviceWorker) return null;\n    const startedAt = performance.now();\n\n    // registration becomes null if failed, non null if registered\n    while (this.registration === undefined && performance.now() - startedAt < INIT_TIMEOUT_MS) await nextTick();\n    if (performance.now() - startedAt >= INIT_TIMEOUT_MS) console.warn(\"Service worker registration timed out.\");\n    if (!this.registration || !this.registration.pushManager) return null;\n\n    while (this.vapidPublicKey === undefined) await nextTick();\n    if (this.vapidPublicKey === null) return null;\n\n    try {\n      const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n      if (\n        (await this.registration.pushManager.permissionState({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        })) !== \"granted\"\n      )\n        return null;\n    } catch (e) {\n      return null; // Chrome can throw here complaining about userVisible if push is not right\n    }\n    const sub = await this.registration.pushManager.getSubscription();\n    if (!sub) return null;\n\n    return sub.endpoint;\n  };\n\n  toggle = async () => {\n    if (!this.registration) return;\n\n    if (this._isSubscribed) {\n      const pushSubscription = await this.registration.pushManager.getSubscription();\n      const res = await this.hubChannel.unsubscribe(pushSubscription);\n\n      if (res && res.has_remaining_subscriptions === false) {\n        pushSubscription.unsubscribe();\n      }\n    } else {\n      let pushSubscription = await this.registration.pushManager.getSubscription();\n\n      if (!pushSubscription) {\n        const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n        pushSubscription = await this.registration.pushManager.subscribe({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        });\n      }\n\n      this.hubChannel.subscribe(pushSubscription);\n    }\n\n    this._isSubscribed = !this._isSubscribed;\n  };\n}\n","const { Pathfinding } = require(\"three-pathfinding\");\nimport qsTruthy from \"../utils/qs_truthy\";\n\nAFRAME.registerSystem(\"nav\", {\n  init: function() {\n    this.pathfinder = new Pathfinding();\n    this.mesh = null;\n    this.el.addEventListener(\"reset_scene\", this.removeNavMeshData.bind(this));\n    this.el.addEventListener(\"leaving_loading_environment\", this.removeNavMeshData.bind(this));\n  },\n\n  loadMesh: function(mesh, zone) {\n    if (this.mesh) {\n      console.error(\"tried to load multiple nav meshes\");\n      this.removeNavMeshData();\n    }\n    const geometry = mesh.geometry.clone();\n    mesh.updateMatrices();\n    geometry.applyMatrix4(mesh.matrixWorld);\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\n    this.mesh = mesh;\n\n    const teleporters = document.querySelectorAll(\"[teleporter]\");\n    for (let i = 0; i < teleporters.length; i++) {\n      teleporters[i].components[\"teleporter\"].queryCollisionEntities();\n    }\n\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\n\n    if (qsTruthy(\"debugNavmesh\")) {\n      this.helperMesh = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({ wireframe: true }));\n      this.el.sceneEl.object3D.add(this.helperMesh);\n    }\n  },\n\n  removeNavMeshData() {\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\n      // If it's using the debug view material, restore the original material so it can be disposed.\n      if (this.mesh._hubs_audio_debug_prev_material) {\n        this.mesh.material = this.mesh._hubs_audio_debug_prev_material;\n        this.mesh._hubs_audio_debug_prev_material = null;\n      }\n    }\n    if (this.helperMesh) {\n      this.helperMesh.material?.dispose();\n      this.helperMesh.geometry?.dispose();\n      this.helperMesh.removeFromParent();\n      this.helperMesh = null;\n    }\n    this.mesh = null;\n    this.pathfinder.zones = {};\n  }\n});\n","export default function traverseFilteredSubtrees(object, cb) {\n  if (cb(object) === false) {\n    return;\n  }\n\n  const children = object.children;\n\n  for (let i = 0; i < children.length; i++) {\n    traverseFilteredSubtrees(children[i], cb);\n  }\n}\n","import { hasComponent } from \"bitecs\";\nimport { IgnoreSpaceBubble } from \"../bit-components\";\nimport { forEachMaterial } from \"../utils/material-utils\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport traverseFilteredSubtrees from \"../utils/traverseFilteredSubtrees\";\n\nconst invaderPos = new THREE.Vector3();\nconst bubblePos = new THREE.Vector3();\nconst isDebug = qsTruthy(\"debug\");\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\n/**\n * Updates invaders every tick, doing one per frame on mobile VR.\n * testing multiline things\n * @namespace avatar/personal-space-bubble\n * @system personal-space-bubble\n */\nAFRAME.registerSystem(\"personal-space-bubble\", {\n  schema: {\n    debug: { default: false },\n    enabled: { default: true }\n  },\n\n  init() {\n    this.invaders = [];\n    this.bubbles = [];\n    this.tickCount = 0;\n    this._updateInvaders = this._updateInvaders.bind(this);\n  },\n\n  registerBubble(bubble) {\n    this.bubbles.push(bubble);\n  },\n\n  unregisterBubble(bubble) {\n    const index = this.bubbles.indexOf(bubble);\n\n    if (index !== -1) {\n      this.bubbles.splice(index, 1);\n    }\n  },\n\n  registerInvader(invader) {\n    NAF.utils.getNetworkedEntity(invader.el).then(networkedEl => {\n      const owner = NAF.utils.getNetworkOwner(networkedEl);\n\n      if (owner !== NAF.clientId) {\n        this.invaders.push(invader);\n      }\n    });\n  },\n\n  unregisterInvader(invader) {\n    const index = this.invaders.indexOf(invader);\n\n    if (index !== -1) {\n      this.invaders.splice(index, 1);\n    }\n  },\n\n  update() {\n    for (let i = 0; i < this.bubbles.length; i++) {\n      this.bubbles[i].updateDebug();\n    }\n\n    for (let i = 0; i < this.invaders.length; i++) {\n      this.invaders[i].updateDebug();\n      if (!this.data.enabled) {\n        this.invaders[i].setInvading(false);\n      }\n    }\n\n    if (this.data.enabled) {\n      this.el.addState(\"spacebubble\");\n    } else {\n      this.el.removeState(\"spacebubble\");\n    }\n  },\n\n  tick() {\n    this._updateInvaders();\n    this.tickCount++;\n  },\n\n  _updateInvaders: (function () {\n    const tempInvasionFlags = [];\n\n    const setInvaderFlag = (i, invaders, bubble) => {\n      // Hide the invader if inside the bubble\n      const invader = invaders[i];\n      invaderPos.setFromMatrixPosition(invader.el.object3D.matrixWorld);\n\n      const distanceSquared = bubblePos.distanceToSquared(invaderPos);\n      const radiusSum = bubble.data.radius + invader.data.radius;\n\n      if (distanceSquared < radiusSum * radiusSum) {\n        tempInvasionFlags[i] = true;\n      }\n    };\n\n    const flushInvadingFlagsForIndex = (i, invaders) => {\n      if (invaders[i].invading !== tempInvasionFlags[i]) {\n        invaders[i].setInvading(tempInvasionFlags[i]);\n      }\n    };\n\n    return function () {\n      if (!this.data.enabled) return;\n      if (this.invaders.length === 0) return;\n\n      tempInvasionFlags.length = 0;\n\n      // precondition for this stuff -- the bubbles and invaders need updated world matrices.\n      // right now this is satisfied because we update the world matrices in the character controller\n      for (let i = 0; i < this.invaders.length; i++) {\n        this.invaders[i].el.object3D.updateMatrices(); // We read matrixWorld below, update matrices here\n        tempInvasionFlags[i] = false;\n      }\n\n      // Loop through all of the space bubbles (usually one)\n      for (let i = 0; i < this.bubbles.length; i++) {\n        const bubble = this.bubbles[i];\n\n        bubble.el.object3D.updateMatrices();\n        bubblePos.setFromMatrixPosition(bubble.el.object3D.matrixWorld);\n\n        if (!isMobileVR) {\n          for (let j = 0; j < this.invaders.length; j++) {\n            setInvaderFlag(j, this.invaders, bubble);\n          }\n        } else {\n          // Optimization: update one invader per frame on mobile VR\n          setInvaderFlag(this.tickCount % this.invaders.length, this.invaders, bubble);\n        }\n      }\n\n      if (!isMobileVR) {\n        for (let i = 0; i < this.invaders.length; i++) {\n          flushInvadingFlagsForIndex(i, this.invaders);\n        }\n      } else {\n        flushInvadingFlagsForIndex(this.tickCount % this.invaders.length, this.invaders);\n      }\n    };\n  })()\n});\n\nfunction createSphereGizmo(radius) {\n  const geometry = new THREE.SphereBufferGeometry(radius, 10, 10);\n  const wireframe = new THREE.WireframeGeometry(geometry);\n  const line = new THREE.LineSegments(wireframe);\n  line.material.opacity = 0.5;\n  line.material.transparent = true;\n  return line;\n}\n\nfunction getGLTFModelRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"gltf-model-plus\"])) {\n    entity = entity.parentNode;\n  }\n\n  return entity;\n}\n\nconst DEBUG_OBJ = \"psb-debug\";\n\n/**\n * Represents an entity that can invade a personal space bubble\n * @namespace avatar/personal-space-bubble\n * @component personal-space-invader\n */\nAFRAME.registerComponent(\"personal-space-invader\", {\n  schema: {\n    radius: { type: \"number\", default: 0.1 },\n    useMaterial: { default: false },\n    debug: { default: false },\n    invadingOpacity: { default: 0.3 }\n  },\n\n  init() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    system.registerInvader(this);\n\n    if (this.data.useMaterial) {\n      this.gltfRootEl = getGLTFModelRoot(this.el);\n    }\n\n    this.invading = false;\n    this.alwaysHidden = false;\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  // Allow external callers to tell this invader to always hide this element, regardless of invasion state\n  setAlwaysHidden(alwaysHidden) {\n    this.alwaysHidden = alwaysHidden;\n    this.applyInvasionToMesh(this.invading);\n  },\n\n  updateDebug() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    if (system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"personal-space-bubble\"].unregisterInvader(this);\n  },\n\n  setInvading(invading) {\n    if (this.invading === invading) return;\n\n    this.applyInvasionToMesh(invading);\n    this.invading = invading;\n  },\n\n  disable() {\n    if (this.invading) {\n      this.applyInvasionToMesh(false);\n    }\n\n    this.disabled = true;\n  },\n\n  enable() {\n    this.disabled = false;\n    this.applyInvasionToMesh(this.invading);\n  },\n\n  applyInvasionToMesh(invading) {\n    if (this.disabled) return;\n\n    // Note: Model isn't loaded on init because this object is inflated before the root is.\n    // object3DMap.mesh is not initially set and must be checked before traversing.\n    if (this.gltfRootEl && this.gltfRootEl.object3DMap.mesh && !this.alwaysHidden) {\n      traverseFilteredSubtrees(this.gltfRootEl.object3DMap.mesh, obj => {\n        // Prevents changing the opacity of ui elements\n        if (obj.el && hasComponent(APP.world, IgnoreSpaceBubble, obj.el.eid)) {\n          // Skip all objects under this branch by returning false\n          return false;\n        }\n\n        if (!obj.material) {\n          return;\n        }\n\n        forEachMaterial(obj, material => {\n          let originalProps = material.userData.originalProps;\n\n          if (!material.userData.originalProps) {\n            originalProps = material.userData.originalProps = {\n              opacity: material.opacity,\n              transparent: material.transparent,\n              format: material.format,\n              blending: material.blending,\n              side: material.side\n            };\n          }\n\n          // Note: Sharing materials will cause all objects with the material to turn transparent / opaque\n          // This is generally fine for avatars since a material will only be shared within a glTF model,\n          // not across avatars in the room.\n          material.opacity = invading ? this.data.invadingOpacity : originalProps.opacity;\n          material.transparent = invading || originalProps.transparent;\n\n          // Note: Since ThreeJS 0.132 the default format for GLTF imported opaque materials is RGBFormat\n          // so we need to switch before enabling transparency.\n          material.format = invading ? THREE.RGBAFormat : originalProps.format;\n          material.blending = invading ? THREE.NormalBlending : originalProps.blending;\n          // This shouldn't be necessary but for some reason transparency doens't work on some models if they are single sided.\n          material.side = invading ? THREE.DoubleSide : originalProps.side;\n        });\n      });\n    } else {\n      this.el.object3D.visible = !invading && !this.alwaysHidden;\n    }\n  }\n});\n\n/**\n * Represents a personal space bubble on an entity.\n * @namespace avatar/personal-space-bubble\n * @component personal-space-bubble\n */\nAFRAME.registerComponent(\"personal-space-bubble\", {\n  schema: {\n    radius: { type: \"number\", default: 0.8 },\n    debug: { default: false }\n  },\n  init() {\n    this.system.registerBubble(this);\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    if (!isDebug) return;\n\n    if (this.system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.system.unregisterBubble(this);\n  }\n});\n","import { paths } from \"./userinput/paths\";\nconst qs = new URLSearchParams(location.search);\nconst IDLE_TIMEOUT_MS = (parseInt(qs.get(\"idle_timeout\"), 10) || 2 * 60 * 60) * 1000;\nconst INPUT_CHECK_INTERVAL_MS = 1000;\n\nconst CHARACTER_ACCELERATION_PATH = paths.actions.characterAcceleration;\nconst BASIC_ACTIVITY_PATHS = [\n  paths.actions.startGazeTeleport,\n  paths.actions.rightHand.startTeleport,\n  paths.actions.leftHand.startTeleport,\n  paths.actions.snapRotateRight,\n  paths.actions.snapRotateLeft,\n  paths.actions.cursor.right.grab,\n  paths.actions.cursor.left.grab,\n  paths.actions.rightHand.grab,\n  paths.actions.leftHand.grab,\n  paths.actions.angularVelocity\n];\n\nAFRAME.registerSystem(\"idle-detector\", {\n  init() {\n    this.resetTimeout = this.resetTimeout.bind(this);\n    this.idleTimeout = null;\n    this.lastInputCheck = 0;\n\n    const events = [\"click\", \"pointerdown\", \"touchstart\", \"keyup\"];\n\n    for (const event of events) {\n      window.addEventListener(event, this.resetTimeout);\n    }\n\n    this.resetTimeout();\n  },\n  resetTimeout() {\n    if (this.idleTimeout) clearTimeout(this.idleTimeout);\n    this.idleTimeout = setTimeout(this.onIdleTimeout, IDLE_TIMEOUT_MS);\n    window.dispatchEvent(new CustomEvent(\"activity_detected\"));\n  },\n  onIdleTimeout() {\n    window.dispatchEvent(new CustomEvent(\"idle_detected\"));\n  },\n  tick(time) {\n    if (time - this.lastInputCheck < INPUT_CHECK_INTERVAL_MS) return;\n\n    const userinput = this.el.systems.userinput;\n\n    let basicActivity = false;\n    for (const activityPath of BASIC_ACTIVITY_PATHS) {\n      basicActivity = basicActivity || !!userinput.get(activityPath);\n    }\n\n    const characterAcceleration = userinput.get(CHARACTER_ACCELERATION_PATH);\n\n    const active =\n      basicActivity ||\n      !!(characterAcceleration && characterAcceleration[0]) ||\n      !!(characterAcceleration && characterAcceleration[1]);\n\n    if (active) {\n      this.resetTimeout();\n    }\n  },\n  remove() {}\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\n// Used for tracking and managing pen tools in the scene\nAFRAME.registerSystem(\"pen-tools\", {\n  init() {\n    this.penEls = [];\n    this.updateMyPen = this.updateMyPen.bind(this);\n\n    waitForDOMContentLoaded().then(() => {\n      this.updateMyPen();\n    });\n  },\n\n  register(el) {\n    this.penEls.push(el);\n    el.addEventListener(\"ownership-changed\", this.updateMyPen);\n    this.updateMyPen();\n  },\n\n  deregister(el) {\n    this.penEls.splice(this.penEls.indexOf(el), 1);\n    el.removeEventListener(\"ownership-changed\", this.updateMyPen);\n    this.updateMyPen();\n  },\n\n  getMyPen() {\n    return this.myPen;\n  },\n\n  updateMyPen() {\n    this.myPen = this.penEls.find(NAF.utils.isMine);\n\n    if (this.myPen) {\n      this.sceneEl.addState(\"pen\");\n    } else {\n      this.sceneEl.removeState(\"pen\");\n    }\n  }\n});\n","export const sets = {};\nsets.global = \"global\";\nsets.inputFocused = \"inputFocused\";\nsets.rightCursorHoveringOnPen = \"rightCursorHoveringOnPen\";\nsets.rightCursorHoveringOnCamera = \"rightCursorHoveringOnCamera\";\nsets.rightCursorHoveringOnInteractable = \"rightCursorHoveringOnInteractable\";\nsets.rightCursorHoveringOnUI = \"rightCursorHoveringOnUI\";\nsets.rightCursorHoveringOnVideo = \"rightCursorHoveringOnVideo\";\nsets.rightCursorHoveringOnNothing = \"rightCursorHoveringOnNothing\";\nsets.rightCursorHoldingPen = \"rightCursorHoldingPen\";\nsets.rightCursorHoldingCamera = \"rightCursorHoldingCamera\";\nsets.rightCursorHoldingInteractable = \"rightCursorHoldingInteractable\";\nsets.rightCursorHoldingUI = \"rightCursorHoldingUI\";\nsets.rightCursorHoldingNothing = \"rightCursorHoldingNothing\";\nsets.leftCursorHoveringOnPen = \"leftCursorHoveringOnPen\";\nsets.leftCursorHoveringOnCamera = \"leftCursorHoveringOnCamera\";\nsets.leftCursorHoveringOnInteractable = \"leftCursorHoveringOnInteractable\";\nsets.leftCursorHoveringOnUI = \"leftCursorHoveringOnUI\";\nsets.leftCursorHoveringOnVideo = \"leftCursorHoveringOnVideo\";\nsets.leftCursorHoveringOnNothing = \"leftCursorHoveringOnNothing\";\nsets.leftCursorHoldingPen = \"leftCursorHoldingPen\";\nsets.leftCursorHoldingCamera = \"leftCursorHoldingCamera\";\nsets.leftCursorHoldingInteractable = \"leftCursorHoldingInteractable\";\nsets.leftCursorHoldingUI = \"leftCursorHoldingUI\";\nsets.leftCursorHoldingNothing = \"leftCursorHoldingNothing\";\nsets.rightHandTeleporting = \"rightHandTeleporting\";\nsets.rightHandHoveringOnPen = \"rightHandHoveringOnPen\";\nsets.rightHandHoveringOnCamera = \"rightHandHoveringOnCamera\";\nsets.rightHandHoveringOnInteractable = \"rightHandHoveringOnInteractable\";\nsets.rightHandHoveringOnNothing = \"rightHandHoveringOnNothing\";\nsets.rightHandHoldingPen = \"rightHandHoldingPen\";\nsets.rightHandHoldingCamera = \"rightHandHoldingCamera\";\nsets.rightHandHoldingInteractable = \"rightHandHoldingInteractable\";\nsets.leftHandTeleporting = \"leftHandTeleporting\";\nsets.leftHandHoveringOnPen = \"leftHandHoveringOnPen\";\nsets.leftHandHoveringOnCamera = \"leftHandHoveringOnCamera\";\nsets.leftHandHoveringOnInteractable = \"leftHandHoveringOnInteractable\";\nsets.leftHandHoldingPen = \"leftHandHoldingPen\";\nsets.leftHandHoldingCamera = \"leftHandHoldingCamera\";\nsets.leftHandHoldingInteractable = \"leftHandHoldingInteractable\";\nsets.leftHandHoveringOnNothing = \"leftHandHoveringOnNothing\";\nsets.debugUserInput = \"debugUserInput\";\nsets.inspecting = \"inspecting\";\n","import { paths } from \"../paths\";\n\n// TODO: Where do these values (500, 10, 2) come from?\nconst modeMod = {\n  [WheelEvent.DOM_DELTA_PIXEL]: 500,\n  [WheelEvent.DOM_DELTA_LINE]: 10,\n  [WheelEvent.DOM_DELTA_PAGE]: 2\n};\n\nconst isInModal = (function() {\n  let uiRoot;\n  return function isInModal() {\n    // TODO: Tech debt. Find better way to handle this state that is available in react.\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    return (\n      (uiRoot && uiRoot.children[0] && uiRoot.children[0].classList.contains(\"in-modal-or-overlay\")) ||\n      window.APP.preferenceScreenIsVisible\n    );\n  };\n})();\n\nexport class MouseDevice {\n  constructor() {\n    this.events = [];\n    this.coords = [0, 0]; // normalized screenspace coordinates in [(-1, 1), (-1, 1)]\n    this.movementXY = [0, 0]; // deltas\n    this.buttonLeft = false;\n    this.buttonRight = false;\n    this.buttonMiddle = false;\n    this.wheel = 0; // delta\n\n    const queueEvent = this.events.push.bind(this.events);\n    this.canvas = document.querySelector(\"canvas\");\n    this.canvas.addEventListener(\"contextmenu\", e => {\n      if (e.button === 2) {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      }\n    });\n    [\"mousedown\", \"wheel\"].map(x => this.canvas.addEventListener(x, queueEvent, { passive: false }));\n    [\"mousemove\", \"mouseup\"].map(x => window.addEventListener(x, queueEvent, { passive: false }));\n\n    document.addEventListener(\n      \"wheel\",\n      e => {\n        // Only capture wheel events when the canvas is focused\n        if (document.activeElement.classList.contains(\"a-canvas\")) {\n          e.preventDefault();\n        }\n      },\n      { passive: false }\n    );\n  }\n\n  process(event) {\n    if (event.type === \"wheel\") {\n      this.wheel += (event.deltaX + event.deltaY) / modeMod[event.deltaMode];\n      return true;\n    }\n\n    const left = event.button === 0;\n    const middle = event.button === 1;\n    const right = event.button === 2;\n    // Note: This assumes the canvas always starts in the top left.\n    // This works with the current sidebar and toolbar layout.\n    this.coords[0] = (event.clientX / this.canvas.clientWidth) * 2 - 1;\n    this.coords[1] = -(event.clientY / this.canvas.clientHeight) * 2 + 1;\n    this.movementXY[0] += event.movementX;\n    this.movementXY[1] += event.movementY;\n    if (event.type === \"mousedown\" && left) {\n      this.mouseDownLeftThisFrame = true;\n      this.buttonLeft = true;\n    } else if (event.type === \"mousedown\" && right) {\n      this.mouseDownRightThisFrame = true;\n      this.buttonRight = true;\n    } else if (event.type === \"mousedown\" && middle) {\n      this.mouseDownMiddleThisFrame = true;\n      this.buttonMiddle = true;\n    } else if (event.type === \"mouseup\" && left) {\n      if (this.mouseDownLeftThisFrame) {\n        return false;\n      }\n      this.buttonLeft = false;\n    } else if (event.type === \"mouseup\" && right) {\n      if (this.mouseDownRightThisFrame) {\n        return false;\n      }\n      this.buttonRight = false;\n    } else if (event.type === \"mouseup\" && middle) {\n      if (this.mouseDownMiddleThisFrame) {\n        return false;\n      }\n      this.buttonMiddle = false;\n    }\n    return true;\n  }\n\n  write(frame) {\n    this.movementXY[0] = 0; // deltas\n    this.movementXY[1] = 0; // deltas\n    this.wheel = 0; // delta\n\n    this.didStopProcessingEarly = false;\n    this.mouseDownLeftThisFrame = false;\n    this.mouseDownRightThisFrame = false;\n    this.mouseDownMiddleThisFrame = false;\n\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (!this.process(event)) {\n        this.didStopProcessingEarly = true;\n        this.events.splice(0, i);\n        break;\n      }\n    }\n\n    if (!this.didStopProcessingEarly) {\n      this.events.length = 0;\n    }\n\n    frame.setVector2(paths.device.mouse.coords, this.coords[0], this.coords[1]);\n    frame.setVector2(paths.device.mouse.movementXY, this.movementXY[0], this.movementXY[1]);\n    frame.setValueType(paths.device.mouse.buttonLeft, this.buttonLeft);\n    frame.setValueType(paths.device.mouse.buttonRight, this.buttonRight);\n    frame.setValueType(paths.device.mouse.buttonMiddle, this.buttonMiddle);\n    frame.setValueType(paths.device.mouse.wheel, this.wheel);\n  }\n}\n\nwindow.oncontextmenu = e => {\n  if (!isInModal()) {\n    e.preventDefault();\n  }\n};\n","// You might prefer to use this over a Set because iterating over a set allocates memory\nexport function ArrayBackedSet(initialItems) {\n  return {\n    items: initialItems || [],\n    has(item) {\n      return this.items.indexOf(item) !== -1;\n    },\n    add(item) {\n      if (!this.has(item)) {\n        this.items.push(item);\n      }\n    },\n    delete(item) {\n      const index = this.items.indexOf(item);\n      if (index !== -1) {\n        this.items[index] = this.items[this.items.length - 1];\n        this.items.pop();\n      }\n    },\n    clear() {\n      this.items.length = 0;\n    }\n  };\n}\n","import { paths } from \"../paths\";\nimport { ArrayBackedSet } from \"../array-backed-set\";\n\n// TODO currently hardcoding these keys to be physical location based instead of character based. We likely want to make this part of the bindings themselves.\nconst CODE_TO_KEY = {\n  KeyW: \"w\",\n  KeyA: \"a\",\n  KeyS: \"s\",\n  KeyD: \"d\",\n  KeyQ: \"q\",\n  KeyE: \"e\"\n};\n\nexport class KeyboardDevice {\n  constructor() {\n    this.seenKeys = new ArrayBackedSet();\n    this.keys = {};\n    this.events = [];\n\n    [\"keydown\", \"keyup\"].map(x =>\n      document.addEventListener(x, e => {\n        if (!e.key) return;\n        this.events.push(e);\n\n        // Block browser hotkeys for chat command, media browser and freeze\n        if (\n          (e.type === \"keydown\" &&\n            e.key === \"/\" &&\n            ![\"TEXTAREA\", \"INPUT\"].includes(document.activeElement && document.activeElement.nodeName) &&\n            !(document.activeElement && document.activeElement.contentEditable === \"true\")) ||\n          (e.ctrlKey &&\n            (e.key === \"1\" ||\n              e.key === \"2\" ||\n              e.key === \"3\" ||\n              e.key === \"4\" ||\n              e.key === \"5\" ||\n              e.key === \"6\" ||\n              e.key === \"7\" ||\n              e.key === \"8\" ||\n              e.key === \"9\" ||\n              e.key === \"0\")) ||\n          (e.key === \"Tab\" && document.activeElement.classList.contains(\"a-canvas\"))\n        ) {\n          e.preventDefault();\n          return false;\n        }\n      })\n    );\n    [\"blur\"].map(x => window.addEventListener(x, this.events.push.bind(this.events)));\n  }\n\n  write(frame) {\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (event.type === \"blur\") {\n        this.keys = {};\n        this.seenKeys.clear();\n      } else {\n        let key = event.key.toLowerCase();\n        // Use event.code and not event.key for wasdqe controls so this works\n        // for non QWERTY keyboards.\n        key = (event.code && CODE_TO_KEY[event.code]) || key;\n        this.keys[key] = event.type === \"keydown\";\n        this.seenKeys.add(key);\n      }\n    }\n\n    this.events.length = 0;\n\n    for (let i = 0; i < this.seenKeys.items.length; i++) {\n      const key = this.seenKeys.items[i];\n      const path = paths.device.keyboard.key(key);\n      frame.setValueType(path, this.keys[key]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class HudDevice {\n  constructor() {\n    this.events = [];\n    document.querySelector(\"a-scene\").addEventListener(\"penButtonPressed\", this.events.push.bind(this.events));\n  }\n\n  write(frame) {\n    frame.setValueType(paths.device.hud.penButton, this.events.length !== 0);\n    while (this.events.length) {\n      this.events.pop();\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class XboxControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [\n      { name: \"a\", buttonId: 0 },\n      { name: \"b\", buttonId: 1 },\n      { name: \"x\", buttonId: 2 },\n      { name: \"y\", buttonId: 3 },\n      { name: \"leftBumper\", buttonId: 4 },\n      { name: \"rightBumper\", buttonId: 5 },\n      { name: \"leftTrigger\", buttonId: 6 },\n      { name: \"rightTrigger\", buttonId: 7 },\n      { name: \"back\", buttonId: 8 },\n      { name: \"start\", buttonId: 9 },\n      { name: \"leftJoystick\", buttonId: 10 },\n      { name: \"rightJoystick\", buttonId: 11 },\n      { name: \"dpadUp\", buttonId: 12 },\n      { name: \"dpadDown\", buttonId: 13 },\n      { name: \"dpadLeft\", buttonId: 14 },\n      { name: \"dpadRight\", buttonId: 15 }\n    ];\n    this.axisMap = [\n      { name: \"leftJoystickHorizontal\", axisId: 0 },\n      { name: \"leftJoystickVertical\", axisId: 1 },\n      { name: \"rightJoystickHorizontal\", axisId: 2 },\n      { name: \"rightJoystickVertical\", axisId: 3 }\n    ];\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (this.gamepad.connected) {\n      const xboxPaths = paths.device.xbox;\n      this.buttonMap.forEach(b => {\n        const path = xboxPaths.button(b.name);\n        const button = this.gamepad.buttons[b.buttonId];\n        frame.setValueType(path.pressed, !!button.pressed);\n        frame.setValueType(path.touched, !!button.touched);\n        frame.setValueType(path.value, button.value);\n      });\n      frame.setValueType(xboxPaths.axesSum, 0);\n      this.axisMap.forEach(axis => {\n        frame.setValueType(xboxPaths.axis(axis.name), this.gamepad.axes[axis.axisId]);\n        frame.setValueType(xboxPaths.axesSum, frame.get(xboxPaths.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n      });\n\n      if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n        frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n      }\n    }\n  }\n}\n","import { Vector3, Quaternion } from \"three\";\nconst forward = new Vector3(0, 0, -1);\nexport function Pose() {\n  return {\n    position: new Vector3(),\n    direction: new Vector3(),\n    orientation: new Quaternion(),\n    fromOriginAndDirection: function (origin, direction) {\n      this.position = origin;\n      this.direction = direction;\n      this.orientation = this.orientation.setFromUnitVectors(forward, direction);\n      return this;\n    },\n    fromCameraProjection: function (camera, normalizedX, normalizedY) {\n      this.position.setFromMatrixPosition(camera.matrixWorld);\n      this.direction.set(normalizedX, normalizedY, 0.5).unproject(camera).sub(this.position).normalize();\n      this.fromOriginAndDirection(this.position, this.direction);\n      return this;\n    },\n    copy: function (pose) {\n      this.position.copy(pose.position);\n      this.direction.copy(pose.direction);\n      this.orientation.copy(pose.orientation);\n    }\n  };\n}\n","// Vector from eyes to elbow (divided by user height).\nconst EYES_TO_ELBOW = { x: 0.175, y: -0.3, z: -0.03 };\n// Vector from eyes to elbow (divided by user height).\nconst FOREARM = { x: 0, y: 0, z: -0.175 };\n\nexport const applyArmModel = (function() {\n  const controllerEuler = new THREE.Euler();\n  const deltaControllerPosition = new THREE.Vector3();\n  const controllerQuaternion = new THREE.Quaternion();\n  const controllerPosition = new THREE.Vector3();\n  return function applyArmModel(gamepadPose, hand, headObject3D, userHeight) {\n    headObject3D.updateMatrices();\n    controllerPosition.copy(headObject3D.position);\n    controllerPosition.y = controllerPosition.y - userHeight;\n    deltaControllerPosition.set(\n      EYES_TO_ELBOW.x * (hand === \"left\" ? -1 : hand === \"right\" ? 1 : 0),\n      EYES_TO_ELBOW.y,\n      EYES_TO_ELBOW.z\n    );\n    deltaControllerPosition.multiplyScalar(userHeight);\n    deltaControllerPosition.applyAxisAngle(headObject3D.up, headObject3D.rotation.y);\n    controllerPosition.add(deltaControllerPosition);\n    deltaControllerPosition.set(FOREARM.x, FOREARM.y, FOREARM.z);\n    deltaControllerPosition.multiplyScalar(userHeight);\n    controllerQuaternion.fromArray(gamepadPose.orientation);\n    controllerEuler.setFromQuaternion(controllerQuaternion);\n    controllerEuler.set(controllerEuler.x, controllerEuler.y, 0);\n    deltaControllerPosition.applyEuler(controllerEuler);\n    controllerPosition.add(deltaControllerPosition);\n    return controllerPosition;\n  };\n})();\n","export const copySittingToStandingTransform = function copySittingToStandingTransform(matrix) {\n  navigator.getVRDisplays &&\n    navigator.getVRDisplays().then(displays => {\n      if (displays[0] && displays[0].stageParameters && displays[0].stageParameters.sittingToStandingTransform) {\n        matrix.fromArray(displays[0].stageParameters.sittingToStandingTransform);\n      } else {\n        setTimeout(() => {\n          copySittingToStandingTransform(matrix);\n        }, 1000); // Try again when the display is ready\n      }\n    });\n};\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\nimport { waitForDOMContentLoaded } from \"../../../utils/async-utils\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst m = new THREE.Matrix4();\n\nconst TOUCHPAD = paths.device.oculusgo.touchpad;\nconst TRIGGER = paths.device.oculusgo.trigger;\n\nexport class OculusGoControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.pose = new Pose();\n    this.q = new THREE.Quaternion();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n\n    // TODO ideally we should just be getting pose from the gamepad\n    // TODO if controller is set to left hand, we still use right hand query here\n    // because otherwise things break.\n    waitForDOMContentLoaded().then(() => {\n      this.rayObject = document.querySelector(\"#player-right-controller\").object3D;\n      this.headObject3D = document.querySelector(\"#avatar-pov-node\").object3D;\n    });\n\n    navigator.getGamepads();\n  }\n\n  write(frame) {\n    if (!this.rayObject || !this.headObject3D) return;\n\n    // Have to call navigator.getGamepads() in order for the gamepad object to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      frame.setValueType(TOUCHPAD.axisX, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD.axisY, this.gamepad.axes[1]);\n      frame.setValueType(TOUCHPAD.pressed, this.gamepad.buttons[0].pressed);\n      frame.setValueType(TOUCHPAD.touched, this.gamepad.buttons[0].touched);\n      frame.setValueType(TOUCHPAD.value, this.gamepad.buttons[0].value);\n      frame.setValueType(TRIGGER.pressed, this.gamepad.buttons[1].pressed);\n      frame.setValueType(TRIGGER.touched, this.gamepad.buttons[1].touched);\n      frame.setValueType(TRIGGER.value, this.gamepad.buttons[1].value);\n\n      this.rayObject.updateMatrices();\n      this.rayObject.getWorldQuaternion(this.q);\n      frame.setValueType(paths.actions.rayObjectRotation, this.q);\n      const rayMatrixWorld = this.rayObject.matrixWorld;\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n\n      this.pose.position.setFromMatrixPosition(rayMatrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.oculusgo.pose, this.pose);\n\n      if (this.gamepad.pose.orientation) {\n        // TODO if controller is set to left hand, we still draw right hand until\n        // bindings are overhauled to handle primary/secondary hands.\n        frame.setMatrix4(\n          paths.device.oculusgo.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.gearVRController.button(\"touchpad\");\nconst TRIGGER = paths.device.gearVRController.button(\"trigger\");\nconst TOUCHPAD_X = paths.device.gearVRController.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.gearVRController.axis(\"touchpadY\");\n\nconst m = new THREE.Matrix4();\n\nexport class GearVRControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [{ name: \"touchpad\", buttonId: 0 }, { name: \"trigger\", buttonId: 1 }];\n    this.axisMap = [{ name: \"touchpadX\", axisId: 0 }, { name: \"touchpadY\", axisId: 1 }];\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    // Chrome requires a call to getGamepads() for the gamepad state to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      const touchpad = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!touchpad.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!touchpad.touched);\n      frame.setValueType(TOUCHPAD.value, !!touchpad.value);\n\n      const trigger = this.gamepad.buttons[1];\n      frame.setValueType(TRIGGER.pressed, !!trigger.pressed);\n      frame.setValueType(TRIGGER.touched, !!trigger.touched);\n      frame.setValueType(TRIGGER.value, !!trigger.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.gearVRController.pose, this.pose);\n      this.headObject3D = this.headObject3D || document.querySelector(\"#avatar-pov-node\").object3D;\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          paths.device.gearVRController.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nexport const leftOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"x\", buttonId: 3 },\n  { name: \"y\", buttonId: 4 }\n];\nexport const rightOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"a\", buttonId: 3 },\n  { name: \"b\", buttonId: 4 }\n];\n\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.1);\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.1);\n\nconst m = new THREE.Matrix4();\n\nexport class OculusTouchControllerDevice {\n  constructor(gamepad) {\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    const buttonMaps = {\n      left: leftOculusTouchButtonMap,\n      right: rightOculusTouchButtonMap\n    };\n\n    const devicePaths = {\n      left: paths.device.leftOculusTouch,\n      right: paths.device.rightOculusTouch\n    };\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n    this.buttonMap = buttonMaps[gamepad.hand];\n    this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.path = devicePaths[gamepad.hand];\n    this.selector = `#player-${gamepad.hand}-controller`;\n\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n    this.handOffset = this.gamepad.hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET;\n  }\n\n  write(frame) {\n    if (!this.gamepad) return;\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad || !this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.orientation.copy(this.rayObjectRotation);\n\n    frame.setPose(this.path.pose, this.pose);\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(this.handOffset)\n      );\n    }\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().makeTranslation(0, 0, -0.04);\nconst m = new THREE.Matrix4();\n\nconst TOUCHPAD = paths.device.daydream.button(\"touchpad\");\nconst TOUCHPAD_X = paths.device.daydream.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.daydream.axis(\"touchpadY\");\nconst POSE = paths.device.daydream.pose;\nconst MATRIX = paths.device.daydream.matrix;\n\nexport class DaydreamControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand || \"right\"}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[0];\n    if (this.gamepad && this.gamepad.connected) {\n      const button = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!button.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!button.touched);\n      frame.setValueType(TOUCHPAD.value, !!button.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO ideally we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(POSE, this.pose);\n\n      this.headObject3D = this.headObject3D || document.querySelector(\"#avatar-pov-node\").object3D;\n\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          MATRIX,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n            .multiply(HAND_OFFSET)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, 0, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.MathUtils.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\nconst RAY_ROTATION = new THREE.Quaternion();\nconst m = new THREE.Matrix4();\n\nexport class ViveControllerDevice {\n  constructor(gamepad) {\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n    this.gamepad = gamepad;\n\n    if (this.gamepad.id === \"OpenVR Cosmos\") {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n      this.buttonMap = [\n        { name: \"trigger\", buttonId: 0 },\n        { name: \"grip\", buttonId: 1 },\n        { name: \"primary\", buttonId: 2 },\n        { name: \"secondary\", buttonId: 3 },\n        { name: \"joystick\", buttonId: 4 },\n        { name: \"bumper\", buttonId: 5 }\n      ];\n      this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n    } else if (this.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), Math.PI / 15);\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 }\n      ];\n      this.axisMap = [{ name: \"touchX\", axisId: 0 }, { name: \"touchY\", axisId: 1 }];\n    } else if (this.gamepad.axes.length === 4) {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 },\n        { name: \"primary\", buttonId: 3 },\n        { name: \"secondary\", buttonId: 4 },\n        { name: \"joystick\", buttonId: 5 },\n        { name: \"index\", buttonId: 6 },\n        { name: \"middle\", buttonId: 7 },\n        { name: \"ring\", buttonId: 8 },\n        { name: \"pinky\", buttonId: 9 }\n      ];\n      this.axisMap = [\n        { name: \"touchX\", axisId: 0 },\n        { name: \"touchY\", axisId: 1 },\n        { name: \"joyX\", axisId: 2 },\n        { name: \"joyY\", axisId: 3 }\n      ];\n    } else {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 },\n        { name: \"primary\", buttonId: 3 }\n      ];\n      this.axisMap = [{ name: \"touchX\", axisId: 0 }, { name: \"touchY\", axisId: 1 }];\n    }\n\n    this.pose = new Pose();\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.path = paths.device.vive[gamepad.hand || \"right\"];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    const gamepads = navigator.getGamepads();\n    if (gamepads.length < this.gamepad.index + 1) {\n      //workaround for: https://bugzilla.mozilla.org/show_bug.cgi?id=1568076\n      return;\n    }\n    this.gamepad = gamepads[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    if (!this.selector) {\n      if (this.gamepad.hand) {\n        this.path = paths.device.vive[this.gamepad.hand];\n        this.selector = `#player-${this.gamepad.hand}-controller`;\n        console.warn(\"gamepad hand eventually specified\");\n      } else {\n        return;\n      }\n    }\n    const el = document.querySelector(this.selector);\n    const rayObject = el.object3D;\n    rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(rayObject.matrixWorld));\n    this.pose.position.setFromMatrixPosition(rayObject.matrixWorld);\n    this.pose.direction\n      .set(0, 0, -1)\n      .applyQuaternion(RAY_ROTATION)\n      .applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, -0.017, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.MathUtils.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\nconst m = new THREE.Matrix4();\n\nexport class WindowsMixedRealityControllerDevice {\n  constructor(gamepad) {\n    this.rayObject = null;\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n\n    if (gamepad.hand) {\n      this.selector = `#player-${gamepad.hand}-controller`;\n    }\n\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n  write(frame) {\n    if (!this.gamepad) return;\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad || !this.gamepad.connected) return;\n\n    const path = paths.device.wmr[this.gamepad.hand || \"right\"];\n\n    frame.setValueType(path.touchpad.pressed, this.gamepad.buttons[0].pressed);\n    frame.setValueType(path.touchpad.touched, this.gamepad.buttons[0].touched);\n    frame.setValueType(path.touchpad.value, this.gamepad.buttons[0].value);\n\n    frame.setValueType(path.trigger.pressed, this.gamepad.buttons[1].pressed);\n    frame.setValueType(path.trigger.touched, this.gamepad.buttons[1].touched);\n    frame.setValueType(path.trigger.value, this.gamepad.buttons[1].value);\n\n    frame.setValueType(path.grip.pressed, this.gamepad.buttons[2].pressed);\n    frame.setValueType(path.grip.touched, this.gamepad.buttons[2].touched);\n    frame.setValueType(path.grip.value, this.gamepad.buttons[2].value);\n\n    frame.setValueType(path.menu.pressed, this.gamepad.buttons[3].pressed);\n    frame.setValueType(path.menu.touched, this.gamepad.buttons[3].touched);\n    frame.setValueType(path.menu.value, this.gamepad.buttons[3].value);\n\n    frame.setValueType(path.touchpad.axisX, this.gamepad.axes[0]);\n    frame.setValueType(path.touchpad.axisY, this.gamepad.axes[1]);\n    frame.setValueType(path.joystick.axisX, this.gamepad.axes[2]);\n    frame.setValueType(path.joystick.axisY, this.gamepad.axes[3]);\n\n    if (!this.selector) {\n      if (!this.gamepad.hand) return;\n      this.selector = `#player-${this.gamepad.hand}-controller`;\n    }\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n// Note these offests are specifically for the oculus touch controllers on a Quest.\n// We'll have to account for other headsets and controllers as we expand WebXR support.\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.12);\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.12);\nconst m = new THREE.Matrix4();\n\nexport class WebXRControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n\n    this.selector = `#player-${gamepad.hand}-controller`;\n    this.rayObject = null;\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.pose = new Pose();\n\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n  write(frame, scene, referenceSpace) {\n    if (!referenceSpace || !this.gamepad) return;\n\n    const hand = this.gamepad.hand || \"right\";\n    const path = paths.device.webxr[hand];\n\n    if (this.gamepad.buttons[0]) {\n      frame.setValueType(path.button.trigger.pressed, this.gamepad.buttons[0].pressed);\n      frame.setValueType(path.button.trigger.touched, this.gamepad.buttons[0].touched);\n      frame.setValueType(path.button.trigger.value, this.gamepad.buttons[0].value);\n    }\n\n    if (this.gamepad.buttons[1]) {\n      frame.setValueType(path.button.grip.pressed, this.gamepad.buttons[1].pressed);\n      frame.setValueType(path.button.grip.touched, this.gamepad.buttons[1].touched);\n      frame.setValueType(path.button.grip.value, this.gamepad.buttons[1].value);\n    }\n\n    if (this.gamepad.buttons[2]) {\n      frame.setValueType(path.button.touchpad.pressed, this.gamepad.buttons[2].pressed);\n      frame.setValueType(path.button.touchpad.touched, this.gamepad.buttons[2].touched);\n      frame.setValueType(path.button.touchpad.value, this.gamepad.buttons[2].value);\n    }\n\n    if (this.gamepad.buttons[3]) {\n      frame.setValueType(path.button.thumbStick.pressed, this.gamepad.buttons[3].pressed);\n      frame.setValueType(path.button.thumbStick.touched, this.gamepad.buttons[3].touched);\n      frame.setValueType(path.button.thumbStick.value, this.gamepad.buttons[3].value);\n    }\n\n    if (this.gamepad.buttons[4]) {\n      frame.setValueType(path.button.a.pressed, this.gamepad.buttons[4].pressed);\n      frame.setValueType(path.button.a.touched, this.gamepad.buttons[4].touched);\n      frame.setValueType(path.button.a.value, this.gamepad.buttons[4].value);\n    }\n\n    if (this.gamepad.buttons[5]) {\n      frame.setValueType(path.button.b.pressed, this.gamepad.buttons[5].pressed);\n      frame.setValueType(path.button.b.touched, this.gamepad.buttons[5].touched);\n      frame.setValueType(path.button.b.value, this.gamepad.buttons[5].value);\n    }\n\n    if (this.gamepad.axes.length >= 4) {\n      frame.setValueType(path.axis.touchpadX, this.gamepad.axes[0]);\n      frame.setValueType(path.axis.touchpadY, this.gamepad.axes[1]);\n      frame.setValueType(path.axis.joyX, this.gamepad.axes[2]);\n      frame.setValueType(path.axis.joyY, this.gamepad.axes[3]);\n    }\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.orientation.copy(this.rayObjectRotation);\n\n    frame.setPose(path.pose, this.pose);\n\n    const pose = scene.frame.getPose(this.gamepad.targetRaySpace, referenceSpace);\n\n    if (pose && pose.transform.position && pose.transform.orientation) {\n      this.position.copy(pose.transform.position);\n      this.orientation.copy(pose.transform.orientation);\n      this.matrix.compose(\n        this.position,\n        this.orientation,\n        ONES\n      );\n      this.matrix.multiply(hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET);\n      frame.setMatrix4(path.matrix, this.matrix);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nconst TWOPI = Math.PI * 2;\n\nclass CircularBuffer {\n  constructor(length) {\n    this.items = new Array(length).fill(0);\n    this.writePtr = 0;\n  }\n\n  push(item) {\n    this.items[this.writePtr] = item;\n    this.writePtr = (this.writePtr + 1) % this.items.length;\n  }\n}\n\nconst abs = Math.abs;\n// Input: two numbers between [-Math.PI, Math.PI]\n// Output: difference between them, where -Math.PI === Math.PI\nconst difference = (curr, prev) => {\n  const a = curr - prev;\n  const b = curr + TWOPI - prev;\n  const c = curr - (prev + TWOPI);\n  if (abs(a) < abs(b)) {\n    if (abs(a) < abs(c)) {\n      return a;\n    }\n  }\n  if (abs(b) < abs(c)) {\n    return b;\n  }\n\n  return c;\n};\n\nconst average = a => {\n  let sum = 0;\n  for (let i = 0; i < a.length; i++) {\n    const n = a[i];\n    sum += n;\n  }\n  return sum / a.length;\n};\n\nexport class GyroDevice {\n  constructor() {\n    this.hmdEuler = new THREE.Euler();\n    this.hmdQuaternion = new THREE.Quaternion();\n    this.prevX = this.hmdEuler.x;\n    this.prevY = this.hmdEuler.y;\n    this.dXBuffer = new CircularBuffer(6);\n    this.dYBuffer = new CircularBuffer(6);\n    this.hasPolyfill = window.webvrpolyfill;\n    if (this.hasPolyfill) {\n      this.vrDisplay = window.webvrpolyfill.getPolyfillDisplays()[0];\n      this.frameData = new window.webvrpolyfill.constructor.VRFrameData();\n    }\n\n    this.enableGyro = window.APP.store.state.preferences.enableGyro;\n    window.APP.store.addEventListener(\"statechanged\", () => {\n      this.enableGyro = window.APP.store.state.preferences.enableGyro;\n    });\n  }\n\n  write(frame) {\n    if (!this.enableGyro || !this.hasPolyfill || !this.vrDisplay || !this.frameData) {\n      return;\n    }\n    const hmdEuler = this.hmdEuler;\n    this.vrDisplay.getFrameData(this.frameData);\n    if (this.frameData.pose.orientation !== null) {\n      this.hmdQuaternion.fromArray(this.frameData.pose.orientation);\n      hmdEuler.setFromQuaternion(this.hmdQuaternion, \"YXZ\");\n    }\n\n    // Don't use gyro values when device is lying flat\n    if (hmdEuler.x < -Math.PI * 0.475) return;\n\n    const dX = difference(hmdEuler.x, this.prevX);\n    const dY = difference(hmdEuler.y, this.prevY);\n\n    this.dXBuffer.push(Math.abs(dX) < 0.001 ? 0 : dX);\n    this.dYBuffer.push(Math.abs(dY) < 0.001 ? 0 : dY);\n\n    this.averageDeltaX = average(this.dXBuffer.items);\n    this.averageDeltaY = average(this.dYBuffer.items);\n\n    this.prevX = hmdEuler.x;\n    this.prevY = hmdEuler.y;\n    frame.setValueType(paths.device.gyro.averageDeltaX, this.averageDeltaX);\n    frame.setValueType(paths.device.gyro.averageDeltaY, this.averageDeltaY);\n  }\n}\n","import { HeldRemoteRight } from \"../../../bit-components\";\nimport { anyEntityWith } from \"../../../utils/bit-utils\";\nimport { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\n\nconst calculateCursorPose = (function() {\n  const origin = new THREE.Vector3();\n  const direction = new THREE.Vector3();\n  return function(cursorPose, camera, coords) {\n    origin.setFromMatrixPosition(camera.matrixWorld);\n    direction\n      .set(coords[0], coords[1], 0.5)\n      .unproject(camera)\n      .sub(origin)\n      .normalize();\n    cursorPose.fromOriginAndDirection(origin, direction);\n    return cursorPose;\n  };\n})();\n\nexport class AppAwareMouseDevice {\n  constructor() {\n    this.cursorPose = new Pose();\n  }\n  write(frame) {\n    const transformSystem = AFRAME.scenes[0].systems[\"transform-selected-object\"];\n\n    const buttonLeft = frame.get(paths.device.mouse.buttonLeft);\n    const buttonRight = frame.get(paths.device.mouse.buttonRight);\n\n    if ((buttonRight && !transformSystem.transforming) || (buttonLeft && !anyEntityWith(APP.world, HeldRemoteRight))) {\n      const movementXY = frame.get(paths.device.mouse.movementXY);\n      if (movementXY) {\n        frame.setVector2(paths.device.smartMouse.cameraDelta, movementXY[0], movementXY[1]);\n      }\n      frame.setValueType(paths.device.smartMouse.shouldMoveCamera, true);\n    }\n\n    if (!this.camera) {\n      this.camera = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n    }\n\n    if (this.camera) {\n      frame.setPose(\n        paths.device.smartMouse.cursorPose,\n        calculateCursorPose(this.cursorPose, this.camera, frame.get(paths.device.mouse.coords))\n      );\n    }\n  }\n}\n","export function touchIsAssigned(touch, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.touch.identifier === touch.identifier;\n    }) !== undefined\n  );\n}\n\nexport function jobIsAssigned(job, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.job === job;\n    }) !== undefined\n  );\n}\n\nexport function assign(touch, job, assignments) {\n  if (touchIsAssigned(touch, assignments) || jobIsAssigned(job, assignments)) {\n    console.error(\"cannot reassign touches or jobs. unassign first\");\n    return undefined;\n  }\n  const assignment = { job, touch };\n  assignments.push(assignment);\n  return assignment;\n}\n\nexport function unassign(touch, job, assignments) {\n  function match(assignment) {\n    return assignment.touch.identifier === touch.identifier && assignment.job === job;\n  }\n  assignments.splice(assignments.findIndex(match), 1);\n}\n\nexport function findByJob(job, assignments) {\n  return assignments.find(assignment => {\n    return assignment.job === job;\n  });\n}\n\nexport function findByTouch(touch, assignments) {\n  return assignments.find(assignment => {\n    return assignment.touch.identifier === touch.identifier;\n  });\n}\n","import { addComponent, defineQuery, hasComponent, removeComponent } from \"bitecs\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\nimport {\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredRemoteLeft,\n  HoveredRemoteRight,\n  NotRemoteHoverTarget,\n  RemoteHoverTarget\n} from \"../bit-components\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { sets } from \"../systems/userinput/sets\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\nimport { Layers } from \"./layers\";\n\nexport function findRemoteHoverTarget(world, object3D) {\n  if (!object3D) return null;\n  if (!object3D.eid) return findRemoteHoverTarget(world, object3D.parent);\n  if (hasComponent(world, NotRemoteHoverTarget, object3D.eid)) return null;\n  if (hasComponent(world, RemoteHoverTarget, object3D.eid)) return object3D.eid;\n  return findRemoteHoverTarget(world, object3D.parent);\n}\n\nconst hoveredRightRemoteQuery = defineQuery([HoveredRemoteRight]);\nconst hoveredLeftRemoteQuery = defineQuery([HoveredRemoteLeft]);\n\nconst HIGHLIGHT = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nconst NO_HIGHLIGHT = new THREE.Color(190 / 255, 190 / 255, 190 / 255);\nconst TRANSFORM_COLOR_1 = new THREE.Color(150 / 255, 80 / 255, 150 / 255);\nconst TRANSFORM_COLOR_2 = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nAFRAME.registerComponent(\"cursor-controller\", {\n  schema: {\n    cursor: { type: \"selector\" },\n    camera: { type: \"selector\" },\n    far: { default: 100 },\n    near: { default: 0.01 },\n    defaultDistance: { default: 4 },\n    minDistance: { default: 0.18 }\n  },\n\n  init: function() {\n    this.enabled = false;\n\n    this.cursorVisual = new THREE.Mesh(\n      new THREE.PlaneBufferGeometry(),\n      new THREE.ShaderMaterial({\n        depthTest: false,\n        uniforms: {\n          color: { value: new THREE.Color(0x2f80ed) }\n        },\n        vertexShader: `\n          varying vec2 vPos;\n          void main() {\n            vPos = position.xy;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n            vec2 scale = vec2(\n              length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) ),\n              length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) )\n            );\n\n            float distance = -mvPosition.z;\n            scale *= distance; // negates projection scale\n            scale += min(1.0/distance, 0.3); // scale in screen space\n\n            float radius = 0.02;\n            mvPosition.xy += position.xy * radius * scale;\n            gl_Position = projectionMatrix * mvPosition;\n          }`,\n        fragmentShader: `\n          uniform vec3 color;\n          varying vec2 vPos;\n\n          void main() {\n            float distance = length(vPos);\n            if (distance > 0.5) {\n                discard;\n            }\n\n            gl_FragColor = vec4(\n              mix(color, vec3(0.0), step(0.35, distance)),\n              0.8\n            );\n\n            // #include <tonemapping_fragment>\n            #include <encodings_fragment>\n          }`\n      })\n    );\n\n    const setCursorScale = () => {\n      this.cursorVisual.scale.setScalar(APP.store.state.preferences[\"cursorSize\"] || 1);\n      this.cursorVisual.matrixNeedsUpdate = true;\n    };\n    APP.store.addEventListener(\"statechanged\", setCursorScale);\n    setCursorScale();\n\n    this.cursorVisual.renderOrder = window.APP.RENDER_ORDER.CURSOR;\n    this.cursorVisual.material.transparent = true;\n    this.cursorVisual.layers.set(Layers.CAMERA_LAYER_UI);\n    this.data.cursor.object3D.add(this.cursorVisual);\n\n    this.intersection = null;\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n    this.distance = this.data.far;\n    this.color = this.cursorVisual.material.uniforms.color.value;\n\n    const lineGeometry = new THREE.BufferGeometry();\n    lineGeometry.setAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\n\n    this.line = new THREE.Line(\n      lineGeometry,\n      new THREE.LineBasicMaterial({\n        color: \"white\",\n        opacity: 0.2,\n        transparent: true,\n        visible: false\n      })\n    );\n    this.el.setObject3D(\"line\", this.line);\n  },\n\n  update: function() {\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick2: (() => {\n    const rawIntersections = [];\n    const cameraPos = new THREE.Vector3();\n    const v = new THREE.Vector3();\n\n    return function(t, left) {\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const cursorPose = userinput.get(left ? paths.actions.cursor.left.pose : paths.actions.cursor.right.pose);\n      const hideLine = userinput.get(left ? paths.actions.cursor.left.hideLine : paths.actions.cursor.right.hideLine);\n\n      this.data.cursor.object3D.visible = this.enabled && !!cursorPose;\n      this.line.material.visible = !!(this.enabled && !hideLine);\n\n      this.intersection = null;\n\n      if (!this.enabled || !cursorPose) {\n        return;\n      }\n\n      this.el.sceneEl.systems[\"hubs-systems\"].characterController.avatarPOV.object3D.updateMatrices();\n      const playerScale = v\n        .setFromMatrixColumn(\n          this.el.sceneEl.systems[\"hubs-systems\"].characterController.avatarPOV.object3D.matrixWorld,\n          1\n        )\n        .length();\n      this.raycaster.far = this.data.far * playerScale;\n      this.raycaster.near = this.data.near * playerScale;\n\n      const isGrabbing = left ? anyEntityWith(APP.world, HeldRemoteLeft) : anyEntityWith(APP.world, HeldRemoteRight);\n      let isHoveringSomething = false;\n      if (!isGrabbing) {\n        rawIntersections.length = 0;\n        this.raycaster.ray.origin = cursorPose.position;\n        this.raycaster.ray.direction = cursorPose.direction;\n        this.raycaster.intersectObjects(\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n          true,\n          rawIntersections\n        );\n        this.intersection = rawIntersections[0];\n\n        const remoteHoverTarget = this.intersection && findRemoteHoverTarget(APP.world, this.intersection.object);\n        isHoveringSomething = !!remoteHoverTarget;\n        if (remoteHoverTarget) {\n          addComponent(APP.world, left ? HoveredRemoteLeft : HoveredRemoteRight, remoteHoverTarget);\n        }\n        const hovered = left ? hoveredLeftRemoteQuery(APP.world) : hoveredRightRemoteQuery(APP.world);\n        for (let i = 0; i < hovered.length; i++) {\n          // Unhover anything that should no longer be hovered\n          if (remoteHoverTarget !== hovered[i]) {\n            removeComponent(APP.world, left ? HoveredRemoteLeft : HoveredRemoteRight, hovered[i]);\n          }\n        }\n        this.distance = remoteHoverTarget ? this.intersection.distance : this.data.defaultDistance * playerScale;\n      }\n\n      const { cursor, minDistance, far, camera } = this.data;\n\n      const cursorModDelta =\n        userinput.get(left ? paths.actions.cursor.left.modDelta : paths.actions.cursor.right.modDelta) || 0;\n      if (isGrabbing && !userinput.activeSets.includes(left ? sets.leftCursorHoldingUI : sets.rightCursorHoldingUI)) {\n        this.distance = THREE.MathUtils.clamp(this.distance - cursorModDelta, minDistance, far * playerScale);\n      }\n      cursor.object3D.position.copy(cursorPose.position).addScaledVector(cursorPose.direction, this.distance);\n      // The cursor will always be oriented towards the player about its Y axis, so objects held by the cursor will rotate towards the player.\n      getLastWorldPosition(camera.object3D, cameraPos);\n      cameraPos.y = cursor.object3D.position.y;\n      cursor.object3D.lookAt(cameraPos);\n      cursor.object3D.matrixNeedsUpdate = true;\n\n      // TODO : Check if the selected object being transformed is for this cursor!\n      const transformObjectSystem = AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      if (\n        transformObjectSystem.transforming &&\n        ((left && transformObjectSystem.hand.el.id === \"player-left-controller\") ||\n          (!left && transformObjectSystem.hand.el.id === \"player-right-controller\"))\n      ) {\n        this.color.copy(TRANSFORM_COLOR_1).lerpHSL(TRANSFORM_COLOR_2, 0.5 + 0.5 * Math.sin(t / 1000.0));\n      } else if (isGrabbing || isHoveringSomething) {\n        this.color.copy(HIGHLIGHT);\n      } else {\n        this.color.copy(NO_HIGHLIGHT);\n      }\n\n      if (this.line.material.visible) {\n        const posePosition = cursorPose.position;\n        const cursorPosition = cursor.object3D.position;\n        const positionArray = this.line.geometry.attributes.position.array;\n\n        positionArray[0] = posePosition.x;\n        positionArray[1] = posePosition.y;\n        positionArray[2] = posePosition.z;\n        positionArray[3] = cursorPosition.x;\n        positionArray[4] = cursorPosition.y;\n        positionArray[5] = cursorPosition.z;\n\n        this.line.geometry.attributes.position.needsUpdate = true;\n        this.line.geometry.computeBoundingSphere();\n      }\n    };\n  })()\n});\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { touchIsAssigned, jobIsAssigned, assign, unassign, findByJob, findByTouch } from \"./touchscreen/assignments\";\nimport { findRemoteHoverTarget } from \"../../../components/cursor-controller\";\n// import { canMove } from \"../../../utils/permissions-utils\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { hasComponent } from \"bitecs\";\nimport {\n  AEntity,\n  HeldRemoteRight,\n  OffersRemoteConstraint,\n  Pinnable,\n  Pinned,\n  SingleActionButton,\n  Static\n} from \"../../../bit-components\";\nimport { anyEntityWith } from \"../../../utils/bit-utils\";\n\nconst MOVE_CURSOR_JOB = \"MOVE CURSOR\";\nconst MOVE_CAMERA_JOB = \"MOVE CAMERA\";\nconst FIRST_PINCHER_JOB = \"FIRST PINCHER\";\nconst SECOND_PINCHER_JOB = \"SECOND PINCHER\";\n\nconst TAP_PATHS = [\n  paths.device.touchscreen.tap1,\n  paths.device.touchscreen.tap2,\n  paths.device.touchscreen.tap3,\n  paths.device.touchscreen.tap4,\n  paths.device.touchscreen.tap5\n];\n\nfunction distance(x1, y1, x2, y2) {\n  const dx = x1 - x2;\n  const dy = y1 - y2;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nconst getPlayerCamera = function() {\n  return AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n};\n\nfunction shouldMoveCursor(touch, rect, raycaster) {\n  const isCursorGrabbing = anyEntityWith(APP.world, HeldRemoteRight);\n  if (isCursorGrabbing) return true;\n\n  // Check if this touch might result in an interact or grab eventually\n  const rawIntersections = [];\n  raycaster.setFromCamera(\n    {\n      x: ((touch.clientX - rect.left) / rect.width) * 2 - 1,\n      y: -((touch.clientY - rect.top) / rect.height) * 2 + 1\n    },\n    getPlayerCamera()\n  );\n  raycaster.intersectObjects(\n    AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n    true,\n    rawIntersections\n  );\n  const intersection = rawIntersections[0];\n  const remoteHoverTarget = intersection && findRemoteHoverTarget(APP.world, intersection.object);\n  if (!remoteHoverTarget) return false;\n\n  const isSingleActionButton = hasComponent(APP.world, SingleActionButton, remoteHoverTarget);\n\n  const isInteractable =\n    hasComponent(APP.world, OffersRemoteConstraint, remoteHoverTarget) ||\n    (hasComponent(APP.world, AEntity, remoteHoverTarget) &&\n      APP.world.eid2obj\n        .get(remoteHoverTarget)\n        .el.matches(\".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon\"));\n\n  const isPinned =\n    hasComponent(APP.world, Pinnable, remoteHoverTarget) && hasComponent(APP.world, Pinned, remoteHoverTarget);\n  const isSceneFrozen = AFRAME.scenes[0].is(\"frozen\");\n\n  // TODO isStatic is likely a superfluous check for things matched via OffersRemoteConstraint\n  const isStatic = hasComponent(APP.world, Static, remoteHoverTarget);\n  return (\n    isSingleActionButton || (isInteractable && (isSceneFrozen || !isPinned) && !isStatic)\n    // TODO check canMove\n    //&& (remoteHoverTarget && canMove(remoteHoverTarget))\n  );\n}\n\nexport class AppAwareTouchscreenDevice {\n  constructor() {\n    this.raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(), 0, 100);\n    this.assignments = [];\n    this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n    // When touches appear, this timestamps and then watches for the high water mark of # of touches\n    this.pendingTap = { maxTouchCount: 0, startedAt: 0 };\n    this.tapIndexToWriteNextFrame = 0;\n\n    this.canvas = document.querySelector(\"canvas\");\n\n    this.events = [];\n    [\"touchstart\", \"touchend\", \"touchmove\", \"touchcancel\"].map(x =>\n      this.canvas.addEventListener(x, this.events.push.bind(this.events))\n    );\n    this.canvasRect = this.canvas.getBoundingClientRect();\n    new ResizeObserver(() => (this.canvasRect = this.canvas.getBoundingClientRect())).observe(this.canvas);\n  }\n\n  end(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      console.warn(\"touch does not have a job\", touch);\n    } else {\n      const assignment = findByTouch(touch, this.assignments);\n      switch (assignment.job) {\n        case MOVE_CURSOR_JOB:\n        case MOVE_CAMERA_JOB:\n          // If grab was being delayed, we should fire the initial grab and also delay the unassignment\n          // to ensure we write at least two frames with the grab down (since the action set will change)\n          // and otherwise we'd not see the falling xform.\n          if (assignment.framesUntilGrab > 0) {\n            assignment.framesUntilUnassign = assignment.framesUntilGrab + 2;\n          } else {\n            unassign(assignment.touch, assignment.job, this.assignments);\n          }\n\n          break;\n        case FIRST_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n          if (jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n            const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n            unassign(second.touch, second.job, this.assignments);\n            if (jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n              // reassign secondPincher to firstPincher\n              const first = assign(second.touch, FIRST_PINCHER_JOB, this.assignments);\n              first.clientX = second.clientX;\n              first.clientY = second.clientY;\n            } else {\n              // reassign secondPincher to moveCamera\n              const cameraMover = assign(second.touch, MOVE_CAMERA_JOB, this.assignments);\n              cameraMover.clientX = second.clientX;\n              cameraMover.clientY = second.clientY;\n              cameraMover.delta = [0, 0];\n            }\n          }\n          break;\n        case SECOND_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n          if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && !jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n            //reassign firstPincher to moveCamera\n            const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n            unassign(first.touch, first.job, this.assignments);\n            const cameraMover = assign(first.touch, MOVE_CAMERA_JOB, this.assignments);\n            cameraMover.clientX = first.clientX;\n            cameraMover.clientY = first.clientY;\n            cameraMover.delta = [0, 0];\n          }\n          break;\n      }\n    }\n\n    // Touches cleared, determine what to do with pending tap\n    if (this.assignments.length === 0) {\n      if (this.pendingTap.maxTouchCount > 0 && performance.now() - this.pendingTap.startedAt <= 125) {\n        this.tapIndexToWriteNextFrame = this.pendingTap.maxTouchCount;\n      }\n\n      this.pendingTap = { maxTouchCount: 0 };\n    }\n  }\n\n  move(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      if (!touch.target.classList[0] || !touch.target.classList[0].startsWith(\"virtual-gamepad-controls\")) {\n        console.warn(\"touch does not have job\", touch);\n      }\n      return;\n    }\n\n    const assignment = findByTouch(touch, this.assignments);\n    switch (assignment.job) {\n      case MOVE_CURSOR_JOB:\n        // Don't move the cursor until after the grab so that the grab happens at the touch's initial position\n        if (assignment.framesUntilGrab < 0) {\n          assignment.cursorPose.fromCameraProjection(\n            getPlayerCamera(),\n            ((touch.clientX - this.canvasRect.left) / this.canvasRect.width) * 2 - 1,\n            -((touch.clientY - this.canvasRect.top) / this.canvasRect.height) * 2 + 1\n          );\n        }\n        break;\n      case MOVE_CAMERA_JOB:\n        assignment.delta[0] += touch.clientX - assignment.clientX;\n        assignment.delta[1] += touch.clientY - assignment.clientY;\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        break;\n      case FIRST_PINCHER_JOB:\n      case SECOND_PINCHER_JOB:\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n          const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n          const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n          const currentDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n          this.pinch.delta += currentDistance - this.pinch.currentDistance;\n          this.pinch.currentDistance = currentDistance;\n        }\n        break;\n    }\n  }\n\n  start(touch) {\n    if (touchIsAssigned(touch, this.assignments)) {\n      console.error(\"touch already has a job\");\n      return;\n    }\n\n    const isFirstTouch = this.assignments.length === 0;\n    const isSecondTouch = this.assignments.length === 1;\n    const isThirdTouch = this.assignments.length === 2;\n\n    const hasSecondPinch = !!findByJob(SECOND_PINCHER_JOB, this.assignments);\n\n    if (isFirstTouch || (isThirdTouch && hasSecondPinch)) {\n      let assignment;\n\n      // First touch or third touch and other two fingers were pinching\n      if (shouldMoveCursor(touch, this.canvasRect, this.raycaster)) {\n        assignment = assign(touch, MOVE_CURSOR_JOB, this.assignments);\n\n        // Grabbing objects is delayed by several frames:\n        // - We don't want the physics constraint to be applied too early, which results in crazy velocities\n        // - We don't want to mis-trigger grabs if the user is about to put down a second finger.\n        assignment.framesUntilGrab = 8;\n      } else {\n        assignment = assign(touch, MOVE_CAMERA_JOB, this.assignments);\n        assignment.delta = [0, 0];\n      }\n\n      assignment.clientX = touch.clientX;\n      assignment.clientY = touch.clientY;\n\n      // On touch down, we always move the cursor on the first frame, but the MOVE_CURSOR_JOB indicates\n      // the touch will then track the cursor (instead of the camera)\n      assignment.cursorPose = new Pose().fromCameraProjection(\n        getPlayerCamera(),\n        ((touch.clientX - this.canvasRect.left) / this.canvasRect.width) * 2 - 1,\n        -((touch.clientY - this.canvasRect.top) / this.canvasRect.height) * 2 + 1\n      );\n    } else if (isSecondTouch || isThirdTouch) {\n      const cursorJob = findByJob(MOVE_CURSOR_JOB, this.assignments);\n\n      if (isSecondTouch && cursorJob && cursorJob.framesUntilGrab < 0) {\n        // The second touch is happening after grab activated, so assign this touch to first pinch.\n        const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n        first.clientX = touch.clientX;\n        first.clientY = touch.clientY;\n      } else {\n        // Second or third touch, but third touch only if not pinching\n        if (isSecondTouch) {\n          // The second touch is happening before the grab activated, so re-assign the first\n          // to the first pinch, and effectively cancel the grab.\n          const previousAssignment = this.assignments[0];\n          unassign(previousAssignment.touch, previousAssignment.job, this.assignments);\n          const first = assign(previousAssignment.touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = previousAssignment.clientX;\n          first.clientY = previousAssignment.clientY;\n        }\n\n        const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n\n        if (!first) {\n          const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = touch.clientX;\n          first.clientY = touch.clientY;\n          return;\n        } else {\n          const second = assign(touch, SECOND_PINCHER_JOB, this.assignments);\n          second.clientX = touch.clientX;\n          second.clientY = touch.clientY;\n\n          const initialDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n\n          this.pinch = {\n            initialDistance,\n            currentDistance: initialDistance,\n            delta: 0\n          };\n        }\n      }\n    }\n\n    if (this.pendingTap.maxTouchCount === 0 && this.assignments.length > 0) {\n      this.pendingTap.startedAt = performance.now();\n    }\n\n    this.pendingTap.maxTouchCount = Math.max(this.pendingTap.maxTouchCount, this.assignments.length);\n  }\n\n  process(event) {\n    switch (event.type) {\n      case \"touchstart\":\n        for (const touch of event.changedTouches) {\n          this.start(touch);\n        }\n        break;\n      case \"touchmove\":\n        for (const touch of event.touches) {\n          this.move(touch);\n        }\n        break;\n      case \"touchend\":\n      case \"touchcancel\":\n        for (const touch of event.changedTouches) {\n          this.end(touch);\n        }\n        break;\n    }\n  }\n\n  write(frame) {\n    if (this.pinch) {\n      this.pinch.delta = 0;\n    }\n    const cameraMover =\n      jobIsAssigned(MOVE_CAMERA_JOB, this.assignments) && findByJob(MOVE_CAMERA_JOB, this.assignments);\n    if (cameraMover) {\n      cameraMover.delta[0] = 0;\n      cameraMover.delta[1] = 0;\n    }\n\n    this.events.forEach(event => {\n      this.process(event);\n    });\n    while (this.events.length) {\n      this.events.pop();\n    }\n\n    const path = paths.device.touchscreen;\n    const hasCursorJob = jobIsAssigned(MOVE_CURSOR_JOB, this.assignments);\n    const hasCameraJob = jobIsAssigned(MOVE_CAMERA_JOB, this.assignments);\n\n    if (hasCursorJob || hasCameraJob) {\n      frame.setValueType(path.isTouching, true);\n\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments) || findByJob(MOVE_CAMERA_JOB, this.assignments);\n      frame.setPose(path.cursorPose, assignment.cursorPose);\n      this.lastPose = assignment.cursorPose;\n    } else if (this.lastPose) {\n      // TODO We want to be able to \"hover\" on things with the touchscreen so we keep the cursor at its last know position\n      // This is not ideal but its also unclear what the \"right\" interaction for this should be on a touchscreen.\n      frame.setPose(path.cursorPose, this.lastPose);\n    }\n\n    frame.setValueType(path.isTouchingGrabbable, false);\n\n    if (hasCursorJob) {\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments);\n      frame.setValueType(path.isTouchingGrabbable, assignment.framesUntilGrab <= 0);\n      assignment.framesUntilGrab--;\n\n      if (assignment.framesUntilUnassign >= 0) {\n        if (assignment.framesUntilUnassign === 0) {\n          unassign(assignment.touch, assignment.job, this.assignments);\n        }\n\n        assignment.framesUntilUnassign--;\n      }\n    }\n\n    if (hasCameraJob) {\n      const delta = findByJob(MOVE_CAMERA_JOB, this.assignments).delta;\n      frame.setVector2(path.touchCameraDelta, delta[0] / this.canvas.clientWidth, delta[1] / this.canvas.clientHeight);\n    }\n\n    frame.setValueType(path.pinch.delta, this.pinch.delta);\n    frame.setValueType(path.pinch.initialDistance, this.pinch.initialDistance);\n    frame.setValueType(path.pinch.currentDistance, this.pinch.currentDistance);\n\n    if (this.tapIndexToWriteNextFrame && this.tapIndexToWriteNextFrame < TAP_PATHS.length) {\n      // write to tap-X path if we had an X-fingered tap\n      frame.setValueType(TAP_PATHS[this.tapIndexToWriteNextFrame - 1], true);\n    }\n\n    this.tapIndexToWriteNextFrame = 0;\n\n    frame.setValueType(path.anything, this.assignments.length !== 0);\n  }\n}\n","import { Pose } from \"../pose\";\nimport { angleTo4Direction } from \"../../../utils/dpad\";\n\nexport const xforms = {\n  noop: function() {},\n  copy: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.value));\n  },\n  scale: function(scalar) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        frame.setValueType(dest.value, frame.get(src.value) * scalar);\n      }\n    };\n  },\n  scaleExp: function(scalar, exp = 1) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        if (exp === 1) {\n          frame.setValueType(dest.value, frame.get(src.value) * scalar);\n        } else {\n          frame.setValueType(dest.value, Math.pow(frame.get(src.value), exp) * scalar);\n        }\n      }\n    };\n  },\n  deadzone: function(deadzoneSize) {\n    return function deadzone(frame, src, dest) {\n      frame.setValueType(dest.value, Math.abs(frame.get(src.value)) < deadzoneSize ? 0 : frame.get(src.value));\n    };\n  },\n  split_vec2: function(frame, src, dest) {\n    const value = frame.get(src.value);\n    if (value !== undefined) {\n      frame.setValueType(dest.x, value[0]);\n      frame.setValueType(dest.y, value[1]);\n    }\n  },\n  compose_vec2: function(frame, src, dest) {\n    const x = frame.get(src.x);\n    const y = frame.get(src.y);\n    if (x !== undefined && y !== undefined) {\n      frame.setVector2(dest.value, x, y);\n    }\n  },\n  negate: function(frame, src, dest) {\n    frame.setValueType(dest.value, -frame.get(src.value));\n  },\n  copyIfFalse: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? undefined : frame.get(src.value));\n  },\n  copyIfTrue: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? frame.get(src.value) : undefined);\n  },\n  copyVec2IfTrue: function(frame, src, dest) {\n    if (frame.get(src.bool)) {\n      const v2 = frame.get(src.value);\n      frame.setVector2(dest.value, v2[0], v2[1]);\n    }\n  },\n  zeroIfDefined: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) !== undefined ? 0 : frame.get(src.value));\n  },\n  true: function(frame, src, dest) {\n    frame.setValueType(dest.value, true);\n  },\n  rising: function rising(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, frame.get(src.value) && prevState === false);\n    return !!frame.get(src.value);\n  },\n  risingWithFrameDelay: function(n) {\n    return function risingWithFrameDelay(frame, src, dest, state = { values: new Array(n) }) {\n      frame.setValueType(dest.value, state.values.shift());\n      state.values.push(frame.get(src.value) && !state.prev);\n      state.prev = frame.get(src.value);\n      return state;\n    };\n  },\n  falling: function falling(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, !frame.get(src.value) && prevState);\n    return !!frame.get(src.value);\n  },\n  vec2Zero: function(frame, _, dest) {\n    frame.setVector2(dest.value, 0, 0);\n  },\n  poseFromCameraProjection: function() {\n    const pose = new Pose();\n    return function poseFromCameraProjection(frame, src, dest) {\n      const camera = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n      const value = frame.get(src.value);\n      frame.setPose(dest.value, pose.fromCameraProjection(camera, value[0], value[1]));\n    };\n  },\n  vec2dpad: function(deadzoneRadius, invertX = false, invertY = false) {\n    const deadzoneRadiusSquared = deadzoneRadius * deadzoneRadius;\n\n    return function vec2dpad(frame, src, dest) {\n      if (!frame.get(src.value)) return;\n      const [x, y] = frame.get(src.value);\n      const inCenter = x * x + y * y < deadzoneRadiusSquared;\n      const direction = inCenter ? \"center\" : angleTo4Direction(Math.atan2(invertX ? -x : x, invertY ? -y : y));\n      if (!dest[direction]) return;\n      frame.setValueType(dest[direction], true);\n    };\n  },\n  always: function(constValue) {\n    return function always(frame, _, dest) {\n      frame.setValueType(dest.value, constValue);\n    };\n  },\n  wasd_to_vec2: function(frame, { w, a, s, d }, { vec2 }) {\n    let x = 0;\n    let y = 0;\n    if (frame.get(a)) x -= 1;\n    if (frame.get(d)) x += 1;\n    if (frame.get(w)) y += 1;\n    if (frame.get(s)) y -= 1;\n    frame.setVector2(vec2, x, y);\n  },\n  add_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      frame.setVector2(dest.value, first[0] + second[0], first[1] + second[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  max_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      const max =\n        first[0] * first[0] + first[1] * first[1] > second[0] * second[0] + second[1] * second[1] ? first : second;\n      frame.setVector2(dest.value, max[0], max[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  normalize_vec2: function(frame, src, dest) {\n    const vec2 = frame.get(src.value);\n    if (vec2) {\n      if (vec2[0] === 0 && vec2[0] === 0) {\n        frame.setVector2(dest.value, vec2[0], vec2[1]);\n      } else {\n        const l = Math.sqrt(vec2[0] * vec2[0] + vec2[1] * vec2[1]);\n        frame.setVector2(dest.value, vec2[0] / l, vec2[1] / l);\n      }\n    }\n  },\n  all: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (!frame.get(path)) {\n        frame.setValueType(dest.value, false);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, true);\n  },\n  any: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (frame.get(path)) {\n        frame.setValueType(dest.value, true);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, false);\n  },\n  touch_axis_scroll(scale = 1, snap_to) {\n    return function touch_axis_scroll(frame, src, dest, state = { value: 0, touching: false }) {\n      if (snap_to === undefined || Math.abs(frame.get(src.value) - state.value) >= snap_to) {\n        frame.setValueType(\n          dest.value,\n          state.touching && frame.get(src.touching) ? scale * (frame.get(src.value) - state.value) : 0\n        );\n      }\n\n      state.value = frame.get(src.value);\n      state.touching = frame.get(src.touching);\n\n      return state;\n    };\n  },\n  diff_vec2: function diff_vec2(frame, src, dest, state = [0, 0]) {\n    const v2 = frame.get(src.value);\n    if (v2) {\n      frame.setVector2(dest.value, v2[0] - state[0], v2[1] - state[1]);\n      state[0] = v2[0];\n      state[1] = v2[1];\n    }\n    return state;\n  },\n  invert_vec2_if_preference(preference) {\n    return function invert_vec2_if_preference(frame, src, dest) {\n      const vec2 = frame.get(src.value);\n      if (vec2) {\n        const invert =\n          window.APP &&\n          window.APP.store &&\n          window.APP.store.state &&\n          window.APP.store.state.preferences &&\n          (window.APP.store.state.preferences[preference] ||\n            window.APP.store.state.preferences[preference] === undefined);\n        const oneOrMinusOne = invert ? -1 : 1;\n        frame.setVector2(dest.value, vec2[0] * oneOrMinusOne, vec2[1] * oneOrMinusOne);\n      }\n    };\n  }\n};\n","export function angleTo4Direction(angle) {\n  angle = (angle * THREE.MathUtils.RAD2DEG + 180 + 45) % 360;\n  if (angle > 0 && angle < 90) {\n    return \"north\";\n  } else if (angle >= 90 && angle < 180) {\n    return \"west\";\n  } else if (angle >= 180 && angle < 270) {\n    return \"south\";\n  } else {\n    return \"east\";\n  }\n}\n\nexport function angleTo8Direction(angle) {\n  angle = (angle * THREE.MathUtils.RAD2DEG + 180 + 45) % 360;\n  let direction = \"\";\n  if ((angle >= 0 && angle < 120) || angle >= 330) {\n    direction += \"north\";\n  }\n  if (angle >= 150 && angle < 300) {\n    direction += \"south\";\n  }\n  if (angle >= 60 && angle < 210) {\n    direction += \"west\";\n  }\n  if ((angle >= 240 && angle < 360) || angle < 30) {\n    direction += \"east\";\n  }\n  return direction;\n}\n","export const addSetsToBindings = mapping => {\n  for (const setName in mapping) {\n    for (const binding of mapping[setName]) {\n      if (!binding.sets) {\n        binding.sets = [];\n      }\n      binding.sets.push(setName);\n    }\n  }\n  return mapping;\n};\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// import { Pose } from \"../pose\";\n\nconst wasd_vec2 = \"/var/mouse-and-keyboard/wasd_vec2\";\nconst keyboardCharacterAcceleration = \"/var/mouse-and-keyboard/keyboardCharacterAcceleration\";\nconst arrows_vec2 = \"/var/mouse-and-keyboard/arrows_vec2\";\nconst togglePenWithRMB = \"/vars/mouse-and-keyboard/drop_pen_with_RMB\";\nconst togglePenWithEsc = \"/vars/mouse-and-keyboard/drop_pen_with_esc\";\nconst togglePenWithP = \"/vars/mouse-and-keyboard/drop_pen_with_p\";\nconst togglePenWithHud = \"/vars/mouse-and-keyboard/drop_pen_with_hud\";\nconst togglePen = \"/vars/mouse-and-keyboard/togglePen\";\nconst startInspectingViaMouse = \"/vars/mouse-and-keyboard/startInspectingViaMouse\";\nconst startInspectingViaKeyboard = \"/vars/mouse-and-keyboard/startInspectingViaKeyboard\";\nconst stopInspectingViaKeyboard = \"/vars/mouse-and-keyboard/stopInspectingViaKeyboard\";\nconst stopInspectingViaKeyboardFocus = \"/vars/mouse-and-keyboard/stopInspectingViaKeyboardFocus\";\nconst stopInspectingSelf = \"/vars/mouse-and-keyboard/stopInspectingSelf\";\n\nconst qs = new URLSearchParams(location.search);\nconst inspectZoomSpeed = parseFloat(qs.get(\"izs\")) || -10.0;\n\nconst k = name => {\n  return `/keyboard-mouse-user/keyboard-var/${name}`;\n};\n\nexport const keyboardMouseUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.always(true)\n    },\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.always(false)\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: keyboardCharacterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.dCharSpeed },\n      xform: xforms.scale(-0.3)\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.camera.exitMirror },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"g\") },\n      dest: { value: paths.actions.toggleFly },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"`\") },\n      dest: { value: paths.actions.toggleUI },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: togglePenWithP },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePenWithHud },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithHud, togglePenWithP],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.smartMouse.cursorPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.mouse.coords },\n      dest: { value: \"/var/mouseCoordsDelta\" },\n      xform: xforms.diff_vec2\n    },\n    {\n      src: { value: \"/var/mouseCoordsDelta\" },\n      dest: { x: \"/var/mouseCoordsX\", y: \"/var/mouseCoordsY\" },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: \"/var/mouseCoordsX\" },\n      dest: { value: \"/var/mouseCoordsXScaled\" },\n      xform: xforms.scale(-Math.PI)\n    },\n    {\n      src: { value: \"/var/mouseCoordsY\" },\n      dest: { value: \"/var/mouseCoordsYScaled\" },\n      xform: xforms.scale((2 * Math.PI) / 3)\n    },\n    {\n      src: { x: \"/var/mouseCoordsXScaled\", y: \"/var/mouseCoordsYScaled\" },\n      dest: { value: \"/var/actions/cameraDelta\" },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: \"/var/actions/cameraDelta\",\n        bool: paths.device.smartMouse.shouldMoveCamera\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.copyVec2IfTrue\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/control+1\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/control+2\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/control+3\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/control+4\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/control+5\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/control+6\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/control+7\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/control+8\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling,\n      priority: 100\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"o\") },\n      dest: { value: paths.actions.nextCameraMode },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/notcontrol+1\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+1\" },\n      dest: { value: paths.actions.spawnEmoji0 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/notcontrol+2\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+2\" },\n      dest: { value: paths.actions.spawnEmoji1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/notcontrol+3\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+3\" },\n      dest: { value: paths.actions.spawnEmoji2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/notcontrol+4\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+4\" },\n      dest: { value: paths.actions.spawnEmoji3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/notcontrol+5\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+5\" },\n      dest: { value: paths.actions.spawnEmoji4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/notcontrol+6\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+6\" },\n      dest: { value: paths.actions.spawnEmoji5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/notcontrol+7\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+7\" },\n      dest: { value: paths.actions.spawnEmoji6 },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"i\") },\n      dest: { value: paths.actions.startInspectingSelf },\n      xform: xforms.rising\n    }\n\n    // Helpful bindings for debugging hands in 2D\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.rightHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(0.2, 1.3, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // },\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.leftHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(-0.2, 1.4, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // }\n  ],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/shift+q\" },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/shift+q\" },\n      dest: { value: paths.actions.cursor.right.penPrevColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/shift+e\" },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/shift+e\" },\n      dest: { value: paths.actions.cursor.right.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/notshift+q\" },\n      xform: xforms.copyIfFalse,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/notshift+q\" },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/notshift+e\" },\n      xform: xforms.copyIfFalse,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/notshift+e\" },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: \"/var/cursorScalePenTipWheel\" },\n      xform: xforms.copy,\n      priority: 200\n    },\n    {\n      src: { value: \"/var/cursorScalePenTipWheel\" },\n      dest: { value: paths.actions.cursor.right.scalePenTip },\n      xform: xforms.scale(0.03)\n    },\n    {\n      src: { value: paths.device.mouse.buttonRight },\n      dest: { value: togglePenWithRMB },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: togglePenWithEsc },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithRMB, togglePenWithEsc, togglePenWithP, togglePenWithHud],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"z\")\n      },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      priority: 1001,\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 200\n    }\n  ],\n\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: paths.actions.cursor.right.scaleGrabbedGrabbable },\n      xform: xforms.noop,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithShift\")\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithoutShift\")\n      },\n      xform: xforms.copyIfFalse,\n      priority: 1\n    },\n    {\n      src: {\n        value: k(\"wheelWithoutShift\")\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: paths.actions.cursor.right.scaleGrabbedGrabbable },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.transformModifier },\n      xform: xforms.copy,\n      priority: 1\n    }\n  ],\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.mouse.buttonRight },\n      dest: { value: startInspectingViaMouse },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"f\") },\n      dest: { value: startInspectingViaKeyboard },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: [startInspectingViaMouse, startInspectingViaKeyboard],\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.any,\n      priority: 201\n    }\n  ],\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(-0.3),\n      priority: 1\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/control+1\" },\n      xform: xforms.copyIfTrue,\n      priority: 1001\n    },\n    {\n      src: { value: \"/var/control+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/control+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/control+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/control+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/control+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/control+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/control+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/control+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.inspecting]: [\n    {\n      src: { value: paths.device.keyboard.key(\"space\") },\n      dest: { value: k(\"space-rising\") },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        paths.device.keyboard.key(\"Escape\"),\n        paths.device.keyboard.key(\"w\"),\n        paths.device.keyboard.key(\"a\"),\n        paths.device.keyboard.key(\"s\"),\n        paths.device.keyboard.key(\"d\"),\n        paths.device.keyboard.key(\"q\"),\n        paths.device.keyboard.key(\"e\"),\n        k(\"space-rising\")\n      ],\n      dest: { value: stopInspectingViaKeyboard },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.inspectZoom },\n      xform: xforms.scale(inspectZoomSpeed),\n      priority: 1\n    },\n    {\n      src: { value: paths.device.mouse.movementXY },\n      dest: { x: \"/var/movementX\", y: \"/var/movementY\" },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { bool: paths.device.mouse.buttonMiddle, value: \"/var/movementY\" },\n      dest: { value: \"/var/middle-mouse-move-y\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/middle-mouse-move-y\" },\n      dest: { value: paths.actions.inspectPanY },\n      xform: xforms.scale(0.001)\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"f\") },\n      dest: { value: stopInspectingViaKeyboardFocus },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"i\") },\n      dest: { value: stopInspectingSelf },\n      xform: xforms.rising\n    },\n    {\n      src: [stopInspectingViaKeyboard, stopInspectingViaKeyboardFocus, stopInspectingSelf],\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.any\n    }\n  ],\n  [sets.debugUserInput]: [\n    {\n      src: { value: paths.device.keyboard.key(\"m\") },\n      dest: { value: paths.actions.debugUserInput.describeCurrentMasks },\n      xform: xforms.rising,\n      priority: 10\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst zero = \"/vars/touchscreen/zero\";\nconst forward = \"/vars/touchscreen/pinchDeltaForward\";\nconst touchCamDeltaMaybeInverted = \"vars/touchscreen/touchCameraDeltaMaybeInverted\";\nconst touchCamDelta = \"vars/touchscreen/touchCameraDelta\";\nconst touchCamDeltaX = \"vars/touchscreen/touchCameraDelta/x\";\nconst touchCamDeltaY = \"vars/touchscreen/touchCameraDelta/y\";\nconst touchCamDeltaXScaled = \"vars/touchscreen/touchCameraDelta/x/scaled\";\nconst touchCamDeltaYScaled = \"vars/touchscreen/touchCameraDelta/y/scaled\";\nconst gyroCamDelta = \"vars/gyro/gyroCameraDelta\";\nconst gyroCamDeltaXScaled = \"vars/gyro/gyroCameraDelta/x/scaled\";\nconst gyroCamDeltaYScaled = \"vars/gyro/gyroCameraDelta/y/scaled\";\nconst togglePen = \"/vars/touchscreen/togglePen\";\n\nexport const touchscreenUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: paths.device.touchscreen.pinch.delta },\n      dest: { value: forward },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: { value: paths.device.touchscreen.tap2 },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.copy\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: { x: zero, y: forward },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.touchscreen.cursorPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.touchCameraDelta },\n      dest: { x: touchCamDeltaX, y: touchCamDeltaY },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: touchCamDeltaX },\n      dest: { value: touchCamDeltaXScaled },\n      xform: xforms.scale(-Math.PI)\n    },\n    {\n      src: { value: touchCamDeltaY },\n      dest: { value: touchCamDeltaYScaled },\n      xform: xforms.scale(-Math.PI / 2)\n    },\n    {\n      src: { x: touchCamDeltaXScaled, y: touchCamDeltaYScaled },\n      dest: { value: touchCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: touchCamDelta },\n      dest: { value: touchCamDeltaMaybeInverted },\n      xform: xforms.invert_vec2_if_preference(\"invertTouchscreenCameraMove\")\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaX },\n      dest: { value: gyroCamDeltaXScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaY },\n      dest: { value: gyroCamDeltaYScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { x: gyroCamDeltaYScaled, y: gyroCamDeltaXScaled },\n      dest: { value: gyroCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: touchCamDeltaMaybeInverted,\n        second: gyroCamDelta\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.add_vec2\n    },\n    {\n      src: { value: touchCamDeltaMaybeInverted },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.risingWithFrameDelay(5),\n      priority: 2\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 3\n    }\n  ],\n\n  [sets.inspecting]: [\n    {\n      src: { value: paths.device.touchscreen.pinch.delta },\n      dest: { value: paths.actions.inspectZoom },\n      xform: xforms.scale(0.025),\n      priority: 1\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const keyboardDebuggingBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst name = \"/touch/var/\";\n\nconst leftButton = paths.device.leftOculusTouch.button;\nconst leftAxis = paths.device.leftOculusTouch.axis;\nconst leftPose = paths.device.leftOculusTouch.pose;\nconst rightButton = paths.device.rightOculusTouch.button;\nconst rightAxis = paths.device.rightOculusTouch.axis;\nconst rightPose = paths.device.rightOculusTouch.pose;\n\nconst wakeLeft = `${name}left/wake`;\nconst wakeRight = `${name}right/wake`;\nconst leftJoyXDeadzoned = `${name}left/joy/x/deadzoned`;\nconst leftJoyYDeadzoned = `${name}left/joy/y/deadzoned`;\nconst scaledLeftJoyX = `${name}left/scaledJoyX`;\nconst scaledLeftJoyY = `${name}left/scaledJoyY`;\nconst cursorDrop2 = `${name}right/cursorDrop2`;\nconst cursorDrop1 = `${name}right/cursorDrop1`;\nconst leftCursorDrop2 = `${name}left/cursorDrop2`;\nconst leftCursorDrop1 = `${name}left/cursorDrop1`;\nconst rightHandDrop2 = `${name}right/rightHandDrop2`;\nconst rightGripRisingGrab = `${name}right/grip/RisingGrab`;\nconst rightTriggerRisingGrab = `${name}right/trigger/RisingGrab`;\nconst leftGripRisingGrab = `${name}left/grip/RisingGrab`;\nconst leftTriggerRisingGrab = `${name}left/trigger/RisingGrab`;\nconst rightDpadNorth = `${name}rightDpad/north`;\nconst rightDpadSouth = `${name}rightDpad/south`;\nconst rightDpadEast = `${name}rightDpad/east`;\nconst rightDpadWest = `${name}rightDpad/west`;\nconst rightDpadCenter = `${name}rightDpad/center`;\nconst rightJoy = `${name}right/joy`;\nconst rightJoyY1 = `${name}right/joyY1`;\nconst rightJoyY2 = `${name}right/joyY2`;\nconst rightJoyYDeadzoned = `${name}right/joy/y/deadzoned`;\nconst leftDpadNorth = `${name}leftDpad/north`;\nconst leftDpadSouth = `${name}leftDpad/south`;\nconst leftDpadEast = `${name}leftDpad/east`;\nconst leftDpadWest = `${name}leftDpad/west`;\nconst leftDpadCenter = `${name}leftDpad/center`;\nconst leftJoy = `${name}left/joy`;\nconst oculusTouchCharacterAcceleration = `${name}characterAcceleration`;\nconst keyboardCharacterAcceleration = \"/var/keyboard/characterAcceleration\";\nconst characterAcceleration = \"/var/oculus-touch/nonNormalizedCharacterAcceleration\";\nconst wasd_vec2 = \"/var/keyboard/wasd_vec2\";\nconst arrows_vec2 = \"/var/keyboard/arrows_vec2\";\nconst keyboardBoost = \"/var/keyboard-oculus/boost\";\nconst rightBoost = \"/var/right-oculus/boost\";\nconst leftBoost = \"/var/left-oculus/boost\";\nconst rightTouchSnapRight = `${name}/right/snap-right`;\nconst rightTouchSnapLeft = `${name}/right/snap-left`;\nconst keyboardSnapRight = `${name}/keyboard/snap-right`;\nconst keyboardSnapLeft = `${name}/keyboard/snap-left`;\n\nconst lowerButtons = `${name}buttons/lower`;\nconst upperButtons = `${name}buttons/upper`;\n\nconst ensureFrozenViaButtons = `${name}buttons/ensureFrozen`;\nconst ensureFrozenViaKeyboard = `${name}keyboard/ensureFrozen`;\n\nconst thawViaButtons = `${name}buttons/thaw`;\nconst thawViaKeyboard = `${name}keyboard/thaw`;\n\nconst v = s => {\n  return \"/oculus-touch-user-vars/\" + s;\n};\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\n\nexport const oculusTouchUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.leftOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.rightOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaButtons, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaButtons, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").touched, leftButton(\"y\").touched, leftButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rightButton(\"a\").touched, rightButton(\"b\").touched, rightButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: leftAxis(\"joyX\"),\n        y: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: leftJoy\n      },\n      dest: {\n        north: leftDpadNorth,\n        south: leftDpadSouth,\n        east: leftDpadEast,\n        west: leftDpadWest,\n        center: leftDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY2 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rightAxis(\"joyX\"),\n        y: rightJoyY1\n      },\n      dest: {\n        value: rightJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rightJoy\n      },\n      dest: {\n        north: rightDpadNorth,\n        south: rightDpadSouth,\n        east: rightDpadEast,\n        west: rightDpadWest,\n        center: rightDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: rightTouchSnapRight\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapRight, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").pressed, rightButton(\"a\").pressed],\n      dest: { value: lowerButtons },\n      xform: xforms.any\n    },\n    {\n      src: [leftButton(\"y\").pressed, rightButton(\"b\").pressed],\n      dest: { value: upperButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: ensureFrozenViaButtons },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: thawViaButtons },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: rightTouchSnapLeft\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapLeft, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyYDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyY\n      },\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: leftAxis(\"joyX\")\n      },\n      dest: {\n        value: leftJoyXDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyXDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyX\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        x: scaledLeftJoyX,\n        y: scaledLeftJoyY\n      },\n      dest: { value: oculusTouchCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: oculusTouchCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        value: characterAcceleration,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"y\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"b\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"thumbStick\").pressed\n      },\n      dest: {\n        value: paths.actions.nextCameraMode\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: rightButton(\"thumbStick\").pressed\n      },\n      dest: {\n        value: paths.actions.toggleFly\n      },\n      xform: xforms.rising\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.cursor.left.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [\n        leftButton(\"y\").pressed,\n        leftButton(\"x\").pressed,\n        leftButton(\"trigger\").pressed,\n        leftButton(\"grip\").pressed\n      ],\n      dest: { value: wakeLeft },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeLeft },\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        rightButton(\"b\").pressed,\n        rightButton(\"a\").pressed,\n        rightButton(\"trigger\").pressed,\n        rightButton(\"grip\").pressed\n      ],\n      dest: { value: wakeRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeRight },\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoveringOnUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.leftCursorHoveringOnVideo]: [\n    {\n      src: { value: leftAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.rightCursorHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftCursorHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.inspecting]: [\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: leftDpadEast,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: leftDpadWest,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"y\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"x\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftCursorHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n  [sets.leftCursorHoldingUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftCursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoldingInteractable]: [\n    {\n      src: { value: leftAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftCursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [leftCursorDrop1, leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n  [sets.leftCursorHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: leftButton(\"y\").pressed },\n      dest: { value: paths.actions.cursor.left.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: {\n        value: rightHandDrop2\n      },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [rightHandDrop2],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: {\n        value: rightJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rightJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 2\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightButton(\"a\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftCursorHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst leftButton = paths.device.webxr.left.button;\nconst leftAxis = paths.device.webxr.left.axis;\nconst leftPose = paths.device.webxr.left.pose;\nconst rightButton = paths.device.webxr.right.button;\nconst rightAxis = paths.device.webxr.right.axis;\nconst rightPose = paths.device.webxr.right.pose;\n\nconst v = path => \"/webxr/var/\" + path;\nconst wakeLeft = v(\"left/wake\");\nconst wakeRight = v(\"right/wake\");\nconst leftJoyXDeadzoned = v(\"left/joy/x/deadzoned\");\nconst leftJoyYDeadzoned = v(\"left/joy/y/deadzoned\");\nconst scaledLeftJoyX = v(\"left/scaledJoyX\");\nconst scaledLeftJoyY = v(\"left/scaledJoyY\");\nconst cursorDrop1 = v(\"right/cursorDrop1\");\nconst cursorDrop2 = v(\"right/cursorDrop2\");\nconst cursorDrop3 = v(\"right/cursorDrop3\");\nconst leftCursorDrop2 = v(\"left/cursorDrop2\");\nconst leftCursorDrop1 = v(\"left/cursorDrop1\");\nconst rightHandDrop2 = v(\"right/rightHandDrop2\");\nconst rightGripRisingGrab = v(\"right/grip/RisingGrab\");\nconst leftGripRisingGrab = v(\"left/grip/RisingGrab\");\nconst rightDpadNorth = v(\"rightDpad/north\");\nconst rightDpadSouth = v(\"rightDpad/south\");\nconst rightDpadEast = v(\"rightDpad/east\");\nconst rightDpadWest = v(\"rightDpad/west\");\nconst rightDpadCenter = v(\"rightDpad/center\");\nconst rightJoy = v(\"right/joy\");\nconst rightJoyY1 = v(\"right/joyY1\");\nconst rightJoyYDeadzoned = v(\"right/joy/y/deadzoned\");\nconst leftDpadNorth = v(\"leftDpad/north\");\nconst leftDpadSouth = v(\"leftDpad/south\");\nconst leftDpadEast = v(\"leftDpad/east\");\nconst leftDpadWest = v(\"leftDpad/west\");\nconst leftDpadCenter = v(\"leftDpad/center\");\nconst leftJoy = v(\"left/joy\");\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\nconst rightBoost = v(\"right/boost\");\nconst leftBoost = v(\"left/boost\");\nconst lowerButtons = v(\"buttons/lower\");\nconst upperButtons = v(\"buttons/upper\");\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\nconst touchpad = v(\"touchpad\");\nconst touchpadRising = v(\"touchpad/rising\");\nconst dpadNorth = v(\"dpadNorth\");\nconst dpadSouth = v(\"dpadSouth\");\nconst dpadEast = v(\"dpadEast\");\nconst dpadWest = v(\"dpadWest\");\nconst dpadCenter = v(\"dpadCenter\");\nconst dpadCenterStrip = v(\"dpadCenterStrip\");\nconst snapRotateRight1 = v(\"snapRotateRight1\");\nconst snapRotateRight2 = v(\"snapRotateRight2\");\nconst snapRotateLeft1 = v(\"snapRotateLeft1\");\nconst snapRotateLeft2 = v(\"snapRotateLeft2\");\nconst centerStripPressed = v(\"centerStripPressed\");\nconst touchpadReleased = v(\"touchpadReleased\");\nconst lowerButtonsReleased = v(\"lowerButtonsReleased\");\n\nexport const webXRUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.webxr.left.matrix },\n      dest: { value: paths.actions.leftHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.webxr.right.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.grip.pressed },\n      dest: { value: leftGripPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.grip.pressed },\n      dest: { value: leftGripPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftGripPressed1 },\n      dest: { value: paths.actions.leftHand.middleRingPinky },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton.a.touched, leftButton.b.touched, leftButton.thumbStick.touched],\n      dest: { value: paths.actions.leftHand.thumb },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftButton.trigger.pressed },\n      dest: { value: leftTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.trigger.pressed },\n      dest: { value: leftTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: { value: paths.actions.leftHand.index },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.grip.pressed },\n      dest: { value: rightGripPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.grip.pressed },\n      dest: { value: rightGripPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightGripPressed1 },\n      dest: { value: paths.actions.rightHand.middleRingPinky },\n      xform: xforms.copy\n    },\n    {\n      src: [rightButton.a.touched, rightButton.b.touched, rightButton.thumbStick.touched],\n      dest: { value: paths.actions.rightHand.thumb },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton.trigger.pressed },\n      dest: { value: rightTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.trigger.pressed },\n      dest: { value: rightTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: { value: paths.actions.rightHand.index },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: leftAxis.joyX,\n        y: leftAxis.joyY\n      },\n      dest: { value: leftJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: leftJoy },\n      dest: {\n        north: leftDpadNorth,\n        south: leftDpadSouth,\n        east: leftDpadEast,\n        west: leftDpadWest,\n        center: leftDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: rightJoyY1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rightAxis.joyX,\n        y: rightJoyY1\n      },\n      dest: { value: rightJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: rightJoy },\n      dest: {\n        north: rightDpadNorth,\n        south: rightDpadSouth,\n        east: rightDpadEast,\n        west: rightDpadWest,\n        center: rightDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: { value: rightDpadEast },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [leftButton.a.pressed, rightButton.a.pressed],\n      dest: { value: lowerButtons },\n      xform: xforms.any\n    },\n    {\n      src: [leftButton.b.pressed, rightButton.b.pressed],\n      dest: { value: upperButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightDpadWest },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftAxis.joyY },\n      dest: { value: leftJoyYDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: scaledLeftJoyY },\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\n    },\n    {\n      src: { value: leftAxis.joyX },\n      dest: { value: leftJoyXDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: leftJoyXDeadzoned },\n      dest: { value: scaledLeftJoyX },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        x: scaledLeftJoyX,\n        y: scaledLeftJoyY\n      },\n      dest: { value: characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: characterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.b.pressed },\n      dest: { value: leftBoost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.b.pressed },\n      dest: { value: rightBoost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.thumbStick.pressed },\n      dest: { value: paths.actions.nextCameraMode },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightButton.thumbStick.pressed },\n      dest: { value: paths.actions.toggleFly },\n      xform: xforms.rising\n    },\n    {\n      src: [leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.cursor.left.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftButton.b.pressed, leftButton.a.pressed, leftButton.trigger.pressed, leftButton.grip.pressed],\n      dest: { value: wakeLeft },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeLeft },\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [rightButton.b.pressed, rightButton.a.pressed, rightButton.trigger.pressed, rightButton.grip.pressed],\n      dest: { value: wakeRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeRight },\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        x: rightAxis.touchpadX,\n        y: rightAxis.touchpadY\n      },\n      dest: { value: touchpad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: touchpad\n      },\n      dest: {\n        north: dpadNorth,\n        south: dpadSouth,\n        east: dpadEast,\n        west: dpadWest,\n        center: dpadCenter\n      },\n      xform: xforms.vec2dpad(0.3)\n    },\n    {\n      src: [dpadNorth, dpadCenter, dpadSouth],\n      dest: { value: dpadCenterStrip },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: dpadCenterStrip,\n        bool: rightButton.touchpad.pressed\n      },\n      dest: { value: centerStripPressed },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: [centerStripPressed, lowerButtons],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton.touchpad.pressed },\n      dest: { value: touchpadReleased },\n      xform: xforms.falling\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: lowerButtonsReleased },\n      xform: xforms.falling\n    },\n    {\n      src: [touchpadReleased, lowerButtonsReleased],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton.touchpad.pressed },\n      dest: { value: touchpadRising },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: dpadEast,\n        bool: touchpadRising\n      },\n      dest: { value: snapRotateRight1 },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadWest,\n        bool: touchpadRising\n      },\n      dest: { value: snapRotateLeft1 },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rightDpadEast },\n      dest: { value: snapRotateRight2 },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightDpadWest },\n      dest: { value: snapRotateLeft2 },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [snapRotateRight1, snapRotateRight2],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: [snapRotateLeft1, snapRotateLeft2],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoveringOnUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.leftCursorHoveringOnVideo]: [\n    {\n      src: { value: leftAxis.joyY },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.rightCursorHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftCursorHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.inspecting]: [\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: leftDpadEast },\n      dest: { value: paths.actions.leftHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftDpadWest },\n      dest: { value: paths.actions.leftHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    },\n    {\n      src: { value: leftButton.b.pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftButton.a.pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab, rightTriggerPressed2],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftCursorHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n  [sets.leftCursorHoldingUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftCursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop3 },\n      xform: xforms.falling,\n      priority: 4\n    },\n    {\n      src: [cursorDrop1, cursorDrop2, cursorDrop3],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoldingInteractable]: [\n    {\n      src: { value: leftAxis.joyY },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftCursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [leftCursorDrop1, leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton.b.pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n  [sets.leftCursorHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: leftButton.b.pressed },\n      dest: { value: paths.actions.cursor.left.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightHandDrop2 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [rightHandDrop2],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightDpadEast },\n      dest: { value: paths.actions.rightHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightDpadWest },\n      dest: { value: paths.actions.rightHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: rightJoyYDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rightJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 2\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton.b.pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightButton.a.pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop3 },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n  [sets.leftCursorHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [],\n  [sets.inputFocused]: []\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst v = name => {\n  return `/vive-user/vive-var/${name}`;\n};\n\nconst wakeLeft = `${name}left/wake`;\nconst wakeRight = `${name}right/wake`;\n\nconst lButton = paths.device.vive.left.button;\nconst lAxis = paths.device.vive.left.axis;\nconst lPose = paths.device.vive.left.pose;\nconst lJoy = v(\"left/joy\");\nconst lJoyScaled = v(\"left/joy/scaled\");\nconst lJoyXScaled = v(\"left/joyX/scaled\");\nconst lJoyYScaled = v(\"left/joyY/scaled\");\nconst lJoyYDeadzoned = v(\"left/joyY/deadzoned\");\nconst lTouch = v(\"left/touch\");\nconst lTouchScaled = v(\"left/touch/scaled\");\nconst lTouchXScaled = v(\"left/touchX/scaled\");\nconst lTouchY = v(\"left/touchY\");\nconst lTouchYScaled = v(\"left/touchY/scaled\");\nconst lDpadNorth1 = v(\"left/dpad/north1\");\nconst lDpadSouth1 = v(\"left/dpad/south1\");\nconst lDpadEast1 = v(\"left/dpad/east1\");\nconst lDpadWest1 = v(\"left/dpad/west1\");\nconst lDpadCenter1 = v(\"left/dpad/center1\");\nconst lDpadNorth2 = v(\"left/dpad/north2\");\nconst lDpadSouth2 = v(\"left/dpad/south2\");\nconst lDpadEast2 = v(\"left/dpad/east2\");\nconst lDpadWest2 = v(\"left/dpad/west2\");\nconst lDpadCenter2 = v(\"left/dpad/center2\");\nconst lTriggerFallingStopDrawing = v(\"left/trigger/falling/stopDrawing\");\nconst lGripFallingStopDrawing = v(\"left/grip/falling/stopDrawing\");\nconst lTriggerRisingGrab = v(\"left/trigger/rising/grab\");\nconst lGripRisingGrab = v(\"left/grab/rising/grab\");\nconst lTouchpadRising2 = v(\"left/touchpad/rising2\");\nconst lTouchpadRising1 = v(\"left/touchpad/rising1\");\nconst touchCharacterAcceleration = v(\"left/touch/characterAcceleration\");\nconst lCharacterAcceleration = v(\"left/characterAcceleration\");\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\nconst leftBoost = v(\"left/boost\");\nconst leftUndoDrawing = v(\"left/drawing/undo\");\n\nconst rButton = paths.device.vive.right.button;\nconst rAxis = paths.device.vive.right.axis;\nconst rPose = paths.device.vive.right.pose;\nconst rTouch = v(\"right/touch\");\nconst rJoy = v(\"right/joy\");\nconst rJoyYDeadzoned = v(\"right/joyY/deadzoned\");\nconst rDpadNorth1 = v(\"right/dpad/north1\");\nconst rDpadSouth1 = v(\"right/dpad/south1\");\nconst rDpadEast1 = v(\"right/dpad/east1\");\nconst rDpadWest1 = v(\"right/dpad/west1\");\nconst rDpadCenter1 = v(\"right/dpad/center\");\nconst rDpadNorth2 = v(\"right/dpad/north2\");\nconst rDpadSouth2 = v(\"right/dpad/south2\");\nconst rDpadEast2 = v(\"right/dpad/east2\");\nconst rDpadWest2 = v(\"right/dpad/west2\");\nconst rDpadCenter2 = v(\"right/dpad/center2\");\nconst rDpadCenterStrip = v(\"right/dpad/centerStrip\");\nconst rTouchpadRising = v(\"right/touchpad/rising\");\nconst rTouchpadFalling = v(\"right/touchpad/falling\");\nconst rightBoost = v(\"right/boost\");\nconst rTriggerRisingGrab = v(\"right/trigger/rising/grab\");\nconst rGripRisingGrab = v(\"right/grab/rising/grab\");\nconst rightCursorDrop1 = v(\"right/cursorDrop1\");\nconst rightCursorDrop2 = v(\"right/cursorDrop2\");\nconst leftCursorDrop1 = v(\"left/cursorDrop1\");\nconst leftCursorDrop2 = v(\"left/cursorDrop2\");\nconst rTriggerStopTeleport = v(\"right/trigger/stopTeleport\");\nconst rTouchpadStopTeleport = v(\"right/touchpad/stopTeleport\");\nconst rootForFrozenOverrideWhenHolding = \"rootForFrozenOverrideWhenHolding\";\nconst rightUndoDrawing = v(\"right/drawing/undo\");\n\nconst ensureFrozenViaDpad = v(\"dpad/ensureFrozen\");\nconst ensureFrozenViaKeyboard = v(\"keyboard/ensureFrozen\");\nconst ensureFrozenViaButtons = v(\"buttons/ensureFrozen\");\n\nconst thawViaDpad = v(\"dpad/thaw\");\nconst thawViaKeyboard = v(\"keyboard/thaw\");\nconst thawViaButtons = v(\"buttons/thaw\");\n\nconst freezeButtons = v(\"buttons/freeze\");\nconst inspectButtons = v(\"buttons/inspect\");\n\nconst rSnapRight1 = v(\"right/snap-right\");\nconst rSnapLeft1 = v(\"right/snap-left\");\nconst rSnapRight2 = v(\"right/snap-right2\");\nconst rSnapLeft2 = v(\"right/snap-left2\");\n\nconst k = name => {\n  return `/vive-user/keyboard-var/${name}`;\n};\nconst keyboardSnapRight = k(\"snap-right\");\nconst keyboardSnapLeft = k(\"snap-left\");\nconst keyboardCharacterAcceleration = k(\"characterAcceleration\");\nconst wasd_vec2 = k(\"wasd_vec2\");\nconst arrows_vec2 = k(\"arrows_vec2\");\nconst keyboardBoost = k(\"boost\");\n\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst leftTouchpadPressed1 = v(\"leftTouchpadPressed1\");\nconst leftTouchpadPressed2 = v(\"leftTouchpadPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\nconst leftTouchpadFallingStopTeleport = v(\"leftTouchpadFallingStopTeleport\");\nconst leftTriggerFallingStopTeleport = v(\"leftTriggerFallingStopTeleport\");\nconst leftGripFallingWhileHoldingPen = v(\"leftGripFallingWhileHoldingPen\");\n\nexport const viveUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.vive.left.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.vive.right.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaDpad, ensureFrozenViaKeyboard, ensureFrozenViaButtons],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaDpad, thawViaKeyboard, thawViaButtons],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [lButton(\"touchpad\").touched, lButton(\"primary\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rButton(\"touchpad\").touched, rButton(\"primary\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: lAxis(\"touchX\"),\n        y: lAxis(\"touchY\")\n      },\n      dest: {\n        value: lTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: lTouch\n      },\n      dest: {\n        north: lDpadNorth1,\n        south: lDpadSouth1,\n        east: lDpadEast1,\n        west: lDpadWest1,\n        center: lDpadCenter1\n      },\n      xform: xforms.vec2dpad(0.35)\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rAxis(\"touchX\"),\n        y: rAxis(\"touchY\")\n      },\n      dest: {\n        value: rTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rTouch\n      },\n      dest: {\n        north: rDpadNorth1,\n        south: rDpadSouth1,\n        east: rDpadEast1,\n        west: rDpadWest1,\n        center: rDpadCenter1\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: {\n        x: rAxis(\"joyX\"),\n        y: rAxis(\"joyY\")\n      },\n      dest: {\n        value: rJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rJoy\n      },\n      dest: {\n        north: rDpadNorth2,\n        south: rDpadSouth2,\n        east: rDpadEast2,\n        west: rDpadWest2,\n        center: rDpadCenter2\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: [rDpadNorth1, rDpadSouth1, rDpadCenter1],\n      dest: { value: rDpadCenterStrip },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadRising\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadFalling\n      },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadEast1\n      },\n      dest: {\n        value: rSnapRight1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadEast2\n      },\n      dest: {\n        value: rSnapRight2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapRight1, rSnapRight2, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed, bool: rDpadCenterStrip },\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rTouchpadFalling },\n      dest: { value: thawViaDpad },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadWest1\n      },\n      dest: {\n        value: rSnapLeft1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadWest2\n      },\n      dest: {\n        value: rSnapLeft2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapLeft1, rSnapLeft2, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\")\n      },\n      dest: {\n        value: lTouchXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lTouchY\n      },\n      dest: { value: lTouchYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lTouchXScaled,\n        y: lTouchYScaled\n      },\n      dest: { value: lTouchScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        bool: leftTouchpadPressed2,\n        value: lTouchScaled\n      },\n      dest: { value: touchCharacterAcceleration },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: lAxis(\"joyX\")\n      },\n      dest: {\n        value: lJoyXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lJoyXScaled,\n        y: lJoyYScaled\n      },\n      dest: { value: lJoyScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lJoyScaled,\n        second: touchCharacterAcceleration\n      },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: characterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"primary\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"primary\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: { value: lPose },\n      dest: { value: paths.actions.cursor.left.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: [\n        lButton(\"primary\").pressed,\n        lButton(\"trigger\").pressed,\n        lButton(\"grip\").pressed,\n        lButton(\"touchpad\").pressed\n      ],\n      dest: { value: wakeLeft },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeLeft },\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        rButton(\"primary\").pressed,\n        rButton(\"trigger\").pressed,\n        rButton(\"grip\").pressed,\n        rButton(\"touchpad\").pressed\n      ],\n      dest: { value: wakeRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeRight },\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        rButton(\"secondary\").pressed,\n        lButton(\"secondary\").pressed,\n        rButton(\"bumper\").pressed,\n        lButton(\"bumper\").pressed\n      ],\n      dest: { value: freezeButtons },\n      xform: xforms.any\n    },\n    {\n      src: [rButton(\"primary\").pressed, lButton(\"primary\").pressed],\n      dest: { value: inspectButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: freezeButtons },\n      dest: { value: ensureFrozenViaButtons },\n      xform: xforms.copy\n    },\n    {\n      src: { value: freezeButtons },\n      dest: { value: thawViaButtons },\n      xform: xforms.falling\n    }\n  ],\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed },\n      dest: { value: rTouchpadStopTeleport },\n      xform: xforms.falling\n    },\n    {\n      src: [rTriggerStopTeleport, rTouchpadStopTeleport],\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandTeleporting]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftTriggerFallingStopTeleport, leftTouchpadFallingStopTeleport, leftGripFallingWhileHoldingPen],\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnNothing]: [],\n\n  [sets.leftCursorHoveringOnNothing]: [],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftCursorHoveringOnUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(0.02)\n    }\n  ],\n\n  [sets.leftCursorHoveringOnVideo]: [\n    {\n      src: {\n        value: lAxis(\"touchY\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.scale(0.02)\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: [lGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTouchpadPressed2 },\n      dest: { value: leftTouchpadFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising1\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadCenter1\n      },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripFallingWhileHoldingPen },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [lTriggerFallingStopDrawing, lGripFallingStopDrawing],\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadNorth1\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadSouth1\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: [rButton(\"primary\").pressed, lButton(\"secondary\").pressed],\n      dest: { value: leftUndoDrawing },\n      xform: xforms.any,\n      priority: 1\n    },\n    {\n      src: { value: leftUndoDrawing },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: lButton(\"primary\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any\n    },\n    {\n      src: { value: inspectButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftCursorHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [lGripRisingGrab],\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.any\n    },\n    {\n      src: { value: inspectButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: {\n        value: rightCursorDrop2\n      },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n\n  [sets.leftCursorHoldingUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: {\n        value: leftCursorDrop2\n      },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.touch_axis_scroll(-1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(-0.02)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightCursorDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [rightCursorDrop1, rightCursorDrop2],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.leftCursorHoldingInteractable]: [\n    {\n      src: {\n        value: lAxis(\"touchY\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.touch_axis_scroll(-1)\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.scale(-0.02),\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftCursorDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftCursorDrop1, leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.any\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n\n  [sets.leftCursorHoveringOnPen]: [],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: [rightCursorDrop1],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: [rightCursorDrop2],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.cursor.right.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.cursor.right.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rButton(\"primary\").pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoldingPen]: [\n    {\n      src: [leftCursorDrop1],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: [leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.left.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising1\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadNorth1\n      },\n      dest: {\n        value: paths.actions.cursor.left.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadSouth1\n      },\n      dest: {\n        value: paths.actions.cursor.left.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: lButton(\"primary\").pressed },\n      dest: { value: paths.actions.cursor.left.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: [lButton(\"primary\").pressed, rButton(\"secondary\").pressed],\n      dest: { value: rightUndoDrawing },\n      xform: xforms.any,\n      priority: 1\n    },\n    {\n      src: { value: rightUndoDrawing },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rButton(\"primary\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.leftCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy\n    }\n  ],\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.leftCursorHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ],\n  [sets.inspecting]: [\n    {\n      src: { value: inspectButtons },\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.falling\n    }\n  ]\n});\n\nexport const viveWandUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.copy\n    }\n  ],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ]\n});\n\nexport const indexUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.copy\n    }\n  ]\n});\n\nexport const viveFocusPlusUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.negate\n    }\n  ],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ]\n});\n\nexport const viveCosmosUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.copy\n    }\n  ],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: {\n        x: lAxis(\"joyX\"),\n        y: lAxis(\"joyY\")\n      },\n      dest: {\n        value: lJoy\n      },\n      xform: xforms.compose_vec2,\n      priority: 1\n    },\n    {\n      src: {\n        value: lJoy\n      },\n      dest: {\n        north: lDpadNorth2,\n        south: lDpadSouth2,\n        east: lDpadEast2,\n        west: lDpadWest2,\n        center: lDpadCenter2\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: lDpadEast2,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.leftHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: lDpadWest2,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.leftHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: {\n        value: lJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1),\n      priority: 1\n    },\n    {\n      src: { value: lJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rDpadEast2 },\n      dest: { value: paths.actions.rightHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rDpadWest2 },\n      dest: { value: paths.actions.rightHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: {\n        value: rJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst lGripPressed = paths.device.wmr.left.grip.pressed;\nconst rGripPressed = paths.device.wmr.right.grip.pressed;\nconst rTriggerPressed = paths.device.wmr.right.trigger.pressed;\n\nconst rJoyNorth = paths.device.wmr.v(\"right/joy/north\");\nconst rGripRising = paths.device.wmr.v(\"right/grip/rising\");\nconst rTriggerRising = paths.device.wmr.v(\"right/trigger/rising\");\nconst rGripFalling = paths.device.wmr.v(\"right/grip/falling\");\nconst rTriggerFalling = paths.device.wmr.v(\"right/trigger/falling\");\n\nfunction dpadVariables(hand) {\n  return {\n    padWest: paths.device.wmr.v(hand + \"/pad/west\"),\n    padEast: paths.device.wmr.v(hand + \"/pad/east\"),\n    padNorth: paths.device.wmr.v(hand + \"/pad/north\"),\n    padSouth: paths.device.wmr.v(hand + \"/pad/south\"),\n    padCenter: paths.device.wmr.v(hand + \"/pad/center\"),\n    padCenterStrip: paths.device.wmr.v(hand + \"/pad/centerStrip\")\n  };\n}\n\nfunction dpadBindings(hand) {\n  const { padWest, padEast, padNorth, padSouth, padCenter, padCenterStrip } = dpadVariables(hand);\n  const pad = paths.device.wmr.v(hand + \"/pad\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr[hand].touchpad.axisX,\n        y: paths.device.wmr[hand].touchpad.axisY\n      },\n      dest: { value: pad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: pad },\n      dest: {\n        west: padWest,\n        east: padEast,\n        north: padNorth,\n        south: padSouth,\n        center: padCenter\n      },\n      xform: xforms.vec2dpad(0.5, false, false)\n    },\n    {\n      src: [padNorth, padCenter, padSouth],\n      dest: { value: padCenterStrip },\n      xform: xforms.any\n    }\n  ];\n}\n\nconst neverFrozenBinding = {\n  src: {},\n  dest: { value: paths.actions.ensureFrozen },\n  xform: xforms.always(false)\n};\n\nfunction penBindings(hand, forCursor) {\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const padPressed = paths.device.wmr[hand].touchpad.pressed;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padRising = paths.device.wmr.v(hand + \"/pad/rising\");\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padWest, padEast, padCenter, padCenterStrip } = dpadVariables(hand);\n\n  const actions = forCursor ? paths.actions.cursor[hand] : paths.actions[hand + \"Hand\"];\n\n  return [\n    neverFrozenBinding,\n    ...dpadBindings(hand),\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.startDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.stopDrawing },\n      xform: xforms.falling\n    },\n    {\n      src: { value: padPressed },\n      dest: { value: padRising },\n      xform: xforms.rising\n    },\n    {\n      src: { bool: padRising, value: padWest },\n      dest: { value: actions.penPrevColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { bool: padRising, value: padEast },\n      dest: { value: actions.penNextColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: actions.scalePenTip },\n      xform: xforms.touch_axis_scroll(-0.05)\n    },\n    {\n      src: [padRising, padCenter],\n      dest: { value: actions.undoDrawing },\n      xform: xforms.all\n    }\n  ];\n}\n\nfunction handPoseBindings(hand) {\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const gripPressed = paths.device.wmr[hand].grip.pressed;\n  const actions = paths.actions[hand + \"Hand\"];\n  return [\n    {\n      src: { value: padTouched },\n      dest: { value: actions.thumb },\n      xform: xforms.copy\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.index },\n      xform: xforms.copy\n    },\n    {\n      src: { value: gripPressed },\n      dest: { value: actions.middleRingPinky },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction freezeBindings() {\n  const leftPadPressed = paths.device.wmr.left.touchpad.pressed;\n  const rightPadPressed = paths.device.wmr.right.touchpad.pressed;\n  const leftPadFalling = paths.device.wmr.v(\"left/touchpad/falling\");\n  const rightPadFalling = paths.device.wmr.v(\"right/touchpad/falling\");\n  const keyboardSaceFalling = paths.device.wmr.k(\"space/falling\");\n  return [\n    {\n      src: [paths.device.keyboard.key(\" \"), leftPadPressed, rightPadPressed],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: keyboardSaceFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftPadPressed },\n      dest: { value: leftPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rightPadPressed },\n      dest: { value: rightPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [keyboardSaceFalling, leftPadFalling, rightPadFalling],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction characterAccelerationBindings() {\n  const wasd_vec2 = paths.device.wmr.k(\"wasd_vec2\");\n  const arrows_vec2 = paths.device.wmr.k(\"arrows_vec2\");\n  const keyboardCharacterAcceleration = paths.device.wmr.k(\"characterAcceleration\");\n  const lJoyXDeadzoned = paths.device.wmr.v(\"left/joy/x/deadzoned\");\n  const lJoyYDeadzoned = paths.device.wmr.v(\"left/joy/y/deadzoned\");\n  const lJoyXScaled = paths.device.wmr.v(\"left/joy/x/scaled\");\n  const lJoyYScaled = paths.device.wmr.v(\"left/joy/y/scaled\");\n  const lCharacterAcceleration = paths.device.wmr.v(\"left/characterAcceleration\");\n  return [\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisX },\n      dest: { value: lJoyXDeadzoned },\n      xform: xforms.deadzone(0.2)\n    },\n    {\n      src: { value: lJoyXDeadzoned },\n      dest: { value: lJoyXScaled },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisY },\n      dest: { value: lJoyYDeadzoned },\n      xform: xforms.deadzone(0.2)\n    },\n    {\n      src: { value: lJoyYDeadzoned },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(-1.5) // vertical character speed modifier\n    },\n    {\n      src: { x: lJoyXScaled, y: lJoyYScaled },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: [\n        paths.device.wmr.left.trigger.pressed,\n        paths.device.wmr.right.trigger.pressed,\n        paths.device.keyboard.key(\"shift\")\n      ],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction cursorModDeltaBindings() {\n  const { padNorth, padSouth } = dpadVariables(\"right\");\n  const rPadNorthOrSouth = paths.device.wmr.v(\"right/pad/northOrSouth\");\n  const rPadNorthOrSouthPressed = paths.device.wmr.v(\"right/pad/northOrSouth/pressed\");\n  const rPadNorthOrSouthPressedY = paths.device.wmr.v(\"right/pad/northOrSouthpressed/y\");\n  return [\n    ...dpadBindings(\"right\"),\n    {\n      src: [padNorth, padSouth],\n      dest: { value: rPadNorthOrSouth },\n      xform: xforms.any\n    },\n    {\n      src: [rPadNorthOrSouth, paths.device.wmr.right.touchpad.pressed],\n      dest: { value: rPadNorthOrSouthPressed },\n      xform: xforms.all\n    },\n    {\n      src: {\n        bool: rPadNorthOrSouthPressed,\n        value: paths.device.wmr.right.touchpad.axisY\n      },\n      dest: { value: rPadNorthOrSouthPressedY },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rPadNorthOrSouthPressedY },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(0.1)\n    }\n  ];\n}\n\nfunction cursorMediaVolumeModBindings() {\n  const hand = \"right\";\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padCenterStrip } = dpadVariables(hand);\n\n  return [\n    ...dpadBindings(hand),\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: paths.actions.cursor[hand].mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ];\n}\n\nfunction holdingCameraBindings(hand, forCursor) {\n  const actions = forCursor ? paths.actions.cursor[hand] : paths.actions[hand + \"Hand\"];\n  return [\n    neverFrozenBinding,\n    {\n      src: { value: paths.device.wmr[hand].trigger.pressed },\n      dest: { value: actions.takeSnapshot },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction teleportationAndRotationBindings() {\n  const rJoy = paths.device.wmr.v(\"right/joy\");\n  const rJoyWest = paths.device.wmr.v(\"right/joy/west\");\n  const rJoyEast = paths.device.wmr.v(\"right/joy/East\");\n  const rJoyWestRising = paths.device.wmr.v(\"right/joy/west/rising\");\n  const rJoyEastRising = paths.device.wmr.v(\"right/joy/east/rising\");\n  const keyboardQRising = paths.device.wmr.k(\"q/rising\");\n  const keyboardERising = paths.device.wmr.k(\"e/rising\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr.right.joystick.axisX,\n        y: paths.device.wmr.right.joystick.axisY\n      },\n      dest: { value: rJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: rJoy },\n      dest: {\n        north: rJoyNorth,\n        west: rJoyWest,\n        east: rJoyEast\n      },\n      xform: xforms.vec2dpad(0.2, false, false)\n    },\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyWest },\n      dest: { value: rJoyWestRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyEast },\n      dest: { value: rJoyEastRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardQRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardERising },\n      xform: xforms.rising\n    },\n    {\n      src: [rJoyWestRising, keyboardQRising],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: [rJoyEastRising, keyboardERising],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    }\n  ];\n}\n\nexport const wmrUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.wmr.left.matrix },\n      dest: { value: paths.actions.leftHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.left.pose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    ...handPoseBindings(\"left\"),\n    ...handPoseBindings(\"right\"),\n    ...freezeBindings(),\n    ...teleportationAndRotationBindings(),\n    ...characterAccelerationBindings(),\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [],\n  [sets.rightCursorHoveringOnNothing]: [],\n  [sets.rightHandHoveringOnNothing]: [],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [...cursorMediaVolumeModBindings()],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerRising },\n      xform: xforms.rising\n    },\n    {\n      src: [rGripRising, rTriggerRising],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n  [sets.rightCursorHoldingInteractable]: [\n    neverFrozenBinding,\n    ...cursorModDeltaBindings(),\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [rGripFalling, rTriggerFalling],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.rightCursorHoveringOnPen]: [],\n  [sets.rightHandHoveringOnPen]: [],\n\n  [sets.leftHandHoldingPen]: penBindings(\"left\"),\n  [sets.rightCursorHoldingPen]: penBindings(\"right\", true),\n  [sets.rightHandHoldingPen]: penBindings(\"right\"),\n\n  [sets.leftHandHoveringOnCamera]: [],\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n\n  [sets.leftHandHoldingCamera]: holdingCameraBindings(\"left\"),\n  [sets.rightCursorHoldingCamera]: holdingCameraBindings(\"right\", true),\n  [sets.rightHandHoldingCamera]: holdingCameraBindings(\"right\"),\n\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst button = paths.device.xbox.button;\nconst axis = paths.device.xbox.axis;\nconst scaledRightJoystickVertical = paths.device.xbox.v(\"scaledRightJoystickVertical\");\nconst scaledLeftJoystickCursorDelta = paths.device.xbox.v(\"scaledLeftJoystickCursorDelta\");\nconst scaledRightJoystickHorizontal = paths.device.xbox.v(\"scaledRightJoystickHorizontal\");\nconst deadzonedRightJoystickHorizontal = paths.device.xbox.v(\"deadzonedRightJoystickHorizontal\");\nconst deadzonedRightJoystickVertical = paths.device.xbox.v(\"deadzonedRightJoystickVertical\");\nconst deadzonedLeftJoystickHorizontal = paths.device.xbox.v(\"deadzonedLeftJoystickHorizontal\");\nconst deadzonedLeftJoystickVertical = paths.device.xbox.v(\"deadzonedLeftJoystickVertical\");\nconst vec2Zero = paths.device.xbox.v(\"vec2Zero\");\nconst zero = paths.device.xbox.v(\"zero\");\n\nfunction characterAccelerationBindings(disableForwardOnTrigger) {\n  const scaledLeftJoystickHorizontal = paths.device.xbox.v(\"scaledLeftJoystickHorizontal\");\n  const scaledLeftJoystickVertical = paths.device.xbox.v(\"scaledLeftJoystickVertical\");\n  const scaledLeftJoystickForwardAcceleration = paths.device.xbox.v(\"scaledLeftJoystickForwardAcceleration\");\n  return [\n    {\n      src: { value: deadzonedLeftJoystickHorizontal },\n      dest: { value: scaledLeftJoystickHorizontal },\n      xform: xforms.scale(1.5) // horizontal move speed modifier\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickVertical },\n      xform: xforms.scale(-1.25) // vertical move speed modifier\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickVertical\n      },\n      dest: { value: scaledLeftJoystickForwardAcceleration },\n      xform: disableForwardOnTrigger ? xforms.copyIfFalse : xforms.copy\n    },\n    {\n      src: {\n        x: scaledLeftJoystickHorizontal,\n        y: scaledLeftJoystickForwardAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    }\n  ];\n}\n\nexport const xboxControllerUserBindings = addSetsToBindings({\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: button(\"b\").pressed },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.cursor.right.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"x\").pressed },\n      dest: { value: paths.actions.cursor.right.penPrevColor },\n      xform: xforms.rising\n    }\n  ],\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: axis(\"rightJoystickHorizontal\") },\n      dest: { value: deadzonedRightJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickHorizontal },\n      dest: { value: scaledRightJoystickHorizontal },\n      xform: xforms.scale(-0.125) // horizontal look speed modifier\n    },\n    {\n      src: { value: axis(\"rightJoystickVertical\") },\n      dest: { value: deadzonedRightJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickVertical },\n      dest: { value: scaledRightJoystickVertical },\n      xform: xforms.scale(-0.125) // vertical look speed modifier\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: {\n        x: scaledRightJoystickHorizontal,\n        y: scaledRightJoystickVertical\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: axis(\"leftJoystickHorizontal\") },\n      dest: { value: deadzonedLeftJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: axis(\"leftJoystickVertical\") },\n      dest: { value: deadzonedLeftJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: button(\"leftTrigger\").pressed },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"leftBumper\").pressed },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"rightBumper\").pressed },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: {},\n      dest: { value: vec2Zero },\n      xform: xforms.vec2Zero\n    },\n    {\n      src: { value: vec2Zero },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.poseFromCameraProjection()\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: button(\"start\").pressed },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.startGazeTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.stopGazeTeleport },\n      xform: xforms.falling\n    }\n  ],\n  [sets.rightCursorHoldingNothing]: [...characterAccelerationBindings()],\n  [sets.rightCursorHoldingInteractable]: [\n    ...characterAccelerationBindings(true),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 100\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickCursorDelta },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickCursorDelta\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copyIfTrue\n    }\n  ],\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.rightCursorHoveringOnInteractable]: [\n    ...characterAccelerationBindings(),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 100\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// vars\nconst v = s => `/vars/daydream/${s}`;\nconst touchpad = v(\"touchpad/axis\");\nconst touchpadRising = v(\"touchpad/rising\");\nconst touchpadFalling = v(\"touchpad/falling\");\nconst touchpadPressed = v(\"touchpad/pressed\");\nconst dpadNorth = v(\"dpad/north\");\nconst dpadSouth = v(\"dpad/south\");\nconst dpadEast = v(\"dpad/east\");\nconst dpadWest = v(\"dpad/west\");\nconst dpadCenter = v(\"dpad/center\");\nconst brushSizeDelta = v(\"brushSizeDelta\");\nconst cursorModDelta = v(\"cursorModDelta\");\nconst dpadSouthDrop = v(\"dropSouth\");\nconst dpadCenterDrop = v(\"dropCenter\");\n\nconst grabBinding = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: paths.actions.cursor.right.grab },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  }\n];\n\nconst dropOnCenterOrSouth = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: dpadCenterDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: { value: dpadSouth, bool: touchpadRising },\n    dest: { value: dpadSouthDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: [dpadCenterDrop, dpadSouthDrop],\n    dest: { value: paths.actions.cursor.right.drop },\n    xform: xforms.any\n  }\n];\n\nexport const daydreamUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.daydream.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: paths.device.daydream.axis(\"touchpadX\"),\n        y: paths.device.daydream.axis(\"touchpadY\")\n      },\n      dest: { value: touchpad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadRising },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadPressed },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: touchpad\n      },\n      dest: {\n        north: dpadNorth,\n        south: dpadSouth,\n        east: dpadEast,\n        west: dpadWest,\n        center: dpadCenter\n      },\n      xform: xforms.vec2dpad(0.5)\n    },\n    {\n      src: {\n        value: dpadEast,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateRight\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadWest,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateLeft\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadCenter,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: grabBinding,\n  [sets.rightCursorHoveringOnUI]: grabBinding,\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: cursorModDelta },\n      xform: xforms.touch_axis_scroll()\n    },\n    {\n      src: { value: cursorModDelta },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: dpadNorth, bool: touchpadRising },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.copy,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadX\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: brushSizeDelta },\n      xform: xforms.touch_axis_scroll(-0.1)\n    },\n    {\n      src: {\n        value: brushSizeDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.right.scalePenTip },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    {\n      src: { value: dpadEast, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.right.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: dpadWest, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.right.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: {\n        value: cursorModDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ],\n\n  [sets.rightCursorHoldingCamera]: [\n    // Don't drop on touchpad release\n    {\n      src: {\n        value: touchpadFalling\n      },\n      xform: xforms.noop,\n      priority: 100\n    },\n    {\n      src: {\n        value: dpadNorth,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\n      xform: xforms.copy,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const cardboardUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport default function generate3DOFTriggerBindings(device) {\n  const touchpad = device.v(\"touchpad\");\n  const touchpadButton = device.button(\"touchpad\");\n  const triggerButton = device.button(\"trigger\");\n  const touchpadX = device.axis(\"touchpadX\");\n  const touchpadXForPen = device.axis(\"touchpadXForPen\");\n  const touchpadY = device.axis(\"touchpadY\");\n  const touchpadYForPen = device.axis(\"touchpadYForPen\");\n  const touchpadRising = device.v(\"touchpad/rising\");\n  const touchpadFalling = device.v(\"touchpad/falling\");\n  const triggerRising = device.v(\"trigger/rising\");\n  const triggerFalling = device.v(\"trigger/falling\");\n  const dpadNorth = device.v(\"dpad/north\");\n  const dpadSouth = device.v(\"dpad/south\");\n  const dpadEast = device.v(\"dpad/east\");\n  const dpadWest = device.v(\"dpad/west\");\n  const dpadCenter = device.v(\"dpad/center\");\n  const dpadCenterStrip = device.v(\"dpad/centerStrip\");\n  const dpadBottomCenterStrip = device.v(\"dpad/bottomCenterStrip\");\n  const togglePen = \"/vars/oculus-go/togglePen\";\n\n  const grabBinding = {\n    src: {\n      value: triggerRising\n    },\n    dest: { value: paths.actions.cursor.right.grab },\n    xform: xforms.copy,\n    priority: 200\n  };\n  const dropBinding = {\n    src: {\n      value: triggerFalling\n    },\n    dest: { value: paths.actions.cursor.right.drop },\n    xform: xforms.copy,\n    priority: 200\n  };\n\n  return addSetsToBindings({\n    [sets.global]: [\n      {\n        src: { value: device.matrix },\n        dest: { value: paths.actions.rightHand.matrix },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerRising },\n        xform: xforms.rising\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerFalling },\n        xform: xforms.falling\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadRising },\n        xform: xforms.rising,\n        priority: 100\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadFalling },\n        xform: xforms.falling,\n        priority: 100\n      },\n      {\n        src: {\n          x: touchpadX,\n          y: touchpadY\n        },\n        dest: { value: touchpad },\n        xform: xforms.compose_vec2\n      },\n      {\n        src: { value: touchpadX },\n        dest: { value: touchpadXForPen },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadY },\n        dest: { value: touchpadYForPen },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: touchpad\n        },\n        dest: {\n          north: dpadNorth,\n          south: dpadSouth,\n          east: dpadEast,\n          west: dpadWest,\n          center: dpadCenter\n        },\n        xform: xforms.vec2dpad(0.3)\n      },\n      {\n        src: [dpadCenter, dpadSouth],\n        dest: { value: dpadBottomCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: [dpadNorth, dpadBottomCenterStrip],\n        dest: { value: dpadCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: {\n          value: dpadCenterStrip,\n          bool: touchpadButton.pressed\n        },\n        dest: {\n          value: paths.actions.ensureFrozen\n        },\n        priority: 100,\n        xform: xforms.copyIfTrue\n      },\n      {\n        src: { value: touchpadFalling },\n        dest: {\n          value: paths.actions.thaw\n        },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateRight\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateLeft\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.rightHand.startTeleport },\n        xform: xforms.copy,\n        priority: 100\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.cursor.right.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.rightHand.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadButton.touched },\n        dest: { value: paths.actions.rightHand.thumb },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.index },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.middleRingPinky },\n        xform: xforms.copy\n      }\n    ],\n\n    [sets.rightCursorHoveringOnInteractable]: [grabBinding],\n    [sets.rightCursorHoveringOnUI]: [grabBinding],\n    [sets.rightCursorHoldingUI]: [dropBinding],\n    [sets.rightCursorHoveringOnVideo]: [\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n        xform: xforms.touch_axis_scroll(-0.1)\n      }\n    ],\n\n    [sets.rightCursorHoldingInteractable]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.right.drop },\n        xform: xforms.copy,\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.modDelta },\n        xform: xforms.touch_axis_scroll()\n      },\n      {\n        src: { value: dpadCenterStrip },\n        priority: 200,\n        xform: xforms.noop\n      }\n    ],\n\n    [sets.rightHandTeleporting]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.rightHand.stopTeleport },\n        xform: xforms.copy,\n        priority: 100\n      }\n    ],\n\n    [sets.rightCursorHoldingPen]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.right.startDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.right.stopDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: touchpadXForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.scalePenTip },\n        xform: xforms.touch_axis_scroll(0.1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadYForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.modDelta },\n        xform: xforms.touch_axis_scroll(1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadBottomCenterStrip,\n          bool: touchpadFalling\n        },\n        dest: { value: togglePen },\n        xform: xforms.copyIfTrue,\n        priority: 300\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.cursor.right.drop },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.pen.remove },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.right.penPrevColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.right.penNextColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadNorth,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.right.undoDrawing\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      }\n    ],\n\n    [sets.rightCursorHoldingCamera]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.right.takeSnapshot },\n        xform: xforms.copy,\n        priority: 300\n      }\n    ]\n  });\n}\n","import { sets } from \"./sets\";\nimport { CAMERA_MODE_INSPECT } from \"../camera-system\";\nimport qsTruthy from \"../../utils/qs_truthy\";\nimport { anyEntityWith } from \"../../utils/bit-utils\";\nimport {\n  HeldRemoteRight,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldHandLeft,\n  HoveredRemoteRight,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredHandLeft,\n  SingleActionButton,\n  HoldableButton,\n  Pen,\n  OffersRemoteConstraint,\n  TogglesHoveredActionSet,\n  CameraTool,\n  OffersHandConstraint,\n  AEntity\n} from \"../../bit-components\";\nimport { hasComponent } from \"bitecs\";\nconst debugUserInput = qsTruthy(\"dui\");\n\nlet leftTeleporter, rightTeleporter;\n\nfunction hc(world, Component, eid) {\n  return eid && hasComponent(world, Component, eid);\n}\n\nfunction hcAFRAME(world, componentName, eid) {\n  return eid && hasComponent(world, AEntity, eid) && !!world.eid2obj.get(eid).el.components[componentName];\n}\n\nexport function resolveActionSets() {\n  leftTeleporter =\n    leftTeleporter ||\n    (document.getElementById(\"player-left-controller\") &&\n      document.getElementById(\"player-left-controller\").components.teleporter);\n  rightTeleporter =\n    rightTeleporter ||\n    (document.getElementById(\"player-right-controller\") &&\n      document.getElementById(\"player-right-controller\").components.teleporter);\n  if (!leftTeleporter || !rightTeleporter) return;\n  const userinput = AFRAME.scenes[0].systems.userinput;\n\n  const world = APP.world;\n\n  const leftHandHovering = anyEntityWith(world, HoveredHandLeft);\n  const leftHandHolding = anyEntityWith(world, HeldHandLeft);\n  const leftRemoteHovering = anyEntityWith(world, HoveredRemoteLeft);\n  const leftRemoteHolding = anyEntityWith(world, HeldRemoteLeft);\n  const rightHandHovering = anyEntityWith(world, HoveredHandRight);\n  const rightHandHolding = anyEntityWith(world, HeldHandRight);\n  const rightRemoteHovering = anyEntityWith(world, HoveredRemoteRight);\n  const rightRemoteHolding = anyEntityWith(world, HeldRemoteRight);\n\n  userinput.toggleSet(sets.leftHandHoldingInteractable, leftHandHolding);\n  userinput.toggleSet(sets.rightHandHoldingInteractable, rightHandHolding);\n  userinput.toggleSet(sets.leftCursorHoldingInteractable, leftRemoteHolding);\n  userinput.toggleSet(sets.rightCursorHoldingInteractable, rightRemoteHolding);\n\n  userinput.toggleSet(sets.leftHandHoveringOnNothing, !leftHandHovering);\n  userinput.toggleSet(sets.rightHandHoveringOnNothing, !rightHandHovering);\n  userinput.toggleSet(sets.leftCursorHoveringOnNothing, !leftRemoteHovering);\n  userinput.toggleSet(sets.rightCursorHoveringOnNothing, !rightRemoteHovering);\n\n  userinput.toggleSet(sets.leftHandHoveringOnPen, hc(world, Pen, leftHandHovering));\n  userinput.toggleSet(sets.rightHandHoveringOnPen, hc(world, Pen, rightHandHovering));\n  userinput.toggleSet(sets.leftCursorHoveringOnPen, hc(world, Pen, leftRemoteHovering));\n  userinput.toggleSet(sets.rightCursorHoveringOnPen, hc(world, Pen, rightRemoteHovering));\n\n  userinput.toggleSet(sets.leftHandHoveringOnCamera, hc(world, CameraTool, leftHandHovering));\n  userinput.toggleSet(sets.rightHandHoveringOnCamera, hc(world, CameraTool, rightHandHovering));\n  userinput.toggleSet(sets.leftCursorHoveringOnCamera, hc(world, CameraTool, leftRemoteHovering));\n  userinput.toggleSet(sets.rightCursorHoveringOnCamera, hc(world, CameraTool, rightRemoteHovering));\n\n  userinput.toggleSet(\n    sets.leftHandHoveringOnInteractable,\n    hc(world, OffersHandConstraint, leftHandHovering) || hcAFRAME(world, \"super-spawner\", leftHandHovering)\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnInteractable,\n    hc(world, OffersHandConstraint, rightHandHovering) || hcAFRAME(world, \"super-spawner\", rightHandHovering)\n  );\n  userinput.toggleSet(\n    sets.leftCursorHoveringOnInteractable,\n    hc(world, OffersRemoteConstraint, leftRemoteHovering) ||\n      hc(world, TogglesHoveredActionSet, leftRemoteHovering) ||\n      hcAFRAME(world, \"super-spawner\", leftRemoteHovering)\n  );\n  userinput.toggleSet(\n    sets.rightCursorHoveringOnInteractable,\n    hc(world, OffersRemoteConstraint, rightRemoteHovering) ||\n      hc(world, TogglesHoveredActionSet, rightRemoteHovering) ||\n      hcAFRAME(world, \"super-spawner\", rightRemoteHovering)\n  );\n\n  userinput.toggleSet(sets.leftHandHoveringOnVideo, hcAFRAME(world, \"media-video\", leftHandHovering));\n  userinput.toggleSet(sets.rightHandHoveringOnVideo, hcAFRAME(world, \"media-video\", rightHandHovering));\n  userinput.toggleSet(sets.leftCursorHoveringOnVideo, hcAFRAME(world, \"media-video\", leftRemoteHovering));\n  userinput.toggleSet(sets.rightCursorHoveringOnVideo, hcAFRAME(world, \"media-video\", rightRemoteHovering));\n\n  userinput.toggleSet(sets.leftHandHoldingPen, hc(world, Pen, leftHandHolding));\n  userinput.toggleSet(sets.rightHandHoldingPen, hc(world, Pen, rightHandHolding));\n  userinput.toggleSet(sets.leftCursorHoldingPen, hc(world, Pen, leftRemoteHolding));\n  userinput.toggleSet(sets.rightCursorHoldingPen, hc(world, Pen, rightRemoteHolding));\n\n  userinput.toggleSet(sets.leftHandHoldingCamera, hc(world, CameraTool, leftHandHolding));\n  userinput.toggleSet(sets.rightHandHoldingCamera, hc(world, CameraTool, rightHandHolding));\n  userinput.toggleSet(sets.leftCursorHoldingCamera, hc(world, CameraTool, leftRemoteHolding));\n  userinput.toggleSet(sets.rightCursorHoldingCamera, hc(world, CameraTool, rightRemoteHolding));\n\n  userinput.toggleSet(\n    sets.leftCursorHoveringOnUI,\n    hc(world, SingleActionButton, leftRemoteHovering) || hc(world, HoldableButton, leftRemoteHovering)\n  );\n  userinput.toggleSet(\n    sets.rightCursorHoveringOnUI,\n    hc(world, SingleActionButton, rightRemoteHovering) || hc(world, HoldableButton, rightRemoteHovering)\n  );\n\n  userinput.toggleSet(sets.leftCursorHoldingNothing, !leftRemoteHolding);\n  userinput.toggleSet(sets.rightCursorHoldingNothing, !rightRemoteHolding);\n\n  userinput.toggleSet(sets.leftCursorHoldingUI, hc(world, HoldableButton, leftRemoteHolding));\n  userinput.toggleSet(sets.rightCursorHoldingUI, hc(world, HoldableButton, rightRemoteHolding));\n\n  userinput.toggleSet(sets.leftHandTeleporting, leftTeleporter.isTeleporting);\n  userinput.toggleSet(sets.rightHandTeleporting, rightTeleporter.isTeleporting);\n\n  userinput.toggleSet(\n    sets.inputFocused,\n    document.activeElement.nodeName === \"INPUT\" ||\n      document.activeElement.nodeName === \"TEXTAREA\" ||\n      document.activeElement.contentEditable === \"true\"\n  );\n\n  userinput.toggleSet(sets.debugUserInput, debugUserInput);\n\n  if (AFRAME.scenes[0] && AFRAME.scenes[0].systems[\"hubs-systems\"]) {\n    userinput.toggleSet(\n      sets.inspecting,\n      AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT\n    );\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class GamepadDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n  }\n\n  write(frame) {\n    if (this.gamepad.connected) {\n      this.gamepad.buttons.forEach((button, i) => {\n        const buttonPath = paths.device.gamepad(this.gamepad.index).button(i);\n        frame.setValueType(buttonPath.pressed, !!button.pressed);\n        frame.setValueType(buttonPath.touched, !!button.touched);\n        frame.setValueType(buttonPath.value, button.value);\n      });\n      this.gamepad.axes.forEach((axis, i) => {\n        frame.setValueType(paths.device.gamepad(this.gamepad.index).axis(i), axis);\n      });\n    }\n  }\n}\n","export const gamepadBindings = {};\n","import { sets } from \"./sets\";\nimport { paths } from \"./paths\";\n\nimport { MouseDevice } from \"./devices/mouse\";\nimport { KeyboardDevice } from \"./devices/keyboard\";\nimport { HudDevice } from \"./devices/hud\";\nimport { XboxControllerDevice } from \"./devices/xbox-controller\";\nimport { OculusGoControllerDevice } from \"./devices/oculus-go-controller\";\nimport { GearVRControllerDevice } from \"./devices/gear-vr-controller\";\nimport { OculusTouchControllerDevice } from \"./devices/oculus-touch-controller\";\nimport { DaydreamControllerDevice } from \"./devices/daydream-controller\";\nimport { ViveControllerDevice } from \"./devices/vive-controller\";\nimport { WindowsMixedRealityControllerDevice } from \"./devices/windows-mixed-reality-controller\";\nimport { WebXRControllerDevice } from \"./devices/webxr-controller\";\nimport { GyroDevice } from \"./devices/gyro\";\n\nimport { AppAwareMouseDevice } from \"./devices/app-aware-mouse\";\nimport { AppAwareTouchscreenDevice } from \"./devices/app-aware-touchscreen\";\n\nimport { keyboardMouseUserBindings } from \"./bindings/keyboard-mouse-user\";\nimport { touchscreenUserBindings } from \"./bindings/touchscreen-user\";\nimport { keyboardDebuggingBindings } from \"./bindings/keyboard-debugging\";\nimport { oculusTouchUserBindings } from \"./bindings/oculus-touch-user\";\nimport { webXRUserBindings } from \"./bindings/webxr-user\";\nimport {\n  viveUserBindings,\n  viveWandUserBindings,\n  indexUserBindings,\n  viveFocusPlusUserBindings,\n  viveCosmosUserBindings\n} from \"./bindings/vive-user\";\nimport { wmrUserBindings } from \"./bindings/windows-mixed-reality-user\";\nimport { xboxControllerUserBindings } from \"./bindings/xbox-controller-user\";\nimport { daydreamUserBindings } from \"./bindings/daydream-user\";\nimport { cardboardUserBindings } from \"./bindings/cardboard-user\";\n\nimport generate3DOFTriggerBindings from \"./bindings/oculus-go-user\";\nconst oculusGoUserBindings = generate3DOFTriggerBindings(paths.device.oculusgo);\nconst gearVRControllerUserBindings = generate3DOFTriggerBindings(paths.device.gearVRController);\n\nimport { resolveActionSets } from \"./resolve-action-sets\";\nimport { GamepadDevice } from \"./devices/gamepad\";\nimport { gamepadBindings } from \"./bindings/generic-gamepad\";\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"../../utils/vr-caps-detect\";\nimport { hackyMobileSafariTest } from \"../../utils/detect-touchscreen\";\nimport { ArrayBackedSet } from \"./array-backed-set\";\n\nfunction arrayContentsDiffer(a, b) {\n  if (a.length !== b.length) return true;\n\n  for (let i = 0, il = a.length; i < il; i++) {\n    const elem = a[i];\n    let found = false;\n\n    for (let j = 0, jl = b.length; j < jl; j++) {\n      if (elem === b[j]) {\n        found = true;\n        break;\n      }\n    }\n\n    if (!found) return true;\n  }\n\n  return false;\n}\n\nconst satisfiesPath = (binding, path) => {\n  for (const key in binding.dest) {\n    if (binding.dest[key].indexOf(path) !== -1) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfyPath = (bindings, path) => {\n  for (const binding of bindings) {\n    if (satisfiesPath(binding, path)) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfiedBy = (binding, bindings) => {\n  for (const path of Object.values(binding.src)) {\n    if (path.startsWith(\"/device/\")) continue;\n    if (!satisfyPath(bindings, path)) return false;\n  }\n  return true;\n};\n\nfunction dependencySort(mappings) {\n  const unsorted = [];\n  for (const mapping of mappings) {\n    for (const setName in mapping) {\n      for (const binding of mapping[setName]) {\n        unsorted.push(binding);\n      }\n    }\n  }\n\n  const sorted = [];\n  while (unsorted.length > 0) {\n    const binding = unsorted.shift();\n    if (satisfiedBy(binding, sorted)) {\n      sorted.push(binding);\n    } else {\n      unsorted.push(binding);\n    }\n  }\n\n  return sorted;\n}\n\nfunction notEmpty(s) {\n  return s !== \"\";\n}\n\nfunction isSubpath(subpath, path) {\n  const a = subpath.split(\"/\").filter(notEmpty);\n  const b = path.split(\"/\").filter(notEmpty);\n  if (a.length > b.length) return false;\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) return false;\n  }\n  return true;\n}\n\nfunction canMask(masker, masked) {\n  if (masker.priority === undefined) {\n    masker.priority = 0;\n  }\n  if (masked.priority === undefined) {\n    masked.priority = 0;\n  }\n  if (masked.priority >= masker.priority) return false;\n  for (const maskerKey in masker.src) {\n    const maskerPath = masker.src[maskerKey];\n    for (const maskedKey in masked.src) {\n      const maskedPath = masked.src[maskedKey];\n      if (maskedPath.indexOf(maskerPath) !== -1 && isSubpath(maskerPath, maskedPath)) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction computeMasks(bindings) {\n  const masks = new Array(bindings.length);\n  for (let row = 0; row < bindings.length; row++) {\n    const masksRow = (masks[row] = []);\n    const bindingsRow = bindings[row];\n    for (let col = 0; col < bindings.length; col++) {\n      if (canMask(bindings[col], bindingsRow)) {\n        masksRow.push(col);\n      }\n    }\n  }\n  return masks;\n}\n\nfunction isActive(binding, sets) {\n  for (let i = 0; i < binding.sets.length; i++) {\n    if (sets.includes(binding.sets[i])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction computeExecutionStrategy(sortedBindings, masks, activeSets) {\n  const actives = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    actives[row] = isActive(sortedBindings[row], activeSets);\n  }\n\n  const masked = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    const maskedRow = (masked[row] = []);\n    const masksRow = masks[row];\n    for (let col = 0; col < sortedBindings.length; col++) {\n      if (actives[col] && masksRow.indexOf(col) !== -1) {\n        maskedRow.push(col);\n      }\n    }\n  }\n\n  return { actives, masked };\n}\n\nAFRAME.registerSystem(\"userinput\", {\n  get(path) {\n    if (!this.frame) return;\n    return this.frame.get(path);\n  },\n\n  toggleSet(set, value) {\n    this.pendingSetChanges.push(set);\n    this.pendingSetChanges.push(!!value);\n  },\n\n  init() {\n    this.frame = {\n      generation: 0,\n      values: {},\n      generations: {},\n      get: function(path) {\n        if (this.generations[path] !== this.generation) return undefined;\n        return this.values[path];\n      },\n      setValueType: function(path, value) {\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setVector2: function(path, a, b) {\n        const value = this.values[path] || [];\n        value[0] = a;\n        value[1] = b;\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setPose: function(path, pose) {\n        this.setValueType(path, pose);\n      },\n      setMatrix4: function(path, mat4) {\n        // Should we assume the incoming mat4 is safe to store instead of copying values?\n        const value = this.values[path] || new THREE.Matrix4();\n        value.copy(mat4);\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      }\n    };\n\n    this.prevActiveSets = [];\n    this.activeSets = [sets.global];\n    this.pendingSetChanges = [];\n    this.xformStates = new Map();\n    this.activeDevices = new ArrayBackedSet([new HudDevice()]);\n\n    const isMobile = AFRAME.utils.device.isMobile();\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\n    const forceEnableTouchscreen = hackyMobileSafariTest();\n\n    if (!(isMobile || isMobileVR || forceEnableTouchscreen)) {\n      this.activeDevices.add(new MouseDevice());\n      this.activeDevices.add(new AppAwareMouseDevice());\n      this.activeDevices.add(new KeyboardDevice());\n    } else if (!isMobileVR || forceEnableTouchscreen) {\n      this.activeDevices.add(new AppAwareTouchscreenDevice());\n      this.activeDevices.add(new KeyboardDevice());\n      this.activeDevices.add(new GyroDevice());\n    }\n\n    this.isMobile = isMobile;\n    this.isMobileVR = isMobileVR;\n\n    this.registeredMappings = new Set([keyboardDebuggingBindings]);\n    this.registeredMappingsChanged = true;\n\n    const vrGamepadMappings = new Map();\n    vrGamepadMappings.set(WindowsMixedRealityControllerDevice, wmrUserBindings);\n    vrGamepadMappings.set(ViveControllerDevice, viveUserBindings);\n    vrGamepadMappings.set(OculusTouchControllerDevice, oculusTouchUserBindings);\n    vrGamepadMappings.set(OculusGoControllerDevice, oculusGoUserBindings);\n    vrGamepadMappings.set(GearVRControllerDevice, gearVRControllerUserBindings);\n    vrGamepadMappings.set(DaydreamControllerDevice, daydreamUserBindings);\n    vrGamepadMappings.set(WebXRControllerDevice, webXRUserBindings);\n\n    const nonVRGamepadMappings = new Map();\n    nonVRGamepadMappings.set(XboxControllerDevice, xboxControllerUserBindings);\n    nonVRGamepadMappings.set(GamepadDevice, gamepadBindings);\n\n    const addExtraMappings = activeDevice => {\n      if (activeDevice instanceof ViveControllerDevice && activeDevice.gamepad) {\n        if (activeDevice.gamepad.id === \"OpenVR Cosmos\") {\n          //HTC Vive Cosmos Controller\n          this.registeredMappings.add(viveCosmosUserBindings);\n        } else if (activeDevice.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n          //HTC Vive Focus Plus Controller\n          this.registeredMappings.add(viveFocusPlusUserBindings);\n        } else if (activeDevice.gamepad.axes.length === 4) {\n          //Valve Index Controller\n          this.registeredMappings.add(indexUserBindings);\n        } else {\n          //HTC Vive Controller (wands)\n          this.registeredMappings.add(viveWandUserBindings);\n        }\n      }\n    };\n\n    const deleteExtraMappings = activeDevice => {\n      if (activeDevice instanceof ViveControllerDevice && activeDevice.gamepad) {\n        this.registeredMappings.delete(viveCosmosUserBindings);\n        this.registeredMappings.delete(viveFocusPlusUserBindings);\n        this.registeredMappings.delete(indexUserBindings);\n        this.registeredMappings.delete(viveWandUserBindings);\n      }\n    };\n\n    const updateBindingsForVRMode = () => {\n      const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n      const isMobile = AFRAME.utils.device.isMobile();\n      const forceEnableTouchscreen = hackyMobileSafariTest();\n\n      if (inVRMode) {\n        console.log(\"Using VR bindings.\");\n        this.registeredMappings.delete(\n          isMobile || forceEnableTouchscreen ? touchscreenUserBindings : keyboardMouseUserBindings\n        );\n        // add mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          const mapping = vrGamepadMappings.get(activeDevice.constructor);\n          mapping && this.registeredMappings.add(mapping);\n          addExtraMappings(activeDevice);\n        }\n\n        // Handle cardboard by looking of VR device caps\n        if (isMobile) {\n          getAvailableVREntryTypes().then(availableVREntryTypes => {\n            if (availableVREntryTypes.cardboard === VR_DEVICE_AVAILABILITY.yes) {\n              this.registeredMappings.add(cardboardUserBindings);\n              this.registeredMappingsChanged = true;\n            }\n          });\n        }\n      } else {\n        console.log(\"Using Non-VR bindings.\");\n        // remove mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          deleteExtraMappings(activeDevice);\n          this.registeredMappings.delete(vrGamepadMappings.get(activeDevice.constructor));\n        }\n        this.registeredMappings.add(\n          isMobile || forceEnableTouchscreen ? touchscreenUserBindings : keyboardMouseUserBindings\n        );\n      }\n\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        const mapping = nonVRGamepadMappings.get(activeDevice.constructor);\n        mapping && this.registeredMappings.add(mapping);\n      }\n\n      this.registeredMappingsChanged = true;\n    };\n\n    const gamepadConnected = e => {\n      let gamepadDevice;\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        if (!e.gamepad.isWebXRGamepad && activeDevice.gamepad && activeDevice.gamepad.index === e.gamepad.index) {\n          console.warn(\"connected already fired for gamepad\", e.gamepad);\n          return; // multiple connect events without a disconnect event\n        }\n      }\n      if (e.gamepad.isWebXRGamepad) {\n        gamepadDevice = new WebXRControllerDevice(e.gamepad);\n      } else if (\n        // HACK Firefox Nightly bug causes corrupt gamepad names for OpenVR, so do startsWith\n        e.gamepad.id.startsWith(\"OpenVR Gamepad\") ||\n        e.gamepad.id.startsWith(\"OpenVR Knuckles\") ||\n        e.gamepad.id === \"HTC Vive Focus Plus Controller\" ||\n        e.gamepad.id === \"OpenVR Cosmos\"\n      ) {\n        gamepadDevice = new ViveControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Oculus Touch\") || e.gamepad.id.startsWith(\"Pico Neo 2\")) {\n        gamepadDevice = new OculusTouchControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Spatial Controller\")) {\n        gamepadDevice = new WindowsMixedRealityControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Oculus Go Controller\" || e.gamepad.id === \"Pico G2 Controller\") {\n        gamepadDevice = new OculusGoControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Gear VR Controller\" || e.gamepad.id === \"HTC Vive Focus Controller\") {\n        gamepadDevice = new GearVRControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Daydream Controller\") {\n        gamepadDevice = new DaydreamControllerDevice(e.gamepad);\n      } else if (e.gamepad.mapping === \"standard\") {\n        // Our XboxController device and bindings should be generic enough for most gamepads.\n        gamepadDevice = new XboxControllerDevice(e.gamepad);\n      } else {\n        // This device doesn't actually have any bindings, but we need to fallback to something.\n        gamepadDevice = new GamepadDevice(e.gamepad);\n      }\n\n      this.activeDevices.add(gamepadDevice);\n\n      updateBindingsForVRMode();\n    };\n\n    const gamepadDisconnected = e => {\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const device = this.activeDevices.items[i];\n        if (device.gamepad && device.gamepad.index === e.gamepad.index) {\n          this.registeredMappings.delete(\n            vrGamepadMappings.get(device.constructor) || nonVRGamepadMappings.get(device.constructor)\n          );\n          this.activeDevices.delete(device);\n          return;\n        }\n      }\n\n      updateBindingsForVRMode();\n    };\n\n    window.addEventListener(\"gamepadconnected\", gamepadConnected, false);\n    window.addEventListener(\"gamepaddisconnected\", gamepadDisconnected, false);\n    for (const gamepad of navigator.getGamepads()) {\n      gamepad && gamepadConnected({ gamepad });\n    }\n\n    const retrieveXRGamepads = ({ added, removed }) => {\n      for (const inputSource of removed) {\n        gamepadDisconnected(inputSource);\n      }\n      for (const inputSource of added) {\n        inputSource.gamepad.isWebXRGamepad = true;\n        inputSource.gamepad.targetRaySpace = inputSource.targetRaySpace;\n        inputSource.gamepad.primaryProfile = inputSource.profiles[0];\n        // inputSource.gamepad.hand is a read-only property and still an experimental property.\n        // We read this property elsewhere. Only Firefox supports this property now.\n        // So we set this property if it's undefined.\n        if (inputSource.gamepad.hand === undefined) {\n          inputSource.gamepad.hand = inputSource.handedness;\n        }\n        gamepadConnected(inputSource);\n      }\n    };\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", () => {\n      const { xrSession } = this.el.sceneEl;\n      if (xrSession) {\n        xrSession.addEventListener(\"inputsourceschange\", retrieveXRGamepads);\n        xrSession.requestReferenceSpace(\"local-floor\").then(referenceSpace => {\n          this.xrReferenceSpace = referenceSpace;\n        });\n        xrSession.addEventListener(\"end\", () => {\n          this.activeDevices.items.filter(d => d.gamepad && d.gamepad.isWebXRGamepad).forEach(gamepadDisconnected);\n        });\n      }\n      updateBindingsForVRMode();\n    });\n    this.el.sceneEl.addEventListener(\"exit-vr\", updateBindingsForVRMode);\n\n    updateBindingsForVRMode();\n  },\n\n  maybeToggleXboxMapping() {\n    if (hackyMobileSafariTest() || this.isMobile || this.isMobileVR) return;\n\n    const vrAxesSum =\n      (this.get(paths.device.vive.left.axesSum) || 0) +\n      (this.get(paths.device.vive.right.axesSum) || 0) +\n      (this.get(paths.device.leftOculusTouch.axesSum) || 0) +\n      (this.get(paths.device.rightOculusTouch.axesSum) || 0);\n    const mouseMovement = this.get(paths.device.mouse.movementXY);\n    const nonXboxActivity = (mouseMovement && (mouseMovement[0] || mouseMovement[1])) > 2 || vrAxesSum > 0.5;\n\n    const hasXboxMapping = this.registeredMappings.has(xboxControllerUserBindings);\n\n    if (nonXboxActivity && hasXboxMapping) {\n      this.registeredMappings.delete(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    } else if (this.get(paths.device.xbox.axesSum) > 0.5 && !hasXboxMapping) {\n      this.registeredMappings.add(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    }\n  },\n\n  tick2() {\n    this.frame.generation += 1;\n    const registeredMappingsChanged = this.registeredMappingsChanged;\n    if (registeredMappingsChanged) {\n      this.registeredMappingsChanged = false;\n      this.prevSortedBindings = this.sortedBindings;\n      this.sortedBindings = dependencySort(this.registeredMappings);\n      if (!this.prevSortedBindings) {\n        this.prevSortedBindings = this.sortedBindings;\n      }\n      this.masks = computeMasks(this.sortedBindings);\n    }\n\n    this.prevActiveSets.length = 0;\n    for (let i = 0; i < this.activeSets.length; i++) {\n      const item = this.activeSets[i];\n      this.prevActiveSets.push(item);\n    }\n    resolveActionSets();\n    for (let i = 0, l = this.pendingSetChanges.length; i < l; i += 2) {\n      const set = this.pendingSetChanges[i];\n      const value = this.pendingSetChanges[i + 1];\n\n      if (value) {\n        if (!this.activeSets.includes(set)) {\n          this.activeSets.push(set);\n        }\n      } else {\n        const idx = this.activeSets.indexOf(set);\n\n        if (idx > -1) {\n          this.activeSets.splice(idx, 1);\n        }\n      }\n    }\n    const activeSetsChanged = arrayContentsDiffer(this.prevActiveSets, this.activeSets);\n    this.pendingSetChanges.length = 0;\n    if (registeredMappingsChanged || activeSetsChanged || (!this.actives && !this.masked)) {\n      this.prevActives = this.actives;\n      this.prevMasked = this.masked;\n      const { actives, masked } = computeExecutionStrategy(this.sortedBindings, this.masks, this.activeSets);\n      this.actives = actives;\n      this.masked = masked;\n    }\n\n    for (let i = 0; i < this.activeDevices.items.length; i++) {\n      this.activeDevices.items[i].write(this.frame, this.el.sceneEl, this.xrReferenceSpace);\n    }\n\n    for (let i = 0; i < this.sortedBindings.length; i++) {\n      if (!this.actives[i] || this.masked[i].length > 0) continue;\n\n      const binding = this.sortedBindings[i];\n\n      let bindingExistedLastFrame = true;\n      if (!registeredMappingsChanged && activeSetsChanged && this.prevSortedBindings) {\n        const j = this.prevSortedBindings.indexOf(binding);\n        bindingExistedLastFrame = j > -1 && this.prevActives[j] && this.prevMasked[j].length === 0;\n      }\n      if (!bindingExistedLastFrame) {\n        this.xformStates.delete(binding);\n      }\n\n      const { src, dest, xform, debug } = binding;\n\n      let oldValue;\n\n      if (debug) {\n        oldValue = this.frame.get(dest.value);\n      }\n\n      const newState = xform(this.frame, src, dest, this.xformStates.get(binding));\n\n      if (debug) {\n        // Note for now this only works with bindings that have { value: } sources and dests\n        console.log(\n          `${JSON.stringify(src.value)} (${src.value && JSON.stringify(this.frame.get(src.value))}) to ${JSON.stringify(\n            dest\n          )}: ${oldValue} -> ${this.frame.get(dest.value)}`\n        );\n      }\n\n      if (newState !== undefined) {\n        this.xformStates.set(binding, newState);\n      }\n    }\n\n    this.prevSortedBindings = this.sortedBindings;\n\n    this.maybeToggleXboxMapping();\n  }\n});\n","import { paths } from \"./paths\";\nimport qsTruthy from \"../../utils/qs_truthy\";\n\nconst PATHS_TO_SHOW = [\"/actions/\", \"/device/\", \"/var/\"];\nconst DELIMITER = \"-----------------------------------\";\n\nconst replacer = (k, v) => {\n  if (typeof v === \"number\") {\n    return `${v >= 0 ? \"+\" : \"\"}${v.toFixed(3)}`;\n  }\n  return v;\n};\nfunction describeCurrentMasks(userinput) {\n  const strings = [];\n  userinput.masked.forEach((maskers, i) => {\n    let val;\n    if (!userinput.actives[i]) return;\n    if (maskers.length) {\n      val = JSON.stringify(userinput.sortedBindings[i], replacer);\n      strings.push(DELIMITER);\n      strings.push(`Binding #${i}:`);\n      if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n      strings.push(`${val}\\n`);\n    }\n    maskers.forEach(masker => {\n      val = JSON.stringify(userinput.sortedBindings[masker], replacer);\n      if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n      strings.push(`- Masked by #${masker}:\\n${val}`);\n    });\n    if (maskers.length) {\n      strings.push(`\\n`);\n    }\n  });\n  return strings.join(\"\\n\");\n}\n\nAFRAME.registerSystem(\"userinput-debug\", {\n  active: true,\n\n  tick() {\n    if (!this.active) return;\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n\n    if (this.userinputFrameStatus) {\n      const pathsOutput = [];\n      const { frame } = userinput;\n      for (const key in frame.values) {\n        if (!frame.get(key)) continue;\n        if (!PATHS_TO_SHOW.some(x => key.startsWith(x))) continue;\n        let val = JSON.stringify(frame.get(key), replacer);\n        if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n        pathsOutput.push(`${key} -> ${val}`);\n      }\n      this.userinputFrameStatus.textContent = pathsOutput.join(\"\\n\");\n    }\n\n    if (userinput.get(paths.actions.debugUserInput.describeCurrentMasks)) {\n      console.log(describeCurrentMasks(userinput));\n    }\n\n    if (userinput.get(paths.actions.logDebugFrame)) {\n      if (qsTruthy(\"userinput_debug\") && !this.userinputFrameStatus) {\n        this.userinputFrameStatus = document.createElement(\"div\");\n        this.userinputFrameStatus.id = \"userinput-frame-status\";\n        this.userinputFrameStatus.style = `\n          position: absolute;\n          z-index: 2;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        `;\n        document.body.append(this.userinputFrameStatus);\n      }\n\n      console.log(userinput);\n      console.log(\"sorted\", JSON.parse(JSON.stringify(userinput.sortedBindings)));\n      console.log(\"actives\", JSON.parse(JSON.stringify(userinput.actives)));\n      console.log(\"masks\", JSON.parse(JSON.stringify(userinput.masks)));\n      console.log(\"masked\", JSON.parse(JSON.stringify(userinput.masked)));\n      console.log(\"devices\", userinput.activeDevices);\n      console.log(\"activeSets\", JSON.parse(JSON.stringify(userinput.activeSets)));\n      console.log(\"frame\", JSON.parse(JSON.stringify(userinput.frame)));\n      console.log(\"xformStates\", userinput.xformStates);\n      const { sortedBindings, actives, masked } = userinput;\n      for (const i in sortedBindings) {\n        const strings = [];\n        if (masked[i].length > 0) {\n          for (const j of masked[i]) {\n            strings.push(JSON.stringify(sortedBindings[j]));\n          }\n        }\n\n        if (this.logBindings) {\n          console.log(\n            \"binding: \",\n            i,\n            \"\\n\",\n            JSON.parse(JSON.stringify(sortedBindings[i])),\n            \"\\n\",\n            \"dest: \",\n            JSON.parse(JSON.stringify(sortedBindings[i].dest && Object.values(sortedBindings[i].dest))),\n            \"\\n\",\n            \"active: \",\n            JSON.parse(JSON.stringify(actives[i])),\n            \"\\n\",\n            \"maskedBy: \",\n            JSON.parse(JSON.stringify(masked[i])),\n            \"\\n\",\n            strings.join(\"\\n\"),\n            \"\\n\"\n          );\n        }\n      }\n    }\n  }\n});\n","import { paths } from \"./userinput/paths\";\nimport { SOURCES } from \"../storage/media-search-store\";\n\nconst MEDIA_SEARCH_PATHS = [\n  paths.actions.mediaSearch1,\n  paths.actions.mediaSearch2,\n  paths.actions.mediaSearch3,\n  paths.actions.mediaSearch4,\n  paths.actions.mediaSearch5,\n  paths.actions.mediaSearch6,\n  paths.actions.mediaSearch7,\n  paths.actions.mediaSearch8\n];\n\n// Every frame, looks for input paths that trigger UI-relevant events and handles them.\nAFRAME.registerSystem(\"ui-hotkeys\", {\n  init() {\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n  },\n\n  tick: function() {\n    if (!this.userinput) {\n      this.userinput = this.el.systems.userinput;\n    }\n\n    if (this.userinput.get(paths.actions.focusChat)) {\n      window.dispatchEvent(new CustomEvent(\"focus_chat\", { detail: { prefix: \"\" } }));\n    }\n\n    if (this.userinput.get(paths.actions.focusChatCommand)) {\n      window.dispatchEvent(new CustomEvent(\"focus_chat\", { detail: { prefix: \"/\" } }));\n    }\n\n    if (this.userinput.get(paths.actions.mediaExit)) {\n      const state = window.APP.history.location.state && window.APP.history.location.state.value;\n      const ignoredStates = new Set([\"avatar-editor\", \"link\", \"profile\", \"device\", \"audio\"]);\n      const maybeInMediaBrowser = !state || !ignoredStates.has(state);\n      if (maybeInMediaBrowser) {\n        // Do not push \"exit media browser\" to history\n        // if we know we are NOT in the media browser.\n        // TODO: If we set the state to \"media browser\"\n        //       while the media browser is open, then we\n        //       can check that condition directly.\n        //       Until then, we push \"exit media browser\"\n        //       to the history if state is undefined.\n        this.mediaSearchStore.pushExitMediaBrowserHistory();\n      }\n\n      this.el.emit(\"action_exit_watch\");\n    }\n\n    for (let i = 0; i < MEDIA_SEARCH_PATHS.length; i++) {\n      if (this.userinput.get(MEDIA_SEARCH_PATHS[i]) && window.APP.hubChannel.can(\"spawn_and_move_media\")) {\n        this.mediaSearchStore.sourceNavigate(SOURCES[i]);\n      }\n    }\n\n    if (this.userinput.get(paths.actions.toggleCamera)) {\n      this.el.emit(\"action_toggle_camera\");\n    }\n\n    if (this.userinput.get(paths.actions.toggleUI)) {\n      this.el.emit(\"action_toggle_ui\");\n    }\n  }\n});\n","import { paths } from \"./userinput/paths\";\n\n// The output of this system is activeTip. There are named tips (eg locomotion) that each have validators.\n//\n// Each frame we run all the non-finished validators and take the first tip (by order)\n// which is VALID. Any tip that returns FINISHED will no longer be considered without\n// a local storage reset.\n\n// Validators can return these values:\n//\n// INVALID - Tip is not valid to show\n// VALID - Tip is valid to show\n// FINISH - Tip should always be assumed INVALID going forward\n//\nconst INVALID = 0;\nconst VALID = 1;\nconst FINISH = 2;\n\nconst LOCAL_STORAGE_KEY = \"__hubs_finished_tips\";\n\nconst TIPS = {\n  desktop: [\"look\", \"locomotion\", \"turning\", \"invite\"],\n  mobile: [\"look\", \"locomotion\", \"invite\"],\n  standalone: []\n};\n\nlet localStorageCache = null;\nlet finished = false; // Optimization, lets system skip altogether once finished.\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst tipPlatform = () => {\n  if (isMobileVR) return \"standalone\";\n  return isMobile ? \"mobile\" : \"desktop\";\n};\n\nconst platformTips = TIPS[tipPlatform()];\n\nfunction markTipFinished(tip) {\n  const storeData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  storeData[tip] = { finished: true };\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(storeData));\n  localStorageCache = null;\n}\n\nconst VALIDATORS = {\n  look: function(userinput) {\n    const cameraDelta = userinput.get(\n      isMobile ? paths.device.touchscreen.touchCameraDelta : paths.device.smartMouse.cameraDelta\n    );\n    return cameraDelta ? FINISH : VALID;\n  },\n  locomotion: function(userinput) {\n    const accel = userinput.get(paths.actions.characterAcceleration);\n\n    // User moved\n    return accel && (accel[0] !== 0 || accel[1] !== 0) ? FINISH : VALID;\n  },\n  turning: function(userinput) {\n    if (userinput.get(paths.actions.snapRotateLeft) || userinput.get(paths.actions.snapRotateRight)) return FINISH;\n    return VALID;\n  },\n  invite: function(_userinput, scene, hub) {\n    if (hub && hub.entry_mode === \"invite\") return INVALID;\n    return scene.is(\"copresent\") ? FINISH : VALID;\n  }\n};\n\nAFRAME.registerSystem(\"tips\", {\n  init: function() {\n    this.activeTip = null;\n    this._performStep = this._performStep.bind(this);\n\n    if (localStorage.getItem(LOCAL_STORAGE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n    }\n  },\n\n  resetTips: function() {\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n    localStorageCache = null;\n    window.APP.store.resetTipActivityFlags();\n    window.APP.store.resetConfirmedBroadcastedRooms();\n    this.activeTip = null;\n    finished = false;\n  },\n\n  skipTips: function() {\n    for (let i = 0; i < platformTips.length; i++) {\n      const tipId = platformTips[i];\n      markTipFinished(tipId);\n    }\n  },\n\n  tick: function() {\n    if (isMobileVR) return; // Optimization for now, don't bother with this on mobile VR until we have real tips\n\n    if (!this._userinput) {\n      this._userinput = this.el.systems.userinput;\n\n      if (!this._userinput) return;\n    }\n\n    const tips = platformTips;\n\n    const prevTip = this.activeTip;\n\n    this._performStep(tips);\n\n    if (prevTip !== this.activeTip) {\n      this.el.emit(\"tip-changed\", this.activeTip);\n    }\n  },\n\n  _performStep: function(tips) {\n    if (finished) return;\n\n    let chosenTip = null;\n    let finishCount = 0;\n\n    for (let i = 0; i < tips.length; i++) {\n      const tip = tips[i];\n\n      if (localStorageCache === null) {\n        localStorageCache = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n      }\n\n      if (localStorageCache[tip] && localStorageCache[tip].finished) {\n        finishCount++;\n        continue;\n      }\n\n      switch (VALIDATORS[tip](this._userinput, this.el, window.APP.hub)) {\n        case FINISH:\n          markTipFinished(tip);\n          break;\n        case VALID:\n          chosenTip = `tips.${tipPlatform()}.${tip}`;\n          break;\n      }\n\n      if (chosenTip) break;\n    }\n\n    this.activeTip = chosenTip;\n\n    if (finishCount === tips.length) {\n      // Optimization: Tips are completed no need to re-walk.\n      finished = true;\n    }\n  }\n});\n","/* global AFRAME */\nimport { paths } from \"./userinput/paths\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { isTagged } from \"../components/tags\";\nimport { hasComponent } from \"bitecs\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\n\nimport {\n  HoveredRemoteRight,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredHandLeft,\n  HeldRemoteRight,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldHandLeft,\n  AEntity\n} from \"../bit-components\";\n\nfunction anyAframeEntityWith(world, component) {\n  const eid = anyEntityWith(world, component);\n  return eid && hasComponent(world, AEntity, eid) && world.eid2obj.get(eid).el;\n}\nexport function isUI(el) {\n  return isTagged(el, \"singleActionButton\") || isTagged(el, \"holdableButton\");\n}\n\nfunction identityFn(o) {\n  return o;\n}\n\nAFRAME.registerSystem(\"interaction\", {\n  getActiveIntersection() {\n    return (\n      (this.state.rightRemote.hovered && this.rightCursorControllerEl.components[\"cursor-controller\"].intersection) ||\n      (this.state.leftRemote.hovered && this.leftCursorControllerEl.components[\"cursor-controller\"].intersection)\n    );\n  },\n\n  isHoldingAnything(pred = identityFn) {\n    return !!(\n      pred(this.state.leftHand.held) ||\n      pred(this.state.rightHand.held) ||\n      pred(this.state.rightRemote.held) ||\n      pred(this.state.leftRemote.held)\n    );\n  },\n\n  isHeld(el) {\n    return (\n      this.state.leftHand.held === el ||\n      this.state.rightHand.held === el ||\n      this.state.rightRemote.held === el ||\n      this.state.leftRemote.held === el\n    );\n  },\n\n  init: function() {\n    this.options = {\n      leftHand: {\n        entity: null,\n        grabPath: paths.actions.leftHand.grab,\n        dropPath: paths.actions.leftHand.drop\n      },\n      rightHand: {\n        entity: null,\n        grabPath: paths.actions.rightHand.grab,\n        dropPath: paths.actions.rightHand.drop\n      },\n      rightRemote: {\n        entity: null,\n        grabPath: paths.actions.cursor.right.grab,\n        dropPath: paths.actions.cursor.right.drop\n      },\n      leftRemote: {\n        entity: null,\n        grabPath: paths.actions.cursor.left.grab,\n        dropPath: paths.actions.cursor.left.drop\n      }\n    };\n    this.state = {\n      leftHand: {\n        hovered: null,\n        held: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null\n      },\n      leftRemote: {\n        hovered: null,\n        held: null\n      }\n    };\n    this.previousState = {\n      leftHand: {\n        hovered: null,\n        held: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null\n      },\n      leftRemote: {\n        hovered: null,\n        held: null\n      }\n    };\n    waitForDOMContentLoaded().then(() => {\n      this.options.leftHand.entity = document.getElementById(\"player-left-controller\");\n      this.options.rightHand.entity = document.getElementById(\"player-right-controller\");\n      this.options.rightRemote.entity = document.getElementById(\"right-cursor\");\n      this.options.leftRemote.entity = document.getElementById(\"left-cursor\");\n      this.rightCursorControllerEl = document.getElementById(\"right-cursor-controller\");\n      this.leftCursorControllerEl = document.getElementById(\"left-cursor-controller\");\n      this.ready = true;\n    });\n  },\n\n  updateLegacyState() {\n    this.previousState.rightRemote.hovered = this.state.rightRemote.hovered;\n    this.previousState.rightRemote.held = this.state.rightRemote.held;\n    this.previousState.leftRemote.hovered = this.state.leftRemote.hovered;\n    this.previousState.leftRemote.held = this.state.leftRemote.held;\n    this.previousState.leftHand.hovered = this.state.leftHand.hovered;\n    this.previousState.leftHand.held = this.state.leftHand.held;\n    this.previousState.rightHand.hovered = this.state.rightHand.hovered;\n    this.previousState.rightHand.held = this.state.rightHand.held;\n\n    const world = APP.world;\n    this.state.rightRemote.hovered = anyAframeEntityWith(world, HoveredRemoteRight);\n    this.state.leftRemote.hovered = anyAframeEntityWith(world, HoveredRemoteLeft);\n    this.state.rightHand.hovered = anyAframeEntityWith(world, HoveredHandRight);\n    this.state.leftHand.hovered = anyAframeEntityWith(world, HoveredHandLeft);\n    this.state.rightRemote.held = anyAframeEntityWith(world, HeldRemoteRight);\n    this.state.leftRemote.held = anyAframeEntityWith(world, HeldRemoteLeft);\n    this.state.rightHand.held = anyAframeEntityWith(world, HeldHandRight);\n    this.state.leftHand.held = anyAframeEntityWith(world, HeldHandLeft);\n  }\n});\n","import { defineQuery, enterQuery, exitQuery } from \"bitecs\";\nimport { CursorRaycastable } from \"../bit-components\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nconst noop = function() {};\nAFRAME.registerComponent(\"overwrite-raycast-as-noop\", {\n  init() {\n    this.el.object3D.raycast = noop;\n    this.mesh = this.el.getObject3D(\"mesh\");\n    if (this.mesh) {\n      this.mesh.raycast = noop;\n    } else {\n      this.el.addEventListener(\"model-loaded\", () => {\n        this.mesh = this.el.getObject3D(\"mesh\");\n        if (this.mesh) {\n          this.mesh.raycast = noop;\n        }\n      });\n    }\n  }\n});\n\nconst cursorRaycastableQuery = defineQuery([CursorRaycastable]);\nconst enteredCursorRaycastableQuery = enterQuery(cursorRaycastableQuery);\nconst exitedCurserRaycastableQuery = exitQuery(cursorRaycastableQuery);\n\nexport class CursorTargettingSystem {\n  constructor() {\n    this.targets = [];\n    this.dirty = true;\n    this.onMutation = this.onMutation.bind(this);\n    this.onObject3DSet = this.onObject3DSet.bind(this);\n    this.onObject3DRemove = this.onObject3DRemove.bind(this);\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.onMutation);\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.rightRemote = document.getElementById(\"right-cursor-controller\");\n      this.leftRemote = document.getElementById(\"left-cursor-controller\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.onObject3DSet);\n      scene.addEventListener(\"object3dremove\", this.onObject3DRemove);\n    });\n  }\n\n  tick(t) {\n    if (\n      this.dirty ||\n      enteredCursorRaycastableQuery(APP.world).length ||\n      exitedCurserRaycastableQuery(APP.world).length\n    ) {\n      this.populateEntities(this.targets);\n      this.dirty = false;\n    }\n\n    if (this.rightRemote) {\n      this.rightRemote.components[\"cursor-controller\"].tick2(t);\n    }\n\n    if (this.leftRemote) {\n      this.leftRemote.components[\"cursor-controller\"].tick2(t, true);\n    }\n  }\n\n  onObject3DSet() {\n    this.dirty = true;\n  }\n\n  onObject3DRemove() {\n    this.dirty = true;\n  }\n\n  onMutation(records) {\n    // let's try to avoid re-querying the targets on attribute changes we know we can ignore\n    if (records.some(r => r.type === \"childList\" || (r.type === \"attributes\" && r.attributeName === \"class\"))) {\n      this.dirty = true;\n    }\n  }\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\n      \".collidable, .interactable, .ui, .drawing, .occupiable-waypoint-icon, .teleport-waypoint-icon, .avatar-inspect-collider\"\n    );\n    for (let i = 0; i < els.length; i++) {\n      if (els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n\n    const eids = cursorRaycastableQuery(APP.world);\n    for (let i = 0; i < eids.length; i++) {\n      targets.push(APP.world.eid2obj.get(eids[i]));\n    }\n  }\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.onObject3DSet);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.onObject3DRemove);\n  }\n}\n","import { hasComponent } from \"bitecs\";\nimport {\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredHandLeft,\n  HoveredHandRight,\n  Pen\n} from \"../bit-components\";\nimport { CAMERA_MODE_INSPECT } from \"../systems/camera-system\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\nimport { hackyMobileSafariTest } from \"../utils/detect-touchscreen\";\nimport { paths } from \"./userinput/paths\";\n\nfunction shouldEnableRemote(world, scene, handHovering, handHeld, remoteHeld, teleporting, woke) {\n  const vrRemotePenIntersection =\n    scene.is(\"vr-mode\") &&\n    remoteHeld &&\n    hasComponent(world, Pen, remoteHeld) &&\n    world.eid2obj.get(remoteHeld).el.children[0].components.pen.intersection;\n\n  return scene.is(\"entered\") && woke && !handHovering && !handHeld && !teleporting && !vrRemotePenIntersection;\n}\n\nexport class CursorTogglingSystem {\n  constructor() {\n    this.wakeLeft = false;\n    this.wakeRight = false;\n\n    waitForDOMContentLoaded().then(() => {\n      this.domContentLoadedButComponentsMayNotHave = true;\n    });\n  }\n\n  tick(interaction, userinput, scene) {\n    if (!this.domContentLoadedButComponentsMayNotHave) return;\n    if (!this.gotComponentReferences) {\n      this.gotComponentReferences = true;\n      this.rightCursorController = document.getElementById(\"right-cursor-controller\").components[\"cursor-controller\"];\n      this.leftCursorController = document.getElementById(\"left-cursor-controller\").components[\"cursor-controller\"];\n      this.rightHandTeleporter = document.getElementById(\"player-right-controller\").components[\"teleporter\"];\n      this.leftHandTeleporter = document.getElementById(\"player-left-controller\").components[\"teleporter\"];\n      this.gazeTeleporter = document.getElementById(\"gaze-teleport\").components[\"teleporter\"];\n    }\n\n    const world = APP.world;\n\n    // TODO this is also in resolveActionSets. It might be we actually do want something like the legacy interaction system state\n    const leftHandHovering = anyEntityWith(world, HoveredHandLeft);\n    const leftHandHolding = anyEntityWith(world, HeldHandLeft);\n    const leftRemoteHolding = anyEntityWith(world, HeldRemoteLeft);\n    const rightHandHovering = anyEntityWith(world, HoveredHandRight);\n    const rightHandHolding = anyEntityWith(world, HeldHandRight);\n    const rightRemoteHolding = anyEntityWith(world, HeldRemoteRight);\n\n    if (userinput.get(paths.actions.cursor.right.wake)) {\n      this.wakeRight = true;\n      if (!leftRemoteHolding) {\n        this.wakeLeft = false;\n      }\n    }\n\n    if (userinput.get(paths.actions.cursor.left.wake)) {\n      this.wakeLeft = true;\n      if (!rightRemoteHolding) {\n        this.wakeRight = false;\n      }\n    }\n\n    const inspecting = interaction.el.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT;\n    const shouldEnableLeftRemote =\n      !inspecting &&\n      shouldEnableRemote(\n        world,\n        scene,\n        leftHandHovering,\n        leftHandHolding,\n        leftRemoteHolding,\n        this.leftHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting,\n        this.wakeLeft\n      );\n    const isMobile = AFRAME.utils.device.isMobile();\n    const shouldEnableRightRemote =\n      isMobile ||\n      hackyMobileSafariTest() ||\n      (!inspecting &&\n        shouldEnableRemote(\n          world,\n          scene,\n          rightHandHovering,\n          rightHandHolding,\n          rightRemoteHolding,\n          this.rightHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting,\n          this.wakeRight\n        ));\n\n    this.leftCursorController.enabled = shouldEnableLeftRemote;\n    this.rightCursorController.enabled = shouldEnableRightRemote;\n  }\n}\n","import { AmmoWorker, WorkerHelpers, CONSTANTS } from \"three-ammo\";\nimport { AmmoDebugConstants, DefaultBufferSize } from \"ammo-debug-drawer\";\nimport configs from \"../utils/configs\";\nimport ammoWasmUrl from \"ammo.js/builds/ammo.wasm.wasm\";\n\nconst MESSAGE_TYPES = CONSTANTS.MESSAGE_TYPES,\n  TYPE = CONSTANTS.TYPE,\n  BUFFER_CONFIG = CONSTANTS.BUFFER_CONFIG;\n\nconst WORLD_CONFIG = {\n  debugDrawMode: AmmoDebugConstants.DrawWireframe,\n  gravity: { x: 0, y: -9.8, z: 0 }\n};\n\nconst MAX_BODIES = 512;\n\nexport class PhysicsSystem {\n  constructor(scene) {\n    this.ammoWorker = new AmmoWorker();\n    this.workerHelpers = new WorkerHelpers(this.ammoWorker);\n\n    this.bodyUuids = [];\n    this.indexToUuid = {};\n    this.bodyUuidToData = new Map();\n\n    this.debug = false;\n    this.debugRequested = false;\n    this.debugEnabled = false;\n    this.scene = scene;\n    this.stepDuration = 0;\n\n    this.ready = false;\n    this.nextBodyUuid = 1;\n    this.nextShapeUuid = 1;\n\n    const arrayBuffer = new ArrayBuffer(4 * BUFFER_CONFIG.BODY_DATA_SIZE * MAX_BODIES);\n    this.objectMatricesFloatArray = new Float32Array(arrayBuffer);\n    this.objectMatricesIntArray = new Int32Array(arrayBuffer);\n\n    this.ammoWorker.postMessage(\n      {\n        type: MESSAGE_TYPES.INIT,\n        worldConfig: WORLD_CONFIG,\n        arrayBuffer,\n        maxBodies: MAX_BODIES,\n        wasmUrl: new URL(ammoWasmUrl, configs.BASE_ASSETS_PATH || window.location).href\n      },\n      [arrayBuffer]\n    );\n\n    this.ammoWorker.onmessage = async event => {\n      if (event.data.type === MESSAGE_TYPES.READY) {\n        this.ready = true;\n      } else if (event.data.type === MESSAGE_TYPES.BODY_READY) {\n        const { uuid, index } = event.data;\n        const bodyData = this.bodyUuidToData.get(uuid);\n        bodyData.index = index;\n        bodyData.isInitialized = true;\n        if (bodyData.removeBodyMessageSent) {\n          this.bodyUuidToData.delete(uuid);\n        } else {\n          this.bodyUuids.push(uuid);\n          this.indexToUuid[index] = uuid;\n        }\n      } else if (event.data.type === MESSAGE_TYPES.SHAPES_READY) {\n        const bodyUuid = event.data.bodyUuid;\n        const shapesUuid = event.data.shapesUuid;\n        if (this.bodyUuidToData.has(bodyUuid)) {\n          this.bodyUuidToData.get(bodyUuid).shapes.push(shapesUuid);\n        } else {\n          console.warn(`Shape initialized on worker but body is missing.`);\n        }\n      } else if (event.data.type === MESSAGE_TYPES.TRANSFER_DATA) {\n        this.objectMatricesFloatArray = event.data.objectMatricesFloatArray;\n        this.objectMatricesIntArray = new Int32Array(this.objectMatricesFloatArray.buffer);\n        this.stepDuration = event.data.stepDuration;\n      }\n    };\n  }\n\n  setDebug(debug) {\n    this.debugRequested = debug;\n  }\n\n  enableDebug() {\n    if (!window.SharedArrayBuffer) {\n      console.warn(\"Physics debug rendering only available in browsers that support SharedArrayBuffers.\");\n      this.debugRequested = false;\n      return;\n    }\n\n    this.debugEnabled = true;\n\n    if (!this.debugMesh) {\n      this.debugSharedArrayBuffer = new window.SharedArrayBuffer(4 + 2 * DefaultBufferSize * 4);\n      this.debugIndex = new Uint32Array(this.debugSharedArrayBuffer, 0, 4);\n      const debugVertices = new Float32Array(this.debugSharedArrayBuffer, 4, DefaultBufferSize);\n      const debugColors = new Float32Array(this.debugSharedArrayBuffer, 4 + DefaultBufferSize, DefaultBufferSize);\n      this.debugGeometry = new THREE.BufferGeometry();\n      this.debugGeometry.addAttribute(\"position\", new THREE.BufferAttribute(debugVertices, 3));\n      this.debugGeometry.addAttribute(\"color\", new THREE.BufferAttribute(debugColors, 3));\n      const debugMaterial = new THREE.LineBasicMaterial({\n        vertexColors: true,\n        depthTest: true\n      });\n      this.debugMesh = new THREE.LineSegments(this.debugGeometry, debugMaterial);\n      this.debugMesh.frustumCulled = false;\n      this.debugMesh.renderOrder = 999;\n    }\n\n    if (!this.debugMesh.parent) {\n      this.scene.add(this.debugMesh);\n      this.workerHelpers.enableDebug(true, this.debugSharedArrayBuffer);\n    }\n  }\n\n  disableDebug() {\n    this.debugEnabled = false;\n    if (this.debugMesh) {\n      this.scene.remove(this.debugMesh);\n      this.workerHelpers.enableDebug(false);\n    }\n  }\n\n  tick = (() => {\n    const transform = new THREE.Matrix4();\n    const inverse = new THREE.Matrix4();\n    const matrix = new THREE.Matrix4();\n    const scale = new THREE.Vector3();\n    return function () {\n      if (this.ready) {\n        if (this.debugRequested !== this.debugEnabled) {\n          if (this.debugRequested) {\n            this.enableDebug();\n          } else {\n            this.disableDebug();\n          }\n        }\n\n        /** Buffer Schema\n         * Every physics body has 26 * 4 bytes (64bit float/int) assigned in the buffer\n         * 0-15   Matrix4 elements (floats)\n         * 16     Linear Velocity (float)\n         * 17     Angular Velocity (float)\n         * 18-25  first 8 Collisions (ints)\n         */\n\n        if (this.objectMatricesFloatArray.buffer.byteLength !== 0) {\n          for (let i = 0; i < this.bodyUuids.length; i++) {\n            const uuid = this.bodyUuids[i];\n            const body = this.bodyUuidToData.get(uuid);\n            const index = body.index;\n            const type = body.options.type ? body.options.type : TYPE.DYNAMIC;\n            const object3D = body.object3D;\n            if (!object3D.parent) {\n              // TODO: Fix me\n              console.error(\"Physics body exists but object3D has no parent.\");\n              continue;\n            }\n            if (type === TYPE.DYNAMIC) {\n              matrix.fromArray(\n                this.objectMatricesFloatArray,\n                index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.MATRIX_OFFSET\n              );\n              object3D.parent.updateMatrices();\n              inverse.copy(object3D.parent.matrixWorld).invert();\n              transform.multiplyMatrices(inverse, matrix);\n              transform.decompose(object3D.position, object3D.quaternion, scale);\n              object3D.matrixNeedsUpdate = true;\n            }\n\n            object3D.updateMatrices();\n            this.objectMatricesFloatArray.set(\n              object3D.matrixWorld.elements,\n              index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.MATRIX_OFFSET\n            );\n\n            body.linearVelocity =\n              this.objectMatricesFloatArray[\n                index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.LINEAR_VELOCITY_OFFSET\n              ];\n\n            body.angularVelocity =\n              this.objectMatricesFloatArray[\n                index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.ANGULAR_VELOCITY_OFFSET\n              ];\n\n            body.collisions.length = 0;\n\n            for (let j = BUFFER_CONFIG.COLLISIONS_OFFSET; j < BUFFER_CONFIG.BODY_DATA_SIZE; j++) {\n              const collidingIndex = this.objectMatricesIntArray[index * BUFFER_CONFIG.BODY_DATA_SIZE + j];\n              if (collidingIndex !== -1) {\n                const collision = this.indexToUuid[collidingIndex];\n                if (collision !== undefined) {\n                  // This will happen whenever you delete an object that is colliding with something\n                  // because we eagerly delete from the map when removing a body.\n                  body.collisions.push(this.indexToUuid[collidingIndex]);\n                }\n              }\n            }\n          }\n\n          this.ammoWorker.postMessage(\n            { type: MESSAGE_TYPES.TRANSFER_DATA, objectMatricesFloatArray: this.objectMatricesFloatArray },\n            [this.objectMatricesFloatArray.buffer]\n          );\n        }\n\n        /* DEBUG RENDERING */\n        if (this.debugEnabled) {\n          const index = window.Atomics.load(this.debugIndex, 0);\n          if (index !== 0) {\n            this.debugGeometry.attributes.position.needsUpdate = true;\n            this.debugGeometry.attributes.color.needsUpdate = true;\n          }\n          this.debugGeometry.setDrawRange(0, index);\n          window.Atomics.store(this.debugIndex, 0, 0);\n        }\n      }\n    };\n  })();\n\n  addBody(object3D, options) {\n    const bodyId = this.nextBodyUuid;\n    this.nextBodyUuid += 1;\n\n    this.workerHelpers.addBody(bodyId, object3D, options);\n\n    this.bodyUuidToData.set(bodyId, {\n      object3D: object3D,\n      options: options,\n      collisions: [],\n      linearVelocity: 0,\n      angularVelocity: 0,\n      index: -1,\n      shapes: [],\n      isInitialized: false,\n      removeBodyMessageSent: false\n    });\n\n    return bodyId;\n  }\n\n  updateBody(uuid, options) {\n    if (this.bodyUuidToData.has(uuid)) {\n      this.bodyUuidToData.get(uuid).options = options;\n      this.workerHelpers.updateBody(uuid, options);\n    } else {\n      console.warn(`updateBody called for uuid: ${uuid} but body missing.`);\n    }\n  }\n\n  // TODO inline updateBody\n  updateBodyOptions(bodyId, options) {\n    const bodyData = this.bodyUuidToData.get(bodyId);\n    if (!bodyData) {\n      // TODO: Fix me.\n      console.warn(\"updateBodyOptions called for invalid bodyId\");\n      return;\n    }\n    this.workerHelpers.updateBody(bodyId, Object.assign(this.bodyUuidToData.get(bodyId).options, options));\n  }\n\n  removeBody(uuid) {\n    const bodyData = this.bodyUuidToData.get(uuid);\n    if (!bodyData) {\n      // TODO: REMOVE ME. We should not ever see this!\n      console.error(`removeBody called for unknown body id`);\n      return;\n    }\n\n    this.workerHelpers.removeBody(uuid);\n    bodyData.removeBodyMessageSent = true;\n\n    if (bodyData.isInitialized) {\n      delete this.indexToUuid[bodyData.index];\n      bodyData.collisions.forEach(otherId => {\n        const otherData = this.bodyUuidToData.get(otherId).collisions;\n        otherData.splice(otherData.indexOf(uuid), 1);\n      });\n      this.bodyUuids.splice(this.bodyUuids.indexOf(uuid), 1);\n      this.bodyUuidToData.delete(uuid);\n    }\n  }\n\n  addShapes(bodyUuid, mesh, options) {\n    if (mesh) {\n      const scale = new THREE.Vector3();\n      mesh.updateMatrices();\n      scale.setFromMatrixScale(mesh.matrixWorld);\n    }\n    this.workerHelpers.addShapes(bodyUuid, this.nextShapeUuid, mesh, options);\n    this.bodyUuidToData.get(bodyUuid).shapes.push(this.nextShapeUuid);\n    return this.nextShapeUuid++;\n  }\n\n  removeShapes(bodyUuid, shapesUuid) {\n    if (this.bodyUuidToData.has(bodyUuid)) {\n      this.workerHelpers.removeShapes(bodyUuid, shapesUuid);\n      const idx = this.bodyUuidToData.get(bodyUuid).shapes.indexOf(shapesUuid);\n      if (idx !== -1) {\n        this.bodyUuidToData.get(bodyUuid).shapes.splice(idx, 1);\n      } else {\n        console.warn(`removeShapes called for shapesUuid: ${shapesUuid} on bodyUuid: ${bodyUuid} but shapes missing.`);\n      }\n    } else {\n      console.error(`Tried to remove shape for unknown body ${bodyUuid}`);\n    }\n  }\n\n  addConstraint(constraintId, bodyUuid, targetUuid, options) {\n    this.workerHelpers.addConstraint(constraintId, bodyUuid, targetUuid, options);\n  }\n\n  removeConstraint(constraintId) {\n    this.workerHelpers.removeConstraint(constraintId);\n  }\n\n  bodyInitialized(uuid) {\n    return this.bodyUuidToData.has(uuid) && this.bodyUuidToData.get(uuid).index !== -1;\n  }\n\n  getLinearVelocity(uuid) {\n    return this.bodyUuidToData.get(uuid).linearVelocity;\n  }\n\n  getAngularVelocity(uuid) {\n    return this.bodyUuidToData.get(uuid).angularVelocity;\n  }\n\n  getCollisions(uuid) {\n    return this.bodyUuidToData.get(uuid).collisions;\n  }\n\n  resetDynamicBody(uuid) {\n    this.workerHelpers.resetDynamicBody(uuid);\n  }\n\n  activateBody(uuid) {\n    this.workerHelpers.activateBody(uuid);\n  }\n}\n","/* global THREE AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst COLLISION_FILTER_MASK_HANDS = { collisionFilterMask: COLLISION_LAYERS.HANDS };\nexport const distanceBetweenStretchers = (() => {\n  const a = new THREE.Vector3();\n  const b = new THREE.Vector3();\n  return function distanceBetweenStretchers(obj1, obj2) {\n    obj1.getWorldPosition(a);\n    obj2.getWorldPosition(b);\n    return a.distanceTo(b);\n  };\n})();\n\nfunction existsAndHeldInEither(object, holderA, holderB) {\n  return object && (object === holderA.held || object === holderB.held);\n}\n\nexport class TwoPointStretchingSystem {\n  constructor() {\n    this.initialScale = new THREE.Vector3();\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    const { leftHand, rightHand, rightRemote, leftRemote } = interaction.state;\n\n    const stretching =\n      existsAndHeldInEither(leftHand.held, rightHand, rightRemote) ||\n      existsAndHeldInEither(leftRemote.held, rightHand, rightRemote);\n    const stretched = leftHand.held || leftRemote.held;\n    let leftStretcher, rightStretcher;\n    if (stretching) {\n      leftStretcher = leftHand.held\n        ? interaction.options.leftHand.entity.object3D\n        : interaction.options.leftRemote.entity.object3D;\n      rightStretcher = rightHand.held\n        ? interaction.options.rightHand.entity.object3D\n        : interaction.options.rightRemote.entity.object3D;\n      if (\n        leftStretcher !== this.previousLeftStretcher ||\n        rightStretcher !== this.previousRightStretcher ||\n        stretched !== this.stretched\n      ) {\n        this.initialStretchDistance = distanceBetweenStretchers(leftStretcher, rightStretcher);\n        this.stretched = stretched;\n        this.initialScale.copy(this.stretched.object3D.scale);\n        if (this.stretched.components[\"ammo-body\"]) {\n          this.stretched.setAttribute(\"ammo-body\", COLLISION_FILTER_MASK_HANDS);\n        }\n      }\n\n      this.stretched.object3D.scale\n        .copy(this.initialScale)\n        .multiplyScalar(distanceBetweenStretchers(leftStretcher, rightStretcher) / this.initialStretchDistance);\n      this.stretched.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.previousLeftStretcher = leftStretcher;\n    this.previousRightStretcher = rightStretcher;\n  }\n}\n","import { isTagged } from \"../components/tags\";\n\nexport class HoldableButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const held = interaction.state.rightRemote.held;\n\n    if (this.prevHeld && this.prevHeld !== held) {\n      // TODO: Should this check for holdable button?\n      this.prevHeld.object3D.dispatchEvent({\n        type: \"holdable-button-up\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n    if (held && this.prevHeld !== held) {\n      held.object3D.dispatchEvent({\n        type: \"holdable-button-down\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n\n    this.prevHeld = held;\n\n    const heldLeft = interaction.state.leftRemote.held;\n\n    if (this.prevHeldLeft && this.prevHeldLeft !== heldLeft) {\n      isTagged(this.prevHeldLeft, \"holdableButton\") &&\n        this.prevHeldLeft.object3D.dispatchEvent({\n          type: \"holdable-button-up\",\n          object3D: interaction.options.leftRemote.entity.object3D\n        });\n    }\n    if (heldLeft && this.prevHeldLeft !== heldLeft) {\n      isTagged(this.heldLeft, \"holdableButton\") &&\n        heldLeft.object3D.dispatchEvent({\n          type: \"holdable-button-down\",\n          object3D: interaction.options.leftRemote.entity.object3D\n        });\n    }\n\n    this.prevHeldLeft = heldLeft;\n  }\n}\n\nconst hasButtonComponent = (function() {\n  const BUTTON_COMPONENT_NAMES = [\n    \"icon-button\",\n    \"text-button\",\n    \"pin-networked-object-button\",\n    \"mic-button\",\n    \"inspect-button\"\n  ];\n  return function hasButtonComponent(components) {\n    for (let i = 0; i < BUTTON_COMPONENT_NAMES.length; i++) {\n      if (components[BUTTON_COMPONENT_NAMES[i]]) {\n        return true;\n      }\n    }\n    return false;\n  };\n})();\n\nfunction getHoverableButton(hovered) {\n  if (!hovered) return null;\n\n  if (\n    hasButtonComponent(hovered.components) ||\n    hovered.classList.contains(\"teleport-waypoint-icon\") ||\n    hovered.classList.contains(\"occupiable-waypoint-icon\")\n  ) {\n    return hovered;\n  }\n  if (hovered.children) {\n    // TODO: not sure if looping thru children here is desireable, but we did this to accomodate the rounded-button mixins\n    for (let i = 0; i < hovered.children.length; i++) {\n      if (\n        hasButtonComponent(hovered.children[i].components) ||\n        hovered.children[i].classList.contains(\"teleport-waypoint-icon\") ||\n        hovered.children[i].classList.contains(\"occupiable-waypoint-icon\")\n      ) {\n        return hovered.children[i];\n      }\n    }\n  }\n  return null;\n}\n\nfunction dispatch(el, event) {\n  el.object3D.dispatchEvent(event);\n  if (el.children) {\n    for (let i = 0; i < el.children.length; i++) {\n      if (\n        hasButtonComponent(el.children[i].components) ||\n        el.children[i].classList.contains(\"teleport-waypoint-icon\") ||\n        el.children[i].classList.contains(\"occupiable-waypoint-icon\")\n      ) {\n        el.children[i].object3D.dispatchEvent(event);\n      }\n    }\n  }\n}\n\nconst HOVERED = { type: \"hovered\" };\nconst UNHOVERED = { type: \"unhovered\" };\nexport class HoverButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const button = getHoverableButton(interaction.state.rightRemote.hovered);\n    const button2 = getHoverableButton(interaction.state.leftRemote.hovered);\n\n    if (this.prevButton && this.prevButton !== button) {\n      dispatch(this.prevButton, UNHOVERED);\n    }\n\n    if (button && this.prevButton !== button) {\n      dispatch(button, HOVERED);\n    }\n\n    this.prevButton = button;\n\n    // TODO: hover should respect both remotes\n    if (this.prevButtonLeft && this.prevButtonLeft !== button2) {\n      dispatch(this.prevButtonLeft, UNHOVERED);\n    }\n\n    if (button2 && this.prevButtonLeft !== button2) {\n      dispatch(button2, HOVERED);\n    }\n\n    this.prevButtonLeft = button2;\n  }\n}\n","import { hasComponent } from \"bitecs\";\nimport { SingleActionButton } from \"../bit-components\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { SOUND_PEN_UNDO_DRAW } from \"./sound-effects-system\";\n\n/**\n * Drawing Menu System\n * A system for showing menus for drawings.\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nexport class DrawingMenuSystem {\n  constructor(sceneEl) {\n    this.sceneEl = sceneEl;\n\n    this.sceneEl.addEventListener(\"stateremoved\", this.hideMenus.bind(this));\n\n    this.lastIntersection = new THREE.Vector3();\n\n    this.drawingMenus = [];\n    this.buttonMap = {};\n\n    waitForDOMContentLoaded().then(() => {\n      this.cursorControllers = document.querySelectorAll(\"[cursor-controller]\");\n      this.camera = this.sceneEl.querySelector(\"#avatar-pov-node\");\n    });\n  }\n\n  tick() {\n    if (!this.cursorControllers || this.cursorControllers.length === 0 || !this.camera) return;\n\n    if (this.sceneEl.is(\"frozen\") && window.APP.hubChannel.can(\"spawn_drawing\")) {\n      const hovered = this.getHovered();\n      if (hovered) {\n        for (let i = 0; i < this.cursorControllers.length; i++) {\n          if (this.cursorControllers[i].components[\"cursor-controller\"].intersection) {\n            const intersectionPoint = this.cursorControllers[i].components[\"cursor-controller\"].intersection.point;\n            this.showMenu(hovered, intersectionPoint);\n          }\n        }\n      }\n      this.handleButtons();\n      this.scaleMenus();\n    }\n  }\n\n  getMenuScale(distance) {\n    if (distance <= 1.5) {\n      return 0.5;\n    }\n    return Math.min(3, distance - 1);\n  }\n\n  scaleMenus = (() => {\n    const cameraWorldPos = new THREE.Vector3();\n    return function() {\n      if (!this.drawingMenus || this.drawingMenus.length === 0) return;\n\n      this.camera.object3D.getWorldPosition(cameraWorldPos);\n\n      for (let i = 0; i < this.drawingMenus.length; i++) {\n        const menu = this.drawingMenus[i];\n        if (menu.object3D.visible && !menu.getAttribute(\"animation__show\")) {\n          const dist = cameraWorldPos.distanceTo(menu.object3D.position);\n          menu.object3D.scale.setScalar(this.getMenuScale(dist));\n          menu.object3D.matrixNeedsUpdate = true;\n        }\n      }\n    };\n  })();\n\n  handleButtons = (() => {\n    const remotes = [\"rightRemote\", \"leftRemote\"];\n    return function() {\n      const interaction = AFRAME.scenes[0].systems.interaction;\n      const userinput = AFRAME.scenes[0].systems.userinput;\n\n      for (let i = 0; i < remotes.length; i++) {\n        const remote = remotes[i];\n        if (interaction.state[remote]) {\n          const hovered = interaction.state[remote].hovered;\n          if (\n            hovered &&\n            userinput.get(interaction.options[remote].grabPath) &&\n            hasComponent(APP.world, SingleActionButton, hovered.eid)\n          ) {\n            if (this.buttonMap[hovered.object3D.uuid]) {\n              const networkedEntity = this.buttonMap[hovered.object3D.uuid];\n              if (hovered.classList.contains(\"undo-drawing\")) {\n                networkedEntity.components[\"networked-drawing\"].undoDraw();\n                this.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\n              } else if (hovered.classList.contains(\"delete-drawing\")) {\n                NAF.utils.takeOwnership(networkedEntity);\n                this.sceneEl.removeChild(networkedEntity);\n              } else if (hovered.classList.contains(\"serialize-drawing\")) {\n                networkedEntity.components[\"networked-drawing\"].serializeDrawing().then(() => {\n                  const networkedEntity = this.buttonMap[hovered.object3D.uuid];\n                  NAF.utils.takeOwnership(networkedEntity);\n                  this.sceneEl.removeChild(networkedEntity);\n                });\n              }\n            }\n          }\n        }\n      }\n    };\n  })();\n\n  getHovered() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    let hovered = null;\n    if (\n      interaction.state.leftRemote &&\n      interaction.state.leftRemote.hovered &&\n      interaction.state.leftRemote.hovered.classList.contains(\"drawing\")\n    ) {\n      hovered = interaction.state.leftRemote.hovered;\n    } else if (\n      interaction.state.rightRemote &&\n      interaction.state.rightRemote.hovered &&\n      interaction.state.rightRemote.hovered.classList.contains(\"drawing\")\n    ) {\n      hovered = interaction.state.rightRemote.hovered;\n    }\n    return hovered;\n  }\n\n  showMenu = (() => {\n    const position = new THREE.Vector3();\n    const cameraWorldPos = new THREE.Vector3();\n    return function(hovered, intersectionPoint) {\n      const menu = hovered.children[0];\n\n      if (!menu.object3D.visible || !almostEquals(0.25, intersectionPoint, this.lastIntersection)) {\n        this.camera.object3D.getWorldPosition(cameraWorldPos);\n        position\n          .subVectors(cameraWorldPos, intersectionPoint)\n          .normalize()\n          .multiplyScalar(0.1);\n        menu.object3D.position.copy(intersectionPoint).add(position);\n        menu.object3D.lookAt(cameraWorldPos);\n        menu.object3D.matrixNeedsUpdate = true;\n        menu.object3D.visible = true;\n        this.lastIntersection.copy(intersectionPoint);\n\n        const isMine = hovered.components.networked.isMine();\n        menu.querySelector(\".undo-drawing\").object3D.visible = isMine;\n        menu.querySelector(\".serialize-drawing\").object3D.visible =\n          isMine && window.APP.hubChannel.can(\"spawn_and_move_media\");\n\n        const dist = cameraWorldPos.distanceTo(menu.object3D.position);\n        const finalScale = this.getMenuScale(dist);\n\n        menu.removeAttribute(\"animation__show\");\n\n        menu.setAttribute(\"animation__show\", {\n          property: \"scale\",\n          dur: 300,\n          from: { x: finalScale * 0.8, y: finalScale * 0.8, z: finalScale * 0.8 },\n          to: { x: finalScale, y: finalScale, z: finalScale },\n          easing: \"easeOutElastic\"\n        });\n\n        menu.addEventListener(\n          \"animationcomplete\",\n          () => {\n            menu.removeAttribute(\"animation__show\");\n          },\n          { once: true }\n        );\n      }\n    };\n  })();\n\n  hideMenus() {\n    if (!this.drawingMenus) return;\n\n    for (let i = 0; i < this.drawingMenus.length; i++) {\n      this.drawingMenus[i].object3D.visible = false;\n    }\n  }\n\n  registerDrawingMenu(networkedDrawingEl) {\n    const menuEl = networkedDrawingEl.querySelector(\".drawing-menu\");\n    this.drawingMenus.push(menuEl);\n    const undoButton = menuEl.querySelector(\".undo-drawing\");\n    this.buttonMap[undoButton.object3D.uuid] = networkedDrawingEl;\n    const deleteButton = menuEl.querySelector(\".delete-drawing\");\n    this.buttonMap[deleteButton.object3D.uuid] = networkedDrawingEl;\n    const serializeButton = menuEl.querySelector(\".serialize-drawing\");\n    this.buttonMap[serializeButton.object3D.uuid] = networkedDrawingEl;\n  }\n\n  unregisterDrawingMenu(networkedDrawingEl) {\n    const menuEl = networkedDrawingEl.querySelector(\".drawing-menu\");\n    const idx = this.drawingMenus.indexOf(menuEl);\n    if (idx !== -1) {\n      this.drawingMenus.splice(idx, 1);\n    }\n    const undoButton = menuEl.querySelector(\".undo-drawing\");\n    delete this.buttonMap[undoButton.object3D.uuid];\n    const deleteButton = menuEl.querySelector(\".delete-drawing\");\n    delete this.buttonMap[deleteButton.object3D.uuid];\n    const serializeButton = menuEl.querySelector(\".serialize-drawing\");\n    delete this.buttonMap[serializeButton.object3D.uuid];\n  }\n}\n","import { isTagged } from \"../components/tags\";\n\nfunction getSpecificHoverMenu(el) {\n  return (\n    el &&\n    el.components &&\n    (el.components[\"hover-menu\"] ||\n      el.components[\"hover-menu__video\"] ||\n      el.components[\"hover-menu__pager\"] ||\n      el.components[\"hover-menu__hubs-item\"] ||\n      el.components[\"hover-menu__link\"] ||\n      el.components[\"hover-menu__photo\"])\n  );\n}\n\nfunction findHoverMenu(hovered) {\n  if (!hovered) return null;\n  const hoverMenu = getSpecificHoverMenu(hovered);\n  // console.log(\"hoverMenu\", hoverMenu);\n  if (hoverMenu) {\n    return hoverMenu;\n  }\n  if (!isTagged(hovered, \"isHoverMenuChild\")) {\n    // console.log(\"not a hover menu child, aborting\", hovered);\n    return null;\n  }\n  let el = hovered.parentNode;\n  while (el && !getSpecificHoverMenu(el)) {\n    el = el.parentNode;\n  }\n  return getSpecificHoverMenu(el);\n}\n\nexport class HoverMenuSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const hoverMenu = findHoverMenu(interaction.state.rightRemote.hovered);\n\n    if (this.prevHoverMenu && this.prevHoverMenu !== hoverMenu) {\n      this.prevHoverMenu.hovering = false;\n      this.prevHoverMenu.applyHoverState();\n    }\n\n    if (hoverMenu && this.prevHoverMenu !== hoverMenu) {\n      hoverMenu.hovering = true;\n      hoverMenu.applyHoverState();\n    }\n\n    this.prevHoverMenu = hoverMenu;\n\n    //TODO: Menu be visible if either remote is hovering.\n    const hoverMenu2 = findHoverMenu(interaction.state.leftRemote.hovered);\n\n    if (this.prevHoverMenu2 && this.prevHoverMenu2 !== hoverMenu2) {\n      this.prevHoverMenu2.hovering = false;\n      this.prevHoverMenu2.applyHoverState();\n    }\n\n    if (hoverMenu2 && this.prevHoverMenu2 !== hoverMenu2) {\n      hoverMenu2.hovering = true;\n      hoverMenu2.applyHoverState();\n    }\n\n    this.prevHoverMenu2 = hoverMenu2;\n  }\n}\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { Held, HeldHandLeft, HeldHandRight, HeldRemoteLeft, HeldRemoteRight } from \"../bit-components\";\nimport { addComponent } from \"bitecs\";\n\n// WARNING: This system mutates interaction system state!\nexport class SuperSpawnerSystem {\n  maybeSpawn(state, grabPath, HeldComponent) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const superSpawner = state.hovered && state.hovered.components[\"super-spawner\"];\n\n    const isPermitted =\n      window.APP.hubChannel &&\n      (superSpawner && superSpawner.data.template === \"#interactable-emoji\"\n        ? window.APP.hubChannel.can(\"spawn_emoji\")\n        : window.APP.hubChannel.can(\"spawn_and_move_media\"));\n\n    if (\n      superSpawner &&\n      superSpawner.spawnedMediaScale &&\n      !superSpawner.cooldownTimeout &&\n      userinput.get(grabPath) &&\n      isPermitted\n    ) {\n      this.performSpawn(state, superSpawner, HeldComponent);\n    }\n  }\n\n  performSpawn(state, superSpawner, HeldComponent) {\n    const data = superSpawner.data;\n\n    const spawnedEntity = addMedia(\n      data.src,\n      data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      data.resolve,\n      true,\n      false,\n      data.mediaOptions\n    ).entity;\n\n    // TODO HACK objects become held mid frame here, so if something runs between here and\n    // when the networked component is initialized isMine will throw since data doesnt exist\n    // should probably fix isMine in networked aframe instead of merging this\n    if (spawnedEntity.components.networked && !spawnedEntity.components.networked.data) {\n      spawnedEntity.components.networked.data = {};\n    }\n\n    superSpawner.el.object3D.getWorldPosition(spawnedEntity.object3D.position);\n    superSpawner.el.object3D.getWorldQuaternion(spawnedEntity.object3D.quaternion);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n    superSpawner.el.emit(\"spawned-entity-created\", { target: spawnedEntity });\n\n    superSpawner.activateCooldown();\n\n    spawnedEntity.addEventListener(\n      \"media-loaded\",\n      () => {\n        spawnedEntity.object3D.scale.copy(superSpawner.spawnedMediaScale);\n        spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n        superSpawner.el.emit(\"spawned-entity-loaded\", { target: spawnedEntity });\n\n        // TODO we do this in media loaded as the entity doesn't appear to actually be initialized right away (and thus doesn't have an eid)\n        // This is fairly hacky and is why we had equally hacky \"spawning\" state stuff before. This goes away with non aframe entities so\n        // just localizing and carrying forward the hack for now.\n        addComponent(APP.world, HeldComponent, spawnedEntity.eid);\n        addComponent(APP.world, Held, spawnedEntity.eid);\n      },\n      { once: true }\n    );\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    this.maybeSpawn(interaction.state.leftHand, interaction.options.leftHand.grabPath, HeldHandLeft);\n    this.maybeSpawn(interaction.state.rightHand, interaction.options.rightHand.grabPath, HeldHandRight);\n    this.maybeSpawn(interaction.state.rightRemote, interaction.options.rightRemote.grabPath, HeldRemoteRight);\n    this.maybeSpawn(interaction.state.leftRemote, interaction.options.leftRemote.grabPath, HeldRemoteLeft);\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { distanceBetweenStretchers } from \"./two-point-stretching-system\";\n\nfunction copyState(previous, current, isTeleporting) {\n  previous.held = current.held;\n  previous.hovered = current.hovered;\n  previous.isTeleporting = isTeleporting;\n}\n\n// TODO: These strengths should be written into bindings, since vibration strength varies across devices.\nconst STRENGTH = {\n  DROP: 0.1,\n  PICKUP: 0.2,\n  BUTTON_PRESSED: 0.2,\n  HOVER: 0.08,\n  STRETCH_BASE: 0.05,\n  STRETCH_DISTANCE: 0.2,\n  TELEPORTING: 0.08,\n  TELEPORTED: 0.2\n};\n\nfunction determineStrength(previous, current, isTeleporting) {\n  if (previous.held && !current.held) {\n    return STRENGTH.DROP;\n  } else if (!previous.held && current.held) {\n    return STRENGTH.PICKUP;\n  } else if (!previous.hovered && current.hovered) {\n    return STRENGTH.HOVER;\n  } else if (isTeleporting) {\n    return STRENGTH.TELEPORTING;\n  } else if (previous.isTeleporting && !isTeleporting) {\n    return STRENGTH.TELEPORTED;\n  } else {\n    return 0;\n  }\n}\n\nfunction determineStretchStrength(stretchSystem) {\n  if (!stretchSystem.stretcherLeft || !stretchSystem.stretcherRight) {\n    return 0;\n  }\n\n  return THREE.MathUtils.clamp(\n    STRENGTH.STRETCH_BASE +\n      STRENGTH.STRETCH_DISTANCE *\n        Math.abs(\n          distanceBetweenStretchers(stretchSystem.stretcherLeft, stretchSystem.stretcherRight) -\n            stretchSystem.initialStretchDistance\n        ),\n    0,\n    0.5\n  );\n}\n\nexport class HapticFeedbackSystem {\n  constructor() {\n    this.state = {\n      rightHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      rightRemote: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      leftHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      leftRemote: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      }\n    };\n  }\n\n  tick(twoPointStretchingSystem, interactLeft, interactRight) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const leftActuator = userinput.get(paths.haptics.actuators.left);\n    const rightActuator = userinput.get(paths.haptics.actuators.right);\n    if (!leftActuator && !rightActuator) {\n      return;\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote, leftRemote } = interaction.state;\n    this.leftTeleporter =\n      this.leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n    this.rightTeleporter =\n      this.rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n\n    const leftHandStrength = determineStrength(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    const rightHandStrength = determineStrength(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    const rightRemoteStrength = determineStrength(this.state.rightRemote, rightRemote, false);\n    const leftRemoteStrength = determineStrength(this.state.leftRemote, leftRemote, false);\n    const buttonLeftStrength = interactLeft ? STRENGTH.BUTTON_PRESSED : 0;\n    const buttonRightStrength = interactRight ? STRENGTH.BUTTON_PRESSED : 0;\n    const stretchingStrength = determineStretchStrength(twoPointStretchingSystem);\n\n    const leftStrength = Math.max(leftHandStrength, leftRemoteStrength, stretchingStrength, buttonLeftStrength);\n    const rightStrength = Math.max(rightHandStrength, rightRemoteStrength, stretchingStrength, buttonRightStrength);\n\n    if (leftStrength && leftActuator) {\n      leftActuator.pulse(leftStrength, 15);\n    }\n\n    if (rightStrength && rightActuator) {\n      rightActuator.pulse(rightStrength, 15);\n    }\n\n    copyState(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    copyState(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    copyState(this.state.rightRemote, rightRemote, false);\n    copyState(this.state.leftRemote, leftRemote, false);\n  }\n}\n","import { CAMERA_MODE_INSPECT } from \"./camera-system.js\";\nimport { setMatrixWorld } from \"../utils/three-utils\";\n\nlet viewingCamera;\nlet uiRoot;\nexport class ScenePreviewCameraSystem {\n  constructor() {\n    this.entities = [];\n  }\n\n  register(el) {\n    this.entities.push(el);\n  }\n\n  unregister(el) {\n    this.entities.splice(this.entities.indexOf(el), 1);\n  }\n\n  tick() {\n    viewingCamera = viewingCamera || document.getElementById(\"viewing-camera\");\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    const entered = viewingCamera && viewingCamera.sceneEl.is(\"entered\");\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n    for (let i = 0; i < this.entities.length; i++) {\n      const el = this.entities[i];\n      const hubsSystems = AFRAME.scenes[0].systems[\"hubs-systems\"];\n      if (el && (!hubsSystems || (hubsSystems.cameraSystem.mode !== CAMERA_MODE_INSPECT && !isGhost && !entered))) {\n        el.components[\"scene-preview-camera\"].tick2();\n        if (hubsSystems && viewingCamera) {\n          el.object3D.updateMatrices();\n          setMatrixWorld(viewingCamera.object3DMap.camera, el.object3D.matrixWorld);\n        }\n      }\n    }\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { SOUND_HOVER_OR_GRAB } from \"./sound-effects-system\";\nimport { isUI } from \"./interactions\";\nimport {\n  HeldHandLeft,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldRemoteRight,\n  HoveredHandLeft,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredRemoteRight\n} from \"../bit-components\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\n\nexport class InteractionSfxSystem {\n  constructor() {}\n\n  tick(interaction, userinput, sfx) {\n    const state = interaction.state;\n    const previousState = interaction.previousState;\n\n    if (\n      state.leftHand.held !== previousState.leftHand.held ||\n      state.rightHand.held !== previousState.rightHand.held ||\n      state.rightRemote.held !== previousState.rightRemote.held ||\n      (isUI(state.rightRemote.hovered) && state.rightRemote.hovered !== previousState.rightRemote.hovered) ||\n      state.leftRemote.held !== previousState.leftRemote.held ||\n      (isUI(state.leftRemote.hovered) && state.leftRemote.hovered !== previousState.leftRemote.hovered)\n    ) {\n      sfx.playSoundOneShot(SOUND_HOVER_OR_GRAB);\n    }\n\n    if (userinput.get(paths.actions.logInteractionState)) {\n      console.log(\n        \"Interaction System State\\nleftHand held\",\n        state.leftHand.held,\n        \"\\nleftHand hovered\",\n        state.leftHand.hovered,\n        \"\\nrightHand held\",\n        state.rightHand.held,\n        \"\\nrightHand hovered\",\n        state.rightHand.hovered,\n        \"\\nrightRemote held\",\n        state.rightRemote.held,\n        \"\\nrightRemote hovered\",\n        state.rightRemote.hovered,\n        \"\\nleftRemote held\",\n        state.leftRemote.held,\n        \"\\nleftRemote hovered\",\n        state.leftRemote.hovered\n      );\n\n      console.log(\n        \"Interaction System State\\nleftHand held\",\n        anyEntityWith(APP.world, HeldHandLeft),\n        \"\\nleftHand hovered\",\n        anyEntityWith(APP.world, HoveredHandLeft),\n        \"\\nrightHand held\",\n        anyEntityWith(APP.world, HeldHandRight),\n        \"\\nrightHand hovered\",\n        anyEntityWith(APP.world, HoveredHandRight),\n        \"\\nrightRemote held\",\n        anyEntityWith(APP.world, HeldRemoteRight),\n        \"\\nrightRemote hovered\",\n        anyEntityWith(APP.world, HoveredRemoteRight),\n        \"\\nleftRemote held\",\n        anyEntityWith(APP.world, HeldRemoteLeft),\n        \"\\nleftRemote hovered\",\n        anyEntityWith(APP.world, HoveredRemoteLeft)\n      );\n    }\n  }\n}\n","import \"./configs\";\nimport { getThemeColor } from \"./theme\";\nimport ColorShiftWorker from \"../workers/color-shift.worker.js\";\nimport { promisifyWorker } from \"./promisify-worker.js\";\nconst colorShift = promisifyWorker(new ColorShiftWorker());\n\nfunction getThemeColorShifter(type) {\n  // Goal of this algorithm is to take a ctx pointing to a spritesheet\n  // that has a single saturated color, and convert it to another.\n  return async (ctx, w, h) => {\n    const data = ctx.getImageData(0, 0, w, h);\n    const color = type === \"action\" ? getThemeColor(\"action-color\") : getThemeColor(\"notice-background-color\");\n    const res = await colorShift(data.data.buffer, [data.data.buffer], { type, color });\n    ctx.putImageData(new ImageData(res, w, h), 0, 0);\n  };\n}\n\nexport { getThemeColorShifter };\n","\nimport worker from \"!!../../node_modules/worker-loader/dist/runtime/inline.js\";\n\nexport default function Worker_fn() {\n  return worker(\"!function(){var r={168:function(r,n,t){var e=t(874),a={};for(var o in e)e.hasOwnProperty(o)&&(a[e[o]]=o);var l=r.exports={rgb:{channels:3,labels:\\\"rgb\\\"},hsl:{channels:3,labels:\\\"hsl\\\"},hsv:{channels:3,labels:\\\"hsv\\\"},hwb:{channels:3,labels:\\\"hwb\\\"},cmyk:{channels:4,labels:\\\"cmyk\\\"},xyz:{channels:3,labels:\\\"xyz\\\"},lab:{channels:3,labels:\\\"lab\\\"},lch:{channels:3,labels:\\\"lch\\\"},hex:{channels:1,labels:[\\\"hex\\\"]},keyword:{channels:1,labels:[\\\"keyword\\\"]},ansi16:{channels:1,labels:[\\\"ansi16\\\"]},ansi256:{channels:1,labels:[\\\"ansi256\\\"]},hcg:{channels:3,labels:[\\\"h\\\",\\\"c\\\",\\\"g\\\"]},apple:{channels:3,labels:[\\\"r16\\\",\\\"g16\\\",\\\"b16\\\"]},gray:{channels:1,labels:[\\\"gray\\\"]}};for(var i in l)if(l.hasOwnProperty(i)){if(!(\\\"channels\\\"in l[i]))throw new Error(\\\"missing channels property: \\\"+i);if(!(\\\"labels\\\"in l[i]))throw new Error(\\\"missing channel labels property: \\\"+i);if(l[i].labels.length!==l[i].channels)throw new Error(\\\"channel and label counts mismatch: \\\"+i);var s=l[i].channels,h=l[i].labels;delete l[i].channels,delete l[i].labels,Object.defineProperty(l[i],\\\"channels\\\",{value:s}),Object.defineProperty(l[i],\\\"labels\\\",{value:h})}l.rgb.hsl=function(r){var n,t,e=r[0]/255,a=r[1]/255,o=r[2]/255,l=Math.min(e,a,o),i=Math.max(e,a,o),s=i-l;return i===l?n=0:e===i?n=(a-o)/s:a===i?n=2+(o-e)/s:o===i&&(n=4+(e-a)/s),(n=Math.min(60*n,360))<0&&(n+=360),t=(l+i)/2,[n,100*(i===l?0:t<=.5?s/(i+l):s/(2-i-l)),100*t]},l.rgb.hsv=function(r){var n,t,e,a,o,l=r[0]/255,i=r[1]/255,s=r[2]/255,h=Math.max(l,i,s),u=h-Math.min(l,i,s),c=function(r){return(h-r)/6/u+.5};return 0===u?a=o=0:(o=u/h,n=c(l),t=c(i),e=c(s),l===h?a=e-t:i===h?a=1/3+n-e:s===h&&(a=2/3+t-n),a<0?a+=1:a>1&&(a-=1)),[360*a,100*o,100*h]},l.rgb.hwb=function(r){var n=r[0],t=r[1],e=r[2];return[l.rgb.hsl(r)[0],1/255*Math.min(n,Math.min(t,e))*100,100*(e=1-1/255*Math.max(n,Math.max(t,e)))]},l.rgb.cmyk=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255;return[100*((1-t-(n=Math.min(1-t,1-e,1-a)))/(1-n)||0),100*((1-e-n)/(1-n)||0),100*((1-a-n)/(1-n)||0),100*n]},l.rgb.keyword=function(r){var n=a[r];if(n)return n;var t,o,l,i=1/0;for(var s in e)if(e.hasOwnProperty(s)){var h=(o=r,l=e[s],Math.pow(o[0]-l[0],2)+Math.pow(o[1]-l[1],2)+Math.pow(o[2]-l[2],2));h<i&&(i=h,t=s)}return t},l.keyword.rgb=function(r){return e[r]},l.rgb.xyz=function(r){var n=r[0]/255,t=r[1]/255,e=r[2]/255;return[100*(.4124*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.3576*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.1805*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)),100*(.2126*n+.7152*t+.0722*e),100*(.0193*n+.1192*t+.9505*e)]},l.rgb.lab=function(r){var n=l.rgb.xyz(r),t=n[0],e=n[1],a=n[2];return e/=100,a/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]},l.hsl.rgb=function(r){var n,t,e,a,o,l=r[0]/360,i=r[1]/100,s=r[2]/100;if(0===i)return[o=255*s,o,o];n=2*s-(t=s<.5?s*(1+i):s+i-s*i),a=[0,0,0];for(var h=0;h<3;h++)(e=l+1/3*-(h-1))<0&&e++,e>1&&e--,o=6*e<1?n+6*(t-n)*e:2*e<1?t:3*e<2?n+(t-n)*(2/3-e)*6:n,a[h]=255*o;return a},l.hsl.hsv=function(r){var n=r[0],t=r[1]/100,e=r[2]/100,a=t,o=Math.max(e,.01);return t*=(e*=2)<=1?e:2-e,a*=o<=1?o:2-o,[n,100*(0===e?2*a/(o+a):2*t/(e+t)),(e+t)/2*100]},l.hsv.rgb=function(r){var n=r[0]/60,t=r[1]/100,e=r[2]/100,a=Math.floor(n)%6,o=n-Math.floor(n),l=255*e*(1-t),i=255*e*(1-t*o),s=255*e*(1-t*(1-o));switch(e*=255,a){case 0:return[e,s,l];case 1:return[i,e,l];case 2:return[l,e,s];case 3:return[l,i,e];case 4:return[s,l,e];case 5:return[e,l,i]}},l.hsv.hsl=function(r){var n,t,e,a=r[0],o=r[1]/100,l=r[2]/100,i=Math.max(l,.01);return e=(2-o)*l,t=o*i,[a,100*(t=(t/=(n=(2-o)*i)<=1?n:2-n)||0),100*(e/=2)]},l.hwb.rgb=function(r){var n,t,e,a,o,l,i,s=r[0]/360,h=r[1]/100,u=r[2]/100,c=h+u;switch(c>1&&(h/=c,u/=c),e=6*s-(n=Math.floor(6*s)),0!=(1&n)&&(e=1-e),a=h+e*((t=1-u)-h),n){default:case 6:case 0:o=t,l=a,i=h;break;case 1:o=a,l=t,i=h;break;case 2:o=h,l=t,i=a;break;case 3:o=h,l=a,i=t;break;case 4:o=a,l=h,i=t;break;case 5:o=t,l=h,i=a}return[255*o,255*l,255*i]},l.cmyk.rgb=function(r){var n=r[0]/100,t=r[1]/100,e=r[2]/100,a=r[3]/100;return[255*(1-Math.min(1,n*(1-a)+a)),255*(1-Math.min(1,t*(1-a)+a)),255*(1-Math.min(1,e*(1-a)+a))]},l.xyz.rgb=function(r){var n,t,e,a=r[0]/100,o=r[1]/100,l=r[2]/100;return t=-.9689*a+1.8758*o+.0415*l,e=.0557*a+-.204*o+1.057*l,n=(n=3.2406*a+-1.5372*o+-.4986*l)>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,[255*(n=Math.min(Math.max(0,n),1)),255*(t=Math.min(Math.max(0,t),1)),255*(e=Math.min(Math.max(0,e),1))]},l.xyz.lab=function(r){var n=r[0],t=r[1],e=r[2];return t/=100,e/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(t=t>.008856?Math.pow(t,1/3):7.787*t+16/116)-16,500*(n-t),200*(t-(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116))]},l.lab.xyz=function(r){var n,t,e,a=r[0];n=r[1]/500+(t=(a+16)/116),e=t-r[2]/200;var o=Math.pow(t,3),l=Math.pow(n,3),i=Math.pow(e,3);return t=o>.008856?o:(t-16/116)/7.787,n=l>.008856?l:(n-16/116)/7.787,e=i>.008856?i:(e-16/116)/7.787,[n*=95.047,t*=100,e*=108.883]},l.lab.lch=function(r){var n,t=r[0],e=r[1],a=r[2];return(n=360*Math.atan2(a,e)/2/Math.PI)<0&&(n+=360),[t,Math.sqrt(e*e+a*a),n]},l.lch.lab=function(r){var n,t=r[0],e=r[1];return n=r[2]/360*2*Math.PI,[t,e*Math.cos(n),e*Math.sin(n)]},l.rgb.ansi16=function(r){var n=r[0],t=r[1],e=r[2],a=1 in arguments?arguments[1]:l.rgb.hsv(r)[2];if(0===(a=Math.round(a/50)))return 30;var o=30+(Math.round(e/255)<<2|Math.round(t/255)<<1|Math.round(n/255));return 2===a&&(o+=60),o},l.hsv.ansi16=function(r){return l.rgb.ansi16(l.hsv.rgb(r),r[2])},l.rgb.ansi256=function(r){var n=r[0],t=r[1],e=r[2];return n===t&&t===e?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(t/255*5)+Math.round(e/255*5)},l.ansi16.rgb=function(r){var n=r%10;if(0===n||7===n)return r>50&&(n+=3.5),[n=n/10.5*255,n,n];var t=.5*(1+~~(r>50));return[(1&n)*t*255,(n>>1&1)*t*255,(n>>2&1)*t*255]},l.ansi256.rgb=function(r){if(r>=232){var n=10*(r-232)+8;return[n,n,n]}var t;return r-=16,[Math.floor(r/36)/5*255,Math.floor((t=r%36)/6)/5*255,t%6/5*255]},l.rgb.hex=function(r){var n=(((255&Math.round(r[0]))<<16)+((255&Math.round(r[1]))<<8)+(255&Math.round(r[2]))).toString(16).toUpperCase();return\\\"000000\\\".substring(n.length)+n},l.hex.rgb=function(r){var n=r.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var t=n[0];3===n[0].length&&(t=t.split(\\\"\\\").map((function(r){return r+r})).join(\\\"\\\"));var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]},l.rgb.hcg=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255,o=Math.max(Math.max(t,e),a),l=Math.min(Math.min(t,e),a),i=o-l;return n=i<=0?0:o===t?(e-a)/i%6:o===e?2+(a-t)/i:4+(t-e)/i+4,n/=6,[360*(n%=1),100*i,100*(i<1?l/(1-i):0)]},l.hsl.hcg=function(r){var n,t=r[1]/100,e=r[2]/100,a=0;return(n=e<.5?2*t*e:2*t*(1-e))<1&&(a=(e-.5*n)/(1-n)),[r[0],100*n,100*a]},l.hsv.hcg=function(r){var n=r[1]/100,t=r[2]/100,e=n*t,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},l.hcg.rgb=function(r){var n=r[0]/360,t=r[1]/100,e=r[2]/100;if(0===t)return[255*e,255*e,255*e];var a,o=[0,0,0],l=n%1*6,i=l%1,s=1-i;switch(Math.floor(l)){case 0:o[0]=1,o[1]=i,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=i;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=i,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return a=(1-t)*e,[255*(t*o[0]+a),255*(t*o[1]+a),255*(t*o[2]+a)]},l.hcg.hsv=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n),e=0;return t>0&&(e=n/t),[r[0],100*e,100*t]},l.hcg.hsl=function(r){var n=r[1]/100,t=r[2]/100*(1-n)+.5*n,e=0;return t>0&&t<.5?e=n/(2*t):t>=.5&&t<1&&(e=n/(2*(1-t))),[r[0],100*e,100*t]},l.hcg.hwb=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n);return[r[0],100*(t-n),100*(1-t)]},l.hwb.hcg=function(r){var n=r[1]/100,t=1-r[2]/100,e=t-n,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},l.apple.rgb=function(r){return[r[0]/65535*255,r[1]/65535*255,r[2]/65535*255]},l.rgb.apple=function(r){return[r[0]/255*65535,r[1]/255*65535,r[2]/255*65535]},l.gray.rgb=function(r){return[r[0]/100*255,r[0]/100*255,r[0]/100*255]},l.gray.hsl=l.gray.hsv=function(r){return[0,0,r[0]]},l.gray.hwb=function(r){return[0,100,r[0]]},l.gray.cmyk=function(r){return[0,0,0,r[0]]},l.gray.lab=function(r){return[r[0],0,0]},l.gray.hex=function(r){var n=255&Math.round(r[0]/100*255),t=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return\\\"000000\\\".substring(t.length)+t},l.rgb.gray=function(r){return[(r[0]+r[1]+r[2])/3/255*100]}},85:function(r,n,t){var e=t(168),a=t(111),o={};Object.keys(e).forEach((function(r){o[r]={},Object.defineProperty(o[r],\\\"channels\\\",{value:e[r].channels}),Object.defineProperty(o[r],\\\"labels\\\",{value:e[r].labels});var n=a(r);Object.keys(n).forEach((function(t){var e=n[t];o[r][t]=function(r){var n=function(n){if(null==n)return n;arguments.length>1&&(n=Array.prototype.slice.call(arguments));var t=r(n);if(\\\"object\\\"==typeof t)for(var e=t.length,a=0;a<e;a++)t[a]=Math.round(t[a]);return t};return\\\"conversion\\\"in r&&(n.conversion=r.conversion),n}(e),o[r][t].raw=function(r){var n=function(n){return null==n?n:(arguments.length>1&&(n=Array.prototype.slice.call(arguments)),r(n))};return\\\"conversion\\\"in r&&(n.conversion=r.conversion),n}(e)}))})),r.exports=o},111:function(r,n,t){var e=t(168);function a(r,n){return function(t){return n(r(t))}}function o(r,n){for(var t=[n[r].parent,r],o=e[n[r].parent][r],l=n[r].parent;n[l].parent;)t.unshift(n[l].parent),o=a(e[n[l].parent][l],o),l=n[l].parent;return o.conversion=t,o}r.exports=function(r){for(var n=function(r){var n=function(){for(var r={},n=Object.keys(e),t=n.length,a=0;a<t;a++)r[n[a]]={distance:-1,parent:null};return r}(),t=[r];for(n[r].distance=0;t.length;)for(var a=t.pop(),o=Object.keys(e[a]),l=o.length,i=0;i<l;i++){var s=o[i],h=n[s];-1===h.distance&&(h.distance=n[a].distance+1,h.parent=a,t.unshift(s))}return n}(r),t={},a=Object.keys(n),l=a.length,i=0;i<l;i++){var s=a[i];null!==n[s].parent&&(t[s]=o(s,n))}return t}},874:function(r){\\\"use strict\\\";r.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},818:function(r,n,t){var e=t(874),a=t(851),o=Object.hasOwnProperty,l=Object.create(null);for(var i in e)o.call(e,i)&&(l[e[i]]=i);var s=r.exports={to:{},get:{}};function h(r,n,t){return Math.min(Math.max(n,r),t)}function u(r){var n=Math.round(r).toString(16).toUpperCase();return n.length<2?\\\"0\\\"+n:n}s.get=function(r){var n,t;switch(r.substring(0,3).toLowerCase()){case\\\"hsl\\\":n=s.get.hsl(r),t=\\\"hsl\\\";break;case\\\"hwb\\\":n=s.get.hwb(r),t=\\\"hwb\\\";break;default:n=s.get.rgb(r),t=\\\"rgb\\\"}return n?{model:t,value:n}:null},s.get.rgb=function(r){if(!r)return null;var n,t,a,l=[0,0,0,1];if(n=r.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(a=n[2],n=n[1],t=0;t<3;t++){var i=2*t;l[t]=parseInt(n.slice(i,i+2),16)}a&&(l[3]=parseInt(a,16)/255)}else if(n=r.match(/^#([a-f0-9]{3,4})$/i)){for(a=(n=n[1])[3],t=0;t<3;t++)l[t]=parseInt(n[t]+n[t],16);a&&(l[3]=parseInt(a+a,16)/255)}else if(n=r.match(/^rgba?\\\\(\\\\s*([+-]?\\\\d+)(?=[\\\\s,])\\\\s*(?:,\\\\s*)?([+-]?\\\\d+)(?=[\\\\s,])\\\\s*(?:,\\\\s*)?([+-]?\\\\d+)\\\\s*(?:[,|\\\\/]\\\\s*([+-]?[\\\\d\\\\.]+)(%?)\\\\s*)?\\\\)$/)){for(t=0;t<3;t++)l[t]=parseInt(n[t+1],0);n[4]&&(n[5]?l[3]=.01*parseFloat(n[4]):l[3]=parseFloat(n[4]))}else{if(!(n=r.match(/^rgba?\\\\(\\\\s*([+-]?[\\\\d\\\\.]+)\\\\%\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)\\\\%\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)\\\\%\\\\s*(?:[,|\\\\/]\\\\s*([+-]?[\\\\d\\\\.]+)(%?)\\\\s*)?\\\\)$/)))return(n=r.match(/^(\\\\w+)$/))?\\\"transparent\\\"===n[1]?[0,0,0,0]:o.call(e,n[1])?((l=e[n[1]])[3]=1,l):null:null;for(t=0;t<3;t++)l[t]=Math.round(2.55*parseFloat(n[t+1]));n[4]&&(n[5]?l[3]=.01*parseFloat(n[4]):l[3]=parseFloat(n[4]))}for(t=0;t<3;t++)l[t]=h(l[t],0,255);return l[3]=h(l[3],0,1),l},s.get.hsl=function(r){if(!r)return null;var n=r.match(/^hsla?\\\\(\\\\s*([+-]?(?:\\\\d{0,3}\\\\.)?\\\\d+)(?:deg)?\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*(?:[,|\\\\/]\\\\s*([+-]?(?=\\\\.\\\\d|\\\\d)(?:0|[1-9]\\\\d*)?(?:\\\\.\\\\d*)?(?:[eE][+-]?\\\\d+)?)\\\\s*)?\\\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,h(parseFloat(n[2]),0,100),h(parseFloat(n[3]),0,100),h(isNaN(t)?1:t,0,1)]}return null},s.get.hwb=function(r){if(!r)return null;var n=r.match(/^hwb\\\\(\\\\s*([+-]?\\\\d{0,3}(?:\\\\.\\\\d+)?)(?:deg)?\\\\s*,\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*,\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*(?:,\\\\s*([+-]?(?=\\\\.\\\\d|\\\\d)(?:0|[1-9]\\\\d*)?(?:\\\\.\\\\d*)?(?:[eE][+-]?\\\\d+)?)\\\\s*)?\\\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,h(parseFloat(n[2]),0,100),h(parseFloat(n[3]),0,100),h(isNaN(t)?1:t,0,1)]}return null},s.to.hex=function(){var r=a(arguments);return\\\"#\\\"+u(r[0])+u(r[1])+u(r[2])+(r[3]<1?u(Math.round(255*r[3])):\\\"\\\")},s.to.rgb=function(){var r=a(arguments);return r.length<4||1===r[3]?\\\"rgb(\\\"+Math.round(r[0])+\\\", \\\"+Math.round(r[1])+\\\", \\\"+Math.round(r[2])+\\\")\\\":\\\"rgba(\\\"+Math.round(r[0])+\\\", \\\"+Math.round(r[1])+\\\", \\\"+Math.round(r[2])+\\\", \\\"+r[3]+\\\")\\\"},s.to.rgb.percent=function(){var r=a(arguments),n=Math.round(r[0]/255*100),t=Math.round(r[1]/255*100),e=Math.round(r[2]/255*100);return r.length<4||1===r[3]?\\\"rgb(\\\"+n+\\\"%, \\\"+t+\\\"%, \\\"+e+\\\"%)\\\":\\\"rgba(\\\"+n+\\\"%, \\\"+t+\\\"%, \\\"+e+\\\"%, \\\"+r[3]+\\\")\\\"},s.to.hsl=function(){var r=a(arguments);return r.length<4||1===r[3]?\\\"hsl(\\\"+r[0]+\\\", \\\"+r[1]+\\\"%, \\\"+r[2]+\\\"%)\\\":\\\"hsla(\\\"+r[0]+\\\", \\\"+r[1]+\\\"%, \\\"+r[2]+\\\"%, \\\"+r[3]+\\\")\\\"},s.to.hwb=function(){var r=a(arguments),n=\\\"\\\";return r.length>=4&&1!==r[3]&&(n=\\\", \\\"+r[3]),\\\"hwb(\\\"+r[0]+\\\", \\\"+r[1]+\\\"%, \\\"+r[2]+\\\"%\\\"+n+\\\")\\\"},s.to.keyword=function(r){return l[r.slice(0,3)]}},767:function(r,n,t){\\\"use strict\\\";var e=t(818),a=t(85),o=[].slice,l=[\\\"keyword\\\",\\\"gray\\\",\\\"hex\\\"],i={};Object.keys(a).forEach((function(r){i[o.call(a[r].labels).sort().join(\\\"\\\")]=r}));var s={};function h(r,n){if(!(this instanceof h))return new h(r,n);if(n&&n in l&&(n=null),n&&!(n in a))throw new Error(\\\"Unknown model: \\\"+n);var t,u;if(null==r)this.model=\\\"rgb\\\",this.color=[0,0,0],this.valpha=1;else if(r instanceof h)this.model=r.model,this.color=r.color.slice(),this.valpha=r.valpha;else if(\\\"string\\\"==typeof r){var c=e.get(r);if(null===c)throw new Error(\\\"Unable to parse color from string: \\\"+r);this.model=c.model,u=a[this.model].channels,this.color=c.value.slice(0,u),this.valpha=\\\"number\\\"==typeof c.value[u]?c.value[u]:1}else if(r.length){this.model=n||\\\"rgb\\\",u=a[this.model].channels;var g=o.call(r,0,u);this.color=f(g,u),this.valpha=\\\"number\\\"==typeof r[u]?r[u]:1}else if(\\\"number\\\"==typeof r)r&=16777215,this.model=\\\"rgb\\\",this.color=[r>>16&255,r>>8&255,255&r],this.valpha=1;else{this.valpha=1;var b=Object.keys(r);\\\"alpha\\\"in r&&(b.splice(b.indexOf(\\\"alpha\\\"),1),this.valpha=\\\"number\\\"==typeof r.alpha?r.alpha:0);var p=b.sort().join(\\\"\\\");if(!(p in i))throw new Error(\\\"Unable to parse color from object: \\\"+JSON.stringify(r));this.model=i[p];var v=a[this.model].labels,d=[];for(t=0;t<v.length;t++)d.push(r[v[t]]);this.color=f(d)}if(s[this.model])for(u=a[this.model].channels,t=0;t<u;t++){var m=s[this.model][t];m&&(this.color[t]=m(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function u(r,n,t){return(r=Array.isArray(r)?r:[r]).forEach((function(r){(s[r]||(s[r]=[]))[n]=t})),r=r[0],function(e){var a;return arguments.length?(t&&(e=t(e)),(a=this[r]()).color[n]=e,a):(a=this[r]().color[n],t&&(a=t(a)),a)}}function c(r){return function(n){return Math.max(0,Math.min(r,n))}}function f(r,n){for(var t=0;t<n;t++)\\\"number\\\"!=typeof r[t]&&(r[t]=0);return r}h.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(r){var n=this.model in e.to?this:this.rgb(),t=1===(n=n.round(\\\"number\\\"==typeof r?r:1)).valpha?n.color:n.color.concat(this.valpha);return e.to[n.model](t)},percentString:function(r){var n=this.rgb().round(\\\"number\\\"==typeof r?r:1),t=1===n.valpha?n.color:n.color.concat(this.valpha);return e.to.rgb.percent(t)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var r={},n=a[this.model].channels,t=a[this.model].labels,e=0;e<n;e++)r[t[e]]=this.color[e];return 1!==this.valpha&&(r.alpha=this.valpha),r},unitArray:function(){var r=this.rgb().color;return r[0]/=255,r[1]/=255,r[2]/=255,1!==this.valpha&&r.push(this.valpha),r},unitObject:function(){var r=this.rgb().object();return r.r/=255,r.g/=255,r.b/=255,1!==this.valpha&&(r.alpha=this.valpha),r},round:function(r){return r=Math.max(r||0,0),new h(this.color.map(function(r){return function(n){return function(r,n){return Number(r.toFixed(n))}(n,r)}}(r)).concat(this.valpha),this.model)},alpha:function(r){return arguments.length?new h(this.color.concat(Math.max(0,Math.min(1,r))),this.model):this.valpha},red:u(\\\"rgb\\\",0,c(255)),green:u(\\\"rgb\\\",1,c(255)),blue:u(\\\"rgb\\\",2,c(255)),hue:u([\\\"hsl\\\",\\\"hsv\\\",\\\"hsl\\\",\\\"hwb\\\",\\\"hcg\\\"],0,(function(r){return(r%360+360)%360})),saturationl:u(\\\"hsl\\\",1,c(100)),lightness:u(\\\"hsl\\\",2,c(100)),saturationv:u(\\\"hsv\\\",1,c(100)),value:u(\\\"hsv\\\",2,c(100)),chroma:u(\\\"hcg\\\",1,c(100)),gray:u(\\\"hcg\\\",2,c(100)),white:u(\\\"hwb\\\",1,c(100)),wblack:u(\\\"hwb\\\",2,c(100)),cyan:u(\\\"cmyk\\\",0,c(100)),magenta:u(\\\"cmyk\\\",1,c(100)),yellow:u(\\\"cmyk\\\",2,c(100)),black:u(\\\"cmyk\\\",3,c(100)),x:u(\\\"xyz\\\",0,c(100)),y:u(\\\"xyz\\\",1,c(100)),z:u(\\\"xyz\\\",2,c(100)),l:u(\\\"lab\\\",0,c(100)),a:u(\\\"lab\\\",1),b:u(\\\"lab\\\",2),keyword:function(r){return arguments.length?new h(r):a[this.model].keyword(this.color)},hex:function(r){return arguments.length?new h(r):e.to.hex(this.rgb().round().color)},rgbNumber:function(){var r=this.rgb().color;return(255&r[0])<<16|(255&r[1])<<8|255&r[2]},luminosity:function(){for(var r=this.rgb().color,n=[],t=0;t<r.length;t++){var e=r[t]/255;n[t]=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(r){var n=this.luminosity(),t=r.luminosity();return n>t?(n+.05)/(t+.05):(t+.05)/(n+.05)},level:function(r){var n=this.contrast(r);return n>=7.1?\\\"AAA\\\":n>=4.5?\\\"AA\\\":\\\"\\\"},isDark:function(){var r=this.rgb().color;return(299*r[0]+587*r[1]+114*r[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var r=this.rgb(),n=0;n<3;n++)r.color[n]=255-r.color[n];return r},lighten:function(r){var n=this.hsl();return n.color[2]+=n.color[2]*r,n},darken:function(r){var n=this.hsl();return n.color[2]-=n.color[2]*r,n},saturate:function(r){var n=this.hsl();return n.color[1]+=n.color[1]*r,n},desaturate:function(r){var n=this.hsl();return n.color[1]-=n.color[1]*r,n},whiten:function(r){var n=this.hwb();return n.color[1]+=n.color[1]*r,n},blacken:function(r){var n=this.hwb();return n.color[2]+=n.color[2]*r,n},grayscale:function(){var r=this.rgb().color,n=.3*r[0]+.59*r[1]+.11*r[2];return h.rgb(n,n,n)},fade:function(r){return this.alpha(this.valpha-this.valpha*r)},opaquer:function(r){return this.alpha(this.valpha+this.valpha*r)},rotate:function(r){var n=this.hsl(),t=n.color[0];return t=(t=(t+r)%360)<0?360+t:t,n.color[0]=t,n},mix:function(r,n){if(!r||!r.rgb)throw new Error('Argument to \\\"mix\\\" was not a Color instance, but rather an instance of '+typeof r);var t=r.rgb(),e=this.rgb(),a=void 0===n?.5:n,o=2*a-1,l=t.alpha()-e.alpha(),i=((o*l==-1?o:(o+l)/(1+o*l))+1)/2,s=1-i;return h.rgb(i*t.red()+s*e.red(),i*t.green()+s*e.green(),i*t.blue()+s*e.blue(),t.alpha()*a+e.alpha()*(1-a))}},Object.keys(a).forEach((function(r){if(-1===l.indexOf(r)){var n=a[r].channels;h.prototype[r]=function(){if(this.model===r)return new h(this);if(arguments.length)return new h(arguments,r);var t,e=\\\"number\\\"==typeof arguments[n]?n:this.valpha;return new h((t=a[this.model][r].raw(this.color),Array.isArray(t)?t:[t]).concat(e),r)},h[r]=function(t){return\\\"number\\\"==typeof t&&(t=f(o.call(arguments),n)),new h(t,r)}}})),r.exports=h},851:function(r,n,t){\\\"use strict\\\";var e=t(594),a=Array.prototype.concat,o=Array.prototype.slice,l=r.exports=function(r){for(var n=[],t=0,l=r.length;t<l;t++){var i=r[t];e(i)?n=a.call(n,o.call(i)):n.push(i)}return n};l.wrap=function(r){return function(){return r(l(arguments))}}},594:function(r){r.exports=function(r){return!(!r||\\\"string\\\"==typeof r)&&(r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&\\\"String\\\"!==r.constructor.name))}}},n={};function t(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,t),o.exports}t.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(n,{a:n}),n},t.d=function(r,n){for(var e in n)t.o(n,e)&&!t.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:n[e]})},t.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},function(){\\\"use strict\\\";var r=t(767),n=t.n(r);self.onmessage=r=>{const t=function(r,t){const e=\\\"action\\\"===r?n()(\\\"#ff3464\\\"):n()(\\\"#2F80ED\\\"),a=n()(t).hsl(),o=e.hsl(),l=a.hue()-o.hue(),i=a.saturationl()/o.saturationl(),s=a.lightness()/o.lightness();return r=>{const t=(()=>{const r=(r,n)=>Math.abs(r-n)<5;return(n,t,e)=>r(n,t)&&r(t,e)&&r(n,e)})(),e={};for(let a=0,o=r.length;a<o;a+=4){const o=r[a],h=r[a+1],u=r[a+2];if(!t(o,h,u)){const t=o+1e3*h+1e6*u;if(!e[t]){let r=n()({r:o,g:h,b:u}).hsl();r=r.rotate(l),r.color[1]*=i,r.color[2]*=s;const[a,c,f]=r.rgb().array();e[t]=[a,c,f]}const[c,f,g]=e[t];r[a]=c,r[a+1]=f,r[a+2]=g}}return r}}(r.data.type,r.data.color)(new Uint8ClampedArray(r.data.payload));self.postMessage({id:r.data.id,result:t})}}()}();\\n\", \"Worker\", undefined, undefined);\n}\n","/* global AFRAME THREE */\n\n// See doc/spritesheet-generation.md for information about this spritesheet\nimport spritesheetAction from \"../assets/images/spritesheets/sprite-system-action-spritesheet.json\";\nimport spritesheetNotice from \"../assets/images/spritesheets/sprite-system-notice-spritesheet.json\";\nimport { createImageTexture } from \"../utils/media-utils\";\nimport spritesheetActionPng from \"../assets/images/spritesheets/sprite-system-action-spritesheet.png\";\nimport spritesheetNoticePng from \"../assets/images/spritesheets/sprite-system-notice-spritesheet.png\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport vertexShader from \"./sprites/sprite.vert\";\nimport fragmentShader from \"./sprites/sprite.frag\";\nimport { getThemeColorShifter } from \"../utils/theme-sprites\";\nimport { disposeTexture } from \"../utils/material-utils\";\nimport { Layers } from \"../components/layers\";\n\nconst MAX_SPRITES = 1024;\nconst SHEET_TYPES = [\"action\", \"notice\"];\nconst PNGS = {\n  action: spritesheetActionPng,\n  notice: spritesheetNoticePng\n};\nconst ZEROS = new Array(16 * 4).fill(0);\n\nconst getSheetType = sprite => (spritesheetAction.frames[sprite.data.name] ? \"action\" : \"notice\");\n\nconst isVisible = o => {\n  if (!o.visible) return false;\n  if (!o.parent) return true;\n  return isVisible(o.parent);\n};\n\nAFRAME.registerComponent(\"sprite\", {\n  schema: { name: { type: \"string\" } },\n  tick() {\n    // TODO when we run out of sprites we currently just stop rendering them. We need to do something better.\n    if (!(this.didRegisterWithSystem || this.didFailToRegister) && this.el.sceneEl.systems[\"hubs-systems\"]) {\n      const registered = this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.add(this);\n      this.didRegisterWithSystem = registered > 0;\n      this.didFailToRegister = registered < 0;\n    }\n  },\n\n  update() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.updateUVs(this);\n    }\n  },\n\n  remove() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.remove(this);\n    }\n  }\n});\n\nconst normalizedFrame = (function() {\n  const memo = new Map();\n  return function normalizedFrame(name, spritesheet) {\n    let ret = memo.get(name);\n    if (ret) {\n      return ret;\n    } else {\n      if (!spritesheet.frames[name]) {\n        ret = { x: 0, y: 0, w: 0, h: 0 };\n        memo.set(name, ret);\n        return ret;\n      }\n      const size = spritesheet.meta.size;\n      const frame = spritesheet.frames[name].frame;\n      ret = {\n        x: frame.x / size.w,\n        y: frame.y / size.h,\n        w: frame.w / size.w,\n        h: frame.h / size.h\n      };\n      memo.set(name, ret);\n      return ret;\n    }\n  };\n})();\n\nconst raycastOnSprite = (function() {\n  const vA = new THREE.Vector3();\n  const vB = new THREE.Vector3();\n  const vC = new THREE.Vector3();\n  const vD = new THREE.Vector3();\n  const point = new THREE.Vector3();\n  const intersectionInfo = { distance: 0, point, object: null };\n\n  return function raycast(raycaster, intersects) {\n    this.updateMatrices();\n    vA.set(-0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vB.set(0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vC.set(-0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n    let intersect = raycaster.ray.intersectTriangle(vA, vC, vB, false, point);\n    if (intersect === null) {\n      vD.set(0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n      intersect = raycaster.ray.intersectTriangle(vB, vC, vD, false, point);\n      if (intersect === null) {\n        return;\n      }\n    }\n\n    const distance = raycaster.ray.origin.distanceTo(point);\n    if (distance < raycaster.near || distance > raycaster.far) return;\n\n    intersectionInfo.distance = distance;\n    intersectionInfo.point = point;\n    intersectionInfo.object = this;\n    intersects.push(intersectionInfo);\n  };\n})();\n\nconst getHoverableVisuals = el => {\n  if (!el || !el.components) return null;\n  if (el.components[\"hoverable-visuals\"]) {\n    return el.components[\"hoverable-visuals\"];\n  }\n  return getHoverableVisuals(el.parentEl);\n};\n\nconst enableSweepingEffect = comp => {\n  const hoverableVisuals = getHoverableVisuals(comp.el);\n  if (!hoverableVisuals) {\n    return false;\n  }\n\n  const isPinned = hoverableVisuals.el.components.pinnable && hoverableVisuals.el.components.pinnable.data.pinned;\n  const isSpawner = !!hoverableVisuals.el.components[\"super-spawner\"];\n  const isFrozen = hoverableVisuals.el.sceneEl.is(\"frozen\");\n  const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\n  return hoverableVisuals.data.enableSweepingEffect && !hideDueToPinning;\n};\n\nconst createGeometry = maxSprites => {\n  // TODO: Consider to use InstancedBufferGeometry which would be more efficient and performant\n  const geometry = new THREE.BufferGeometry();\n\n  const positions = new Float32Array(maxSprites * 3 * 4);\n  for (let i = 0; i < maxSprites; i++) {\n    positions[i * 3 * 4 + 0] = -0.5;\n    positions[i * 3 * 4 + 1] = 0.5;\n    positions[i * 3 * 4 + 2] = 0.0;\n    positions[i * 3 * 4 + 3] = 0.5;\n    positions[i * 3 * 4 + 4] = 0.5;\n    positions[i * 3 * 4 + 5] = 0.0;\n    positions[i * 3 * 4 + 6] = -0.5;\n    positions[i * 3 * 4 + 7] = -0.5;\n    positions[i * 3 * 4 + 8] = 0.0;\n    positions[i * 3 * 4 + 9] = 0.5;\n    positions[i * 3 * 4 + 10] = -0.5;\n    positions[i * 3 * 4 + 11] = 0.0;\n  }\n  // We need to use \"position\" as the attribute name here. It was previously \"a_vertices\". It seems three.js\n  // might assume that geometries have a \"position\" attribute in some cases,\n  // like in https://github.com/mrdoob/three.js/pull/18044\n  geometry.setAttribute(\"position\", new THREE.BufferAttribute(positions, 3, false));\n\n  geometry.setAttribute(\n    \"a_hubs_EnableSweepingEffect\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4), 1, false)\n  );\n\n  geometry.setAttribute(\n    \"a_hubs_SweepParams\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4 * 2), 2, false)\n  );\n\n  geometry.setAttribute(\"a_uvs\", new THREE.BufferAttribute(new Float32Array(maxSprites * 2 * 4), 2, false));\n  geometry.setAttribute(\"a_mv\", new THREE.BufferAttribute(new Float32Array(maxSprites * 16 * 4), 16, false));\n\n  const indices = new Uint16Array(maxSprites * 3 * 2);\n  for (let i = 0; i < maxSprites; i++) {\n    indices[i * 3 * 2 + 0] = i * 4 + 0;\n    indices[i * 3 * 2 + 1] = i * 4 + 2;\n    indices[i * 3 * 2 + 2] = i * 4 + 1;\n    indices[i * 3 * 2 + 3] = i * 4 + 1;\n    indices[i * 3 * 2 + 4] = i * 4 + 2;\n    indices[i * 3 * 2 + 5] = i * 4 + 3;\n  }\n  geometry.setIndex(new THREE.BufferAttribute(indices, 1));\n\n  geometry.drawRange.count = 0;\n\n  return geometry;\n};\n\nconst createMaterial = spritesheetTexture => {\n  return new THREE.RawShaderMaterial({\n    uniforms: {\n      u_spritesheet: { value: spritesheetTexture },\n      hubs_Time: { value: 0 }\n    },\n    vertexShader,\n    fragmentShader,\n    side: THREE.DoubleSide,\n    transparent: true\n  });\n};\n\nexport class SpriteSystem {\n  raycast(raycaster, intersects) {\n    for (const sheetType of SHEET_TYPES) {\n      const sprites = this.sprites[sheetType];\n      for (const sprite of sprites) {\n        const o = sprite.el.object3D;\n        if (isVisible(o)) {\n          raycastOnSprite.call(o, raycaster, intersects);\n        }\n      }\n    }\n    return intersects;\n  }\n\n  constructor(scene) {\n    this.sprites = { action: [], notice: [] };\n    this.indicesFromSprites = { action: new WeakMap(), notice: new WeakMap() };\n    this.meshes = { action: null, notice: null };\n\n    waitForDOMContentLoaded().then(() => {\n      for (const type in PNGS) {\n        const spritesheetPng = PNGS[type];\n        createImageTexture(spritesheetPng, getThemeColorShifter(type)).then(spritesheetTexture => {\n          const geometry = createGeometry(MAX_SPRITES);\n          const material = createMaterial(spritesheetTexture);\n          const mesh = (this.meshes[type] = new THREE.Mesh(geometry, material));\n          const el = document.createElement(\"a-entity\");\n          el.classList.add(\"ui\");\n          scene.appendChild(el);\n          el.setObject3D(\"mesh\", mesh);\n          mesh.frustumCulled = false;\n          mesh.layers.set(Layers.CAMERA_LAYER_UI);\n          mesh.renderOrder = window.APP.RENDER_ORDER.HUD_ICONS;\n          mesh.raycast = this.raycast.bind(this);\n        });\n      }\n    });\n\n    APP.store.addEventListener(\"themechanged\", () => {\n      for (const type in PNGS) {\n        const spritesheetPng = PNGS[type];\n        // TODO: Fix me if possible\n        // 1. If theme is changed before meshes are initialized, no effect to textures.\n        // 2. If theme is changed before textures loading for the previous theme is completed\n        // and textures loading for the new theme is completed earlier than the previous ones,\n        // the previous ones are set.\n        if (this.meshes[type]) {\n          createImageTexture(spritesheetPng, getThemeColorShifter(type)).then(newTexture => {\n            const oldTexture = this.meshes[type].material.uniforms.u_spritesheet.value;\n            this.meshes[type].material.uniforms.u_spritesheet.value = newTexture;\n            this.meshes[type].material.uniformsNeedUpdate = true;\n            disposeTexture(oldTexture);\n          });\n        }\n      }\n    });\n  }\n\n  tick(t) {\n    for (let i = 0, il = SHEET_TYPES.length; i < il; i++) {\n      const sheetType = SHEET_TYPES[i];\n      const mesh = this.meshes[sheetType];\n\n      if (!mesh) continue;\n\n      mesh.material.uniforms.hubs_Time.value = t;\n      mesh.material.uniformsNeedUpdate = true;\n\n      const geometry = mesh.geometry;\n      const aMv = geometry.getAttribute(\"a_mv\");\n      const aEnableSweepingEffect = geometry.getAttribute(\"a_hubs_EnableSweepingEffect\");\n      const aSweepParams = geometry.getAttribute(\"a_hubs_SweepParams\");\n      const sprites = this.sprites[sheetType];\n\n      let aEnableSweepingEffectNeedsUpdate = false;\n      let aSweepParamsNeedsUpdate = false;\n\n      for (let j = 0, jl = sprites.length; j < jl; j++) {\n        const sprite = sprites[j];\n\n        if (isVisible(sprite.el.object3D)) {\n          const enableSweepingEffectValue = enableSweepingEffect(sprite) ? 1 : 0;\n          aEnableSweepingEffect.array[j * 4 + 0] = enableSweepingEffectValue;\n          aEnableSweepingEffect.array[j * 4 + 1] = enableSweepingEffectValue;\n          aEnableSweepingEffect.array[j * 4 + 2] = enableSweepingEffectValue;\n          aEnableSweepingEffect.array[j * 4 + 3] = enableSweepingEffectValue;\n          aEnableSweepingEffectNeedsUpdate = true;\n\n          if (enableSweepingEffectValue) {\n            const hoverableVisuals = getHoverableVisuals(sprite.el);\n            const s = hoverableVisuals.sweepParams[0];\n            const t = hoverableVisuals.sweepParams[1];\n            aSweepParams.setXY(j * 4 + 0, s, t);\n            aSweepParams.setXY(j * 4 + 1, s, t);\n            aSweepParams.setXY(j * 4 + 2, s, t);\n            aSweepParams.setXY(j * 4 + 3, s, t);\n            aSweepParamsNeedsUpdate = true;\n          }\n\n          // TODO: This tick should be invoked after updating the entire scene graph matrices.\n          // If we do it, we may remove this .updateMatrices() call\n          sprite.el.object3D.updateMatrices();\n          const mat4 = sprite.el.object3D.matrixWorld;\n          aMv.array.set(mat4.elements, j * 4 * 16);\n          aMv.array.set(mat4.elements, (j * 4 + 1) * 16);\n          aMv.array.set(mat4.elements, (j * 4 + 2) * 16);\n          aMv.array.set(mat4.elements, (j * 4 + 3) * 16);\n        } else {\n          aMv.array.set(ZEROS, j * 4 * 16);\n        }\n      }\n\n      aMv.needsUpdate = true;\n      aMv.updateRange.count = sprites.length * 4 * 16;\n\n      if (aEnableSweepingEffectNeedsUpdate) {\n        aEnableSweepingEffect.needsUpdate = true;\n        aEnableSweepingEffect.updateRange.count = sprites.length * 4;\n      }\n\n      if (aSweepParamsNeedsUpdate) {\n        aSweepParams.needsUpdate = true;\n        aSweepParams.updateRange.count = sprites.length * 4 * 2;\n      }\n    }\n  }\n\n  updateUVs(sprite) {\n    const sheetType = getSheetType(sprite);\n    const mesh = this.meshes[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!mesh) return;\n\n    const indicesFromSprites = this.indicesFromSprites[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!indicesFromSprites.has(sprite)) return;\n\n    const index = indicesFromSprites.get(sprite);\n    const flipY = mesh.material.uniforms.u_spritesheet.value.flipY;\n    const frame = normalizedFrame(sprite.data.name, sheetType === \"action\" ? spritesheetAction : spritesheetNotice);\n    const aUvs = mesh.geometry.getAttribute(\"a_uvs\");\n    aUvs.setXY(index * 4 + 0, frame.x, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(index * 4 + 1, frame.x + frame.w, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(index * 4 + 2, frame.x, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.setXY(index * 4 + 3, frame.x + frame.w, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.needsUpdate = true;\n    aUvs.updateRange.count = this.sprites[sheetType].length * 4 * 2;\n  }\n\n  add(sprite) {\n    const sheetType = getSheetType(sprite);\n    const mesh = this.meshes[sheetType];\n\n    if (!mesh) return 0;\n\n    const sprites = this.sprites[sheetType];\n    const indicesFromSprites = this.indicesFromSprites[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (indicesFromSprites.has(sprite)) {\n      console.error(\"This sprite is already added\");\n      return -1;\n    }\n\n    if (sprites.length >= MAX_SPRITES) {\n      console.error(\"Too many sprites\");\n      return -1;\n    }\n\n    const index = sprites.push(sprite) - 1;\n    indicesFromSprites.set(sprite, index);\n    this.updateUVs(sprite);\n\n    const geometry = mesh.geometry;\n    geometry.drawRange.count = sprites.length * 3 * 2;\n\n    return 1;\n  }\n\n  remove(sprite) {\n    const sheetType = getSheetType(sprite);\n    const mesh = this.meshes[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!mesh) return;\n\n    const sprites = this.sprites[sheetType];\n    const indicesFromSprites = this.indicesFromSprites[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!indicesFromSprites.has(sprite)) {\n      console.error(\"This sprite is not found\");\n      return;\n    }\n\n    const index = indicesFromSprites.get(sprite);\n    indicesFromSprites.delete(sprite);\n\n    const lastSprite = sprites.pop();\n\n    if (sprite !== lastSprite) {\n      // Move the last sprite to the place at the removed sprite index\n      sprites[index] = lastSprite;\n      indicesFromSprites.set(lastSprite, index);\n      this.updateUVs(lastSprite);\n    }\n\n    const geometry = mesh.geometry;\n    geometry.drawRange.count = sprites.length * 3 * 2;\n  }\n}\n","export default \"uniform mat4 modelViewMatrix;\\nuniform mat4 projectionMatrix;\\n\\nattribute mat4 a_mv;\\nattribute vec3 position;\\nattribute vec2 a_uvs;\\nvarying vec2 v_uvs;\\nattribute float a_hubs_EnableSweepingEffect;\\nvarying float v_hubs_EnableSweepingEffect;\\nattribute vec2 a_hubs_SweepParams;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\n\\nvoid main() {\\n  gl_Position = projectionMatrix * modelViewMatrix * a_mv * vec4(position, 1.0);\\n  v_uvs = a_uvs;\\n  v_hubs_EnableSweepingEffect = a_hubs_EnableSweepingEffect;\\n  v_hubs_SweepParams = a_hubs_SweepParams;\\n\\n  vec4 wt = vec4(position, 1.0);\\n  hubs_WorldPosition = (a_mv * wt).xyz;\\n}\\n\";","export default \"precision mediump float;\\n\\nuniform sampler2D u_spritesheet;\\n\\nvarying vec2 v_uvs;\\n\\nvarying float v_hubs_EnableSweepingEffect;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\nuniform bool hubs_HighlightInteractorOne;\\nuniform vec3 hubs_InteractorOnePos;\\nuniform bool hubs_HighlightInteractorTwo;\\nuniform vec3 hubs_InteractorTwoPos;\\nuniform float hubs_Time;\\n\\nvec4 LinearTosRGB( in vec4 value ) {\\n    return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\\n}\\n\\nvec4 linearToOutputTexel( vec4 value ) {\\n  return LinearTosRGB( value );\\n}\\n\\nvoid main() {\\n    vec4 texColor = texture2D(u_spritesheet, v_uvs);\\n\\n    float ratio = 0.0;\\n    if (v_hubs_EnableSweepingEffect > 0.9 ) {\\n        float size = v_hubs_SweepParams.t - v_hubs_SweepParams.s * 1.0;\\n        float line = mod(hubs_Time / 500.0 * size, size * 3.0) + v_hubs_SweepParams.s - size / 3.0;\\n        if (hubs_WorldPosition.y < line) {\\n            ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n        }\\n\\n    }\\n    ratio = min(1.0, ratio);\\n\\n    vec4 highlightColor = vec4(0.184, 0.499, 0.933, 1.0);\\n    gl_FragColor = linearToOutputTexel(vec4((texColor.rgb * (1.0 - ratio)) + (highlightColor.rgb * ratio), texColor.a));\\n}\\n\";","import { setMatrixWorld, affixToWorldUp } from \"../utils/three-utils\";\nimport { isTagged } from \"../components/tags\";\nimport { applyPersistentSync } from \"../utils/permissions-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nconst calculateIconTransform = (function () {\n  const up = new THREE.Vector3();\n  const backward = new THREE.Vector3();\n  const forward = new THREE.Vector3();\n  const camToWaypoint = new THREE.Vector3();\n  const v1 = new THREE.Vector3();\n  const m1 = new THREE.Matrix4();\n  const position = new THREE.Vector3();\n  let scale = 1;\n\n  return function calculateIconTransform(waypoint, viewingCamera, outMat4) {\n    waypoint.updateMatrices();\n    viewingCamera.updateMatrices();\n    affixToWorldUp(m1.copy(waypoint.matrixWorld), m1).extractBasis(v1, up, backward);\n    position\n      .setFromMatrixPosition(waypoint.matrixWorld)\n      .add(v1.addVectors(up.multiplyScalar(1.6), backward.multiplyScalar(0.15)));\n    camToWaypoint.subVectors(position, v1.setFromMatrixPosition(viewingCamera.matrixWorld));\n    const distance = camToWaypoint.length();\n    const minDistance = distance < 0.2 * v1.setFromMatrixColumn(viewingCamera.matrixWorld, 0).length();\n    if (distance < minDistance) {\n      scale = 0.00001;\n      camToWaypoint.set(0, 0, -1);\n    } else {\n      scale = 0.1 + 0.05 * distance;\n    }\n    forward.copy(camToWaypoint).projectOnPlane(up.set(0, 1, 0)).normalize();\n\n    return outMat4\n      .makeBasis(\n        v1.crossVectors(forward, up).multiplyScalar(scale),\n        up.multiplyScalar(scale),\n        forward.multiplyScalar(scale * -1)\n      )\n      .setPosition(position);\n  };\n})();\nfunction isMineOrTakeOwnership(el) {\n  return NAF.utils.isMine(el) || NAF.utils.takeOwnership(el);\n}\nfunction isOccupiableSpawnPoint(waypointData) {\n  return waypointData.canBeOccupied && waypointData.canBeSpawnPoint;\n}\nfunction isUnoccupiableSpawnPoint(waypointData) {\n  return !waypointData.canBeOccupied && waypointData.canBeSpawnPoint;\n}\nfunction loadTemplateAndAddToScene(scene, templateId) {\n  return new Promise(resolve => {\n    const content = document.importNode(document.getElementById(templateId).content.children[0]);\n    scene.appendChild(content, true);\n    setTimeout(() => {\n      // Without this timeout, this resolves too early in Firefox for Android\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n      resolve(content);\n    }, 0);\n  });\n}\nfunction templatesToLoadForWaypointData(data) {\n  const templateIds = [];\n  if (data.canBeClicked && data.canBeOccupied) {\n    templateIds.push(\"occupiable-waypoint-icon\");\n  } else if (data.canBeClicked && !data.canBeOccupied) {\n    templateIds.push(\"teleport-waypoint-icon\");\n  } else if (isUnoccupiableSpawnPoint(data)) {\n    //    templateIds.push(\"teleport-waypoint-icon\");\n  } else if (isOccupiableSpawnPoint(data)) {\n    //    templateIds.push(\"occupiable-waypoint-icon\");\n  } else {\n    //templateIds.push(\"teleport-waypoint-icon\");\n  }\n  return templateIds;\n}\nfunction loadTemplatesForWaypointData(scene, data) {\n  return templatesToLoadForWaypointData(data).map(templateId => loadTemplateAndAddToScene(scene, templateId));\n}\n\nfunction shouldTryToOccupy(waypointComponent) {\n  return (\n    waypointComponent.data.canBeOccupied &&\n    (NAF.utils.isMine(waypointComponent.el) ||\n      !(\n        waypointComponent.data.isOccupied &&\n        NAF.utils.getNetworkOwner(waypointComponent.el) &&\n        NAF.connection.connectedClients[NAF.utils.getNetworkOwner(waypointComponent.el)]\n      ))\n  );\n}\n\nfunction isOccupiedByMe(waypointComponent) {\n  return (\n    waypointComponent.data.canBeOccupied &&\n    waypointComponent.data.isOccupied &&\n    waypointComponent.el.components.networked &&\n    NAF.utils.isMine(waypointComponent.el)\n  );\n}\nfunction unoccupyWaypoint(waypointComponent) {\n  waypointComponent.el.setAttribute(\"waypoint\", { isOccupied: false });\n}\nfunction unoccupyWaypoints(waypointComponents) {\n  waypointComponents.filter(isOccupiedByMe).forEach(unoccupyWaypoint);\n}\nfunction occupyWaypoint(waypointComponent) {\n  waypointComponent.el.setAttribute(\"waypoint\", { isOccupied: true });\n}\n\nfunction uuid(el) {\n  return el.object3D.uuid;\n}\n\nexport class WaypointSystem {\n  constructor(scene, characterController) {\n    this.helperMat4 = new THREE.Matrix4();\n    this.scene = scene;\n    this.loading = [];\n    this.ready = [];\n    this.previousWaypointHash = null;\n    this.initialSpawnHappened = false;\n\n    this.waypointForTemplateEl = {};\n    this.elementsFromTemplatesFor = {};\n    this.eventHandlers = [];\n    this.lostOwnershipOfWaypoint = this.lostOwnershipOfWaypoint.bind(this);\n    waitForDOMContentLoaded().then(() => {\n      loadTemplateAndAddToScene(scene, \"waypoint-preview-avatar-template\").then(el => {\n        this.waypointPreviewAvatar = el;\n        this.waypointPreviewAvatar.object3D.visible = false;\n      });\n    });\n    this.characterController = characterController;\n  }\n\n  releaseAnyOccupiedWaypoints() {\n    unoccupyWaypoints(this.ready);\n    if (this.currentWaypoint) {\n      this.currentWaypoint.el.removeEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\n    }\n  }\n\n  teleportToWaypoint(iconEl, waypointComponent) {\n    return function onInteract() {\n      this.moveToWaypoint(waypointComponent, false);\n    }.bind(this);\n  }\n  tryTeleportToOccupiableWaypoint(iconEl, waypointComponent) {\n    return function onInteract() {\n      const previouslyOccupiedWaypoints = this.ready.filter(isOccupiedByMe);\n      this.tryToOccupy(waypointComponent).then(didOccupy => {\n        if (didOccupy) {\n          waypointComponent.el.object3D.updateMatrices();\n          this.characterController.shouldLandWhenPossible = true;\n          this.characterController.enqueueWaypointTravelTo(\n            waypointComponent.el.object3D.matrixWorld,\n            false,\n            waypointComponent.data\n          );\n          unoccupyWaypoints(previouslyOccupiedWaypoints.filter(wp => wp !== waypointComponent));\n        }\n      });\n    }.bind(this);\n  }\n  setupEventHandlersFor(component) {\n    return function setupEventHandlers(el) {\n      const id = uuid(el);\n      this.eventHandlers[id] = this.eventHandlers[id] || {};\n      if (\n        component.data.canBeClicked &&\n        (el.classList.contains(\"teleport-waypoint-icon\") || el.classList.contains(\"occupiable-waypoint-icon\"))\n      ) {\n        const onHover = () => {\n          component.el.object3D.updateMatrices();\n          if (this.waypointPreviewAvatar && !this.waypointForTemplateEl[id].data.willMaintainInitialOrientation) {\n            this.waypointPreviewAvatar.object3D.visible = true;\n            component.el.object3D.updateMatrices();\n            setMatrixWorld(this.waypointPreviewAvatar.object3D, component.el.object3D.matrixWorld);\n          }\n        };\n        const onUnhover = () => {\n          if (this.waypointPreviewAvatar) {\n            this.waypointPreviewAvatar.object3D.visible = false;\n          }\n        };\n        el.object3D.addEventListener(\"hovered\", onHover);\n        el.object3D.addEventListener(\"unhovered\", onUnhover);\n        this.eventHandlers[id][\"hovered\"] = onHover;\n        this.eventHandlers[id][\"unhovered\"] = onUnhover;\n      }\n      if (isTagged(el, \"singleActionButton\") && component.data.canBeClicked) {\n        let onInteract = () => {\n          console.log(\"interacted with\", el, \"associated with waypoint\", component);\n        };\n        if (el.classList.contains(\"teleport-waypoint-icon\")) {\n          onInteract = this.teleportToWaypoint(el, component);\n        } else if (el.classList.contains(\"occupiable-waypoint-icon\")) {\n          onInteract = this.tryTeleportToOccupiableWaypoint(el, component);\n        }\n        el.object3D.addEventListener(\"interact\", onInteract);\n        this.eventHandlers[id][\"interact\"] = onInteract;\n      }\n    }.bind(this);\n  }\n  registerComponent(component) {\n    this.loading.push(component);\n    const setupEventHandlers = this.setupEventHandlersFor(component);\n    const waypointId = uuid(component.el);\n    this.elementsFromTemplatesFor[waypointId] = this.elementsFromTemplatesFor[waypointId] || [];\n    Promise.all(loadTemplatesForWaypointData(this.scene, component.data)).then(elementsFromTemplates => {\n      const li = this.loading.indexOf(component);\n      if (li === -1) {\n        return null;\n      }\n      this.loading.splice(li, 1);\n      this.ready.push(component);\n      this.elementsFromTemplatesFor[waypointId].push(...elementsFromTemplates);\n      elementsFromTemplates.forEach(el => {\n        this.waypointForTemplateEl[uuid(el)] = component;\n      });\n      elementsFromTemplates.forEach(setupEventHandlers);\n    });\n  }\n  unregisterComponent(component) {\n    const li = this.loading.indexOf(component);\n    if (li !== -1) {\n      this.loading.splice(li, 1);\n    }\n    const ri = this.ready.indexOf(component);\n    if (ri !== -1) {\n      this.ready.splice(ri, 1);\n      const waypointId = uuid(component.el);\n      const elementsFromTemplates = this.elementsFromTemplatesFor[waypointId];\n      for (let i = 0; i < elementsFromTemplates.length; i++) {\n        const el = elementsFromTemplates[i];\n        const id = uuid(el);\n        if (this.eventHandlers[id]) {\n          const removeEventListener = eventName => {\n            if (this.eventHandlers[id][eventName]) {\n              el.object3D.removeEventListener(eventName, this.eventHandlers[id][eventName]);\n              delete this.eventHandlers[id][eventName];\n            }\n          };\n          [\"interact\", \"hovered\", \"unhovered\"].map(removeEventListener);\n        }\n        el.parentNode.removeChild(el);\n      }\n      this.elementsFromTemplatesFor[waypointId].length = 0;\n    }\n  }\n  getUnoccupiableSpawnPoint() {\n    const candidates = this.ready.filter(component => isUnoccupiableSpawnPoint(component.data));\n    return candidates.length && candidates.splice(Math.floor(Math.random() * candidates.length), 1)[0];\n  }\n  lostOwnershipOfWaypoint(e) {\n    if (this.currentWaypoint && this.currentWaypoint.el === e.detail.el) {\n      this.mightNeedRespawn = true;\n      this.ownershipLostTime = performance.now();\n    }\n  }\n  tryToOccupy(waypointComponent) {\n    return new Promise(resolve => {\n      if (shouldTryToOccupy(waypointComponent) && isMineOrTakeOwnership(waypointComponent.el)) {\n        occupyWaypoint(waypointComponent);\n        if (this.currentWaypoint) {\n          this.currentWaypoint.el.removeEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\n        }\n        this.currentWaypoint = waypointComponent;\n        waypointComponent.el.addEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\n        resolve(true);\n      } else {\n        resolve(false);\n      }\n    });\n  }\n  tryToOccupyAnyOf(waypoints) {\n    if (!waypoints.length) return Promise.resolve(null);\n    const candidate = waypoints.splice(Math.floor(Math.random() * waypoints.length), 1)[0];\n    return this.tryToOccupy(candidate).then(didOccupy => {\n      if (didOccupy) {\n        return Promise.resolve(candidate);\n      } else {\n        return this.tryToOccupyAnyOf(waypoints);\n      }\n    });\n  }\n  moveToSpawnPoint() {\n    if (this.currentMoveToSpawn) {\n      return this.currentMoveToSpawn;\n    }\n    if (!this.nextMoveToSpawn) {\n      this.waitOneTick = true;\n      this.nextMoveToSpawn = new Promise(resolve => {\n        this.nextMoveToSpawnResolve = resolve;\n      });\n    }\n    // Reset system state to allow for waypoint selection based on URL fragments\n    this.previousWaypointHash = null;\n    this.initialSpawnHappened = false;\n    return this.nextMoveToSpawn;\n  }\n  moveToWaypoint(waypointComponent, instant) {\n    this.releaseAnyOccupiedWaypoints();\n    waypointComponent.el.object3D.updateMatrices();\n    this.characterController.shouldLandWhenPossible = true;\n    this.characterController.enqueueWaypointTravelTo(\n      waypointComponent.el.object3D.matrixWorld,\n      !window.APP.store.state.preferences.animateWaypointTransitions || instant,\n      waypointComponent.data\n    );\n  }\n  moveToUnoccupiableSpawnPoint() {\n    const waypointComponent = this.getUnoccupiableSpawnPoint();\n    if (waypointComponent) {\n      this.moveToWaypoint(waypointComponent, true);\n    }\n    return waypointComponent;\n  }\n  tick() {\n    if (this.waitOneTick) {\n      this.waitOneTick = false;\n      return;\n    }\n\n    const hashUpdated = window.location.hash !== \"\" && this.previousWaypointHash !== window.location.hash;\n\n    if (hashUpdated && this.initialSpawnHappened) {\n      const waypointName = window.location.hash.replace(\"#\", \"\");\n      const waypoint = this.ready.find(c => c.el.object3D.name === waypointName);\n      if (waypoint) {\n        this.moveToWaypoint(waypoint, this.previousWaypointHash === null);\n        window.history.replaceState(null, null, window.location.href.split(\"#\")[0]); // Reset so you can re-activate the same waypoint\n      }\n      this.previousWaypointHash = window.location.hash;\n    }\n\n    if (!this.currentMoveToSpawn && this.nextMoveToSpawn) {\n      this.mightNeedRespawn = false;\n      this.currentMoveToSpawn = this.nextMoveToSpawn;\n      this.currentMoveToSpawnResolve = this.nextMoveToSpawnResolve;\n      this.nextMoveToSpawn = null;\n      this.nextMoveToSpawnResolve = null;\n\n      let resolvedWaypointOrNull;\n\n      const previouslyOccupiedWaypoints = this.ready.filter(isOccupiedByMe);\n      this.tryToOccupyAnyOf(this.ready.filter(component => isOccupiableSpawnPoint(component.data))).then(\n        waypointComponentOrNull => {\n          if (waypointComponentOrNull) {\n            const waypointComponent = waypointComponentOrNull;\n            unoccupyWaypoints(previouslyOccupiedWaypoints.filter(wp => wp !== waypointComponent));\n            waypointComponent.el.object3D.updateMatrices();\n            this.characterController.shouldLandWhenPossible = true;\n            this.characterController.enqueueWaypointTravelTo(\n              waypointComponent.el.object3D.matrixWorld,\n              true,\n              waypointComponent.data\n            );\n            resolvedWaypointOrNull = waypointComponent;\n          } else if (waypointComponentOrNull === null) {\n            resolvedWaypointOrNull = this.moveToUnoccupiableSpawnPoint();\n          }\n          this.initialSpawnHappened = true;\n          this.currentMoveToSpawnResolve(resolvedWaypointOrNull);\n          this.currentMoveToSpawn = null;\n          this.currentMoveToSpawnResolve = null;\n        }\n      );\n    } else if (this.mightNeedRespawn && performance.now() - this.ownershipLostTime < 8000) {\n      this.mightNeedRespawn = false;\n      this.moveToSpawnPoint();\n    }\n    const tickTemplateEl = (elementFromTemplate, waypointComponent) => {\n      if (\n        elementFromTemplate.classList.contains(\"teleport-waypoint-icon\") ||\n        elementFromTemplate.classList.contains(\"occupiable-waypoint-icon\")\n      ) {\n        elementFromTemplate.object3D.visible = this.scene.is(\"frozen\");\n        if (elementFromTemplate.object3D.visible) {\n          this.viewingCamera = this.viewingCamera || document.getElementById(\"viewing-camera\").object3DMap.camera;\n          setMatrixWorld(\n            elementFromTemplate.object3D,\n            calculateIconTransform(waypointComponent.el.object3D, this.viewingCamera, this.helperMat4)\n          );\n        }\n      }\n    };\n    function tickWaypoint(waypointComponent) {\n      const elementsFromTemplates = this.elementsFromTemplatesFor[uuid(waypointComponent.el)];\n      elementsFromTemplates.forEach(el => tickTemplateEl(el, waypointComponent));\n    }\n    this.ready.forEach(tickWaypoint.bind(this));\n  }\n}\n\nAFRAME.registerComponent(\"waypoint\", {\n  schema: {\n    canBeSpawnPoint: { default: false },\n    canBeOccupied: { default: false },\n    canBeClicked: { default: false },\n    willDisableMotion: { default: false },\n    willDisableTeleporting: { default: false },\n    snapToNavMesh: { default: false },\n    willMaintainInitialOrientation: { default: false },\n    willMaintainWorldUp: { default: true },\n    isOccupied: { default: false }\n  },\n  init() {\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].waypointSystem;\n    this.didRegisterWithSystem = false;\n  },\n  play() {\n    if (!this.didRegisterWithSystem) {\n      if (this.el.components.networked) {\n        applyPersistentSync(this.el.components.networked.data.networkId);\n      }\n      this.system.registerComponent(this, this.el.sceneEl);\n      this.didRegisterWithSystem = true;\n    }\n  },\n  remove() {\n    if (!this.didRegisterWithSystem) {\n      console.warn(\"Waypoint removed without ever having registered with the system.\");\n    } else {\n      this.system.unregisterComponent(this);\n    }\n  }\n});\n","const mat4Pool = [];\nexport function getPooledMatrix4() {\n  return mat4Pool.shift() || new THREE.Matrix4();\n}\nexport function freePooledMatrix4(mat4) {\n  mat4Pool.push(mat4);\n}\n","export const getCurrentPlayerHeight = (function() {\n  let avatarPOV;\n  let avatarRig;\n  return function getCurrentPlayerHeight(world) {\n    avatarPOV = avatarPOV || document.getElementById(\"avatar-pov-node\");\n    avatarRig = avatarRig || document.getElementById(\"avatar-rig\");\n    avatarRig.object3D.updateMatrices();\n    avatarPOV.object3D.updateMatrices();\n    if (world) {\n      return avatarPOV.object3D.matrixWorld.elements[13] - avatarRig.object3D.matrixWorld.elements[13];\n    }\n    return avatarPOV.object3D.matrix.elements[13];\n  };\n})();\n","import { paths } from \"./userinput/paths\";\nimport { SOUND_SNAP_ROTATE, SOUND_WAYPOINT_START, SOUND_WAYPOINT_END } from \"./sound-effects-system\";\nimport { easeOutQuadratic } from \"../utils/easing\";\nimport { getPooledMatrix4, freePooledMatrix4 } from \"../utils/mat4-pool\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport {\n  childMatch,\n  rotateInPlaceAroundWorldUp,\n  calculateCameraTransformForWaypoint,\n  interpolateAffine,\n  affixToWorldUp\n} from \"../utils/three-utils\";\nimport { getCurrentPlayerHeight } from \"../utils/get-current-player-height\";\nimport qsTruthy from \"../utils/qs_truthy\";\n//import { m4String } from \"../utils/pretty-print\";\nconst NAV_ZONE = \"character\";\nconst qsAllowWaypointLerp = qsTruthy(\"waypointLerp\");\nconst isMobile = AFRAME.utils.device.isMobile();\n\nconst calculateDisplacementToDesiredPOV = (function() {\n  const translationCoordinateSpace = new THREE.Matrix4();\n  const translated = new THREE.Matrix4();\n  const localTranslation = new THREE.Matrix4();\n  return function calculateDisplacementToDesiredPOV(\n    povMat4,\n    allowVerticalMovement,\n    localDisplacement,\n    displacementToDesiredPOV\n  ) {\n    localTranslation.makeTranslation(localDisplacement.x, localDisplacement.y, localDisplacement.z);\n    translationCoordinateSpace.extractRotation(povMat4);\n    if (!allowVerticalMovement) {\n      affixToWorldUp(translationCoordinateSpace, translationCoordinateSpace);\n    }\n    translated.copy(translationCoordinateSpace).multiply(localTranslation);\n    return displacementToDesiredPOV.setFromMatrixPosition(translated);\n  };\n})();\n\n/**\n * A character controller that moves the avatar.\n * The controller accounts for playspace offset and orientation and depends on the nav mesh system for translation.\n * @namespace avatar\n */\nconst BASE_SPEED = 3.2; //TODO: in what units?\nexport class CharacterControllerSystem {\n  constructor(scene) {\n    this.scene = scene;\n    this.fly = false;\n    this.shouldLandWhenPossible = false;\n    this.waypoints = [];\n    this.waypointTravelStartTime = 0;\n    this.waypointTravelTime = 0;\n    this.navGroup = null;\n    this.navNode = null;\n    this.relativeMotion = new THREE.Vector3(0, 0, 0);\n    this.nextRelativeMotion = new THREE.Vector3(0, 0, 0);\n    this.dXZ = 0;\n    this.scene.addEventListener(\"nav-mesh-loaded\", () => {\n      this.navGroup = null;\n      this.navNode = null;\n    });\n    waitForDOMContentLoaded().then(() => {\n      this.avatarPOV = document.getElementById(\"avatar-pov-node\");\n      this.avatarRig = document.getElementById(\"avatar-rig\");\n    });\n  }\n  // Use this API for waypoint travel so that your matrix doesn't end up in the pool\n  enqueueWaypointTravelTo(inTransform, isInstant, waypointComponentData) {\n    this.waypoints.push({ transform: getPooledMatrix4().copy(inTransform), isInstant, waypointComponentData }); //TODO: don't create new object\n  }\n  enqueueRelativeMotion(motion) {\n    this.relativeMotion.add(motion);\n  }\n  enqueueInPlaceRotationAroundWorldUp(dXZ) {\n    this.dXZ += dXZ;\n  }\n  // We assume the rig is at the root, and its local position === its world position.\n  teleportTo = (function() {\n    const rig = new THREE.Vector3();\n    const head = new THREE.Vector3();\n    const deltaFromHeadToTargetForHead = new THREE.Vector3();\n    const targetForHead = new THREE.Vector3();\n    const targetForRig = new THREE.Vector3();\n    //TODO: Use enqueue waypoint\n    return function teleportTo(targetWorldPosition) {\n      this.isMotionDisabled = false;\n      this.avatarRig.object3D.getWorldPosition(rig);\n      this.avatarPOV.object3D.getWorldPosition(head);\n      targetForHead.copy(targetWorldPosition);\n      targetForHead.y += this.avatarPOV.object3D.position.y;\n      deltaFromHeadToTargetForHead.copy(targetForHead).sub(head);\n      targetForRig.copy(rig).add(deltaFromHeadToTargetForHead);\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\n      this.findPositionOnNavMesh(targetForRig, targetForRig, this.avatarRig.object3D.position, navMeshExists);\n      this.avatarRig.object3D.matrixNeedsUpdate = true;\n    };\n  })();\n\n  travelByWaypoint = (function() {\n    const inMat4Copy = new THREE.Matrix4();\n    const inPosition = new THREE.Vector3();\n    const outPosition = new THREE.Vector3();\n    const translation = new THREE.Matrix4();\n    const initialOrientation = new THREE.Matrix4();\n    const finalScale = new THREE.Vector3();\n    const finalPosition = new THREE.Vector3();\n    const finalPOV = new THREE.Matrix4();\n    return function travelByWaypoint(inMat4, snapToNavMesh, willMaintainInitialOrientation) {\n      this.avatarPOV.object3D.updateMatrices();\n      if (!this.fly && !snapToNavMesh) {\n        this.fly = true;\n        this.shouldLandWhenPossible = true;\n        this.shouldUnoccupyWaypointsOnceMoving = true;\n      }\n      inMat4Copy.copy(inMat4);\n      rotateInPlaceAroundWorldUp(inMat4Copy, Math.PI, finalPOV);\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\n      if (!navMeshExists && snapToNavMesh) {\n        console.warn(\"Tried to travel to a waypoint that wants to snap to the nav mesh, but there is no nav mesh\");\n      }\n      if (navMeshExists && snapToNavMesh) {\n        inPosition.setFromMatrixPosition(inMat4Copy);\n        this.findPositionOnNavMesh(inPosition, inPosition, outPosition, true);\n        finalPOV.setPosition(outPosition);\n        translation.makeTranslation(0, getCurrentPlayerHeight(), -0.15);\n      } else {\n        // If we are not snapping to the nav mesh, align the user's\n        // perspective exactly to the robot eyes as they appear in the\n        // waypoint indicator. (1.6 meters up and 0.15 meters forward)\n        // This does _not_ require taking the player's height into account\n        // on this line because we are only interested in where the\n        // camera will end up.\n        translation.makeTranslation(0, 1.6, -0.15);\n      }\n      finalPOV.multiply(translation);\n      if (willMaintainInitialOrientation) {\n        initialOrientation.extractRotation(this.avatarPOV.object3D.matrixWorld);\n        finalScale.setFromMatrixScale(finalPOV);\n        finalPosition.setFromMatrixPosition(finalPOV);\n        finalPOV\n          .copy(initialOrientation)\n          .scale(finalScale)\n          .setPosition(finalPosition);\n      }\n      calculateCameraTransformForWaypoint(this.avatarPOV.object3D.matrixWorld, finalPOV, finalPOV);\n      childMatch(this.avatarRig.object3D, this.avatarPOV.object3D, finalPOV);\n    };\n  })();\n\n  tick = (function() {\n    const snapRotatedPOV = new THREE.Matrix4();\n    const newPOV = new THREE.Matrix4();\n    const displacementToDesiredPOV = new THREE.Vector3();\n\n    const startPOVPosition = new THREE.Vector3();\n    const desiredPOVPosition = new THREE.Vector3();\n    const navMeshSnappedPOVPosition = new THREE.Vector3();\n    const AVERAGE_WAYPOINT_TRAVEL_SPEED_METERS_PER_SECOND = 50;\n    const startTransform = new THREE.Matrix4();\n    const interpolatedWaypoint = new THREE.Matrix4();\n    const startTranslation = new THREE.Matrix4();\n    const waypointPosition = new THREE.Vector3();\n    const v = new THREE.Vector3();\n\n    let uiRoot;\n    return function tick(t, dt) {\n      const entered = this.scene.is(\"entered\");\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\n      const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n      if (!isGhost && !entered) return;\n      const vrMode = this.scene.is(\"vr-mode\");\n      this.sfx = this.sfx || this.scene.systems[\"hubs-systems\"].soundEffectsSystem;\n      this.waypointSystem = this.waypointSystem || this.scene.systems[\"hubs-systems\"].waypointSystem;\n\n      if (!this.activeWaypoint && this.waypoints.length) {\n        this.activeWaypoint = this.waypoints.splice(0, 1)[0];\n        // Normally, do not disable motion on touchscreens because there is no way to teleport out of it.\n        // But if motion AND teleporting is disabled, then disable motion because the waypoint author\n        // intended for the user to be stuck here.\n        this.isMotionDisabled =\n          this.activeWaypoint.waypointComponentData.willDisableMotion &&\n          (!isMobile || this.activeWaypoint.waypointComponentData.willDisableTeleporting);\n        this.isTeleportingDisabled = this.activeWaypoint.waypointComponentData.willDisableTeleporting;\n        this.avatarPOV.object3D.updateMatrices();\n        this.waypointTravelTime =\n          (vrMode && !qsAllowWaypointLerp) || this.activeWaypoint.isInstant\n            ? 0\n            : 1000 *\n              (new THREE.Vector3()\n                .setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld)\n                .distanceTo(waypointPosition.setFromMatrixPosition(this.activeWaypoint.transform)) /\n                AVERAGE_WAYPOINT_TRAVEL_SPEED_METERS_PER_SECOND);\n        rotateInPlaceAroundWorldUp(this.avatarPOV.object3D.matrixWorld, Math.PI, startTransform);\n        startTransform.multiply(startTranslation.makeTranslation(0, -1 * getCurrentPlayerHeight(), -0.15));\n        this.waypointTravelStartTime = t;\n        if (!vrMode && this.waypointTravelTime > 100) {\n          this.sfx.playSoundOneShot(SOUND_WAYPOINT_START);\n        }\n      }\n\n      const animationIsOver =\n        this.waypointTravelTime === 0 || t >= this.waypointTravelStartTime + this.waypointTravelTime;\n      if (this.activeWaypoint && !animationIsOver) {\n        const progress = THREE.MathUtils.clamp((t - this.waypointTravelStartTime) / this.waypointTravelTime, 0, 1);\n        interpolateAffine(\n          startTransform,\n          this.activeWaypoint.transform,\n          easeOutQuadratic(progress),\n          interpolatedWaypoint\n        );\n        this.travelByWaypoint(\n          interpolatedWaypoint,\n          false,\n          this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation\n        );\n      }\n      if (this.activeWaypoint && (this.waypoints.length || animationIsOver)) {\n        this.travelByWaypoint(\n          this.activeWaypoint.transform,\n          this.activeWaypoint.waypointComponentData.snapToNavMesh,\n          this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation\n        );\n        freePooledMatrix4(this.activeWaypoint.transform);\n        this.activeWaypoint = null;\n        if (vrMode || this.waypointTravelTime > 0) {\n          this.sfx.playSoundOneShot(SOUND_WAYPOINT_END);\n        }\n      }\n\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const wasFlying = this.fly;\n      if (userinput.get(paths.actions.toggleFly)) {\n        this.shouldLandWhenPossible = false;\n        this.avatarRig.messageDispatch.dispatch(\"/fly\"); // TODO: Separate the logic about displaying the message from toggling the fly state in such a way that it is clear that this.fly will be toggled here\n      }\n      const didStopFlying = wasFlying && !this.fly;\n      if (!this.fly && this.shouldLandWhenPossible) {\n        this.shouldLandWhenPossible = false;\n      }\n      if (this.fly) {\n        this.navNode = null;\n      }\n      const preferences = window.APP.store.state.preferences;\n      const snapRotateLeft = userinput.get(paths.actions.snapRotateLeft);\n      const snapRotateRight = userinput.get(paths.actions.snapRotateRight);\n      if (snapRotateLeft) {\n        this.dXZ += (preferences.snapRotationDegrees * Math.PI) / 180;\n      }\n      if (snapRotateRight) {\n        this.dXZ -= (preferences.snapRotationDegrees * Math.PI) / 180;\n      }\n      if (snapRotateLeft || snapRotateRight) {\n        this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n      }\n      const characterAcceleration = userinput.get(paths.actions.characterAcceleration);\n      if (characterAcceleration) {\n        const zCharacterAcceleration = -1 * characterAcceleration[1];\n        this.relativeMotion.set(\n          this.relativeMotion.x +\n            (preferences.disableMovement || preferences.disableStrafing ? 0 : characterAcceleration[0]),\n          this.relativeMotion.y,\n          this.relativeMotion.z +\n            (preferences.disableMovement\n              ? 0\n              : preferences.disableBackwardsMovement\n                ? Math.min(0, zCharacterAcceleration)\n                : zCharacterAcceleration)\n        );\n      }\n      const lerpC = vrMode ? 0 : 0.85; // TODO: To support drifting (\"ice skating\"), motion needs to keep initial direction\n      this.nextRelativeMotion.copy(this.relativeMotion).multiplyScalar(lerpC);\n      this.relativeMotion.multiplyScalar(1 - lerpC);\n\n      this.avatarPOV.object3D.updateMatrices();\n      rotateInPlaceAroundWorldUp(this.avatarPOV.object3D.matrixWorld, this.dXZ, snapRotatedPOV);\n\n      newPOV.copy(snapRotatedPOV);\n\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\n      if (!this.isMotionDisabled) {\n        const playerScale = v.setFromMatrixColumn(this.avatarPOV.object3D.matrixWorld, 1).length();\n        const triedToMove = this.relativeMotion.lengthSq() > 0.000001;\n\n        if (triedToMove) {\n          const speedModifier = preferences.movementSpeedModifier;\n          calculateDisplacementToDesiredPOV(\n            snapRotatedPOV,\n            this.fly || !navMeshExists,\n            this.relativeMotion.multiplyScalar(\n              ((userinput.get(paths.actions.boost) ? 2 : 1) *\n                speedModifier *\n                BASE_SPEED *\n                Math.sqrt(playerScale) *\n                dt) /\n                1000\n            ),\n            displacementToDesiredPOV\n          );\n\n          newPOV\n            .makeTranslation(displacementToDesiredPOV.x, displacementToDesiredPOV.y, displacementToDesiredPOV.z)\n            .multiply(snapRotatedPOV);\n        }\n\n        const shouldRecomputeNavGroupAndNavNode = didStopFlying || this.shouldLandWhenPossible;\n        const shouldResnapToNavMesh = navMeshExists && (shouldRecomputeNavGroupAndNavNode || triedToMove);\n\n        let squareDistNavMeshCorrection = 0;\n\n        if (shouldResnapToNavMesh) {\n          this.findPOVPositionAboveNavMesh(\n            startPOVPosition.setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld),\n            desiredPOVPosition.setFromMatrixPosition(newPOV),\n            navMeshSnappedPOVPosition,\n            shouldRecomputeNavGroupAndNavNode\n          );\n\n          squareDistNavMeshCorrection = desiredPOVPosition.distanceToSquared(navMeshSnappedPOVPosition);\n\n          if (this.fly && this.shouldLandWhenPossible && squareDistNavMeshCorrection < 0.5 && !this.activeWaypoint) {\n            this.shouldLandWhenPossible = false;\n            this.fly = false;\n            newPOV.setPosition(navMeshSnappedPOVPosition);\n          } else if (!this.fly) {\n            newPOV.setPosition(navMeshSnappedPOVPosition);\n          }\n        }\n\n        if (!this.activeWaypoint && this.shouldUnoccupyWaypointsOnceMoving && triedToMove) {\n          this.shouldUnoccupyWaypointsOnceMoving = false;\n          this.waypointSystem.releaseAnyOccupiedWaypoints();\n          if (this.fly && this.shouldLandWhenPossible && (shouldResnapToNavMesh && squareDistNavMeshCorrection < 3)) {\n            newPOV.setPosition(navMeshSnappedPOVPosition);\n            this.shouldLandWhenPossible = false;\n            this.fly = false;\n          }\n        }\n      }\n\n      childMatch(this.avatarRig.object3D, this.avatarPOV.object3D, newPOV);\n      this.relativeMotion.copy(this.nextRelativeMotion);\n      this.dXZ = 0;\n    };\n  })();\n\n  getClosestNode(pos) {\n    const pathfinder = this.scene.systems.nav.pathfinder;\n    if (!pathfinder.zones[NAV_ZONE].groups[this.navGroup]) {\n      return null;\n    }\n    return (\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup, true) ||\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup)\n    );\n  }\n\n  findPOVPositionAboveNavMesh = (function() {\n    const startingFeetPosition = new THREE.Vector3();\n    const desiredFeetPosition = new THREE.Vector3();\n    // TODO: Here we assume the player is standing straight up, but in VR it is often the case\n    // that you want to lean over the edge of a balcony/table that does not have nav mesh below.\n    // We should find way to allow leaning over the edge of a balcony and maybe disallow putting\n    // your head through a wall.\n    return function findPOVPositionAboveNavMesh(\n      startPOVPosition,\n      desiredPOVPosition,\n      outPOVPosition,\n      shouldRecomputeGroupAndNode\n    ) {\n      const playerHeight = getCurrentPlayerHeight(true);\n      startingFeetPosition.copy(startPOVPosition);\n      startingFeetPosition.y -= playerHeight;\n      desiredFeetPosition.copy(desiredPOVPosition);\n      desiredFeetPosition.y -= playerHeight;\n      this.findPositionOnNavMesh(\n        startingFeetPosition,\n        desiredFeetPosition,\n        outPOVPosition,\n        shouldRecomputeGroupAndNode\n      );\n      outPOVPosition.y += playerHeight;\n      return outPOVPosition;\n    };\n  })();\n\n  findPositionOnNavMesh(start, end, outPos, shouldRecomputeGroupAndNode) {\n    const pathfinder = this.scene.systems.nav.pathfinder;\n    if (!(NAV_ZONE in pathfinder.zones)) return;\n    this.navGroup =\n      shouldRecomputeGroupAndNode || this.navGroup === null\n        ? pathfinder.getGroup(NAV_ZONE, end, true, true)\n        : this.navGroup;\n    this.navNode =\n      shouldRecomputeGroupAndNode || this.navNode === null || this.navNode === undefined\n        ? this.getClosestNode(end)\n        : this.navNode;\n    if (this.navNode === null || this.navNode === undefined) {\n      // this.navNode can be null if it has never been set or if getClosestNode fails,\n      // and it can be undefined if clampStep fails, so we have to check both. We do not\n      // simply check if it is falsey (!this.navNode), because 0 (zero) is a valid value,\n      // and 0 is falsey.\n      outPos.copy(end);\n    } else {\n      this.navNode = pathfinder.clampStep(start, end, this.navNode, NAV_ZONE, this.navGroup, outPos);\n    }\n    return outPos;\n  }\n\n  enableFly(enabled) {\n    if (enabled && window.APP.hubChannel && window.APP.hubChannel.can(\"fly\")) {\n      this.fly = true;\n    } else {\n      this.fly = false;\n    }\n    return this.fly;\n  }\n}\n","const IDENTITY = new THREE.Matrix4().identity();\nexport class CursorPoseTrackingSystem {\n  constructor() {\n    this.pairs = [];\n  }\n  register(object3D, path) {\n    object3D.applyMatrix4(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\n    this.pairs.push({ object3D, path });\n  }\n  unregister(object3D) {\n    this.pairs = this.pairs.filter(p => p.object3D !== object3D);\n  }\n  tick() {\n    for (let i = 0; i < this.pairs.length; i++) {\n      const matrix = AFRAME.scenes[0].systems.userinput.get(this.pairs[i].path);\n      if (matrix) {\n        const o = this.pairs[i].object3D;\n        o.matrix.copy(matrix);\n        o.matrix.decompose(o.position, o.quaternion, o.scale);\n        o.matrixWorldNeedsUpdate = true;\n      }\n    }\n  }\n}\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { elasticOut } from \"../utils/easing\";\nconst MENU_ANIMATION_DURATION_MS = 750;\nexport class MenuAnimationSystem {\n  constructor() {\n    this.components = [];\n    this.data = new Map();\n    this.tick = this.tick.bind(this);\n    waitForDOMContentLoaded().then(() => {\n      this.viewingCameraEl = document.getElementById(\"viewing-camera\");\n    });\n  }\n  register(component, menuEl, chooseScale) {\n    this.components.push(component);\n    this.data.set(component, {\n      menuEl,\n      chooseScale,\n      menuOpenTime: -1,\n      startScaleAtMenuOpenTime: 0,\n      wasMenuVisible: false,\n      endingScale: 0\n    });\n  }\n  unregister(component) {\n    this.components.splice(this.components.indexOf(component), 1);\n    this.data.delete(component);\n  }\n  tick = (function() {\n    const menuToCamera = new THREE.Vector3();\n    const menuScale = new THREE.Vector3();\n    const menuParentScale = new THREE.Vector3();\n    const menuPosition = new THREE.Vector3();\n    const cameraPosition = new THREE.Vector3();\n    return function tick(t) {\n      if (!this.viewingCameraEl) {\n        return;\n      }\n      const camera = this.viewingCameraEl.object3DMap.camera;\n      camera.updateMatrices();\n      cameraPosition.setFromMatrixPosition(camera.matrixWorld);\n\n      for (let i = 0; i < this.components.length; i++) {\n        const datum = this.data.get(this.components[i]);\n        const isMenuVisible = datum.menuEl.object3D.visible;\n        const isMenuOpening = isMenuVisible && !datum.wasMenuVisible;\n        const distanceToMenu = menuToCamera\n          .subVectors(cameraPosition, menuPosition.setFromMatrixPosition(datum.menuEl.object3D.matrixWorld))\n          .length();\n        datum.menuEl.object3D.parent.updateMatrices();\n        menuParentScale.setFromMatrixScale(datum.menuEl.object3D.parent.matrixWorld);\n        if (isMenuOpening) {\n          const scale = datum.chooseScale\n            ? THREE.MathUtils.clamp(0.45 * distanceToMenu, 0.05, 4)\n            : menuScale.setFromMatrixScale(datum.menuEl.object3D.matrixWorld).x;\n          datum.endingScale = scale / menuParentScale.x;\n          datum.menuOpenTime = t;\n          datum.startScaleAtMenuOpenTime = datum.endingScale * 0.8;\n        }\n        if (isMenuVisible) {\n          const currentScale = THREE.MathUtils.lerp(\n            datum.startScaleAtMenuOpenTime,\n            datum.endingScale,\n            elasticOut(THREE.MathUtils.clamp((t - datum.menuOpenTime) / MENU_ANIMATION_DURATION_MS, 0, 1))\n          );\n          if (datum.menuEl.object3D.scale.x !== currentScale) {\n            datum.menuEl.object3D.scale.setScalar(currentScale);\n            datum.menuEl.object3D.matrixNeedsUpdate = true;\n          }\n        }\n        datum.wasMenuVisible = isMenuVisible;\n      }\n    };\n  })();\n}\n","import { SourceType } from \"../components/audio-params\";\nimport { updateAudioSettings } from \"../update-audio-settings\";\n\nexport class AudioSettingsSystem {\n  constructor(sceneEl) {\n    sceneEl.addEventListener(\"reset_scene\", this.onSceneReset);\n\n    if (window.APP.store.state.preferences.audioNormalization !== 0.0) {\n      //hack to always reset to 0.0 (disabled)\n      window.APP.store.update({\n        preferences: { audioNormalization: 0.0 }\n      });\n    }\n  }\n\n  onSceneReset = () => {\n    APP.sceneAudioDefaults.delete(SourceType.AVATAR_AUDIO_SOURCE);\n    APP.sceneAudioDefaults.delete(SourceType.MEDIA_VIDEO);\n    for (const [el, audio] of APP.audios.entries()) {\n      updateAudioSettings(el, audio);\n    }\n  };\n}\n","import { LogMessageType } from \"../react-components/room/ChatSidebar\";\nimport { GAIN_TIME_CONST, SourceType } from \"../components/audio-params\";\n\nlet delayedReconnectTimeout = null;\nfunction performDelayedReconnect(gainNode) {\n  if (delayedReconnectTimeout) {\n    clearTimeout(delayedReconnectTimeout);\n  }\n\n  delayedReconnectTimeout = setTimeout(() => {\n    delayedReconnectTimeout = null;\n    console.warn(\n      \"enableChromeAEC: recreate RTCPeerConnection loopback because the local connection was disconnected for 10s\"\n    );\n    // eslint-disable-next-line no-use-before-define\n    enableChromeAEC(gainNode);\n  }, 10000);\n}\n\nimport * as sdpTransform from \"sdp-transform\";\nimport MediaDevicesManager from \"../utils/media-devices-manager\";\n\nfunction isThreeAudio(node) {\n  return node instanceof THREE.Audio || node instanceof THREE.PositionalAudio;\n}\n\nasync function enableChromeAEC(gainNode) {\n  /**\n   *  workaround for: https://bugs.chromium.org/p/chromium/issues/detail?id=687574\n   *  1. grab the GainNode from the scene's THREE.AudioListener\n   *  2. disconnect the GainNode from the AudioDestinationNode (basically the audio out), this prevents hearing the audio twice.\n   *  3. create a local webrtc connection between two RTCPeerConnections (see this example: https://webrtc.github.io/samples/src/content/peerconnection/pc1/)\n   *  4. create a new MediaStreamDestination from the scene's THREE.AudioContext and connect the GainNode to it.\n   *  5. add the MediaStreamDestination's track  to one of those RTCPeerConnections\n   *  6. connect the other RTCPeerConnection's stream to a new audio element.\n   *  All audio is now routed through Chrome's audio mixer, thus enabling AEC, while preserving all the audio processing that was performed via the WebAudio API.\n   */\n\n  const audioEl = new Audio();\n  audioEl.setAttribute(\"autoplay\", \"autoplay\");\n  audioEl.setAttribute(\"playsinline\", \"playsinline\");\n\n  const context = THREE.AudioContext.getContext();\n  const loopbackDestination = context.createMediaStreamDestination();\n  const outboundPeerConnection = new RTCPeerConnection();\n  const inboundPeerConnection = new RTCPeerConnection();\n\n  const onError = e => {\n    console.error(\"enableChromeAEC: RTCPeerConnection loopback initialization error\", e);\n  };\n\n  outboundPeerConnection.addEventListener(\"icecandidate\", e => {\n    inboundPeerConnection.addIceCandidate(e.candidate).catch(onError);\n  });\n  outboundPeerConnection.addEventListener(\"iceconnectionstatechange\", () => {\n    console.warn(\n      \"enableChromeAEC: outboundPeerConnection state changed to \" + outboundPeerConnection.iceConnectionState\n    );\n    if (outboundPeerConnection.iceConnectionState === \"disconnected\") {\n      performDelayedReconnect(gainNode);\n    }\n    if (outboundPeerConnection.iceConnectionState === \"connected\") {\n      if (delayedReconnectTimeout) {\n        // The RTCPeerConnection reconnected by itself, cancel recreating the\n        // local connection.\n        clearTimeout(delayedReconnectTimeout);\n      }\n    }\n  });\n\n  inboundPeerConnection.addEventListener(\"icecandidate\", e => {\n    outboundPeerConnection.addIceCandidate(e.candidate).catch(onError);\n  });\n  inboundPeerConnection.addEventListener(\"iceconnectionstatechange\", () => {\n    console.warn(\"enableChromeAEC: inboundPeerConnection state changed to \" + inboundPeerConnection.iceConnectionState);\n    if (inboundPeerConnection.iceConnectionState === \"disconnected\") {\n      performDelayedReconnect(gainNode);\n    }\n    if (inboundPeerConnection.iceConnectionState === \"connected\") {\n      if (delayedReconnectTimeout) {\n        // The RTCPeerConnection reconnected by itself, cancel recreating the\n        // local connection.\n        clearTimeout(delayedReconnectTimeout);\n      }\n    }\n  });\n\n  inboundPeerConnection.addEventListener(\"track\", e => {\n    audioEl.srcObject = e.streams[0];\n  });\n\n  try {\n    //The following should never fail, but just in case, we won't disconnect/reconnect the gainNode unless all of this succeeds\n    loopbackDestination.stream.getTracks().forEach(track => {\n      outboundPeerConnection.addTrack(track, loopbackDestination.stream);\n    });\n\n    const offer = await outboundPeerConnection.createOffer();\n    outboundPeerConnection.setLocalDescription(offer);\n    await inboundPeerConnection.setRemoteDescription(offer);\n\n    const answer = await inboundPeerConnection.createAnswer();\n\n    // Rewrite SDP to be stereo and (variable) max bitrate\n    const parsedSdp = sdpTransform.parse(answer.sdp);\n    for (let i = 0; i < parsedSdp.media.length; i++) {\n      for (let j = 0; j < parsedSdp.media[i].fmtp.length; j++) {\n        parsedSdp.media[i].fmtp[j].config += `;stereo=1;cbr=0;maxaveragebitrate=510000;`;\n      }\n    }\n    answer.sdp = sdpTransform.write(parsedSdp);\n\n    inboundPeerConnection.setLocalDescription(answer);\n    outboundPeerConnection.setRemoteDescription(answer);\n\n    gainNode.disconnect();\n    gainNode.connect(loopbackDestination);\n  } catch (e) {\n    onError(e);\n  }\n}\n\nexport class AudioSystem {\n  constructor(sceneEl) {\n    this._sceneEl = sceneEl;\n\n    this.audioContext = THREE.AudioContext.getContext();\n    this.audioNodes = new Map();\n    this.mediaStreamDestinationNode = this.audioContext.createMediaStreamDestination(); // Voice, camera, screenshare\n    this.audioDestination = this.audioContext.createMediaStreamDestination(); // Media elements\n    this.outboundStream = this.mediaStreamDestinationNode.stream;\n    this.outboundGainNode = this.audioContext.createGain();\n    this.outboundAnalyser = this.audioContext.createAnalyser();\n    this.outboundAnalyser.fftSize = 32;\n    this.analyserLevels = new Uint8Array(this.outboundAnalyser.fftSize);\n    this.outboundGainNode.connect(this.outboundAnalyser);\n    this.outboundAnalyser.connect(this.mediaStreamDestinationNode);\n    this.audioContextNeedsToBeResumed = false;\n\n    this.mixer = {\n      [SourceType.AVATAR_AUDIO_SOURCE]: this.audioContext.createGain(),\n      [SourceType.MEDIA_VIDEO]: this.audioContext.createGain(),\n      [SourceType.SFX]: this.audioContext.createGain()\n    };\n    this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(this._sceneEl.audioListener.getInput());\n    this.mixer[SourceType.MEDIA_VIDEO].connect(this._sceneEl.audioListener.getInput());\n    this.mixer[SourceType.SFX].connect(this._sceneEl.audioListener.getInput());\n\n    // Analyser to show the output audio level\n    this.mixerAnalyser = this.audioContext.createAnalyser();\n    this.mixerAnalyser.fftSize = 32;\n    this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(this.mixerAnalyser);\n    this.mixer[SourceType.MEDIA_VIDEO].connect(this.mixerAnalyser);\n    this.mixer[SourceType.SFX].connect(this.mixerAnalyser);\n\n    // Webkit Mobile fix\n    this._safariMobileAudioInterruptionFix();\n\n    document.body.addEventListener(\"touchend\", this._resumeAudioContext, false);\n    document.body.addEventListener(\"mouseup\", this._resumeAudioContext, false);\n\n    this.onPrefsUpdated = this.updatePrefs.bind(this);\n    window.APP.store.addEventListener(\"statechanged\", this.onPrefsUpdated);\n  }\n\n  addStreamToOutboundAudio(id, mediaStream) {\n    if (this.audioNodes.has(id)) {\n      this.removeStreamFromOutboundAudio(id);\n    }\n\n    const sourceNode = this.audioContext.createMediaStreamSource(mediaStream);\n    const gainNode = this.audioContext.createGain();\n    sourceNode.connect(gainNode);\n    gainNode.connect(this.outboundGainNode);\n    this.audioNodes.set(id, { sourceNode, gainNode });\n  }\n\n  removeStreamFromOutboundAudio(id) {\n    if (this.audioNodes.has(id)) {\n      const nodes = this.audioNodes.get(id);\n      nodes.sourceNode.disconnect();\n      nodes.gainNode.disconnect();\n      this.audioNodes.delete(id);\n    }\n  }\n\n  addAudio({ sourceType, node }) {\n    let outputNode = node;\n    if (isThreeAudio(node)) {\n      node.gain.disconnect();\n      outputNode = node.gain;\n    }\n    outputNode.connect(this.mixer[sourceType]);\n  }\n\n  removeAudio({ node }) {\n    let outputNode = node;\n    if (isThreeAudio(node)) {\n      outputNode = node.gain;\n    }\n    outputNode.disconnect();\n  }\n\n  updatePrefs() {\n    const { globalVoiceVolume, globalMediaVolume, globalSFXVolume } = window.APP.store.state.preferences;\n    let newGain = globalMediaVolume / 100;\n    this.mixer[SourceType.MEDIA_VIDEO].gain.setTargetAtTime(newGain, this.audioContext.currentTime, GAIN_TIME_CONST);\n\n    newGain = globalSFXVolume / 100;\n    this.mixer[SourceType.SFX].gain.setTargetAtTime(newGain, this.audioContext.currentTime, GAIN_TIME_CONST);\n\n    newGain = globalVoiceVolume / 100;\n    this.mixer[SourceType.AVATAR_AUDIO_SOURCE].gain.setTargetAtTime(\n      newGain,\n      this.audioContext.currentTime,\n      GAIN_TIME_CONST\n    );\n\n    if (MediaDevicesManager.isAudioOutputSelectEnabled && APP.mediaDevicesManager) {\n      const sinkId = APP.mediaDevicesManager.selectedSpeakersDeviceId;\n      const isDefault = sinkId === APP.mediaDevicesManager.defaultOutputDeviceId;\n      if ((!this.outputMediaAudio && isDefault) || sinkId === this.outputMediaAudio?.sinkId) return;\n      const sink = isDefault ? this._sceneEl.audioListener.getInput() : this.audioDestination;\n      this.mixer[SourceType.AVATAR_AUDIO_SOURCE].disconnect();\n      this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(sink);\n      this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(this.mixerAnalyser);\n      this.mixer[SourceType.MEDIA_VIDEO].disconnect();\n      this.mixer[SourceType.MEDIA_VIDEO].connect(sink);\n      this.mixer[SourceType.MEDIA_VIDEO].connect(this.mixerAnalyser);\n      this.mixer[SourceType.SFX].disconnect();\n      this.mixer[SourceType.SFX].connect(sink);\n      this.mixer[SourceType.SFX].connect(this.mixerAnalyser);\n      if (isDefault) {\n        if (this.outputMediaAudio) {\n          this.outputMediaAudio.pause();\n          this.outputMediaAudio.srcObject = null;\n          this.outputMediaAudio = null;\n        }\n      } else {\n        // Swithing the audio sync is only supported in Chrome at the time of writing this.\n        // It also seems to have some limitations and it only works on audio elements. We are piping all our media through the Audio Context\n        // and that doesn't seem to work.\n        // To workaround that we need to use a MediaStreamAudioDestinationNode that is set as the source of the audio element where we switch the sink.\n        // This is very hacky but there don't seem to have any better alternatives at the time of writing this.\n        // https://stackoverflow.com/a/67043782\n        if (!this.outputMediaAudio) {\n          this.outputMediaAudio = new Audio();\n          this.outputMediaAudio.srcObject = this.audioDestination.stream;\n        }\n        if (this.outputMediaAudio.sinkId !== sinkId) {\n          this.outputMediaAudio.setSinkId(sinkId).then(() => {\n            this.outputMediaAudio.play();\n          });\n        }\n      }\n    }\n  }\n\n  /**\n   * Chrome and Safari will start Audio contexts in a \"suspended\" state.\n   * A user interaction (touch/mouse event) is needed in order to resume the AudioContext.\n   */\n  _resumeAudioContext = () => {\n    this.audioContext.resume();\n\n    setTimeout(() => {\n      if (this.audioContext.state === \"running\") {\n        const disableAEC = window.APP.store.state.preferences.disableEchoCancellation;\n        if (!AFRAME.utils.device.isMobile() && /chrome/i.test(navigator.userAgent) && !disableAEC) {\n          enableChromeAEC(this._sceneEl.audioListener.gain);\n        }\n\n        document.body.removeEventListener(\"touchend\", this._resumeAudioContext, false);\n        document.body.removeEventListener(\"mouseup\", this._resumeAudioContext, false);\n      }\n    }, 0);\n  };\n\n  // Webkit mobile fix\n  // https://stackoverflow.com/questions/10232908/is-there-a-way-to-detect-a-mobile-safari-audio-interruption-headphones-unplugg\n  _safariMobileAudioInterruptionFix() {\n    this.audioContext.onstatechange = () => {\n      console.log(`AudioContext state changed to ${this.audioContext.state}`);\n      if (this.audioContext.state === \"suspended\") {\n        // When you unplug the headphone or when the bluetooth headset disconnects on\n        // iOS Safari or Chrome, the state changes to suspended.\n        // Chrome Android doesn't go in suspended state for this case.\n        document.getElementById(\"avatar-rig\").messageDispatch.log(LogMessageType.audioSuspended);\n        document.body.addEventListener(\"touchend\", this._resumeAudioContext, false);\n        document.body.addEventListener(\"mouseup\", this._resumeAudioContext, false);\n        this.audioContextNeedsToBeResumed = true;\n      } else if (this.audioContext.state === \"running\" && this.audioContextNeedsToBeResumed) {\n        this.audioContextNeedsToBeResumed = false;\n        document.getElementById(\"avatar-rig\").messageDispatch.log(LogMessageType.audioResumed);\n      }\n    };\n  }\n}\n","import { updateMaterials } from \"../utils/material-utils.js\";\n\nconst frustumBox = new THREE.Box3();\nconst inverseShadowCameraMatrixWorld = new THREE.Matrix4();\nconst tempBox = new THREE.Box3();\nconst FRUSTUM_PADDING = 1;\nconst NEAR_CLIPPING_PLANE = -500;\nconst FAR_CLIPPING_PLANE = 500;\nconst verts = [\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3()\n];\n\nfunction computeShadowCameraBoundingBox(object3D, boundingBox = new THREE.Box3()) {\n  boundingBox.makeEmpty();\n\n  object3D.updateMatrixWorld();\n\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\n  object3D.traverse(node => {\n    const geometry = node.geometry;\n\n    if (geometry && node.castShadow) {\n      if (!geometry.boundingBox) {\n        geometry.computeBoundingBox();\n      }\n\n      tempBox.copy(geometry.boundingBox);\n\n      // Apply matrix transforming bounding box from model space to world space\n      tempBox.applyMatrix4(node.matrixWorld);\n\n      boundingBox.union(tempBox);\n    }\n  });\n\n  tempBox.makeEmpty();\n\n  return boundingBox;\n}\n\nfunction resizeShadowCameraFrustum(light, boundingBox) {\n  // Reset bounding box\n  frustumBox.makeEmpty();\n\n  // Transform the resulting bounding box from world space to light space.\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\n  const min = boundingBox.min;\n  const max = boundingBox.max;\n\n  verts[0].set(min.x, min.y, min.z);\n  verts[1].set(min.x, min.y, max.z);\n  verts[2].set(min.x, max.y, min.z);\n  verts[3].set(min.x, max.y, max.z);\n  verts[4].set(max.x, min.y, min.z);\n  verts[5].set(max.x, min.y, max.z);\n  verts[6].set(max.x, max.y, min.z);\n  verts[7].set(max.x, max.y, max.z);\n\n  light.updateMatrices();\n  light.target.updateMatrices();\n  light.shadow.updateMatrices(light);\n  inverseShadowCameraMatrixWorld.copy(light.shadow.camera.matrixWorld).invert();\n\n  for (let i = 0; i < verts.length; i++) {\n    verts[i].applyMatrix4(inverseShadowCameraMatrixWorld);\n    frustumBox.expandByPoint(verts[i]);\n  }\n\n  // Update the camera frustum to fit the resulting bounding box.\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\n  const camera = light.shadow.camera;\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\n  camera.updateProjectionMatrix();\n}\n\nexport class ShadowSystem {\n  constructor(sceneEl) {\n    this.sceneEl = sceneEl;\n    this.shadowCameraBoundingBox = new THREE.Box3();\n    this.previousShadowsEnabled = this.realtimeShadowsEnabled = null;\n\n    // Defaults previously in hub.html\n    sceneEl.renderer.shadowMap.enabled = false;\n    sceneEl.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n    sceneEl.renderer.shadowMap.autoUpdate = true;\n\n    window.APP.store.addEventListener(\"statechanged\", this.updatePrefs.bind(this));\n    this.updatePrefs();\n  }\n\n  updatePrefs() {\n    this.realtimeShadowsEnabled =\n      window.APP.store.state.preferences.enableDynamicShadows === true &&\n      window.APP.store.materialQualitySetting !== \"low\";\n    if (this.previousShadowsEnabled !== this.realtimeShadowsEnabled) {\n      this.sceneEl.renderer.shadowMap.enabled = this.realtimeShadowsEnabled;\n\n      // If scene has already rendered, materials which can receive shadows must be updated.\n      if (this.sceneEl.hasLoaded) {\n        this.sceneEl.object3D.traverse(node => {\n          if (node.receiveShadow && node.material) {\n            updateMaterials(node, material => {\n              material.needsUpdate = true;\n              return material;\n            });\n          }\n        });\n      }\n    }\n    this.previousShadowsEnabled = this.realtimeShadowsEnabled;\n  }\n\n  tick() {\n    if (!this.realtimeShadowsEnabled) {\n      return;\n    }\n    computeShadowCameraBoundingBox(this.sceneEl.object3D, this.shadowCameraBoundingBox);\n    this.sceneEl.object3D.traverse(object3D => {\n      if (object3D.isDirectionalLight) {\n        resizeShadowCameraFrustum(object3D, this.shadowCameraBoundingBox);\n      }\n    });\n  }\n}\n","import { paths } from \"./userinput/paths\";\nexport class InspectYourselfSystem {\n  tick(scene, userinput, cameraSystem) {\n    if (!scene.is(\"entered\")) return;\n    if (userinput.get(paths.actions.startInspectingSelf)) {\n      const rig = document.getElementById(\"avatar-rig\");\n      cameraSystem.inspect(rig, 1.5);\n    }\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { emojis, spawnEmojiInFrontOfUser } from \"../components/emoji\";\n\nconst actions = [\n  paths.actions.spawnEmoji0,\n  paths.actions.spawnEmoji1,\n  paths.actions.spawnEmoji2,\n  paths.actions.spawnEmoji3,\n  paths.actions.spawnEmoji4,\n  paths.actions.spawnEmoji5,\n  paths.actions.spawnEmoji6\n];\n\nconst EMOJI_RATE_LIMIT = 1000;\n\nexport class EmojiSystem {\n  constructor(scene) {\n    this.scene = scene;\n\n    this.scene.addEventListener(\"enter-vr\", () => {\n      if (!document.getElementById(\"emoji-hud\")) {\n        const emojiHudEntity = document.createElement(\"a-entity\");\n        emojiHudEntity.id = \"emoji-hud\";\n        emojiHudEntity.setAttribute(\"emoji-hud\", \"\");\n        scene.appendChild(emojiHudEntity);\n      }\n    });\n\n    this.scene.addEventListener(\"exit-vr\", () => {\n      const emojiHudEntity = document.getElementById(\"emoji-hud\");\n\n      if (emojiHudEntity) {\n        emojiHudEntity.remove();\n      }\n    });\n\n    this.lastSpawnedEmoji = 0;\n  }\n\n  tick(time, userinput) {\n    if (!this.scene.is(\"entered\")) return;\n\n    for (let i = 0; i < actions.length; i++) {\n      if (\n        userinput.get(actions[i]) &&\n        i < emojis.length &&\n        window.APP.hubChannel.can(\"spawn_emoji\") &&\n        time - this.lastSpawnedEmoji > EMOJI_RATE_LIMIT\n      ) {\n        this.lastSpawnedEmoji = time;\n        spawnEmojiInFrontOfUser(emojis[i]);\n      }\n    }\n  }\n}\n","// We apply the most restrictive audio parameters\nfunction paramsReducer(acc, curr) {\n  if (!curr && !acc) return {};\n  else if (curr && !acc) return curr;\n  else if (!curr && acc) return acc;\n  else\n    return [\n      \"gain\",\n      \"maxDistance\",\n      \"refDistance\",\n      \"rolloffFactor\",\n      \"coneInnerAngle\",\n      \"coneOuterAngle\",\n      \"coneOuterGain\"\n    ].reduce((result, key) => {\n      if (curr[key] !== undefined && acc[key] !== undefined) {\n        result[key] = Math.min(acc[key], curr[key]);\n      } else if (curr[key] !== undefined && acc[key] === undefined) {\n        result[key] = curr[key];\n      } else if (curr[key] === undefined && acc[key] !== undefined) {\n        result[key] = acc[key];\n      }\n      return result;\n    }, {});\n}\n\nfunction addOrRemoveZone(zones, zone, position) {\n  const isInZone = zone.isEnabled() && zone.contains(position);\n  const wasInZone = zones.has(zone);\n  if (isInZone && !wasInZone) {\n    zones.add(zone);\n  } else if (!isInZone && wasInZone) {\n    zones.delete(zone);\n  }\n}\n\nfunction any(set, predicate) {\n  for (const item of set) {\n    if (predicate(item)) return true;\n  }\n  return false;\n}\n\nfunction isUpdated(currZones, prevZones) {\n  return currZones.size !== prevZones.size || any(currZones, zone => !prevZones.has(zone));\n}\n\nconst setRay = (function() {\n  const direction = new THREE.Vector3();\n  return function setRay(ray, from, to) {\n    ray.set(from, direction.subVectors(to, from).normalize());\n  };\n})();\n\nfunction exclude(zones) {\n  return zone => {\n    return !zones.has(zone);\n  };\n}\n\nfunction hasIntersection(ray) {\n  const intersectTarget = new THREE.Vector3();\n  return zone => {\n    ray.intersectBox(zone.getBoundingBox(), intersectTarget);\n    return intersectTarget !== null;\n  };\n}\nconst updateSource = (function() {\n  const ray = new THREE.Ray();\n  return function updateSource(source, sourcePosition, sourceZones, listenerPosition, listenerZones) {\n    setRay(ray, listenerPosition, sourcePosition);\n\n    // TODO: Reimplement the desired sorting of zones\n    const inOutParams = Array.from(sourceZones)\n      .filter(zone => zone.data.inOut)\n      .filter(exclude(listenerZones))\n      .filter(hasIntersection(ray))\n      .map(zone => zone.getAudioParams())\n      .reduce(paramsReducer, null);\n\n    // TODO: Reimplement the desired sorting of zones\n    const outInParams = Array.from(listenerZones)\n      .filter(zone => zone.data.outIn)\n      .filter(exclude(sourceZones))\n      .filter(hasIntersection(ray))\n      .map(zone => zone.getAudioParams())\n      .reduce(paramsReducer, null);\n\n    if (!outInParams && !inOutParams) {\n      source.restore();\n    } else if (outInParams && !inOutParams) {\n      source.apply(outInParams);\n    } else if (!outInParams && inOutParams) {\n      source.apply(inOutParams);\n    } else {\n      // In this case two zones ar acting over the same source simultaneously.\n      // We apply the closest zone params with the lowest gain\n      source.apply(\n        Object.assign(\n          {},\n          inOutParams,\n          outInParams,\n          paramsReducer(\n            {\n              gain: outInParams.gain\n            },\n            {\n              gain: inOutParams.gain\n            }\n          )\n        )\n      );\n    }\n  };\n})();\n\nexport class AudioZonesSystem {\n  constructor() {\n    this.zones = [];\n    this.sources = [];\n    this.entities = [];\n    this.currZones = new Map();\n    this.prevZones = new Map();\n    this.didRegisterAudioListener = false;\n  }\n  registerZone(zone) {\n    this.zones.push(zone);\n  }\n  unregisterZone(zone) {\n    this.zones.splice(this.zones.indexOf(zone), 1);\n    this.entities.forEach(entity => {\n      this.currZones.get(entity).delete(zone);\n    });\n  }\n  registerSource(source) {\n    this.sources.push(source);\n    this.registerEntity(source);\n  }\n  unregisterSource(source) {\n    this.sources.splice(this.sources.indexOf(source), 1);\n    this.unregisterEntity(source);\n  }\n  registerEntity(entity) {\n    this.entities.push(entity);\n    this.currZones.set(entity, new Set());\n    this.prevZones.set(entity, new Set());\n  }\n  unregisterEntity(entity) {\n    this.entities.splice(this.entities.indexOf(entity), 1);\n    this.currZones.delete(entity);\n    this.prevZones.delete(entity);\n  }\n\n  tick = (function() {\n    const listenerPosition = new THREE.Vector3();\n    return function(scene) {\n      if (!scene.is(\"entered\")) return;\n\n      if (!this.didRegisterAudioListener) {\n        this.didRegisterAudioListener = true;\n        this.registerEntity(scene.audioListener);\n      }\n\n      const currListenerZones = this.currZones.get(scene.audioListener);\n      scene.audioListener.getWorldPosition(listenerPosition);\n      this.zones.forEach(zone => {\n        addOrRemoveZone(currListenerZones, zone, listenerPosition);\n        this.sources.forEach(source => {\n          addOrRemoveZone(this.currZones.get(source), zone, source.getPosition());\n        });\n      });\n\n      const isListenerUpdated = isUpdated(currListenerZones, this.prevZones.get(scene.audioListener));\n      this.sources\n        .filter(source => {\n          return isListenerUpdated || isUpdated(this.currZones.get(source), this.prevZones.get(source));\n        })\n        .forEach(source => {\n          updateSource(source, source.getPosition(), this.currZones.get(source), listenerPosition, currListenerZones);\n        });\n\n      this.entities.forEach(entity => {\n        const prevZones = this.prevZones.get(entity);\n        prevZones.clear();\n        this.currZones.get(entity).forEach(zone => prevZones.add(zone));\n      });\n    };\n  })();\n}\n","import {\n  getCurrentAudioSettings,\n  shouldAddSupplementaryAttenuation,\n  updateAudioSettings\n} from \"../update-audio-settings\";\n\nconst distanceModels = {\n  linear: function(distance, rolloffFactor, refDistance, maxDistance) {\n    return 1.0 - rolloffFactor * ((distance - refDistance) / (maxDistance - refDistance));\n  },\n  inverse: function(distance, rolloffFactor, refDistance) {\n    return refDistance / (refDistance + rolloffFactor * (Math.max(distance, refDistance) - refDistance));\n  },\n  exponential: function(distance, rolloffFactor, refDistance) {\n    return Math.pow(Math.max(distance, refDistance) / refDistance, -rolloffFactor);\n  }\n};\n\nconst calculateAttenuation = (() => {\n  const listenerPos = new THREE.Vector3();\n  const sourcePos = new THREE.Vector3();\n  return (el, audio) => {\n    el.sceneEl.audioListener.getWorldPosition(listenerPos);\n    audio.getWorldPosition(sourcePos);\n    const distance = sourcePos.distanceTo(listenerPos);\n    if (audio.panner) {\n      return distanceModels[audio.panner.distanceModel](\n        distance,\n        audio.panner.rolloffFactor,\n        audio.panner.refDistance,\n        audio.panner.maxDistance\n        // TODO: Why are coneInnerAngle, coneOuterAngle and coneOuterGain not used?\n      );\n    } else {\n      const { distanceModel, rolloffFactor, refDistance, maxDistance } = getCurrentAudioSettings(el);\n      if (!distanceModel) {\n        // Apparently, it is valid to give null as your distanceModel\n        return 1.0;\n      }\n      if (!distanceModels[distanceModel]) {\n        // TODO: Validate properties earlier in the process.\n        console.error(\"Unrecognized distance model.\");\n        return 1.0;\n      }\n\n      return distanceModels[distanceModel](distance, rolloffFactor, refDistance, maxDistance);\n    }\n  };\n})();\n\n// TODO: Rename \"GainSystem\" because the name is suspicious\nexport class GainSystem {\n  tick() {\n    const { enableAudioClipping, audioClippingThreshold } = window.APP.store.state.preferences;\n    for (const [el, audio] of APP.audios.entries()) {\n      const attenuation = calculateAttenuation(el, audio);\n\n      if (shouldAddSupplementaryAttenuation(el, audio)) {\n        APP.supplementaryAttenuation.set(el, attenuation);\n        updateAudioSettings(el, audio);\n      } else if (APP.supplementaryAttenuation.has(el)) {\n        APP.supplementaryAttenuation.delete(el);\n        updateAudioSettings(el, audio);\n      }\n\n      const isClipped = APP.clippingState.has(el);\n      const shouldBeClipped = enableAudioClipping && attenuation < audioClippingThreshold;\n      if (isClipped !== shouldBeClipped) {\n        if (shouldBeClipped) {\n          APP.clippingState.add(el);\n        } else {\n          APP.clippingState.delete(el);\n        }\n        updateAudioSettings(el, audio);\n      }\n    }\n  }\n}\n","import { GUI } from \"three/examples/jsm/libs/lil-gui.module.min\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nimport { LUTCubeLoader } from \"three/examples/jsm/loaders/LUTCubeLoader\";\nimport blenderLutPath from \"../assets/blender-lut.cube\";\n\nconst toneMappingOptions = {\n  None: \"NoToneMapping\",\n  Linear: \"LinearToneMapping\",\n  Reinhard: \"ReinhardToneMapping\",\n  Cineon: \"CineonToneMapping\",\n  ACESFilmic: \"ACESFilmicToneMapping\",\n  CustomToneMapping: \"CustomToneMapping\",\n  LUTToneMapping: \"LUTToneMapping\"\n};\n\nconst outputEncodingOptions = {\n  LinearEncoding: \"LinearEncoding\",\n  sRGBEncoding: \"sRGBEncoding\",\n  GBEEncoding: \"GBEEncoding\",\n  GBM7Encoding: \"GBM7Encoding\",\n  GBDEncoding: \"GBDEncoding\",\n  BasicDepthPacking: \"BasicDepthPacking\",\n  GBADepthPacking: \"GBADepthPackig\"\n};\n\nconst defaultEnvSettings = {\n  toneMapping: toneMappingOptions.Linear,\n  outputEncoding: outputEncodingOptions.sRGBEncoding,\n  toneMappingExposure: 1,\n  physicallyCorrectLights: true,\n  envMapTexture: null,\n  backgroundTexture: null,\n  backgroundColor: new THREE.Color(\"#000000\"),\n\n  fogType: null,\n  fogColor: new THREE.Color(\"#ffffff\"),\n  fogDensity: 0.00025,\n  fogFar: 1000,\n  fogNear: 1\n};\n\nlet blenderLUTPromise; // lazy loaded\n\nexport class EnvironmentSystem {\n  constructor(sceneEl) {\n    this.scene = sceneEl.object3D;\n    this.renderer = sceneEl.renderer;\n\n    this.pmremGenerator = new THREE.PMREMGenerator(this.renderer);\n\n    this.applyEnvSettings(defaultEnvSettings);\n\n    if (qsTruthy(\"envSettingsDebug\")) {\n      this.setupDebugView();\n    }\n  }\n\n  setupDebugView() {\n    const debugSettings = { ...defaultEnvSettings };\n\n    const updateDebug = () => {\n      this.applyEnvSettings(debugSettings);\n    };\n\n    const gui = new GUI();\n    gui\n      .add(debugSettings, \"toneMapping\", Object.values(toneMappingOptions))\n      .onChange(updateDebug)\n      .listen();\n    gui\n      .add(debugSettings, \"toneMappingExposure\", 0, 4, 0.01)\n      .onChange(updateDebug)\n      .listen();\n    gui\n      .add(debugSettings, \"outputEncoding\", Object.values(outputEncodingOptions))\n      .onChange(updateDebug)\n      .listen();\n    gui\n      .add(debugSettings, \"physicallyCorrectLights\", true)\n      .onChange(updateDebug)\n      .listen();\n    gui.open();\n\n    this.debugGui = gui;\n    this.debugSettings = debugSettings;\n    this.debugMode = true;\n\n    window.$E = this;\n  }\n\n  updateEnvironment(envEl) {\n    const envSettingsEl = envEl.querySelector(\"[environment-settings]\");\n    const skyboxEl = envEl.querySelector(\"[skybox]\");\n    const navmeshEl = envEl.querySelector(\"[nav-mesh]\");\n\n    const envSettings = {\n      ...defaultEnvSettings,\n      skybox: skyboxEl?.components[\"skybox\"]\n    };\n\n    if (envSettingsEl) {\n      Object.assign(envSettings, envSettingsEl.components[\"environment-settings\"].data);\n    }\n\n    const navMesh = navmeshEl?.object3D.getObjectByProperty(\"isMesh\", true);\n    if (navMesh) {\n      AFRAME.scenes[0].systems.nav.loadMesh(navMesh, navmeshEl.components[\"nav-mesh\"].data.zone);\n    }\n\n    // TODO animated objects should not be static\n    envEl.object3D.traverse(o => {\n      if (o.isMesh) {\n        o.reflectionProbeMode = \"static\";\n      }\n    });\n\n    this.applyEnvSettings(envSettings);\n  }\n\n  applyEnvSettings(settings) {\n    if (this.debugSettings) {\n      Object.assign(this.debugSettings, settings);\n    }\n\n    let materialsNeedUpdate = false;\n\n    if (this.debugMode) console.log(\"Applying environment settings\", settings);\n\n    if (this.renderer.physicallyCorrectLights !== settings.physicallyCorrectLights) {\n      this.renderer.physicallyCorrectLights = settings.physicallyCorrectLights;\n      materialsNeedUpdate = true;\n    }\n\n    const newToneMapping = THREE[settings.toneMapping];\n    if (this.renderer.toneMapping !== newToneMapping) {\n      this.renderer.toneMapping = newToneMapping;\n      materialsNeedUpdate = true;\n\n      // TODO clean up async behavior\n      if (newToneMapping === THREE.LUTToneMapping) {\n        if (!blenderLUTPromise) {\n          blenderLUTPromise = new Promise(function(resolve, reject) {\n            new LUTCubeLoader().load(blenderLutPath, ({ texture3D }) => resolve(texture3D), null, reject);\n          });\n        }\n\n        blenderLUTPromise\n          .then(t => {\n            this.renderer.tonemappingLUT = t;\n          })\n          .catch(function(e) {\n            console.error(\"Error loading Blender LUT\", e);\n            blenderLUTPromise = null;\n          });\n      } else {\n        this.renderer.tonemappingLUT = null;\n      }\n    }\n\n    this.renderer.toneMappingExposure = settings.toneMappingExposure;\n\n    const newOutputEncoding = THREE[settings.outputEncoding];\n    if (this.renderer.outputEncoding !== newOutputEncoding) {\n      this.renderer.outputEncoding = newOutputEncoding;\n      materialsNeedUpdate = true;\n    }\n\n    this.scene.remove(window.lp);\n\n    if (settings.backgroundTexture) {\n      // Assume texture is always an equirect for now\n      settings.backgroundTexture.mapping = THREE.EquirectangularReflectionMapping;\n      this.scene.background = settings.backgroundTexture;\n    } else {\n      this.scene.background = settings.backgroundColor;\n    }\n\n    if (settings.envMapTexture) {\n      if (this.prevEnvMapTextureUUID !== settings.envMapTexture.uuid) {\n        this.prevEnvMapTextureUUID = settings.envMapTexture.uuid;\n        // TODO PMREMGenerator should be fixed to not assume this\n        settings.envMapTexture.flipY = true;\n        // Assume texture is always an equirect for now\n        settings.envMapTexture.mapping = THREE.EquirectangularReflectionMapping;\n        this.scene.environment = settings.envMapTexture;\n      }\n    } else if (settings.skybox) {\n      if (this.prevEnvMapTextureUUID !== settings.skybox.uuid) {\n        this.prevEnvMapTextureUUID = settings.skybox.uuid;\n        this.scene.environment = settings.skybox.sky.generateEnvironmentMap(this.renderer);\n      }\n    } else {\n      this.scene.environment = null;\n      this.prevEnvMapTextureUUID = null;\n    }\n\n    if (this.scene.fog?.name !== settings.fogType) {\n      if (settings.fogType === \"linear\") {\n        this.scene.fog = new THREE.Fog(settings.fogColor, settings.fogNear, settings.fogFar);\n      } else if (settings.fogType === \"exponential\") {\n        this.scene.fog = new THREE.FogExp2(settings.fogColor, settings.fogDensity);\n      } else {\n        this.scene.fog = null;\n      }\n      materialsNeedUpdate = true;\n    } else if (settings.fogType) {\n      this.scene.fog.color.copy(settings.fogColor);\n      if (settings.fogType === \"linear\") {\n        this.scene.fog.near = settings.fogNear;\n        this.scene.fog.far = settings.fogFar;\n      } else if (settings.fogType === \"exponential\") {\n        this.scene.fog.density = settings.fogDensity;\n      }\n    }\n\n    if (materialsNeedUpdate) {\n      if (this.debugMode) console.log(\"materials need updating\");\n      this.scene.traverse(o => {\n        if (o.material) o.material.needsUpdate = true;\n      });\n    }\n  }\n}\n\nAFRAME.registerComponent(\"nav-mesh\", {\n  schema: {\n    zone: { default: \"character\" }\n  }\n});\n\nAFRAME.registerComponent(\"environment-settings\", {\n  schema: {\n    toneMapping: { default: defaultEnvSettings.toneMapping, oneOf: Object.values(toneMappingOptions) },\n    toneMappingExposure: { default: defaultEnvSettings.toneMappingExposure },\n    backgroundColor: { type: \"color\", default: defaultEnvSettings.background },\n\n    fogType: { type: \"string\", default: defaultEnvSettings.fogType },\n    fogColor: { type: \"color\", default: defaultEnvSettings.fogColor },\n    fogDensity: { type: \"number\", default: defaultEnvSettings.fogDensity },\n    fogNear: { type: \"number\", default: defaultEnvSettings.forNear },\n    fogFar: { type: \"number\", default: defaultEnvSettings.fogFar }\n  }\n});\n\nAFRAME.registerComponent(\"reflection-probe\", {\n  schema: {\n    size: { default: 1 },\n    envMapTexture: { type: \"map\" }\n  },\n\n  init: function() {\n    this.el.object3D.updateMatrices();\n\n    const box = new THREE.Box3()\n      .setFromCenterAndSize(new THREE.Vector3(), new THREE.Vector3().setScalar(this.data.size * 2))\n      .applyMatrix4(this.el.object3D.matrixWorld);\n\n    this.el.setObject3D(\"probe\", new THREE.ReflectionProbe(box, this.data.envMapTexture));\n\n    if (this.el.sceneEl.systems[\"hubs-systems\"].environmentSystem.debugMode) {\n      const debugBox = new THREE.Box3().setFromCenterAndSize(\n        new THREE.Vector3(),\n        new THREE.Vector3().setScalar(this.data.size * 2)\n      );\n      this.el.setObject3D(\n        \"helper\",\n        new THREE.Box3Helper(debugBox, new THREE.Color(Math.random(), Math.random(), Math.random()))\n      );\n    }\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nexport class NameTagVisibilitySystem {\n  constructor(sceneEl) {\n    this.sceneEl = sceneEl;\n    this.store = window.APP.store;\n    this.components = [];\n    this.lastUpdateTime = Date.now();\n    this.tick = this.tick.bind(this);\n    this.onStateChanged = this.onStateChanged.bind(this);\n    this.nametagVisibility = this.store.state.preferences.nametagVisibility;\n    this.nametagVisibilityDistance = Math.pow(this.store.state.preferences.nametagVisibilityDistance, 2);\n    waitForDOMContentLoaded().then(() => {\n      this.avatarRig = document.getElementById(\"avatar-rig\").object3D;\n    });\n    window.APP.store.addEventListener(\"statechanged\", this.onStateChanged);\n  }\n\n  register(component) {\n    this.components.push(component);\n  }\n\n  unregister(component) {\n    this.components.splice(this.components.indexOf(component), 1);\n  }\n\n  tick = (function() {\n    const worldPos = new THREE.Vector3();\n    const avatarRigWorldPos = new THREE.Vector3();\n    return function tick() {\n      this.avatarRig.getWorldPosition(avatarRigWorldPos);\n      this.components.forEach(nametag => {\n        if (this.nametagVisibility === \"showSpeaking\") {\n          const now = Date.now();\n          if (!nametag.isTalking && nametag.wasTalking) {\n            if (now - nametag.lastUpdateTime > 3000) {\n              nametag.shouldBeVisible = false;\n            }\n          } else if (nametag.isTalking && !nametag.wasTalking) {\n            nametag.lastUpdateTime = Date.now();\n            nametag.shouldBeVisible = true;\n          } else if (!nametag.isTalking && !nametag.wasTalking) {\n            if (now - nametag.lastUpdateTime > 3000) {\n              nametag.shouldBeVisible = false;\n            }\n          }\n        } else if (this.nametagVisibility === \"showFrozen\") {\n          nametag.shouldBeVisible = this.sceneEl.is(\"frozen\");\n        } else if (this.nametagVisibility === \"showNone\") {\n          nametag.shouldBeVisible = false;\n        } else if (this.nametagVisibility === \"showClose\") {\n          if (nametag.ikRoot) {\n            nametag.ikRoot.getWorldPosition(worldPos);\n            nametag.shouldBeVisible = worldPos.sub(avatarRigWorldPos).lengthSq() < this.nametagVisibilityDistance;\n          }\n        } else {\n          nametag.shouldBeVisible = true;\n        }\n      });\n    };\n  })();\n\n  onStateChanged() {\n    this.nametagVisibilityDistance = Math.pow(this.store.state.preferences.nametagVisibilityDistance, 2);\n    this.nametagVisibility = this.store.state.preferences.nametagVisibility;\n  }\n}\n","const UNOWNED_INTERACTABLE = require(\"../constants\").COLLISION_LAYERS.UNOWNED_INTERACTABLE;\nimport { exitQuery, defineQuery, removeComponent, hasComponent, entityExists } from \"bitecs\";\nimport {\n  Held,\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  Owned,\n  Rigidbody\n} from \"../bit-components\";\n\n// TODO this seems wrong, nothing sets it back unless its a floaty object\nconst exitOwned = exitQuery(defineQuery([Owned]));\nconst componentsToRemove = [Held, HeldHandRight, HeldHandLeft, HeldRemoteRight, HeldRemoteLeft];\nconst kinematicOptions = { type: \"kinematic\", collisionFilterMask: UNOWNED_INTERACTABLE };\nexport function onOwnershipLost(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  const entities = exitOwned(world);\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    if (!entityExists(world, eid)) continue;\n    for (let j = 0; j < componentsToRemove.length; j++) {\n      const component = componentsToRemove[j];\n      removeComponent(world, component, eid);\n    }\n\n    if (hasComponent(world, Rigidbody, eid)) {\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], kinematicOptions);\n    }\n  }\n}\n","import { addComponent, defineQuery, hasComponent, removeComponent } from \"bitecs\";\nimport { HandCollisionTarget, HoveredHandLeft, HoveredHandRight, Rigidbody } from \"../bit-components\";\n\nfunction findHandCollisionTargetForHand(world, hand) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  // TODO physics system init is async so these don't get created right away.. They probably can be\n  if (!hasComponent(world, Rigidbody, hand)) return;\n\n  const handCollisions = physicsSystem.getCollisions(Rigidbody.bodyId[hand]);\n  if (handCollisions) {\n    for (let i = 0; i < handCollisions.length; i++) {\n      const bodyData = physicsSystem.bodyUuidToData.get(handCollisions[i]);\n      const object3D = bodyData && bodyData.object3D;\n      if (object3D && hasComponent(world, HandCollisionTarget, object3D.eid)) {\n        return object3D.eid;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction hoverHand(world, interactor, hoveredQuery, Component) {\n  hoveredQuery(world).forEach(eid => removeComponent(world, Component, eid));\n  const collision = findHandCollisionTargetForHand(world, interactor);\n  if (collision) addComponent(world, Component, collision);\n}\n\nconst leftHandHoveredQuery = defineQuery([HoveredHandLeft]);\nconst rightHandHoveredQuery = defineQuery([HoveredHandRight]);\nexport function handHoverSystem(world, legacyInteractionSystem) {\n  const interactorSettings = legacyInteractionSystem.options;\n  hoverHand(world, interactorSettings.leftHand.entity.object3D.eid, leftHandHoveredQuery, HoveredHandLeft);\n  hoverHand(world, interactorSettings.rightHand.entity.object3D.eid, rightHandHoveredQuery, HoveredHandRight);\n}\n","import { paths } from \"./userinput/paths\";\nimport { addComponent, removeComponent, defineQuery, hasComponent } from \"bitecs\";\nimport {\n  Held,\n  Holdable,\n  Pinned,\n  HoveredRemoteRight,\n  HeldRemoteRight,\n  HoveredRemoteLeft,\n  HeldRemoteLeft,\n  HoveredHandRight,\n  HeldHandRight,\n  HoveredHandLeft,\n  HeldHandLeft,\n  AEntity\n} from \"../bit-components\";\nimport { canMove } from \"../utils/permissions-utils\";\n\nconst GRAB_REMOTE_RIGHT = paths.actions.cursor.right.grab;\nconst DROP_REMOTE_RIGHT = paths.actions.cursor.right.drop;\nconst GRAB_REMOTE_LEFT = paths.actions.cursor.left.grab;\nconst DROP_REMOTE_LEFT = paths.actions.cursor.left.drop;\nconst GRAB_HAND_RIGHT = paths.actions.rightHand.grab;\nconst DROP_HAND_RIGHT = paths.actions.rightHand.drop;\nconst GRAB_HAND_LEFT = paths.actions.leftHand.grab;\nconst DROP_HAND_LEFT = paths.actions.leftHand.drop;\n\nfunction hasPermissionToGrab(world, eid) {\n  if (!hasComponent(world, AEntity, eid)) return true;\n  return canMove(world.eid2obj.get(eid).el);\n}\n\nfunction grab(world, userinput, queryHovered, held, grabPath) {\n  const hovered = queryHovered(world)[0];\n  if (\n    hovered &&\n    userinput.get(grabPath) &&\n    (!hasComponent(world, Pinned, hovered) || AFRAME.scenes[0].is(\"frozen\")) &&\n    hasPermissionToGrab(world, hovered)\n  ) {\n    addComponent(world, held, hovered);\n    addComponent(world, Held, hovered);\n  }\n}\n\nfunction drop(world, userinput, queryHeld, held, dropPath) {\n  const heldEid = queryHeld(world)[0];\n  if (heldEid && userinput.get(dropPath)) {\n    // TODO: Drop on ownership lost\n    removeComponent(world, held, heldEid);\n\n    if (\n      !hasComponent(world, HeldRemoteRight, heldEid) &&\n      !hasComponent(world, HeldRemoteLeft, heldEid) &&\n      !hasComponent(world, HeldHandRight, heldEid) &&\n      !hasComponent(world, HeldHandLeft, heldEid)\n    ) {\n      removeComponent(world, Held, heldEid);\n    }\n  }\n}\n\nconst queryHeldRemoteRight = defineQuery([Holdable, HeldRemoteRight]);\nconst queryHoveredRemoteRight = defineQuery([Holdable, HoveredRemoteRight]);\n\nconst queryHeldRemoteLeft = defineQuery([Holdable, HeldRemoteLeft]);\nconst queryHoveredRemoteLeft = defineQuery([Holdable, HoveredRemoteLeft]);\n\nconst queryHeldHandRight = defineQuery([Holdable, HeldHandRight]);\nconst queryHoveredHandRight = defineQuery([Holdable, HoveredHandRight]);\n\nconst queryHeldHandLeft = defineQuery([Holdable, HeldHandLeft]);\nconst queryHoveredHandLeft = defineQuery([Holdable, HoveredHandLeft]);\n\nexport function holdSystem(world, userinput) {\n  grab(world, userinput, queryHoveredRemoteRight, HeldRemoteRight, GRAB_REMOTE_RIGHT);\n  grab(world, userinput, queryHoveredRemoteLeft, HeldRemoteLeft, GRAB_REMOTE_LEFT);\n  grab(world, userinput, queryHoveredHandRight, HeldHandRight, GRAB_HAND_RIGHT);\n  grab(world, userinput, queryHoveredHandLeft, HeldHandLeft, GRAB_HAND_LEFT);\n\n  drop(world, userinput, queryHeldRemoteRight, HeldRemoteRight, DROP_REMOTE_RIGHT);\n  drop(world, userinput, queryHeldRemoteLeft, HeldRemoteLeft, DROP_REMOTE_LEFT);\n  drop(world, userinput, queryHeldHandRight, HeldHandRight, DROP_HAND_RIGHT);\n  drop(world, userinput, queryHeldHandLeft, HeldHandLeft, DROP_HAND_LEFT);\n}\n","import { defineQuery, removeComponent } from \"bitecs\";\nimport {\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredRemoteRight,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredHandLeft\n} from \"../bit-components\";\n\nfunction removeHover(world, entities, component) {\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    removeComponent(world, component, eid);\n  }\n}\n\nconst queryRemoteRight = defineQuery([HoveredRemoteRight, HeldRemoteRight]);\nconst queryRemoteLeft = defineQuery([HoveredRemoteLeft, HeldRemoteLeft]);\nconst queryHandRight = defineQuery([HoveredHandRight, HeldHandRight]);\nconst queryHandLeft = defineQuery([HoveredHandLeft, HeldHandLeft]);\nexport function dontHoverAndHold(world) {\n  removeHover(world, queryRemoteRight(world), HoveredRemoteRight);\n  removeHover(world, queryRemoteLeft(world), HoveredRemoteLeft);\n  removeHover(world, queryHandRight(world), HoveredHandRight);\n  removeHover(world, queryHandLeft(world), HoveredHandLeft);\n}\n\nconst queryDoubleHeldRight = defineQuery([HeldHandRight, HeldRemoteRight]);\nconst queryDoubleHeldLeft = defineQuery([HeldHandLeft, HeldRemoteLeft]);\nconst queryDoubleHoverRight = defineQuery([HoveredHandRight, HoveredRemoteRight]);\nconst queryDoubleHoverLeft = defineQuery([HoveredHandLeft, HoveredRemoteLeft]);\nexport function dontHoldWithHandAndRemote(world) {\n  queryDoubleHeldLeft(world).forEach(eid => removeComponent(world, HeldRemoteLeft, eid));\n  queryDoubleHeldRight(world).forEach(eid => removeComponent(world, HeldRemoteRight, eid));\n  // TODO this may not be needed because of CursorTogglingSystem\n  queryDoubleHoverLeft(world).forEach(eid => removeComponent(world, HoveredRemoteLeft, eid));\n  queryDoubleHoverRight(world).forEach(eid => removeComponent(world, HoveredRemoteRight, eid));\n}\n","import { removeNetworkedObject } from \"../utils/removeNetworkedObject\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport { defineQuery } from \"bitecs\";\nimport { Interacted, RemoveNetworkedEntityButton } from \"../bit-components\";\n\nconst query = defineQuery([RemoveNetworkedEntityButton, Interacted]);\n\nexport function removeNetworkedObjectButtonSystem(world) {\n  const ents = query(world);\n  for (let i = 0; i < ents.length; i++) {\n    const eid = ents[i];\n    const button = world.eid2obj.get(eid);\n    const networkedEntity = findAncestorWithComponent(button.el, \"networked\");\n    removeNetworkedObject(networkedEntity.sceneEl, networkedEntity);\n    button.parent.visible = false;\n  }\n}\n","import { defineQuery, exitQuery, removeEntity } from \"bitecs\";\nimport { GLTFModel, MediaFrame, Object3DTag, Slice9, Text } from \"../bit-components\";\nimport { gltfCache } from \"../components/gltf-model-plus\";\n\nfunction cleanupObjOnExit(Component, f) {\n  const query = exitQuery(defineQuery([Component]));\n  return function(world) {\n    query(world).forEach(eid => f(world.eid2obj.get(eid)));\n  };\n}\n\n// NOTE we don't dispose of slice9's textures here, its non trivial since they are shared.\n// We want to keep them loaded anyway since we only have a few and want them to load instantly.\nconst cleanupSlice9s = cleanupObjOnExit(Slice9, obj => obj.geometry.dispose());\nconst cleanupGLTFs = cleanupObjOnExit(GLTFModel, obj => gltfCache.release(obj.userData.gltfSrc));\nconst cleanupTexts = cleanupObjOnExit(Text, obj => obj.dispose());\nconst cleanupMediaFrames = cleanupObjOnExit(MediaFrame, obj => obj.geometry.dispose());\n\n// TODO This feels messy and brittle\n//\n// This makes the assumption that we will not explicitly remove Object3DTag components.\n// Instead, they will only be removed when we call removeEntity.\n//\n// When we remove an entity with an Object3DTag:\n// - The associated object3D will be removed from the scene graph.\n// - The rest of the scene graph will be left intact.\n// - We will call removeEntity for all entities associated with the object3D's descendants.\n// - The descendants won't be removed from their parents.\n//\n// TODO AFRAME entities get cleaned up in an an odd way:\n//      When we remove an AFRAME entity, AFRAME will call `removeEntity` for all of its descendants,\n//      which means we will remove each descendent from its parent.\nconst exitedObject3DQuery = exitQuery(defineQuery([Object3DTag]));\nexport function removeObject3DSystem(world) {\n  function removeFromMap(eid) {\n    const o = world.eid2obj.get(eid);\n    world.eid2obj.delete(eid);\n    o.eid = null;\n  }\n\n  // remove entities that are children of any removed entities\n  const entities = exitedObject3DQuery(world);\n  entities.forEach(eid => {\n    const obj = world.eid2obj.get(eid);\n    obj.traverse(o => o.eid && removeEntity(world, o.eid));\n    obj.removeFromParent();\n  });\n\n  // cleanup any component specific resources\n  cleanupGLTFs(world);\n  cleanupSlice9s(world);\n  cleanupTexts(world);\n  cleanupMediaFrames(world);\n\n  // Finally remove all the entities we just removed from the eid2obj map\n  entities.forEach(removeFromMap);\n  exitedObject3DQuery(world).forEach(removeFromMap);\n}\n","import { defineQuery, hasComponent } from \"bitecs\";\nimport { NetworkedTransform, Owned } from \"../bit-components\";\n\nconst query = defineQuery([NetworkedTransform]);\n\nconst tmpVec = new THREE.Vector3();\nconst tmpQuat = new THREE.Quaternion();\nexport function networkedTransformSystem(world) {\n  const ents = query(world);\n  for (let i = 0; i < ents.length; i++) {\n    const eid = ents[i];\n    const obj = world.eid2obj.get(eid);\n    if (hasComponent(world, Owned, eid)) {\n      tmpVec.fromArray(NetworkedTransform.position[eid]);\n      if (!tmpVec.near(obj.position, 0.001)) {\n        obj.position.toArray(NetworkedTransform.position[eid]);\n      }\n      tmpQuat.fromArray(NetworkedTransform.rotation[eid]);\n      // TODO does it even make sense to check \"near\" in this way?\n      if (!tmpQuat.near(obj.quaternion, 0.001)) {\n        obj.quaternion.toArray(NetworkedTransform.rotation[eid]);\n      }\n      tmpVec.fromArray(NetworkedTransform.scale[eid]);\n      if (!tmpVec.near(obj.scale, 0.001)) {\n        obj.scale.toArray(NetworkedTransform.scale[eid]);\n      }\n    } else {\n      tmpVec.fromArray(NetworkedTransform.position[eid]);\n      if (!tmpVec.near(obj.position)) {\n        obj.position.copy(tmpVec);\n        obj.matrixNeedsUpdate = true;\n      }\n\n      tmpQuat.fromArray(NetworkedTransform.rotation[eid]);\n      if (!tmpQuat.near(obj.quaternion)) {\n        obj.quaternion.copy(tmpQuat);\n        obj.matrixNeedsUpdate = true;\n      }\n\n      tmpVec.fromArray(NetworkedTransform.scale[eid]);\n      if (!tmpVec.near(obj.scale)) {\n        obj.scale.copy(tmpVec);\n        obj.matrixNeedsUpdate = true;\n      }\n    }\n  }\n}\n\n// TODO lerping\n","import { anyEntityWith } from \"../utils/bit-utils\";\nimport { CONSTANTS } from \"three-ammo\";\nconst { DISABLE_DEACTIVATION, ACTIVE_TAG } = CONSTANTS.ACTIVATION_STATE;\n\nimport { defineQuery, enterQuery, entityExists, exitQuery, hasComponent } from \"bitecs\";\nimport {\n  RemoteRight,\n  RemoteLeft,\n  HandRight,\n  HandLeft,\n  HeldRemoteRight,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldHandLeft,\n  OffersHandConstraint,\n  OffersRemoteConstraint,\n  Rigidbody\n} from \"../bit-components\";\nimport { takeOwnership } from \"./netcode\";\n\nconst queryRemoteRight = defineQuery([HeldRemoteRight, OffersRemoteConstraint, Rigidbody]);\nconst queryEnterRemoteRight = enterQuery(queryRemoteRight);\nconst queryExitRemoteRight = exitQuery(queryRemoteRight);\n\nconst queryRemoteLeft = defineQuery([HeldRemoteLeft, OffersRemoteConstraint, Rigidbody]);\nconst queryEnterRemoteLeft = enterQuery(queryRemoteLeft);\nconst queryExitRemoteLeft = exitQuery(queryRemoteLeft);\n\nconst queryHandRight = defineQuery([HeldHandRight, OffersHandConstraint, Rigidbody]);\nconst queryEnterHandRight = enterQuery(queryHandRight);\nconst queryExitHandRight = exitQuery(queryHandRight);\n\nconst queryHandLeft = defineQuery([HeldHandLeft, OffersHandConstraint, Rigidbody]);\nconst queryEnterHandLeft = enterQuery(queryHandLeft);\nconst queryExitHandLeft = exitQuery(queryHandLeft);\n\nconst grabBodyOptions = { type: \"dynamic\", activationState: DISABLE_DEACTIVATION };\nconst releaseBodyOptions = { activationState: ACTIVE_TAG };\n\nfunction add(world, physicsSystem, interactor, entities) {\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    takeOwnership(world, eid);\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], grabBodyOptions);\n    physicsSystem.addConstraint(interactor, Rigidbody.bodyId[eid], Rigidbody.bodyId[interactor], {});\n  }\n}\n\nfunction remove(world, offersConstraint, physicsSystem, interactor, entities) {\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    if (!entityExists(world, eid)) continue;\n    if (hasComponent(world, offersConstraint, eid) && hasComponent(world, Rigidbody, eid)) {\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], releaseBodyOptions);\n      physicsSystem.removeConstraint(interactor);\n    }\n  }\n}\n\nexport function constraintsSystem(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  add(world, physicsSystem, anyEntityWith(world, RemoteRight), queryEnterRemoteRight(world));\n  add(world, physicsSystem, anyEntityWith(world, RemoteLeft), queryEnterRemoteLeft(world));\n  add(world, physicsSystem, anyEntityWith(world, HandRight), queryEnterHandRight(world));\n  add(world, physicsSystem, anyEntityWith(world, HandLeft), queryEnterHandLeft(world));\n  remove(world, OffersRemoteConstraint, physicsSystem, anyEntityWith(world, RemoteRight), queryExitRemoteRight(world));\n  remove(world, OffersRemoteConstraint, physicsSystem, anyEntityWith(world, RemoteLeft), queryExitRemoteLeft(world));\n  remove(world, OffersHandConstraint, physicsSystem, anyEntityWith(world, HandRight), queryExitHandRight(world));\n  remove(world, OffersHandConstraint, physicsSystem, anyEntityWith(world, HandLeft), queryExitHandLeft(world));\n}\n","// https://dev.reticulum.io/scenes/7vGnzkM/outdoor-meetup\n// A scene with media-frames\n\nimport { addEntity, defineQuery, entityExists, hasComponent, removeEntity } from \"bitecs\";\nimport {\n  AEntity,\n  Held,\n  MediaFrame,\n  MediaLoading,\n  Networked,\n  NetworkedMediaFrame,\n  Owned,\n  Rigidbody\n} from \"../bit-components\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\nimport { updateMaterials } from \"../utils/material-utils\";\nimport { MediaType } from \"../utils/media-utils\";\nimport { cloneObject3D, setMatrixWorld } from \"../utils/three-utils\";\nimport { takeOwnership } from \"./netcode\";\n\nconst EMPTY_COLOR = 0x6fc0fd;\nconst HOVER_COLOR = 0x2f80ed;\nconst FULL_COLOR = 0x808080;\n\nconst mediaFramesQuery = defineQuery([MediaFrame]);\n\n// TODO currently only aframe entiteis can be placed in media frames\nfunction mediaTypeMaskFor(world, eid) {\n  if (!hasComponent(world, AEntity, eid)) return 0;\n\n  const el = world.eid2obj.get(eid).el;\n  let mediaTypeMask = 0;\n  mediaTypeMask |= el.components[\"gltf-model-plus\"] && MediaType.MODEL;\n  mediaTypeMask |= el.components[\"media-video\"] && MediaType.VIDEO;\n  mediaTypeMask |= el.components[\"media-image\"] && MediaType.IMAGE;\n  mediaTypeMask |= el.components[\"media-pdf\"] && MediaType.PDF;\n  return mediaTypeMask;\n}\n\nfunction isAncestor(a, b) {\n  let ancestor = b.parent;\n  while (ancestor) {\n    if (ancestor === a) return true;\n    ancestor = ancestor.parent;\n  }\n  return false;\n}\n\nfunction inOtherFrame(world, ignoredFrame, eid) {\n  const frames = mediaFramesQuery(world);\n  for (const frame of frames) {\n    if (frame === ignoredFrame) continue;\n    if (MediaFrame.capturedNid[frame] === Networked.id[eid] || MediaFrame.previewingNid[frame] === Networked.id[eid])\n      return true;\n  }\n  return false;\n}\n\nfunction getCapturableEntity(world, frame) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  const collisions = physicsSystem.getCollisions(Rigidbody.bodyId[frame]);\n  const frameObj = world.eid2obj.get(frame);\n  for (let i = 0; i < collisions.length; i++) {\n    const bodyData = physicsSystem.bodyUuidToData.get(collisions[i]);\n    const eid = bodyData.object3D.eid;\n    if (\n      MediaFrame.mediaType[frame] & mediaTypeMaskFor(world, eid) &&\n      !hasComponent(world, MediaLoading, eid) &&\n      !inOtherFrame(world, frame, eid) &&\n      !isAncestor(bodyData.object3D, frameObj)\n    ) {\n      return eid;\n    }\n  }\n  return null;\n}\n\nfunction isColliding(world, eidA, eidB) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  const collisions = physicsSystem.getCollisions(Rigidbody.bodyId[eidA]);\n  for (let i = 0; i < collisions.length; i++) {\n    const bodyData = physicsSystem.bodyUuidToData.get(collisions[i]);\n    const collidedEid = bodyData && bodyData.object3D && bodyData.object3D.eid;\n    if (collidedEid === eidB) {\n      return true;\n    }\n  }\n  return false;\n}\n\nconst snapToFrame = (() => {\n  const framePos = new THREE.Vector3();\n  const frameQuat = new THREE.Quaternion();\n  const frameScale = new THREE.Vector3();\n  const m4 = new THREE.Matrix4();\n\n  function scaleForAspectFit(containerSize, itemSize) {\n    return Math.min(containerSize[0] / itemSize.x, containerSize[1] / itemSize.y, containerSize[2] / itemSize.z);\n  }\n\n  return function snapToFrame(world, frame, target) {\n    const frameObj = world.eid2obj.get(frame);\n    const targetObj = world.eid2obj.get(target);\n\n    frameObj.updateMatrices();\n    frameObj.matrixWorld.decompose(framePos, frameQuat, frameScale);\n\n    // TODO we only allow capturing media-loader so rely on its bounds calculations for now\n    const contentBounds = targetObj.el.components[\"media-loader\"].contentBounds;\n\n    setMatrixWorld(\n      targetObj,\n      m4.compose(\n        framePos,\n        frameQuat,\n        frameScale.multiplyScalar(scaleForAspectFit(MediaFrame.bounds[frame], contentBounds))\n      )\n    );\n  };\n})();\n\nfunction setMatrixScale(obj, scaleArray) {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n  const scale = new THREE.Vector3();\n  const m4 = new THREE.Matrix4();\n  obj.updateMatrices();\n  obj.matrixWorld.decompose(position, quaternion, scale);\n  setMatrixWorld(\n    obj,\n    m4.compose(\n      position,\n      quaternion,\n      scale.fromArray(scaleArray)\n    )\n  );\n}\n\nfunction cloneForPreview(world, eid) {\n  // TODO We assume capturable object is an AFRAME entity\n  const el = world.eid2obj.get(eid).el;\n  const mesh = el.getObject3D(\"mesh\");\n  const meshClone = cloneObject3D(mesh, false);\n  meshClone.traverse(node => {\n    updateMaterials(node, function(srcMat) {\n      const mat = srcMat.clone();\n      mat.transparent = true;\n      mat.opacity = 0.5;\n      mat.format = THREE.RGBAFormat;\n      mat.blending = THREE.NormalBlending;\n      node.material = mat;\n      return mat;\n    });\n  });\n\n  // TODO play animations on previews\n\n  // TODO HACK We add this mesh to a group whose position is centered\n  //      so that putting this in the middle of a media frame is easy,\n  //      but we should just do this math when putting an object into a frame\n  //      and not assume an object's root is in the center of its geometry.\n  meshClone.position.setScalar(0);\n  meshClone.quaternion.identity();\n  meshClone.matrixNeedsUpdate = true;\n  const aabb = new THREE.Box3().setFromObject(meshClone);\n  aabb.getCenter(meshClone.position).multiplyScalar(-1);\n  meshClone.matrixNeedsUpdate = true;\n\n  const cloneObj = new THREE.Group();\n  cloneObj.el = el; // We rely on media-loader component for bounds\n  cloneObj.add(meshClone);\n  AFRAME.scenes[0].object3D.add(cloneObj);\n\n  return addObject3DComponent(world, addEntity(world), cloneObj);\n}\n\nfunction showPreview(world, frame, capturable) {\n  const clone = cloneForPreview(world, capturable);\n  MediaFrame.preview[frame] = clone;\n  MediaFrame.previewingNid[frame] = Networked.id[capturable];\n  snapToFrame(world, frame, clone);\n}\n\nfunction hidePreview(world, frame) {\n  // NOTE we intentionally do not dispose of geometries or textures since they are all shared with the original object\n  removeEntity(world, MediaFrame.preview[frame]);\n  MediaFrame.preview[frame] = 0;\n  MediaFrame.previewingNid[frame] = 0;\n}\n\nconst zero = [0, 0, 0];\nconst tmpVec3 = new THREE.Vector3();\n\nexport function display(world, frame, heldMediaTypes) {\n  const capturable = !MediaFrame.capturedNid[frame] && getCapturableEntity(world, frame);\n  const shouldPreviewBeVisible = capturable && hasComponent(world, Held, capturable);\n  if (shouldPreviewBeVisible && !MediaFrame.preview[frame]) {\n    showPreview(world, frame, capturable);\n  } else if (!shouldPreviewBeVisible && MediaFrame.preview[frame]) {\n    hidePreview(world, frame);\n  }\n\n  const frameObj = world.eid2obj.get(frame);\n  frameObj.visible = !!(MediaFrame.mediaType[frame] & heldMediaTypes);\n\n  if (frameObj.visible) {\n    const captured = world.nid2eid.get(MediaFrame.capturedNid[frame]) || 0;\n    const isHoldingObjectOfInterest =\n      (captured && hasComponent(world, Held, captured)) || (capturable && hasComponent(world, Held, capturable));\n\n    frameObj.material.uniforms.color.value.set(\n      isHoldingObjectOfInterest ? HOVER_COLOR : MediaFrame.capturedNid[frame] ? FULL_COLOR : EMPTY_COLOR\n    );\n  }\n}\n\nfunction mediaTypesOf(world, entities) {\n  let mask = 0;\n  for (let i = 0; i < entities.length; i++) {\n    mask |= mediaTypeMaskFor(world, entities[i]);\n  }\n  return mask;\n}\n\nconst heldQuery = defineQuery([Held]);\n// const droppedQuery = exitQuery(heldQuery);\nexport function mediaFramesSystem(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  const heldMediaTypes = mediaTypesOf(world, heldQuery(world));\n  // const droppedEntities = droppedQuery(world).filter(eid => entityExists(world, eid));\n  const mediaFrames = mediaFramesQuery(world);\n\n  for (let i = 0; i < mediaFrames.length; i++) {\n    const frame = mediaFrames[i];\n\n    const captured = world.nid2eid.get(MediaFrame.capturedNid[frame]) || 0;\n    const colliding = captured && isColliding(world, frame, captured);\n\n    if (captured && hasComponent(world, Owned, captured) && !hasComponent(world, Held, captured) && colliding) {\n      snapToFrame(world, frame, captured);\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[captured], { type: \"kinematic\" });\n    } else if (\n      (hasComponent(world, Owned, frame) &&\n        MediaFrame.capturedNid[frame] &&\n        world.deletedNids.has(MediaFrame.capturedNid[frame])) ||\n      (captured && hasComponent(world, Owned, captured) && !colliding)\n    ) {\n      takeOwnership(world, frame);\n      NetworkedMediaFrame.capturedNid[frame] = 0;\n      NetworkedMediaFrame.scale[frame].set(zero);\n      // TODO BUG: If an entity I do not own is captured by the media frame,\n      //           and then I take ownership of the entity (by grabbing it),\n      //           the physics system does not immediately notice the entity colliding with the frame,\n      //           so I immediately think the frame should be emptied.\n    } else if (!NetworkedMediaFrame.capturedNid[frame]) {\n      const capturable = getCapturableEntity(world, frame);\n      if (\n        capturable &&\n        hasComponent(world, Owned, capturable) &&\n        !hasComponent(world, Held, capturable) &&\n        !inOtherFrame(world, frame, capturable)\n      ) {\n        takeOwnership(world, frame);\n        NetworkedMediaFrame.capturedNid[frame] = Networked.id[capturable];\n        const obj = world.eid2obj.get(capturable);\n        obj.updateMatrices();\n        tmpVec3.setFromMatrixScale(obj.matrixWorld).toArray(NetworkedMediaFrame.scale[frame]);\n        snapToFrame(world, frame, capturable);\n        physicsSystem.updateBodyOptions(Rigidbody.bodyId[capturable], { type: \"kinematic\" });\n      }\n    }\n\n    if (\n      NetworkedMediaFrame.capturedNid[frame] !== MediaFrame.capturedNid[frame] &&\n      (captured && entityExists(world, captured) && hasComponent(world, Owned, captured))\n    ) {\n      // TODO: If you are resetting scale because you lost a race for the frame,\n      //       you should probably also move the object away from the frame.\n      setMatrixScale(world.eid2obj.get(captured), MediaFrame.scale[frame]);\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[captured], { type: \"dynamic\" });\n    }\n\n    MediaFrame.capturedNid[frame] = NetworkedMediaFrame.capturedNid[frame];\n    MediaFrame.scale[frame].set(NetworkedMediaFrame.scale[frame]);\n\n    display(world, frame, heldMediaTypes);\n  }\n}\n","const { detect } = require(\"detect-browser\");\nconst browser = detect();\n\nconst isFirefox = browser.name === \"firefox\";\n\nconst supportsCaptureStreamTrack = typeof window.CanvasCaptureMediaStreamTrack !== \"undefined\";\n\nfunction blitFramebuffer(renderer, src, srcX0, srcY0, srcX1, srcY1, dest, dstX0, dstY0, dstX1, dstY1) {\n  const gl = renderer.getContext();\n\n  // Copies from one framebuffer to another. Note that at the end of this function, you need to restore\n  // the original framebuffer via setRenderTarget\n  const srcFramebuffer = renderer.properties.get(src).__webglFramebuffer;\n  const destFramebuffer = renderer.properties.get(dest).__webglFramebuffer;\n\n  if (srcFramebuffer && destFramebuffer) {\n    gl.bindFramebuffer(gl.READ_FRAMEBUFFER, srcFramebuffer);\n    gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, destFramebuffer);\n\n    if (gl.checkFramebufferStatus(gl.READ_FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n      gl.blitFramebuffer(srcX0, srcY0, srcX1, srcY1, dstX0, dstY0, dstX1, dstY1, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n    }\n  }\n}\nconst createBlankAudioTrack = () => {\n  const context = THREE.AudioContext.getContext();\n  const oscillator = context.createOscillator();\n  const gain = context.createGain();\n  const destination = context.createMediaStreamDestination();\n  gain.gain.setValueAtTime(0.0001, context.currentTime);\n  oscillator.connect(destination);\n  gain.connect(destination);\n  return destination.stream.getAudioTracks()[0];\n};\n\nexport class RenderTargetRecorder {\n  constructor(renderer, mimeType, captureWidth, captureHeight, fps, srcAudioTrack) {\n    this.renderer = renderer;\n\n    // Create a separate render target for video because we need to flip (and sometimes downscale) it before\n    // encoding it to video.\n    this.videoRenderTarget = new THREE.WebGLRenderTarget(captureWidth, captureHeight, {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n\n    const tmpRenderTarget = renderer.getRenderTarget();\n    // Used to set up framebuffer in three.js as a side effect\n    renderer.setRenderTarget(this.videoRenderTarget);\n    renderer.setRenderTarget(tmpRenderTarget);\n\n    const videoCanvas = document.createElement(\"canvas\");\n    videoCanvas.width = this.videoRenderTarget.width;\n    videoCanvas.height = this.videoRenderTarget.height;\n\n    this.videoContext = videoCanvas.getContext(\"2d\");\n    this.videoImageData = this.videoContext.createImageData(\n      this.videoRenderTarget.width,\n      this.videoRenderTarget.height\n    );\n    // this.videoPixels = new Uint8Array(captureWidth * captureHeight * 4);\n    // this.videoImageData.data.set(this.videoPixels);\n\n    const stream = videoCanvas.captureStream(supportsCaptureStreamTrack ? 0 : fps);\n    this.videoTrack = stream.getVideoTracks()[0];\n\n    if (srcAudioTrack) {\n      stream.addTrack(srcAudioTrack);\n    } else if (isFirefox) {\n      // FF 73+ seems to fail to decode videos with no audio track, so we always include a silent track.\n      // Chrome has issues when the audio tracks are silent so we only do this for FF.\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=1223382\n      stream.addTrack(createBlankAudioTrack());\n    }\n\n    this.mediaRecorder = new MediaRecorder(stream, { mimeType });\n  }\n\n  start() {\n    this.chunks = [];\n    this.mediaRecorder.ondataavailable = e => this.chunks.push(e.data);\n    this.mediaRecorder.start();\n  }\n\n  captureFrame(srcRenderTarget) {\n    blitFramebuffer(\n      this.renderer,\n      srcRenderTarget,\n      0,\n      0,\n      srcRenderTarget.width,\n      srcRenderTarget.height,\n      this.videoRenderTarget,\n      0,\n      this.videoRenderTarget.height,\n      this.videoRenderTarget.width,\n      0\n    );\n    this.renderer.readRenderTargetPixels(\n      this.videoRenderTarget,\n      0,\n      0,\n      this.videoRenderTarget.width,\n      this.videoRenderTarget.height,\n      this.videoImageData.data\n    );\n    // this.videoImageData.data.set(this.videoPixels);\n    this.videoContext.putImageData(this.videoImageData, 0, 0);\n    if (supportsCaptureStreamTrack) {\n      this.videoTrack.requestFrame();\n    }\n  }\n\n  save() {\n    return new Promise(resolve => {\n      this.mediaRecorder.onstop = () => {\n        const chunks = this.chunks;\n        if (chunks.length === 0) resolve(null);\n        const mimeType = chunks[0].type;\n        const blob = new Blob(chunks, { type: mimeType });\n        const file = new File([blob], \"capture\", { type: mimeType.split(\";\")[0] }); // Drop codec\n        chunks.length = 0;\n        resolve(file);\n      };\n      this.mediaRecorder.stop();\n    });\n  }\n\n  cancel() {\n    this.mediaRecorder.ondataavailable = null;\n    this.mediaRecorder.stop();\n    this.chunks.length = 0;\n  }\n}\n\nexport async function pixelsToPNG(pixels, width, height) {\n  const snapCanvas = document.createElement(\"canvas\");\n  snapCanvas.width = width;\n  snapCanvas.height = height;\n  const context = snapCanvas.getContext(\"2d\");\n\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(pixels);\n  const bitmap = await createImageBitmap(imageData);\n  context.scale(1, -1);\n  context.drawImage(bitmap, 0, -height);\n  const blob = await new Promise(resolve => snapCanvas.toBlob(resolve));\n  return new File([blob], \"snap.png\", { type: \"image/png\" });\n}\n","import { defineQuery, enterQuery, entityExists, exitQuery, hasComponent } from \"bitecs\";\nimport {\n  CameraTool,\n  Held,\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredRemoteRight,\n  Interacted,\n  RemoteRight,\n  Rigidbody,\n  TextButton\n} from \"../bit-components\";\nimport { addMedia } from \"../utils/media-utils\";\nimport { pixelsToPNG, RenderTargetRecorder } from \"../utils/render-target-recorder\";\nimport { isFacingCamera } from \"../utils/three-utils\";\nimport { SOUND_CAMERA_TOOL_COUNTDOWN, SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { ObjectTypes } from \"../object-types\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\n\n// Prefer h264 if available due to faster decoding speec on most platforms\nconst videoCodec = [\"h264\", \"vp9,opus\", \"vp8,opus\", \"vp9\", \"vp8\"].find(\n  codec => window.MediaRecorder && MediaRecorder.isTypeSupported(`video/webm; codecs=${codec}`)\n);\nconst videoMimeType = videoCodec ? `video/webm; codecs=${videoCodec}` : null;\nconst hasWebGL2 = !!document.createElement(\"canvas\").getContext(\"webgl2\");\nconst allowVideo = !!videoMimeType && hasWebGL2;\n\nconst RENDER_WIDTH = 1280;\nconst RENDER_HEIGHT = 720;\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isOculusBrowser = navigator.userAgent.match(/Oculus/);\n// TODO ported from old camera system. Do we still want these restrictions?\nconst CAPTURE_WIDTH = isMobileVR && !isOculusBrowser ? 640 : 1280;\nconst CAPTURE_HEIGHT = isMobileVR && !isOculusBrowser ? 360 : 720;\n\nconst VIDEO_FPS = 25;\nconst VIEWFINDER_UPDATE_RATE = 1000 / 6;\nconst VIDEO_UPDATE_RATE = 1000 / VIDEO_FPS;\n\nconst CAMERA_STATE = {\n  IDLE: 0,\n  COUNTDOWN_PHOTO: 1,\n  COUNTDOWN_VIDEO: 2,\n  SNAP_PHOTO: 3,\n  RECORDING_VIDEO: 4\n};\n\nconst CAPTURE_DURATIONS = [3, 7, 15, 30, 60];\n\nconst renderTargets = new Map();\nconst videoRecorders = new Map();\nlet captureAudio = false;\n\nconst tmpVec3 = new THREE.Vector3();\n\nfunction clicked(eid) {\n  return hasComponent(APP.world, Interacted, eid);\n}\n\nfunction grabberPressedSnapAction(world, camera) {\n  const userinput = AFRAME.scenes[0].systems.userinput;\n  return (\n    (hasComponent(world, HeldRemoteLeft, camera) && userinput.get(paths.actions.cursor.left.takeSnapshot)) ||\n    (hasComponent(world, HeldRemoteRight, camera) && userinput.get(paths.actions.cursor.right.takeSnapshot)) ||\n    (hasComponent(world, HeldHandLeft, camera) && userinput.get(paths.actions.leftHand.takeSnapshot)) ||\n    (hasComponent(world, HeldHandRight, camera) && userinput.get(paths.actions.rightHand.takeSnapshot))\n    // userinput.get(paths.actions.takeSnapshot)\n  );\n}\n\nfunction spawnCameraFile(cameraObj, file, type) {\n  const opts = type === \"video\" ? { videoPaused: true } : {};\n  const { entity } = addMedia(file, \"#interactable-media\", undefined, `${type}-camera`, false, false, true, opts);\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      AFRAME.scenes[0].systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n      // TODO animate and orient around camera\n      entity.object3D.position.copy(cameraObj.localToWorld(new THREE.Vector3(0, -0.5, 0)));\n      entity.object3D.quaternion.copy(cameraObj.quaternion);\n      entity.object3D.matrixNeedsUpdate = true;\n      APP.hubChannel.sendMessage({ src: entity.components[\"media-loader\"].data.src }, type);\n      APP.hubChannel.sendObjectSpawnedEvent(ObjectTypes.CAMERA);\n    },\n    { once: true }\n  );\n}\n\nfunction createRecorder(captureAudio) {\n  let srcAudioTrack;\n  // NOTE: if we don't have a self audio track, we can end up generating an empty video (browser bug?)\n  // if no audio comes through on the listener source. (Eg the room is otherwise silent.)\n  // So for now, if we don't have a track, just disable audio capture.\n  if (captureAudio && APP.dialog._micProducer?.track) {\n    const context = THREE.AudioContext.getContext();\n    const destination = context.createMediaStreamDestination();\n    if (APP.audioListener) {\n      // NOTE audio is not captured from camera vantage point for now.\n      APP.audioListener.getInput().connect(destination);\n    }\n    context.createMediaStreamSource(new MediaStream([APP.dialog._micProducer?.track])).connect(destination);\n    srcAudioTrack = destination.stream.getAudioTracks()[0];\n  }\n\n  return new RenderTargetRecorder(\n    AFRAME.scenes[0].renderer,\n    videoMimeType,\n    CAPTURE_WIDTH,\n    CAPTURE_HEIGHT,\n    VIDEO_FPS,\n    srcAudioTrack\n  );\n}\n\nfunction endRecording(world, camera, cancel) {\n  const recorder = videoRecorders.get(camera);\n  if (cancel) {\n    recorder.cancel();\n  } else {\n    recorder.save().then(file => {\n      spawnCameraFile(world.eid2obj.get(camera), file, \"video\");\n    });\n  }\n  videoRecorders.delete(camera);\n  APP.hubChannel.endRecording();\n}\n\nfunction updateRenderTarget(world, camera) {\n  const sceneEl = AFRAME.scenes[0];\n  const renderer = AFRAME.scenes[0].renderer;\n\n  const tmpVRFlag = renderer.xr.enabled;\n  renderer.xr.enabled = false;\n\n  // TODO we are doing this because aframe uses this hook for tock.\n  // Namely to capture what camera was rendering. We don't actually use that in any of our tocks.\n  // Also tock can likely go away as a concept since we can just direclty order things after render in raf if we want to.\n  const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\n  delete sceneEl.object3D.onAfterRender;\n\n  // TODO this assumption is now not true since we are not running after render. We should probably just permentently turn of autoUpdate and run matrix updates at a point we wnat to.\n  // The entire scene graph matrices should already be updated\n  // in tick(). They don't need to be recomputed again in tock().\n  const tmpAutoUpdate = sceneEl.object3D.autoUpdate;\n  sceneEl.object3D.autoUpdate = false;\n\n  const bubbleSystem = AFRAME.scenes[0].systems[\"personal-space-bubble\"];\n  const boneVisibilitySystem = AFRAME.scenes[0].systems[\"hubs-systems\"].boneVisibilitySystem;\n\n  if (bubbleSystem) {\n    for (let i = 0, l = bubbleSystem.invaders.length; i < l; i++) {\n      bubbleSystem.invaders[i].disable();\n    }\n    // HACK, bone visibility typically takes a tick to update, but since we want to be able\n    // to have enable() and disable() be reflected this frame, we need to do it immediately.\n    boneVisibilitySystem.tick();\n    // scene.autoUpdate will be false so explicitly update the world matrices\n    boneVisibilitySystem.updateMatrices();\n  }\n\n  const renderTarget = renderTargets.get(camera);\n  renderTarget.needsUpdate = false;\n  renderTarget.lastUpdated = world.time.elapsed;\n\n  const tmpRenderTarget = renderer.getRenderTarget();\n  renderer.setRenderTarget(renderTarget);\n  renderer.render(sceneEl.object3D, world.eid2obj.get(CameraTool.cameraRef[camera]));\n  renderer.setRenderTarget(tmpRenderTarget);\n\n  renderer.xr.enabled = tmpVRFlag;\n  sceneEl.object3D.onAfterRender = tmpOnAfterRender;\n  sceneEl.object3D.autoUpdate = tmpAutoUpdate;\n\n  if (bubbleSystem) {\n    for (let i = 0, l = bubbleSystem.invaders.length; i < l; i++) {\n      bubbleSystem.invaders[i].enable();\n    }\n    // HACK, bone visibility typically takes a tick to update, but since we want to be able\n    // to have enable() and disable() be reflected this frame, we need to do it immediately.\n    boneVisibilitySystem.tick();\n    boneVisibilitySystem.updateMatrices();\n  }\n}\n\nfunction updateUI(world, camera) {\n  const snapMenuObj = world.eid2obj.get(CameraTool.snapMenuRef[camera]);\n  const snapBtnObj = world.eid2obj.get(CameraTool.snapRef[camera]);\n  const recBtnObj = world.eid2obj.get(CameraTool.recVideoRef[camera]);\n  const cancelBtnObj = world.eid2obj.get(CameraTool.cancelRef[camera]);\n  const nextBtnObj = world.eid2obj.get(CameraTool.button_next[camera]);\n  const prevBtnObj = world.eid2obj.get(CameraTool.button_prev[camera]);\n  const countdownLblObj = world.eid2obj.get(CameraTool.countdownLblRef[camera]);\n  const captureDurLblObj = world.eid2obj.get(CameraTool.captureDurLblRef[camera]);\n  const screenObj = world.eid2obj.get(CameraTool.screenRef[camera]);\n  const selfieScreenObj = world.eid2obj.get(CameraTool.selfieScreenRef[camera]);\n\n  const sndToggleBtnObj = world.eid2obj.get(CameraTool.sndToggleRef[camera]);\n  const sndToggleLblObj = world.eid2obj.get(TextButton.labelRef[CameraTool.sndToggleRef[camera]]);\n\n  const isIdle = CameraTool.state[camera] === CAMERA_STATE.IDLE;\n  const isCounting =\n    CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_PHOTO ||\n    CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_VIDEO ||\n    CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO;\n\n  const inVR = AFRAME.scenes[0].is(\"vr-mode\");\n  const showViewfinder = !inVR || (hasComponent(world, Held, camera) || !isIdle);\n  screenObj.visible = showViewfinder;\n  selfieScreenObj.visible = showViewfinder;\n\n  const playerInFrontOfCamera = isFacingCamera(world.eid2obj.get(camera));\n\n  const yRot = playerInFrontOfCamera ? 0 : Math.PI;\n  if (snapMenuObj.rotation.y !== yRot) {\n    snapMenuObj.rotation.y = yRot;\n    snapMenuObj.matrixNeedsUpdate = true;\n  }\n\n  snapBtnObj.visible = isIdle;\n\n  recBtnObj.visible = allowVideo && isIdle;\n  captureDurLblObj.visible = allowVideo && isIdle;\n  nextBtnObj.visible = allowVideo && isIdle;\n  prevBtnObj.visible = allowVideo && isIdle;\n  sndToggleBtnObj.visible = allowVideo && isIdle;\n\n  cancelBtnObj.visible = isCounting;\n  countdownLblObj.visible = isCounting;\n\n  if (countdownLblObj.visible) {\n    const timeLeftSec = Math.ceil((CameraTool.snapTime[camera] - world.time.elapsed) / 1000);\n    countdownLblObj.text = timeLeftSec;\n    countdownLblObj.sync(); // TODO this should probably happen in 1 spot per frame for all Texts\n  }\n\n  if (captureDurLblObj.visible) {\n    captureDurLblObj.text = CAPTURE_DURATIONS[CameraTool.captureDurIdx[camera]];\n    captureDurLblObj.sync(); // TODO this should probably happen in 1 spot per frame for all Texts\n  }\n\n  if (sndToggleBtnObj.visible) {\n    sndToggleLblObj.text = captureAudio ? \"Sound ON\" : \"Sound OFF\";\n    sndToggleLblObj.sync();\n  }\n\n  // TODO HACK hidden objects are still not having their matricies updated correctly\n  // Seems like a regression of #5421\n  snapMenuObj.matrixNeedsUpdate = true;\n}\n\nlet snapPixels;\nfunction captureSnapshot(world, camera) {\n  if (!snapPixels) {\n    snapPixels = new Uint8Array(RENDER_WIDTH * RENDER_HEIGHT * 4);\n  }\n  const renderer = AFRAME.scenes[0].renderer;\n  renderer.readRenderTargetPixels(renderTargets.get(camera), 0, 0, RENDER_WIDTH, RENDER_HEIGHT, snapPixels);\n  pixelsToPNG(snapPixels, RENDER_WIDTH, RENDER_HEIGHT).then(file => {\n    spawnCameraFile(world.eid2obj.get(camera), file, \"photo\");\n  });\n}\n\n// TODO this should be its own thing, not hardcoded to camera tools or mouse bindings\nfunction rotateWithRightClick(world, camera) {\n  const userinput = AFRAME.scenes[0].systems.userinput;\n  const transformSystem = AFRAME.scenes[0].systems[\"transform-selected-object\"];\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  if (\n    !transformSystem.transforming &&\n    hasComponent(world, HoveredRemoteRight, camera) &&\n    userinput.get(paths.device.mouse.buttonRight)\n  ) {\n    const rightCursor = anyEntityWith(world, RemoteRight);\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[camera], { type: \"kinematic\" });\n    transformSystem.startTransform(world.eid2obj.get(camera), world.eid2obj.get(rightCursor), {\n      mode: \"cursor\"\n    });\n  } else if (transformSystem.target?.eid === camera && !userinput.get(paths.device.mouse.buttonRight)) {\n    transformSystem.stopTransform();\n  }\n}\n\nconst cameraToolQuery = defineQuery([CameraTool]);\nconst cameraToolEnterQuery = enterQuery(cameraToolQuery);\nconst cameraToolExitQuery = exitQuery(cameraToolQuery);\n\nexport function cameraToolSystem(world) {\n  cameraToolEnterQuery(world).forEach(function(eid) {\n    const renderTarget = new THREE.WebGLRenderTarget(RENDER_WIDTH, RENDER_HEIGHT, {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n    renderTarget.lastUpdated = 0;\n    renderTarget.needsUpdate = true;\n\n    // Only update the renderTarget when the screens are in view\n    function setRendertargetDirty() {\n      renderTarget.needsUpdate = true;\n    }\n\n    const screenObj = world.eid2obj.get(CameraTool.screenRef[eid]);\n    screenObj.material.map = renderTarget.texture;\n    screenObj.onBeforeRender = setRendertargetDirty;\n\n    const selfieScreenObj = world.eid2obj.get(CameraTool.selfieScreenRef[eid]);\n    selfieScreenObj.material.map = renderTarget.texture;\n    selfieScreenObj.onBeforeRender = setRendertargetDirty;\n\n    renderTargets.set(eid, renderTarget);\n  });\n\n  cameraToolExitQuery(world).forEach(function(eid) {\n    const renderTarget = renderTargets.get(eid);\n    renderTarget.dispose();\n    renderTargets.delete(eid);\n\n    const screenObj = world.eid2obj.get(CameraTool.screenRef[eid]);\n    screenObj.geometry.dispose();\n    screenObj.material.dispose();\n  });\n\n  cameraToolQuery(world).forEach((camera, i, allCameras) => {\n    rotateWithRightClick(world, camera);\n\n    if (CameraTool.trackTarget[camera]) {\n      if (entityExists(world, CameraTool.trackTarget[camera])) {\n        world.eid2obj.get(CameraTool.trackTarget[camera]).getWorldPosition(tmpVec3);\n        world.eid2obj.get(camera).lookAt(tmpVec3);\n      } else {\n        CameraTool.trackTarget[camera] = 0;\n      }\n    }\n\n    if (CameraTool.state[camera] === CAMERA_STATE.IDLE) {\n      if (clicked(CameraTool.snapRef[camera]) || grabberPressedSnapAction(world, camera)) {\n        CameraTool.state[camera] = CAMERA_STATE.COUNTDOWN_PHOTO;\n        CameraTool.snapTime[camera] = world.time.elapsed + 3000;\n      }\n\n      if (clicked(CameraTool.recVideoRef[camera])) {\n        CameraTool.state[camera] = CAMERA_STATE.COUNTDOWN_VIDEO;\n        CameraTool.snapTime[camera] = world.time.elapsed + 3000;\n      }\n\n      if (clicked(CameraTool.button_next[camera])) {\n        CameraTool.captureDurIdx[camera] = (CameraTool.captureDurIdx[camera] + 1) % CAPTURE_DURATIONS.length;\n      }\n\n      if (clicked(CameraTool.button_prev[camera])) {\n        CameraTool.captureDurIdx[camera] =\n          CameraTool.captureDurIdx[camera] === 0 ? CAPTURE_DURATIONS.length - 1 : CameraTool.captureDurIdx[camera] - 1;\n      }\n\n      if (clicked(CameraTool.sndToggleRef[camera])) {\n        captureAudio = !captureAudio;\n      }\n    }\n\n    if (\n      CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_PHOTO ||\n      CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_VIDEO\n    ) {\n      if (clicked(CameraTool.cancelRef[camera])) {\n        CameraTool.state[camera] = CAMERA_STATE.IDLE;\n      } else if (world.time.elapsed >= CameraTool.snapTime[camera]) {\n        if (CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_VIDEO) {\n          CameraTool.snapTime[camera] = world.time.elapsed + CAPTURE_DURATIONS[CameraTool.captureDurIdx[camera]] * 1000;\n          CameraTool.state[camera] = CAMERA_STATE.RECORDING_VIDEO;\n\n          const recorder = createRecorder(captureAudio);\n          videoRecorders.set(camera, recorder);\n          recorder.start();\n\n          APP.hubChannel.beginRecording();\n        } else {\n          CameraTool.state[camera] = CAMERA_STATE.SNAP_PHOTO;\n        }\n      } else {\n        // Floating point imprecision: Add epsilon to elapsed time so that the countdown sound always plays on the same frame that we click\n        const elapsed = world.time.elapsed + 0.01;\n        const msRemaining = CameraTool.snapTime[camera] - elapsed;\n        const msRemainingLastFrame = CameraTool.snapTime[camera] - (elapsed - world.time.delta);\n        if (Math.floor(msRemaining / 1000) !== Math.floor(msRemainingLastFrame / 1000)) {\n          AFRAME.scenes[0].systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\n        }\n      }\n    }\n\n    // TODO we previously did this in tock() since we wanted to run it late in the frame\n    // We actually want to run this before the normal scene render otherwise the camera view is a frame behind.\n    // This is not really a big deal since we also run the camera at a lower FPS anyway\n    const renderTarget = renderTargets.get(camera);\n    const elapsed = world.time.elapsed;\n\n    // Update render target when taking a photo, recording a video, or round robbin for cameras in view\n    if (\n      CameraTool.state[camera] === CAMERA_STATE.SNAP_PHOTO ||\n      (CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO &&\n        elapsed > renderTarget.lastUpdated + VIDEO_UPDATE_RATE) ||\n      (renderTarget.needsUpdate &&\n        world.time.tick % allCameras.length === i &&\n        elapsed > renderTarget.lastUpdated + VIEWFINDER_UPDATE_RATE)\n    ) {\n      updateRenderTarget(world, camera);\n      if (CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO) {\n        videoRecorders.get(camera).captureFrame(renderTargets.get(camera));\n      }\n    }\n\n    if (CameraTool.state[camera] === CAMERA_STATE.SNAP_PHOTO) {\n      captureSnapshot(world, camera);\n      CameraTool.state[camera] = CAMERA_STATE.IDLE;\n    } else if (CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO) {\n      if (clicked(CameraTool.cancelRef[camera])) {\n        endRecording(world, camera, true);\n        CameraTool.state[camera] = CAMERA_STATE.IDLE;\n      } else if (world.time.elapsed >= CameraTool.snapTime[camera]) {\n        endRecording(world, camera, false);\n        CameraTool.state[camera] = CAMERA_STATE.IDLE;\n      }\n    }\n\n    updateUI(world, camera);\n  });\n}\n","import { defineQuery, removeEntity } from \"bitecs\";\nimport { DestroyAtExtremeDistance } from \"../bit-components\";\n\nconst DIST = 1000;\nconst pos = new THREE.Vector3();\n\nconst query = defineQuery([DestroyAtExtremeDistance]);\nexport function destroyAtExtremeDistanceSystem(world) {\n  const ents = query(world);\n  if (!ents.length) return;\n\n  // Check only one per frame\n  const eid = ents[world.time.tick % ents.length];\n  const obj = world.eid2obj.get(eid);\n  obj.getWorldPosition(pos);\n  if (pos.x < -DIST || pos.x > DIST || pos.y < -DIST || pos.y > DIST || pos.z < -DIST || pos.z > DIST) {\n    removeEntity(world, eid);\n  }\n}\n","import { CursorTargettingSystem } from \"./cursor-targetting-system\";\nimport { PositionAtBorderSystem } from \"../components/position-at-border\";\nimport { BoneVisibilitySystem } from \"../components/bone-visibility\";\nimport { AnimationMixerSystem } from \"../components/animation-mixer\";\nimport { UVScrollSystem } from \"../components/uv-scroll\";\nimport { CursorTogglingSystem } from \"./cursor-toggling-system\";\nimport { PhysicsSystem } from \"./physics-system\";\nimport { TwoPointStretchingSystem } from \"./two-point-stretching-system\";\nimport { HoldableButtonSystem, HoverButtonSystem } from \"./button-systems\";\nimport { DrawingMenuSystem } from \"./drawing-menu-system\";\nimport { HoverMenuSystem } from \"./hover-menu-system\";\nimport { SuperSpawnerSystem } from \"./super-spawner-system\";\nimport { HapticFeedbackSystem } from \"./haptic-feedback-system\";\nimport { SoundEffectsSystem } from \"./sound-effects-system\";\nimport { ScenePreviewCameraSystem } from \"./scene-preview-camera-system\";\nimport { InteractionSfxSystem } from \"./interaction-sfx-system\";\nimport { SpriteSystem } from \"./sprites\";\nimport { CameraSystem } from \"./camera-system\";\nimport { WaypointSystem } from \"./waypoint-system\";\nimport { CharacterControllerSystem } from \"./character-controller-system\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { CursorPoseTrackingSystem } from \"./cursor-pose-tracking\";\nimport { MenuAnimationSystem } from \"./menu-animation-system\";\nimport { AudioSettingsSystem } from \"./audio-settings-system\";\nimport { AudioSystem } from \"./audio-system\";\nimport { ShadowSystem } from \"./shadow-system\";\nimport { InspectYourselfSystem } from \"./inspect-yourself-system\";\nimport { EmojiSystem } from \"./emoji-system\";\nimport { AudioZonesSystem } from \"./audio-zones-system\";\nimport { GainSystem } from \"./audio-gain-system\";\nimport { EnvironmentSystem } from \"./environment-system\";\nimport { NameTagVisibilitySystem } from \"./name-tag-visibility-system\";\n \n// new world\nimport { networkSendSystem, networkReceiveSystem } from \"./netcode\";\nimport { onOwnershipLost } from \"./on-ownership-lost\";\nimport { interactionSystem } from \"./bit-interaction-system\";\nimport { floatyObjectSystem } from \"./floaty-object-system\";\nimport { removeNetworkedObjectButtonSystem } from \"./remove-networked-object-button-system\";\nimport { removeObject3DSystem } from \"./remove-object3D-system\";\nimport { networkedTransformSystem } from \"./networked-transform\";\nimport { buttonSystems } from \"./single-action-button-system\";\nimport { constraintsSystem } from \"./bit-constraints-system\";\nimport { mediaFramesSystem } from \"./bit-media-frames\";\nimport { cameraToolSystem } from \"../bit-systems/camera-tool\";\n// import { holdableButtonSystem } from \"./holdable-button-system\";\nimport { physicsCompatSystem } from \"./bit-physics\";\nimport { destroyAtExtremeDistanceSystem } from \"./bit-destroy-at-extreme-distances\";\n\nAFRAME.registerSystem(\"hubs-systems\", {\n  init() {\n    waitForDOMContentLoaded().then(() => {\n      this.DOMContentDidLoad = true;\n    });\n    this.cursorTogglingSystem = new CursorTogglingSystem();\n    this.interactionSfxSystem = new InteractionSfxSystem();\n    this.superSpawnerSystem = new SuperSpawnerSystem();\n    this.cursorTargettingSystem = new CursorTargettingSystem();\n    this.positionAtBorderSystem = new PositionAtBorderSystem();\n    this.physicsSystem = new PhysicsSystem(this.el.object3D);\n    this.twoPointStretchingSystem = new TwoPointStretchingSystem();\n    this.holdableButtonSystem = new HoldableButtonSystem();\n    this.hoverButtonSystem = new HoverButtonSystem();\n    this.hoverMenuSystem = new HoverMenuSystem();\n    this.hapticFeedbackSystem = new HapticFeedbackSystem();\n    this.audioSystem = new AudioSystem(this.el);\n    this.soundEffectsSystem = new SoundEffectsSystem(this.el);\n    this.scenePreviewCameraSystem = new ScenePreviewCameraSystem();\n    this.spriteSystem = new SpriteSystem(this.el);\n    this.cameraSystem = new CameraSystem(this.el.camera, this.el.renderer);\n    this.drawingMenuSystem = new DrawingMenuSystem(this.el);\n    this.characterController = new CharacterControllerSystem(this.el);\n    this.waypointSystem = new WaypointSystem(this.el, this.characterController);\n    this.cursorPoseTrackingSystem = new CursorPoseTrackingSystem();\n    this.menuAnimationSystem = new MenuAnimationSystem();\n    this.audioSettingsSystem = new AudioSettingsSystem(this.el);\n    this.animationMixerSystem = new AnimationMixerSystem();\n    this.boneVisibilitySystem = new BoneVisibilitySystem();\n    this.uvScrollSystem = new UVScrollSystem();\n    this.shadowSystem = new ShadowSystem(this.el);\n    this.inspectYourselfSystem = new InspectYourselfSystem();\n    this.emojiSystem = new EmojiSystem(this.el);\n    this.audioZonesSystem = new AudioZonesSystem();\n    this.gainSystem = new GainSystem();\n    this.environmentSystem = new EnvironmentSystem(this.el);\n    this.nameTagSystem = new NameTagVisibilitySystem(this.el);\n\n    window.$S = this;\n  },\n\n  tick(t, dt) {\n    if (!this.DOMContentDidLoad) return;\n    const world = APP.world;\n\n    networkReceiveSystem(world);\n    onOwnershipLost(world);\n\n    physicsCompatSystem(APP.world);\n\n    networkedTransformSystem(world);\n\n    const systems = AFRAME.scenes[0].systems;\n    systems.userinput.tick2();\n\n    interactionSystem(world, this.cursorTargettingSystem, t, systems);\n\n    buttonSystems(world);\n    constraintsSystem(world, systems.userinput);\n\n    // We run this earlier in the frame so things have a chance to override properties run by animations\n    this.animationMixerSystem.tick(dt);\n\n    this.characterController.tick(t, dt);\n    this.cursorTogglingSystem.tick(systems.interaction, systems.userinput, this.el);\n    this.interactionSfxSystem.tick(systems.interaction, systems.userinput, this.soundEffectsSystem);\n    this.superSpawnerSystem.tick();\n    this.emojiSystem.tick(t, systems.userinput);\n    this.cursorPoseTrackingSystem.tick();\n    this.hoverMenuSystem.tick();\n    this.positionAtBorderSystem.tick();\n    // this.constraintsSystem.tick();\n    this.twoPointStretchingSystem.tick();\n\n    floatyObjectSystem(world);\n\n    this.holdableButtonSystem.tick();\n    this.hoverButtonSystem.tick();\n    this.drawingMenuSystem.tick();\n    this.hapticFeedbackSystem.tick(\n      this.twoPointStretchingSystem,\n      false,\n      false\n      // TODO: didInteractLeftThisFrame doesn't exist?\n      // this.singleActionButtonSystem.didInteractLeftThisFrame,\n      // this.singleActionButtonSystem.didInteractRightThisFrame\n    );\n    this.soundEffectsSystem.tick();\n    this.scenePreviewCameraSystem.tick();\n    this.physicsSystem.tick(dt);\n    this.inspectYourselfSystem.tick(this.el, systems.userinput, this.cameraSystem);\n    this.cameraSystem.tick(this.el, dt);\n    cameraToolSystem(world);\n    this.waypointSystem.tick(t, dt);\n    this.menuAnimationSystem.tick(t);\n    this.spriteSystem.tick(t, dt);\n    this.uvScrollSystem.tick(dt);\n    this.shadowSystem.tick();\n    mediaFramesSystem(world);\n    this.audioZonesSystem.tick(this.el);\n    this.gainSystem.tick();\n    this.nameTagSystem.tick();\n\n    destroyAtExtremeDistanceSystem(world);\n    removeNetworkedObjectButtonSystem(world);\n    removeObject3DSystem(world);\n\n    // We run this late in the frame so that its the last thing to have an opinion about the scale of an object\n    this.boneVisibilitySystem.tick();\n\n    networkSendSystem(world);\n  },\n\n  remove() {\n    this.cursorTargettingSystem.remove();\n  }\n});\n","import { handHoverSystem } from \"./bit-hand-hover-system\";\nimport { holdSystem } from \"./hold-system\";\nimport { dontHoldWithHandAndRemote, dontHoverAndHold } from \"./not-hovered-if-held\";\n\nexport function interactionSystem(world, cursorTargettingSystem, t, systems) {\n  cursorTargettingSystem.tick(t); // handles hovers for cursors\n  handHoverSystem(world, systems.interaction);\n\n  holdSystem(world, systems.userinput);\n  dontHoldWithHandAndRemote(world);\n  dontHoverAndHold(world);\n\n  // Copies hovered/held state (only for aframe entities) for querying by legacy systems/components\n  systems.interaction.updateLegacyState();\n}\n","import qsTruthy from \"../utils/qs_truthy\";\n\nAFRAME.registerSystem(\"capture-system\", {\n  init() {\n    this._gotAudioTrack = false;\n    this._recorderTimeout = null;\n  },\n\n  _initRecorder() {\n    if (!this.available()) return;\n\n    this._stream = new MediaStream();\n\n    const video = this.el.canvas.captureStream().getVideoTracks()[0];\n    this._stream.addTrack(video);\n\n    this._recorder = new MediaRecorder(this._stream, { mimeType: \"video/webm; codecs=vp8\" });\n\n    const chunks = [];\n\n    this._recorder.ondataavailable = e => {\n      chunks.push(e.data);\n    };\n    this._recorder.onstop = () => {\n      if (chunks.length === 0) return;\n      const mimeType = chunks[0].type;\n      const blob = new Blob(chunks, { type: mimeType });\n      chunks.length = 0;\n      this.el.emit(\"add_media\", new File([blob], \"capture\", { type: mimeType }));\n    };\n  },\n\n  available() {\n    return qsTruthy(\"video_capture\") && window.MediaRecorder && MediaRecorder.isTypeSupported(\"video/webm; codecs=vp8\");\n  },\n\n  started() {\n    return this._recorder && this._recorder.state !== \"inactive\";\n  },\n\n  _tryAddingAudioTrack() {\n    if (this._gotAudioTrack || !this.el.audioListener) return;\n\n    const listener = this.el.audioListener;\n    const destination = listener.context.createMediaStreamDestination();\n    listener.getInput().connect(destination);\n    const audio = destination.stream.getAudioTracks()[0];\n\n    this._stream.addTrack(audio);\n    this._gotAudioTrack = true;\n  },\n\n  start() {\n    if (!this._recorder) {\n      this._initRecorder();\n    }\n\n    // The scene doesn't get an audioListener until something in the scene is playing audio.\n    // So we have to get the audio track lazily.\n    this._tryAddingAudioTrack();\n\n    if (!this.started()) {\n      this._recorder.start();\n      this._recorderTimeout = setTimeout(() => {\n        if (this.started()) {\n          this._recorder.stop();\n        }\n      }, 15000);\n    }\n  },\n\n  stop() {\n    if (this.started()) {\n      clearTimeout(this._recorderTimeout);\n      this._recorder.stop();\n    }\n  }\n});\n","// Provides the idea of \"media linking\" -- if two media objects are linked\n// then updates to one (src, page, etc) will be reflected on the other, and vice versa.\n//\n// When you link a media element from A -> B via registerLinkage, a few notes:\n// - The media is assumed to be of the same kind, ideally created via media-utils/cloneMedia\n// - Sync is bidirectional, however, elB is assumed to be a 'derivate of' elA. this means:\n//   - for the video case, elA will have its volume set to zero and restored if elB is removed\n//   - when elA is removed, elB will be removed (done in media-loader) but not vice-versa\n\nimport { updateAudioSettings } from \"../update-audio-settings\";\n\n//\nAFRAME.registerSystem(\"linked-media\", {\n  init: function() {\n    this.handlers = [];\n    this.addLinkageHandler = this.addLinkageHandler.bind(this);\n    this.syncLinkage = this.syncLinkage.bind(this);\n  },\n\n  addLinkageHandler(elA, elB) {\n    const handler = () => {\n      // Since elB will have its event fired here if we change something, ignore it.\n      if (elB._handlingLinkage) return;\n      elA._handlingLinkage = true;\n      this.syncLinkage(elA, elB);\n      elA._handlingLinkage = false;\n    };\n\n    if (elA.components[\"media-loader\"].data) {\n      elA.addEventListener(\"componentchanged\", handler);\n    } else {\n      const waitForMediaLoader = evt => {\n        if (evt.detail.name === \"media-loader\") {\n          elA.removeEventListener(\"componentinitialized\", waitForMediaLoader);\n          elA.addEventListener(\"componentchanged\", handler);\n        }\n      };\n\n      elA.addEventListener(\"componentinitialized\", waitForMediaLoader);\n    }\n\n    return handler;\n  },\n\n  registerLinkage: function(elA, elB) {\n    this.syncLinkage(elA, elB);\n\n    const handlerA = this.addLinkageHandler(elA, elB);\n    const handlerB = this.addLinkageHandler(elB, elA);\n    elA.setAttribute(\"linked-media\", \"\");\n    elB.setAttribute(\"linked-media\", \"\");\n\n    // As a convenience, if elA has audio, we turn its volume off so we don't hear it twice\n    APP.mutedState.add(elA);\n    const audio = APP.audios.get(elA);\n    if (audio) {\n      updateAudioSettings(elA, audio);\n    }\n\n    this.handlers.push([elA, elB, handlerA, handlerB]);\n  },\n\n  deregisterLinkage: function(el) {\n    // Deregister elA -> elB, get list of elBs, and remove them\n    for (const [elA, elB, handlerA, handlerB] of this.handlers) {\n      if (el === elA || el === elB) {\n        elA.removeEventListener(\"componentchanged\", handlerA);\n        elB.removeEventListener(\"componentchanged\", handlerB);\n      }\n\n      APP.mutedState.delete(elA);\n      const audio = APP.audios.get(elA);\n      if (audio) {\n        updateAudioSettings(elA, audio);\n      }\n    }\n\n    this.handlers = this.handlers.filter(([elA, elB]) => elA !== el && elB !== el);\n  },\n\n  syncLinkage(elA, elB) {\n    if (elB.components[\"networked\"]) {\n      // Take ownership before updating\n      if (!NAF.utils.isMine(elB) && !NAF.utils.takeOwnership(elB)) return;\n    }\n\n    const { src, version } = elA.components[\"media-loader\"].data;\n\n    // For now, manually sync linkable properties.\n    elB.setAttribute(\"media-loader\", { src, version });\n\n    if (elA.components[\"media-pdf\"]) {\n      const { index } = elA.components[\"media-pdf\"].data;\n      elB.setAttribute(\"media-pdf\", { index });\n    }\n\n    if (elA.components[\"media-video\"]) {\n      const { time, videoPaused, loop, hidePlaybackControls } = elA.components[\"media-video\"].data;\n\n      // Sync time, pause state, playback controls, and tighten sync tolerance since its local\n      const syncedVideoAttributes = { time, videoPaused, loop, hidePlaybackControls };\n\n      const targetIsNetworked = !elB.components.networked;\n      if (targetIsNetworked) {\n        syncedVideoAttributes.syncTolerance = 0.25;\n      }\n\n      elB.setAttribute(\"media-video\", syncedVideoAttributes);\n      elB.components[\"media-video\"].updatePlaybackState(true);\n    }\n  }\n});\n\nAFRAME.registerComponent(\"linked-media\", {\n  remove: function() {\n    this.system.deregisterLinkage(this.el);\n  }\n});\n","export default \"precision highp float;\\nprecision highp int;\\n\\nvarying vec2 vUv;\\nvarying vec3 vNormal;\\nvoid main()\\n{\\n  vNormal = normalize(normal);\\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n  vUv = position.xz;\\n}\";","import audioDebugVert from \"./audio-debug.vert\";\nimport audioDebugFrag from \"./audio-debug.frag\";\nimport { DistanceModelType } from \"../components/audio-params\";\nimport { getWebGLVersion } from \"../utils/webgl\";\nimport { getMeshes } from \"../utils/aframe-utils\";\n\nconst fakePanner = {\n  distanceModel: DistanceModelType.Inverse,\n  maxDistance: 0,\n  refDistance: 0,\n  rolloffFactor: 0,\n  coneInnerAngle: 0,\n  coneOuterAngle: 0\n};\n\nAFRAME.registerSystem(\"audio-debug\", {\n  schema: {\n    enabled: { default: false }\n  },\n\n  init() {\n    this.maxDebugSources = 64;\n    this.unsupported = false;\n    const webGLVersion = getWebGLVersion(this.el.sceneEl.renderer);\n    if (webGLVersion < \"2.0\") {\n      this.unsupported = true;\n    } else {\n      const gl = this.el.sceneEl.renderer.getContext();\n      const maxUniformVectors = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);\n      // 10 is the number of uniform vectors in the shader. If we update that, this number must be updated accordingly.\n      this.maxDebugSources = Math.min(Math.floor(maxUniformVectors / 10), this.maxDebugSources);\n    }\n\n    window.APP.store.addEventListener(\"statechanged\", this.updateState.bind(this));\n\n    this.onSceneLoaded = this.onSceneLoaded.bind(this);\n    this.el.sceneEl.addEventListener(\"environment-scene-loaded\", this.onSceneLoaded);\n\n    this.navMeshObject = null;\n    this.zones = [];\n\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: { value: 0.0 },\n        colorInner: { value: new THREE.Color(\"#7AFF59\") },\n        colorOuter: { value: new THREE.Color(\"#FF6340\") },\n        colorGain: { value: new THREE.Color(\"#70DBFF\") },\n        count: { value: 0 },\n        maxDistance: { value: [] },\n        refDistance: { value: [] },\n        rolloffFactor: { value: [] },\n        distanceModel: { value: [] },\n        sourcePosition: { value: [] },\n        sourceOrientation: { value: [] },\n        coneInnerAngle: { value: [] },\n        coneOuterAngle: { value: [] },\n        gain: { value: [] },\n        clipped: { value: [] }\n      },\n      vertexShader: audioDebugVert,\n      fragmentShader: audioDebugFrag\n    });\n    this.material.side = THREE.FrontSide;\n    this.material.transparent = true;\n    this.material.uniforms.count.value = 0;\n    this.material.defines.MAX_DEBUG_SOURCES = this.maxDebugSources;\n\n    this.sourcePositions = new Array(this.maxDebugSources);\n    this.sourcePositions.fill(new THREE.Vector3());\n    this.sourceOrientations = new Array(this.maxDebugSources);\n    this.sourceOrientations.fill(new THREE.Vector3());\n    this.distanceModels = new Array(this.maxDebugSources);\n    this.distanceModels.fill(0);\n    this.maxDistances = new Array(this.maxDebugSources);\n    this.maxDistances.fill(0.0);\n    this.refDistances = new Array(this.maxDebugSources);\n    this.refDistances.fill(0.0);\n    this.rolloffFactors = new Array(this.maxDebugSources);\n    this.rolloffFactors.fill(0.0);\n    this.coneInnerAngles = new Array(this.maxDebugSources);\n    this.coneInnerAngles.fill(0.0);\n    this.coneOuterAngles = new Array(this.maxDebugSources);\n    this.coneOuterAngles.fill(0.0);\n    this.gains = new Array(this.maxDebugSources);\n    this.gains.fill(0.0);\n    this.clipped = new Array(this.maxDebugSources);\n    this.clipped.fill(0.0);\n  },\n\n  remove() {\n    window.APP.store.removeEventListener(\"statechanged\", this.updateState);\n    this.el.sceneEl.removeEventListener(\"environment-scene-loaded\", this.onSceneLoaded);\n  },\n\n  registerZone(zone) {\n    this.zones.push(zone);\n  },\n\n  unregisterZone(zone) {\n    const index = this.zones.indexOf(zone);\n\n    if (index !== -1) {\n      this.zones.splice(index, 1);\n    }\n  },\n\n  tick: (() => {\n    const sourcePos = new THREE.Vector3();\n    const sourceDir = new THREE.Vector3();\n    return function (time) {\n      if (!this.data.enabled) {\n        return;\n      }\n\n      let sourceNum = 0;\n      for (const [el, audio] of APP.audios.entries()) {\n        if (sourceNum >= this.maxDebugSources) continue;\n        if (APP.isAudioPaused.has(el)) continue;\n\n        audio.getWorldPosition(sourcePos);\n        audio.getWorldDirection(sourceDir);\n        this.sourcePositions[sourceNum] = this.navMeshObject.worldToLocal(sourcePos).clone(); // TODO: Use Vector3 pool\n        this.sourceOrientations[sourceNum] = this.navMeshObject.worldToLocal(sourceDir).clone();\n\n        const panner = audio.panner || fakePanner;\n\n        this.distanceModels[sourceNum] = 0;\n        if (panner.distanceModel === DistanceModelType.Linear) {\n          this.distanceModels[sourceNum] = 0;\n        } else if (panner.distanceModel === DistanceModelType.Inverse) {\n          this.distanceModels[sourceNum] = 1;\n        } else if (panner.distanceModel === DistanceModelType.Exponential) {\n          this.distanceModels[sourceNum] = 2;\n        }\n        this.maxDistances[sourceNum] = panner.maxDistance;\n        this.refDistances[sourceNum] = panner.refDistance;\n        this.rolloffFactors[sourceNum] = panner.rolloffFactor;\n        this.coneInnerAngles[sourceNum] = panner.coneInnerAngle;\n        this.coneOuterAngles[sourceNum] = panner.coneOuterAngle;\n\n        this.gains[sourceNum] = audio.gain.gain.value;\n        this.clipped[sourceNum] = APP.clippingState.has(el);\n        sourceNum++;\n      }\n\n      // Update material uniforms\n      this.material.uniforms.time.value = time;\n      this.material.uniforms.distanceModel.value = this.distanceModels;\n      this.material.uniforms.maxDistance.value = this.maxDistances;\n      this.material.uniforms.refDistance.value = this.refDistances;\n      this.material.uniforms.rolloffFactor.value = this.rolloffFactors;\n      this.material.uniforms.sourcePosition.value = this.sourcePositions;\n      this.material.uniforms.sourceOrientation.value = this.sourceOrientations;\n      this.material.uniforms.count.value = sourceNum;\n      this.material.uniforms.coneInnerAngle.value = this.coneInnerAngles;\n      this.material.uniforms.coneOuterAngle.value = this.coneOuterAngles;\n      this.material.uniforms.gain.value = this.gains;\n      this.material.uniforms.clipped.value = this.clipped;\n    };\n  })(),\n\n  enableDebugMode(enabled, force = false) {\n    if (((enabled === undefined || enabled === this.data.enabled) && !force) || this.unsupported) return;\n    this.zones.forEach(zone => {\n      zone.el.setAttribute(\"audio-zone\", \"debuggable\", enabled);\n    });\n\n    const collisionEntities = Array.from(this.el.sceneEl.querySelectorAll(\"[nav-mesh]\"));\n    const meshes = getMeshes(collisionEntities);\n\n    if (meshes.length) {\n      this.data.enabled = enabled;\n      meshes.forEach(obj => {\n        if (obj.isMesh) {\n          this.navMeshObject = obj;\n          obj.parent.visible = enabled;\n          if (obj.material) {\n            if (enabled) {\n              !obj._hubs_audio_debug_prev_material && (obj._hubs_audio_debug_prev_material = obj.material);\n              obj.material = this.material;\n              obj.material.needsUpdate = true;\n            } else if (obj._hubs_audio_debug_prev_material) {\n              obj.material = obj._hubs_audio_debug_prev_material;\n              obj._hubs_audio_debug_prev_material = null;\n              obj.material.needsUpdate = true;\n            }\n            obj.geometry.computeVertexNormals();\n          }\n        }\n      });\n    }\n\n    if (!this.navMeshObject) {\n      this.data.enabled = false;\n    }\n  },\n\n  updateState({ force }) {\n    const isEnabled = window.APP.store.state.preferences.showAudioDebugPanel;\n    if (force || isEnabled !== this.data.enabled) {\n      this.enableDebugMode(isEnabled, force);\n    }\n  },\n\n  onSceneLoaded() {\n    this.navMeshObject = null;\n    this.updateState({ force: true });\n  }\n});\n","export default \"// Based on: https://www.shadertoy.com/view/Mll3D4#\\n\\nprecision highp float;\\nprecision highp int;\\n\\nvarying vec2 vUv;\\nvarying vec3 vNormal;\\nuniform float time;\\n\\nconst int LINEAR = 0;\\nconst int INVERSE = 1;\\nconst int EXPONENTIAL = 2;\\n        \\nuniform vec3 colorInner;\\nuniform vec3 colorOuter;\\nuniform vec3 colorGain;\\nuniform int count;\\nuniform vec3 sourcePosition[MAX_DEBUG_SOURCES];\\nuniform vec3 sourceOrientation[MAX_DEBUG_SOURCES];\\nuniform float maxDistance[MAX_DEBUG_SOURCES];\\nuniform float refDistance[MAX_DEBUG_SOURCES];\\nuniform float rolloffFactor[MAX_DEBUG_SOURCES];\\nuniform int distanceModel[MAX_DEBUG_SOURCES];\\nuniform float coneInnerAngle[MAX_DEBUG_SOURCES];\\nuniform float coneOuterAngle[MAX_DEBUG_SOURCES];\\nuniform float gain[MAX_DEBUG_SOURCES];\\nuniform bool clipped[MAX_DEBUG_SOURCES];\\n\\nconst float kPi = 3.141592;\\nconst float kDegToRad = kPi / 180.0;\\nconst float kInvPi = 1.0 / 3.141592;\\nconst float kRefDistWidth = 0.05;\\n\\nfloat distance[MAX_DEBUG_SOURCES];\\nvec2 center[MAX_DEBUG_SOURCES];\\nfloat startOffset[MAX_DEBUG_SOURCES];\\nfloat clampedGain[MAX_DEBUG_SOURCES];\\n\\nfloat att_linear(float x, float rolloff, float dref, float dmax) {\\n  return 1.0-(rolloff*((x-dref)/(dmax-dref)));\\n}\\n\\nfloat att_inverse(float x, float rolloff, float dref) {\\n  return dref/(dref+(rolloff*(max(x, dref)-dref)));\\n}\\n\\nfloat att_exponential(float x, float rolloff, float dref) {\\n  return pow((max(x, dref)/dref),-rolloff);\\n}\\n\\nvec4 circle(vec2 center, float d, float len, float radius, float holeRadius, vec3 color, float offset) {  \\n  // Define how blurry the circle should be. \\n  // A value of 1.0 means 'sharp', larger values\\n  // will increase the bluriness.\\n  float bluriness = 1.0;\\n  \\n  // Calculate angle, so we can draw segments, too.\\n  float angle = atan( center.x, center.y ) * kInvPi * 0.5;\\n  angle = fract( angle + offset);\\n  \\n  // Create an anti-aliased circle.\\n  float wd = bluriness * fwidth( d );\\n  float circle = smoothstep( radius + wd, radius - wd, d );\\n  \\n  // Optionally, you could create a hole in it:\\n  float inner = holeRadius;\\n  circle -= smoothstep( inner + wd, inner - wd, d );\\n  \\n  // Or only draw a portion (segment) of the circle.\\n  float wa = bluriness * fwidth( angle );\\n  float segment = smoothstep( len + wa, len - wa, angle );\\n  segment *= smoothstep( 0.0, 2.0 * wa, angle );\\n  circle *= mix( segment, 1.0, step( 1.0, len ) );\\n      \\n  // Let's define the circle's color now.\\n  vec3 rgb = color * circle;\\n  \\n  // Output final color.\\n  return vec4( rgb, circle);\\n}\\n\\nfloat att(float d, float maxDistance, float refDistance, float rolloffFactor, int distanceModel) {\\n  // Calculate attenuation\\n  float attenuation = 1.0;\\n  if (distanceModel == LINEAR) {\\n    attenuation = att_linear(d, rolloffFactor, refDistance, maxDistance);\\n  } else if (distanceModel == INVERSE) {\\n    attenuation = att_inverse(d, rolloffFactor, refDistance);\\n  } else if (distanceModel == EXPONENTIAL) {\\n    attenuation = att_exponential(d, rolloffFactor, refDistance);\\n  }\\n  return clamp(attenuation, 0.0, 1.0);\\n}\\n\\nvec4 draw_att(float d, float attenuation, vec4 circle) {\\n  // Waves\\n  float v = sin((d * 2.0 * kPi) - (time * 0.005)) + 1.0;\\n  float waves = circle.a * attenuation * v;\\n  \\n  // Output final color.\\n  return vec4( circle.rgb, waves );\\n}\\n\\nvoid main() {\\n  // Draw background\\n  vec4 background = vec4(1.0, 1.0, 1.0, 0.0);\\n\\n  for (int i=0; i<count; i++) {\\n    center[i] = sourcePosition[i].xz - vUv;\\n\\n    // Calculate distance to (0,0).\\n    distance[i] = length( center[i] );\\n\\n    // Optional start Offset.\\n    vec2 orientation = normalize(sourceOrientation[i].xz);\\n    float ang = atan(-orientation.x, orientation.y) * kInvPi * 0.5;\\n    // Rotate to start drawing facing front\\n    ang -= 0.5;\\n    startOffset[i] = mod(ang, 1.0);\\n\\n    // Gain\\n    clampedGain[i] = clamp(gain[i], 0.0, 1.0);\\n  }\\n\\n  for (int i=0; i<count; i++) {\\n    float attenuation = att(distance[i], maxDistance[i], refDistance[i], rolloffFactor[i], distanceModel[i]);\\n\\n    // Draw inner cone\\n    float innerAngle = coneInnerAngle[i] * kDegToRad * kInvPi * 0.5;\\n    float innerStartAngle = startOffset[i] + innerAngle * 0.5;\\n    vec4 innerLayer = circle(center[i], distance[i], innerAngle, 10000.0, 1.0, colorInner, innerStartAngle);\\n    innerLayer = draw_att(distance[i], attenuation, innerLayer);\\n    background = mix(background, innerLayer, innerLayer.a * clampedGain[i]);\\n\\n    // Draw outer cone\\n    float outerAngle = coneOuterAngle[i] * kDegToRad * kInvPi * 0.5;\\n    float outerAngleDiffHalf = (outerAngle - innerAngle) * 0.5;\\n    vec4 outerLayer1 = circle(center[i], distance[i], outerAngleDiffHalf, 10000.0, 1.0, colorOuter, innerStartAngle + outerAngleDiffHalf);\\n    outerLayer1 = draw_att(distance[i], attenuation, outerLayer1);\\n    background = mix(background, outerLayer1, outerLayer1.a * clampedGain[i]);\\n    vec4 outerLayer2 = circle(center[i], distance[i], outerAngleDiffHalf, 10000.0, 1.0, colorOuter, innerStartAngle - innerAngle);\\n    outerLayer2 = draw_att(distance[i], attenuation, outerLayer2);\\n    background = mix(background, outerLayer2, outerLayer2.a * (clipped[i] ? 0.0 : 1.0) * clampedGain[i]);\\n  }\\n\\n  for (int i=0; i<count; i++) {\\n    // Draw base\\n    vec4 baseLayer = circle(center[i], distance[i], 1.0, 1.0, 0.1, vec3(0.5, 0.5, 0.5), 0.0);\\n    background = mix(background, baseLayer, baseLayer.a);\\n\\n    // Draw gain\\n    vec4 gainLayer = circle(center[i], distance[i], clampedGain[i], 1.0, 0.5, colorGain, startOffset[i]);\\n    background = mix(background, gainLayer, gainLayer.a);\\n    if (gain[i] > 1.0) {\\n      vec4 overGainLayer = circle(center[i], distance[i], gain[i] -  clampedGain[i], 1.0, 0.5, vec3(1.0, 0.0, 0.0), startOffset[i]);\\n      background = mix(background, overGainLayer, overGainLayer.a);\\n    }\\n  } \\n  \\n  // Blend\\n  gl_FragColor = vec4(background.rgb, background.a * vNormal.y);\\n}\";","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\n  const publicComponent = publicComponents[inputComponent];\n\n  if (!publicComponent) {\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\n  }\n\n  const publicProperty = publicComponent.publicProperties[inputProperty];\n\n  if (!publicProperty) {\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\n  }\n\n  return {\n    mappedComponent: publicComponent.mappedComponent,\n    mappedProperty: publicProperty.mappedProperty,\n    getMappedValue: publicProperty.getMappedValue\n  };\n}\n","import { sanitizeUrl } from \"@braintree/sanitize-url\";\nimport \"./components/gltf-model-plus\";\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\nimport { TYPE, SHAPE, FIT } from \"three-ammo/constants\";\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\nimport { AudioType, DistanceModelType, SourceType } from \"./components/audio-params\";\nimport { updateAudioSettings } from \"./update-audio-settings\";\nimport { renderAsEntity } from \"./utils/jsx-entity\";\nimport { Networked } from \"./bit-components\";\nimport { addComponent } from \"bitecs\";\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\", el => {\n  el.setAttribute(\"duck\", \"\");\n  el.setAttribute(\"quack\", { quackPercentage: 0.1 });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\n  //TODO: Do not automatically add these components\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n  el.setAttribute(\"hoverable-visuals\", \"\");\n  el.setAttribute(componentName, componentData);\n});\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"body-helper\", el => {\n  //This is only required for migration of old environments with super-spawners\n  //will no longer be needed when spawners are added via Spoke instead.\n  el.setAttribute(\"body-helper\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"shape-helper\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\n  if (componentData.distance === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n  if (componentData.castShadow) {\n    // HACK: component.light isn't set until one frame after setArrtibute\n    setTimeout(() => {\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\n    }, 0);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"billboard\", \"billboard\");\nAFRAME.GLTFModelPlus.registerComponent(\"simple-water\", \"simple-water\");\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"morph-audio-feedback\", \"morph-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\"uv-scroll\", \"uv-scroll\");\nAFRAME.GLTFModelPlus.registerComponent(\"frustrum\", \"frustrum\");\nAFRAME.GLTFModelPlus.registerComponent(\"mirror\", \"mirror\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"shape-helper\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation: { x: orientation.x, y: orientation.y, z: orientation.z, w: orientation.w }\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\", el => {\n  el.setAttribute(\"waypoint\", {\n    canBeSpawnPoint: true,\n    canBeOccupied: false,\n    canBeClicked: false,\n    willDisableMotion: false,\n    willDisableTeleporting: false,\n    willMaintainWorldUp: true\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"waypoint\", \"waypoint\", (el, componentName, componentData, components) => {\n  if (componentData.canBeOccupied) {\n    el.setAttribute(\"networked\", {\n      template: \"#template-waypoint-avatar\",\n      attachTemplateToLocal: false,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n  el.setAttribute(\"waypoint\", componentData);\n});\n\nimport { findAncestorWithComponent } from \"./utils/scene-graph\";\nimport { createElementEntity } from \"./utils/jsx-entity\";\n/** @jsx createElementEntity */ createElementEntity;\n\nAFRAME.GLTFModelPlus.registerComponent(\"media-frame\", \"media-frame\", (el, _componentName, componentData) => {\n  const eid = renderAsEntity(APP.world, <entity media-frame={componentData} />);\n\n  addComponent(APP.world, Networked, eid);\n\n  const networkedEl = findAncestorWithComponent(el, \"networked\");\n  const rootNid = (networkedEl && networkedEl.components.networked.data.networkId) || \"scene\";\n  Networked.id[eid] = APP.getSid(`${rootNid}.${el.object3D.children[0].userData.gltfIndex}`);\n  APP.world.nid2eid.set(Networked.id[eid], eid);\n\n  el.object3D.add(APP.world.eid2obj.get(eid));\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  const mediaLoaderAttributes = {\n    src: sanitizeUrl(componentData.src),\n    fitToBox: componentData.contentSubtype ? false : true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    contentSubtype: componentData.contentSubtype\n  };\n\n  if (componentData.version) {\n    mediaLoaderAttributes.version = componentData.version;\n  }\n\n  el.setAttribute(\"media-loader\", mediaLoaderAttributes);\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pdf\", { index: componentData.pageIndex });\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => { {\n\n    if (componentData.id) {\n      el.setAttribute(\"networked\", {\n        template: \"#interactable-media\",\n        owner: \"scene\",\n        persistent: true,\n        networkId: componentData.id\n      });\n    }\n\n    const mediaLoaderAttributes = {\n      src: sanitizeUrl(componentData.src),\n      fitToBox: componentData.contentSubtype ? false : true,\n      resolve: true,\n      fileIsOwned: true,\n      animate: false,\n      contentSubtype: componentData.contentSubtype\n    };\n\n    if (componentData.version) {\n      mediaLoaderAttributes.version = componentData.version;\n    }\n\n    el.setAttribute(\"media-loader\", mediaLoaderAttributes);\n\n    if (componentData.pageIndex) {\n      el.setAttribute(\"media-pdf\", { index: componentData.pageIndex });\n      el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n    }\n\n    if (componentData.paused !== undefined) {\n      el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n    }\n\n    if (componentData.time) {\n      el.setAttribute(\"media-video\", { time: componentData.time });\n    }\n  }\n});\n\nasync function mediaInflator(el, componentName, componentData, components) {\n  let isControlled = true;\n\n  if (componentName === \"link\" && (components.video || components.image)) {\n    // video/image component will set link url specified in link component.\n    return;\n  }\n\n  if (components.networked) {\n    isControlled = componentData.controls || componentName === \"link\";\n\n    const hasVolume = componentName === \"video\" || componentName === \"audio\";\n    const templateName =\n      componentName === \"model\" || isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\n\n    el.setAttribute(\"networked\", {\n      template: templateName,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {};\n\n  if (componentName === \"video\" || componentName === \"image\") {\n    mediaOptions.projection = componentData.projection;\n    mediaOptions.alphaMode = componentData.alphaMode;\n    mediaOptions.alphaCutoff = componentData.alphaCutoff;\n  }\n\n  if (componentName === \"video\" || componentName === \"audio\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.hidePlaybackControls = !isControlled;\n\n    if (componentData.audioType) {\n      // This is an old version of this component, which had built-in audio parameters.\n      // The way we are handling it is wrong. If a user created a scene with this old version\n      // of the component, all of these parameters will be present whether the user explicitly set\n      // the values for them or not. But really, they should only count as \"overrides\" if the user\n      // meant for them to take precendence over the app and scene defaults.\n      // TODO: Fix this issue. One option is to just ignore this component data, which might break old scenes\n      //       but simplifying the handling. Another option is to compare the component data here with\n      //       the \"defaults\" and only save the values that are different from the defaults. However,\n      //       this loses information if the user changed the scene settings but wanted this specific\n      //       node to use the \"defaults\".\n      //       I don't see a perfect solution here and would prefer not to handle the \"legacy\" components.\n      //\n      // For legacy components we don't want artificial distance based attenuation to be applied to stereo audios\n      // so we set the distanceModel and rolloffFactor so the attenuation is always 1. The artificial distance based\n      // attenuation is calculated in the gain system for stereo audios.\n      APP.audioOverrides.set(el, {\n        audioType: componentData.audioType,\n        distanceModel:\n          componentData.audioType === AudioType.Stereo ? DistanceModelType.Linear : componentData.distanceModel,\n        rolloffFactor: componentData.audioType === AudioType.Stereo ? 0 : componentData.rolloffFactor,\n        refDistance: componentData.refDistance,\n        maxDistance: componentData.maxDistance,\n        coneInnerAngle: componentData.coneInnerAngle,\n        coneOuterAngle: componentData.coneOuterAngle,\n        coneOuterGain: componentData.coneOuterGain,\n        gain: componentData.volume\n      });\n      APP.sourceType.set(el, SourceType.MEDIA_VIDEO);\n\n      const audio = APP.audios.get(el);\n      if (audio) {\n        updateAudioSettings(el, audio);\n      }\n    }\n\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\n  }\n\n  if ((componentName === \"video\" || componentName === \"image\") && components.link) {\n    mediaOptions.href = sanitizeUrl(components.link.href);\n  }\n\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\n\n  el.setAttribute(\"media-loader\", {\n    src: sanitizeUrl(src),\n    fitToBox: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    mediaOptions,\n    moveTheParentNotTheMesh: true\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"model\", \"model\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"audio\", \"audio\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\n\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\n  el.setAttribute(\"media-loader\", {\n    src: sanitizeUrl(componentData.src),\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    moveTheParentNotTheMesh: true\n  });\n  el.setAttribute(\"css-class\", \"interactable\");\n  el.setAttribute(\"super-spawner\", {\n    src: sanitizeUrl(componentData.src),\n    resolve: true,\n    template: \"#interactable-media\",\n    mediaOptions: componentData.mediaOptions || {}\n  });\n  el.setAttribute(\"hoverable-visuals\", \"\");\n  el.setAttribute(\"body-helper\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nconst publicComponents = {\n  video: {\n    mappedComponent: \"video-pause-state\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  },\n  \"loop-animation\": {\n    mappedComponent: \"loop-animation\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  }\n};\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"trigger-volume\",\n  \"trigger-volume\",\n  (el, componentName, componentData, components, indexToEntityMap) => {\n    const {\n      size,\n      target,\n      enterComponent,\n      enterProperty,\n      enterValue,\n      leaveComponent,\n      leaveProperty,\n      leaveValue\n    } = componentData;\n\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\n\n    try {\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\n\n      // indexToEntityMap should be considered depredcated. These references are now resovled by the GLTFHubsComponentExtension\n      if (typeof target === \"number\") {\n        targetEntity = indexToEntityMap[target];\n      } else {\n        targetEntity = target?.el;\n      }\n\n      if (!targetEntity) {\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\n      }\n    } catch (e) {\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\n      return;\n    }\n\n    // Filter out scope and colliders properties.\n    el.setAttribute(\"trigger-volume\", {\n      colliders: \"#avatar-pov-node\",\n      size,\n      target: targetEntity,\n      enterComponent: enterComponentMapping.mappedComponent,\n      enterProperty: enterComponentMapping.mappedProperty,\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\n      leaveComponent: leaveComponentMapping.mappedComponent,\n      leaveProperty: leaveComponentMapping.mappedProperty,\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"heightfield\", \"heightfield\", (el, componentName, componentData) => {\n  el.setAttribute(\"shape-helper__heightfield\", {\n    type: SHAPE.HEIGHTFIELD,\n    margin: 0.01,\n    fit: FIT.MANUAL,\n    heightfieldDistance: componentData.distance,\n    offset: componentData.offset,\n    heightfieldData: componentData.data\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"trimesh\", \"trimesh\", el => {\n  el.setAttribute(\"shape-helper__trimesh\", {\n    type: SHAPE.MESH,\n    margin: 0.01,\n    fit: FIT.ALL,\n    includeInvisible: true\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"particle-emitter\", \"particle-emitter\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"networked-drawing-buffer\", \"networked-drawing-buffer\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"audio-settings\", \"audio-settings\", (el, _componentName, componentData) => {\n  const removeUndefined = obj => {\n    return Object.entries(obj).reduce((result, [key, value]) => {\n      if (value !== undefined) {\n        result[key] = value;\n      }\n      return result;\n    }, {});\n  };\n  // TODO: This component should only overwrite the scene audio defaults if this\n  //       component is on the scene node. If this component is on some other node\n  //       we don't care about it and should ignore it.\n  APP.sceneAudioDefaults.set(\n    SourceType.MEDIA_VIDEO,\n    removeUndefined({\n      distanceModel: componentData.mediaDistanceModel,\n      rolloffFactor: componentData.mediaRolloffFactor,\n      refDistance: componentData.mediaRefDistance,\n      maxDistance: componentData.mediaMaxDistance,\n      coneInnerAngle: componentData.mediaConeInnerAngle,\n      coneOuterAngle: componentData.mediaConeOuterAngle,\n      coneOuterGain: componentData.mediaConeOuterGain,\n      gain: componentData.mediaVolume\n    })\n  );\n  APP.sceneAudioDefaults.set(\n    SourceType.AVATAR_AUDIO_SOURCE,\n    removeUndefined({\n      distanceModel: componentData.avatarDistanceModel,\n      rolloffFactor: componentData.avatarRolloffFactor,\n      refDistance: componentData.avatarRefDistance,\n      maxDistance: componentData.avatarMaxDistance,\n      coneInnerAngle: componentData.avatarConeInnerAngle,\n      coneOuterAngle: componentData.avatarConeOuterAngle,\n      coneOuterGain: componentData.avatarConeOuterGain,\n      gain: componentData.avatarVolume\n    })\n  );\n  for (const [el, audio] of APP.audios.entries()) {\n    updateAudioSettings(el, audio);\n  }\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"video-texture-target\",\n  \"video-texture-target\",\n  (el, componentName, componentData, _components, indexToEntityMap) => {\n    const { targetBaseColorMap, targetEmissiveMap, srcNode } = componentData;\n\n    let srcEl;\n    if (srcNode !== undefined) {\n      // indexToEntityMap should be considered depredcated. These references are now resovled by the GLTFHubsComponentExtension\n      if (typeof srcNode === \"number\") {\n        srcEl = indexToEntityMap[srcNode];\n      } else {\n        srcEl = srcNode?.el;\n      }\n      if (!srcEl) {\n        console.warn(\n          `Error inflating gltf component \"video-texture-srcEl\": Couldn't find srcEl entity with index ${srcNode}`\n        );\n      }\n    }\n\n    el.setAttribute(componentName, {\n      src: srcEl ? \"el\" : \"\",\n      targetBaseColorMap,\n      targetEmissiveMap,\n      srcEl\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"video-texture-source\", \"video-texture-source\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"text\", \"text\");\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"audio-target\",\n  \"audio-target\",\n  (el, componentName, componentData, _components, indexToEntityMap) => {\n    const { srcNode } = componentData;\n\n    let srcEl;\n    if (srcNode !== undefined) {\n      // indexToEntityMap should be considered depredcated. These references are now resovled by the GLTFHubsComponentExtension\n      if (typeof srcNode === \"number\") {\n        srcEl = indexToEntityMap[srcNode];\n      } else {\n        srcEl = srcNode?.el;\n      }\n      if (!srcEl) {\n        console.warn(\n          `Error inflating gltf component ${componentName}: Couldn't find srcEl entity with index ${srcNode}`\n        );\n      }\n    }\n\n    if (componentData.positional !== undefined) {\n      // This is an old version of the audio-target component, which had built-in audio parameters.\n      // The way we are handling it is wrong. If a user created a scene in spoke with this old version\n      // of this component, all of these parameters will be present whether the user explicitly set\n      // the values for them or not. But really, they should only count as \"overrides\" if the user\n      // meant for them to take precendence over the app and scene defaults.\n      // TODO: Fix this issue. One option is to just ignore this component data, which might break old scenes\n      //       but simplifying the handling. Another option is to compare the component data here with\n      //       the \"defaults\" and only save the values that are different from the defaults. However,\n      //       this loses information if the user changed the scene settings but wanted this specific\n      //       node to use the \"defaults\".\n      //       I don't see a perfect solution here and would prefer not to handle the \"legacy\" components.\n      APP.audioOverrides.set(el, {\n        audioType: componentData.positional ? AudioType.PannerNode : AudioType.Stereo,\n        distanceModel: componentData.distanceModel,\n        rolloffFactor: componentData.rolloffFactor,\n        refDistance: componentData.refDistance,\n        maxDistance: componentData.maxDistance,\n        coneInnerAngle: componentData.coneInnerAngle,\n        coneOuterAngle: componentData.coneOuterAngle,\n        coneOuterGain: componentData.coneOuterGain,\n        gain: componentData.gain\n      });\n      APP.sourceType.set(el, SourceType.AUDIO_TARGET);\n\n      const audio = APP.audios.get(el);\n      if (audio) {\n        updateAudioSettings(el, audio);\n      }\n    }\n\n    el.setAttribute(componentName, {\n      minDelay: componentData.minDelay,\n      maxDelay: componentData.maxDelay,\n      debug: componentData.debug,\n      srcEl\n    });\n  }\n);\nAFRAME.GLTFModelPlus.registerComponent(\"zone-audio-source\", \"zone-audio-source\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"audio-params\", \"audio-params\", (el, componentName, componentData) => {\n  APP.audioOverrides.set(el, componentData);\n  const audio = APP.audios.get(el);\n  if (audio) {\n    updateAudioSettings(el, audio);\n  }\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"audio-zone\", \"audio-zone\", (el, componentName, componentData) => {\n  el.setAttribute(componentName, { ...componentData });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"background\", \"background\", (el, _componentName, componentData) => {\n  console.warn(\n    \"The `background` component is deprecated, use `backgroundColor` on the `environment-settings` component instead.\"\n  );\n  // This assumes the background component is on the root entity, which it is for spoke, the only thing using this component\n  el.setAttribute(\"environment-settings\", { backgroundColor: new THREE.Color(componentData.color) });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"fog\", \"fog\", (el, _componentName, componentData) => {\n  // TODO need to actually implement this in blender exporter before showing this warning\n  // console.warn(\n  //   \"The `fog` component is deprecated, use the fog properties on the `environment-settings` component instead.\"\n  // );\n  // This assumes the fog component is on the root entitycoco\n  el.setAttribute(\"environment-settings\", {\n    fogType: componentData.type,\n    fogColor: new THREE.Color(componentData.color),\n    fogNear: componentData.near,\n    fogFar: componentData.far,\n    fogDensity: componentData.density\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"environment-settings\",\n  \"environment-settings\",\n  (el, componentName, componentData) => {\n    // TODO a bit silly to be storing this as an aframe component. Use a glboal store of some sort\n    el.setAttribute(componentName, {\n      ...componentData,\n      backgroundColor: new THREE.Color(componentData.backgroundColor)\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"reflection-probe\", \"reflection-probe\", (el, componentName, componentData) => {\n  // TODO PMREMGenerator should be fixed to not assume this\n  componentData.envMapTexture.flipY = true;\n  // Assume texture is always an equirect for now\n  componentData.envMapTexture.mapping = THREE.EquirectangularReflectionMapping;\n\n  el.setAttribute(componentName, componentData);\n});","import { addComponent, removeComponent } from \"bitecs\";\nimport {\n  RemoteRight,\n  RemoteLeft,\n  HandRight,\n  HandLeft,\n  RemoteHoverTarget,\n  NotRemoteHoverTarget,\n  RemoveNetworkedEntityButton,\n  DestroyAtExtremeDistance\n} from \"./bit-components\";\n\n[\n  [\"remote-right\", RemoteRight],\n  [\"remote-left\", RemoteLeft],\n  [\"hand-right\", HandRight],\n  [\"hand-left\", HandLeft],\n  [\"is-remote-hover-target\", RemoteHoverTarget],\n  [\"is-not-remote-hover-target\", NotRemoteHoverTarget],\n  [\"remove-networked-object-button\", RemoveNetworkedEntityButton],\n  [\"destroy-at-extreme-distances\", DestroyAtExtremeDistance]\n].forEach(([aframeComponentName, bitecsComponent]) => {\n  AFRAME.registerComponent(aframeComponentName, {\n    init: function() {\n      addComponent(APP.world, bitecsComponent, this.el.object3D.eid);\n    },\n    remove: function() {\n      removeComponent(APP.world, bitecsComponent, this.el.object3D.eid);\n    }\n  });\n});\n","import * as bitecs from \"bitecs\";\nimport { addEntity, createWorld } from \"bitecs\";\nimport \"./aframe-to-bit-components\";\nimport { AEntity, Networked, Object3DTag, Owned } from \"./bit-components\";\nimport MediaSearchStore from \"./storage/media-search-store\";\nimport Store from \"./storage/store\";\nimport qsTruthy from \"./utils/qs_truthy\";\n\nwindow.$B = bitecs;\n\nconst timeSystem = world => {\n  const { time } = world;\n  const now = performance.now();\n  const delta = now - time.then;\n  time.delta = delta;\n  time.elapsed += delta;\n  time.then = now;\n  time.tick++;\n  return world;\n};\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n    this.hubChannel = null;\n    this.mediaDevicesManager = null;\n\n    // TODO: Remove comments\n    // TODO: Rename or reconfigure these as needed\n    this.audios = new Map(); //                           el -> (THREE.Audio || THREE.PositionalAudio)\n    this.sourceType = new Map(); //                       el -> SourceType\n    this.audioOverrides = new Map(); //                   el -> AudioSettings\n    this.zoneOverrides = new Map(); //                    el -> AudioSettings\n    this.audioDebugPanelOverrides = new Map(); // SourceType -> AudioSettings\n    this.sceneAudioDefaults = new Map(); //       SourceType -> AudioSettings\n    this.gainMultipliers = new Map(); //                  el -> Number\n    this.supplementaryAttenuation = new Map(); //         el -> Number\n    this.clippingState = new Set();\n    this.mutedState = new Set();\n    this.isAudioPaused = new Set();\n\n    this.world = createWorld();\n\n    // TODO: Create accessor / update methods for these maps / set\n    this.world.eid2obj = new Map(); // eid -> Object3D\n\n    this.world.nid2eid = new Map();\n    this.world.deletedNids = new Set();\n    this.world.ignoredNids = new Set();\n\n    this.str2sid = new Map([[null, 0]]);\n    this.sid2str = new Map([[0, null]]);\n    this.nextSid = 1;\n\n    window.$o = eid => {\n      this.world.eid2obj.get(eid);\n    };\n\n    // reserve entity 0 to avoid needing to check for undefined everywhere eid is checked for existance\n    addEntity(this.world);\n\n    // used in aframe and networked aframe to avoid imports\n    this.world.nameToComponent = {\n      object3d: Object3DTag,\n      networked: Networked,\n      owned: Owned,\n      AEntity\n    };\n  }\n\n  // TODO nothing ever cleans these up\n  getSid(str) {\n    if (!this.str2sid.has(str)) {\n      const sid = this.nextSid;\n      this.nextSid = this.nextSid + 1;\n      this.str2sid.set(str, sid);\n      this.sid2str.set(sid, str);\n      return sid;\n    }\n    return this.str2sid.get(str);\n  }\n\n  getString(sid) {\n    return this.sid2str.get(sid);\n  }\n\n  // This gets called by a-scene to setup the renderer, camera, and audio listener\n  // TODO ideally the contorl flow here would be inverted, and we would setup this stuff,\n  // initialize aframe, and then run our own RAF loop\n  setupRenderer(sceneEl) {\n    const canvas = document.createElement(\"canvas\");\n    canvas.classList.add(\"a-canvas\");\n    canvas.dataset.aframeCanvas = true;\n\n    // TODO this comes from aframe and prevents zoom on ipad.\n    // This should alreeady be handleed by disable-ios-zoom but it does not appear to work\n    canvas.addEventListener(\"touchmove\", function(event) {\n      event.preventDefault();\n    });\n\n    const renderer = new THREE.WebGLRenderer({\n      // TODO we should not be using alpha: false https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#avoid_alphafalse_which_can_be_expensive\n      alpha: true,\n      antialias: true,\n      depth: true,\n      stencil: true,\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: false,\n      logarithmicDepthBuffer: false,\n      // TODO we probably want high-performance\n      powerPreference: \"high-performance\",\n      canvas\n    });\n\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    renderer.debug.checkShaderErrors = qsTruthy(\"checkShaderErrors\");\n\n    // These get overridden by environment-system but setting to the highly expected defaults to avoid any extra work\n    renderer.physicallyCorrectLights = true;\n    renderer.outputEncoding = THREE.sRGBEncoding;\n\n    sceneEl.appendChild(renderer.domElement);\n\n    const camera = new THREE.PerspectiveCamera(80, window.innerWidth / window.innerHeight, 0.05, 10000);\n\n    const audioListener = new THREE.AudioListener();\n    APP.audioListener = audioListener;\n    camera.add(audioListener);\n\n    const renderClock = new THREE.Clock();\n\n    // TODO NAF currently depends on this, it should not\n    sceneEl.clock = renderClock;\n\n    // TODO we should have 1 source of truth for time\n    APP.world.time = {\n      delta: 0,\n      elapsed: 0,\n      then: performance.now(),\n      tick: 0\n    };\n\n    APP.world.scene = sceneEl.object3D;\n\n    // Main RAF loop\n    function mainTick(_rafTime, xrFrame) {\n      // TODO we should probably be using time from the raf loop itself\n      const delta = renderClock.getDelta() * 1000;\n      const time = renderClock.elapsedTime * 1000;\n\n      // TODO pass this into systems that care about it (like input) once they are moved into this loop\n      sceneEl.frame = xrFrame;\n\n      timeSystem(APP.world);\n\n      // Tick AFrame systems and components\n      if (sceneEl.isPlaying) {\n        sceneEl.tick(time, delta);\n      }\n\n      renderer.render(sceneEl.object3D, camera);\n    }\n\n    // This gets called after all system and component init functions\n    sceneEl.addEventListener(\"loaded\", () => {\n      renderer.setAnimationLoop(mainTick);\n      sceneEl.renderStarted = true;\n    });\n\n    return {\n      renderer,\n      camera,\n      audioListener\n    };\n  }\n}\n","import pinnedEntityToGltf from \"./pinned-entity-to-gltf\";\nimport { getPromotionTokenForFile } from \"./media-utils\";\nimport { SignInMessages } from \"../react-components/auth/SignInModal\";\n\nexport default class PinningHelper {\n  constructor(hubChannel, authChannel, store, performConditionalSignIn) {\n    this.hubChannel = hubChannel;\n    this.authChannel = authChannel;\n    this.store = store;\n    this.performConditionalSignIn = performConditionalSignIn;\n  }\n\n  async setPinned(el, pin) {\n    if (NAF.utils.isMine(el)) {\n      this._signInAndPinOrUnpinElement(el, pin);\n    } else {\n      console.warn(\"PinningHelper: Attempted to set pin state on object that was not mine.\");\n    }\n  }\n\n  _signInAndPinOrUnpinElement = (el, pin) => {\n    const action = pin ? () => this._pinElement(el) : () => this.unpinElement(el);\n\n    this.performConditionalSignIn(\n      () => this.hubChannel.signedIn,\n      action,\n      pin ? SignInMessages.pin : SignInMessages.unpin,\n      e => {\n        console.warn(`PinningHelper: Conditional sign-in failed. ${e}`);\n      }\n    );\n  };\n\n  async _pinElement(el) {\n    const { networkId } = el.components.networked.data;\n\n    const { fileId, src } = el.components[\"media-loader\"].data;\n    let fileAccessToken, promotionToken;\n    if (fileId) {\n      fileAccessToken = new URL(src).searchParams.get(\"token\");\n      const storedPromotionToken = getPromotionTokenForFile(fileId);\n      if (storedPromotionToken) {\n        promotionToken = storedPromotionToken.promotionToken;\n      }\n    }\n\n    const gltfNode = pinnedEntityToGltf(el);\n    if (!gltfNode) {\n      console.warn(\"PinningHelper: Entity did not produce a GLTF node.\");\n      return;\n    }\n    el.setAttribute(\"networked\", { persistent: true });\n    el.setAttribute(\"media-loader\", { fileIsOwned: true });\n\n    try {\n      await this.hubChannel.pin(networkId, gltfNode, fileId, fileAccessToken, promotionToken);\n\n      // If we lost ownership of the entity while waiting for the pin to go through,\n      // try to regain ownership before setting the \"pinned\" state.\n      if (!NAF.utils.isMine(el) && !NAF.utils.takeOwnership(el)) {\n        console.warn(\"PinningHelper: Pinning succeeded, but ownership was lost in the mean time\");\n      }\n\n      el.setAttribute(\"pinnable\", \"pinned\", true);\n      el.emit(\"pinned\", { el });\n      this.store.update({ activity: { hasPinned: true } });\n    } catch (e) {\n      if (e.reason === \"invalid_token\") {\n        await this.authChannel.signOut(this.hubChannel);\n        this._signInAndPinOrUnpinElement(el);\n      } else {\n        console.warn(\"PinningHelper: Pin failed for unknown reason\", e);\n      }\n    }\n  }\n\n  unpinElement(el) {\n    const components = el.components;\n    const networked = components.networked;\n\n    if (!networked || !networked.data || !NAF.utils.isMine(el)) {\n      console.warn(\"PinningHelper: Tried to unpin element that is not networked or not mine.\");\n      return;\n    }\n\n    const networkId = components.networked.data.networkId;\n    el.setAttribute(\"networked\", { persistent: false });\n\n    const mediaLoader = components[\"media-loader\"];\n    const fileId = mediaLoader.data && mediaLoader.data.fileId;\n\n    this.hubChannel.unpin(networkId, fileId);\n    el.setAttribute(\"pinnable\", \"pinned\", false);\n    el.emit(\"unpinned\", { el });\n  }\n}\n","export default function pinnedEntityToGltf(el) {\n  if (!NAF.utils.isMine(el)) return;\n\n  // Construct a GLTF node from this entity\n  const object3D = el.object3D;\n  const components = el.components;\n  const networkId = components.networked.data.networkId;\n\n  const gltfComponents = {};\n  // TODO: Move to MOZ_hubs_components and include version number. Requires migration of existing room objects.\n  // Please do this before making a breaking change to the data stored here.\n  const gltfNode = { name: networkId, extensions: { HUBS_components: gltfComponents } };\n\n  // Adapted from three.js GLTFExporter\n  const equalArray = (x, y) => x.length === y.length && x.every((v, i) => v === y[i]);\n  const rotation = object3D.quaternion.toArray();\n  const position = object3D.position.toArray();\n  const scale = object3D.scale.toArray();\n\n  if (!equalArray(rotation, [0, 0, 0, 1])) gltfNode.rotation = rotation;\n  if (!equalArray(position, [0, 0, 0])) gltfNode.translation = position;\n  if (!equalArray(scale, [1, 1, 1])) gltfNode.scale = scale;\n\n  if (components[\"media-loader\"]) {\n    const mediaSrc = components[\"media-loader\"].data.src;\n    const mediaVersion = components[\"media-loader\"].data.version;\n    const mediaContentSubtype = components[\"media-loader\"].data.contentSubtype;\n\n    if (mediaSrc.startsWith(\"hubs://\") && mediaSrc.endsWith(\"/video\")) {\n      // Do not persist hubs client video urls\n      return null;\n    }\n\n    gltfComponents.media = { src: mediaSrc, version: mediaVersion, contentSubtype: mediaContentSubtype, id: networkId };\n\n    if (components[\"media-pdf\"]) {\n      gltfComponents.media.pageIndex = components[\"media-pdf\"].data.index;\n    }\n\n    if (components[\"media-video\"] && components[\"media-video\"].data.videoPaused) {\n      gltfComponents.media.paused = true;\n      gltfComponents.media.time = components[\"media-video\"].data.time;\n    }\n  }\n\n  gltfComponents.pinnable = { pinned: true };\n\n  return gltfNode;\n}\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"scalable-when-grabbed\", {\n  tick: function() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    let deltaScale;\n    if (interaction.state.rightRemote.held === this.el) {\n      deltaScale = userinput.get(paths.actions.cursor.right.scaleGrabbedGrabbable);\n    }\n    if (interaction.state.leftRemote.held === this.el) {\n      deltaScale = userinput.get(paths.actions.cursor.left.scaleGrabbedGrabbable);\n    }\n    if (!deltaScale) return;\n\n    this.el.object3D.scale.addScalar(deltaScale).clampScalar(0.1, 100);\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { paths } from \"../../systems/userinput/paths\";\nimport { getLastWorldPosition, getLastWorldQuaternion } from \"../../utils/three-utils\";\nimport {\n  SOUND_PEN_START_DRAW,\n  SOUND_PEN_STOP_DRAW,\n  SOUND_PEN_UNDO_DRAW,\n  SOUND_PEN_CHANGE_COLOR\n} from \"../../systems/sound-effects-system\";\nimport { waitForDOMContentLoaded } from \"../../utils/async-utils\";\nimport { convertStandardMaterial } from \"../../utils/material-utils\";\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    startDrawing: paths.actions.rightHand.startDrawing,\n    stopDrawing: paths.actions.rightHand.stopDrawing,\n    undoDrawing: paths.actions.rightHand.undoDrawing,\n    switchDrawMode: paths.actions.rightHand.switchDrawMode,\n    penNextColor: paths.actions.rightHand.penNextColor,\n    penPrevColor: paths.actions.rightHand.penPrevColor,\n    scalePenTip: paths.actions.rightHand.scalePenTip\n  },\n  \"player-left-controller\": {\n    startDrawing: paths.actions.leftHand.startDrawing,\n    stopDrawing: paths.actions.leftHand.stopDrawing,\n    undoDrawing: paths.actions.leftHand.undoDrawing,\n    switchDrawMode: paths.actions.leftHand.switchDrawMode,\n    penNextColor: paths.actions.leftHand.penNextColor,\n    penPrevColor: paths.actions.leftHand.penPrevColor,\n    scalePenTip: paths.actions.leftHand.scalePenTip\n  },\n  \"right-cursor\": {\n    pose: paths.actions.cursor.right.pose,\n    startDrawing: paths.actions.cursor.right.startDrawing,\n    stopDrawing: paths.actions.cursor.right.stopDrawing,\n    undoDrawing: paths.actions.cursor.right.undoDrawing,\n    penNextColor: paths.actions.cursor.right.penNextColor,\n    penPrevColor: paths.actions.cursor.right.penPrevColor,\n    scalePenTip: paths.actions.cursor.right.scalePenTip\n  },\n  \"left-cursor\": {\n    pose: paths.actions.cursor.left.pose,\n    startDrawing: paths.actions.cursor.left.startDrawing,\n    stopDrawing: paths.actions.cursor.left.stopDrawing,\n    undoDrawing: paths.actions.cursor.left.undoDrawing,\n    penNextColor: paths.actions.cursor.left.penNextColor,\n    penPrevColor: paths.actions.cursor.left.penPrevColor,\n    scalePenTip: paths.actions.cursor.left.scalePenTip\n  }\n};\n\nconst DRAW_MODE = {\n  DEFAULT_3D: 0,\n  PROJECTION: 1\n};\n\nconst MAX_DISTANCE_BETWEEN_SURFACES = 1;\n\n/**\n * Pen tool\n * A tool that allows drawing on networked-drawing components.\n * @namespace drawing\n * @component pen\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen\", {\n  schema: {\n    drawFrequency: { default: 5 }, //frequency of polling for drawing points\n    minDistanceBetweenPoints: { default: 0.01 }, //minimum distance to register new drawing point\n    camera: { type: \"selector\" },\n    drawingManager: { type: \"string\" },\n    color: { type: \"color\", default: \"#FF0033\" },\n    availableColors: {\n      default: [\n        \"#FF0033\",\n        \"#FFFF00\",\n        \"#0099FF\",\n        \"#00FF33\",\n        \"#9900FF\",\n        \"#FF6600\",\n        \"#8D5524\",\n        \"#C68642\",\n        \"#E0AC69\",\n        \"#F1C27D\",\n        \"#FFDBAC\",\n        \"#FFFFFF\",\n        \"#222222\",\n        \"#111111\",\n        \"#000000\"\n      ]\n    },\n    radius: { default: 0.01 }, //drawing geometry radius\n    minRadius: { default: 0.005 },\n    maxRadius: { default: 0.2 },\n    far: { default: 100 },\n    near: { default: 0.01 },\n    drawMode: { default: DRAW_MODE.DEFAULT_3D, oneOf: [DRAW_MODE.DEFAULT_3D, DRAW_MODE.PROJECTION] },\n    penVisible: { default: true },\n    penTipPosition: { default: { x: 0, y: 0, z: 0 } }\n  },\n\n  init() {\n    this.timeSinceLastDraw = 0;\n\n    this.lastPosition = new THREE.Vector3();\n    this.lastPosition.copy(this.el.object3D.position);\n\n    this.direction = new THREE.Vector3(1, 0, 0);\n\n    this.currentDrawing = null;\n\n    this.normal = new THREE.Vector3();\n\n    this.worldPosition = new THREE.Vector3();\n\n    this.colorIndex = 0;\n\n    this.grabbed = false;\n\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n\n    this.originalPosition = this.el.object3D.position.clone();\n    this.lastIntersectionDistance = 0;\n\n    this.targets = [];\n    this.setDirty = this.setDirty.bind(this);\n    this.dirty = true;\n\n    let material = new THREE.MeshStandardMaterial();\n    const quality = window.APP.store.state.preferences.materialQualitySetting;\n    material = convertStandardMaterial(material, quality);\n\n    this.penTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 16, 12), material);\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n\n    this.el.setObject3D(\"mesh\", this.penTip);\n\n    this.penLaserAttributesUpdated = false;\n    this.penLaserAttributes = {\n      color: \"#FF0033\",\n      laserVisible: false,\n      laserInHand: false,\n      laserOrigin: { x: 0, y: 0, z: 0 },\n      remoteLaserOrigin: { x: 0, y: 0, z: 0 },\n      laserTarget: { x: 0, y: 0, z: 0 }\n    };\n\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.setDirty);\n\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.setDirty);\n      scene.addEventListener(\"object3dremove\", this.setDirty);\n    });\n\n    this.penSystem = this.el.sceneEl.systems[\"pen-tools\"];\n    this.penSystem.register(this.el);\n  },\n\n  play() {\n    this.drawingManager = document.querySelector(this.data.drawingManager).components[\"drawing-manager\"];\n  },\n\n  update(prevData) {\n    if (prevData.color != this.data.color) {\n      this.penTip.material.color.set(this.data.color);\n      this.penLaserAttributes.color = this.data.color;\n      this.el.setAttribute(\"pen-laser\", { color: this.data.color });\n    }\n    if (prevData.radius != this.data.radius) {\n      this.el.setAttribute(\"radius\", this.data.radius);\n    }\n\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick(t, dt) {\n    const isMine = this.el.parentEl.components.networked.initialized && this.el.parentEl.components.networked.isMine();\n\n    if (this.penTip.material.visible !== isMine) {\n      this.penTip.material.visible = isMine;\n    }\n\n    if (isMine) {\n      this._handleInput();\n\n      const cursorPose =\n        this.data.drawMode === DRAW_MODE.PROJECTION &&\n        (this.grabberId === \"right-cursor\" || this.grabberId === \"left-cursor\")\n          ? AFRAME.scenes[0].systems.userinput.get(pathsMap[this.grabberId].pose)\n          : null;\n\n      const intersection = this._getIntersection(cursorPose);\n\n      this._updatePenTip(intersection);\n\n      const laserVisible = this.data.drawMode === DRAW_MODE.PROJECTION && !!intersection;\n      const laserInHand = this.el.sceneEl.is(\"vr-mode\") && laserVisible;\n\n      if (this.penLaserAttributes.laserVisible !== laserVisible) {\n        this.penLaserAttributes.laserVisible = laserVisible;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (this.penLaserAttributes.laserInHand !== laserInHand) {\n        this.penLaserAttributes.laserInHand = laserInHand;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (laserVisible) {\n        this._updateLaser(cursorPose, intersection);\n      }\n\n      const penVisible = (this.grabberId !== \"left-cursor\" && this.grabberId !== \"right-cursor\") || !intersection;\n      this._setPenVisible(penVisible);\n      this.el.setAttribute(\"pen\", { penVisible: penVisible });\n\n      this._doDraw(intersection, dt);\n\n      if (this.penLaserAttributesUpdated) {\n        this.penLaserAttributesUpdated = false;\n        this.el.setAttribute(\"pen-laser\", this.penLaserAttributes, true);\n      }\n    } else {\n      this._setPenVisible(this.data.penVisible);\n    }\n  },\n\n  _handleInput() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    if (interaction.state.rightHand.held === this.el.parentNode) {\n      this.grabberId = \"player-right-controller\";\n    } else if (interaction.state.leftHand.held === this.el.parentNode) {\n      this.grabberId = \"player-left-controller\";\n    } else if (interaction.state.rightRemote.held === this.el.parentNode) {\n      this.grabberId = \"right-cursor\";\n      this.data.drawMode = DRAW_MODE.PROJECTION;\n    } else if (interaction.state.leftRemote.held === this.el.parentNode) {\n      this.grabberId = \"left-cursor\";\n      this.data.drawMode = DRAW_MODE.PROJECTION;\n    } else {\n      this.grabberId = null;\n    }\n\n    if (this.grabberId && pathsMap[this.grabberId]) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      const paths = pathsMap[this.grabberId];\n      if (userinput.get(paths.startDrawing)) {\n        this._startDraw();\n        sfx.playSoundOneShot(SOUND_PEN_START_DRAW);\n      }\n      if (userinput.get(paths.stopDrawing)) {\n        this._endDraw();\n        sfx.playSoundOneShot(SOUND_PEN_STOP_DRAW);\n      }\n      const penScaleMod = userinput.get(paths.scalePenTip);\n      if (penScaleMod) {\n        this._changeRadius(penScaleMod);\n      }\n      if (userinput.get(paths.penNextColor)) {\n        this._changeColor(1);\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n      }\n      if (userinput.get(paths.penPrevColor)) {\n        this._changeColor(-1);\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n      }\n      if (userinput.get(paths.undoDrawing)) {\n        this._undoDraw();\n        sfx.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\n      }\n      if (paths.switchDrawMode && userinput.get(paths.switchDrawMode)) {\n        this.data.drawMode = this.data.drawMode === DRAW_MODE.DEFAULT_3D ? DRAW_MODE.PROJECTION : DRAW_MODE.DEFAULT_3D;\n      }\n    }\n  },\n\n  _getIntersection: (() => {\n    const rawIntersections = [];\n    const worldQuaternion = new THREE.Quaternion();\n    return function(cursorPose) {\n      rawIntersections.length = 0;\n\n      if (this.data.drawMode === DRAW_MODE.PROJECTION) {\n        if (cursorPose) {\n          this.raycaster.ray.origin.copy(cursorPose.position);\n          this.raycaster.ray.direction.copy(cursorPose.direction);\n        } else if (this.grabberId !== null) {\n          getLastWorldPosition(this.el.parentEl.object3D, this.raycaster.ray.origin);\n          getLastWorldQuaternion(this.el.parentEl.object3D, worldQuaternion);\n          this.raycaster.ray.direction.set(0, -1, 0);\n          this.raycaster.ray.direction.applyQuaternion(worldQuaternion);\n        }\n\n        if (this.grabberId !== null) {\n          this.raycaster.intersectObjects(this.targets, true, rawIntersections);\n          return rawIntersections[0];\n        }\n      }\n\n      return null;\n    };\n  })(),\n\n  _updatePenTip(intersection) {\n    if (this.data.drawMode === DRAW_MODE.PROJECTION) {\n      if (intersection) {\n        this.el.object3D.position.copy(intersection.point);\n\n        this.el.parentEl.object3D.worldToLocal(this.el.object3D.position);\n\n        this.el.object3D.matrixNeedsUpdate = true;\n        this.worldPosition.copy(intersection.point);\n      } else {\n        this.el.object3D.position.copy(this.originalPosition);\n        this.el.object3D.matrixNeedsUpdate = true;\n        getLastWorldPosition(this.el.object3D, this.worldPosition);\n      }\n    } else {\n      this.el.object3D.position.copy(this.originalPosition);\n      this.el.object3D.matrixNeedsUpdate = true;\n      getLastWorldPosition(this.el.object3D, this.worldPosition);\n    }\n  },\n\n  _updateLaser: (() => {\n    const laserStartPosition = new THREE.Vector3();\n    const laserEndPosition = new THREE.Vector3();\n    const camerWorldPosition = new THREE.Vector3();\n    const remoteLaserOrigin = new THREE.Vector3();\n    return function(cursorPose, intersection) {\n      if (cursorPose) {\n        laserStartPosition.copy(cursorPose.position);\n      } else {\n        this.el.parentEl.object3D.getWorldPosition(laserStartPosition);\n      }\n\n      laserEndPosition.copy(intersection.point);\n\n      if (this.el.sceneEl.is(\"vr-mode\")) {\n        remoteLaserOrigin.copy(laserStartPosition);\n      } else {\n        this.data.camera.object3D.getWorldPosition(camerWorldPosition);\n        remoteLaserOrigin\n          .subVectors(laserEndPosition, camerWorldPosition)\n          .normalize()\n          .multiplyScalar(0.5);\n        remoteLaserOrigin.add(camerWorldPosition);\n      }\n\n      if (!almostEquals(0.001, this.penLaserAttributes.laserOrigin, laserStartPosition)) {\n        this.penLaserAttributes.laserOrigin.x = laserStartPosition.x;\n        this.penLaserAttributes.laserOrigin.y = laserStartPosition.y;\n        this.penLaserAttributes.laserOrigin.z = laserStartPosition.z;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (!almostEquals(0.001, this.penLaserAttributes.remoteLaserOrigin, remoteLaserOrigin)) {\n        this.penLaserAttributes.remoteLaserOrigin.x = remoteLaserOrigin.x;\n        this.penLaserAttributes.remoteLaserOrigin.y = remoteLaserOrigin.y;\n        this.penLaserAttributes.remoteLaserOrigin.z = remoteLaserOrigin.z;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (!almostEquals(0.001, this.penLaserAttributes.laserTarget, laserEndPosition)) {\n        this.penLaserAttributes.laserTarget.x = laserEndPosition.x;\n        this.penLaserAttributes.laserTarget.y = laserEndPosition.y;\n        this.penLaserAttributes.laserTarget.z = laserEndPosition.z;\n        this.penLaserAttributesUpdated = true;\n      }\n    };\n  })(),\n\n  _doDraw(intersection, dt) {\n    //Prevent drawings from \"jumping\" large distances\n    if (\n      this.currentDrawing &&\n      (this.lastIntersectedObject !== (intersection ? intersection.object : null) &&\n        (!intersection ||\n          Math.abs(intersection.distance - this.lastIntersectionDistance) > MAX_DISTANCE_BETWEEN_SURFACES))\n    ) {\n      this.worldPosition.copy(this.lastPosition);\n      this._endDraw();\n    }\n    this.lastIntersectionDistance = intersection ? intersection.distance : 0;\n    this.lastIntersectedObject = intersection ? intersection.object : null;\n\n    if (!almostEquals(0.005, this.worldPosition, this.lastPosition)) {\n      this.direction.subVectors(this.worldPosition, this.lastPosition).normalize();\n      this.lastPosition.copy(this.worldPosition);\n    }\n\n    if (this.currentDrawing) {\n      const time = this.timeSinceLastDraw + dt;\n      if (\n        time >= this.data.drawFrequency &&\n        this.currentDrawing.getLastPoint().distanceTo(this.worldPosition) >= this.data.minDistanceBetweenPoints\n      ) {\n        this._getNormal(this.normal, this.worldPosition, this.direction);\n        this.currentDrawing.draw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n      }\n\n      this.timeSinceLastDraw = time % this.data.drawFrequency;\n    }\n\n    if (this.currentDrawing && !this.grabberId) {\n      this._endDraw();\n    }\n\n    if (this.dirty) {\n      this.populateEntities(this.targets);\n      this.dirty = false;\n    }\n  },\n\n  _setPenVisible(visible) {\n    if (this.el.parentEl.object3DMap.mesh && this.el.parentEl.object3DMap.mesh.visible !== visible) {\n      this.el.parentEl.object3DMap.mesh.visible = visible;\n    }\n  },\n\n  //helper function to get normal of direction of drawing cross direction to camera\n  _getNormal: (() => {\n    const directionToCamera = new THREE.Vector3();\n    return function(normal, position, direction) {\n      directionToCamera.subVectors(position, this.data.camera.object3D.position).normalize();\n      normal.crossVectors(direction, directionToCamera);\n    };\n  })(),\n\n  _startDraw() {\n    this.drawingManager.getDrawing(this).then(drawing => {\n      this.currentDrawing = drawing;\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.startDraw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n    });\n  },\n\n  _endDraw() {\n    if (this.currentDrawing) {\n      this.timeSinceLastDraw = 0;\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.endDraw(this.worldPosition, this.direction, this.normal);\n      this.drawingManager.returnDrawing(this);\n      this.currentDrawing = null;\n    }\n  },\n\n  _undoDraw() {\n    this.drawingManager.getDrawing(this).then(drawing => {\n      drawing.undoDraw();\n      this.drawingManager.returnDrawing(this);\n    });\n  },\n\n  _changeColor(mod) {\n    this.colorIndex = (this.colorIndex + mod + this.data.availableColors.length) % this.data.availableColors.length;\n    this.data.color = this.data.availableColors[this.colorIndex];\n    this.penTip.material.color.set(this.data.color);\n    this.penLaserAttributes.color = this.data.color;\n    this.penLaserAttributesUpdated = true;\n  },\n\n  _changeRadius(mod) {\n    this.data.radius = Math.max(this.data.minRadius, Math.min(this.data.radius + mod, this.data.maxRadius));\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n  },\n\n  setDirty() {\n    this.dirty = true;\n  },\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, #environment-root\");\n    for (let i = 0; i < els.length; i++) {\n      if (!els[i].classList.contains(\"pen\") && els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n  },\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\n    this.penSystem.deregister(this.el);\n  }\n});\n","const InterpolationBuffer = require(\"buffered-interpolation\");\nimport { convertStandardMaterial } from \"../../utils/material-utils\";\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen-laser\", {\n  schema: {\n    color: { type: \"color\", default: \"#FF0033\" },\n    laserVisible: { default: false },\n    laserInHand: { default: false },\n    laserOrigin: { default: { x: 0, y: 0, z: 0 } },\n    remoteLaserOrigin: { default: { x: 0, y: 0, z: 0 } },\n    laserTarget: { default: { x: 0, y: 0, z: 0 } }\n  },\n\n  init() {\n    let material = new THREE.MeshStandardMaterial({ color: \"red\", opacity: 0.5, transparent: true, visible: true });\n    const quality = window.APP.store.state.preferences.materialQualitySetting;\n    material = convertStandardMaterial(material, quality);\n\n    const tipMaterial = material.clone();\n\n    const lineCurve = new THREE.LineCurve3(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 2));\n    const geometry = new THREE.TubeBufferGeometry(lineCurve, 2, 0.003, 8, true);\n    this.laser = new THREE.Mesh(geometry, material);\n\n    this.laserTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 8, 6), tipMaterial);\n    this.laserTip.scale.setScalar(0.01);\n    this.laserTip.matrixNeedsUpdate = true;\n\n    //prevents the line from being a raycast target for the cursor\n    this.laser.raycast = function() {};\n\n    this.el.sceneEl.setObject3D(`pen-laser-${this.laser.uuid}`, this.laser);\n    this.el.sceneEl.setObject3D(`pen-laser-tip-${this.laser.uuid}`, this.laserTip);\n\n    this.originBuffer = new InterpolationBuffer(InterpolationBuffer.MODE_LERP, 0.1);\n    this.targetBuffer = new InterpolationBuffer(InterpolationBuffer.MODE_LERP, 0.1);\n  },\n\n  update: (() => {\n    const originBufferPosition = new THREE.Vector3();\n    const targetBufferPosition = new THREE.Vector3();\n\n    return function(prevData) {\n      if (prevData.color != this.data.color) {\n        this.laser.material.color.set(this.data.color);\n        this.laserTip.material.color.set(this.data.color);\n      }\n\n      if (prevData.remoteLaserOrigin && !almostEquals(0.001, prevData.remoteLaserOrigin, this.data.remoteLaserOrigin)) {\n        this.originBuffer.setPosition(\n          originBufferPosition.set(\n            this.data.remoteLaserOrigin.x,\n            this.data.remoteLaserOrigin.y,\n            this.data.remoteLaserOrigin.z\n          )\n        );\n      }\n\n      if (prevData.laserTarget && !almostEquals(0.001, prevData.laserTarget, this.data.laserTarget)) {\n        this.targetBuffer.setPosition(\n          targetBufferPosition.set(this.data.laserTarget.x, this.data.laserTarget.y, this.data.laserTarget.z)\n        );\n      }\n    };\n  })(),\n\n  tick: (() => {\n    const origin = new THREE.Vector3();\n    const target = new THREE.Vector3();\n    return function(t, dt) {\n      const isMine =\n        this.el.parentEl.components.networked.initialized && this.el.parentEl.components.networked.isMine();\n      let laserVisible = false;\n\n      if (isMine && this.data.laserVisible) {\n        origin.copy(this.data.laserOrigin);\n\n        if (!this.data.laserInHand) {\n          // On 2d mode, shift downards\n          origin.y = origin.y - 0.4;\n        }\n\n        target.copy(this.data.laserTarget);\n        laserVisible = true;\n      } else if (!isMine && this.data.laserVisible) {\n        this.originBuffer.update(dt);\n        this.targetBuffer.update(dt);\n        origin.copy(this.originBuffer.getPosition());\n        target.copy(this.targetBuffer.getPosition());\n        laserVisible = true;\n      }\n\n      if (laserVisible) {\n        this.laser.position.copy(origin);\n        this.laser.lookAt(target);\n        this.laser.scale.set(1, 1, origin.distanceTo(target));\n        this.laser.matrixNeedsUpdate = true;\n        this.laserTip.position.copy(target);\n        this.laserTip.matrixNeedsUpdate = true;\n      }\n\n      if (this.laser.material.visible !== laserVisible) {\n        this.laser.material.visible = laserVisible;\n      }\n\n      const laserTipVisible = laserVisible ? !(isMine && this.data.laserVisible) : false;\n      if (this.laserTip.material.visible !== laserTipVisible) {\n        this.laserTip.material.visible = laserTipVisible;\n      }\n    };\n  })(),\n\n  remove() {\n    this.el.sceneEl.removeObject3D(`pen-laser-${this.laser.uuid}`);\n    this.el.sceneEl.removeObject3D(`pen-laser-tip-${this.laser.uuid}`);\n  }\n});\n","export default class SharedBufferGeometry {\n  constructor(material, maxBufferSize) {\n    this.material = material;\n\n    this.maxBufferSize = maxBufferSize;\n    this.geometries = [];\n    this.current = null;\n    this.drawing = new THREE.Object3D();\n    this.addBuffer();\n  }\n\n  remove(prevIdx, idx) {\n    // Loop through all the attributes: position, color, normal,...\n    if (this.idx.position > idx.position) {\n      for (const key in this.idx) {\n        const componentSize = key === \"index\" ? 1 : 3;\n        let pos = prevIdx[key] * componentSize;\n        const start = (idx[key] + 1) * componentSize;\n        const end = this.idx[key] * componentSize;\n        for (let i = start; i < end; i++) {\n          if (key === \"index\") {\n            //index needs to be handled specially\n            this.current.index.array[pos++] = this.current.index.array[i] - idx.position - 1;\n          } else {\n            this.current.attributes[key].array[pos++] = this.current.attributes[key].array[i];\n          }\n        }\n        const diff = idx[key] - prevIdx[key] + 1;\n        this.idx[key] -= diff;\n      }\n    } else {\n      for (const key in this.idx) {\n        const diff = idx[key] - prevIdx[key];\n        this.idx[key] -= diff;\n      }\n    }\n\n    this.update();\n  }\n\n  undo(prevIdx) {\n    this.idx = prevIdx;\n    this.update();\n  }\n\n  addBuffer() {\n    const geometry = new THREE.BufferGeometry();\n\n    const vertices = new Float32Array(this.maxBufferSize * 3);\n    const normals = new Float32Array(this.maxBufferSize * 3);\n    const colors = new Float32Array(this.maxBufferSize * 3);\n    const indices = new Uint32Array(this.maxBufferSize * 3);\n\n    const mesh = new THREE.Mesh(geometry, this.material);\n\n    mesh.frustumCulled = false;\n    mesh.vertices = vertices;\n\n    const object3D = new THREE.Object3D();\n    this.drawing.add(object3D);\n    object3D.add(mesh);\n\n    geometry.setDrawRange(0, 0);\n    geometry.setAttribute(\"position\", new THREE.BufferAttribute(vertices, 3).setUsage(THREE.DynamicDrawUsage));\n    geometry.setAttribute(\"normal\", new THREE.BufferAttribute(normals, 3).setUsage(THREE.DynamicDrawUsage));\n    geometry.setAttribute(\"color\", new THREE.BufferAttribute(colors, 3).setUsage(THREE.DynamicDrawUsage));\n    geometry.setIndex(new THREE.BufferAttribute(indices, 1).setUsage(THREE.DynamicDrawUsage));\n\n    this.previous = null;\n    if (this.geometries.length > 0) {\n      this.previous = this.current;\n    }\n\n    this.idx = {\n      position: 0,\n      normal: 0,\n      color: 0,\n      index: 0\n    };\n\n    this.geometries.push(geometry);\n    this.current = geometry;\n  }\n\n  addColor(r, g, b) {\n    this.current.attributes.color.setXYZ(this.idx.color++, r, g, b);\n  }\n\n  addNormal(x, y, z) {\n    this.current.attributes.normal.setXYZ(this.idx.normal++, x, y, z);\n  }\n\n  addVertex(x, y, z) {\n    const buffer = this.current.attributes.position;\n    if (this.idx.position === buffer.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    }\n    buffer.setXYZ(this.idx.position++, x, y, z);\n  }\n\n  addIndex(a, b, c) {\n    this.current.index.setXYZ(this.idx.index, a, b, c);\n    this.idx.index += 3;\n  }\n\n  update() {\n    this.current.setDrawRange(0, this.idx.index);\n\n    this.current.attributes.color.needsUpdate = true;\n    this.current.attributes.normal.needsUpdate = true;\n    this.current.attributes.position.needsUpdate = true;\n    this.current.index.needsUpdate = true;\n  }\n\n  computeBoundingSpheres() {\n    for (let i = 0; i < this.geometries.length; i++) {\n      this.geometries[i].computeBoundingSphere();\n    }\n  }\n}\n","import SharedBufferGeometry from \"./sharedbuffergeometry\";\n\nexport default class SharedBufferGeometryManager {\n  constructor() {\n    this.sharedBuffers = {};\n  }\n\n  addSharedBuffer(name, material, maxBufferSize) {\n    this.sharedBuffers[name] = new SharedBufferGeometry(material, maxBufferSize);\n  }\n\n  getSharedBuffer(name) {\n    return this.sharedBuffers[name];\n  }\n}\n","/* global THREE */\n/**\n * Networked Drawing\n * Creates procedurally generated 'lines' (or tubes) that are networked.\n * @namespace drawing\n * @component networked-drawing\n */\n\nimport SharedBufferGeometryManager from \"../../utils/sharedbuffergeometrymanager\";\nimport { GLTFExporter } from \"three/examples/jsm/exporters/GLTFExporter\";\nimport { convertStandardMaterial } from \"../../utils/material-utils\";\nimport { addMedia, addMeshScaleAnimation } from \"../../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../../object-types\";\nimport { SOUND_PEN_START_DRAW } from \"../../systems/sound-effects-system\";\n\nconst MSG_CONFIRM_CONNECT = 0;\nconst MSG_BUFFER_DATA = 1;\nconst MSG_BUFFER_DATA_FULL = 2;\n\nfunction copyData(fromArray, toArray, fromIndex, toIndex) {\n  let i = fromIndex - 1;\n  let j = -1;\n  while (i + 1 <= toIndex) {\n    toArray[++j] = fromArray[++i];\n  }\n}\n\nAFRAME.registerComponent(\"networked-drawing\", {\n  schema: {\n    segments: { default: 8 }, //the number of \"sides\" the procedural tube should have\n    defaultRadius: { default: 0.01 }, //the radius of the procedural tube\n    maxDrawTimeout: { default: 600000 }, //the maximum time a drawn line will live\n    maxLines: { default: 50 }, //how many lines can persist before lines older than minDrawTime are removed\n    maxPointsPerLine: { default: 250 } //the max number of points a single line can have\n  },\n\n  init() {\n    this._receiveData = this._receiveData.bind(this);\n\n    this.networkBuffer = [];\n\n    this.sendNetworkBufferQueue = [];\n\n    this.drawStarted = false;\n    this.lineStarted = false;\n    this.remoteLineStarted = false;\n\n    this.receivedBufferParts = 0;\n    this.bufferIndex = 0;\n    this.connectedToOwner = false;\n    this.networkBufferInitialized = false;\n\n    const options = {\n      vertexColors: true\n    };\n\n    this.color = new THREE.Color();\n    this.radius = this.data.defaultRadius;\n    this.segments = this.data.segments;\n\n    let material = new THREE.MeshStandardMaterial(options);\n\n    const quality = window.APP.store.state.preferences.materialQualitySetting;\n    material = convertStandardMaterial(material, quality);\n\n    this.sharedBufferGeometryManager = new SharedBufferGeometryManager();\n    // NOTE: 20 is approximate for how many floats per point are added.\n    // maxLines + 1 because a line can be currently drawing while at maxLines.\n    // Multiply by 1/3 (0.333) because 3 floats per vertex (x, y, z).\n    const maxBufferSize = Math.round(this.data.maxPointsPerLine * 20 * (this.data.maxLines + 1) * 0.333);\n    this.sharedBufferGeometryManager.addSharedBuffer(0, material, maxBufferSize);\n\n    this.lastPoint = new THREE.Vector3();\n\n    this.lastSegments = [];\n    this.currentSegments = [];\n    for (let x = 0; x < this.segments; x++) {\n      this.lastSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n      this.currentSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n    }\n\n    this.sharedBuffer = this.sharedBufferGeometryManager.getSharedBuffer(0);\n    this.drawing = this.sharedBuffer.drawing;\n\n    this.el.setObject3D(\"mesh\", this.drawing);\n\n    this.prevIdx = Object.assign({}, this.sharedBuffer.idx);\n    this.idx = Object.assign({}, this.sharedBuffer.idx);\n    this.vertexCount = 0; //number of vertices added for current line (used for line deletion).\n    this.indexCount = 0; //number of indexes added for current line (used for line deletion);\n    this.networkBufferCount = 0; //number of items added to networkBuffer for current line (used for line deletion).\n    this.currentPointCount = 0; //number of points added for current line (used for maxPointsPerLine).\n    this.invalidPointRead = false; //flag flipped if we read a bad point anywhere during this line\n    this.lastReadPointCount = 0; //last read point count read off of the network, used for sanity checking\n    this.networkBufferHistory = []; //tracks vertexCount and networkBufferCount so that lines can be deleted.\n\n    NAF.connection.onConnect(() => {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkId = NAF.utils.getNetworkId(this.networkedEl);\n        this.drawingId = \"drawing-\" + this.networkId;\n        NAF.connection.subscribeToDataChannel(this.drawingId, this._receiveData);\n      });\n    });\n  },\n\n  play() {\n    AFRAME.scenes[0].systems[\"hubs-systems\"].drawingMenuSystem.registerDrawingMenu(this.el);\n  },\n\n  remove() {\n    NAF.connection.unsubscribeToDataChannel(this.drawingId, this._receiveData);\n\n    this.drawStarted = false;\n\n    this.el.removeObject3D(\"mesh\");\n\n    const drawingManager = this.el.sceneEl.querySelector(\"#drawing-manager\").components[\"drawing-manager\"];\n    drawingManager.destroyDrawing(this);\n\n    AFRAME.scenes[0].systems[\"hubs-systems\"].drawingMenuSystem.unregisterDrawingMenu(this.el);\n  },\n\n  tick(t) {\n    const connected = NAF.connection.isConnected() && this.networkedEl;\n    const isMine = connected && NAF.utils.isMine(this.networkedEl);\n\n    if (!this.connectedToOwner && connected) {\n      const owner = NAF.utils.getNetworkOwner(this.networkedEl);\n      if (!isMine && NAF.connection.hasActiveDataChannel(owner)) {\n        NAF.connection.sendDataGuaranteed(owner, this.drawingId, {\n          type: MSG_CONFIRM_CONNECT,\n          clientId: NAF.clientId\n        });\n        this.connectedToOwner = true;\n      }\n    }\n\n    if (this.networkBuffer.length > 0 && connected) {\n      if (!isMine) {\n        this._drawFromNetwork();\n      } else if (this.bufferIndex < this.networkBuffer.length) {\n        this._broadcastDrawing();\n      }\n    }\n\n    //TODO: handle possibility that a clientId gets stuck in sendNetworkBufferQueue\n    //if that client disconnects before this executes and an activeDataChannel is opened.\n    if (isMine && this.sendNetworkBufferQueue.length > 0) {\n      const connected = [];\n      for (let i = 0; i < this.sendNetworkBufferQueue.length; i++) {\n        if (NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[i])) {\n          connected.push(this.sendNetworkBufferQueue[i]);\n        }\n      }\n      for (let j = 0; j < connected.length; j++) {\n        const pos = this.sendNetworkBufferQueue.indexOf(connected[j]);\n        this._sendNetworkBuffer(connected[j]);\n        this.sendNetworkBufferQueue.splice(pos, 1);\n      }\n    }\n\n    this._deleteExpiredLines(t);\n  },\n\n  cloneMesh(sharedBufferGeometry) {\n    const originalGeometry = sharedBufferGeometry.current;\n    const idx = sharedBufferGeometry.idx;\n    const geometry = new THREE.BufferGeometry();\n\n    const positions = originalGeometry.getAttribute(\"position\").array.subarray(0, idx.position * 3);\n    const colors = originalGeometry.getAttribute(\"color\").array.subarray(0, idx.color * 3);\n    const normals = originalGeometry.getAttribute(\"normal\").array.subarray(0, idx.normal * 3);\n    const indices = originalGeometry.index.array.subarray(0, idx.index);\n\n    geometry.setAttribute(\"position\", new THREE.BufferAttribute(positions, 3));\n    geometry.setAttribute(\"color\", new THREE.BufferAttribute(colors, 3));\n    geometry.setAttribute(\"normal\", new THREE.BufferAttribute(normals, 3));\n    geometry.setIndex(new THREE.BufferAttribute(indices, 1));\n\n    const material = new THREE.MeshStandardMaterial({\n      vertexColors: THREE.VertexColors\n    });\n    return new THREE.Mesh(geometry, material);\n  },\n\n  async serializeDrawing() {\n    const exporter = new GLTFExporter();\n\n    //mesh needs to be cloned before exporting to get rid of excess geometry information\n    const mesh = this.cloneMesh(this.sharedBuffer);\n\n    mesh.userData.gltfExtensions = {\n      MOZ_hubs_components: {\n        version: 4,\n        \"networked-drawing-buffer\": { buffer: this.networkBuffer }\n      }\n    };\n\n    // TODO: Proper error handling\n    const glb = await new Promise((resolve, reject) => {\n      exporter.parse(mesh, resolve, reject, {\n        binary: true,\n        includeCustomExtensions: true\n      });\n    });\n\n    const file = new File([glb], \"drawing.glb\", {\n      type: \"model/gltf-binary\"\n    });\n\n    const { entity } = addMedia(file, \"#interactable-media\", ObjectContentOrigins.FILE, \"drawing\", false, false);\n\n    const min = new THREE.Vector3(Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY);\n    const max = new THREE.Vector3(Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY);\n    const temp = new THREE.Vector3();\n\n    const attribute = this.sharedBuffer.current.attributes.position;\n    for (let i = 0; i < this.sharedBuffer.idx.position; i++) {\n      temp.set(attribute.getX(i), attribute.getY(i), attribute.getZ(i));\n      min.min(temp);\n      max.max(temp);\n    }\n\n    entity.object3D.position.addVectors(min, max).multiplyScalar(0.5);\n    entity.object3D.matrixNeedsUpdate = true;\n  },\n\n  deserializeDrawing: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function(buffer) {\n      let head = buffer[0];\n      if (head === \"-\") {\n        this._undoDraw();\n        buffer.shift();\n        head = buffer[0];\n      }\n\n      while (head != null && buffer.length >= 11) {\n        position.set(buffer[1], buffer[2], buffer[3]);\n        direction.set(buffer[4], buffer[5], buffer[6]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(buffer[7], buffer[8], buffer[9]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        buffer.splice(0, 10);\n\n        if (!this.drawStarted) {\n          this.startDraw(position, direction, normal);\n        } else if (buffer[0] !== null) {\n          this.draw(position, direction, normal);\n        }\n\n        if (buffer[0] === null) {\n          this.endDraw(position, direction, normal);\n          buffer.shift();\n        }\n      }\n    };\n  })(),\n\n  _broadcastDrawing: (() => {\n    const copyArray = [];\n    return function() {\n      copyArray.length = 0;\n      copyData(this.networkBuffer, copyArray, this.bufferIndex, this.networkBuffer.length - 1);\n\n      //remove undo's from networkBuffer after they've been sent so that\n      //newly joining clients don't get them\n      let index = -1;\n      while ((index = this.networkBuffer.indexOf(\"-\")) != -1) {\n        this.networkBuffer.splice(index, 1);\n      }\n      this.bufferIndex = this.networkBuffer.length;\n      NAF.connection.broadcastDataGuaranteed(this.drawingId, { type: MSG_BUFFER_DATA, buffer: copyArray });\n    };\n  })(),\n\n  _drawFromNetwork: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function() {\n      let head = this.networkBuffer[0];\n      if (head === \"-\") {\n        this._undoDraw();\n        this.networkBuffer.shift();\n        head = this.networkBuffer[0];\n      }\n      let didWork = false;\n      while (head != null && this.networkBuffer.length >= 11) {\n        const pointCount = this.networkBuffer[0];\n\n        // This is a sanity check against the sequence number to help uncover remaining bugs.\n        // If the point is out-of-order, report the error and stop drawing this line.\n        if (pointCount !== this.lastReadPointCount + 1) {\n          this.invalidPointRead = true;\n\n          console.error(\n            `Draw networking error: ID ${this.drawingId} expected point ${this.lastReadPointCount +\n              1} but received ${pointCount}`\n          );\n        }\n\n        this.lastReadPointCount = pointCount;\n        position.set(this.networkBuffer[1], this.networkBuffer[2], this.networkBuffer[3]);\n        direction.set(this.networkBuffer[4], this.networkBuffer[5], this.networkBuffer[6]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(this.networkBuffer[7], this.networkBuffer[8], this.networkBuffer[9]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        this.networkBuffer.splice(0, 10);\n\n        if (!this.remoteLineStarted) {\n          this.startDraw(position, direction, normal);\n          this.remoteLineStarted = true;\n        }\n\n        if (this.networkBuffer[0] === null) {\n          if (!this.invalidPointRead) {\n            this._endDraw(position, direction, normal);\n          }\n\n          this.remoteLineStarted = false;\n          this.networkBuffer.shift();\n          this.lastReadPointCount = 0;\n          this.invalidPointRead = false;\n        } else {\n          if (!this.invalidPointRead) {\n            this._draw(position, direction, normal);\n            didWork = true;\n          }\n        }\n      }\n      if (didWork) this._updateBuffer();\n    };\n  })(),\n\n  _deleteExpiredLines(time) {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const drawTime = this.networkBufferHistory[0].time;\n      if (length > this.data.maxLines || drawTime + this.data.maxDrawTimeout <= time) {\n        const datum = this.networkBufferHistory[0];\n        this.idx.position = datum.vertexCount;\n        this.idx.normal = datum.vertexCount;\n        this.idx.color = datum.vertexCount;\n        this.idx.index = datum.indexCount;\n        this.sharedBuffer.remove(this.prevIdx, this.idx);\n        this.networkBufferHistory.shift();\n        if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n          this.networkBuffer.splice(0, datum.networkBufferCount);\n          this.bufferIndex -= datum.networkBufferCount;\n        }\n      }\n    }\n  },\n\n  _sendNetworkBuffer: (() => {\n    const copyArray = [];\n    //This number needs to be approx. < ~6000 based on napkin math\n    //see: https://github.com/webrtc/adapter/blob/682e0f2439e139da6c0c406370eae820637b8sc1a/src/js/common_shim.js#L157\n    const chunkAmount = 3000;\n    return function(clientId) {\n      if (NAF.utils.isMine(this.networkedEl)) {\n        if (this.networkBuffer.length <= chunkAmount) {\n          NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n            type: MSG_BUFFER_DATA_FULL,\n            parts: 1,\n            buffer: this.networkBuffer\n          });\n        } else {\n          let start = 0;\n          let end = 0;\n          while (end < this.networkBuffer.length) {\n            end = Math.min(end + chunkAmount, this.networkBuffer.length);\n            copyArray.length = 0;\n            copyData(this.networkBuffer, copyArray, start, end - 1);\n            start = end;\n            NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n              type: MSG_BUFFER_DATA_FULL,\n              parts: Math.ceil(this.networkBuffer.length / chunkAmount),\n              buffer: copyArray\n            });\n          }\n        }\n      }\n    };\n  })(),\n\n  _receiveData(_, dataType, data) {\n    switch (data.type) {\n      case MSG_CONFIRM_CONNECT:\n        this.sendNetworkBufferQueue.push(data.clientId);\n        break;\n      case MSG_BUFFER_DATA:\n        if (this.networkBufferInitialized) {\n          this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        }\n        break;\n      case MSG_BUFFER_DATA_FULL:\n        this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        if (++this.receivedBufferParts >= data.parts) {\n          this.networkBufferInitialized = true;\n        }\n        break;\n    }\n  },\n\n  getLastPoint() {\n    return this.lastPoint;\n  },\n\n  startDraw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected()) {\n      return;\n    }\n\n    this.drawStarted = true;\n\n    if (color) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this.lastPoint.copy(position);\n    this._addToNetworkBuffer(position, direction, normal);\n  },\n\n  draw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected() || !this.drawStarted) {\n      return;\n    }\n\n    if (color && color != \"#\" + this.color.getHexString().toUpperCase()) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this._addToNetworkBuffer(position, direction, normal);\n    this._draw(position, direction, normal);\n\n    this._updateBuffer();\n  },\n\n  _draw: (() => {\n    const capNormal = new THREE.Vector3();\n    return function(position, direction, normal, radiusMultiplier = 1.0) {\n      if (!this.lineStarted) {\n        this._generateSegments(this.lastSegments, position, direction, normal, this.radius * radiusMultiplier);\n\n        //get normal for tip of cap\n        capNormal.copy(direction).negate();\n        //get normals for rim of cap\n        for (let i = 0; i < this.segments; i++) {\n          this.lastSegments[i].normal.add(capNormal).multiplyScalar(0.5);\n        }\n\n        this._drawStartCap(this.lastPoint, this.lastSegments, capNormal);\n\n        this.lineStarted = true;\n      } else {\n        this._generateSegments(this.currentSegments, position, direction, normal, this.radius * radiusMultiplier);\n        this._drawCylinder();\n\n        if (this.currentPointCount > this.data.maxPointsPerLine) {\n          this._drawProjectedEndCap(position, direction);\n          this._endLine();\n        }\n      }\n      this.lastPoint.copy(position);\n    };\n  })(),\n\n  undoDraw() {\n    if (!NAF.connection.isConnected() || this.drawStarted) {\n      return;\n    }\n    this._undoDraw();\n    this._pushToNetworkBuffer(\"-\");\n  },\n\n  _undoDraw() {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const datum = this.networkBufferHistory.pop();\n      this.idx.position = 0;\n      this.idx.normal = 0;\n      this.idx.color = 0;\n      this.idx.index = 0;\n      if (length > 1) {\n        this.idx.position = this.sharedBuffer.idx.position - datum.vertexCount - 1;\n        this.idx.normal = this.sharedBuffer.idx.normal - datum.vertexCount - 1;\n        this.idx.color = this.sharedBuffer.idx.color - datum.vertexCount - 1;\n        this.idx.index = this.sharedBuffer.idx.index - datum.indexCount - 1;\n      }\n      this.sharedBuffer.remove(this.idx, this.sharedBuffer.idx);\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        this.networkBuffer.splice(this.networkBuffer.length - datum.networkBufferCount, datum.networkBufferCount);\n        this.bufferIndex -= datum.networkBufferCount;\n      }\n    }\n  },\n\n  endDraw(position, direction, normal) {\n    this._endDraw(position, direction, normal);\n    this._updateBuffer();\n  },\n\n  _endDraw(position, direction, normal) {\n    if (!this.lineStarted && this.drawStarted) {\n      this._drawPoint(position);\n    } else if (this.lineStarted && this.drawStarted) {\n      this._addToNetworkBuffer(position, direction, normal);\n      this._draw(position, direction, normal);\n      this._drawProjectedEndCap(position, direction);\n    }\n    this._endLine();\n  },\n\n  _drawProjectedEndCap: (() => {\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position, direction) {\n      if (this.lineStarted && this.drawStarted) {\n        projectedDirection.copy(direction).multiplyScalar(this.radius);\n        projectedPoint.copy(position).add(projectedDirection);\n        this._drawEndCap(projectedPoint, direction);\n      }\n    };\n  })(),\n\n  _endLine() {\n    if (!this.drawStarted) return;\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) this._pushToNetworkBuffer(null);\n\n    const datum = {\n      networkBufferCount: this.networkBufferCount,\n      vertexCount: this.vertexCount - 1,\n      indexCount: this.indexCount - 1,\n      time: this.el.sceneEl.clock.elapsedTime * 1000\n    };\n    this.networkBufferHistory.push(datum);\n    this.vertexCount = 0;\n    this.indexCount = 0;\n    this.networkBufferCount = 0;\n    this.currentPointCount = 0;\n    this.lineStarted = false;\n    this.drawStarted = false;\n\n    this.sharedBuffer.computeBoundingSpheres();\n  },\n\n  _addToNetworkBuffer: (() => {\n    const copyDirection = new THREE.Vector3();\n    const copyNormal = new THREE.Vector3();\n    return function(position, direction, normal) {\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        ++this.currentPointCount;\n        this._pushToNetworkBuffer(this.currentPointCount);\n        this._pushToNetworkBuffer(position.x);\n        this._pushToNetworkBuffer(position.y);\n        this._pushToNetworkBuffer(position.z);\n        copyDirection.copy(direction);\n        copyDirection.setLength(this.radius); //encode radius as length of direction vector\n        this._pushToNetworkBuffer(copyDirection.x);\n        this._pushToNetworkBuffer(copyDirection.y);\n        this._pushToNetworkBuffer(copyDirection.z);\n        copyNormal.copy(normal);\n        copyNormal.setLength(this.color.getHex() + 1); //encode color as length, add one in case color is black\n        this._pushToNetworkBuffer(copyNormal.x);\n        this._pushToNetworkBuffer(copyNormal.y);\n        this._pushToNetworkBuffer(copyNormal.z);\n      }\n    };\n  })(),\n\n  _pushToNetworkBuffer(val) {\n    //don't increment networkBufferCount if undo, because the undo character\n    //will be removed in tick() on the next frame\n    if (val !== \"-\") {\n      ++this.networkBufferCount;\n    }\n    this.networkBuffer.push(val);\n  },\n\n  //draw a cylinder from last to current segments\n  _drawCylinder() {\n    //average the normals with the normals from the lastSegment\n    //not a perfect normal calculation, but works well enough\n    for (let i = 0; i < this.segments; i++) {\n      this.currentSegments[i].normal.add(this.lastSegments[i].normal).multiplyScalar(0.5);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this._addVertex(this.currentSegments[i]);\n    }\n\n    const bufferVertexCount = this.sharedBuffer.idx.position;\n\n    for (let i = 0; i < this.segments; i++) {\n      const a = bufferVertexCount - (this.segments + (this.segments - i));\n      const b = i + 1 < this.segments ? a + 1 : bufferVertexCount - 2 * this.segments;\n      const c = bufferVertexCount - (this.segments - i);\n      const d = i + 1 < this.segments ? c + 1 : bufferVertexCount - this.segments;\n\n      this._addIndex(c, a, b);\n      this._addIndex(c, b, d);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this.lastSegments[i].position.copy(this.currentSegments[i].position);\n      this.lastSegments[i].normal.copy(this.currentSegments[i].normal);\n    }\n  },\n\n  //draw a standalone point in space\n  _drawPoint: (() => {\n    const up = new THREE.Vector3(0, 1, 0);\n    const down = new THREE.Vector3(0, -1, 0);\n    const left = new THREE.Vector3(1, 0, 0);\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position) {\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n      this.lastPoint.copy(projectedPoint);\n\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      this._draw(position, down, left);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n\n      this._drawEndCap(projectedPoint, down);\n    };\n  })(),\n\n  _drawStartCap(point, segments, normal) {\n    this._addVertex({ position: point, normal: normal });\n\n    for (let i = 0; i < this.segments; i++) {\n      this._addVertex(segments[i]);\n    }\n\n    const bufferVertexCount = this.sharedBuffer.idx.position;\n    const a = bufferVertexCount - this.segments - 1;\n    for (let i = 0; i < this.segments; i++) {\n      const b = bufferVertexCount - (this.segments - i);\n      const c = i + 1 < this.segments ? b + 1 : bufferVertexCount - this.segments;\n      this._addIndex(a, c, b);\n    }\n  },\n\n  _drawEndCap(point, normal) {\n    this._addVertex({ position: point, normal: normal });\n\n    const bufferVertexCount = this.sharedBuffer.idx.position;\n    const a = bufferVertexCount - 1;\n    for (let i = 0; i < this.segments; i++) {\n      const b = bufferVertexCount - (this.segments - i) - 1;\n      const c = i + 1 < this.segments ? b + 1 : bufferVertexCount - this.segments - 1;\n      this._addIndex(a, b, c);\n    }\n  },\n\n  _updateBuffer() {\n    this.sharedBuffer.update();\n  },\n\n  _addVertex(segment) {\n    const point = segment.position;\n    const normal = segment.normal;\n    this.sharedBuffer.addVertex(point.x, point.y, point.z);\n    this.sharedBuffer.addColor(this.color.r, this.color.g, this.color.b);\n\n    if (normal) {\n      this.sharedBuffer.addNormal(normal.x, normal.y, normal.z);\n    } else {\n      ++this.sharedBuffer.idx.normal;\n    }\n\n    ++this.vertexCount;\n  },\n\n  _addIndex(a, b, c) {\n    this.sharedBuffer.addIndex(a, b, c);\n    this.indexCount += 3;\n  },\n\n  //calculate the segments for a given point\n  _generateSegments(segmentsList, point, forward, up, radius) {\n    const angleIncrement = (Math.PI * 2) / this.segments;\n    for (let i = 0; i < this.segments; i++) {\n      const segment = segmentsList[i].position;\n      this._rotatePointAroundAxis(segment, point, forward, up, angleIncrement * i, radius);\n      segmentsList[i].normal.subVectors(segment, point).normalize();\n    }\n  },\n\n  _rotatePointAroundAxis: (() => {\n    const calculatedDirection = new THREE.Vector3();\n    return function(out, point, axis, up, angle, radius) {\n      calculatedDirection.copy(up);\n      calculatedDirection.applyAxisAngle(axis, angle);\n      out.copy(point).add(calculatedDirection.normalize().multiplyScalar(radius));\n    };\n  })()\n});\n\nAFRAME.registerComponent(\"networked-drawing-buffer\", {\n  schema: {\n    buffer: { default: [] }\n  },\n\n  play() {\n    const button = this._getDeserializeButton(this.el.parentEl);\n    if (button) {\n      button.object3D.visible = true;\n      button.components[\"deserialize-drawing-button\"].networkedDrawingBuffer = this;\n    }\n  },\n\n  _getDeserializeButton(entity) {\n    if (entity.classList.contains(\"interactable\")) {\n      return entity.querySelector(\".deserialize-drawing\");\n    } else if (entity.parentEl) {\n      return this._getDeserializeButton(entity.parentEl);\n    } else {\n      return null;\n    }\n  }\n});\n\nAFRAME.registerComponent(\"deserialize-drawing-button\", {\n  init() {\n    const drawingManager = this.el.sceneEl.querySelector(\"#drawing-manager\").components[\"drawing-manager\"];\n    this.networkedDrawingBuffer = null;\n\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      const finishDrawing = () => {\n        drawingManager.drawing.deserializeDrawing(this.networkedDrawingBuffer.data.buffer);\n        addMeshScaleAnimation(drawingManager.drawing.el.object3DMap.mesh, { x: 0.001, y: 0.001, z: 0.001 });\n\n        if (this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned) {\n          window.APP.pinningHelper.setPinned(this.targetEl, false);\n        }\n        this.targetEl.parentEl.removeChild(this.targetEl);\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PEN_START_DRAW);\n      };\n\n      //serialize any existing drawing and clear the drawing.\n      if (drawingManager.drawing) {\n        drawingManager.drawing.serializeDrawing().then(() => {\n          drawingManager.drawing.el.parentEl.removeChild(drawingManager.drawing.el);\n          drawingManager.destroyDrawing(drawingManager.drawing);\n\n          drawingManager.createDrawing().then(finishDrawing);\n        });\n      } else {\n        drawingManager.createDrawing().then(finishDrawing);\n      }\n    };\n\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    if (this.networkedDrawingBuffer) {\n      const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n      const canPin = window.APP.hubChannel.can(\"pin_objects\") && window.APP.hubChannel.signedIn;\n      this.el.object3D.visible = (!isPinned || canPin) && window.APP.hubChannel.can(\"spawn_drawing\");\n    } else {\n      this.el.object3D.visible = false;\n    }\n  }\n});\n","import { addComponent, removeComponent } from \"bitecs\";\nimport { CONSTANTS } from \"three-ammo\";\nimport { Rigidbody } from \"../bit-components\";\nconst ACTIVATION_STATE = CONSTANTS.ACTIVATION_STATE,\n  TYPE = CONSTANTS.TYPE;\n\nexport const ACTIVATION_STATES = [\n  ACTIVATION_STATE.ACTIVE_TAG,\n  ACTIVATION_STATE.ISLAND_SLEEPING,\n  ACTIVATION_STATE.WANTS_DEACTIVATION,\n  ACTIVATION_STATE.DISABLE_DEACTIVATION,\n  ACTIVATION_STATE.DISABLE_SIMULATION\n];\n\nAFRAME.registerComponent(\"body-helper\", {\n  schema: {\n    loadedEvent: { default: \"\" },\n    mass: { default: 1 },\n    gravity: { type: \"vec3\", default: { x: 0, y: -9.8, z: 0 } },\n    linearDamping: { default: 0.01 },\n    angularDamping: { default: 0.01 },\n    linearSleepingThreshold: { default: 1.6 },\n    angularSleepingThreshold: { default: 2.5 },\n    angularFactor: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    activationState: {\n      default: ACTIVATION_STATE.ACTIVE_TAG,\n      oneOf: ACTIVATION_STATES\n    },\n    type: { default: \"dynamic\", oneOf: [TYPE.STATIC, TYPE.DYNAMIC, TYPE.KINEMATIC] },\n    emitCollisionEvents: { default: false },\n    disableCollision: { default: false },\n    collisionFilterGroup: { default: 1 }, //32-bit mask,\n    collisionFilterMask: { default: 1 }, //32-bit mask\n    scaleAutoUpdate: { default: true }\n  },\n\n  init: function() {\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n    this.alive = true;\n    this.el.object3D.updateMatrices();\n    this.uuid = this.system.addBody(this.el.object3D, this.data);\n    const eid = this.el.object3D.eid;\n    addComponent(APP.world, Rigidbody, eid);\n    Rigidbody.bodyId[eid] = this.uuid; //uuid is a lie, it's actually an int\n  },\n\n  update: function(prevData) {\n    if (prevData) {\n      this.system.updateBody(this.uuid, this.data);\n    }\n  },\n\n  remove: function() {\n    this.system.removeBody(this.uuid);\n    const eid = this.el.object3D.eid;\n    removeComponent(APP.world, Rigidbody, eid);\n    this.alive = false;\n  }\n});\n","import { SHAPE, FIT } from \"three-ammo/constants\";\n\nAFRAME.registerComponent(\"shape-helper\", {\n  schema: {\n    type: {\n      default: SHAPE.HULL,\n      oneOf: [\n        SHAPE.BOX,\n        SHAPE.CYLINDER,\n        SHAPE.SPHERE,\n        SHAPE.CAPSULE,\n        SHAPE.CONE,\n        SHAPE.HULL,\n        SHAPE.HACD,\n        SHAPE.VHACD,\n        SHAPE.MESH,\n        SHAPE.HEIGHTFIELD\n      ]\n    },\n    fit: { default: FIT.ALL, oneOf: [FIT.ALL, FIT.MANUAL] },\n    halfExtents: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    minHalfExtent: { default: 0 },\n    maxHalfExtent: { default: Number.POSITIVE_INFINITY },\n    sphereRadius: { default: NaN },\n    cylinderAxis: { default: \"y\", oneOf: [\"x\", \"y\", \"z\"] },\n    margin: { default: 0.01 },\n    offset: { type: \"vec3\", default: { x: 0, y: 0, z: 0 } },\n    orientation: { type: \"vec4\", default: { x: 0, y: 0, z: 0, w: 1 } },\n    heightfieldData: { default: [] },\n    heightfieldDistance: { default: 1 },\n    includeInvisible: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n    this.uuid = -1;\n    this.mesh = null;\n\n    let bodyEl = this.el;\n    this.bodyHelper = bodyEl.components[\"body-helper\"] || null;\n    while (!this.bodyHelper && bodyEl.parentNode != this.el.sceneEl) {\n      bodyEl = bodyEl.parentNode;\n      if (bodyEl.components[\"body-helper\"]) {\n        this.bodyHelper = bodyEl.components[\"body-helper\"];\n      }\n    }\n    if (!this.bodyHelper || this.bodyHelper.uuid === null || this.bodyHelper.uuid === undefined) {\n      console.error(\"body not found\");\n      return;\n    }\n    if (this.data.fit === FIT.ALL) {\n      if (!this.el.object3DMap.mesh) {\n        console.error(\"Cannot use FIT.ALL without object3DMap.mesh\");\n        return;\n      }\n      this.mesh = this.el.object3DMap.mesh;\n      this.mesh.updateMatrices();\n    }\n\n    this.uuid = this.system.addShapes(this.bodyHelper.uuid, this.mesh, this.data);\n  },\n\n  remove: function() {\n    // Removing a body already cleans up it's shapes\n    if (this.uuid !== -1 && this.bodyHelper.alive) {\n      this.system.removeShapes(this.bodyHelper.uuid, this.uuid);\n    }\n  }\n});\n","import Raven from \"raven-js\";\nimport configs from \"./utils/configs\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = configs.SENTRY_DSN;\n  const gaTrackingId = configs.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { IntlProvider } from \"react-intl\";\nimport \"@formatjs/intl-locale/polyfill\";\nimport \"@formatjs/intl-pluralrules/polyfill\";\nimport \"@formatjs/intl-pluralrules/locale-data/en\";\nimport \"@formatjs/intl-relativetimeformat/polyfill\";\nimport \"@formatjs/intl-relativetimeformat/locale-data/en\";\nimport { getLocale, getMessages } from \"../utils/i18n\";\n\nexport class WrappedIntlProvider extends React.Component {\n  static propTypes = {\n    children: PropTypes.node.isRequired\n  };\n\n  state = {\n    locale: getLocale(),\n    messages: getMessages()\n  };\n\n  updateLocale = () => {\n    this.setState({ locale: getLocale(), messages: getMessages() });\n  };\n\n  componentDidMount() {\n    this.updateLocale();\n    window.addEventListener(\"locale-updated\", this.updateLocale);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"locale-updated\", this.updateLocale);\n  }\n\n  render() {\n    return (\n      <IntlProvider locale={this.state.locale} messages={this.state.messages}>\n        {this.props.children}\n      </IntlProvider>\n    );\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"oauth-screen\":\"OAuthScreen__oauth-screen__qY3Hq\",\"oauthScreen\":\"OAuthScreen__oauth-screen__qY3Hq\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./OAuthScreen.scss\";\nimport { Modal } from \"../modal/Modal\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Button } from \"../input/Button\";\nimport { LegalMessage } from \"./LegalMessage\";\n\nconst providerLabel = {\n  discord: \"Discord\",\n  slack: \"Slack\"\n};\nexport function OAuthScreen({ provider, redirectUrl, termsUrl, privacyUrl, ...rest }) {\n  return (\n    <div className={styles.oauthScreen} {...rest}>\n      <Modal title={<FormattedMessage id=\"oauth-screen.title\" defaultMessage=\"Sign In To Continue\" />}>\n        <Column center padding>\n          <p>\n            <FormattedMessage\n              id=\"oauth-screen.description\"\n              defaultMessage=\"You'll need to sign in to {provider} to access this room.\"\n              values={{ provider: providerLabel[provider] }}\n            />\n          </p>\n          <p>\n            <FormattedMessage\n              id=\"oauth-screen.email-reason\"\n              defaultMessage=\"We'll ask for access to your e-mail address so you can skip signing in next time.\"\n            />\n          </p>\n          <p>\n            <small>\n              <LegalMessage termsUrl={termsUrl} privacyUrl={privacyUrl} />\n            </small>\n          </p>\n          <Button as=\"a\" href={redirectUrl} preset={provider === \"discord\" ? \"accent5\" : \"accent4\"}>\n            <FormattedMessage\n              id=\"oauth-screen.sign-in-button\"\n              defaultMessage=\"Sign Into {provider}\"\n              values={{ provider: providerLabel[provider] }}\n            />\n          </Button>\n        </Column>\n      </Modal>\n    </div>\n  );\n}\n\nOAuthScreen.propTypes = {\n  provider: PropTypes.string.isRequired,\n  redirectUrl: PropTypes.string.isRequired,\n  termsUrl: PropTypes.string,\n  privacyUrl: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { OAuthScreen } from \"./OAuthScreen\";\nimport { TERMS, PRIVACY } from \"../../constants\";\n\nexport function OAuthScreenContainer({ oauthInfo }) {\n  const { url, type } = oauthInfo[0];\n\n  return (\n    <OAuthScreen\n      provider={type}\n      redirectUrl={url}\n      termsUrl={configs.feature(\"show_terms\") && configs.link(\"terms_of_use\", TERMS)}\n      privacyUrl={configs.feature(\"show_privacy\") && configs.link(\"privacy_notice\", PRIVACY)}\n    />\n  );\n}\n\nOAuthScreenContainer.propTypes = {\n  oauthInfo: PropTypes.array\n};\n","import {\n  getCurrentHubId,\n  updateVRHudPresenceCount,\n  updateSceneCopresentState,\n  createHubChannelParams\n} from \"./utils/hub-utils\";\nimport \"./utils/debug-log\";\nimport configs from \"./utils/configs\";\nimport \"./utils/theme\";\nimport \"@babel/polyfill\";\n\nconsole.log(\n  `App version: ${\n    configs.IS_LOCAL_OR_CUSTOM_CLIENT\n      ? `Custom client or local client (undeploy custom client to run build ${process.env.BUILD_VERSION})`\n      : process.env.BUILD_VERSION || \"?\"\n  }`\n);\n\nimport \"./react-components/styles/global.scss\";\nimport \"./assets/stylesheets/globals.scss\";\nimport \"./assets/stylesheets/hub.scss\";\nimport loadingEnvironment from \"./assets/models/LoadingEnvironment.glb\";\n\nimport \"aframe\";\nimport \"./utils/aframe-overrides\";\n\n// A-Frame hardcodes THREE.Cache.enabled = true\n// But we don't want to use THREE.Cache because\n// web browser cache should work well.\n// So we disable it here.\nTHREE.Cache.enabled = false;\n\nimport \"./utils/logging\";\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"networked-aframe/src/index\";\nimport \"webrtc-adapter\";\nimport { detectOS, detect } from \"detect-browser\";\nimport {\n  getReticulumFetchUrl,\n  getReticulumMeta,\n  migrateChannelToSocket,\n  connectToReticulum,\n  denoisePresence,\n  presenceEventsForHub,\n  tryGetMatchingMeta\n} from \"./utils/phoenix-utils\";\nimport { Presence } from \"phoenix\";\nimport { emitter } from \"./emitter\";\nimport \"./phoenix-adapter\";\n\nimport nextTick from \"./utils/next-tick\";\nimport { addAnimationComponents } from \"./utils/animation\";\nimport Cookies from \"js-cookie\";\nimport { DialogAdapter, DIALOG_CONNECTION_ERROR_FATAL, DIALOG_CONNECTION_CONNECTED } from \"./naf-dialog-adapter\";\nimport \"./change-hub\";\n\nimport \"./components/scene-components\";\nimport \"./components/mute-mic\";\nimport \"./components/bone-mute-state-indicator\";\nimport \"./components/bone-visibility\";\nimport \"./components/fader\";\nimport \"./components/in-world-hud\";\nimport \"./components/emoji\";\nimport \"./components/emoji-hud\";\nimport \"./components/virtual-gamepad-controls\";\nimport \"./components/ik-controller\";\nimport \"./components/hand-controls2\";\nimport \"./components/hoverable-visuals\";\nimport \"./components/hover-visuals\";\nimport \"./components/offset-relative-to\";\nimport \"./components/player-info\";\nimport \"./components/name-tag\";\nimport \"./components/debug\";\nimport \"./components/hand-poses\";\nimport \"./components/hud-controller\";\nimport \"./components/freeze-controller\";\nimport \"./components/icon-button\";\nimport \"./components/text-button\";\nimport \"./components/block-button\";\nimport \"./components/mute-button\";\nimport \"./components/kick-button\";\nimport \"./components/close-vr-notice-button\";\nimport \"./components/leave-room-button\";\nimport \"./components/visible-if-permitted\";\nimport \"./components/visibility-on-content-types\";\nimport \"./components/hide-when-pinned-and-forbidden\";\nimport \"./components/visibility-while-frozen\";\nimport \"./components/stats-plus\";\nimport \"./components/networked-avatar\";\nimport \"./components/media-video\";\nimport \"./components/media-pdf\";\nimport \"./components/media-image\";\nimport \"./components/avatar-volume-controls\";\nimport \"./components/pinch-to-move\";\nimport \"./components/pitch-yaw-rotator\";\nimport \"./components/position-at-border\";\nimport \"./components/pinnable\";\nimport \"./components/pin-networked-object-button\";\nimport \"./components/mirror-media-button\";\nimport \"./components/close-mirrored-media-button\";\nimport \"./components/drop-object-button\";\nimport \"./components/camera-focus-button\";\nimport \"./components/unmute-video-button\";\nimport \"./components/visible-to-owner\";\nimport \"./components/emit-state-change\";\nimport \"./components/action-to-event\";\nimport \"./components/action-to-remove\";\nimport \"./components/emit-scene-event-on-remove\";\nimport \"./components/follow-in-fov\";\nimport \"./components/clone-media-button\";\nimport \"./components/open-media-button\";\nimport \"./components/refresh-media-button\";\nimport \"./components/tweet-media-button\";\nimport \"./components/remix-avatar-button\";\nimport \"./components/transform-object-button\";\nimport \"./components/scale-button\";\nimport \"./components/hover-menu\";\nimport \"./components/disable-frustum-culling\";\nimport \"./components/teleporter\";\nimport \"./components/track-pose\";\nimport \"./components/replay\";\nimport \"./components/visibility-by-path\";\nimport \"./components/tags\";\nimport \"./components/periodic-full-syncs\";\nimport \"./components/inspect-button\";\nimport \"./components/inspect-pivot-child-selector\";\nimport \"./components/inspect-pivot-offset-from-camera\";\nimport \"./components/optional-alternative-to-not-hide\";\nimport \"./components/avatar-audio-source\";\nimport \"./components/avatar-inspect-collider\";\nimport \"./components/video-texture-target\";\nimport \"./components/mirror\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { Router, Route } from \"react-router-dom\";\nimport { createBrowserHistory, createMemoryHistory } from \"history\";\nimport { pushHistoryState } from \"./utils/history\";\nimport UIRoot from \"./react-components/ui-root\";\nimport { ExitedRoomScreenContainer } from \"./react-components/room/ExitedRoomScreenContainer\";\nimport AuthChannel from \"./utils/auth-channel\";\nimport HubChannel from \"./utils/hub-channel\";\nimport LinkChannel from \"./utils/link-channel\";\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\nimport { proxiedUrlFor } from \"./utils/media-url-utils\";\nimport { traverseMeshesAndAddShapes } from \"./utils/physics-utils\";\nimport { handleExitTo2DInterstitial, exit2DInterstitialAndEnterVR } from \"./utils/vr-interstitial\";\nimport { getAvatarSrc } from \"./utils/avatar-utils.js\";\nimport MessageDispatch from \"./message-dispatch\";\nimport SceneEntryManager from \"./scene-entry-manager\";\nimport Subscriptions from \"./subscriptions\";\nimport { createInWorldLogMessage } from \"./react-components/chat-message\";\n\nimport \"./systems/nav\";\nimport \"./systems/frame-scheduler\";\nimport \"./systems/personal-space-bubble\";\nimport \"./systems/app-mode\";\nimport \"./systems/permissions\";\nimport \"./systems/exit-on-blur\";\nimport \"./systems/auto-pixel-ratio\";\nimport \"./systems/idle-detector\";\nimport \"./systems/pen-tools\";\nimport \"./systems/userinput/userinput\";\nimport \"./systems/userinput/userinput-debug\";\nimport \"./systems/ui-hotkeys\";\nimport \"./systems/tips\";\nimport \"./systems/interactions\";\nimport \"./systems/hubs-systems\";\nimport \"./systems/capture-system\";\nimport \"./systems/listed-media\";\nimport \"./systems/linked-media\";\nimport \"./systems/audio-debug-system\";\nimport \"./systems/audio-gain-system\";\n\nimport \"./gltf-component-mappings\";\n\nimport { App } from \"./App\";\nimport MediaDevicesManager from \"./utils/media-devices-manager\";\nimport PinningHelper from \"./utils/pinning-helper\";\nimport { sleep } from \"./utils/async-utils\";\nimport { platformUnsupported } from \"./support\";\n\nwindow.APP = new App();\nwindow.APP.dialog = new DialogAdapter();\nwindow.APP.RENDER_ORDER = {\n  HUD_BACKGROUND: 1,\n  HUD_ICONS: 2,\n  CURSOR: 3\n};\n\nconst store = window.APP.store;\nstore.update({ preferences: { shouldPromptForRefresh: false } }); // Clear flag that prompts for refresh from preference screen\nconst mediaSearchStore = window.APP.mediaSearchStore;\nconst OAUTH_FLOW_PERMS_TOKEN_KEY = \"ret-oauth-flow-perms-token\";\nconst NOISY_OCCUPANT_COUNT = 30; // Above this # of occupants, we stop posting join/leaves/renames\n\nconst qs = new URLSearchParams(location.search);\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isEmbed = window.self !== window.top;\nif (isEmbed && !qs.get(\"embed_token\")) {\n  // Should be covered by X-Frame-Options, but just in case.\n  throw new Error(\"no embed token\");\n}\n\nTHREE.Object3D.DefaultMatrixAutoUpdate = false;\n\nimport \"./components/owned-object-limiter\";\nimport \"./components/owned-object-cleanup-timeout\";\nimport \"./components/set-unowned-body-kinematic\";\nimport \"./components/scalable-when-grabbed\";\nimport \"./components/networked-counter\";\nimport \"./components/event-repeater\";\nimport \"./components/set-yxz-order\";\n\nimport \"./components/cursor-controller\";\n\nimport \"./components/tools/pen\";\nimport \"./components/tools/pen-laser\";\nimport \"./components/tools/networked-drawing\";\nimport \"./components/tools/drawing-manager\";\n\nimport \"./components/body-helper\";\nimport \"./components/shape-helper\";\n\nimport registerNetworkSchemas from \"./network-schemas\";\nimport registerTelemetry from \"./telemetry\";\n\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY, ONLY_SCREEN_AVAILABLE } from \"./utils/vr-caps-detect\";\nimport detectConcurrentLoad from \"./utils/concurrent-load-detector\";\n\nimport qsTruthy from \"./utils/qs_truthy\";\nimport { WrappedIntlProvider } from \"./react-components/wrapped-intl-provider\";\nimport { ExitReason } from \"./react-components/room/ExitedRoomScreen\";\nimport { OAuthScreenContainer } from \"./react-components/auth/OAuthScreenContainer\";\nimport { SignInMessages } from \"./react-components/auth/SignInModal\";\nimport { ThemeProvider } from \"./react-components/styles/theme\";\nimport { LogMessageType } from \"./react-components/room/ChatSidebar\";\n\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\nNAF.options.firstSyncSource = PHOENIX_RELIABLE_NAF;\nNAF.options.syncSource = PHOENIX_RELIABLE_NAF;\n\nlet isOAuthModal = false;\n\n// OAuth popup handler\n// TODO: Replace with a new oauth callback route that has this postMessage script.\ntry {\n  if (window.opener && window.opener.doingTwitterOAuth) {\n    window.opener.postMessage(\"oauth-successful\");\n    isOAuthModal = true;\n    window.close();\n  }\n} catch (e) {\n  console.error(\"Exception in oauth processing code\", e);\n}\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isTelemetryDisabled = qsTruthy(\"disable_telemetry\");\nconst isDebug = qsTruthy(\"debug\");\n\nif (!isBotMode && !isTelemetryDisabled) {\n  registerTelemetry(\"/hub\", \"Room Landing Page\");\n}\n\ndisableiOSZoom();\n\nif (!isOAuthModal) {\n  detectConcurrentLoad();\n}\n\nfunction setupLobbyCamera() {\n  console.log(\"Setting up lobby camera\");\n  const camera = document.getElementById(\"scene-preview-node\");\n  const previewCamera = document.getElementById(\"environment-scene\").object3D.getObjectByName(\"scene-preview-camera\");\n\n  if (previewCamera) {\n    camera.object3D.position.copy(previewCamera.position);\n    camera.object3D.rotation.copy(previewCamera.rotation);\n    camera.object3D.rotation.reorder(\"YXZ\");\n  } else {\n    const cameraPos = camera.object3D.position;\n    camera.object3D.position.set(cameraPos.x, 2.5, cameraPos.z);\n  }\n\n  camera.object3D.matrixNeedsUpdate = true;\n\n  camera.removeAttribute(\"scene-preview-camera\");\n  camera.setAttribute(\"scene-preview-camera\", \"positionOnly: true; duration: 60\");\n}\n\nlet uiProps = {};\n\n// Hub ID and slug are the basename\nlet routerBaseName = document.location.pathname.split(\"/\").slice(0, 2).join(\"/\");\n\nif (document.location.pathname.includes(\"hub.html\")) {\n  routerBaseName = \"/\";\n}\n\n// when loading the client as a \"default room\" on the homepage, use MemoryHistory since exposing all the client paths at the root is undesirable\nconst history = routerBaseName === \"/\" ? createMemoryHistory() : createBrowserHistory({ basename: routerBaseName });\nwindow.APP.history = history;\n\nconst qsVREntryType = qs.get(\"vr_entry_type\");\n\nfunction mountUI(props = {}) {\n  const scene = document.querySelector(\"a-scene\");\n  const disableAutoExitOnIdle =\n    qsTruthy(\"allow_idle\") || (process.env.NODE_ENV === \"development\" && !qs.get(\"idle_timeout\"));\n  const forcedVREntryType = qsVREntryType;\n\n  ReactDOM.render(\n    <WrappedIntlProvider>\n      <ThemeProvider store={store}>\n        <Router history={history}>\n          <Route\n            render={routeProps =>\n              props.showOAuthScreen ? (\n                <OAuthScreenContainer oauthInfo={props.oauthInfo} />\n              ) : props.roomUnavailableReason ? (\n                <ExitedRoomScreenContainer reason={props.roomUnavailableReason} />\n              ) : (\n                <UIRoot\n                  {...{\n                    scene,\n                    isBotMode,\n                    disableAutoExitOnIdle,\n                    forcedVREntryType,\n                    store,\n                    mediaSearchStore,\n                    ...props,\n                    ...routeProps\n                  }}\n                />\n              )\n            }\n          />\n        </Router>\n      </ThemeProvider>\n    </WrappedIntlProvider>,\n    document.getElementById(\"ui-root\")\n  );\n}\n\nexport function remountUI(props) {\n  uiProps = { ...uiProps, ...props };\n  mountUI(uiProps);\n}\n\nexport async function getSceneUrlForHub(hub) {\n  let sceneUrl;\n  let isLegacyBundle; // Deprecated\n  if (hub.scene) {\n    isLegacyBundle = false;\n    sceneUrl = hub.scene.model_url;\n  } else if (hub.scene === null) {\n    // delisted/removed scene\n    sceneUrl = loadingEnvironment;\n  } else {\n    const defaultSpaceTopic = hub.topics[0];\n    const glbAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"glb\");\n    const bundleAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"gltf_bundle\");\n    sceneUrl = (glbAsset || bundleAsset).src || loadingEnvironment;\n    const hasExtension = /\\.gltf/i.test(sceneUrl) || /\\.glb/i.test(sceneUrl);\n    isLegacyBundle = !(glbAsset || hasExtension);\n  }\n\n  if (qsTruthy(\"debugLocalScene\") && sceneUrl?.startsWith(\"blob:\")) {\n    // we skip doing this if you haven't entered because refreshing the page will invalidate blob urls and break loading\n    sceneUrl = document.querySelector(\"a-scene\").is(\"entered\") ? sceneUrl : loadingEnvironment;\n  } else if (isLegacyBundle) {\n    // Deprecated\n    const res = await fetch(sceneUrl);\n    const data = await res.json();\n    const baseURL = new URL(THREE.LoaderUtils.extractUrlBase(sceneUrl), window.location.href);\n    sceneUrl = new URL(data.assets[0].src, baseURL).href;\n  } else {\n    sceneUrl = proxiedUrlFor(sceneUrl);\n  }\n  return sceneUrl;\n}\n\nexport async function updateEnvironmentForHub(hub, entryManager) {\n  console.log(\"Updating environment for hub\");\n  const sceneUrl = await getSceneUrlForHub(hub);\n\n  const sceneErrorHandler = () => {\n    remountUI({ roomUnavailableReason: ExitReason.sceneError });\n    entryManager.exitScene();\n  };\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n  const sceneEl = document.querySelector(\"a-scene\");\n\n  const envSystem = sceneEl.systems[\"hubs-systems\"].environmentSystem;\n\n  console.log(`Scene URL: ${sceneUrl}`);\n  const loadStart = performance.now();\n\n  let environmentEl = null;\n\n  if (environmentScene.childNodes.length === 0) {\n    const environmentEl = document.createElement(\"a-entity\");\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        environmentEl.removeEventListener(\"model-error\", sceneErrorHandler);\n\n        console.log(`Scene file initial load took ${Math.round(performance.now() - loadStart)}ms`);\n\n        // Show the canvas once the model has loaded\n        document.querySelector(\".a-canvas\").classList.remove(\"a-hidden\");\n\n        sceneEl.addState(\"visible\");\n\n        envSystem.updateEnvironment(environmentEl);\n\n        //TODO: check if the environment was made with spoke to determine if a shape should be added\n        traverseMeshesAndAddShapes(environmentEl);\n      },\n      { once: true }\n    );\n\n    environmentEl.addEventListener(\"model-error\", sceneErrorHandler, { once: true });\n\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl, useCache: false, inflate: true });\n    environmentScene.appendChild(environmentEl);\n  } else {\n    // Change environment\n    environmentEl = environmentScene.childNodes[0];\n\n    // Clear the three.js image cache and load the loading environment before switching to the new one.\n    THREE.Cache.clear();\n    const waypointSystem = sceneEl.systems[\"hubs-systems\"].waypointSystem;\n    waypointSystem.releaseAnyOccupiedWaypoints();\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        environmentEl.addEventListener(\n          \"model-loaded\",\n          () => {\n            environmentEl.removeEventListener(\"model-error\", sceneErrorHandler);\n\n            envSystem.updateEnvironment(environmentEl);\n\n            console.log(`Scene file update load took ${Math.round(performance.now() - loadStart)}ms`);\n\n            traverseMeshesAndAddShapes(environmentEl);\n\n            // We've already entered, so move to new spawn point once new environment is loaded\n            if (sceneEl.is(\"entered\")) {\n              waypointSystem.moveToSpawnPoint();\n            }\n\n            const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\n\n            // Add a slight delay before de-in to reduce hitching.\n            setTimeout(() => fader.fadeIn(), 2000);\n          },\n          { once: true }\n        );\n\n        sceneEl.emit(\"leaving_loading_environment\");\n        if (environmentEl.components[\"gltf-model-plus\"].data.src === sceneUrl) {\n          console.warn(\"Updating environment to the same url.\");\n          environmentEl.setAttribute(\"gltf-model-plus\", { src: \"\" });\n        }\n        environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl });\n      },\n      { once: true }\n    );\n\n    if (!sceneEl.is(\"entered\")) {\n      environmentEl.addEventListener(\"model-error\", sceneErrorHandler, { once: true });\n    }\n\n    if (environmentEl.components[\"gltf-model-plus\"].data.src === loadingEnvironment) {\n      console.warn(\"Transitioning to loading environment but was already in loading environment.\");\n      environmentEl.setAttribute(\"gltf-model-plus\", { src: \"\" });\n    }\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: loadingEnvironment });\n  }\n}\n\nexport async function updateUIForHub(hub, hubChannel) {\n  remountUI({ hub, entryDisallowed: !hubChannel.canEnterRoom(hub) });\n}\n\nfunction onConnectionError(entryManager, connectError) {\n  console.error(\"An error occurred while attempting to connect to networked scene:\", connectError);\n  // hacky until we get return codes\n  const isFull = connectError.msg && connectError.msg.match(/\\bfull\\b/i);\n  remountUI({ roomUnavailableReason: isFull ? ExitReason.full : ExitReason.connectError });\n  entryManager.exitScene();\n}\n\n// TODO: Find a home for this\n// TODO: Naming. Is this an \"event bus\"?\nconst events = emitter();\nfunction handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data, permsToken) {\n  const scene = document.querySelector(\"a-scene\");\n  const isRejoin = NAF.connection.isConnected();\n\n  if (isRejoin) {\n    // Slight hack, to ensure correct presence state we need to re-send the entry event\n    // on re-join. Ideally this would be updated into the channel socket state but this\n    // would require significant changes to the hub channel events and socket management.\n    if (scene.is(\"entered\")) {\n      hubChannel.sendEnteredEvent();\n    }\n\n    // Send complete sync on phoenix re-join.\n    // TODO: We should be able to safely remove this completeSync now that\n    //       NAF occupancy is driven from phoenix presence state.\n    NAF.connection.entities.completeSync(null, true);\n    return;\n  }\n\n  // Turn off NAF for embeds as an optimization, so the user's browser isn't getting slammed\n  // with NAF traffic on load.\n  if (isEmbed) {\n    hubChannel.allowNAFTraffic(false);\n  }\n\n  const hub = data.hubs[0];\n  let embedToken = hub.embed_token;\n\n  if (!embedToken) {\n    const embedTokenEntry = store.state.embedTokens && store.state.embedTokens.find(t => t.hubId === hub.hub_id);\n\n    if (embedTokenEntry) {\n      embedToken = embedTokenEntry.embedToken;\n    }\n  }\n\n  console.log(`Dialog host: ${hub.host}:${hub.port}`);\n\n  remountUI({\n    messageDispatch: messageDispatch,\n    onSendMessage: messageDispatch.dispatch,\n    onLoaded: () => store.executeOnLoadActions(scene),\n    onMediaSearchResultEntrySelected: (entry, selectAction) =>\n      scene.emit(\"action_selected_media_result_entry\", { entry, selectAction }),\n    onMediaSearchCancelled: entry => scene.emit(\"action_media_search_cancelled\", entry),\n    onAvatarSaved: entry => scene.emit(\"action_avatar_saved\", entry),\n    embedToken: embedToken\n  });\n\n  scene.addEventListener(\"action_selected_media_result_entry\", e => {\n    const { entry, selectAction } = e.detail;\n    if ((entry.type !== \"scene_listing\" && entry.type !== \"scene\") || selectAction !== \"use\") return;\n    if (!hubChannel.can(\"update_hub\")) return;\n\n    hubChannel.updateScene(entry.url);\n  });\n\n  // Handle request for user gesture\n  scene.addEventListener(\"2d-interstitial-gesture-required\", () => {\n    remountUI({\n      showInterstitialPrompt: true,\n      onInterstitialPromptClicked: () => {\n        remountUI({ showInterstitialPrompt: false, onInterstitialPromptClicked: null });\n        scene.emit(\"2d-interstitial-gesture-complete\");\n      }\n    });\n  });\n\n  scene.addEventListener(\n    \"didConnectToNetworkedScene\",\n    () => {\n      // Append objects once we are in the NAF room since ownership may be taken.\n      const objectsScene = document.querySelector(\"#objects-scene\");\n      const objectsUrl = getReticulumFetchUrl(`/${hub.hub_id}/objects.gltf`);\n      const objectsEl = document.createElement(\"a-entity\");\n\n      objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\n\n      if (!isBotMode) {\n        objectsScene.appendChild(objectsEl);\n      }\n    },\n    { once: true }\n  );\n\n  scene.setAttribute(\"networked-scene\", {\n    room: hub.hub_id,\n    serverURL: `wss://${hub.host}:${hub.port}`, // TODO: This is confusing because this is the dialog host and port.\n    debug: !!isDebug,\n    adapter: \"phoenix\"\n  });\n\n  (async () => {\n    while (!scene.components[\"networked-scene\"] || !scene.components[\"networked-scene\"].data) await nextTick();\n\n    const loadEnvironmentAndConnect = () => {\n      console.log(\"Loading environment and connecting to dialog servers\");\n\n      updateEnvironmentForHub(hub, entryManager);\n\n      // Disconnect in case this is a re-entry\n      APP.dialog.disconnect();\n      APP.dialog.connect({\n        serverUrl: `wss://${hub.host}:${hub.port}`,\n        roomId: hub.hub_id,\n        joinToken: permsToken,\n        serverParams: { host: hub.host, port: hub.port, turn: hub.turn },\n        scene,\n        clientId: data.session_id,\n        forceTcp: qs.get(\"force_tcp\"),\n        forceTurn: qs.get(\"force_turn\"),\n        iceTransportPolicy: qs.get(\"force_tcp\") || qs.get(\"force_turn\") ? \"relay\" : \"all\"\n      });\n      scene.addEventListener(\n        \"adapter-ready\",\n        ({ detail: adapter }) => {\n          adapter.hubChannel = hubChannel;\n          adapter.events = events;\n          adapter.session_id = data.session_id;\n        },\n        { once: true }\n      );\n      scene.components[\"networked-scene\"]\n        .connect()\n        .then(() => {\n          scene.emit(\"didConnectToNetworkedScene\");\n        })\n        .catch(connectError => {\n          onConnectionError(entryManager, connectError);\n        });\n    };\n\n    window.APP.hub = hub;\n    updateUIForHub(hub, hubChannel);\n    scene.emit(\"hub_updated\", { hub });\n\n    if (!isEmbed) {\n      console.log(\"Page is not embedded so environment initialization will start immediately\");\n      loadEnvironmentAndConnect();\n    } else {\n      console.log(\"Page is embedded so environment initialization will be deferred\");\n      remountUI({\n        onPreloadLoadClicked: () => {\n          console.log(\"Preload has been activated\");\n          hubChannel.allowNAFTraffic(true);\n          remountUI({ showPreload: false });\n          loadEnvironmentAndConnect();\n        }\n      });\n    }\n  })();\n}\n\nasync function runBotMode(scene, entryManager) {\n  console.log(\"Running in bot mode...\");\n  const noop = () => {};\n  const alwaysFalse = () => false;\n  scene.renderer = {\n    setAnimationLoop: noop,\n    render: noop,\n    shadowMap: {},\n    vr: { isPresenting: alwaysFalse },\n    setSize: noop\n  };\n\n  while (!NAF.connection.isConnected()) await nextTick();\n  entryManager.enterSceneWhenLoaded(false, false);\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n  if (isOAuthModal) {\n    return;\n  }\n\n  await store.initProfile();\n\n  const canvas = document.querySelector(\".a-canvas\");\n  canvas.classList.add(\"a-hidden\");\n\n  if (platformUnsupported()) {\n    return;\n  }\n\n  const detectedOS = detectOS(navigator.userAgent);\n  const browser = detect();\n  // HACK - it seems if we don't initialize the mic track up-front, voices can drop out on iOS\n  // safari when initializing it later.\n  if ([\"iOS\", \"Mac OS\"].includes(detectedOS) && [\"safari\", \"ios\"].includes(browser.name)) {\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n    } catch (e) {\n      remountUI({ showSafariMicDialog: true });\n      return;\n    }\n  }\n\n  const hubId = getCurrentHubId();\n  console.log(`Hub ID: ${hubId}`);\n\n  // 외부 js 파일 만들어서 불러오기\n  const scriptTag = document.createElement(\"script\");\n  scriptTag.src = \"https://metatest.nztoverse.com/_clickEvent.js?\" + new Date().getMilliseconds();\n  document.body.append(scriptTag);\n\n  const shouldRedirectToSignInPage =\n    // Default room won't work if account is required to access\n    !configs.feature(\"default_room_id\") &&\n    configs.feature(\"require_account_for_join\") &&\n    !(store.state.credentials && store.state.credentials.token);\n  if (shouldRedirectToSignInPage) {\n    document.location = `/?sign_in&sign_in_destination=hub&sign_in_destination_url=${encodeURIComponent(\n      document.location.toString()\n    )}`;\n  }\n\n  const subscriptions = new Subscriptions(hubId);\n  APP.subscriptions = subscriptions;\n  subscriptions.register();\n\n  const scene = document.querySelector(\"a-scene\");\n  window.APP.scene = scene;\n\n  const onSceneLoaded = () => {\n    const physicsSystem = scene.systems[\"hubs-systems\"].physicsSystem;\n    physicsSystem.setDebug(isDebug || physicsSystem.debug);\n  };\n  if (scene.hasLoaded) {\n    onSceneLoaded();\n  } else {\n    scene.addEventListener(\"loaded\", onSceneLoaded, { once: true });\n  }\n\n  // If the stored avatar doesn't have a valid src, reset to a legacy avatar.\n  const avatarSrc = await getAvatarSrc(store.state.profile.avatarId);\n  if (!avatarSrc) {\n    await store.resetToRandomDefaultAvatar();\n  }\n\n  const authChannel = new AuthChannel(store);\n  const hubChannel = new HubChannel(store, hubId);\n  window.APP.hubChannel = hubChannel;\n\n  const entryManager = new SceneEntryManager(hubChannel, authChannel, history);\n  window.APP.entryManager = entryManager;\n\n  APP.dialog.on(DIALOG_CONNECTION_CONNECTED, () => {\n    scene.emit(\"didConnectToDialog\");\n  });\n  APP.dialog.on(DIALOG_CONNECTION_ERROR_FATAL, () => {\n    // TODO: Change the wording of the connect error to match dialog connection error\n    // TODO: Tell the user that dialog is broken, but don't completely end the experience\n    remountUI({ roomUnavailableReason: ExitReason.connectError });\n    APP.entryManager.exitScene();\n  });\n\n  const audioSystem = scene.systems[\"hubs-systems\"].audioSystem;\n  APP.mediaDevicesManager = new MediaDevicesManager(scene, store, audioSystem);\n\n  const performConditionalSignIn = async (predicate, action, signInMessage, onFailure) => {\n    if (predicate()) return action();\n\n    await handleExitTo2DInterstitial(true, () => remountUI({ showSignInDialog: false }));\n\n    remountUI({\n      showSignInDialog: true,\n      signInMessage,\n      onContinueAfterSignIn: async () => {\n        remountUI({ showSignInDialog: false, onContinueAfterSignIn: null });\n        let actionError = null;\n        if (predicate()) {\n          try {\n            await action();\n          } catch (e) {\n            actionError = e;\n          }\n        } else {\n          actionError = new Error(\"Predicate failed post sign-in\");\n        }\n\n        if (actionError && onFailure) onFailure(actionError);\n        exit2DInterstitialAndEnterVR();\n      }\n    });\n  };\n\n  window.APP.pinningHelper = new PinningHelper(hubChannel, authChannel, store, performConditionalSignIn);\n\n  window.addEventListener(\"action_create_avatar\", () => {\n    performConditionalSignIn(\n      () => hubChannel.signedIn,\n      () => pushHistoryState(history, \"overlay\", \"avatar-editor\"),\n      SignInMessages.createAvatar\n    );\n  });\n\n  scene.addEventListener(\"scene_media_selected\", e => {\n    const sceneInfo = e.detail;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_hub\"),\n      () => hubChannel.updateScene(sceneInfo),\n      SignInMessages.changeScene\n    );\n  });\n\n  remountUI({\n    performConditionalSignIn,\n    embed: isEmbed,\n    showPreload: isEmbed\n  });\n  entryManager.performConditionalSignIn = performConditionalSignIn;\n  entryManager.init();\n\n  const linkChannel = new LinkChannel(store);\n  window.dispatchEvent(new CustomEvent(\"hub_channel_ready\"));\n\n  const handleEarlyVRMode = () => {\n    // If VR headset is activated, refreshing page will fire vrdisplayactivate\n    // which puts A-Frame in VR mode, so exit VR mode whenever it is attempted\n    // to be entered and we haven't entered the room yet.\n    if (scene.is(\"vr-mode\") && !scene.is(\"vr-entered\") && !isMobileVR) {\n      console.log(\"Pre-emptively exiting VR mode.\");\n      scene.exitVR();\n      return true;\n    }\n\n    return false;\n  };\n  remountUI({ availableVREntryTypes: ONLY_SCREEN_AVAILABLE, checkingForDeviceAvailability: true });\n  const availableVREntryTypesPromise = getAvailableVREntryTypes();\n  scene.addEventListener(\"enter-vr\", () => {\n    if (handleEarlyVRMode()) return true;\n\n    if (isMobileVR) {\n      // Optimization, stop drawing UI if not visible\n      remountUI({ hide: true });\n    }\n\n    document.body.classList.add(\"vr-mode\");\n\n    availableVREntryTypesPromise.then(availableVREntryTypes => {\n      // Don't stretch canvas on cardboard, since that's drawing the actual VR view :)\n      if ((!isMobile && !isMobileVR) || availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.yes) {\n        document.body.classList.add(\"vr-mode-stretch\");\n      }\n    });\n  });\n  handleEarlyVRMode();\n\n  // HACK A-Frame 0.9.0 seems to fail to wire up vrdisplaypresentchange early enough\n  // to catch presentation state changes and recognize that an HMD is presenting on startup.\n  window.addEventListener(\n    \"vrdisplaypresentchange\",\n    () => {\n      if (scene.is(\"vr-entered\")) return;\n      if (scene.is(\"vr-mode\")) return;\n\n      const device = AFRAME.utils.device.getVRDisplay();\n\n      if (device && device.isPresenting) {\n        if (!scene.is(\"vr-mode\")) {\n          console.warn(\"Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode.\");\n          scene.enterVR();\n        }\n      }\n    },\n    { once: true }\n  );\n\n  scene.addEventListener(\"exit-vr\", () => {\n    document.body.classList.remove(\"vr-mode\");\n    document.body.classList.remove(\"vr-mode-stretch\");\n\n    remountUI({ hide: false });\n\n    // HACK: Oculus browser pauses videos when exiting VR mode, so we need to resume them after a timeout.\n    if (/OculusBrowser/i.test(window.navigator.userAgent)) {\n      document.querySelectorAll(\"[media-video]\").forEach(m => {\n        const videoComponent = m.components[\"media-video\"];\n\n        if (videoComponent) {\n          videoComponent._ignorePauseStateChanges = true;\n\n          setTimeout(() => {\n            const video = videoComponent.video;\n\n            if (video && video.paused && !videoComponent.data.videoPaused) {\n              video.play();\n            }\n\n            videoComponent._ignorePauseStateChanges = false;\n          }, 1000);\n        }\n      });\n    }\n  });\n\n  registerNetworkSchemas();\n\n  remountUI({\n    authChannel,\n    hubChannel,\n    linkChannel,\n    subscriptions,\n    enterScene: entryManager.enterScene,\n    exitScene: reason => {\n      entryManager.exitScene();\n      remountUI({ roomUnavailableReason: reason || ExitReason.exited });\n    }\n  });\n\n  scene.addEventListener(\"leave_room_requested\", () => {\n    entryManager.exitScene();\n    remountUI({ roomUnavailableReason: ExitReason.left });\n  });\n\n  scene.addEventListener(\"hub_closed\", () => {\n    scene.exitVR();\n    entryManager.exitScene();\n    remountUI({ roomUnavailableReason: ExitReason.closed });\n  });\n\n  scene.addEventListener(\"action_camera_recording_started\", () => hubChannel.beginRecording());\n  scene.addEventListener(\"action_camera_recording_ended\", () => hubChannel.endRecording());\n\n  if (qs.get(\"required_version\") && process.env.BUILD_VERSION) {\n    const buildNumber = process.env.BUILD_VERSION.split(\" \", 1)[0]; // e.g. \"123 (abcd5678)\"\n\n    if (qs.get(\"required_version\") !== buildNumber) {\n      remountUI({ roomUnavailableReason: ExitReason.versionMismatch });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  }\n\n  getReticulumMeta().then(reticulumMeta => {\n    console.log(`Reticulum @ ${reticulumMeta.phx_host}: v${reticulumMeta.version} on ${reticulumMeta.pool}`);\n\n    if (\n      qs.get(\"required_ret_version\") &&\n      (qs.get(\"required_ret_version\") !== reticulumMeta.version || qs.get(\"required_ret_pool\") !== reticulumMeta.pool)\n    ) {\n      remountUI({ roomUnavailableReason: ExitReason.versionMismatch });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  });\n\n  availableVREntryTypesPromise.then(async availableVREntryTypes => {\n    if (isMobileVR) {\n      remountUI({\n        availableVREntryTypes,\n        forcedVREntryType: qsVREntryType || \"vr\",\n        checkingForDeviceAvailability: false\n      });\n\n      if (/Oculus/.test(navigator.userAgent) && \"getVRDisplays\" in navigator) {\n        // HACK - The polyfill reports Cardboard as the primary VR display on startup out ahead of\n        // Oculus Go on Oculus Browser 5.5.0 beta. This display is cached by A-Frame,\n        // so we need to resolve that and get the real VRDisplay before entering as well.\n        const displays = await navigator.getVRDisplays();\n        const vrDisplay = displays.length && displays[0];\n        AFRAME.utils.device.getVRDisplay = () => vrDisplay;\n      }\n    } else {\n      const hasVREntryDevice =\n        availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no ||\n        availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no ||\n        availableVREntryTypes.daydream !== VR_DEVICE_AVAILABILITY.no;\n\n      remountUI({\n        availableVREntryTypes,\n        forcedVREntryType: qsVREntryType || (!hasVREntryDevice ? \"2d\" : null),\n        checkingForDeviceAvailability: false\n      });\n    }\n  });\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n  environmentScene.addEventListener(\n    \"model-loaded\",\n    () => {\n      // Replace renderer with a noop renderer to reduce bot resource usage.\n      if (isBotMode) {\n        runBotMode(scene, entryManager);\n      }\n    },\n    { once: true }\n  );\n\n  environmentScene.addEventListener(\"model-loaded\", ({ detail: { model } }) => {\n    console.log(\"Environment scene has loaded\");\n\n    if (!scene.is(\"entered\")) {\n      setupLobbyCamera();\n    }\n\n    // This will be run every time the environment is changed (including the first load.)\n    remountUI({ environmentSceneLoaded: true });\n    scene.emit(\"environment-scene-loaded\", model);\n\n    // Re-bind the teleporter controls collision meshes in case the scene changed.\n    document.querySelectorAll(\"a-entity[teleporter]\").forEach(x => x.components[\"teleporter\"].queryCollisionEntities());\n\n    for (const modelEl of environmentScene.children) {\n      addAnimationComponents(modelEl);\n    }\n  });\n\n  // Socket disconnects on refresh but we don't want to show exit scene in that scenario.\n  let isReloading = false;\n  window.addEventListener(\"beforeunload\", () => (isReloading = true));\n\n  const socket = await connectToReticulum(isDebug);\n\n  socket.onClose(e => {\n    // We don't currently have an easy way to distinguish between being kicked (server closes socket)\n    // and a variety of other network issues that seem to produce the 1000 closure code, but the\n    // latter are probably more common. Either way, we just tell the user they got disconnected.\n    const NORMAL_CLOSURE = 1000;\n\n    if (e.code === NORMAL_CLOSURE && !isReloading) {\n      entryManager.exitScene();\n      remountUI({ roomUnavailableReason: ExitReason.disconnected });\n    }\n  });\n\n  // Reticulum global channel\n  APP.retChannel = socket.channel(`ret`, { hub_id: hubId });\n  APP.retChannel\n    .join()\n    .receive(\"ok\", data => {\n      subscriptions.setVapidPublicKey(data.vapid_public_key);\n    })\n    .receive(\"error\", res => {\n      subscriptions.setVapidPublicKey(null);\n      console.error(res);\n    });\n\n  const pushSubscriptionEndpoint = await subscriptions.getCurrentEndpoint();\n\n  APP.hubChannelParamsForPermsToken = permsToken => {\n    return createHubChannelParams({\n      profile: store.state.profile,\n      pushSubscriptionEndpoint,\n      permsToken,\n      isMobile,\n      isMobileVR,\n      isEmbed,\n      hubInviteId: qs.get(\"hub_invite_id\"),\n      authToken: store.state.credentials && store.state.credentials.token\n    });\n  };\n\n  const migrateToNewReticulumServer = async ({ ret_version, ret_pool }, shouldAbandonMigration) => {\n    console.log(`[reconnect] Reticulum deploy detected v${ret_version} on ${ret_pool}.`);\n\n    const didMatchMeta = await tryGetMatchingMeta({ ret_version, ret_pool }, shouldAbandonMigration);\n    if (!didMatchMeta) {\n      console.error(`[reconnect] Failed to reconnect. Did not get meta for v${ret_version} on ${ret_pool}.`);\n      return;\n    }\n\n    console.log(\"[reconnect] Reconnect in progress. Updated reticulum meta.\");\n    const oldSocket = APP.retChannel.socket;\n    const socket = await connectToReticulum(isDebug, oldSocket.params());\n    APP.retChannel = await migrateChannelToSocket(APP.retChannel, socket);\n    await hubChannel.migrateToSocket(socket, APP.hubChannelParamsForPermsToken());\n    authChannel.setSocket(socket);\n    linkChannel.setSocket(socket);\n\n    // Disconnect old socket after a delay to ensure this user is always registered in presence.\n    await sleep(10000);\n    oldSocket.teardown();\n    console.log(\"[reconnect] Reconnection successful.\");\n  };\n\n  const onRetDeploy = (function () {\n    let pendingNotification = null;\n    const hasPendingNotification = function () {\n      return !!pendingNotification;\n    };\n\n    const handleNextMessage = (function () {\n      let isLocked = false;\n      return async function handleNextMessage() {\n        if (isLocked || !pendingNotification) return;\n\n        isLocked = true;\n        const currentNotification = Object.assign({}, pendingNotification);\n        pendingNotification = null;\n        try {\n          await migrateToNewReticulumServer(currentNotification, hasPendingNotification);\n        } catch {\n          console.error(\"Failed to migrate to new reticulum server after deploy.\", currentNotification);\n        } finally {\n          isLocked = false;\n          handleNextMessage();\n        }\n      };\n    })();\n\n    return function onRetDeploy(deployNotification) {\n      // If for some reason we receive multiple deployNotifications, only the\n      // most recent one matters. The rest can be overwritten.\n      pendingNotification = deployNotification;\n      handleNextMessage();\n    };\n  })();\n\n  APP.retChannel.on(\"notice\", data => {\n    if (data.event === \"ret-deploy\") {\n      onRetDeploy(data);\n    }\n  });\n\n  const messageDispatch = new MessageDispatch(scene, entryManager, hubChannel, remountUI, mediaSearchStore);\n  APP.messageDispatch = messageDispatch;\n  document.getElementById(\"avatar-rig\").messageDispatch = messageDispatch;\n\n  const oauthFlowPermsToken = Cookies.get(OAUTH_FLOW_PERMS_TOKEN_KEY);\n  if (oauthFlowPermsToken) {\n    Cookies.remove(OAUTH_FLOW_PERMS_TOKEN_KEY);\n  }\n  const hubPhxChannel = socket.channel(`hub:${hubId}`, APP.hubChannelParamsForPermsToken(oauthFlowPermsToken));\n  hubChannel.channel = hubPhxChannel;\n  hubChannel.presence = new Presence(hubPhxChannel);\n  const { rawOnJoin, rawOnLeave } = denoisePresence(presenceEventsForHub(events));\n  hubChannel.presence.onJoin(rawOnJoin);\n  hubChannel.presence.onLeave(rawOnLeave);\n  hubChannel.presence.onSync(() => {\n    events.trigger(`hub:sync`, { presence: hubChannel.presence });\n  });\n\n  events.on(`hub:join`, ({ key, meta }) => {\n    scene.emit(\"presence_updated\", {\n      sessionId: key,\n      profile: meta.profile,\n      roles: meta.roles,\n      permissions: meta.permissions,\n      streaming: meta.streaming,\n      recording: meta.recording,\n      hand_raised: meta.hand_raised,\n      typing: meta.typing\n    });\n  });\n  events.on(`hub:join`, ({ key, meta }) => {\n    if (\n      APP.hideHubPresenceEvents ||\n      key === hubChannel.channel.socket.params().session_id ||\n      hubChannel.presence.list().length > NOISY_OCCUPANT_COUNT\n    ) {\n      return;\n    }\n    messageDispatch.receive({\n      type: \"join\",\n      presence: meta.presence,\n      name: meta.profile.displayName\n    });\n  });\n\n  events.on(`hub:leave`, ({ meta }) => {\n    if (APP.hideHubPresenceEvents || hubChannel.presence.list().length > NOISY_OCCUPANT_COUNT) {\n      return;\n    }\n    messageDispatch.receive({\n      type: \"leave\",\n      name: meta.profile.displayName\n    });\n  });\n\n  events.on(`hub:change`, ({ key, previous, current }) => {\n    if (\n      previous.presence === current.presence ||\n      current.presence !== \"room\" ||\n      key === hubChannel.channel.socket.params().session_id\n    ) {\n      return;\n    }\n\n    messageDispatch.receive({\n      type: \"entered\",\n      presence: current.presence,\n      name: current.profile.displayName\n    });\n  });\n  events.on(`hub:change`, ({ previous, current }) => {\n    if (previous.profile.displayName !== current.profile.displayName) {\n      messageDispatch.receive({\n        type: \"display_name_changed\",\n        oldName: previous.profile.displayName,\n        newName: current.profile.displayName\n      });\n    }\n  });\n  events.on(`hub:change`, ({ key, previous, current }) => {\n    if (\n      key === hubChannel.channel.socket.params().session_id &&\n      previous.profile.avatarId !== current.profile.avatarId\n    ) {\n      messageDispatch.log(LogMessageType.avatarChanged);\n    }\n  });\n  events.on(`hub:change`, ({ key, current }) => {\n    scene.emit(\"presence_updated\", {\n      sessionId: key,\n      profile: current.profile,\n      roles: current.roles,\n      permissions: current.permissions,\n      streaming: current.streaming,\n      recording: current.recording,\n      hand_raised: current.hand_raised,\n      typing: current.typing\n    });\n  });\n\n  // We need to be able to wait for initial presence syncs across reconnects and socket migrations,\n  // so we create this object in the outer scope and assign it a new promise on channel join.\n  const presenceSync = {\n    promise: null,\n    resolve: null\n  };\n  events.on(\"hub:sync\", () => {\n    presenceSync.resolve();\n  });\n  events.on(`hub:sync`, () => {\n    APP.hideHubPresenceEvents = false;\n  });\n  events.on(`hub:sync`, updateVRHudPresenceCount);\n  events.on(`hub:sync`, ({ presence }) => {\n    updateSceneCopresentState(presence, scene);\n  });\n  events.on(`hub:sync`, ({ presence }) => {\n    remountUI({\n      sessionId: socket.params().session_id,\n      presences: presence.state,\n      entryDisallowed: !hubChannel.canEnterRoom(uiProps.hub)\n    });\n  });\n\n  hubPhxChannel\n    .join()\n    .receive(\"ok\", async data => {\n      APP.hideHubPresenceEvents = true;\n      presenceSync.promise = new Promise(resolve => {\n        presenceSync.resolve = resolve;\n      });\n\n      socket.params().session_id = data.session_id;\n      socket.params().session_token = data.session_token;\n\n      const permsToken = oauthFlowPermsToken || data.perms_token;\n      hubChannel.setPermissionsFromToken(permsToken);\n\n      subscriptions.setHubChannel(hubChannel);\n      subscriptions.setSubscribed(data.subscriptions.web_push);\n\n      remountUI({\n        hubIsBound: data.hub_requires_oauth,\n        initialIsFavorited: data.subscriptions.favorites\n      });\n\n      await presenceSync.promise;\n      handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data, permsToken, hubChannel, events);\n    })\n    .receive(\"error\", res => {\n      if (res.reason === \"closed\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: ExitReason.closed });\n      } else if (res.reason === \"oauth_required\") {\n        entryManager.exitScene();\n        remountUI({ oauthInfo: res.oauth_info, showOAuthScreen: true });\n      } else if (res.reason === \"join_denied\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: ExitReason.denied });\n      }\n\n      console.error(res);\n    });\n\n  hubPhxChannel.on(\"message\", ({ session_id, type, body, from }) => {\n    const getAuthor = () => {\n      const userInfo = hubChannel.presence.state[session_id];\n      if (from) {\n        return from;\n      } else if (userInfo) {\n        return userInfo.metas[0].profile.displayName;\n      } else {\n        return \"Mystery user\";\n      }\n    };\n\n    const name = getAuthor();\n    const maySpawn = scene.is(\"entered\");\n\n    const incomingMessage = {\n      name,\n      type,\n      body,\n      maySpawn,\n      sessionId: session_id,\n      sent: session_id === socket.params().session_id\n    };\n\n    if (scene.is(\"vr-mode\")) {\n      createInWorldLogMessage(incomingMessage);\n    }\n\n    messageDispatch.receive(incomingMessage);\n  });\n\n  hubPhxChannel.on(\"hub_refresh\", ({ session_id, hubs, stale_fields }) => {\n    const hub = hubs[0];\n    const userInfo = hubChannel.presence.state[session_id];\n    const displayName = (userInfo && userInfo.metas[0].profile.displayName) || \"API\";\n\n    window.APP.hub = hub;\n    updateUIForHub(hub, hubChannel);\n\n    if (\n      stale_fields.includes(\"scene\") ||\n      stale_fields.includes(\"scene_listing\") ||\n      stale_fields.includes(\"default_environment_gltf_bundle_url\")\n    ) {\n      const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\n\n      fader.fadeOut().then(() => {\n        scene.emit(\"reset_scene\");\n        updateEnvironmentForHub(hub, entryManager);\n      });\n\n      messageDispatch.receive({\n        type: \"scene_changed\",\n        name: displayName,\n        sceneName: hub.scene ? hub.scene.name : \"a custom URL\"\n      });\n    }\n\n    if (stale_fields.includes(\"member_permissions\")) {\n      hubChannel.fetchPermissions();\n    }\n\n    if (stale_fields.includes(\"name\")) {\n      const titleParts = document.title.split(\" | \"); // Assumes title has | trailing site name\n      titleParts[0] = hub.name;\n      document.title = titleParts.join(\" | \");\n\n      // Re-write the slug in the browser history\n      const pathParts = history.location.pathname.split(\"/\");\n      const oldSlug = pathParts[1];\n      const { search, state } = history.location;\n      const pathname = history.location.pathname.replace(`/${oldSlug}`, `/${hub.slug}`);\n\n      history.replace({ pathname, search, state });\n\n      messageDispatch.receive({\n        type: \"hub_name_changed\",\n        name: displayName,\n        hubName: hub.name\n      });\n    }\n\n    if (hub.entry_mode === \"deny\") {\n      scene.emit(\"hub_closed\");\n    }\n\n    scene.emit(\"hub_updated\", { hub });\n  });\n\n  hubPhxChannel.on(\"permissions_updated\", () => hubChannel.fetchPermissions());\n\n  hubPhxChannel.on(\"mute\", ({ session_id }) => {\n    if (session_id === NAF.clientId) {\n      APP.mediaDevicesManager.micEnabled = false;\n    }\n  });\n\n  authChannel.setSocket(socket);\n  linkChannel.setSocket(socket);\n});\n","// Stores a key in localStorage and registeres a listener for the same key being set (by another tab).\n// When detected, fire a \"concurrentload\" event.\nexport default function detectConcurrentLoad(instanceKey = \"global\") {\n  const key = `___concurrent_load_detector_${instanceKey}`;\n  localStorage.setItem(key, JSON.stringify({ started_at: new Date() }));\n  const onStorageEvent = e => {\n    if (e.key !== key) return;\n    window.dispatchEvent(new CustomEvent(\"concurrentload\"));\n    window.removeEventListener(\"storage\", onStorageEvent);\n  };\n  window.addEventListener(\"storage\", onStorageEvent);\n}\n","export function emitter() {\n  let bindings = [];\n  let bindingRef = 0;\n  const on = (event, callback) => {\n    const ref = bindingRef++;\n    bindings.push({ event, ref, callback });\n    return ref;\n  };\n  const off = (event, ref) => {\n    bindings = bindings.filter(bind => {\n      return !(bind.event === event && (typeof ref === \"undefined\" || ref === bind.ref));\n    });\n  };\n  const trigger = (event, payload) => {\n    bindings.filter(bind => bind.event === event).forEach(bind => {\n      bind.callback(payload);\n    });\n  };\n  const getBindings = () => {\n    return bindings;\n  };\n  return {\n    on,\n    off,\n    trigger,\n    getBindings\n  };\n}\n","function registerNetworkSchemas() {\n  const vectorRequiresUpdate = epsilon => {\n    return () => {\n      let prev = null;\n\n      return curr => {\n        if (prev === null) {\n          prev = new THREE.Vector3(curr.x, curr.y, curr.z);\n          return true;\n        } else if (!NAF.utils.almostEqualVec3(prev, curr, epsilon)) {\n          prev.copy(curr);\n          return true;\n        }\n\n        return false;\n      };\n    };\n  };\n\n  // Note: networked template ids are semantically important. We use the template suffix as a filter\n  // for allowing and authorizing messages in reticulum.\n  // See `spawn_permitted?` in https://github.com/mozilla/reticulum/blob/master/lib/ret_web/channels/hub_channel.ex\n\n  // NAF schemas have been extended with a custom nonAuthorizedComponents property that is used to skip authorization\n  // on certain components and properties regardless of hub or user permissions. See permissions-utils.js.\n\n  NAF.schemas.add({\n    template: \"#remote-avatar\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"player-info\",\n      \"networked-avatar\",\n      {\n        selector: \".camera\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".camera\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"visible\"\n      },\n      {\n        selector: \".right-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"visible\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-media\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pdf\",\n        property: \"index\"\n      },\n      \"pinnable\"\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-emoji\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"emoji\",\n        property: \"emitEndTime\"\n      },\n      {\n        component: \"emoji\",\n        property: \"particleEmitterConfig\"\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"media-loader\",\n      \"pinnable\",\n      {\n        selector: \".particle-emitter\",\n        component: \"particle-emitter\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-controlled-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pdf\",\n        property: \"index\"\n      }\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-drawing\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"networked-drawing\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#template-waypoint-avatar\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"waypoint\"\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"waypoint\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-pen\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"radius\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"color\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"drawMode\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"penVisible\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen-laser\",\n        property: \"laserVisible\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen-laser\",\n        property: \"remoteLaserOrigin\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen-laser\",\n        property: \"laserTarget\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      }\n    ]\n  });\n}\n\nexport default registerNetworkSchemas;\n","/* global AFRAME */\n\n/**\n * Toggle visibility of an entity based on if the user is in vr mode or not\n * @namespace vr-mode\n * @component vr-mode-toggle-visibility\n */\nAFRAME.registerComponent(\"vr-mode-toggle-visibility\", {\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.setAttribute(\"visible\", inVRMode !== this.data.invert);\n  }\n});\n\n/**\n * Toggle the isPlaying state of a component based on app mode\n * @namespace vr-mode\n * @component vr-mode-toggle-playing\n */\nAFRAME.registerComponent(\"vr-mode-toggle-playing\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const componentName = this.id;\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.components[componentName][inVRMode !== this.data.invert ? \"play\" : \"pause\"]();\n  }\n});\n\n/**\n * Toggle a CSS class based upon app mode.\n * @namespace vr-mode\n * @component vr-mode-toggle-class\n */\nAFRAME.registerComponent(\"vr-mode-toggle-class\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false },\n    class: { type: \"string\", default: \"\" }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n\n    if (inVRMode) {\n      this.el.classList.add(this.data.class);\n    } else {\n      this.el.classList.remove(this.data.class);\n    }\n  }\n});\n","// On high-DPI displays, measures the median FPS over time and reduces the\n// pixelRatio if the FPS drops below a threshold.\n\nconst LOW_FPS_THRESHOLD = 30;\nconst HIGH_FPS_THRESHOLD = 48;\nconst SKIP_SECONDS_AFTER_SCENE_VISIBLE = 30;\nconst MEASUREMENT_PERIOD_SECONDS = 5;\nconst MIN_PIXEL_RATIO = 1;\nconst CHANGE_RATE = 1;\nconst NUM_TIMES_DECREASED_BEFORE_CHANGING_MAX_PIXEL_RATIO = 3;\n\nAFRAME.registerSystem(\"auto-pixel-ratio\", {\n  init() {\n    // For now let's only enabled this on macs, since they tend to have retina displays.\n    // Note this test will also include iPads running iPadOS.\n    this.enabled = window.devicePixelRatio > 1 && /macintosh/i.test(navigator.userAgent);\n    this.deltas = [];\n    this.secondsSinceMeasurementStart = 0;\n    this.secondsSinceSceneVisible = 0;\n    this.maxPixelRatio = window.devicePixelRatio;\n    this.pixelRatioToTimesDecreased = {};\n\n    this.disabledByPref = window.APP.store.state.preferences.disableAutoPixelRatio;\n    this.onPreferenceChange = this.onPreferenceChange.bind(this);\n    window.APP.store.addEventListener(\"statechanged\", this.onPreferenceChange);\n  },\n  onPreferenceChange() {\n    this.disabledByPref = window.APP.store.state.preferences.disableAutoPixelRatio;\n  },\n  tick(time, delta) {\n    if (!this.enabled || this.disabledByPref || this.maxPixelRatio === MIN_PIXEL_RATIO) return;\n    if (!this.el.is(\"visible\")) return;\n    if (this.secondsSinceSceneVisible < SKIP_SECONDS_AFTER_SCENE_VISIBLE) {\n      this.secondsSinceSceneVisible += delta / 1000;\n      return;\n    }\n    if (document.visibilityState === \"hidden\") return;\n\n    this.deltas.push(delta);\n    this.secondsSinceMeasurementStart += delta / 1000;\n\n    if (this.secondsSinceMeasurementStart > MEASUREMENT_PERIOD_SECONDS) {\n      this.deltas.sort();\n      const medianDelta = this.deltas[Math.floor(this.deltas.length / 2)];\n      const medianFps = 1000 / medianDelta;\n\n      const currentPixelRatio = this.el.renderer.getPixelRatio();\n\n      const shouldDecrease = currentPixelRatio > MIN_PIXEL_RATIO && medianFps < LOW_FPS_THRESHOLD;\n      const shouldIncrease = currentPixelRatio < this.maxPixelRatio && medianFps > HIGH_FPS_THRESHOLD;\n      if (shouldDecrease || shouldIncrease) {\n        const newPixelRatio = currentPixelRatio + (CHANGE_RATE * shouldIncrease ? 1 : -1);\n        console.info(\n          `Hubs auto-pixel-ratio: Median FPS (${medianFps.toFixed()}) was ${\n            shouldIncrease ? `above ${HIGH_FPS_THRESHOLD}` : `below ${LOW_FPS_THRESHOLD}`\n          }. ` + `Adjusting pixel ratio to ${newPixelRatio}.`\n        );\n        this.el.renderer.setPixelRatio(newPixelRatio);\n        if (shouldDecrease) {\n          const timesDecreased = (this.pixelRatioToTimesDecreased[currentPixelRatio] || 0) + 1;\n          this.pixelRatioToTimesDecreased[currentPixelRatio] = timesDecreased;\n          if (timesDecreased >= NUM_TIMES_DECREASED_BEFORE_CHANGING_MAX_PIXEL_RATIO) {\n            console.info(\n              `Hubs auto-pixel-ratio: Attempts to maintain high frame rate with pixel ratio ${currentPixelRatio} failed ${timesDecreased} times and will not be attempted again. Lowering maximum pixel ratio to ${newPixelRatio}.`\n            );\n            this.maxPixelRatio = newPixelRatio;\n          }\n        }\n      }\n\n      // Clear deltas so that we start measuring a new median.\n      this.deltas.length = 0;\n      this.secondsSinceMeasurementStart = 0;\n    }\n  }\n});\n","/**\n * Emits an \"exit\" event when a user has stopped using the app for a certain period of time\n * @system exit-on-blur\n */\nAFRAME.registerSystem(\"exit-on-blur\", {\n  init() {\n    this.onBlur = this.onBlur.bind(this);\n    this.onFocus = this.onFocus.bind(this);\n    this.onTimeout = this.onTimeout.bind(this);\n    this.onEnterVR = this.onEnterVR.bind(this);\n\n    this.isOculusBrowser = navigator.userAgent.match(/Oculus/);\n    this.enteredVR = false;\n\n    window.addEventListener(\"blur\", this.onBlur);\n    window.addEventListener(\"focus\", this.onFocus);\n    this.el.addEventListener(\"enter-vr\", this.onEnterVR);\n\n    this.lastTimeoutCheck = 0;\n    this.exitTimeout = null;\n  },\n\n  tick(t) {\n    // This is a hack to detect when an Oculus Go user has taken off the headset and the headset has\n    // entered standby mode. Currently Oculus Browser is not emitting a blur, vrdisplaydeactivate,\n    // vrdisplayblur, visibilitychange, or vrdisplaypresentchange event, so we wait 15 seconds after\n    // the last requestAnimationFrame callback to determine if the headset has gone into standby mode.\n    // We also check that you have entered VR so that this timeout does not occur in the setup UI.\n    if (\n      this.isOculusBrowser &&\n      this.enteredVR &&\n      (this.lastTimeoutCheck === 0 || t - this.lastTimeoutCheck >= 1000.0) // Don't do this clear every frame, slow.\n    ) {\n      this.lastTimeoutCheck = t;\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onEnterVR() {\n    this.enteredVR = true;\n  },\n\n  onBlur() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onFocus() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n    }\n  },\n\n  onTimeout() {\n    if (window.APP.store.state.preferences.disableIdleDetection) return;\n    this.el.dispatchEvent(new CustomEvent(\"exit\"));\n  },\n\n  remove() {\n    clearTimeout(this.exitTimeout);\n    window.removeEventListener(\"blur\", this.onBlur);\n  }\n});\n","// Given a function and a queue name, schedules things so a single function\n// from a given queue will be called per frame.\nAFRAME.registerSystem(\"frame-scheduler\", {\n  init() {\n    // Registry a map from queue name to list of registered functions.\n    this.registry = new Map();\n    this.queues = [];\n    this.frameIndex = 0;\n  },\n\n  schedule(func, queue) {\n    if (!this.registry.has(queue)) {\n      this.queues.push(queue);\n      this.registry.set(queue, []);\n    }\n\n    this.registry.get(queue).push(func);\n  },\n\n  unschedule(func) {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      const idx = entries.indexOf(func);\n\n      if (idx >= 0) {\n        entries.splice(idx, 1);\n      }\n    }\n  },\n\n  tick: function() {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      if (entries.length === 0) continue;\n\n      entries[this.frameIndex % entries.length]();\n    }\n\n    this.frameIndex++;\n  }\n});\n","AFRAME.registerSystem(\"listed-media\", {\n  init: function() {\n    this.els = [];\n  },\n\n  register: function(el) {\n    this.els.push(el);\n    this.el.emit(\"listed_media_changed\");\n  },\n\n  unregister: function(el) {\n    this.els.splice(this.els.indexOf(el), 1);\n    this.el.emit(\"listed_media_changed\");\n  }\n});\n\nAFRAME.registerComponent(\"listed-media\", {\n  init: function() {\n    this.system.register(this.el);\n  },\n\n  remove: function() {\n    this.system.unregister(this.el);\n  }\n});\n","AFRAME.registerSystem(\"permissions\", {\n  onPermissionsUpdated(handler) {\n    if (window.APP.hubChannel) {\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", handler);\n    } else {\n      window.addEventListener(\n        \"hub_channel_ready\",\n        () => window.APP.hubChannel.addEventListener(\"permissions_updated\", handler),\n        { once: true }\n      );\n    }\n  },\n  can(permissionName) {\n    return !!window.APP.hubChannel.can(permissionName);\n  },\n  canOrWillIfCreator(permissionName) {\n    return !!window.APP.hubChannel.canOrWillIfCreator(permissionName);\n  },\n  fetchPermissions() {\n    return window.APP.hubChannel.fetchPermissions();\n  }\n});\n","import qsTruthy from \"./qs_truthy\";\n\nconst showLog = qsTruthy(\"debug_log\");\n\nif (showLog) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = `\n    <style>\n      #debug-log {\n        position: absolute;\n        top: 13em;\n        background: white;\n        opacity: 0.7;\n        z-index: 1000;\n      }\n      #debug-log, #debug-log-input {\n        font-family: monospace;\n        font-size: 11px;\n        width: 100%;\n      }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n    </style>\n    <div id=\"debug-log\">\n        <div id=\"debug-log-controls\">\n          <form id=\"debug-log-eval\">\n            <input id=\"debug-log-input\" placeholder=\"&gt;&gt;\" autocorrect=\"off\" autocapitalize=\"none\" />\n            <button>&gt;</button>\n          </form>\n          <button id=\"debug-log-minimize\">_</button>\n        </div>\n        <div id=\"debug-log-log\"></div>\n    </div>\n  `;\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    document.body.appendChild(template.content);\n  });\n\n  const debugLog = template.content.querySelector(\"#debug-log-log\");\n  debugLog.addEventListener(\"wheel\", e => e.stopPropagation());\n\n  const debugLogInput = template.content.querySelector(\"#debug-log-input\");\n  const debugLogEval = template.content.querySelector(\"#debug-log-eval\");\n  debugLogEval.onsubmit = e => {\n    e.preventDefault();\n    console.log(eval(`(${debugLogInput.value})`));\n  };\n\n  let minimized = false;\n  const debugLogMinimize = template.content.querySelector(\"#debug-log-minimize\");\n  debugLogMinimize.onclick = () => {\n    minimized = !minimized;\n    debugLog.className = minimized ? \"minimized\" : \"\";\n    debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  const origConsoleInfo = console.info;\n  const origConsoleLog = console.log;\n  const origConsoleError = console.error;\n  const origConsoleWarn = console.warn;\n\n  const log = function(className, objs) {\n    let entry;\n    if (debugLog.childNodes.length > 1000) {\n      entry = debugLog.firstChild;\n    } else {\n      entry = document.createElement(\"div\");\n      entry.classList.add(\"entry\");\n    }\n    entry.classList.remove(\"warn\", \"error\");\n    entry.classList.add(className);\n\n    const arr = Array.from(objs);\n    const firstObj = arr[0];\n    let content;\n    if (typeof firstObj === \"string\" && firstObj.includes(\"%c\")) {\n      content = firstObj.replace(/%c/g, \"\");\n    } else if (firstObj instanceof Error) {\n      content = `${firstObj.message}\\n${firstObj.stack}`;\n    } else {\n      content = arr\n        .map(obj => {\n          if (typeof obj === \"string\") return obj;\n          return JSON.stringify(obj);\n        })\n        .join(\" \");\n    }\n\n    const time = new Date().toISOString().substring(11, 23);\n    entry.textContent = `[${time}] ${content}`;\n\n    const shouldScroll = debugLog.scrollTop === debugLog.scrollHeight - debugLog.clientHeight;\n    debugLog.append(entry);\n    if (shouldScroll) debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  console.warn = function() {\n    origConsoleWarn.apply(null, arguments);\n    log(\"warn\", arguments);\n  };\n\n  console.error = function() {\n    origConsoleError.apply(null, arguments);\n    log(\"error\", arguments);\n  };\n\n  console.log = function() {\n    origConsoleLog.apply(null, arguments);\n    log(\"log\", arguments);\n  };\n\n  console.info = function() {\n    origConsoleInfo.apply(null, arguments);\n    log(\"info\", arguments);\n  };\n\n  window.onunhandledrejection = e => log(\"error\", [e.reason.message, e.reason.code, e.reason.name]);\n  window.onerror = e => log(\"error\", [e]);\n}\n","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n\nexport function qsGet(param) {\n  return qs.get(param);\n}\n","/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nTHREE.Water = function(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const textureWidth = options.textureWidth !== undefined ? options.textureWidth : 512;\n  const textureHeight = options.textureHeight !== undefined ? options.textureHeight : 512;\n\n  const clipBias = options.clipBias !== undefined ? options.clipBias : 0.0;\n  const alpha = options.alpha !== undefined ? options.alpha : 1.0;\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  //\n\n  const mirrorPlane = new THREE.Plane();\n  const normal = new THREE.Vector3();\n  const mirrorWorldPosition = new THREE.Vector3();\n  const cameraWorldPosition = new THREE.Vector3();\n  const rotationMatrix = new THREE.Matrix4();\n  const lookAtPosition = new THREE.Vector3(0, 0, -1);\n  const clipPlane = new THREE.Vector4();\n\n  const view = new THREE.Vector3();\n  const target = new THREE.Vector3();\n  const q = new THREE.Vector4();\n\n  const textureMatrix = new THREE.Matrix4();\n\n  const mirrorCamera = new THREE.PerspectiveCamera();\n\n  const parameters = {\n    minFilter: THREE.LinearFilter,\n    magFilter: THREE.LinearFilter,\n    format: THREE.RGBAFormat,\n    stencilBuffer: false\n  };\n\n  const renderTarget = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);\n\n  if (!THREE.MathUtils.isPowerOfTwo(textureWidth) || !THREE.MathUtils.isPowerOfTwo(textureHeight)) {\n    renderTarget.texture.generateMipmaps = false;\n  }\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"fog\"],\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        mirrorSampler: { value: null },\n        alpha: { value: 1.0 },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        textureMatrix: { value: new THREE.Matrix4() },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: [\n      \"uniform mat4 textureMatrix;\",\n      \"uniform float time;\",\n\n      \"varying vec4 mirrorCoord;\",\n      \"varying vec4 worldPosition;\",\n\n      THREE.ShaderChunk[\"fog_pars_vertex\"],\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\n\n      \"void main() {\",\n      \"\tmirrorCoord = modelMatrix * vec4( position, 1.0 );\",\n      \"\tworldPosition = mirrorCoord.xyzw;\",\n      \"\tmirrorCoord = textureMatrix * mirrorCoord;\",\n      \"\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\",\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\n\n      THREE.ShaderChunk[\"fog_vertex\"],\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\n\n      \"}\"\n    ].join(\"\\n\"),\n\n    fragmentShader: [\n      \"uniform sampler2D mirrorSampler;\",\n      \"uniform float alpha;\",\n      \"uniform float time;\",\n      \"uniform float size;\",\n      \"uniform float distortionScale;\",\n      \"uniform sampler2D normalSampler;\",\n      \"uniform vec3 sunColor;\",\n      \"uniform vec3 sunDirection;\",\n      \"uniform vec3 eye;\",\n      \"uniform vec3 waterColor;\",\n\n      \"varying vec4 mirrorCoord;\",\n      \"varying vec4 worldPosition;\",\n\n      \"vec4 getNoise( vec2 uv ) {\",\n      \"\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\",\n      \"\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\",\n      \"\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\",\n      \"\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\",\n      \"\tvec4 noise = texture2D( normalSampler, uv0 ) +\",\n      \"\t\ttexture2D( normalSampler, uv1 ) +\",\n      \"\t\ttexture2D( normalSampler, uv2 ) +\",\n      \"\t\ttexture2D( normalSampler, uv3 );\",\n      \"\treturn noise * 0.5 - 1.0;\",\n      \"}\",\n\n      \"void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\",\n      \"\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\",\n      \"\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\",\n      \"\tspecularColor += pow( direction, shiny ) * sunColor * spec;\",\n      \"\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\",\n      \"}\",\n\n      THREE.ShaderChunk[\"common\"],\n      THREE.ShaderChunk[\"packing\"],\n      THREE.ShaderChunk[\"bsdfs\"],\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\n      THREE.ShaderChunk[\"lights_pars_begin\"],\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\n      THREE.ShaderChunk[\"shadowmask_pars_fragment\"],\n\n      \"void main() {\",\n      \"\tvec4 noise = getNoise( worldPosition.xz * size );\",\n      \"\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\",\n\n      \"\tvec3 diffuseLight = vec3(0.0);\",\n      \"\tvec3 specularLight = vec3(0.0);\",\n\n      \"\tvec3 worldToEye = eye-worldPosition.xyz;\",\n      \"\tvec3 eyeDirection = normalize( worldToEye );\",\n      \"\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\",\n\n      \"\tfloat distance = length(worldToEye);\",\n\n      \"\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;\",\n      \"\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.z + distortion ) );\",\n\n      \"\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\",\n      \"\tfloat rf0 = 0.3;\",\n      \"\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\",\n      \"\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\",\n      \"\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);\",\n      \"\tvec3 outgoingLight = albedo;\",\n      \"\tgl_FragColor = vec4( outgoingLight, alpha );\",\n\n      THREE.ShaderChunk[\"tonemapping_fragment\"],\n      THREE.ShaderChunk[\"fog_fragment\"],\n\n      \"}\"\n    ].join(\"\\n\")\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: true,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.mirrorSampler.value = renderTarget.texture;\n  material.uniforms.textureMatrix.value = textureMatrix;\n  material.uniforms.alpha.value = alpha;\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n  scope.mirrorCamera = mirrorCamera;\n\n  scope.onBeforeRender = function(renderer, scene, camera) {\n    mirrorWorldPosition.setFromMatrixPosition(scope.matrixWorld);\n    cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);\n\n    rotationMatrix.extractRotation(scope.matrixWorld);\n\n    normal.set(0, 0, 1);\n    normal.applyMatrix4(rotationMatrix);\n\n    view.subVectors(mirrorWorldPosition, cameraWorldPosition);\n\n    // Avoid rendering when mirror is facing away\n\n    if (view.dot(normal) > 0) return;\n\n    view.reflect(normal).negate();\n    view.add(mirrorWorldPosition);\n\n    rotationMatrix.extractRotation(camera.matrixWorld);\n\n    lookAtPosition.set(0, 0, -1);\n    lookAtPosition.applyMatrix4(rotationMatrix);\n    lookAtPosition.add(cameraWorldPosition);\n\n    target.subVectors(mirrorWorldPosition, lookAtPosition);\n    target.reflect(normal).negate();\n    target.add(mirrorWorldPosition);\n\n    mirrorCamera.position.copy(view);\n    mirrorCamera.up.set(0, 1, 0);\n    mirrorCamera.up.applyMatrix4(rotationMatrix);\n    mirrorCamera.up.reflect(normal);\n    mirrorCamera.lookAt(target);\n\n    mirrorCamera.far = camera.far; // Used in WebGLBackground\n\n    mirrorCamera.matrixNeedsUpdate = true;\n    mirrorCamera.updateMatrixWorld();\n    mirrorCamera.projectionMatrix.copy(camera.projectionMatrix);\n\n    // Update the texture matrix\n    textureMatrix.set(0.5, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.5, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 1.0);\n    textureMatrix.multiply(mirrorCamera.projectionMatrix);\n    textureMatrix.multiply(mirrorCamera.matrixWorldInverse);\n\n    // Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n    // Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n    mirrorPlane.setFromNormalAndCoplanarPoint(normal, mirrorWorldPosition);\n    mirrorPlane.applyMatrix4(mirrorCamera.matrixWorldInverse);\n\n    clipPlane.set(mirrorPlane.normal.x, mirrorPlane.normal.y, mirrorPlane.normal.z, mirrorPlane.constant);\n\n    const projectionMatrix = mirrorCamera.projectionMatrix;\n\n    q.x = (Math.sign(clipPlane.x) + projectionMatrix.elements[8]) / projectionMatrix.elements[0];\n    q.y = (Math.sign(clipPlane.y) + projectionMatrix.elements[9]) / projectionMatrix.elements[5];\n    q.z = -1.0;\n    q.w = (1.0 + projectionMatrix.elements[10]) / projectionMatrix.elements[14];\n\n    // Calculate the scaled plane vector\n    clipPlane.multiplyScalar(2.0 / clipPlane.dot(q));\n\n    // Replacing the third row of the projection matrix\n    projectionMatrix.elements[2] = clipPlane.x;\n    projectionMatrix.elements[6] = clipPlane.y;\n    projectionMatrix.elements[10] = clipPlane.z + 1.0 - clipBias;\n    projectionMatrix.elements[14] = clipPlane.w;\n\n    eye.setFromMatrixPosition(camera.matrixWorld);\n\n    //\n\n    const currentRenderTarget = renderer.getRenderTarget();\n\n    const currentXrEnabled = renderer.xr.enabled;\n    const currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n\n    scope.visible = false;\n\n    renderer.xr.enabled = false; // Avoid camera modification and recursion\n    renderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows\n\n    renderer.setRenderTarget(renderTarget);\n    renderer.render(scene, mirrorCamera);\n    renderer.setRenderTarget(null);\n\n    scope.visible = true;\n\n    renderer.xr.enabled = currentXrEnabled;\n    renderer.shadowMap.autoUpdate = currentShadowAutoUpdate;\n\n    renderer.setRenderTarget(currentRenderTarget);\n  };\n};\n\nTHREE.Water.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Water.prototype.constructor = THREE.Water;\n","/* eslint-disable @calm/react-intl/missing-formatted-message */\n\n/*\nNOTE: support.js needs to be as self-contained as possible, since it needs to work in legacy browers\nthat we do not support. Avoid adding imports to libraries or other modules from our own codebase\nthat might break the support UI in legacy browsers.\nWe also do not support localization in this file, since it would require additional transpiliation\nand polyfilling.\n*/\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport copy from \"copy-to-clipboard\";\nimport { detectOS } from \"detect-browser\";\nimport \"./react-components/styles/global.scss\";\nimport styles from \"./assets/stylesheets/support.scss\";\n\nconst SHORTHAND_INITIALIZER = \"var foo = 'bar'; var baz = { foo };\";\nconst SPREAD_SYNTAX = \"var foo = {}; var baz = { ...foo };\";\nconst CATCH_SYNTAX = \"try { foo(); } catch {}\";\n\nfunction syntaxSupported(syntax) {\n  try {\n    eval(syntax);\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction getPlatformSupport() {\n  return [\n    { name: \"Web Assembly\", supported: !!window.WebAssembly },\n    { name: \"Media Devices\", supported: !!navigator.mediaDevices },\n    {\n      name: \"Modern JavaScript Syntax\",\n      supported:\n        syntaxSupported(CATCH_SYNTAX) && syntaxSupported(SPREAD_SYNTAX) && syntaxSupported(SHORTHAND_INITIALIZER)\n    }\n  ];\n}\n\nfunction isInAppBrowser() {\n  // Some apps like Twitter, Discord and Facebook on Android and iOS open links in\n  // their own embedded preview browsers.\n  //\n  // On iOS this WebView does not have a mediaDevices API at all, but in Android apps\n  // like Facebook, the browser pretends to have a mediaDevices, but never actually\n  // prompts the user for device access. So, we show a dialog that tells users to open\n  // the room in an actual browser like Safari, Chrome or Firefox.\n  //\n  // Facebook Mobile Browser on Android has a userAgent like this:\n  // Mozilla/5.0 (Linux; Android 9; SM-G950U1 Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko)\n  // Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/262.0.0.34.117;]\n  const detectedOS = detectOS(navigator.userAgent);\n  return (detectedOS === \"iOS\" && !navigator.mediaDevices) || /\\bfb_iab\\b/i.test(navigator.userAgent);\n}\n\nexport function platformUnsupported() {\n  return getPlatformSupport().some(s => !s.supported) || isInAppBrowser();\n}\n\nclass Support extends React.Component {\n  state = { showDetails: false, hasCopied: false };\n  toggleDetails = e => {\n    e.preventDefault();\n    this.setState(state => {\n      state.showDetails = !state.showDetails;\n      return state;\n    });\n  };\n  onCopyClicked = e => {\n    e.preventDefault();\n    copy(document.location);\n    this.setState({ hasCopied: true });\n  };\n  render() {\n    const platformSupport = getPlatformSupport();\n    const allSupported = platformSupport.every(s => s.supported);\n    const inAppBrowser = isInAppBrowser();\n\n    if (allSupported && !inAppBrowser) return null;\n\n    const detectedOS = detectOS(navigator.userAgent);\n\n    return (\n      <div className={styles.supportMain}>\n        <div className={styles.supportContent}>\n          <h1>Mozilla Hubs</h1>\n          <br />\n          <p className={styles.unsupportedLangs}>\n            · <span>Unsupported</span> · <span>No Soportado</span> · <span>Nicht Unterstützt</span>\n            {\" · \"}\n            <span>Sem Suporte</span> · <span>Non Compatible</span> · <span>不支援</span>\n            {\" · \"}\n            <span>не поддерживается</span> · <span>サポートされていません</span> ·\n          </p>\n          <br />\n          <p>\n            <span>Your browser is missing required features.</span>\n            <br />\n            {inAppBrowser ? (\n              detectedOS === \"iOS\" ? (\n                <span>Copy and paste this link directly into Safari</span>\n              ) : (\n                <span>Copy and paste this link directly into Chrome or Firefox</span>\n              )\n            ) : (\n              <span>Please try switching or updating to a newer browser</span>\n            )}\n            <br />\n            <br />\n            <input type=\"text\" readOnly onFocus={e => e.target.select()} value={document.location} />\n            <a className=\"copy-link\" href=\"#\" onClick={this.onCopyClicked}>\n              {this.state.hasCopied ? \"copied!\" : \"copy\"}\n            </a>\n            <br />\n            <br />\n            <a className={styles.detailsLink} href=\"#\" onClick={this.toggleDetails}>\n              <span>details</span>\n            </a>\n          </p>\n          {this.state.showDetails && (\n            <table className={styles.details}>\n              <tbody>\n                {platformSupport.sort((a, b) => (a.supported && !b.supported ? 1 : -1)).map(s => (\n                  <tr key={s.name}>\n                    <td>{s.name}</td>\n                    <td>{s.supported ? \"supported\" : \"unsupported\"}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  ReactDOM.render(<Support />, document.getElementById(\"support-root\"));\n});\n","// extracted by mini-css-extract-plugin\nexport default {\"support-main\":\"support__support-main__oWEp2\",\"supportMain\":\"support__support-main__oWEp2\",\"support-content\":\"support__support-content__6Fy7i\",\"supportContent\":\"support__support-content__6Fy7i\",\"unsupported-langs\":\"support__unsupported-langs__iVeQB\",\"unsupportedLangs\":\"support__unsupported-langs__iVeQB\",\"details\":\"support__details__dKlwm\"};","var map = {\n\t\"./de.json\": [\n\t\t33116,\n\t\t116\n\t],\n\t\"./es.json\": [\n\t\t27297,\n\t\t297\n\t],\n\t\"./fr.json\": [\n\t\t83056,\n\t\t56\n\t],\n\t\"./ja.json\": [\n\t\t23160,\n\t\t160\n\t],\n\t\"./ko.json\": [\n\t\t55540,\n\t\t540\n\t],\n\t\"./pt.json\": [\n\t\t10188,\n\t\t188\n\t],\n\t\"./ru.json\": [\n\t\t97441,\n\t\t441\n\t],\n\t\"./zh-cn.json\": [\n\t\t2030,\n\t\t30\n\t],\n\t\"./zh-tw.json\": [\n\t\t4076,\n\t\t76\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3 | 16);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 37472;\nmodule.exports = webpackAsyncContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"hubs:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"assets/js/\" + chunkId + \"-\" + {\"30\":\"33feee8912fbb9f86cb7\",\"56\":\"6355c5185b4e4ce6dcd8\",\"76\":\"e33c44d6605d1ba4d9e7\",\"116\":\"7bcf915010ef5cfec6b0\",\"160\":\"3a627c660bdcd661b30f\",\"188\":\"72828fae6854d71bb4e4\",\"297\":\"027c0244da655969168e\",\"441\":\"5f411d5aacab400324d8\",\"540\":\"88f7021158d167173ca5\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.j = 488;","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t488: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkhubs\"] = self[\"webpackChunkhubs\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [495,542,119,666], function() { return __webpack_require__(54560); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["AFRAME","registerComponent","multiple","schema","path","type","event","withPermission","init","this","needsPermission","data","updatePermissions","window","APP","hubChannel","hasPermission","canOrWillIfCreator","play","el","sceneEl","systems","permissions","onPermissionsUpdated","pause","removeEventListener","tick","scenes","userinput","get","emit","requireOwnership","default","NAF","utils","getNetworkedEntity","then","networkedEl","isMine","parentNode","removeChild","color","intensity","light","THREE","AmbientLight","setObject3D","update","prevData","set","convertSRGBToLinear","remove","removeObject3D","anime","require","components","animation","colorHelperFrom","Color","colorHelperTo","propertyPathCache","getComponentPropertyPath","str","delimiter","indexOf","split","getComponentProperty","name","splitName","constructor","String","getAttribute","setComponentProperty","value","setAttribute","splitCache","TYPE_COLOR","PROP_ROTATION","PROP_SCALE","STRING_COMPONENTS","toRadians","obj","x","MathUtils","degToRad","y","z","addEventListeners","eventNames","handler","i","length","addEventListener","removeEventListeners","getRawProperty","splitDot","setRawProperty","propertyName","targetValue","startsWith","r","g","b","isRawProperty","property","autoplay","delay","dir","dur","easing","elasticity","enabled","from","loop","parse","parseInt","startEvents","pauseEvents","resumeEvents","round","to","self","eventDetail","attrName","time","animationIsPlaying","onStartEvent","bind","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targets","targetsArray","updateConfigForDefault","updateConfigForRawColor","config","complete","id","oldData","direction","duration","createAndStartAnimation","t","dt","cancelDelayedStart","paused","pausedWasPlaying","updateConfig","delayTimeout","setTimeout","stopRelatedAnimations","key","waitComponentInitRawProperty","setColorConfig","push","lastValue","anim","animatables","target","isBoolean","isNaN","toString","parseFloat","aframeProperty","updateConfigForVector","coordinates","animations","Math","max","object3D","matrixNeedsUpdate","propType","component","componentName","cb","wait","evt","detail","clearTimeout","DEBUG_BBAA_COLOR","debugMaterial","MeshBasicMaterial","transparent","opacity","side","DoubleSide","inOut","outIn","debuggable","debugGeometry","BoxGeometry","debugMesh","Mesh","debugBBAA","BoxHelper","add","updateMatrixWorld","registerZone","audioZonesSystem","enableDebug","store","state","preferences","showAudioDebugPanel","unregisterZone","isEnabled","getBoundingBox","bbaa","Box3","copy","geometry","boundingBox","applyMatrix4","matrixWorld","visible","getAudioParams","audioOverrides","contains","position","containsPoint","isMobileVR","device","onlyY","_updateBillboard","_updateIsInView","schedule","unschedule","isInView","frustum","Frustum","frustumMatrix","Matrix4","box","boxTemp","expandBox","o","updateMatrices","computeBoundingBox","expandByPoint","min","screenCamera","playerCamera","document","getElementById","getObject3D","is","multiplyMatrices","projectionMatrix","matrixWorldInverse","setFromProjectionMatrix","makeEmpty","traverse","intersectsBox","targetPos","Vector3","worldPos","camera","setFromMatrixPosition","getWorldPosition","lookAt","onClick","block","owner","networked","clientId","hide","unmutedBoneName","mutedBoneName","onPos","offPos","onStateToggled","unmutedBone","getObjectByName","mutedBone","modelLoaded","updateMuteState","onMicStateChanged","dialog","on","off","muted","mediaDevicesManager","isMicEnabled","classList","log","origDispatch","dispatchEvent","Array","arguments","apply","e","includes","firstObject","console","info","JSON","stringify","k","undefined","method","castShadow","shadowMapResolution","shadowBias","shadowRadius","DirectionalLight","shadow","bias","radius","width","height","prevWidth","prevHeight","mapSize","map","dispose","frustumCulled","COLLISION_LAYERS","targetEl","takeOwnership","modifyGravityOnRelease","gravity","angularDamping","linearDamping","linearSleepingThreshold","angularSleepingThreshold","collisionFilterMask","DEFAULT_INTERACTABLE","physicsSystem","uuid","activateBody","initialForce","maxForce","maxScale","initialScale","scale","networkedEntity","entity","currentScale","force","angle","random","PI","cos","sin","transform","oneof","stateadded","stateremoved","eventSource","events","eventListeners","_handleEvent","mesh","BackSide","fog","object3DMap","fadeOut","beginTransition","fadeIn","_resolveFinish","Error","Promise","res","material","mat","offset","speed","snappedRot","Euler","snappedQ","Quaternion","snappedXForm","snappedXFormWorld","tempVector","isHovered","interaction","hoveredEl","rightRemote","hovered","leftRemote","_hoveredFrames","_applyMaskedTargetRotation","DEG2RAD","rotation","parent","worldToLocal","started","decompose","quaternion","reset","order","setFromEuler","compose","culled","updateDescendants","node","generateAndAddHeightfield","shape","mass","body","distance","orientation","CANNON","setFromAxisAngle","Vec3","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","HemisphereLight","whenPinned","_updateUI","_updateUIOnStateChange","isPinned","pinnable","pinned","pinnedAndForbidden","updateComponentState","materialQualitySetting","quality","template","isFlat","dim","onFrozenStateChange","hovering","getHoverMenu","applyHoverState","menuPromise","resolve","menu","appendChild","importNode","content","children","parentEl","animate","hoverContainer","querySelector","allowed","setScalar","image","hoverImage","activeImage","activeHoverImage","disabledImage","active","disabled","tooltip","tooltipText","activeTooltipText","onHover","updateButtonState","onHoverOut","sprite","warn","error","initializedInTick","cameraSystem","inspect","uninspect","selector","kick","close","mute","left_hand_pose","right_hand_pose","timestamps","Map","clear","count","size","register","has","performance","now","_destroyOldest","deregister","delete","oldestEl","minTs","Number","MAX_VALUE","forEach","ts","isHeld","_destroy","ttl","timeout","counter","_syncCounterRegistration","wasHeld","lastSync","syncAll","range","decay","PointLight","matrixAutoUpdate","playhead","poseIndex","overflow","poses","timestamp","setBodyKinematic","didThisOnce","UNOWNED_INTERACTABLE","innerConeAngle","outerConeAngle","SpotLight","penumbra","textHoverColor","textColor","backgroundHoverColor","backgroundColor","textEl","slice9","plane","toneMapped","once","noop","dependencies","raycast","penSpawner","drawingToPen","drawingEl","createDrawing","createDrawingPromise","createElement","handNetworkedDrawingInit","drawing","destroyDrawing","networkedDrawing","getDrawingPromise","getDrawing","pen","reject","returnDrawing","didRegister","cursorPoseTrackingSystem","unregister","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","colliders","enterComponent","enterProperty","enterValue","v","leaveComponent","leaveProperty","leaveValue","collidingLastFrame","setFromCenterAndSize","isColliding","onPauseStateChange","videoComponent","onVideoLoaded","video","togglePlaying","shouldBeVisible","contentTypes","contentSubtype","updateVisibility","contentType","catch","mediaLoader","mediaImage","mediaVideo","mediaPdf","currentContentType","matchesType","targetContentType","toLowerCase","endsWith","matchesSubtype","matches","onStateChange","newOwner","bit","nextBit","CL","ALL","NONE","INTERACTABLES","ENVIRONMENT","AVATAR","HANDS","MEDIA_FRAMES","DEFAULT_SPAWNER","module","exports","PRIVACY","TERMS","AVAILABLE_LOCALES","en","pt","ja","es","ru","fr","ko","de","FALLBACK_LOCALES","jp","defaultLocaleData","DEFAULT_LOCALE","cachedMessages","_locale","_localeData","setLocale","locale","resolvedLocale","locales","navigator","languages","language","userLanguage","unshift","curLocale","hasOwnProperty","primaryLanguageSubtag","findLocale","CustomEvent","localeData","interval","setInterval","clearInterval","getLocale","getMessages","configs","configTranslations","messageKey","entries","messages","replace","_match","subkey","reduce","acc","entry","isAdmin","process","BASE_ASSETS_PATH_KEY","URL","location","__webpack_public_path__","hasThumbnailServerMetaTag","IS_LOCAL_OR_CUSTOM_CLIENT","AVAILABLE_INTEGRATIONS","APP_CONFIG","theme","colorVars","style","innerHTML","join","head","insertBefore","firstChild","features","feature","featureName","localDevImages","imageName","cssUrl","url","images","link","linkName","defaultValue","links","setIsAdmin","_isAdmin","integration","availableIntegrations","translation","translationsConfig","translations","getMessage","updateVRHudPresenceCount","presence","occupantCount","Object","getOwnPropertyNames","getColorSchemePref","matchMedia","themes","find","darkModeDefault","STORYBOOK_APP_CONFIG","useDarkMode","darkMode","setDarkMode","useState","changeListener","useCallback","useEffect","darkmodeQuery","addListener","removeListener","ThemeProvider","themeId","setThemeId","onStoreChanged","nextThemeId","isArray","variables","styleTag","useTheme","useThemeFromStore","propTypes","PropTypes","waitForEvent","eventName","eventObj","waitForDOMContentLoaded","readyState","sleep","milliseconds","DEFAULT_ACTION_COLOR","DEFAULT_ACTION_COLOR_LIGHT","DEFAULT_COLORS","getThemeColor","activateTheme","actionColor","actionHoverColor","newThemeId","hackyMobileSafariTestValue","hackyMobileSafariTest","test","userAgent","hasTouchScreen","maxTouchPoints","msMaxTouchPoints","mQ","media","UA","detectTouchScreen","MOBILE_RE","TABLET_RE","isIpadOS","platform","isIOS","_isMobile","a","vendor","opera","substr","mockUserAgent","isTablet","isMobile","qs","URLSearchParams","search","isDebug","qsTruthy","logFilter","debug","names","chooseRandom","arr","floor","fetchRandomDefaultAvatarId","defaultAvatars","fetchReticulumAuthenticated","defaultAvatar","href","avatar","MediaDevicesEvents","freeze","PERMISSIONS_STATUS_CHANGED","MIC_SHARE_STARTED","MIC_SHARE_ENDED","VIDEO_SHARE_STARTED","VIDEO_SHARE_ENDED","DEVICE_CHANGE","PermissionStatus","GRANTED","DENIED","PROMPT","MediaDevices","MICROPHONE","SPEAKERS","CAMERA","SCREEN","NO_DEVICE_ID","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","Symbol","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","defaultMaterialQuality","MATERIAL_QUALITY_OPTIONS","qsMobileDefault","qsGet","qsDefault","isFirefoxReality","match","SCHEMA","definitions","profile","additionalProperties","properties","displayName","pattern","avatarId","personalAvatarId","credentials","token","email","activity","hasFoundFreeze","hasChangedName","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","hasOpenedShare","entryCount","settings","lastUsedMicDeviceId","micMuted","shouldPromptForRefresh","preferredMic","preferredSpeakers","preferredCamera","muteMicOnEntry","disableLeftRightPanning","audioNormalization","invertTouchscreenCameraMove","enableOnScreenJoystickLeft","detectMobile","enableOnScreenJoystickRight","enableGyro","animateWaypointTransitions","showFPSCounter","allowMultipleHubsInstances","disableIdleDetection","fastRoomSwitching","lazyLoadSceneMedia","preferMobileObjectInfoPanel","maxResolutionWidth","maxResolutionHeight","globalVoiceVolume","globalMediaVolume","globalSFXVolume","snapRotationDegrees","enableDynamicShadows","disableSoundEffects","disableMovement","disableBackwardsMovement","disableStrafing","disableTeleporter","disableAutoPixelRatio","movementSpeedModifier","disableEchoCancellation","disableNoiseSuppression","disableAutoGainControl","showRtcDebugPanel","enableAudioClipping","audioClippingThreshold","audioPanningQuality","cursorSize","nametagVisibility","nametagVisibilityDistance","avatarVoiceLevels","confirmedDiscordRooms","items","confirmedBroadcastedRooms","uploadPromotionTokens","fileId","promotionToken","creatorAssignmentTokens","hubId","creatorAssignmentToken","embedTokens","embedToken","onLoadActions","action","args","$ref","Store","EventTarget","super","_signOutOnExpiredAuthToken","jwtDecode","exp","Date","initProfile","_shouldResetAvatarOnInit","resetToRandomDefaultAvatar","_preferences","localStorage","getItem","setItem","oauthFlowCredentials","Cookies","maybeDispatchThemeChanged","previous","current","props","credentialsAccountId","sub","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","bumpEntryCount","currentEntryCount","enqueueOnLoadAction","executeOnLoadActions","clearOnLoadActions","arrayMerge","destinationArray","sourceArray","newState","mergeOpts","finalState","merge","valid","errors","validate","message","instance","argument","hasReticulumServer","isLocalClient","host","hubUrl","extraParams","slug","pathname","searchParams","resolverLink","directReticulumHostAndPort","reticulumMeta","invalidatedReticulumMetaThisSession","getReticulumFetchUrl","absolute","port","getReticulumMeta","version","pool","phx_host","fetch","json","phxHostOverride","protocol","invalidateReticulumMeta","connectToReticulum","params","socketClass","Socket","getNewSocketUrl","refreshDirectReticulumHostAndPort","socketUrl","socketSettings","logger","kind","msg","socket","connect","onError","endPointPath","endPoint","newEndPoint","payload","retUrl","headers","authorization","result","text","getPresenceEntryForSession","presences","sessionId","metas","getPresenceProfileForSession","migrateBindings","oldChannel","newChannel","doNotDuplicate","l","bindings","item","bindingRef","migrateChannelToSocket","channel","topic","pushBuffer","oldJoinPush","joinPush","recHooks","receive","status","callback","discordBridgesForPresences","channels","p","values","m","discordBridges","prototype","tryGetMatchingMeta","shouldAbandonMigration","ret_pool","ret_version","didMatchMeta","attempt","delayMS","ceil","transportForChannel","reliable","dataType","isOpen","connectionState","d","isFirstSync","clone","nafrPayload","naf","setDefaultSize","setRemovedRecycleThreshold","$isStringType","Networked","defineComponent","Types","creator","lastOwnerTime","Owned","NetworkedMediaFrame","capturedNid","MediaFrame","mediaType","bounds","preview","previewingNid","Text","Slice9","insets","NetworkedTransform","AEntity","Object3DTag","GLTFModel","CursorRaycastable","RemoteHoverTarget","NotRemoteHoverTarget","Holdable","RemoveNetworkedEntityButton","Interacted","HandRight","HandLeft","RemoteRight","RemoteLeft","HoveredHandRight","HoveredHandLeft","HoveredRemoteRight","HoveredRemoteLeft","HeldHandRight","HeldHandLeft","HeldRemoteRight","HeldRemoteLeft","Held","OffersRemoteConstraint","HandCollisionTarget","OffersHandConstraint","TogglesHoveredActionSet","HoverButton","TextButton","labelRef","HoldableButton","SingleActionButton","Pen","HoverMenuChild","Static","Inspectable","PreventAudioBoost","IgnoreSpaceBubble","Rigidbody","bodyId","collisionGroup","collisionMask","flags","PhysicsShape","shapeId","halfExtents","Pinnable","Pinned","DestroyAtExtremeDistance","MediaLoading","FloatyObject","releaseGravity","MakeKinematicOnRelease","CameraTool","snapTime","captureDurIdx","trackTarget","snapMenuRef","button_next","button_prev","snapRef","cancelRef","recVideoRef","screenRef","selfieScreenRef","cameraRef","countdownLblRef","captureDurLblRef","sndToggleRef","MyCameraTool","showHoverEffect","isFrozen","isSpawner","isEmojiSpawner","canMove","emoji","can","indexForComponent","fullComponent","findIndex","schemaComponent","nonAuthorizedSchemas","authorizeEntityManipulation","entityMetadata","sender","senderPermissions","isCreator","pin_objects","spawn_and_move_media","spawn_camera","spawn_drawing","spawn_emoji","getPendingOrExistingEntityMetadata","networkId","pendingData","connection","adapter","getPendingDataForNetworkId","schemas","schemaDict","pinnableComponent","entities","getEntity","authorizeOrSanitizeMessageData","nonAuthorizedComponents","nonAuthorizedComponent","index","initializeNonAuthorizedSchemas","nonAuthorizedIndices","sanitizeMessageData","persistentSyncs","stashPersistentSync","entityData","currentData","currentComponents","assign","from_session_id","emptyObject","applyPersistentSync","handleIncomingNAF","getTimeOffsetToServer","clientSentTime","serverReceivedTime","cache","getTime","precision","clientReceivedTime","getAverageTimeOffset","average","offsets","n","nextTick","addAnimationComponents","modelEl","adapters","persistent","presenceState","sanitizedAny","stashedAny","filter","authorizeOrSanitizeMessage","source","frozen","nafMessageReceived","storeMessage","handleIncomingNAFR","unparsedData","refs","frozenUpdates","_blockedClients","setServerUrl","setApp","setRoom","setWebRtcOptions","setServerConnectListeners","nafConnectSuccess","nafConnectFailed","setRoomOccupantListener","setDataChannelListeners","nafOccupantJoined","nafOccupantLeave","session_id","reliableTransport","unreliableTransport","list","shouldStartConnectionTo","startStreamConnection","closeStreamConnection","getConnectStatus","getMediaStream","getServerTime","sendData","sendDataGuaranteed","broadcastData","broadcastDataGuaranteed","disconnect","toggleFreeze","unfreeze","flushPendingUpdates","getPendingData","dataForUpdateMultiMessage","storeSingleMessage","storedMessage","storedData","isOutdatedMessage","isContemporaneousMessage","unblock","newDebug","PC_PROPRIETARY_CONSTRAINTS","optional","googDscp","WEBCAM_SIMULCAST_ENCODINGS","scaleResolutionDownBy","maxBitrate","SCREEN_SHARING_SIMULCAST_ENCODINGS","dtx","DIALOG_CONNECTION_CONNECTED","DIALOG_CONNECTION_ERROR_FATAL","DialogAdapter","EventEmitter","_micShouldBeEnabled","_micProducer","_cameraProducer","_shareProducer","_localMediaStream","_consumers","_pendingMediaRequests","_forceTcp","_forceTurn","_iceTransportPolicy","scene","_serverParams","_consumerStats","consumerStats","downlinkBwe","_downlinkBwe","getIceServers","turn","iceServers","_serverUrl","transports","urls","username","credential","getServerStats","_protoo","connected","_sendTransport","_closed","sendTransport","stats","request","transportId","producer","_producers","producerId","_recvTransport","recvTransport","consumer","consumerId","emitRTCEvent","iceRestart","transport","iceParameters","restartIce","recreateSendTransport","closeSendTransport","createSendTransport","restartSendICE","err","checkSendIceStatus","recreateRecvTransport","closeRecvTransport","createRecvTransport","restartRecvICE","checkRecvIceStatus","serverUrl","roomId","joinToken","serverParams","forceTcp","forceTurn","iceTransportPolicy","_roomId","_joinToken","_clientId","urlWithParams","append","protooTransport","protooClient","retry","retries","cleanUpLocalState","_retryConnectWithNewHost","accept","peerId","rtpParameters","appData","consume","removeConsumer","spatialLayers","temporalLayers","mediasoupClient","encodings","scalabilityMode","resolvePendingMediaRequestForTrack","track","notification","closePeer","spatialLayer","temporalLayer","score","_joinRoom","removeAllListeners","getHost","newServerUrl","pendingMediaRequests","audio","requests","MediaStream","keys","closed","promise","sendTransportInfo","producing","consuming","sctpCapabilities","_mediasoupDevice","iceCandidates","dtlsParameters","sctpParameters","proprietaryConstraints","errback","observer","level","_videoProducer","recvTransportInfo","routerRtpCapabilities","load","_device","rtpCapabilities","_useDataChannel","setLocalMediaStream","stream","sawAudio","sawVideo","all","getTracks","stop","replaceTrack","produce","stopTracks","codecOptions","opusStereo","opusDtx","zeroRtpOnPause","disableTrackOnPause","_hubs_contentHint","disableCamera","enableShare","disableShare","enableCamera","videoGoogleStartBitrate","share","toggleMicrophone","enableMicrophone","resume","room_id","room","user_id","whom","tag","msgFunc","toLocaleTimeString","hour12","hour","minute","second","changeHub","addToHistory","hub","hub_id","hideHubPresenceEvents","migrateToHub","reason","messageDispatch","hubs","history","pushState","updateUIForHub","subscriptions","setSubscribed","web_push","remountUI","hubIsBound","hub_requires_oauth","initialIsFavorited","favorites","removeRemoteEntities","querySelectorAll","connectedClients","activeDataChannels","childNodes","src","getSceneUrlForHub","updateEnvironmentForHub","entryManager","retChannel","perms_token","objectsScene","objectsUrl","objectsEl","useCache","inflate","loadRoomObjects","sendEnteredEvent","hubName","showLineBreak","newHubId","substring","AnimationMixerSystem","cmp","mixer","findAncestorWithComponent","easeOutQuadratic","initMixer","AnimationMixer","splice","elasticOut","s","asin","pow","registerComponentInstance","componentRegistry","deregisterComponentInstance","getCurrentStreamer","playerInfos","playerInfo","playerSessionId","streaming","updateVolume","newRawVolume","analyser","levels","getByteTimeDomainData","sum","amplitude","sqrt","calculateVolume","newPerceivedVolume","mapLinear","E","volume","prevVolume","getAnalyser","ikRootEl","analyserEl","disableUpdates","avatarIsTalking","_updateAnalysis","_runScheduledWork","ctx","AudioContext","getContext","createAnalyser","fftSize","Uint8Array","soundSource","lastSeenVolume","registerSystem","onMicEnabled","audioSystem","outboundAnalyser","analyserLevels","minScale","cameraEl","minValue","maxValue","meshes","skinnedmesh","group","isSkinnedMesh","morphs","morphNumber","morphTargetDictionary","morphValue","morphTargetInfluences","SPRITE_NAMES","MIC","MIC_HOVER","MIC_OFF","MIC_OFF_HOVER","prevSpriteName","audioAnalyser","spriteName","clamp","ObjectContentOrigins","ObjectTypes","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","UNKNOWN","objectTypeForOrigin","contentOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","srcSuffixLookupMap","updateMaterials","fn","HubsMeshBasicMaterial","fromMeshStandardMaterial","Material","call","emissive","emissiveIntensity","emissiveMap","lightMap","lightMapIntensity","aoMap","aoMapIntensity","alphaMap","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","onBeforeCompile","shader","uniforms","_emissive","_emissiveIntensity","_emissiveMap","fragmentShader","HubsMeshPhongMaterial","MeshPhongMaterial","vertexShader","normalMapType","normalMap","normalScale","bumpMap","bumpScale","displacementMap","displacementScale","displacementBias","reflectivity","refractionRatio","convertStandardMaterial","isMeshStandardMaterial","disposeTexture","texture","dash","HTMLVideoElement","hls","stopLoad","detachMedia","destroy","detectIOS","HAS_IMAGE_BITMAP","createImageBitmap","HubsTextureLoader","TextureLoader","manager","onLoad","onProgress","conversionRatio","newWidth","newHeight","canvas","drawImage","format","RGBAFormat","UnsignedByteType","resizeIfNeeded","_loadImageBitmapTexture","onUpdate","loadAsync","Texture","loader","ImageBitmapLoader","setCrossOrigin","crossOrigin","setPath","bitmap","needsUpdate","Cache","resolveURL","flipY","interactorOneTransform","interactorTwoTransform","validMaterials","enableSweepingEffect","geometryRadius","sweepParams","isTouchscreen","showEffect","toggling","cursorTogglingSystem","interactorOne","interactorTwo","ready","leftHand","held","options","leftToggledOff","rightToggledOff","rightHand","toArray","worldY","elements","ms1","ms2","ms3","scaledRadius","uniform","hubs_EnableSweepingEffect","hubs_IsFrozen","hubs_SweepParams","hubs_HighlightInteractorOne","hubs_InteractorOnePos","hubs_HighlightInteractorTwo","hubs_InteractorTwoPos","hubs_Time","nonCorsProxyDomains","hostname","commonKnownContentTypes","gltf","glb","png","jpg","jpeg","pdf","mp4","mp3","basis","ktx2","m3u8","mpd","scaledThumbnailUrlFor","extension","pathParts","extensionCandidate","pop","thumbnailUrl","btoa","encodeURIComponent","_","p1","fromCharCode","farsparkEncodeUrl","urlHostname","isNonCorsProxyDomain","domain","proxiedUrlFor","parsedUrl","getCustomGLTFParserURLResolver","gltfUrl","basisJsUrl","basisWasmUrl","dracoWrapperJsUrl","dracoWasmUrl","corsProxyPrefix","originalUrlParts","decodeURIComponent","slice","dataUrlRegex","guessContentType","exec","originIsHubsServer","isHubsServer","origin","hubsSceneRegex","hubsAvatarRegex","hubsRoomRegex","isLocalHubsUrl","isHubsSceneUrl","isLocalHubsSceneUrl","isHubsAvatarUrl","isLocalHubsAvatarUrl","isHubsRoomUrl","groups","MediaType","MODEL","IMAGE","VIDEO","PDF","ALL_2D","linkify","Linkify","tlds","mediaAPIEndpoint","resolveUrlCache","getDefaultResolveQuality","useLowerQuality","resolveUrl","resultPromise","response","ok","statusText","upload","file","desiredContentType","formData","FormData","getDirectReticulumFetchUrl","coerceToUrl","urlOrText","addMedia","fitToBox","mediaOptions","linkedEl","nid","createNetworkId","templateBody","firstElementChild","cloneNode","elAttrs","attributes","attrIdx","needsToBeUploaded","File","els","getLatestMediaVersionOfSrc","fileIsOwned","reader","FileReader","onload","view","DataView","getUint16","byteLength","marker","getUint32","little","tags","readAsArrayBuffer","getOrientation","srcUrl","meta","access_token","file_id","promotion_token","objectType","prefix","suffix","objectTypeForOriginAndContentType","cloneMedia","sourceEl","injectCustomShaderChunks","shaderUniforms","object","isTroikaText","reflectionProbeMode","hubs_InjectedCustomShaderChunks","newMaterial","renderer","getPromotionTokenForFile","mediaPos","addAndArrangeMedia","snapCount","mirrorOrientation","pos","rotateY","idx","localToWorld","eventType","textureLoader","createImageTexture","Image","CanvasTexture","encoding","sRGBEncoding","anisotropy","createVideoOrAudioEl","preload","addMeshScaleAnimation","onComplete","step","MIN_VALUE","closeExistingMediaMirror","mirrorTarget","textures","tex","actionButtonSrc","button","buttonSrc","nametag","nametagSrc","nametagBorderSrc","alphaTest","bottom","left","padding","right","oneOf","top","usingCustomMaterial","usingAtlas","uvAtlasMin","uvAtlasMax","textureSrc","PlaneBufferGeometry","regenerateMesh","array","uvs","uv","setPos","setUV","u","w2","h2","diff","setStyle","FrontSide","parseSide","updateMap","setMap","promisifyWorker","worker","nextItemId","outstanding","onmessage","handlers","transfer","postMessage","Layers","mask","recursive","layers","tempVector3","getLastWorldPosition","disposeMaterial","mtrl","specularMap","envMap","metalnessMap","roughnessMap","disposeNode","IDENTITY","identity","tempMatrix4","EPSILON","setMatrixWorld","matrixIsModified","matrix","invert","multiply","near","childrenNeedMatrixWorldUpdate","parallelTraverse","cloneObject3D","preserveUUIDs","cloneLookup","cloneUUIDLookup","sourceNode","clonedNode","animationClip","sourceAnimationClip","clonedTracks","tracks","keyframeTrack","sourceKeyframeTrack","nodeName","objectName","objectIndex","propertyIndex","PropertyBinding","parseTrackName","clonedUUID","clonedKeyframeTrack","cloneKeyframeTrack","AnimationClip","cloneAnimationClip","isMesh","boundsTree","isDirectionalLight","isSpotLight","sourceBones","skeleton","bones","sourceBone","bindMatrix","findNode","root","pred","nodes","shift","concat","interpolateAffine","mat4","end","start","interpolated","startMat4","endMat4","progress","outMat4","setFromRotationMatrix","extractRotation","slerpQuaternions","lerpVectors","setFromMatrixColumn","setFromMatrixScale","affixToWorldUp","inRotationMat4","inForward","outForward","outSide","worldUp","inMat4Copy","inMat4","multiplyScalar","projectOnVector","normalize","crossVectors","makeBasis","setPosition","calculateCameraTransformForWaypoint","upAffixedCameraTransform","upAffixedWaypointTransform","detachFromWorldUp","cameraTransform","waypointTransform","rotateInPlaceAroundWorldUp","startRotation","endRotation","theta","makeRotationY","childMatch","inverseParentWorld","childRelativeToParent","childInverse","newParentMatrix","child","createPlaneBufferGeometry","widthSegments","heightSegments","setY","getY","isFacingCamera","objWorldDir","objWorld","camWorld","viewingCamera","getWorldDirection","dot","acceleratedRaycast","gltfCache","retain","cacheItem","release","inflightGltfs","extractZipFile","defaultInflator","componentData","cloneGltf","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","getHubsComponentsFromMaterial","GLTFModelPlus","componentKey","inflator","inflateEntities","indexToEntityMap","templates","isRoot","modelToWorldScale","childEntities","entityComponents","materialComponents","className","setFromQuaternion","generateUUID","gltfIndex","inflatedEntity","isFirstInflation","objectInflations","objectInflation","resolveNodeRefs","propName","__mhc_link_type","prop","attachTemplate","templateRoot","targetEls","getHubsComponentsExtension","extensions","extras","ktxLoader","dracoLoader","GLTFHubsPlugin","parser","jsonPreprocessor","beforeRoot","oldHeightfieldNode","heightfield","runMigration","afterRoot","Object3D","DefaultMatrixAutoUpdate","materialQuality","parsedPath","GLTFHubsComponentsExtension","deps","resolveComponents","gltfRootType","associations","ext","getDependency","loadedDep","MOZ_texture_rgbe","GLTFHubsLightMapExtension","loadMaterial","materialIndex","materialDef","materials","extensionDef","pending","results","isMeshBasicMaterial","GLTFHubsTextureBasisExtension","basisLoader","loadTexture","textureIndex","textureDef","BasisTextureLoader","detectSupport","loadTextureImage","GLTFMozTextureRGBE","minFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","NearestFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","LinearFilter","loadGLTF","fileMap","loadingManager","LoadingManager","setURLModifier","gltfLoader","GLTFLoader","RGBELoader","setDataType","HalfFloatType","KTX2Loader","DRACOLoader","setKTX2Loader","setDRACOLoader","finally","revokeObjectURL","loadModel","resolveAsset","charAt","assetEl","loadTemplates","applySrc","templateEl","lastSrc","inflatedEl","disposeLastInflatedEl","model","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","isInterleavedBufferAttribute","triCount","MeshBVH","strategy","maxDepth","object3DToSet","inflateComponents","rewires","f","removeAttribute","clip","activeClipIndex","activeClipIndices","mixerEl","currentActions","updateClip","clipName","clips","clipNames","clipAction","setLoop","LoopRepeat","Infinity","textureToData","registeredTextures","UVScrollSystem","instances","addScaledVector","increment","Vector2","isVisibleUpToRoot","FAKE_TROIKA_BOUNDS","computeLocalBoundingBox","vertex","rootInverse","toRootSpace","excludeInvisible","union","isGeometry","vertices","itemSize","fromBufferAttribute","computeObjectAABB","getBox","boxRoot","worldSpace","isEmpty","matrixWorldNeedsUpdate","getScaleCoefficient","dX","abs","dY","dZ","DISTANCE_MODEL_OPTIONS","SourceType","MEDIA_VIDEO","AVATAR_AUDIO_SOURCE","SFX","AUDIO_TARGET","AUDIO_ZONE","AudioType","Stereo","PannerNode","DistanceModelType","Linear","Inverse","Exponential","PanningModelType","HRTF","EqualPower","AvatarAudioDefaults","audioType","distanceModel","panningModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","gain","MediaAudioDefaults","TargetAudioDefaults","defaultSettingsForSourceType","getOverriddenPanningModelType","getCurrentAudioSettings","sourceType","defaults","sceneOverrides","sceneAudioDefaults","audioDebugPanelOverrides","zoneSettings","zoneOverrides","preferencesOverrides","overriddenPanningModelType","clippingState","mutedState","gainMultipliers","supplementaryAttenuation","getCurrentAudioSettingsForSourceType","updateAudioSettings","panner","setDistanceModel","setRolloffFactor","setRefDistance","setMaxDistance","setTargetAtTime","context","currentTime","applySettings","shouldAddSupplementaryAttenuation","soundEnum","SOUND_HOVER_OR_GRAB","SOUND_THAW","SOUND_PEN_STOP_DRAW","SOUND_PEN_UNDO_DRAW","SOUND_PEN_CHANGE_COLOR","SOUND_TOGGLE_MIC","SOUND_TELEPORT_START","SOUND_TELEPORT_END","SOUND_WAYPOINT_START","SOUND_WAYPOINT_END","SOUND_SNAP_ROTATE","SOUND_SPAWN_PEN","SOUND_PEN_START_DRAW","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","SOUND_ENTER_SCENE","SOUND_QUACK","SOUND_SPECIAL_QUACK","SOUND_CHAT_MESSAGE","SOUND_FREEZE","SOUND_PIN","SOUND_MEDIA_LOADING","SOUND_MEDIA_LOADED","SOUND_CAMERA_TOOL_COUNTDOWN","SOUND_PREFERENCE_MENU_HOVER","SOUND_SPAWN_EMOJI","SOUND_SPEAKER_TONE","SoundEffectsSystem","pendingAudioSourceNodes","pendingPositionalAudios","positionalAudiosStationary","positionalAudiosFollowingObject3Ds","audioContext","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","URL_SPAWN_EMOJI","URL_SPEAKER_TONE","loading","audioBufferPromise","arrayBuffer","decodeAudioData","sounds","sound","audioBuffer","isDisabled","shouldBeDisabled","stopAllPositionalAudios","enqueueSound","createBufferSource","buffer","addAudio","enqueuePositionalSound","disablePositionalAudio","positionalAudio","Audio","audioListener","PositionalAudio","setBuffer","playPositionalSoundAt","playPositionalSoundFollowing","playSoundOneShot","playSoundLooped","playSoundLoopedWithGain","createGain","stopSoundNode","removeAudio","stopPositionalAudio","inPositionalAudio","pendingIndex","isPlaying","removeFromParent","pendingPositionalAudio","positionalAudioAndObject3D","loadingObject","loadingObjectSrc","playSoundEffect","moveTheParentNotTheMesh","showLoader","clearLoadingTimeout","onMediaLoaded","handleLinkedElRemoved","refresh","animating","updateScale","center","originalMeshMatrix","desiredObjectMatrix","addVectors","scaleCoefficient","removeShape","loaderMixer","sfx","soundEffectsSystem","loadingSoundEffect","loadedSoundEffect","useFancyLoader","loadingClip","loadingScaleClip","VectorKeyframeTrack","SHAPE","showLoaderTimeout","updateHoverableVisuals","boundingSphere","Sphere","hoverableVisuals","injectedCustomShaderChunks","setFromObject","getBoundingSphere","physicsShape","shouldUpdateScale","finish","minHalfExtent","registerLinkage","contentBounds","getSize","eid","entityExists","world","removeComponent","forceLocalRefresh","srcChanged","addComponent","thumbnail","canonicalUrl","canonicalAudioUrl","accessibleUrl","isLocalModelAsset","is360","projection","origin_audio","expected_content_type","raw","isHLS","linkedVideoTexture","linkedAudioSource","linkedMediaElementAudioSource","linkedMediaVideo","videoTexture","audioSource","mediaElementAudioSource","qsTime","startTime","hash","reduceAngularFloat","audioSrc","applyGravity","mayChangeScene","maxIndex","onNext","onPrev","onSnap","hoverMenu","nextButton","prevButton","snapButton","pageLabel","pinnableElement","newIndex","quackPercentage","specialQuackPercentage","wasInteracting","isInteracting","quack","rand","paths","actions","toggleScreenShare","snapRotateLeft","snapRotateRight","angularVelocity","logDebugFrame","logInteractionState","debugUserInput","describeCurrentMasks","cameraDelta","lobbyCameraDelta","characterAcceleration","dCharSpeed","boost","startGazeTeleport","stopGazeTeleport","spawnPen","ensureFrozen","thaw","muteMic","toggleFly","toggleUI","waypointDeltaDistance","focusChat","focusChatCommand","toggleCamera","takeSnapshot","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","transformModifier","rayObjectRotation","cursor","pose","hideLine","grab","drop","modDelta","startDrawing","stopDrawing","undoDrawing","penNextColor","penPrevColor","scalePenTip","scaleGrabbedGrabbable","mediaVolumeMod","wake","switchDrawMode","startTeleport","stopTeleport","thumb","middleRingPinky","exitMirror","startInspecting","startInspectingSelf","stopInspecting","inspectZoom","inspectPanY","resetInspectView","nextCameraMode","spawnEmoji0","spawnEmoji1","spawnEmoji2","spawnEmoji3","spawnEmoji4","spawnEmoji5","spawnEmoji6","haptics","actuators","mouse","coords","movementXY","buttonLeft","buttonRight","buttonMiddle","wheel","smartMouse","cursorPose","shouldMoveCamera","touchscreen","touchCameraDelta","gyroCameraDelta","pinch","delta","initialDistance","currentDistance","isTouching","isTouchingGrabbable","tap1","tap2","tap3","tap4","tap5","anything","gyro","averageDeltaX","averageDeltaY","hud","penButton","keyboard","gamepad","gamepadIndex","buttonIndex","pressed","touched","axis","axisIndex","xbox","buttonName","axisName","axesSum","oculusgo","trigger","touchpad","axisX","axisY","gearVRController","daydream","rightOculusTouch","leftOculusTouch","axes","wmrController","wmr","grip","joystick","vive","webxr","thumbStick","touchpadX","touchpadY","joyX","joyY","tag2ecs","isHoldable","offersRemoteConstraint","isHandCollisionTarget","offersHandConstraint","togglesHoveredActionSet","singleActionButton","holdableButton","isPen","isHoverMenuChild","isStatic","inspectable","preventAudioBoost","ignoreSpaceBubble","isTagged","elOrObject3D","hasComponent","didUpdateOnce","tagName","isSet","customFOV","enableThirdPersonMode","q","orbit","owq","owp","cwq","cwp","rwq","UP","RIGHT","dPos","targetQuat","targetScale","targetMatrix","dhQ","dvQ","pivot","rig","dh","dv","dz","panY","getWorldQuaternion","applyQuaternion","premultiply","subVectors","zoom","newLength","moveRigSoCameraLooksAtPivot","oForw","defaultBoxMax","distanceMod","getCenter","vrMode","dist","fov","aspect","halfYExtents","halfXExtents","halfVertFOV","halfHorFOV","atan","tan","length1","length2","length3","calculateViewingDistance","NEXT_MODES","ensureLightsAreSeenByCamera","isLight","enable","firstPersonOnlyLayer","enableInspectLayer","disableInspectLayer","disable","CameraSystem","uiRoot","updateMatrix","entered","mode","quat","viewingRig","avatarRig","characterController","fly","avatarPOV","enteredScene","avatarPOVRotator","viewingCameraRotator","hoverEl","nextMode","ensureListenerIsParentedCorrectly","makeTranslation","horizontalDelta","verticalDelta","snapshot","audioSourceTargetTransform","lightsEnabled","audioTransform","xrManager","xr","updateXRCamera","updateCamera","xrCamera","getCamera","cameras","bg","fireChangeEvent","getInspectableInHierarchy","pivotFor","getInspectableAndPivot","hideEverythingButThisObject","c","getAudio","showEverythingAsNormal","toggleLights","notHiddenObject","lerp","newRot","positionOnly","scenePreviewCameraSystem","startPoint","targetPoint","targetRotDelta","targetRotation","backwards","ranOnePass","tick2","hubsSystems","streamerCamera","streamer","getStreamerCamera","translateZ","fromRot","toRot","BoxBufferGeometry","CubeCamera","PMREMGenerator","Scene","ShaderMaterial","UniformsLib","UniformsUtils","WebGLCubeRenderTarget","Sky","sky","_geometry","_inclination","_azimuth","_distance","updateSunPosition","turbidity","rayleigh","luminance","mieCoefficient","mieDirectionalG","inclination","azimuth","phi","sunPosition","generateEnvironmentMap","skyScene","cubeCamera","vrEnabled","pmremGenerator","fromCubemap","renderTarget","generateLightProbe","magFilter","lightProbe","LightProbeGenerator","skyIndex","playerHeight","loadedEvent","moveToSpawnPoint","spawnPoints","spawnPoint","MakeStaticWhenAtRest","makeStaticAtRestQuery","defineQuery","Not","makeKinematicOnReleaseExitQuery","exitQuery","enteredFloatyObjectsQuery","enterQuery","heldFloatyObjectsQuery","exitedHeldFloatyObjectsQuery","enterHeldFloatyObjectsQuery","unthrowable","spawnScale","NaN","spawnCooldown","spawnEvent","animateFromCursor","cooldownTimeout","handPosition","onSpawnEvent","tempSpawnHandPosition","handleMediaLoaded","spawnedMediaScale","spawnedEntity","divideScalar","hand","willAnimateFromCursor","activateCooldown","resetDynamicBody","sx","sy","sz","MobileWater","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","mirrorShader","ShaderChunk","lights","wrapS","wrapT","RepeatWrapping","create","Water","forceMobile","waterMesh","waterGeometry","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","water","mirrorCamera","MeshStandardMaterial","Octave","alternate","SimpleWater","resolution","lowQuality","rotateX","waterUniforms","ripplesSpeed","ripplesScale","materialClass","roughness","metalness","specular","receiveShadow","dynamic","octaves","simplex","SimplexNoise","tideHeight","tideScale","tideSpeed","waveHeight","waveScale","waveSpeed","positionAttribute","octave","noise","computeVertexNormals","vec2Equals","waterNormalsUrl","usePhongShader","defaultSrcUrl","defaultSrcImage","startColor","middleColor","endColor","startOpacity","middleOpacity","endOpacity","colorCurve","sizeCurve","startSize","endSize","sizeRandomness","ageRandomness","lifetime","lifetimeRandomness","particleCount","startVelocity","endVelocity","velocityCurve","particleEmitter","ParticleEmitter","updateParticles","setTexture","originalAudioParamsData","registerSource","unregisterSource","getPosition","sourcePos","audios","restore","THREE_SIDES","front","back","double","numberOrPercent","textAlign","anchorX","anchorY","clipRect","out","val","curveRadius","depthOffset","fillOpacity","fontUrl","fontSize","letterSpacing","lineHeight","maxWidth","outlineBlur","outlineColor","outlineOffsetX","outlineOffsetY","outlineOpacity","outlineWidth","overflowWrap","strokeColor","strokeOpacity","strokeWidth","textIndent","whiteSpace","troikaTextMesh","font","sync","outSize","bindAllEvents","unbindAllEvents","eventSrc","toggleEvents","muteEvents","unmuteEvents","onToggle","onMute","onUnmute","toggleMic","micEnabled","HIDDEN_SCALE","BoneVisibilitySystem","updateWhileInvisible","lastVisible","mic","spawn","cameraBtn","inviteBtn","background","updateButtonStates","onMicClick","onSpawnClick","onPenClick","onCameraClick","onInviteClick","onHubUpdated","entry_mode","emojis","emoji0Model","particle","emoji0Particle","emoji1Model","emoji1Particle","emoji2Model","emoji2Particle","emoji3Model","emoji3Particle","emoji4Model","emoji4Particle","emoji5Model","emoji5Particle","emoji6Model","emoji6Particle","particleEmitterConfig","spawnEmojiInFrontOfUser","emitDecayTime","emitFadeTime","emitEndTime","particleConfig","originalParticleCount","initialized","setOffsetVector","totalNumEmojis","spacing","offsetVector","sign","spawnerScale","spawnedScale","hudAngle","minHudAngle","maxHudAngle","hudDistance","spawnerPlatformWidth","spawnerPlatformSpacing","cameraWorldPosition","_onFrozen","_onThaw","spawnerEntities","spawnerEntity","requireHoverOnNonMobile","TYPE","collisionFilterGroup","cameraObject3D","_updateOffset","targetWorldPos","cameraForward","projectedCameraForward","angledCameraForward","defaultRight","transformDirection","projectOnPlane","DefaultUp","angleTo","angleOffset","applyAxisAngle","insertAfter","referenceEl","nextSibling","onEnterVr","onExitVr","onFirstInteraction","onMoveJoystickChanged","onMoveJoystickEnd","onLookJoystickChanged","onLookJoystickEnd","mockJoystickContainer","leftMock","styles","leftMockSmall","rightMock","rightMockSmall","enableLeft","enableRight","createLeftStick","createRightStick","onPreferenceChange","inVr","moving","rotating","displacement","lookDy","lookDx","newEnableLeft","newEnableRight","leftStick","leftTouchZone","rightStick","rightTouchZone","nipplejs","zone","fadeTime","ui","removeProperty","preferenceScreenIsVisible","radian","enqueueRelativeMotion","enqueueInPlaceRotationAroundWorldUp","display","cameraToolsQuery","leftController","rightController","HAND_ROTATIONS","makeRotationFromEuler","angleOnXZPlaneBetweenMatrixRotations","XZ_PLANE_NORMAL","v1","v2","matrixA","matrixB","leftEye","rightEye","neck","chest","rotationSpeed","maxLerpAngle","alwaysUpdate","headTransform","hipsPosition","invHipsToHeadVector","middleEyeMatrix","middleEyePosition","invMiddleEyeToHead","cameraYRotation","cameraYQuaternion","invHipsQuaternion","headQuaternion","rootToChest","invRootToChest","ikRoot","findIKRoot","hasConvergedHips","lastCameraTransform","forceIkUpdate","negate","hasNewCameraTransform","equals","_hadFirstTick","epsilon","w","quaternionAlmostEquals","updateHand","handRotation","handObject3D","controllerObject3D","isLeft","handMatrix","spaceInvader","setAlwaysHidden","tmpPos","isInViewOfCamera","cameraTools","screenObj","eid2obj","cameraObj","POSES","poseForFingers","subpath","handleLeftVisuals","handleRightVisuals","hadLeftVisualLastFrame","hadRightVisualLastFrame","interactingElement","hideVisual","selfDestruct","updateOffset","QUARTER_CIRCLE","rotateOnAxis","AVATARS_API","AVATAR_TYPES","SKINNABLE","getAvatarType","resp","avatars","fetchAvatar","fetchSkinnableAvatar","avatar_id","gltf_url","getAvatarSrc","fetchAvatarGltfUrl","files","avatarUnavailableImage","MAT_NAME","ensureAvatarMaterial","materialForMesh","primitives","primitive","remixAvatar","parentId","parent_avatar_listing_id","ensureAvatarNodes","some","originalRoot","avatarSrc","avatarType","isSharingAvatarCamera","applyProperties","handleModelError","handleRemoteModelError","onPresenceUpdated","onAvatarModelLoaded","isLocalPlayerInfo","getCreator","playerPresence","updateFromPresenceMeta","avatarEl","isAudioPaused","isSkinnedAvatar","erasingBonesIndex","dst","SkinnedMesh","skinIndexAttr","skinIndex","skinWeightAttr","skinWeight","getIndex","oldTriangles","triangles","bws","exclude","bw0","skin0","bw1","skin1","bw2","skin2","excludeTriangles","newTriangle","setIndex","onBeforeRender","Skeleton","boneInverses","createErasedMesh","createModelForSkinnedMesh","presenceMeta","perm","videoTextureTargets","DEBUG","ANIM_CONFIG","nametagVolumeGeometry","nametagVolumeMaterial","nametagTypingGeometry","CircleBufferGeometry","handRaisedTexture","handRaisedIconSrc","handRaisedGeometry","handRaisedMaterial","identityName","isTalking","isTyping","isOwner","isRecording","isHandRaised","volumeAvg","MovingAverage","avatarAABB","avatarAABBSize","avatarAABBCenter","nametagHeight","isAvatarReady","lastUpdateTime","onModelLoading","onModelLoaded","onModelIkFirstTick","onStateChanged","nametagIdentityName","nametagBackground","nametagStatusBorder","recordingBadge","modBadge","nametagText","handRaised","nametagVolume","nametagTyping","Group","depthWrite","updateTheme","avatarAABBHelper","Box3Helper","typingAnimTime","wasTalking","audioAnalyzer","resizeNameTag","setX","nametagElPosY","updateAvatarModelAABB","nameTagSystem","recording","roles","typing","hand_raised","updateDisplayName","updateHandRaised","prevDisplayName","tmpVector","NAMETAG_BACKGROUND_PADDING","open","thumbDown","indexDown","mrpDown","thumbUp","point","fist","NETWORK_POSES","animatePose","networkField","getNetworkedAvatar","networkedAvatar","prev","curr","LoopOnce","clampWhenFinished","setHandPose","TWOPI","lookCutoff","animRange","yawCutoff","onChildHovered","removeHoverEvents","isYLocked","lockedHeadPositionY","lookDir","lookEuler","hoverableChildren","pitch","RAD2DEG","yawDif","deltaAngle","forceHudVisible","hudLocked","hudOutOfView","wasInspecting","addState","removeState","withinDistance","withoutPermission","visibleIfOwned","camWorldPos","objWorldPos","hoverableSearch","hoverable","isVisible","shouldNotBeVisible","isWithinDistance","distanceToSquared","isTransforming","transforming","isHoldingAnything","toggle","ThreeStats","_rS","memory","geometries","programs","render","calls","points","attach","caption","over","fractions","HIDDEN_CLASS","$queries","allEntitiesQuery","aEntityQuery","onExpand","onCollapse","plugins","rStats","css","fps","below","createStats","statsEl","statsHeaderEl","statsTitleEl","collapseEl","fpsEl","lastFpsUpdate","lastFps","frameCount","inVR","vrStatsEnabled","initVRStats","lastUpdate","getOwnPropertySymbols","description","vrPanel","depthTest","toggleVRStats","frame","stepDuration","toFixed","show","getCurrentMirroredMedia","mirrorEl","refreshButton","localRefreshButton","errorImage","errorImageSrc","errorTexture","scaleToAspectRatio","ratio","browser","detect","browserIsSafari","os","ONCE_TRUE","TYPE_IMG_PNG","audioIconTexture","audioIcon","VOLUME_LABELS","j","timeFmt","h","endTime","hidePlaybackControls","videoPaused","tickRate","syncTolerance","updateHoverMenu","tryUpdateVideoPlaybackState","ensureOwned","isMineOrLocal","updateSrc","seekForward","seekBack","volumeUp","volumeDown","snap","changeVolumeBy","setupAudio","videoMutedAt","localSnapCount","isSnapping","videoIsLive","onSnapImageLoaded","hasAudioTracks","playbackControls","playPauseButton","volumeUpButton","volumeDownButton","seekForwardButton","seekBackButton","timeLabel","volumeLabel","linkButton","updateVolumeLabel","updatePlaybackState","getNetworkOwner","onPreferenceChanged","newDisableLeftRightPanning","newAudioPanningQuality","shouldRecreateAudio","shouldUpdateAudioSettings","currentHour","getHours","setupVideo","gainMultiplier","videoWidth","videoHeight","blob","toBlob","_ignorePauseStateChanges","_playbackStateChangeTimeout","setNodeSource","mediaElement","audioSourceEl","cleanUp","createVideoTextureAudioSourceEl","refreshMediaMirror","audioTracks","mozHasAudio","webkitAudioDecodedByteCount","semver","createMediaElementSource","updateHLSLiveState","currentLevel","details","live","HLS","SphereBufferGeometry","isVideoTexture","pollTimeout","_audioSyncInterval","resolved","failLoad","videoEl","audioEl","isReady","VideoTexture","streamController","audioOnly","streamClientId","_onStreamUpdated","srcObject","getVideoTracks","dashPlayer","MediaPlayer","extend","modifyRequestHeader","xhr","modifyRequestURL","initialize","setTextDefaultEnabled","clearDefaultUTCTimingSources","addUTCTimingSource","baseUrl","xhrSetup","buildAbsoluteURL","loadSource","attachMedia","fatal","startLoad","recoverMediaError","setupHls","canPlayType","onerror","videoStartTime","getFullYear","getMonth","getDate","poll","mayModifyPlayHead","volumeModRight","volumeModLeft","pdfjs","canvasContext","renderTask","loadingSrc","numPages","page","getPage","viewport","getViewport","pw","ph","GIFTexture","frames","delays","disposals","_ctx","generateMipmaps","frameStartTime","clearRect","parseGIF","rawImageData","delayTimes","loadCnt","img","textureCache","inflightTextures","errorCacheItem","alphaMode","alphaCutoff","currentSrcIsRetained","inflightKey","createGIFTexture","mipmaps","createKTX2Texture","MAX_VOLUME_LABELS","MAX_GAIN_MULTIPLIER","SMALL_GAIN_STEP","BIG_GAIN_STEP","calcLevel","updateAvatarVolumesPref","muteButton","normalizer","onRemoteMuteUpdated","volumePref","updateGainMultiplier","updateLocalMuted","updatePref","isLocalMuted","calcGainStepUp","calcGainStepDown","numBars","pinchDelta","rotatePitchAndYaw","opq","oq","pq","yq","initialUpDot","initialForwardDotUp","newUpDot","newForwardDotUp","scenePreviewNode","pendingXRotation","lobby","isGhost","ROTATE_Y","updateFromLocalBB","currentPosition","localBox","offsetToCenter","updateTargetRotationFromCamera","up","forward","cameraPosition","cameraRotation","isVR","vrFocalPoint","desiredTargetQuaternion","positionAtBorderComponents","didInit","doInit","cam","didRegisterWithAnimationSystem","menuAnimationSystem","wasVisible","previousMesh","meshLocalBoundingBox","meshCenter","meshHalfExtents","meshOffsetToCenter","isTargetBoundingBoxDirty","targetLocalBoundingBox","targetCenter","targetHalfExtents","targetOffsetToCenter","markDirty","centerToCamera","intersectionToCam","desiredCenterPoint","desiredTargetPosition","currentTargetScale","desiredTargetScale","desiredTargetTransform","centerToBorder","currentMeshRotation","currentMeshScale","meshForward","boxCorners","currentMesh","isOpening","needsYRotate","intersection","getActiveIntersection","meshSphereRadius","distanceToSphere","distanceToCenter","divide","PositionAtBorderSystem","_persist","_persistAndAnimate","_animate","pinningHelper","setPinned","_isMine","isAnimationRunning","didFireThisFrame","transformObjectSystem","wasTransforming","tipSelector","labelSelector","tipEl","labelEl","onHovered","onUnhovered","wasPinned","_discordBridges","canPin","highlighted","queries","anyEntityWith","eids","$parentArray","$storeFlattened","defineNetworkSchema","Component","componentProps","shadowSymbols","ArrayBuffer","isView","shadowStore","subarray","createShadow","serialize","_world","isFullSync","changedPids","pid","getString","deserialize","updatedPids","getSid","myCam","tracking","menuPlacementRoots","findComponentsInNearestAncestor","hasEnteredFullScreenThisSession","shouldShowFullScreen","screenfull","showFullScreenIfAvailable","showFullScreenIfWasFullScreen","_isIn2DInterstitial","_exitAction","getUserGesture","handleExitTo2DInterstitial","isLower","exitAction","nonFullscreen","exitVR","vrNotice","exit2DInterstitialAndEnterVR","enterVR","isIn2DInterstitial","onlyOpenLink","label","exitImmersive","replaceState","initialTweet","mediaUrl","REMIX_LABEL","idForAvatarUrl","allow_remixing","copying","AMMO_BODY_ATTRIBUTES","TRANSFORM_MODE","AXIS","PUPPET","CURSOR","ALIGN","SCALE","STEP_LENGTH","CAMERA_WORLD_QUATERNION","CAMERA_WORLD_POSITION","TARGET_WORLD_QUATERNION","q2","eps","onGrabStart","transformSystem","startTransform","onGrabEnd","stopTransform","startQ","dxStore","dxApplied","dyAll","dyStore","dyApplied","raycasters","puppet","initialControllerOrientation","initialControllerOrientation_inverse","initialObjectOrientation","currentControllerOrientation","controllerOrientationDelta","planarInfo","normal","intersections","previousPointOnPlane","currentPointOnPlane","deltaOnPlane","finalProjectedVec","PI_AROUND_Y","pInv","startPlaneCasting","raycaster","far","sign2","dxAll","puppetingTick","cursorAxisOrScaleTick","cameraToPlaneDistance","modify","FORWARD","TWO_PI","calculatePlaneMatrix","planeMatrix","planeUp","planeForward","planeRight","planePosition","camPosition","planeForLeftCursor","planeForRightCursor","getMeshes","collisionEntities","isScaling","planeRotation","initialIntersectionPoint","intersectionPoint","initialObjectScale","desiredObjectScale","deltaScale","objectMatrix","dragVector","currentObjectScale","objectToScale","objectPosition","objectToCam","startScaling","didGetObjectReferences","leftEventer","leftCursorController","leftRaycaster","rightCursorController","rightRaycaster","raycastOnPlane","initialDistanceToObject","transformSelectedObjectSystem","endScaling","dotFactor","scaleFactor","CYLINDER_TEXTURE","RayCurve","numPoints","BufferGeometry","setPoint","A","B","C","D","P","Float32Array","BufferAttribute","setUsage","DynamicDrawUsage","setDirection","cross","setWidth","parabolicCurve","p0","v0","checkLineIntersection","referenceNormal","landingMaxAngle","hitPoint","intersects","intersectObjects","collisionNormal","angleNormals","isValidNormalsAngle","face","MISS_COLOR","LANDING_NORMAL","DRAW_TIME_MS","vecHelper","confirm","hitCylinderColor","hitCylinderRadius","outerRadius","hitCylinderHeight","isTeleporting","rayCurve","parabola","hit","Raycaster","rigWorldPosition","newRigWorldPosition","teleportOriginWorldPosition","teleportEventDetail","oldPosition","newPosition","prevHitHeight","hitEntity","createHitEntity","queryCollisionEntities","stopPlayingTeleportSound","teleportingSound","isTeleportingDisabled","timeTeleporting","teleportTo","playerScale","collidedIndex","timeSegment","percentToDraw","segmentT","dRadii","outerScale","easeIn","outerTorus","hitEntityOpacity","easeOutIn","torus","cylinder","TorusBufferGeometry","CylinderBufferGeometry","rotate","translate","INFO_INIT_FAILED","INFO_NO_NETWORKED_EL","INFO_NO_OWNER","SHOULD_CREATE_SILENT_AUDIO_ELS","getOwnerId","createAudio","isCreatingAudio","isRemoved","createSilentAudioEl","destination","createMediaStreamDestination","mediaStreamSource","createMediaStreamSource","destinationSource","mediaStream","ownerId","newStream","tmpWorldPos","onlyMods","muteSelf","gainFilter","whiteNoise","bufferSize","sampleRate","noiseBuffer","createBuffer","getChannelData","createWhiteNoise","setInput","getMaxScaleOnAxis","boundingRadiusSquared","LineSegments","WireframeGeometry","newInput","input","getGainFilter","trackingEl","minDelay","maxDelay","srcEl","connectAudio","delayNode","createDelay","delayTime","randFloat","setFilters","srcZone","isCamera","WebGLRenderTarget","depth","stencil","textureNeedsUpdate","tock","lastRenderTime","tmpXRFlag","tmpOnAfterRender","onAfterRender","tmpAutoUpdate","autoUpdate","setRenderTarget","targetBaseColorMap","targetEmissiveMap","getMaterial","mask1","originalMap","originalEmissiveMap","videoTextureSource","applyTexture","originalTexture","DEFAULT_MIRROR_GEOMETRY","DEFAULT_TEXTURE_WIDTH","innerWidth","devicePixelRatio","DEFAULT_TEXTURE_HEIGHT","innerHeight","reflector","Reflector","originalOnBeforeRender","originalRender","pushOrUpdateHistory","newPathname","newSearch","__historyLength","__duplicate","isDuplicate","pushHistoryState","pushHistoryPath","popToBeginningOfHubHistory","navigateToPriorPage","len","unsubscribe","listen","go","sluglessPath","withSlug","VR_DEVICE_AVAILABILITY","yes","no","maybe","GENERIC_ENTRY_TYPE_DISALLOWED_DEVICES","getAvailableVREntryTypes","ua","isSamsungBrowser","isWebVRCapableBrowser","hasNativeWebVRImplementation","isWebXRCapableBrowser","hasNativeWebXRImplementation","isDaydreamCapableBrowser","isIDevice","isFirefoxBrowser","isUIWebView","mediaDevices","safari","isCardboardCapableBrowser","displays","getVRDisplays","isOculusBrowser","screen","generic","cardboard","gearvr","isMaybeGearVRCompatibleDevice","isMaybeDaydreamCompatibleDevice","capabilities","canPresent","ONLY_SCREEN_AVAILABLE","canShare","opts","title","tweetLink","ReactAudioContext","React","StateRoute","stateKey","stateValue","routeProps","MIC_PRESENCE_VOLUME_THRESHOLD","getMicrophonePresences","microphonePresences","sessionIds","currentSessionIds","talking","networkedAudioAnalysers","networkedAudioAnalyser","Sidebar","beforeTitle","afterTitle","contentClassName","disableOverflowScroll","classNames","defaultProps","IconButton","memo","forwardRef","ref","as","ButtonComponent","compactSm","lg","rest","buttonProps","_path","_path2","SvgClose","_ref","titleId","viewBox","fill","xmlns","stroke","strokeLinecap","strokeLinejoin","CloseButton","SvgChevronBack","BackButton","defaultMessage","Button","sm","xl","thin","thick","preset","NextButton","CancelButton","ContinueButton","AcceptButton","ApplyButton","InputField","htmlFor","fullWidth","_path3","SvgWarning","isExitingFullscreenDueToFocus","TextInput","invalid","beforeInput","afterInput","onFocus","onBlur","textInputStyles","InputElement","buttonStyles","iconButtonStyles","focus","select","handleTextFieldFocus","onChange","nextId","useId","TextInputField","inputClassName","labelId","labelClassName","Column","lastChildMargin","gap","centerMd","grow","gapClass","paddingClass","AvatarSettingsContent","displayNameInputRef","disableDisplayNameInput","onChangeDisplayName","avatarPreview","displayNamePattern","onChangeAvatar","spellCheck","required","AvatarSettingsSidebar","showBackButton","onBack","onClose","Modal","titleNode","disableFullscreen","AvatarSetupModal","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","CubeTextureLoader","Blob","createObjectURL","putImageData","toDataURL","disposeImageBitmap","imageBitmap","HTMLImageElement","TEXTURE_PROPS","base_map","emissive_map","normal_map","orm_map","ALL_MAPS","createRenderer","alpha","useDevicePixelRatio","antialias","premultipliedAlpha","preserveDrawingBuffer","powerPreference","WebGLRenderer","forceWebVR","outputEncoding","physicallyCorrectLights","setPixelRatio","ORBIT_ANGLE","fitBoxInFrustum","margin","applyEuler","AvatarPreview","componentDidMount","PerspectiveCamera","clientWidth","clientHeight","controls","OrbitControls","screenSpacePanning","enableKeys","loadId","avatarGltfUrl","loadCurrentAvatarGltfUrl","clock","Clock","snapshotCanvas","snapshotCamera","snapshotRenderer","setClearAlpha","previewRenderer","setClearColor","currentTheme","currentThemeObject","getThemeBackground","setAnimationLoop","getDelta","resize","mounted","parentElement","offsetWidth","offsetHeight","setSize","updateProjectionMatrix","setAvatar","resetCamera","setState","componentWillUnmount","domElement","imageBitmaps","componentDidUpdate","oldProps","applyMaps","loadPreviewAvatar","previewMesh","idleAnimation","idleAnimationAction","removeOnUpdate","getImage","originalMaps","createDefaultEnvironmentMap","applyMapToPreview","revertMap","bm","newLoadId","onGltfLoaded","newProps","mapName","applyMap","srcSet","linebreak","injectIntl","ProfileEntryPanel","getStateFromProfile","storeUpdated","saveStateAndFinish","preventDefault","hasChangedNowOrPreviously","finished","stopPropagation","setAvatarFromMediaResult","selectAction","replaceHistoryState","refetchAvatar","nameInput","_prevProps","prevState","avatarSettingsProps","inp","displayNameOverride","mediaSearchStore","sourceNavigateWithNoNav","onSubmit","containerType","EMPTY_RESULT","URL_SOURCE_TO_TO_API_SOURCE","videos","youtube","gifs","sketchfab","twitch","SOURCES","apiSource","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","_update","urlSource","getUrlMediaSource","previousSource","urlParams","requestIndex","currentRequestIndex","locationSearchParams","isMy","param","singular","lastSavedUrl","isFetching","nextCursor","next_cursor","lastFetchedUrl","pageNavigate","goBack","filterQueryNavigate","query","getSearchClearedSearchParams","keepSource","keepNav","keepSelectAction","_stashLastSearchParams","_stashedParams","_stashedSource","clearStashedQuery","sourceNavigate","_sourceNavigate","sourceNavigateToDefaultSource","hideNav","useLastStashedParams","currentQuery","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","pushExitMediaBrowserHistory","stashLastSearchParams","setHistory","AvatarUrlModal","handleSubmit","useForm","placeholder","rel","AvatarUrlModalContainer","SceneUrlModal","enableSpoke","editorName","onValidateUrl","isSubmitting","glblink","chunks","getReader","header","read","readChunk","done","cancel","isValidSceneUrl","trim","isValidGLB","SceneUrlModalContainer","intl","useIntl","formatMessage","updateScene","SvgAttach","strokeMiterlimit","ObjectUrlModal","showModelCollectionLink","modelCollectionUrl","watch","setValue","hasFile","fileName","onClear","showCloseButton","sketchfablink","collectionlink","ObjectUrlModalContainer","ducky","SvgSearch","SvgStar","SvgArrowForward","SvgArrowBack","FullscreenLayout","headerLeft","headerCenter","headerRight","MediaGrid","isVariableWidth","navTitleMessages","defineMessages","MediaBrowser","browserRef","searchInputRef","autoFocusSearch","searchPlaceholder","searchDescription","onSearchKeyDown","onClearSearch","mediaSources","selectedSource","onSelectSource","activeFilter","facets","onSelectFacet","onChangeQuery","hasNext","hasPrevious","onNextPage","onPreviousPage","noResultsMessage","autoFocus","onKeyDown","facet","_g","_defs","SvgUpload","clipPath","SvgLink","fillRule","clipRule","_path4","SvgPeople","SvgAdd","SvgPen","SvgDuplicate","SvgHelp","SvgExternalLink","PUBLISHER_FOR_ENTRY_TYPE","sketchfab_model","twitch_stream","BaseTile","additionalProps","TileComponent","tall","wide","tabIndex","role","TileAction","CreateTile","MediaTile","processThumbnailUrl","onEdit","onShowSimilar","onCopy","onInfo","attributions","publisherName","publisher","thumbnailWidth","thumbnailHeight","isImage","isAvatar","imageAspect","useMemo","imageWidth","imageHeight","useThumbnailSize","useThumbnail","last_activated_at","relativeTime","updateIntervalInSeconds","autoPlay","playsInline","alt","favorited","member_count","project_id","LegalMessage","termsUrl","privacyUrl","toslink","privacylink","SignInStep","SignInMessages","pin","unpin","changeScene","roomSettings","closeRoom","muteUser","kickUser","addOwner","removeOwner","createAvatar","remixScene","favoriteRoom","favoriteRooms","tweet","SubmitEmail","onSubmitEmail","initialEmail","setEmail","onSubmitForm","onChangeEmail","WaitForVerification","onCancel","showNewsletterSignup","SignInComplete","onContinue","SignInModal","closeable","PRIVACY_POLICY_LINKS","DEFAULT_FACETS","poweredByMessages","customObjectMessages","searchPlaceholderMessages","emptyMessages","MediaBrowserContainer","showNav","selectNextResult","clearStashedQueryOnClose","getStoreAndHistoryState","selectEntry","sourceChanged","inputRef","getUrlSource","suggestions","handleQueryUpdated","forceNow","_sendQueryTimeout","handleEntryClicked","lucky_query","handleFacetClicked","similar_to","similar_name","onMediaSearchResultEntrySelected","handleSourceClicked","showCustomMediaDialog","isAvatarApiType","showNonHistoriedDialog","handlePager","browserDiv","scrollTop","handleCopyAvatar","performConditionalSignIn","signedIn","handleCopyScene","parent_scene_id","onCreateAvatar","isSceneApiType","showCustomOption","hideSearch","showEmptyStringOnNoResult","handleCustomClicked","customObjectType","ctrlKey","blur","isScene","spokeProjectUrl","EntryStartPanel","entering","onEnteringCanceled","IfFeature","delistAvatarInfoMessage","defineMessage","defaultEditors","allowedEditors","GLTFBinarySplitterPlugin","bin","KHR_binary_glTF","asset","AvatarEditor","baseAvatarResults","editorLinks","previewGltfUrl","creatorAttribution","inputFiles","base_gltf_url","gltfs","randomAvatarResult","base","createOrUpdateAvatar","uploadAvatar","filesToUpload","uploading","fileUploads","onSave","deleteAvatar","fileField","getPreviewUrl","icon","faTimes","mapField","faCloudUploadAlt","textField","baseSid","avatarResult","selectListingField","sid","selectListingGrid","selected","paddingBottom","textarea","checkbox","checked","handleGltfLoaded","editors","companyName","license","licenselink","hideDelete","confirmDelete","has_listings","HMD_MIC_REGEXES","audioOutputSelectEnabled","HTMLMediaElement","detectedOS","detectOS","audioInputSelectEnabled","MediaDevicesManager","onDeviceChange","fetchMediaDevices","changeAudioOutput","selectedSpeakersDeviceId","_scene","_store","_micDevices","_videoDevices","_outputDevices","_deviceId","_audioTrack","_mediaStream","outboundStream","_permissionsStatus","isAudioOutputSelectEnabled","isAudioInputSelectEnabled","deviceId","audioTrack","defaultInputDeviceId","defaultOutputDeviceId","defaultVideoDeviceId","micDevicesOptions","videoDevicesOptions","outputDevicesOptions","selectedMicLabel","micLabelForAudioTrack","selectedMicDeviceId","deviceIdForMicDeviceLabel","isMicShared","getPermissionsStatus","isVideoShared","isWebcamShared","isScreenShared","micStatus","mediaDevice","videoStatus","speakersStatus","enumerateDevices","startMicShare","unmute","updatePrefs","constraints","ideal","_startMicShare","micDeviceId","micLabelForDeviceId","echoCancellation","noiseSuppression","autoGainControl","getUserMedia","addStreamToOutboundAudio","getAudioTracks","recreateAudioStream","stopMicShare","removeStreamFromOutboundAudio","startVideoShare","isDisplayMedia","success","videoTrackAdded","getDisplayMedia","frameRate","addTrack","stopVideoShare","removeTrack","shouldShowHmdMicWarning","enterInVR","hasHmdMicrophone","deviceIdForSpeakersDeviceLabel","speakersLabelForDeviceId","videoDeviceIdForMicLabel","videoLabelForDeviceId","updateGradient","backgroundImage","leftColor","rightColor","getLinearGradientCSS","Slider","useRef","addOrientationChangeListener","useCapture","ScreenOrientation","removeOrientationChangeListener","isNaturalOrientation","getScreenWidth","getScreenHeight","getScreenResolutionWidth","getMaxResolutionWidth","getMaxResolutionHeight","GLOBAL_VOLUME_MAX","WarnIcon","faExclamationTriangle","ResetToDefaultButton","faUndo","ResetToDefaultButtonPlaceholder","sanitize","countDigits","NumberRangeSelector","isFocused","displayValue","digitsFromUser","digits","storeKey","forceUpdate","sanitizedInput","numberOrReset","finalValue","num","CheckboxPlaceholder","BooleanPreference","MapCountPreference","storedPref","Select","PreferenceSelect","onChanged","MaxResolutionPreferenceItem","onOrientationChange","readOnly","multiplier","setMaxResolution","ListItem","indent","preferenceLabels","maxResolution","PreferenceListItem","isCheckbox","itemProps","prefType","isSmallScreen","prefSchema","resetToDefault","disableIfTrue","disableIfFalse","Control","IntlPreferenceListItem","TOP_LEVEL_CATEGORIES","categoryNames","NavItem","ariaLabel","controlType","ControlType","Section","Nav","RefreshPrompt","reportHeight","getComputedStyle","PreferencesScreen","onMediaDevicesUpdated","currentSpeakers","updateMediaDevices","micOptions","speakersOptions","videoOptions","category","toastHeight","createSections","browserDefault","availableLocales","availableThemes","DEFINITIONS","promptForRefresh","defaultBool","toItem","createItem","categoryName","minHeight","_path5","_path6","_path7","SvgWand","SvgChat","SvgSend","SvgReaction","TextAreaInput","TextareaAutosize","ToolbarButton","iconContainerClassName","large","statusColor","PopoverArrow","arrowClass","Popover","Content","showHeader","placement","offsetSkidding","offsetDistance","initiallyVisible","onChangeVisible","popoverApiRef","popoverClass","_visible","_setVisible","setVisible","referenceElement","setReferenceElement","popperElement","setPopperElement","arrowElement","setArrowElement","popper","popperStyles","arrow","arrowStyles","usePopper","modifiers","element","breakpoint","useCssBreakpoints","fullscreen","openPopover","closePopover","togglePopover","popoverVisible","triggerRef","createPortal","iconSheet","EmojiPicker","backgroundImageFn","sheetSize","emojiRegex","MAX_MESSAGE_LENGTH","formatMessageBody","emojiClassName","bodyLength","monospace","cleanedBody","toEmojis","multiline","emojiComponents","formattedBody","SpawnMessageButton","SendMessageButton","EmojiPickerPopoverButton","onSelectEmoji","shiftKeyDown","onKeyUp","onSelect","keepPickerOpen","pickerRemainedOpen","MessageAttachmentButton","ChatLengthWarning","messageLength","maxLength","ChatInput","warning","isOverMaxLength","onSpawn","enteredMessages","joinedMessages","LogMessageType","roomEntryRequired","flyModeDisabled","flyModeEnabled","unauthorizedSceneChange","invalidSceneUrl","unauthorizedRoomRename","captureUnavailable","captureStopped","captureStarted","captureAlreadyStopped","captureAlreadyRunning","positionalAudioEnabled","positionalAudioDisabled","setAudioNormalizationFactor","audioNormalizationDisabled","audioNormalizationNaN","invalidAudioNormalizationRange","audioSuspended","audioResumed","joinFailed","avatarChanged","logMessages","formatSystemMessage","oldName","newName","sceneName","messageType","SystemMessage","MessageBubble","ChatMessageGroup","sent","getMessageComponent","ChatMessageList","ChatSidebar","ChatToolbarButton","onScrollList","listRef","CHAT_MESSAGE_TEXTURE_SIZE","messageBodyDom","fromSessionId","onViewProfile","wrapStyle","messageBodyClasses","includeClientLink","onFromClick","renderChatMessage","allowEmojiRender","isEmoji","entryDom","ReactDOM","html2canvas","logging","meshEntity","blobUrl","meshMaterial","spawnChatMessage","ChatMessage","maySpawn","PhotoMessage","landingPageUrl","photoUrl","getLandingPageForPhoto","onShareClicked","shareHashtag","VideoMessage","ImageMessage","spawnImage","PresenceLog","domForEntry","entryClasses","expired","isBot","discord","includeFromLink","inRoom","systemMessage","presenceClasses","PreloadOverlay","loadButtonText","hubScene","screenshot_url","onLoadClicked","drawFunc","xData","yData","xSum","xRatio","yMax","yRatio","fillStyle","strokeStyle","lineWidth","x0","x1","y0","y1","beginPath","moveTo","lineTo","closePath","DataGraph","xAxis","yAxis","canvasRef","draw","animationFrameId","requestAnimationFrame","cancelAnimationFrame","useCanvas","CreatePropsFromData","propKey","propValue","Prop","DataPanel","graphData","alignSelf","flex","CollapsiblePanel","border","row","wrap","collapsed","download","rootClassName","rootStyle","flexGrow","buttonClassName","contentStyle","flexFlow","isCollapsed","collapse","openLink","SvgCaretDown","getItemValue","getSelectedItem","selectedItemValue","getItemLabel","SelectInputField","selectedItem","getToggleButtonProps","getMenuProps","getLabelProps","highlightedIndex","getItemProps","useSelect","onSelectedItemChange","selectedItemLabel","isRequired","DISTANCE_MAX","ANGLE_MAX","SelectProperty","padEnd","newValue","SliderProperty","parsedValue","getPrefs","AudioDebugPanel","isNarrow","onCollapsed","mediaSettings","setMediaSettings","avatarSettings","setAvatarSettings","onSettingChange","newSetting","setPreferences","onPreferencesUpdated","maxHeight","alignItems","marginLeft","TransportType","StatsType","ERROR_COLOR","PRODUCERS_KEY","CONSUMERS_KEY","MEDIASOUP_DOC_BASE_URL","MDN_DOC_BASE_URL","MessageButtonStyle","minWidth","isFirefox","capitalize","toUpperCase","PanelMessageButton","TrackStatsPanel","opened","codec","producerScore","producerScores","rtpStats","graph","TransportPanel","candidates","producers","consumers","isButtonEnabled","onRestart","SignalingPanel","onConnect","onDisconnect","RtcDebugPanel","logEvent","currentLog","showPanel","connectSignaling","disconnectSignaling","colorForLevel","createLogMsgs","logLines","reverse","createLog","Local","Log","Remote","runStats","getDeviceData","_recvRtpCapabilities","codecs","mimeType","clockRate","getCandidatesData","peer","getStats","selectedCandidatePairId","candidatePair","isCandidate","getTransportData","_connectionState","_id","getProducerConsumerData","profileFromPresence","profileFromConsumer","_appData","_paused","getTrackData","_kind","_track","getSignalingData","getServerData","getRtpStatsData","getGraphData","lastStats","statsData","last","bytesSent","bytesReceived","packetsSent","packetsReceived","bytesSentDelta","bytesReceivedDelta","packetsSentDelta","packetsReceivedDelta","timeDelta","getPeerSpeed","lastData","running","taskId","deviceData","serverData","signalingData","transportsData","speedData","rtpStatsData","createCandidates","createProducers","createConsumers","reducedConsumers","reducedConsumer","consumerPanels","createRemoteTransports","stat","showRtcDebug","showAudioDebug","filename","click","maskEmail","emailParts","emailIdentity","emailDomain","SvgHmcLogo","AppLogo","forceConfigurableLogo","logo","preferredThemeId","getCurrentTheme","getAppLogo","LoadingScreenLayout","SvgSpinner","Spinner","LoadingScreen","infoMessages","infoMessage","transitionDelay","messageTimeoutRef","queueNextMessage","currentIndex","useRandomMessageTransition","heading","reducer","objectCount","loadedCount","allObjectsLoaded","environmentLoaded","networkConnected","loaded","lazyLoadMedia","dialogConnected","loadingObjects","connectingScene","enteringRoom","LoadingScreenContainer","onLoaded","loadingTimeoutRef","dispatch","useReducer","onObjectLoading","onObjectLoaded","onEnvironmentLoaded","onNetworkConnected","onDialogConnected","useRoomLoadingState","Toolbar","styleUtils","hideLeft","hideRight","RoomLayout","viewportClassName","sidebar","sidebarClassName","toolbarLeft","toolbarCenter","toolbarRight","toolbarClassName","modal","objectFocused","viewportRef","RoomLayoutContainer","ResizeObserver","isPresenting","isVRPresenting","canvasRect","contentRect","rendererSize","pixelRatio","calculateRendererSize","observe","useResizeViewport","SvgEnter","SvgVr","SvgShow","SvgSettings","RoomEntryModal","roomName","showJoinRoom","onJoinRoom","showEnterOnDevice","onEnterOnDevice","showSpectate","onSpectate","showOptions","onOptions","EnterOnDeviceModal","shortUrl","loadingCode","code","headsetConnected","unsupportedBrowser","onEnterOnConnectedHeadset","char","_rect","SvgMicrophone","SvgMicrophoneMuted","SvgVolumeOff","SvgInfo","ToggleInput","MicSetupModal","microphoneOptions","onChangeMicrophone","speakerOptions","onChangeSpeaker","isMicrophoneEnabled","onPlaySound","isMicrophoneMuted","onChangeMicrophoneMuted","onEnterRoom","permissionStatus","isAudioInputSelectAvailable","isAudioOutputSelectAvailable","micLevelBar","speakerLevelBar","iconStyle","onMouseEnter","onMouseLeave","marginRight","useMicrophoneStatus","isMicMuted","setIsMicMuted","setIsMicEnabled","setPermissionsStatus","onMicMutedStateChanged","onMicDisabled","onPermissionsChanged","toggleMute","useMicrophone","micDevices","setMicDevices","micDeviceChanged","useSound","sfxSystem","analyserRef","mixerAnalyser","playSound","useSpeakers","speakerDevices","setSpeakerDevices","speakerDeviceChanged","LevelBar","MIN_VOLUME_THRESHOLD","useVolumeMeter","updateRate","movingAvgRef","meterRef","timout","meter","movingAverage","nextVolume","VolumeLevelBar","pct","MicSetupModalContainer","isMicMutedOnEntry","setIsMicMutedOnEntry","copyLabelMessage","copiedLabelMessage","CopyableTextInputField","buttonPreset","clipboard","useClipboard","copiedTimeout","copyLabel","copiedLabel","maxLabelLength","isSupported","copied","SvgInvite","InviteLinkInputField","fetchingInvite","inviteUrl","onRevokeInvite","showRevokeConfirmation","setShowRevokeConfirmation","revokeInvite","cancelConfirmRevokeInvite","confirmRevokeInvite","InvitePopoverContent","embed","inviteRequired","invitePopoverTitle","InvitePopoverButton","useInviteUrl","inviteId","setInviteId","fetchInvite","hub_invite_id","InvitePopoverContainer","embedText","embed_token","onInviteButtonClicked","canGenerateInviteUrl","SvgMore","MoreMenuItem","Icon","MoreMenuGroup","MoreMenuPopoverContent","MoreMenuContext","createContext","MoreMenuContextProvider","Provider","moreMenuTitle","MoreMenuPopoverButton","useContext","CompactMoreMenuButton","ChatContext","messageGroups","sendMessage","uniqueMessageId","NEW_MESSAGE_GROUP_TIMEOUT","ChatContextProvider","setMessageGroups","unreadMessages","setUnreadMessages","onReceiveMessage","newMessage","messageProps","lastMessageGroup","senderSessionId","shouldCreateNewMessageGroup","processChatMessage","updateMessageGroups","setMessagesRead","ChatSidebarContainer","canSpawnMessages","inputEffect","scrolledToBottom","setScrolledToBottom","scrollHeight","useMaintainScrollPosition","setMessage","typingTimeoutRef","shiftKey","endTyping","beginTyping","onSendMessage","onUploadAttachments","native","discordSnippet","ch","discordChannels","onScroll","ChatToolbarButtonContainer","joinChildren","renderSeparator","Children","SvgObjects","ContentMenuButton","ObjectsMenuButton","PeopleMenuButton","presenceCount","presencecount","ContentMenu","SvgCamera","SvgAvatar","SvgDelete","SvgWarningCircle","SvgHome","SvgTextDocument","_path8","_path9","_path10","SvgSupport","SvgShield","SvgDiscord","SvgLeave","SvgDesktop","SvgPhone","SvgVolumeHigh","SvgVolumeMuted","_style","SvgHandRaised","xmlSpace","List","ButtonListItem","getDeviceLabel","hmd","mobile","getVoiceLabel","micPresence","PeopleSidebar","people","onSelectPerson","showMuteAll","onMuteAll","numPeople","person","DeviceIcon","VRIcon","DiscordIcon","PhoneIcon","DesktopIcon","getDeviceIconComponent","VoiceIcon","VolumeMutedIcon","VolumeHighIcon","VolumeOffIcon","getVoiceIconComponent","you","isMe","getPersonName","getPresenceMessage","PromoteClientModal","onConfirm","MIN","MAX","UserProfileSidebar","userId","hasMicPresence","isSignedIn","canPromote","onPromote","canDemote","onDemote","isHidden","onToggleHidden","canMute","isNetworkMuted","canKick","onKick","updateMultiplier","isMuted","updateMuted","onMultiplierChanged","getPlayerInfo","controlsEl","setMultiplier","setIsMuted","onMultiplierUpdated","onLocalMutedUpdated","useAvatarVolume","onLevelChanged","calcGainMultiplier","newLevel","UserProfileSidebarContainer","user","onCloseDialog","avatarThumbnailUrl","setAvatarThumbnailUrl","mayKick","mayMute","setIsOwner","signed_in","mayAddOwner","mayRemoveOwner","setIsHidden","getAvatarThumbnailUrl","toggleHidden","unhide","userFromPresence","micPresences","mySessionId","PeopleListContainer","mute_users","PeopleSidebarContainer","micUpdateFrequency","setPeople","updateMicrophoneState","usePeopleList","selectedPersonId","setSelectedPersonId","selectedPerson","setSelectedPerson","SORT_ORDER_VIDEO","SORT_ORDER_AUDIO","SORT_ORDER_IMAGE","SORT_ORDER_PDF","SORT_ORDER_MODEL","SORT_ORDER_UNIDENTIFIED","mediaSortOrder","mediaSort","el1","el2","faVideo","faMusic","faImage","faNewspaper","faQuestion","faCube","SORT_ORDER_TO_TYPE","getMediaType","getDisplayString","resourceName","httpIndex","lessHost","hostSplit","ObjectListContext","objects","focusedObject","selectedObject","focusObject","unfocusObject","inspectObject","uninspectObject","handleInspect","handleDeselect","ObjectListProvider","setObjects","setFocusedObject","setSelectedObject","setLightsEnabled","updateMediaEntities","sort","onInspectTargetChanged","inspectedEl","onLightsChanged","selectObject","deselectObject","selectNextObject","curObjIdx","nextObjIdx","selectPrevObject","activeObject","cloneElement","useObjectList","SvgObject","SvgImage","SvgVideo","SvgAudio","objectTypeNames","ObjectsSidebarItem","ObjectTypeIcon","VideoIcon","AudioIcon","ImageIcon","TextDocumentIcon","ObjectIcon","getObjectIcon","listStyles","NoObjects","canAddObjects","ObjectsSidebar","ObjectsSidebarContainer","onUnfocusListItem","relatedTarget","onMouseOver","onMouseOut","SvgLightbulb","SvgLightbulbOutline","ObjectMenuButton","ObjectMenu","onPrevObject","onNextObject","currentObjectIndex","onToggleLights","removeNetworkedObject","getPinnedState","isPlayer","SvgPin","SvgGoTo","SvgHide","MyMenuItems","onOpenProfile","PlayerMenuItems","hideAvatar","useHideAvatar","ObjectMenuItems","onGoToObject","togglePinned","setIsPinned","pinObject","unpinObject","onPinStateChanged","userOwnsFile","usePinObject","canRemoveObject","removeObject","useRemoveObject","canGoTo","goToSelectedObject","enqueueWaypointTravelTo","willDisableMotion","willDisableTeleporting","snapToNavMesh","willMaintainInitialOrientation","useGoToSelectedObject","getObjectUrl","ObjectMenuContainer","menuItems","SvgGif","SvgScene","ButtonGridPopover","placePopoverTitle","PlacePopoverButton","filteredItems","PlacePopoverContainer","setItems","updateItems","hasActiveCamera","hasActivePen","getMyPen","nextItems","PenIcon","CameraIcon","GIFIcon","AvatarIcon","SceneIcon","UploadIcon","onSceneStateChange","SvgShare","sharePopoverTitle","SharePopoverButton","activeItem","SharePopoverContainer","sharingSource","canShareCamera","toggleShareCamera","canShareScreen","toggleShareScreen","canShareCameraToAvatar","toggleShareCameraToAvatar","setSharingSource","setCanShareCamera","setCanShareScreen","setCanShareCameraToAvatar","hasVideoTextureTarget","avatarModelEl","useAvatar","onShareVideoEnabled","onShareVideoDisabled","devices","hasCamera","useShare","Row","spaceBetween","breakpointColumn","topMargin","flexClassName","flexBasis","noWrap","childrenMarginR","breakpointColumnClass","topMarginClass","flexBasisClass","childrenMarginRClass","Divider","marginClass","AudioPopoverContent","nowrap","isSoundPlaying","AudioPopoverContentContainer","SvgArrow","AudioPopoverButton","micButton","ToolbarMicButton","rect","AudioPopoverButtonContainer","AudioPopoverContainer","ImageGridPopover","ReactionButton","HandRaisedButton","reactionPopoverTitle","ReactionPopoverContent","onToggleHandRaised","TooltipPopoverContent","ReactionPopoverButton","isReactionsVisible","setIsReactionsVisible","isTooltipVisible","setIsTooltipVisible","onTooltipHandLowered","emojiLabels","smile","laugh","clap","heart","wave","angry","cry","ReactionPopoverContainer","initialPresence","setPresence","onPresenceUpdate","usePresence","lowerHand","raiseHand","SafariMicModal","reload","RoomSignInModalContainer","cachedEmail","setCachedEmail","showTerms","showPrivacy","LeaveReason","reasonMessages","confirmationMessages","LeaveRoomModal","destinationUrl","SceneAttribution","attribution","unknown","author","SceneInfo","accountId","showAttributions","canChangeScene","onChangeScene","changeSceneButton","showSceneLink","account_id","allow_promotion","allowDisplayOfSceneLink","filteredAttributionElements","RoomSidebar","canEdit","TextAreaInputField","RadioInputContainer","RadioInputOption","RadioInputField","_RadioInputOption","NumericInput","inputMode","NumericInputField","RoomSettingsSidebar","maxRoomSize","showPublicRoomSetting","defaultValues","entryMode","spawnAndMoveMedia","shouldDirty","autoComplete","minLength","minRows","room_size","RoomSettingsSidebarContainer","applyChanges","updateHub","roomSize","AutoExitReason","AutoExitWarningModal","secondsRemaining","ExitReason","exited","denied","disconnected","full","sceneError","connectError","versionMismatch","ExitedRoomScreen","showSourceLink","subtitle","contactEmail","tcpUrl","tcpParams","CloseRoomModal","confirmText","setConfirmText","showIsNotMatchError","setShowIsNotMatchError","onClickConfirm","WebVRUnsupportedModal","emojiPlugin","createEmojiPlugin","hashtagPlugin","createHashtagPlugin","linkifyPlugin","createLinkifyPlugin","counterPlugin","createCounterPlugin","TweetEditorModal","editorState","editorRef","sending","mediaThumbnailUrl","onClickEditor","onSend","EmojiSuggestions","EmojiSelect","CharCounter","tweetLength","getCurrentContent","getPlainText","limit","addEmoji","contentState","entityKey","createEntity","emojiUnicode","getLastCreatedEntityKey","currentSelectionState","getSelection","emojiAddedContent","emojiEndPos","blockSize","afterRemovalContentState","Modifier","targetSelection","getSelectionAfter","getAnchorOffset","blockKey","getAnchorKey","getBlockForKey","getLength","newEditorState","EditorState","TweetEditorModalContainer","setEditorState","createEditorStateWithText","setSending","sendTweet","media_stored_file_url","TwitterOAuthModal","appName","TwitterOAuthModalContainer","onConnected","popupRef","getTwitterOAuthURL","screenLeft","screenTop","doingTwitterOAuth","popup","onMessage","TweetModalContainer","canTweet","setCanTweet","Tip","onDismiss","dismissLabel","moveKeys","turnLeftKey","turnRightKey","getLayoutMap","onboardingMessages","OkDismissLabel","SkipDismissLabel","FullscreenTip","TipContainer","inLobby","isStreaming","isEmbedded","lobbyTipDismissed","setLobbyTipDismissed","broadcastTipDismissed","setBroadcastTipDismissed","streamingTipDismissed","setStreamingTipDismissed","embeddedTipDismissed","setEmbeddedTipDismissed","onboardingTipId","setOnboardingTipId","onSkipOnboarding","tips","skipTips","tipId","activeTip","isBroadcasting","broadcastTarget","channelName","hasEmbedPresences","SpectatingLabel","avatarEditorDebug","IN_ROOM_MODAL_ROUTER_PATHS","IN_ROOM_MODAL_QUERY_VARS","LOBBY_MODAL_ROUTER_PATHS","LOBBY_MODAL_QUERY_VARS","LOBBY_MODAL_QUERY_VALUES","UIRoot","willCompileAndUploadMaterials","showShareDialog","linkCode","linkCodeCancel","miniInviteActivated","didConnectToNetworkedScene","noMoreLoadingUpdates","hideLoader","showPrefs","watching","waitingOnAudio","audioTrackClone","autoExitTimerStartedAt","autoExitTimerInterval","autoExitReason","secondsRemainingBeforeAutoExit","videoShareMediaSource","showVideoShareFailed","objectInfo","objectSrc","sidebarId","chatInputEffect","onConcurrentLoad","startAutoExitTimer","onIdleDetected","disableAutoExitOnIdle","onActivityDetected","endAutoExitTimer","showContextualSignInDialog","signInMessage","authChannel","onContinueAfterSignIn","authComplete","startAuthentication","closeDialog","updateSubscribedState","isSubscribed","toggleFavorited","isFavorited","onLoadingFinished","onSceneLoaded","sceneLoaded","onShareVideoFailed","shareVideo","mediaSource","endShareVideo","onSubscribeChanged","handleForceEntry","forcedVREntryType","enterDaydream","enter2D","secondsSinceStart","checkForAutoExit","exitScene","isWaitingForAutoExit","performDirectEntryFlow","hasGrantedMic","grantedMicLabels","beginOrSkipAudioSetup","onRequestMicPermission","availableVREntryTypes","onAudioReadyButton","clearHistoryState","muteOnEntry","enterScene","attemptLink","onFinished","linkChannel","generateCode","toggleShareDialog","DialogClass","toggleStreamerMode","beginStreaming","endStreaming","renderDialog","signOut","onMiniInviteClicked","hasEmbedPresence","onTweet","onFocusChat","setSidebar","renderInterstitialPrompt","onInterstitialPromptClicked","renderBotMode","sendEnteringCancelledEvent","renderEntryStartPanel","promptForNameAndAvatarBeforeEntry","entryDisallowed","sendEnteringEvent","renderDevicePanel","renderAudioSetupPanel","isInModalOrOverlay","overlay","exitEventHandler","prevProps","showSignInDialog","isBotMode","compile","isTexture","initTexture","roomLayoutStyles","hideUITip","entry_step","playerRig","UNSAFE_componentWillMount","otherState","selectedUserId","toggleSidebar","curSidebarId","getSelectedUser","rootStyles","showSafariMicDialog","showPreload","isLoading","showInterstitialPrompt","enteredOrWatching","enableSpectateVRButton","entryDialog","presenceLogEntries","showMediaBrowser","showObjectList","streamerName","renderEntryFlow","canCloseRoom","isModerator","moreMenu","LeaveIcon","EnterIcon","SettingsIcon","HomeIcon","DeleteIcon","closeHub","WarningCircleIcon","SupportIcon","resetTips","ShieldIcon","onPreloadLoadClicked","onSignIn","returnToProfile","onAvatarSaved","cameraMode","UIRootHooksWrapper","keyboardUserClass","keyboardUser","setKeyboardUser","onMouseDown","useAccessibleOutlineStyle","checkingForDeviceAvailability","environmentSceneLoaded","roomUnavailableReason","isSupportAvailable","ExitedRoomScreenContainer","constants","AuthChannel","setSocket","_signedIn","verifyAuthentication","authTopic","authToken","authPayload","leave","handleAuthCredentials","signIn","isSameMonth","da","db","HUB_CREATOR_PERMISSIONS","VALID_PERMISSIONS","HubChannel","setPermissionsFromToken","_permissions","postgrest_role","nextRefresh","fetchPermissionsTimeout","fetchPermissions","entryDisplayType","vrDisplay","initialOccupantCount","entryState","entryEvent","getEntryTimingFlags","entryTimingFlags","isNewDaily","isNewMonthly","isNewDayWindow","isNewMonthWindow","storedLastEnteredAt","lastEntered","msSinceLastEntered","sendObjectSpawnedEvent","object_type","sendProfileUpdate","update_hub","hubInviteId","close_hub","subscribe","subscription","allowNAFTraffic","allow","_getCreatorAssignmentToken","creatorAssignmentTokenEntry","creator_assignment_token","auth_token","oauth_url","gltfNode","fileAccessToken","gltf_node","file_access_token","permsToken","_blockedSessionIds","completeSync","requestSupport","favorite","unfavorite","Set","permission","userCan","canEnterRoom","migrateToSocket","presenceBindings","onJoin","caller","onLeave","onSync","Presence","hubChannelParamsForPermsToken","migrateToChannel","beginRecording","endRecording","deriveKey","privateKey","publicKey","crypto","subtle","public","publicKeyToString","exportKey","stringToPublicKey","importKey","namedCurve","stringToArrayBuffer","buf","charCodeAt","arrayBufferToString","keyPair","generateKey","publicKeyString","incomingPublicKeyString","iv","incomingPublicKey","secret","encryptedData","encrypt","base64value","ciphertext","atob","decrypt","LINK_ACTION_TIMEOUT","LinkChannel","getLetter","readyToSend","leftChannel","incoming","generatePublicKeyAndEncryptedObject","public_key","target_session_id","reply_to_session_id","generateKeys","numOccupants","decryptObject","exceedsDensityThreshold","subtree","boundingData","isHighDensity","continueGeneration","leftResult","rightResult","isGeometryHighDensity","roots","_roots","traverseMeshesAndAddShapes","shapePrefix","shapes","meshRoot","__proto__","navMesh","fit","FIT","includeInvisible","groupEnd","interact","interactor","interactedQuery","rightRemoteQuery","leftRemoteQuery","BUTTON_TYPES","DEFAULT","ACTION","applyTheme","hoverColor","hoverComponents","hoverButtonsQuery","buttonSystems","hasAnyComponent","hoverButtonSystem","interactedEnts","interactorSettings","singleActionButtonSystem","rigidbodyQuery","rigidbodyEnteredQuery","rigidbodyExitedQuery","shapeExitQuery","DEFAULTS","isValidChild","preloadFont","characters","reservedAttrs","Ref","createRef","resolveRef","addEntity","createElementEntity","attrs","outputAttrs","attr","flat","addObject3DComponent","$isEidType","createDefaultInflator","inflators","holdable","rigidbody","guide","leftPadded","rightPadded","topPadded","bottomPadded","updateSlice9Geometry","TroikaText","modelEid","gltfSrc","renderAsEntity","entityDef","fromArray","childEid","buttonTexture","Label","cameraModelSrc","prefabs","screenMaterial","screenGeometry","buttonHeight","buttonScale","smallButtonScale","uiZ","cube","createMessageDatas","createNetworkedEntityFromRemote","prefabName","initialData","rootNid","nid2eid","spawnAllowed","createNetworkedEntity","networkedObjectsQuery","ownedNetworkObjectsQuery","networkableComponents","pendingMessages","pendingJoins","pendingParts","messageFor","created","updated","deleted","creates","updates","deletes","updateMessage","componentIds","isNetworkInstantiated","isNetworkInstantiatedByMe","subscribeToDataChannel","fromClientId","_dataType","pendingUpdatesForNid","rcvEnteredNetworkedObjectsQuery","nextNetworkTick","sendEnteredNetworkedObjectsQuery","sendExitedNetworkedObjectsQuery","MessageDispatch","commandParts","dispatchCommand","activeElement","command","scales","curScale","captureSystem","enableFly","relativeUrl","getAbsoluteUrl","avatarPov","setDebug","debugEnabled","inalidSceneUrl","rename","available","factor","effectiveFactor","addToPresenceLog","forceEnableTouchscreen","SceneEntryManager","whenSceneLoaded","_setupBlocking","hasEntered","_entered","session","verbose","waypointSystem","_setupPlayerRig","_setupKicking","_setupMedia","_setupCamera","_spawnAvatar","_runBot","toISOString","hasLoaded","enterSceneWhenLoaded","localMediaStream","_setPlayerInfoFromProfile","avatarScale","_lastFetchedAvatarId","kickedClientId","unpinElement","removeEntity","ev","removeEntitiesOfClient","spawnMediaInfrontOfPlayer","or","lastDebugScene","currentVideoShareEntity","forceExitFrom2DInterstitial","contentEditable","clipboardData","getData","dataTransfer","isHandlingVideoShare","shareSuccess","isVideoTrackAdded","shareError","delaySpawn","audioInput","dataInput","crossorigin","onchange","getRecording","audioStream","captureStream","mozCaptureStream","audioVolume","audioDestination","gainNode","urlBase64ToUint8Array","base64String","base64","repeat","rawData","outputArray","Subscriptions","setHubChannel","setRegistration","registration","setRegistrationFailed","setVapidPublicKey","vapidPublicKey","_isSubscribed","getCurrentEndpoint","serviceWorker","startedAt","pushManager","convertedVapidKey","permissionState","userVisibleOnly","applicationServerKey","getSubscription","endpoint","pushSubscription","has_remaining_subscriptions","Pathfinding","traverseFilteredSubtrees","pathfinder","removeNavMeshData","loadMesh","setZoneData","createZone","teleporters","helperMesh","_hubs_audio_debug_prev_material","zones","invaderPos","bubblePos","createSphereGizmo","line","invaders","bubbles","tickCount","_updateInvaders","registerBubble","bubble","unregisterBubble","registerInvader","invader","unregisterInvader","updateDebug","setInvading","tempInvasionFlags","setInvaderFlag","distanceSquared","radiusSum","flushInvadingFlagsForIndex","invading","DEBUG_OBJ","useMaterial","invadingOpacity","gltfRootEl","getGLTFModelRoot","alwaysHidden","radiusSquared","applyInvasionToMesh","originalProps","blending","NormalBlending","system","IDLE_TIMEOUT_MS","CHARACTER_ACCELERATION_PATH","BASIC_ACTIVITY_PATHS","resetTimeout","idleTimeout","lastInputCheck","onIdleTimeout","basicActivity","activityPath","penEls","updateMyPen","myPen","sets","modeMod","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","isInModal","MouseDevice","queueEvent","passive","deltaX","deltaY","deltaMode","middle","clientX","clientY","movementX","movementY","mouseDownLeftThisFrame","mouseDownRightThisFrame","mouseDownMiddleThisFrame","write","didStopProcessingEarly","setVector2","setValueType","ArrayBackedSet","initialItems","oncontextmenu","CODE_TO_KEY","KeyW","KeyA","KeyS","KeyD","KeyQ","KeyE","KeyboardDevice","seenKeys","HudDevice","XboxControllerDevice","buttonMap","buttonId","axisMap","axisId","getGamepads","xboxPaths","buttons","hapticActuators","Pose","fromOriginAndDirection","setFromUnitVectors","fromCameraProjection","normalizedX","normalizedY","unproject","applyArmModel","controllerEuler","deltaControllerPosition","controllerQuaternion","controllerPosition","gamepadPose","headObject3D","userHeight","copySittingToStandingTransform","stageParameters","sittingToStandingTransform","ONES","TOUCHPAD","TRIGGER","OculusGoControllerDevice","sittingToStandingMatrix","rayObject","rayMatrixWorld","setPose","setMatrix4","TOUCHPAD_X","TOUCHPAD_Y","GearVRControllerDevice","leftOculusTouchButtonMap","rightOculusTouchButtonMap","LEFT_HAND_OFFSET","RIGHT_HAND_OFFSET","OculusTouchControllerDevice","buttonMaps","devicePaths","handOffset","HAND_OFFSET","POSE","MATRIX","DaydreamControllerDevice","RAY_ROTATION","ViveControllerDevice","gamepads","WindowsMixedRealityControllerDevice","WebXRControllerDevice","referenceSpace","getPose","targetRaySpace","CircularBuffer","writePtr","difference","GyroDevice","hmdEuler","hmdQuaternion","prevX","prevY","dXBuffer","dYBuffer","hasPolyfill","webvrpolyfill","getPolyfillDisplays","frameData","VRFrameData","getFrameData","calculateCursorPose","AppAwareMouseDevice","touchIsAssigned","touch","assignments","assignment","identifier","jobIsAssigned","job","unassign","findByJob","findByTouch","findRemoteHoverTarget","hoveredRightRemoteQuery","hoveredLeftRemoteQuery","HIGHLIGHT","NO_HIGHLIGHT","TRANSFORM_COLOR_1","TRANSFORM_COLOR_2","defaultDistance","minDistance","cursorVisual","setCursorScale","renderOrder","RENDER_ORDER","firstHitOnly","lineGeometry","Line","LineBasicMaterial","rawIntersections","cameraPos","isGrabbing","isHoveringSomething","ray","cursorTargettingSystem","remoteHoverTarget","cursorModDelta","activeSets","leftCursorHoldingUI","rightCursorHoldingUI","lerpHSL","posePosition","cursorPosition","positionArray","computeBoundingSphere","MOVE_CURSOR_JOB","MOVE_CAMERA_JOB","FIRST_PINCHER_JOB","SECOND_PINCHER_JOB","TAP_PATHS","x2","y2","dx","dy","getPlayerCamera","AppAwareTouchscreenDevice","pendingTap","maxTouchCount","tapIndexToWriteNextFrame","getBoundingClientRect","framesUntilGrab","framesUntilUnassign","first","cameraMover","move","isFirstTouch","isSecondTouch","isThirdTouch","hasSecondPinch","setFromCamera","isSingleActionButton","isInteractable","isSceneFrozen","shouldMoveCursor","cursorJob","previousAssignment","changedTouches","touches","hasCursorJob","hasCameraJob","lastPose","xforms","dest","scalar","scaleExp","deadzone","deadzoneSize","split_vec2","compose_vec2","copyIfFalse","bool","copyIfTrue","copyVec2IfTrue","zeroIfDefined","true","rising","risingWithFrameDelay","falling","vec2Zero","poseFromCameraProjection","vec2dpad","deadzoneRadius","invertX","invertY","deadzoneRadiusSquared","atan2","always","constValue","wasd_to_vec2","vec2","add_vec2","max_vec2","normalize_vec2","any","touch_axis_scroll","snap_to","touching","diff_vec2","invert_vec2_if_preference","preference","oneOrMinusOne","addSetsToBindings","mapping","setName","binding","wasd_vec2","keyboardCharacterAcceleration","arrows_vec2","togglePenWithRMB","togglePenWithEsc","togglePenWithP","togglePenWithHud","togglePen","startInspectingViaMouse","startInspectingViaKeyboard","stopInspectingViaKeyboard","stopInspectingViaKeyboardFocus","stopInspectingSelf","inspectZoomSpeed","keyboardMouseUserBindings","global","xform","priority","rightCursorHoldingPen","rightCursorHoldingCamera","rightCursorHoldingInteractable","rightCursorHoveringOnInteractable","rightCursorHoveringOnVideo","inputFocused","rightCursorHoveringOnUI","inspecting","zero","touchCamDeltaMaybeInverted","touchCamDelta","touchCamDeltaX","touchCamDeltaY","touchCamDeltaXScaled","touchCamDeltaYScaled","gyroCamDelta","gyroCamDeltaXScaled","gyroCamDeltaYScaled","touchscreenUserBindings","rightCursorHoveringOnPen","keyboardDebuggingBindings","leftButton","leftAxis","leftPose","rightButton","rightAxis","rightPose","wakeLeft","wakeRight","leftJoyXDeadzoned","leftJoyYDeadzoned","scaledLeftJoyX","scaledLeftJoyY","cursorDrop2","cursorDrop1","leftCursorDrop2","leftCursorDrop1","rightHandDrop2","rightGripRisingGrab","rightTriggerRisingGrab","leftGripRisingGrab","leftTriggerRisingGrab","rightDpadNorth","rightDpadSouth","rightDpadEast","rightDpadWest","rightDpadCenter","rightJoy","rightJoyY1","rightJoyY2","rightJoyYDeadzoned","leftDpadNorth","leftDpadSouth","leftDpadEast","leftDpadWest","leftDpadCenter","leftJoy","oculusTouchCharacterAcceleration","keyboardBoost","rightBoost","leftBoost","rightTouchSnapRight","rightTouchSnapLeft","keyboardSnapRight","keyboardSnapLeft","lowerButtons","upperButtons","ensureFrozenViaButtons","ensureFrozenViaKeyboard","thawViaButtons","thawViaKeyboard","leftGripPressed1","leftGripPressed2","rightGripPressed1","rightGripPressed2","leftTriggerPressed1","leftTriggerPressed2","rightTriggerPressed1","rightTriggerPressed2","oculusTouchUserBindings","north","south","east","west","override","leftHandHoveringOnNothing","leftCursorHoveringOnUI","leftCursorHoveringOnVideo","rightCursorHoveringOnNothing","leftCursorHoveringOnNothing","leftHandHoveringOnInteractable","leftHandHoldingInteractable","leftHandHoveringOnPen","leftHandHoldingPen","leftCursorHoveringOnInteractable","leftCursorHoldingInteractable","leftCursorHoldingPen","rightHandHoveringOnInteractable","rightHandHoldingInteractable","rightHandHoveringOnPen","rightHandHoldingPen","rightCursorHoveringOnCamera","rightHandHoveringOnCamera","leftHandHoveringOnCamera","rightHandHoldingCamera","leftHandHoldingCamera","leftCursorHoldingCamera","rightHandHoveringOnNothing","cursorDrop3","touchpadRising","dpadNorth","dpadSouth","dpadEast","dpadWest","dpadCenter","dpadCenterStrip","snapRotateRight1","snapRotateRight2","snapRotateLeft1","snapRotateLeft2","centerStripPressed","touchpadReleased","lowerButtonsReleased","webXRUserBindings","lButton","lAxis","lPose","lJoy","lJoyScaled","lJoyXScaled","lJoyYScaled","lJoyYDeadzoned","lTouch","lTouchScaled","lTouchXScaled","lTouchY","lTouchYScaled","lDpadNorth1","lDpadSouth1","lDpadEast1","lDpadWest1","lDpadCenter1","lDpadNorth2","lDpadSouth2","lDpadEast2","lDpadWest2","lDpadCenter2","lTriggerFallingStopDrawing","lGripFallingStopDrawing","lTriggerRisingGrab","lGripRisingGrab","lTouchpadRising2","lTouchpadRising1","touchCharacterAcceleration","lCharacterAcceleration","leftUndoDrawing","rButton","rAxis","rPose","rTouch","rJoy","rJoyYDeadzoned","rDpadNorth1","rDpadSouth1","rDpadEast1","rDpadWest1","rDpadCenter1","rDpadNorth2","rDpadSouth2","rDpadEast2","rDpadWest2","rDpadCenter2","rDpadCenterStrip","rTouchpadRising","rTouchpadFalling","rTriggerRisingGrab","rGripRisingGrab","rightCursorDrop1","rightCursorDrop2","rTriggerStopTeleport","rTouchpadStopTeleport","rootForFrozenOverrideWhenHolding","rightUndoDrawing","ensureFrozenViaDpad","thawViaDpad","freezeButtons","inspectButtons","rSnapRight1","rSnapLeft1","rSnapRight2","rSnapLeft2","leftTouchpadPressed1","leftTouchpadPressed2","leftTouchpadFallingStopTeleport","leftTriggerFallingStopTeleport","leftGripFallingWhileHoldingPen","viveUserBindings","rightHandTeleporting","leftHandTeleporting","leftCursorHoveringOnPen","leftCursorHoveringOnCamera","viveWandUserBindings","indexUserBindings","viveFocusPlusUserBindings","viveCosmosUserBindings","lGripPressed","rGripPressed","rTriggerPressed","rJoyNorth","rGripRising","rTriggerRising","rGripFalling","rTriggerFalling","dpadVariables","padWest","padEast","padNorth","padSouth","padCenter","padCenterStrip","dpadBindings","pad","neverFrozenBinding","penBindings","forCursor","padY","triggerPressed","padPressed","padTouched","padRising","padCenterStripTouched","handPoseBindings","gripPressed","holdingCameraBindings","wmrUserBindings","leftPadPressed","rightPadPressed","leftPadFalling","rightPadFalling","keyboardSaceFalling","freezeBindings","rJoyWest","rJoyEast","rJoyWestRising","rJoyEastRising","keyboardQRising","keyboardERising","teleportationAndRotationBindings","lJoyXDeadzoned","characterAccelerationBindings","cursorMediaVolumeModBindings","rPadNorthOrSouth","rPadNorthOrSouthPressed","rPadNorthOrSouthPressedY","cursorModDeltaBindings","scaledRightJoystickVertical","scaledLeftJoystickCursorDelta","scaledRightJoystickHorizontal","deadzonedRightJoystickHorizontal","deadzonedRightJoystickVertical","deadzonedLeftJoystickHorizontal","deadzonedLeftJoystickVertical","disableForwardOnTrigger","scaledLeftJoystickHorizontal","scaledLeftJoystickVertical","scaledLeftJoystickForwardAcceleration","xboxControllerUserBindings","rightCursorHoldingNothing","touchpadFalling","touchpadPressed","brushSizeDelta","dpadSouthDrop","dpadCenterDrop","grabBinding","dropOnCenterOrSouth","daydreamUserBindings","cardboardUserBindings","generate3DOFTriggerBindings","touchpadButton","triggerButton","touchpadXForPen","touchpadYForPen","triggerRising","triggerFalling","dpadBottomCenterStrip","dropBinding","leftTeleporter","rightTeleporter","hc","hcAFRAME","GamepadDevice","buttonPath","gamepadBindings","oculusGoUserBindings","gearVRControllerUserBindings","satisfiesPath","satisfyPath","satisfiedBy","notEmpty","isSubpath","canMask","masker","masked","maskerKey","maskerPath","maskedKey","maskedPath","isActive","toggleSet","pendingSetChanges","generation","generations","prevActiveSets","xformStates","activeDevices","registeredMappings","registeredMappingsChanged","vrGamepadMappings","nonVRGamepadMappings","addExtraMappings","activeDevice","deleteExtraMappings","updateBindingsForVRMode","inVRMode","gamepadConnected","gamepadDevice","isWebXRGamepad","gamepadDisconnected","retrieveXRGamepads","added","removed","inputSource","primaryProfile","profiles","handedness","xrSession","requestReferenceSpace","xrReferenceSpace","maybeToggleXboxMapping","vrAxesSum","mouseMovement","nonXboxActivity","hasXboxMapping","prevSortedBindings","sortedBindings","mappings","unsorted","sorted","dependencySort","masks","masksRow","bindingsRow","col","computeMasks","teleporter","leftHandHovering","leftHandHolding","leftRemoteHovering","leftRemoteHolding","rightHandHovering","rightHandHolding","rightRemoteHovering","rightRemoteHolding","leftHandHoveringOnVideo","rightHandHoveringOnVideo","leftCursorHoldingNothing","resolveActionSets","activeSetsChanged","il","elem","found","jl","arrayContentsDiffer","actives","prevActives","prevMasked","maskedRow","computeExecutionStrategy","bindingExistedLastFrame","oldValue","PATHS_TO_SHOW","replacer","userinputFrameStatus","pathsOutput","textContent","strings","maskers","logBindings","MEDIA_SEARCH_PATHS","ignoredStates","LOCAL_STORAGE_KEY","localStorageCache","tipPlatform","platformTips","desktop","standalone","markTipFinished","tip","storeData","VALIDATORS","look","locomotion","accel","turning","invite","_userinput","anyAframeEntityWith","isUI","identityFn","_performStep","prevTip","chosenTip","finishCount","rightCursorControllerEl","leftCursorControllerEl","grabPath","dropPath","previousState","updateLegacyState","cursorRaycastableQuery","enteredCursorRaycastableQuery","exitedCurserRaycastableQuery","CursorTargettingSystem","dirty","onMutation","onObject3DSet","onObject3DRemove","MutationObserver","childList","populateEntities","records","attributeName","shouldEnableRemote","handHovering","handHeld","remoteHeld","teleporting","woke","vrRemotePenIntersection","CursorTogglingSystem","domContentLoadedButComponentsMayNotHave","gotComponentReferences","rightHandTeleporter","leftHandTeleporter","gazeTeleporter","shouldEnableLeftRemote","shouldEnableRightRemote","MESSAGE_TYPES","CONSTANTS","BUFFER_CONFIG","WORLD_CONFIG","debugDrawMode","AmmoDebugConstants","PhysicsSystem","inverse","debugRequested","disableDebug","objectMatricesFloatArray","bodyUuids","bodyUuidToData","DYNAMIC","BODY_DATA_SIZE","MATRIX_OFFSET","linearVelocity","LINEAR_VELOCITY_OFFSET","ANGULAR_VELOCITY_OFFSET","collisions","COLLISIONS_OFFSET","collidingIndex","objectMatricesIntArray","indexToUuid","ammoWorker","TRANSFER_DATA","Atomics","debugIndex","setDrawRange","AmmoWorker","workerHelpers","WorkerHelpers","nextBodyUuid","nextShapeUuid","Int32Array","INIT","worldConfig","maxBodies","wasmUrl","ammoWasmUrl","READY","BODY_READY","bodyData","isInitialized","removeBodyMessageSent","SHAPES_READY","bodyUuid","shapesUuid","SharedArrayBuffer","debugSharedArrayBuffer","DefaultBufferSize","Uint32Array","debugVertices","debugColors","addAttribute","vertexColors","addBody","updateBody","updateBodyOptions","removeBody","otherId","otherData","addShapes","removeShapes","addConstraint","constraintId","targetUuid","removeConstraint","bodyInitialized","getLinearVelocity","getAngularVelocity","getCollisions","COLLISION_FILTER_MASK_HANDS","distanceBetweenStretchers","obj1","obj2","distanceTo","existsAndHeldInEither","holderA","holderB","TwoPointStretchingSystem","stretching","stretched","leftStretcher","rightStretcher","previousLeftStretcher","previousRightStretcher","initialStretchDistance","HoldableButtonSystem","prevHeld","heldLeft","prevHeldLeft","hasButtonComponent","BUTTON_COMPONENT_NAMES","getHoverableButton","HOVERED","UNHOVERED","HoverButtonSystem","button2","prevButtonLeft","DrawingMenuSystem","scaleMenus","cameraWorldPos","drawingMenus","getMenuScale","handleButtons","remotes","remote","undoDraw","serializeDrawing","showMenu","almostEquals","lastIntersection","finalScale","hideMenus","cursorControllers","getHovered","registerDrawingMenu","networkedDrawingEl","menuEl","undoButton","deleteButton","serializeButton","unregisterDrawingMenu","getSpecificHoverMenu","findHoverMenu","HoverMenuSystem","prevHoverMenu","hoverMenu2","prevHoverMenu2","SuperSpawnerSystem","maybeSpawn","HeldComponent","superSpawner","isPermitted","performSpawn","copyState","determineStrength","HapticFeedbackSystem","twoPointStretchingSystem","interactLeft","interactRight","leftActuator","rightActuator","leftHandStrength","rightHandStrength","rightRemoteStrength","leftRemoteStrength","buttonLeftStrength","buttonRightStrength","stretchingStrength","stretchSystem","stretcherLeft","stretcherRight","leftStrength","rightStrength","pulse","ScenePreviewCameraSystem","InteractionSfxSystem","colorShift","getThemeColorShifter","getImageData","ImageData","SHEET_TYPES","PNGS","spritesheetActionPng","notice","spritesheetNoticePng","ZEROS","getSheetType","spritesheetAction","didRegisterWithSystem","didFailToRegister","registered","spriteSystem","updateUVs","normalizedFrame","spritesheet","ret","raycastOnSprite","vA","vB","vC","vD","intersectionInfo","intersect","intersectTriangle","getHoverableVisuals","comp","hideDueToPinning","createGeometry","maxSprites","positions","indices","Uint16Array","drawRange","createMaterial","spritesheetTexture","RawShaderMaterial","u_spritesheet","SpriteSystem","sheetType","sprites","indicesFromSprites","WeakMap","HUD_ICONS","spritesheetPng","newTexture","oldTexture","uniformsNeedUpdate","aMv","aEnableSweepingEffect","aSweepParams","aEnableSweepingEffectNeedsUpdate","aSweepParamsNeedsUpdate","enableSweepingEffectValue","setXY","updateRange","spritesheetNotice","aUvs","lastSprite","calculateIconTransform","backward","camToWaypoint","m1","waypoint","extractBasis","isOccupiableSpawnPoint","waypointData","canBeOccupied","canBeSpawnPoint","isUnoccupiableSpawnPoint","loadTemplateAndAddToScene","templateId","isOccupiedByMe","waypointComponent","isOccupied","unoccupyWaypoint","unoccupyWaypoints","waypointComponents","WaypointSystem","helperMat4","previousWaypointHash","initialSpawnHappened","waypointForTemplateEl","elementsFromTemplatesFor","eventHandlers","lostOwnershipOfWaypoint","waypointPreviewAvatar","releaseAnyOccupiedWaypoints","currentWaypoint","teleportToWaypoint","iconEl","moveToWaypoint","tryTeleportToOccupiableWaypoint","previouslyOccupiedWaypoints","tryToOccupy","didOccupy","shouldLandWhenPossible","wp","setupEventHandlersFor","canBeClicked","onUnhover","onInteract","setupEventHandlers","waypointId","templateIds","templatesToLoadForWaypointData","elementsFromTemplates","li","unregisterComponent","ri","getUnoccupiableSpawnPoint","mightNeedRespawn","ownershipLostTime","shouldTryToOccupy","occupyWaypoint","tryToOccupyAnyOf","waypoints","candidate","currentMoveToSpawn","nextMoveToSpawn","waitOneTick","nextMoveToSpawnResolve","instant","moveToUnoccupiableSpawnPoint","waypointName","resolvedWaypointOrNull","currentMoveToSpawnResolve","waypointComponentOrNull","tickTemplateEl","elementFromTemplate","willMaintainWorldUp","mat4Pool","getCurrentPlayerHeight","NAV_ZONE","qsAllowWaypointLerp","calculateDisplacementToDesiredPOV","translationCoordinateSpace","translated","localTranslation","povMat4","allowVerticalMovement","localDisplacement","displacementToDesiredPOV","CharacterControllerSystem","deltaFromHeadToTargetForHead","targetForHead","targetForRig","targetWorldPosition","isMotionDisabled","navMeshExists","nav","findPositionOnNavMesh","travelByWaypoint","inPosition","outPosition","initialOrientation","finalPosition","finalPOV","shouldUnoccupyWaypointsOnceMoving","snapRotatedPOV","newPOV","startPOVPosition","desiredPOVPosition","navMeshSnappedPOVPosition","interpolatedWaypoint","startTranslation","waypointPosition","activeWaypoint","waypointComponentData","waypointTravelTime","isInstant","waypointTravelStartTime","animationIsOver","wasFlying","didStopFlying","navNode","dXZ","zCharacterAcceleration","relativeMotion","lerpC","nextRelativeMotion","triedToMove","lengthSq","speedModifier","shouldRecomputeNavGroupAndNavNode","shouldResnapToNavMesh","squareDistNavMeshCorrection","findPOVPositionAboveNavMesh","startingFeetPosition","desiredFeetPosition","outPOVPosition","shouldRecomputeGroupAndNode","navGroup","inTransform","motion","getClosestNode","outPos","getGroup","clampStep","CursorPoseTrackingSystem","pairs","MenuAnimationSystem","menuToCamera","menuScale","menuParentScale","menuPosition","viewingCameraEl","datum","isMenuVisible","isMenuOpening","wasMenuVisible","distanceToMenu","chooseScale","endingScale","menuOpenTime","startScaleAtMenuOpenTime","AudioSettingsSystem","onSceneReset","delayedReconnectTimeout","performDelayedReconnect","enableChromeAEC","isThreeAudio","loopbackDestination","outboundPeerConnection","RTCPeerConnection","inboundPeerConnection","addIceCandidate","iceConnectionState","streams","offer","createOffer","setLocalDescription","setRemoteDescription","answer","createAnswer","parsedSdp","sdpTransform","sdp","fmtp","AudioSystem","_resumeAudioContext","disableAEC","_sceneEl","audioNodes","mediaStreamDestinationNode","outboundGainNode","audioContextNeedsToBeResumed","getInput","_safariMobileAudioInterruptionFix","onPrefsUpdated","outputNode","newGain","sinkId","isDefault","outputMediaAudio","sink","setSinkId","onstatechange","frustumBox","inverseShadowCameraMatrixWorld","tempBox","verts","ShadowSystem","shadowCameraBoundingBox","previousShadowsEnabled","realtimeShadowsEnabled","shadowMap","PCFSoftShadowMap","computeShadowCameraBoundingBox","resizeShadowCameraFrustum","InspectYourselfSystem","EmojiSystem","emojiHudEntity","lastSpawnedEmoji","paramsReducer","addOrRemoveZone","isInZone","wasInZone","isUpdated","currZones","prevZones","predicate","setRay","hasIntersection","intersectTarget","intersectBox","updateSource","Ray","sourcePosition","sourceZones","listenerPosition","listenerZones","inOutParams","outInParams","AudioZonesSystem","didRegisterAudioListener","registerEntity","currListenerZones","sources","isListenerUpdated","unregisterEntity","distanceModels","linear","exponential","calculateAttenuation","listenerPos","GainSystem","attenuation","shouldBeClipped","toneMappingOptions","None","Reinhard","Cineon","ACESFilmic","CustomToneMapping","LUTToneMapping","outputEncodingOptions","LinearEncoding","GBEEncoding","GBM7Encoding","GBDEncoding","BasicDepthPacking","GBADepthPacking","defaultEnvSettings","toneMapping","toneMappingExposure","envMapTexture","backgroundTexture","fogType","fogColor","fogDensity","fogFar","fogNear","blenderLUTPromise","EnvironmentSystem","applyEnvSettings","setupDebugView","debugSettings","gui","GUI","debugGui","debugMode","$E","updateEnvironment","envEl","envSettingsEl","skyboxEl","navmeshEl","envSettings","skybox","getObjectByProperty","materialsNeedUpdate","newToneMapping","LUTCubeLoader","blenderLutPath","texture3D","tonemappingLUT","newOutputEncoding","lp","EquirectangularReflectionMapping","prevEnvMapTextureUUID","environment","Fog","FogExp2","density","forNear","ReflectionProbe","environmentSystem","debugBox","NameTagVisibilitySystem","avatarRigWorldPos","exitOwned","componentsToRemove","kinematicOptions","hoverHand","hoveredQuery","collision","handCollisions","findHandCollisionTargetForHand","leftHandHoveredQuery","rightHandHoveredQuery","GRAB_REMOTE_RIGHT","DROP_REMOTE_RIGHT","GRAB_REMOTE_LEFT","DROP_REMOTE_LEFT","GRAB_HAND_RIGHT","DROP_HAND_RIGHT","GRAB_HAND_LEFT","DROP_HAND_LEFT","queryHovered","hasPermissionToGrab","queryHeld","heldEid","queryHeldRemoteRight","queryHoveredRemoteRight","queryHeldRemoteLeft","queryHoveredRemoteLeft","queryHeldHandRight","queryHoveredHandRight","queryHeldHandLeft","queryHoveredHandLeft","removeHover","queryRemoteRight","queryRemoteLeft","queryHandRight","queryHandLeft","queryDoubleHeldRight","queryDoubleHeldLeft","queryDoubleHoverRight","queryDoubleHoverLeft","cleanupObjOnExit","cleanupSlice9s","cleanupGLTFs","cleanupTexts","cleanupMediaFrames","exitedObject3DQuery","tmpVec","tmpQuat","DISABLE_DEACTIVATION","ACTIVE_TAG","queryEnterRemoteRight","queryExitRemoteRight","queryEnterRemoteLeft","queryExitRemoteLeft","queryEnterHandRight","queryExitHandRight","queryEnterHandLeft","queryExitHandLeft","grabBodyOptions","activationState","releaseBodyOptions","offersConstraint","EMPTY_COLOR","HOVER_COLOR","FULL_COLOR","mediaFramesQuery","mediaTypeMaskFor","mediaTypeMask","isAncestor","ancestor","inOtherFrame","ignoredFrame","getCapturableEntity","frameObj","eidA","eidB","snapToFrame","framePos","frameQuat","frameScale","m4","targetObj","containerSize","setMatrixScale","scaleArray","tmpVec3","heldMediaTypes","capturable","shouldPreviewBeVisible","meshClone","srcMat","cloneObj","cloneForPreview","showPreview","hidePreview","captured","isHoldingObjectOfInterest","heldQuery","supportsCaptureStreamTrack","CanvasCaptureMediaStreamTrack","RenderTargetRecorder","captureWidth","captureHeight","srcAudioTrack","videoRenderTarget","tmpRenderTarget","getRenderTarget","videoCanvas","videoContext","videoImageData","createImageData","videoTrack","oscillator","createOscillator","setValueAtTime","createBlankAudioTrack","mediaRecorder","MediaRecorder","ondataavailable","captureFrame","srcRenderTarget","srcX0","srcY0","srcX1","srcY1","dstX0","dstY0","dstX1","dstY1","gl","srcFramebuffer","__webglFramebuffer","destFramebuffer","bindFramebuffer","READ_FRAMEBUFFER","DRAW_FRAMEBUFFER","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","blitFramebuffer","COLOR_BUFFER_BIT","LINEAR","readRenderTargetPixels","requestFrame","save","onstop","pixels","snapCanvas","imageData","videoCodec","isTypeSupported","videoMimeType","hasWebGL2","allowVideo","RENDER_WIDTH","RENDER_HEIGHT","CAPTURE_WIDTH","CAPTURE_HEIGHT","CAMERA_STATE","CAPTURE_DURATIONS","renderTargets","videoRecorders","captureAudio","clicked","spawnCameraFile","recorder","snapPixels","cameraToolQuery","cameraToolEnterQuery","cameraToolExitQuery","cameraToolSystem","setRendertargetDirty","lastUpdated","selfieScreenObj","allCameras","rightCursor","rotateWithRightClick","grabberPressedSnapAction","elapsed","createRecorder","msRemaining","msRemainingLastFrame","tmpVRFlag","bubbleSystem","boneVisibilitySystem","updateRenderTarget","pixelsToPNG","captureSnapshot","snapMenuObj","snapBtnObj","recBtnObj","cancelBtnObj","nextBtnObj","prevBtnObj","countdownLblObj","captureDurLblObj","sndToggleBtnObj","sndToggleLblObj","isIdle","isCounting","showViewfinder","yRot","timeLeftSec","updateUI","DIST","DOMContentDidLoad","interactionSfxSystem","superSpawnerSystem","positionAtBorderSystem","holdableButtonSystem","hoverMenuSystem","hapticFeedbackSystem","drawingMenuSystem","audioSettingsSystem","animationMixerSystem","uvScrollSystem","shadowSystem","inspectYourselfSystem","emojiSystem","gainSystem","$S","networkedObjects","partingClientId","nidString","deletedNids","ignoredNids","componentId","networkReceiveSystem","onOwnershipLost","angularFactor","ACTIVATION_STATE","emitCollisionEvents","scaleAutoUpdate","disableCollision","physicsCompatSystem","ents","networkedTransformSystem","legacyInteractionSystem","handHoverSystem","holdSystem","dontHoldWithHandAndRemote","dontHoverAndHold","interactionSystem","constraintsSystem","makeStaticAtRest","makeKinematicOnRelease","floatyObjectSystem","mediaTypesOf","mediaFrames","colliding","mediaFramesSystem","destroyAtExtremeDistanceSystem","removeNetworkedObjectButtonSystem","removeFromMap","removeObject3DSystem","networkSendSystem","_gotAudioTrack","_recorderTimeout","_initRecorder","_stream","_recorder","_tryAddingAudioTrack","listener","addLinkageHandler","syncLinkage","elA","elB","_handlingLinkage","waitForMediaLoader","handlerA","handlerB","deregisterLinkage","syncedVideoAttributes","fakePanner","maxDebugSources","unsupported","getParameter","VERSION","getWebGLVersion","maxUniformVectors","MAX_FRAGMENT_UNIFORM_VECTORS","updateState","navMeshObject","colorInner","colorOuter","colorGain","sourceOrientation","clipped","defines","MAX_DEBUG_SOURCES","sourcePositions","sourceOrientations","maxDistances","refDistances","rolloffFactors","coneInnerAngles","coneOuterAngles","gains","sourceDir","sourceNum","enableDebugMode","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","mediaInflator","isControlled","templateName","sanitizeUrl","euler","attachTemplateToLocal","_componentName","mediaLoaderAttributes","pageIndex","enterComponentMapping","leaveComponentMapping","targetEntity","heightfieldDistance","heightfieldData","removeUndefined","mediaDistanceModel","mediaRolloffFactor","mediaRefDistance","mediaMaxDistance","mediaConeInnerAngle","mediaConeOuterAngle","mediaConeOuterGain","mediaVolume","avatarDistanceModel","avatarRolloffFactor","avatarRefDistance","avatarMaxDistance","avatarConeInnerAngle","avatarConeOuterAngle","avatarConeOuterGain","avatarVolume","_components","srcNode","positional","aframeComponentName","bitecsComponent","$B","bitecs","PinningHelper","_signInAndPinOrUnpinElement","_pinElement","storedPromotionToken","gltfComponents","equalArray","every","mediaSrc","mediaVersion","mediaContentSubtype","pinnedEntityToGltf","addScalar","clampScalar","pathsMap","drawFrequency","minDistanceBetweenPoints","drawingManager","availableColors","minRadius","maxRadius","drawMode","penVisible","penTipPosition","timeSinceLastDraw","lastPosition","currentDrawing","worldPosition","colorIndex","grabbed","originalPosition","lastIntersectionDistance","setDirty","penTip","penLaserAttributesUpdated","penLaserAttributes","laserVisible","laserInHand","laserOrigin","remoteLaserOrigin","laserTarget","penSystem","_handleInput","grabberId","_getIntersection","_updatePenTip","_updateLaser","_setPenVisible","_doDraw","_startDraw","_endDraw","penScaleMod","_changeRadius","_changeColor","_undoDraw","worldQuaternion","laserStartPosition","laserEndPosition","camerWorldPosition","lastIntersectedObject","getLastPoint","_getNormal","directionToCamera","startDraw","endDraw","mod","InterpolationBuffer","tipMaterial","lineCurve","LineCurve3","TubeBufferGeometry","laser","laserTip","originBuffer","MODE_LERP","targetBuffer","originBufferPosition","targetBufferPosition","laserTipVisible","SharedBufferGeometry","maxBufferSize","addBuffer","prevIdx","componentSize","undo","normals","colors","addColor","setXYZ","addNormal","addVertex","addIndex","computeBoundingSpheres","SharedBufferGeometryManager","sharedBuffers","addSharedBuffer","getSharedBuffer","copyData","fromIndex","toIndex","segments","defaultRadius","maxDrawTimeout","maxLines","maxPointsPerLine","_receiveData","networkBuffer","sendNetworkBufferQueue","drawStarted","lineStarted","remoteLineStarted","receivedBufferParts","bufferIndex","connectedToOwner","networkBufferInitialized","sharedBufferGeometryManager","lastPoint","lastSegments","currentSegments","sharedBuffer","vertexCount","indexCount","networkBufferCount","currentPointCount","invalidPointRead","lastReadPointCount","networkBufferHistory","getNetworkId","drawingId","unsubscribeToDataChannel","isConnected","hasActiveDataChannel","_broadcastDrawing","_drawFromNetwork","_sendNetworkBuffer","_deleteExpiredLines","cloneMesh","sharedBufferGeometry","originalGeometry","VertexColors","exporter","GLTFExporter","binary","includeCustomExtensions","POSITIVE_INFINITY","NEGATIVE_INFINITY","temp","attribute","getX","getZ","deserializeDrawing","setHex","copyArray","didWork","pointCount","_draw","_updateBuffer","drawTime","chunkAmount","parts","_addToNetworkBuffer","getHexString","capNormal","radiusMultiplier","_generateSegments","_drawCylinder","_drawProjectedEndCap","_endLine","_drawStartCap","_pushToNetworkBuffer","_drawPoint","projectedDirection","projectedPoint","_drawEndCap","elapsedTime","copyDirection","copyNormal","setLength","getHex","_addVertex","bufferVertexCount","_addIndex","down","segment","segmentsList","angleIncrement","_rotatePointAroundAxis","calculatedDirection","_getDeserializeButton","networkedDrawingBuffer","finishDrawing","ACTIVATION_STATES","ISLAND_SLEEPING","WANTS_DEACTIVATION","DISABLE_SIMULATION","STATIC","KINEMATIC","alive","maxHalfExtent","sphereRadius","cylinderAxis","bodyEl","bodyHelper","ga","WrappedIntlProvider","updateLocale","providerLabel","slack","OAuthScreen","provider","redirectUrl","OAuthScreenContainer","oauthInfo","BUILD_VERSION","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","dataTexture","DataTexture","FloatType","Camera","getError","checkFloatTextureSupport","patchWebGLRenderingContext","createWorld","str2sid","sid2str","nextSid","$o","nameToComponent","object3d","owned","setupRenderer","dataset","aframeCanvas","logarithmicDepthBuffer","checkShaderErrors","AudioListener","renderClock","mainTick","_rafTime","xrFrame","timeSystem","renderStarted","HUD_BACKGROUND","OAUTH_FLOW_PERMS_TOKEN_KEY","isEmbed","PHOENIX_RELIABLE_NAF","firstSyncSource","syncSource","isOAuthModal","opener","isTelemetryDisabled","trackedPage","trackedTitle","sentryDsn","gaTrackingId","Raven","install","registerTelemetry","lastTouchAtMs","isDoubleTouch","disableiOSZoom","started_at","onStorageEvent","detectConcurrentLoad","uiProps","routerBaseName","createMemoryHistory","createBrowserHistory","basename","qsVREntryType","showOAuthScreen","mountUI","sceneUrl","isLegacyBundle","model_url","loadingEnvironment","defaultSpaceTopic","topics","glbAsset","assets","asset_type","bundleAsset","hasExtension","baseURL","LoaderUtils","extractUrlBase","sceneErrorHandler","environmentScene","envSystem","loadStart","environmentEl","fader","getBindings","emitter","vr","platformUnsupported","defaultRoomId","getCurrentHubId","scriptTag","getMilliseconds","onFailure","actionError","sceneInfo","handleEarlyVRMode","availableVREntryTypesPromise","getVRDisplay","vectorRequiresUpdate","almostEqualVec3","requiresNetworkUpdate","registerNetworkSchemas","buildNumber","hasVREntryDevice","runBotMode","previewCamera","reorder","setupLobbyCamera","isReloading","vapid_public_key","pushSubscriptionEndpoint","push_subscription_endpoint","createHubChannelParams","migrateToNewReticulumServer","oldSocket","teardown","onRetDeploy","pendingNotification","hasPendingNotification","handleNextMessage","isLocked","currentNotification","deployNotification","oauthFlowPermsToken","hubPhxChannel","rawOnJoin","rawOnLeave","beforeJoin","afterJoin","remaining","denoisePresence","presenceEventsForHub","presenceSync","updateSceneCopresentState","session_token","embedTokenEntry","onMediaSearchCancelled","serverURL","loadEnvironmentAndConnect","onConnectionError","handleHubChannelJoined","oauth_info","incomingMessage","userInfo","getAuthor","createInWorldLogMessage","stale_fields","titleParts","oldSlug","class","deltas","secondsSinceMeasurementStart","secondsSinceSceneVisible","maxPixelRatio","pixelRatioToTimesDecreased","disabledByPref","visibilityState","medianFps","currentPixelRatio","getPixelRatio","shouldDecrease","shouldIncrease","newPixelRatio","timesDecreased","onTimeout","onEnterVR","enteredVR","lastTimeoutCheck","exitTimeout","registry","queues","frameIndex","func","queue","permissionName","showLog","debugLog","debugLogInput","debugLogEval","onsubmit","eval","minimized","debugLogMinimize","onclick","origConsoleInfo","origConsoleLog","origConsoleError","origConsoleWarn","objs","firstObj","stack","shouldScroll","onunhandledrejection","scope","clipBias","mirrorPlane","Plane","mirrorWorldPosition","rotationMatrix","lookAtPosition","clipPlane","Vector4","textureMatrix","parameters","stencilBuffer","isPowerOfTwo","mirrorSampler","reflect","setFromNormalAndCoplanarPoint","constant","currentRenderTarget","currentXrEnabled","currentShadowAutoUpdate","SHORTHAND_INITIALIZER","SPREAD_SYNTAX","CATCH_SYNTAX","syntaxSupported","syntax","getPlatformSupport","supported","WebAssembly","isInAppBrowser","Support","showDetails","hasCopied","toggleDetails","onCopyClicked","platformSupport","allSupported","inAppBrowser","webpackAsyncContext","req","__webpack_require__","ids","__webpack_module_cache__","deferred","leafPrototypes","getProto","inProgress","dataWebpackPrefix","moduleId","cachedModule","__webpack_modules__","amdO","O","chunkIds","notFulfilled","fulfilled","getter","__esModule","getPrototypeOf","ns","def","definition","defineProperty","enumerable","chunkId","promises","miniCssF","globalThis","Function","script","needAttach","scripts","getElementsByTagName","charset","nc","onScriptComplete","doneFns","toStringTag","nmd","installedChunks","installedChunkData","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}