{"version":3,"file":"assets/js/hub-aed9a4d719e6e6b282e9.js","mappings":"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","sources":["webpack://hubs/./src/components/action-to-event.js","webpack://hubs/./src/components/action-to-remove.js","webpack://hubs/./src/components/ambient-light.js","webpack://hubs/./src/components/animation.js","webpack://hubs/./src/components/audio-zone.js","webpack://hubs/./src/components/avatar-inspect-collider.js","webpack://hubs/./src/components/billboard.js","webpack://hubs/./src/components/block-button.js","webpack://hubs/./src/components/bone-mute-state-indicator.js","webpack://hubs/./src/components/close-vr-notice-button.js","webpack://hubs/./src/components/css-class.js","webpack://hubs/./src/components/debug.js","webpack://hubs/./src/components/directional-light.js","webpack://hubs/./src/components/disable-frustum-culling.js","webpack://hubs/./src/components/drop-object-button.js","webpack://hubs/./src/components/duck.js","webpack://hubs/./src/components/emit-scene-event-on-remove.js","webpack://hubs/./src/components/emit-state-change.js","webpack://hubs/./src/components/event-repeater.js","webpack://hubs/./src/components/fader.js","webpack://hubs/./src/components/follow-in-fov.js","webpack://hubs/./src/components/frustrum.js","webpack://hubs/./src/components/heightfield.js","webpack://hubs/./src/components/hemisphere-light.js","webpack://hubs/./src/components/hide-when-pinned-and-forbidden.js","webpack://hubs/./src/components/hide-when-quality.js","webpack://hubs/./src/components/hover-menu.js","webpack://hubs/./src/components/icon-button.js","webpack://hubs/./src/components/inject-main-camera-here.js","webpack://hubs/./src/components/inspect-button.js","webpack://hubs/./src/components/inspect-pivot-child-selector.js","webpack://hubs/./src/components/kick-button.js","webpack://hubs/./src/components/leave-room-button.js","webpack://hubs/./src/components/mute-button.js","webpack://hubs/./src/components/networked-avatar.js","webpack://hubs/./src/components/networked-counter.js","webpack://hubs/./src/components/optional-alternative-to-not-hide.js","webpack://hubs/./src/components/owned-object-cleanup-timeout.js","webpack://hubs/./src/components/owned-object-limiter.js","webpack://hubs/./src/components/periodic-full-syncs.js","webpack://hubs/./src/components/point-light.js","webpack://hubs/./src/components/replay.js","webpack://hubs/./src/components/set-unowned-body-kinematic.js","webpack://hubs/./src/components/set-yxz-order.js","webpack://hubs/./src/components/spot-light.js","webpack://hubs/./src/components/text-button.js","webpack://hubs/./src/components/tools/drawing-manager.js","webpack://hubs/./src/components/track-pose.js","webpack://hubs/./src/components/trigger-volume.js","webpack://hubs/./src/components/video-pause-state.js","webpack://hubs/./src/components/visibility-by-path.js","webpack://hubs/./src/components/visibility-on-content-types.js","webpack://hubs/./src/components/visible-if-permitted.js","webpack://hubs/./src/components/visible-to-owner.js","webpack://hubs/./src/constants.js","webpack://hubs/./src/assets/locales/locale_config.js","webpack://hubs/./src/utils/i18n.js","webpack://hubs/./src/utils/configs.js","webpack://hubs/./src/utils/hub-utils.js","webpack://hubs/./src/utils/get-color-scheme-pref.js","webpack://hubs/./src/react-components/styles/theme.js","webpack://hubs/./src/utils/async-utils.js","webpack://hubs/./src/utils/theme.js","webpack://hubs/./src/utils/detect-touchscreen.js","webpack://hubs/./src/utils/is-mobile.js","webpack://hubs/./src/utils/aframe-overrides.js","webpack://hubs/./src/utils/logging.js","webpack://hubs/./src/utils/webgl.js","webpack://hubs/./src/utils/identity.js","webpack://hubs/./src/utils/media-devices-utils.js","webpack://hubs/./src/storage/store.js","webpack://hubs/./src/utils/phoenix-utils.js","webpack://hubs/./src/transport-for-channel.js","webpack://hubs/./src/bit-components.js","webpack://hubs/./src/utils/permissions-utils.js","webpack://hubs/./src/phoenix-adapter.js","webpack://hubs/./src/utils/next-tick.js","webpack://hubs/./src/utils/animation.js","webpack://hubs/./src/naf-dialog-adapter.js","webpack://hubs/./src/change-hub.js","webpack://hubs/./src/components/animation-mixer.js","webpack://hubs/./src/utils/scene-graph.js","webpack://hubs/./src/utils/easing.js","webpack://hubs/./src/utils/component-utils.js","webpack://hubs/./src/components/audio-feedback.js","webpack://hubs/./src/object-types.js","webpack://hubs/./src/utils/media-highlight-frag.glsl","webpack://hubs/./src/utils/material-utils.js","webpack://hubs/./src/loaders/HubsTextureLoader.js","webpack://hubs/./src/components/hoverable-visuals.js","webpack://hubs/./src/utils/media-url-utils.js","webpack://hubs/./src/utils/media-utils.js","webpack://hubs/./src/components/slice9.js","webpack://hubs/./src/utils/promisify-worker.js","webpack://hubs/./src/components/layers.js","webpack://hubs/./src/utils/three-utils.js","webpack://hubs/./src/components/gltf-model-plus.js","webpack://hubs/./src/workers/sketchfab-zip.worker.js","webpack://hubs/./src/components/loop-animation.js","webpack://hubs/./src/components/uv-scroll.js","webpack://hubs/./src/utils/auto-box-collider.js","webpack://hubs/./src/components/audio-params.js","webpack://hubs/./src/update-audio-settings.js","webpack://hubs/./src/systems/sound-effects-system.js","webpack://hubs/./src/components/media-loader.js","webpack://hubs/./src/components/quack.js","webpack://hubs/./src/systems/userinput/paths.js","webpack://hubs/./src/components/tags.js","webpack://hubs/./src/systems/camera-system.js","webpack://hubs/./src/components/scene-preview-camera.js","webpack://hubs/./src/components/skybox.js","webpack://hubs/./src/components/spawn-controller.js","webpack://hubs/./src/systems/floaty-object-system.js","webpack://hubs/./src/components/floaty-object.js","webpack://hubs/./src/components/super-spawner.js","webpack://hubs/./src/components/water.js","webpack://hubs/./src/components/simple-water.js","webpack://hubs/./src/components/particle-emitter.js","webpack://hubs/./src/components/audio-zone-source.js","webpack://hubs/./src/components/troika-text.js","webpack://hubs/./src/components/mute-mic.js","webpack://hubs/./src/components/bone-visibility.js","webpack://hubs/./src/components/in-world-hud.js","webpack://hubs/./src/components/emoji.js","webpack://hubs/./src/components/emoji-hud.js","webpack://hubs/./src/components/virtual-gamepad-controls.css?e72e","webpack://hubs/./src/components/virtual-gamepad-controls.js","webpack://hubs/./src/components/ik-controller.js","webpack://hubs/./src/components/hand-controls2.js","webpack://hubs/./src/components/hover-visuals.js","webpack://hubs/./src/components/offset-relative-to.js","webpack://hubs/./src/utils/avatar-utils.js","webpack://hubs/./src/components/player-info.js","webpack://hubs/./src/components/name-tag.js","webpack://hubs/./src/components/hand-poses.js","webpack://hubs/./src/components/hud-controller.js","webpack://hubs/./src/components/freeze-controller.js","webpack://hubs/./src/components/visibility-while-frozen.js","webpack://hubs/./src/components/stats-plus.js","webpack://hubs/./src/utils/mirror-utils.js","webpack://hubs/./src/utils/error-texture.js","webpack://hubs/./src/utils/scale-to-aspect-ratio.js","webpack://hubs/./src/utils/detect-safari.js","webpack://hubs/./src/components/media-video.js","webpack://hubs/./src/components/media-pdf.js","webpack://hubs/./src/utils/create-basis-texture.js","webpack://hubs/./src/utils/gif-texture.js","webpack://hubs/./src/workers/gifparsing.worker.js","webpack://hubs/./src/components/media-image.js","webpack://hubs/./src/utils/texture-cache.js","webpack://hubs/./src/utils/avatar-volume-utils.js","webpack://hubs/./src/components/avatar-volume-controls.js","webpack://hubs/./src/components/pinch-to-move.js","webpack://hubs/./src/components/pitch-yaw-rotator.js","webpack://hubs/./src/components/position-at-border.js","webpack://hubs/./src/components/pinnable.js","webpack://hubs/./src/components/pin-networked-object-button.js","webpack://hubs/./src/components/mirror-media-button.js","webpack://hubs/./src/components/close-mirrored-media-button.js","webpack://hubs/./src/utils/bit-utils.js","webpack://hubs/./src/components/camera-focus-button.js","webpack://hubs/./src/components/unmute-video-button.js","webpack://hubs/./src/components/clone-media-button.js","webpack://hubs/./src/utils/fullscreen.js","webpack://hubs/./src/utils/vr-interstitial.js","webpack://hubs/./src/components/open-media-button.js","webpack://hubs/./src/components/refresh-media-button.js","webpack://hubs/./src/components/tweet-media-button.js","webpack://hubs/./src/components/remix-avatar-button.js","webpack://hubs/./src/components/transform-object-button.js","webpack://hubs/./src/components/scale-button.js","webpack://hubs/./src/utils/aframe-utils.js","webpack://hubs/./src/components/teleporter.js","webpack://hubs/./src/components/cylinder-texture.js","webpack://hubs/./src/components/inspect-pivot-offset-from-camera.js","webpack://hubs/./src/components/avatar-audio-source.js","webpack://hubs/./src/components/video-texture-target.js","webpack://hubs/./src/components/mirror.js","webpack://hubs/./src/utils/history.js","webpack://hubs/./src/utils/vr-caps-detect.js","webpack://hubs/./src/utils/share.js","webpack://hubs/./src/assets/stylesheets/ui-root.scss?3c01","webpack://hubs/./src/react-components/styles/style-utils.scss?31b9","webpack://hubs/./src/react-components/wrap-with-audio.js","webpack://hubs/./src/react-components/state-route.js","webpack://hubs/./src/utils/microphone-presence.js","webpack://hubs/./src/react-components/sidebar/Sidebar.js","webpack://hubs/./src/react-components/sidebar/Sidebar.scss?ca5c","webpack://hubs/./src/react-components/input/IconButton.scss?4ade","webpack://hubs/./src/react-components/input/IconButton.js","webpack://hubs/./src/react-components/input/TextInput.scss?5f06","webpack://hubs/./src/react-components/icons/Close.svg","webpack://hubs/./src/react-components/input/CloseButton.js","webpack://hubs/./src/react-components/input/BackButton.scss?ad0b","webpack://hubs/./src/react-components/icons/ChevronBack.svg","webpack://hubs/./src/react-components/input/BackButton.js","webpack://hubs/./src/react-components/input/Button.scss?4353","webpack://hubs/./src/react-components/input/Button.js","webpack://hubs/./src/react-components/input/InputField.js","webpack://hubs/./src/react-components/input/InputField.scss?2992","webpack://hubs/./src/react-components/icons/Warning.svg","webpack://hubs/./src/utils/focus-utils.js","webpack://hubs/./src/react-components/input/TextInput.js","webpack://hubs/./src/react-components/input/useId.js","webpack://hubs/./src/react-components/input/TextInputField.js","webpack://hubs/./src/react-components/layout/Column.scss?fb86","webpack://hubs/./src/react-components/layout/Column.js","webpack://hubs/./src/react-components/room/AvatarSettingsContent.js","webpack://hubs/./src/react-components/room/AvatarSettingsContent.scss?5aa7","webpack://hubs/./src/react-components/room/AvatarSettingsSidebar.js","webpack://hubs/./src/react-components/modal/Modal.js","webpack://hubs/./src/react-components/modal/Modal.scss?a27f","webpack://hubs/./src/react-components/room/AvatarSetupModal.js","webpack://hubs/./src/components/environment-map.js","webpack://hubs/./src/utils/image-bitmap-utils.js","webpack://hubs/./src/assets/stylesheets/avatar-preview.scss?9b2b","webpack://hubs/./src/react-components/avatar-preview.js","webpack://hubs/./src/react-components/profile-entry-panel.js","webpack://hubs/./src/storage/media-search-store.js","webpack://hubs/./src/react-components/room/AvatarUrlModal.js","webpack://hubs/./src/react-components/room/AvatarUrlModalContainer.js","webpack://hubs/./src/react-components/room/SceneUrlModal.js","webpack://hubs/./src/utils/scene-url-utils.js","webpack://hubs/./src/react-components/icons/Attach.svg","webpack://hubs/./src/react-components/room/SceneUrlModalContainer.js","webpack://hubs/./src/react-components/room/ObjectUrlModal.scss?40b1","webpack://hubs/./src/react-components/room/ObjectUrlModal.js","webpack://hubs/./src/react-components/room/ObjectUrlModalContainer.js","webpack://hubs/./src/react-components/room/MediaBrowser.scss?9b0d","webpack://hubs/./src/react-components/icons/Search.svg","webpack://hubs/./src/react-components/icons/Star.svg","webpack://hubs/./src/react-components/icons/ArrowForward.svg","webpack://hubs/./src/react-components/icons/ArrowBack.svg","webpack://hubs/./src/react-components/layout/FullscreenLayout.js","webpack://hubs/./src/react-components/layout/FullscreenLayout.scss?ba56","webpack://hubs/./src/react-components/room/MediaGrid.js","webpack://hubs/./src/react-components/room/MediaGrid.scss?f1d1","webpack://hubs/./src/react-components/room/MediaBrowser.js","webpack://hubs/./src/react-components/icons/Upload.svg","webpack://hubs/./src/react-components/icons/Link.svg","webpack://hubs/./src/react-components/icons/People.svg","webpack://hubs/./src/react-components/icons/Add.svg","webpack://hubs/./src/react-components/icons/Pen.svg","webpack://hubs/./src/react-components/icons/Duplicate.svg","webpack://hubs/./src/react-components/icons/Help.svg","webpack://hubs/./src/react-components/icons/ExternalLink.svg","webpack://hubs/./src/react-components/room/MediaTiles.js","webpack://hubs/./src/react-components/room/MediaTiles.scss?e8ed","webpack://hubs/./src/react-components/auth/LegalMessage.js","webpack://hubs/./src/react-components/auth/SignInModal.js","webpack://hubs/./src/react-components/media-browser.js","webpack://hubs/./src/react-components/entry-start-panel.js","webpack://hubs/./src/react-components/if-feature.js","webpack://hubs/./src/react-components/avatar-editor.js","webpack://hubs/./src/assets/stylesheets/avatar-editor.scss?c33e","webpack://hubs/./src/assets/stylesheets/preferences-screen.scss?2e33","webpack://hubs/./src/utils/media-devices-manager.js","webpack://hubs/./src/react-components/input/Slider.js","webpack://hubs/./src/react-components/input/Slider.scss?cbe7","webpack://hubs/./src/utils/screen-orientation-utils.js","webpack://hubs/./src/react-components/preferences-screen.js","webpack://hubs/./src/react-components/icons/Wand.svg","webpack://hubs/./src/assets/stylesheets/presence-log.scss?c846","webpack://hubs/./src/react-components/icons/Chat.svg","webpack://hubs/./src/react-components/icons/Send.svg","webpack://hubs/./src/react-components/icons/Reaction.svg","webpack://hubs/./src/react-components/input/TextAreaInput.js","webpack://hubs/./src/react-components/input/TextAreaInput.scss?2f75","webpack://hubs/./src/react-components/input/ToolbarButton.scss?5bab","webpack://hubs/./src/react-components/input/ToolbarButton.js","webpack://hubs/./src/react-components/popover/Popover.scss?e8d5","webpack://hubs/./src/react-components/popover/Popover.js","webpack://hubs/./src/react-components/room/EmojiPicker.js","webpack://hubs/./src/react-components/room/ChatSidebar.scss?d405","webpack://hubs/./src/utils/chat-message.js","webpack://hubs/./src/react-components/room/ChatSidebar.js","webpack://hubs/./src/react-components/chat-message.js","webpack://hubs/./src/react-components/photo-message.js","webpack://hubs/./src/react-components/video-message.js","webpack://hubs/./src/react-components/image-message.js","webpack://hubs/./src/react-components/presence-log.js","webpack://hubs/./src/assets/stylesheets/preload-overlay.scss?edb4","webpack://hubs/./src/react-components/preload-overlay.js","webpack://hubs/./src/react-components/debug-panel/DataGraph.js","webpack://hubs/./src/react-components/debug-panel/Prop.js","webpack://hubs/./src/react-components/debug-panel/Prop.scss?173c","webpack://hubs/./src/react-components/debug-panel/DataPanel.js","webpack://hubs/./src/react-components/debug-panel/DataPanel.scss?1d3f","webpack://hubs/./src/react-components/debug-panel/CollapsiblePanel.scss?c3e0","webpack://hubs/./src/react-components/debug-panel/CollapsiblePanel.js","webpack://hubs/./src/react-components/debug-panel/RtcDebugPanel.scss?0ae3","webpack://hubs/./src/react-components/icons/CaretDown.svg","webpack://hubs/./src/react-components/debug-panel/AudioDebugPanel.scss?8752","webpack://hubs/./src/react-components/input/SelectInputField.js","webpack://hubs/./src/react-components/input/SelectInputField.scss?b05e","webpack://hubs/./src/react-components/debug-panel/AudioDebugPanel.js","webpack://hubs/./src/react-components/debug-panel/RtcDebugPanel.js","webpack://hubs/./src/utils/mask-email.js","webpack://hubs/./src/react-components/layout/LoadingScreenLayout.scss?1ca1","webpack://hubs/./src/react-components/icons/HmcLogo.svg","webpack://hubs/./src/react-components/misc/AppLogo.js","webpack://hubs/./src/utils/isHmc.js","webpack://hubs/./src/react-components/layout/LoadingScreenLayout.js","webpack://hubs/./src/react-components/misc/Spinner.svg","webpack://hubs/./src/react-components/misc/Spinner.js","webpack://hubs/./src/react-components/misc/Spinner.scss?f1ac","webpack://hubs/./src/react-components/room/LoadingScreen.js","webpack://hubs/./src/react-components/room/useRandomMessageTransition.js","webpack://hubs/./src/react-components/room/useRoomLoadingState.js","webpack://hubs/./src/react-components/room/LoadingScreenContainer.js","webpack://hubs/./src/react-components/layout/RoomLayout.scss?fc6f","webpack://hubs/./src/react-components/layout/Toolbar.scss?ec28","webpack://hubs/./src/react-components/layout/Toolbar.js","webpack://hubs/./src/react-components/layout/RoomLayout.js","webpack://hubs/./src/react-components/room/RoomLayoutContainer.js","webpack://hubs/./src/react-components/room/useResizeViewport.js","webpack://hubs/./src/react-components/icons/Enter.svg","webpack://hubs/./src/react-components/icons/VR.svg","webpack://hubs/./src/react-components/icons/Show.svg","webpack://hubs/./src/react-components/icons/Settings.svg","webpack://hubs/./src/react-components/room/RoomEntryModal.scss?ed86","webpack://hubs/./src/react-components/room/RoomEntryModal.js","webpack://hubs/./src/react-components/room/EnterOnDeviceModal.js","webpack://hubs/./src/react-components/room/EnterOnDeviceModal.scss?ed19","webpack://hubs/./src/react-components/icons/Microphone.svg","webpack://hubs/./src/react-components/icons/MicrophoneMuted.svg","webpack://hubs/./src/react-components/icons/VolumeOff.svg","webpack://hubs/./src/react-components/icons/Info.svg","webpack://hubs/./src/react-components/room/MicSetupModal.scss?6f27","webpack://hubs/./src/react-components/input/ToggleInput.js","webpack://hubs/./src/react-components/input/ToggleInput.scss?d772","webpack://hubs/./src/react-components/room/MicSetupModal.js","webpack://hubs/./src/react-components/room/useMicrophoneStatus.js","webpack://hubs/./src/react-components/room/useMicrophone.js","webpack://hubs/./src/react-components/room/useSound.js","webpack://hubs/./src/react-components/room/useSpeakers.js","webpack://hubs/./src/react-components/misc/LevelBar.scss?8b24","webpack://hubs/./src/react-components/misc/LevelBar.js","webpack://hubs/./src/react-components/misc/useVolumeMeter.js","webpack://hubs/./src/react-components/misc/VolumeLevelBar.js","webpack://hubs/./src/react-components/room/MicSetupModalContainer.js","webpack://hubs/./src/react-components/room/InvitePopover.scss?5f27","webpack://hubs/./src/react-components/input/CopyableTextInputField.js","webpack://hubs/./src/react-components/input/CopyableTextInputField.scss?6eb1","webpack://hubs/./src/react-components/icons/Invite.svg","webpack://hubs/./src/react-components/room/RoomSettingsSidebar.scss?7f50","webpack://hubs/./src/react-components/room/InviteLinkInputField.js","webpack://hubs/./src/react-components/room/InvitePopover.js","webpack://hubs/./src/react-components/room/useInviteUrl.js","webpack://hubs/./src/react-components/room/InvitePopoverContainer.js","webpack://hubs/./src/react-components/room/MoreMenuPopover.scss?af03","webpack://hubs/./src/react-components/icons/More.svg","webpack://hubs/./src/react-components/room/MoreMenuPopover.js","webpack://hubs/./src/react-components/room/ChatSidebarContainer.js","webpack://hubs/./src/react-components/misc/useMaintainScrollPosition.js","webpack://hubs/./src/react-components/misc/joinChildren.js","webpack://hubs/./src/react-components/room/ContentMenu.scss?0e29","webpack://hubs/./src/react-components/icons/Objects.svg","webpack://hubs/./src/react-components/room/ContentMenu.js","webpack://hubs/./src/react-components/icons/Camera.svg","webpack://hubs/./src/react-components/icons/Avatar.svg","webpack://hubs/./src/react-components/icons/Delete.svg","webpack://hubs/./src/react-components/icons/Favorites.svg","webpack://hubs/./src/react-components/icons/StarOutline.svg","webpack://hubs/./src/react-components/icons/WarningCircle.svg","webpack://hubs/./src/react-components/icons/Home.svg","webpack://hubs/./src/react-components/icons/TextDocument.svg","webpack://hubs/./src/react-components/icons/Support.svg","webpack://hubs/./src/react-components/icons/Shield.svg","webpack://hubs/./src/react-components/icons/Discord.svg","webpack://hubs/./src/react-components/icons/Leave.svg","webpack://hubs/./src/react-components/room/PeopleSidebar.scss?b1d5","webpack://hubs/./src/react-components/icons/Desktop.svg","webpack://hubs/./src/react-components/icons/Phone.svg","webpack://hubs/./src/react-components/icons/VolumeHigh.svg","webpack://hubs/./src/react-components/icons/VolumeMuted.svg","webpack://hubs/./src/react-components/icons/HandRaised.svg","webpack://hubs/./src/react-components/layout/List.js","webpack://hubs/./src/react-components/layout/List.scss?9eba","webpack://hubs/./src/react-components/room/PeopleSidebar.js","webpack://hubs/./src/react-components/room/PromoteClientModal.js","webpack://hubs/./src/react-components/room/UserProfileSidebar.js","webpack://hubs/./src/react-components/room/useAvatarVolume.js","webpack://hubs/./src/react-components/room/UserProfileSidebar.scss?4c9b","webpack://hubs/./src/react-components/room/UserProfileSidebarContainer.js","webpack://hubs/./src/react-components/room/PeopleSidebarContainer.js","webpack://hubs/./src/utils/media-sorting.js","webpack://hubs/./src/react-components/room/useObjectList.js","webpack://hubs/./src/react-components/room/ObjectsSidebar.scss?0799","webpack://hubs/./src/react-components/icons/Object.svg","webpack://hubs/./src/react-components/icons/Image.svg","webpack://hubs/./src/react-components/icons/Video.svg","webpack://hubs/./src/react-components/icons/Audio.svg","webpack://hubs/./src/react-components/room/ObjectsSidebar.js","webpack://hubs/./src/react-components/room/ObjectsSidebarContainer.js","webpack://hubs/./src/react-components/room/ObjectMenu.scss?d379","webpack://hubs/./src/react-components/icons/Lightbulb.svg","webpack://hubs/./src/react-components/icons/LightbulbOutline.svg","webpack://hubs/./src/react-components/room/ObjectMenu.js","webpack://hubs/./src/utils/removeNetworkedObject.js","webpack://hubs/./src/react-components/icons/Pin.svg","webpack://hubs/./src/react-components/room/object-hooks.js","webpack://hubs/./src/react-components/icons/GoTo.svg","webpack://hubs/./src/react-components/icons/Hide.svg","webpack://hubs/./src/react-components/room/ObjectMenuContainer.js","webpack://hubs/./src/react-components/icons/GIF.svg","webpack://hubs/./src/react-components/icons/Scene.svg","webpack://hubs/./src/react-components/popover/ButtonGridPopover.js","webpack://hubs/./src/react-components/popover/ButtonGridPopover.scss?2eb0","webpack://hubs/./src/react-components/room/PlacePopover.js","webpack://hubs/./src/react-components/room/PlacePopoverContainer.js","webpack://hubs/./src/react-components/icons/Share.svg","webpack://hubs/./src/react-components/room/SharePopover.js","webpack://hubs/./src/react-components/room/SharePopoverContainer.js","webpack://hubs/./src/react-components/room/useAvatar.js","webpack://hubs/./src/react-components/room/AudioPopover.scss?dc72","webpack://hubs/./src/react-components/layout/Row.scss?301a","webpack://hubs/./src/react-components/layout/Row.js","webpack://hubs/./src/react-components/layout/Divider.js","webpack://hubs/./src/react-components/layout/Divider.scss?7488","webpack://hubs/./src/react-components/room/AudioPopoverContent.js","webpack://hubs/./src/react-components/room/AudioPopoverContentContainer.js","webpack://hubs/./src/react-components/icons/Arrow.svg","webpack://hubs/./src/react-components/room/AudioPopoverButton.js","webpack://hubs/./src/react-components/input/ToolbarMicButton.js","webpack://hubs/./src/react-components/room/AudioPopoverButtonContainer.js","webpack://hubs/./src/react-components/room/AudioPopoverContainer.js","webpack://hubs/./src/react-components/popover/ImageGridPopover.js","webpack://hubs/./src/react-components/popover/ImageGridPopover.scss?acb7","webpack://hubs/./src/react-components/room/ReactionButton.js","webpack://hubs/./src/react-components/room/ReactionButton.scss?234d","webpack://hubs/./src/react-components/room/ReactionPopover.js","webpack://hubs/./src/react-components/room/ReactionPopover.scss?57d7","webpack://hubs/./src/react-components/room/ReactionPopoverContainer.js","webpack://hubs/./src/react-components/room/SafariMicModal.js","webpack://hubs/./src/react-components/auth/RoomSignInModalContainer.js","webpack://hubs/./src/react-components/room/LeaveRoomModal.js","webpack://hubs/./src/react-components/room/RoomSidebar.scss?487f","webpack://hubs/./src/react-components/room/RoomSidebar.js","webpack://hubs/./src/react-components/input/TextAreaInputField.js","webpack://hubs/./src/react-components/input/RadioInput.js","webpack://hubs/./src/react-components/input/RadioInput.scss?7624","webpack://hubs/./src/react-components/input/RadioInputField.js","webpack://hubs/./src/react-components/input/NumericInput.js","webpack://hubs/./src/react-components/input/NumericInput.scss?b8ab","webpack://hubs/./src/react-components/input/NumericInputField.js","webpack://hubs/./src/react-components/room/RoomSettingsSidebar.js","webpack://hubs/./src/react-components/room/RoomSettingsSidebarContainer.js","webpack://hubs/./src/react-components/room/AutoExitWarningModal.js","webpack://hubs/./src/react-components/room/ExitedRoomScreen.js","webpack://hubs/./src/react-components/room/CloseRoomModal.js","webpack://hubs/./src/react-components/room/WebVRUnsupportedModal.js","webpack://hubs/./src/react-components/room/TweetEditorModal.scss?03f9","webpack://hubs/./src/react-components/room/TweetEditorModal.js","webpack://hubs/./src/react-components/room/TweetEditorModalContainer.js","webpack://hubs/./src/react-components/room/TwitterOAuthModal.js","webpack://hubs/./src/react-components/room/TwitterOAuthModalContainer.js","webpack://hubs/./src/react-components/room/TweetModalContainer.js","webpack://hubs/./src/react-components/room/Tip.js","webpack://hubs/./src/react-components/room/Tip.scss?c46d","webpack://hubs/./src/react-components/room/TipContainer.js","webpack://hubs/./src/react-components/room/SpectatingLabel.js","webpack://hubs/./src/react-components/room/SpectatingLabel.scss?749e","webpack://hubs/./src/react-components/ui-root.js","webpack://hubs/./src/react-components/input/useAccessibleOutlineStyle.js","webpack://hubs/./src/react-components/room/ExitedRoomScreenContainer.js","webpack://hubs/./src/utils/auth-channel.js","webpack://hubs/./src/utils/hub-channel.js","webpack://hubs/./src/utils/crypto.js","webpack://hubs/./src/utils/link-channel.js","webpack://hubs/./src/utils/disable-ios-zoom.js","webpack://hubs/./src/utils/physics-utils.js","webpack://hubs/./src/systems/single-action-button-system.js","webpack://hubs/./src/systems/bit-physics.js","webpack://hubs/./src/inflators/media-frame.js","webpack://hubs/./src/inflators/text.js","webpack://hubs/./src/utils/jsx-entity.js","webpack://hubs/./src/inflators/slice9.js","webpack://hubs/./src/update-slice9-geometry.js","webpack://hubs/./src/inflators/model.js","webpack://hubs/./src/network-prefabs/camera-tool.js","webpack://hubs/./src/systems/netcode.js","webpack://hubs/./src/message-dispatch.js","webpack://hubs/./src/scene-entry-manager.js","webpack://hubs/./src/subscriptions.js","webpack://hubs/./src/systems/nav.js","webpack://hubs/./src/utils/traverseFilteredSubtrees.js","webpack://hubs/./src/systems/personal-space-bubble.js","webpack://hubs/./src/systems/idle-detector.js","webpack://hubs/./src/systems/pen-tools.js","webpack://hubs/./src/systems/userinput/sets.js","webpack://hubs/./src/systems/userinput/devices/mouse.js","webpack://hubs/./src/systems/userinput/array-backed-set.js","webpack://hubs/./src/systems/userinput/devices/keyboard.js","webpack://hubs/./src/systems/userinput/devices/hud.js","webpack://hubs/./src/systems/userinput/devices/xbox-controller.js","webpack://hubs/./src/systems/userinput/pose.js","webpack://hubs/./src/systems/userinput/arm-model.js","webpack://hubs/./src/systems/userinput/devices/copy-sitting-to-standing-transform.js","webpack://hubs/./src/systems/userinput/devices/oculus-go-controller.js","webpack://hubs/./src/systems/userinput/devices/gear-vr-controller.js","webpack://hubs/./src/systems/userinput/devices/oculus-touch-controller.js","webpack://hubs/./src/systems/userinput/devices/daydream-controller.js","webpack://hubs/./src/systems/userinput/devices/vive-controller.js","webpack://hubs/./src/systems/userinput/devices/windows-mixed-reality-controller.js","webpack://hubs/./src/systems/userinput/devices/webxr-controller.js","webpack://hubs/./src/systems/userinput/devices/gyro.js","webpack://hubs/./src/systems/userinput/devices/app-aware-mouse.js","webpack://hubs/./src/systems/userinput/devices/touchscreen/assignments.js","webpack://hubs/./src/components/cursor-controller.js","webpack://hubs/./src/systems/userinput/devices/app-aware-touchscreen.js","webpack://hubs/./src/utils/dpad.js","webpack://hubs/./src/systems/userinput/bindings/xforms.js","webpack://hubs/./src/systems/userinput/bindings/utils.js","webpack://hubs/./src/systems/userinput/bindings/keyboard-mouse-user.js","webpack://hubs/./src/systems/userinput/bindings/touchscreen-user.js","webpack://hubs/./src/systems/userinput/bindings/keyboard-debugging.js","webpack://hubs/./src/systems/userinput/bindings/oculus-touch-user.js","webpack://hubs/./src/systems/userinput/bindings/webxr-user.js","webpack://hubs/./src/systems/userinput/bindings/vive-user.js","webpack://hubs/./src/systems/userinput/bindings/windows-mixed-reality-user.js","webpack://hubs/./src/systems/userinput/bindings/xbox-controller-user.js","webpack://hubs/./src/systems/userinput/bindings/daydream-user.js","webpack://hubs/./src/systems/userinput/bindings/cardboard-user.js","webpack://hubs/./src/systems/userinput/bindings/oculus-go-user.js","webpack://hubs/./src/systems/userinput/resolve-action-sets.js","webpack://hubs/./src/systems/userinput/devices/gamepad.js","webpack://hubs/./src/systems/userinput/bindings/generic-gamepad.js","webpack://hubs/./src/systems/userinput/userinput.js","webpack://hubs/./src/systems/userinput/userinput-debug.js","webpack://hubs/./src/systems/ui-hotkeys.js","webpack://hubs/./src/systems/tips.js","webpack://hubs/./src/systems/interactions.js","webpack://hubs/./src/systems/cursor-targetting-system.js","webpack://hubs/./src/systems/cursor-toggling-system.js","webpack://hubs/./src/systems/physics-system.js","webpack://hubs/./src/systems/two-point-stretching-system.js","webpack://hubs/./src/systems/button-systems.js","webpack://hubs/./src/systems/drawing-menu-system.js","webpack://hubs/./src/systems/hover-menu-system.js","webpack://hubs/./src/systems/super-spawner-system.js","webpack://hubs/./src/systems/haptic-feedback-system.js","webpack://hubs/./src/systems/scene-preview-camera-system.js","webpack://hubs/./src/systems/interaction-sfx-system.js","webpack://hubs/./src/utils/theme-sprites.js","webpack://hubs/./src/workers/color-shift.worker.js","webpack://hubs/./src/systems/sprites.js","webpack://hubs/./src/systems/sprites/sprite.vert","webpack://hubs/./src/systems/sprites/sprite.frag","webpack://hubs/./src/systems/waypoint-system.js","webpack://hubs/./src/utils/mat4-pool.js","webpack://hubs/./src/utils/get-current-player-height.js","webpack://hubs/./src/systems/character-controller-system.js","webpack://hubs/./src/systems/cursor-pose-tracking.js","webpack://hubs/./src/systems/menu-animation-system.js","webpack://hubs/./src/systems/audio-settings-system.js","webpack://hubs/./src/systems/audio-system.js","webpack://hubs/./src/systems/shadow-system.js","webpack://hubs/./src/systems/inspect-yourself-system.js","webpack://hubs/./src/systems/emoji-system.js","webpack://hubs/./src/systems/audio-zones-system.js","webpack://hubs/./src/systems/audio-gain-system.js","webpack://hubs/./src/systems/environment-system.js","webpack://hubs/./src/systems/name-tag-visibility-system.js","webpack://hubs/./src/systems/on-ownership-lost.js","webpack://hubs/./src/systems/bit-hand-hover-system.js","webpack://hubs/./src/systems/hold-system.js","webpack://hubs/./src/systems/not-hovered-if-held.js","webpack://hubs/./src/systems/remove-networked-object-button-system.js","webpack://hubs/./src/systems/remove-object3D-system.js","webpack://hubs/./src/systems/networked-transform.js","webpack://hubs/./src/systems/bit-constraints-system.js","webpack://hubs/./src/systems/bit-media-frames.js","webpack://hubs/./src/utils/render-target-recorder.js","webpack://hubs/./src/bit-systems/camera-tool.js","webpack://hubs/./src/systems/bit-destroy-at-extreme-distances.js","webpack://hubs/./src/systems/hubs-systems.js","webpack://hubs/./src/systems/bit-interaction-system.js","webpack://hubs/./src/systems/capture-system.js","webpack://hubs/./src/systems/linked-media.js","webpack://hubs/./src/systems/audio-debug.vert","webpack://hubs/./src/systems/audio-debug-system.js","webpack://hubs/./src/systems/audio-debug.frag","webpack://hubs/./src/utils/component-mappings.js","webpack://hubs/./src/gltf-component-mappings.js","webpack://hubs/./src/aframe-to-bit-components.js","webpack://hubs/./src/App.js","webpack://hubs/./src/utils/pinning-helper.js","webpack://hubs/./src/utils/pinned-entity-to-gltf.js","webpack://hubs/./src/components/scalable-when-grabbed.js","webpack://hubs/./src/components/tools/pen.js","webpack://hubs/./src/components/tools/pen-laser.js","webpack://hubs/./src/utils/sharedbuffergeometry.js","webpack://hubs/./src/utils/sharedbuffergeometrymanager.js","webpack://hubs/./src/components/tools/networked-drawing.js","webpack://hubs/./src/components/body-helper.js","webpack://hubs/./src/components/shape-helper.js","webpack://hubs/./src/telemetry.js","webpack://hubs/./src/react-components/wrapped-intl-provider.js","webpack://hubs/./src/react-components/auth/OAuthScreen.js","webpack://hubs/./src/react-components/auth/OAuthScreen.scss?640c","webpack://hubs/./src/react-components/auth/OAuthScreenContainer.js","webpack://hubs/./src/hub.js","webpack://hubs/./src/utils/concurrent-load-detector.js","webpack://hubs/./src/emitter.js","webpack://hubs/./src/network-schemas.js","webpack://hubs/./src/systems/app-mode.js","webpack://hubs/./src/systems/auto-pixel-ratio.js","webpack://hubs/./src/systems/exit-on-blur.js","webpack://hubs/./src/systems/frame-scheduler.js","webpack://hubs/./src/systems/listed-media.js","webpack://hubs/./src/systems/permissions.js","webpack://hubs/./src/utils/debug-log.js","webpack://hubs/./src/utils/qs_truthy.js","webpack://hubs/./src/vendor/Water.js","webpack://hubs/./src/support.js","webpack://hubs/./src/assets/stylesheets/support.scss?8cf9","webpack://hubs/./src/assets/locales/ lazy ^\\.\\/.*\\.json$ namespace object","webpack://hubs/webpack/bootstrap","webpack://hubs/webpack/runtime/chunk loaded","webpack://hubs/webpack/runtime/create fake namespace object","webpack://hubs/webpack/runtime/load script","webpack://hubs/webpack/runtime/amd options","webpack://hubs/webpack/runtime/compat get default export","webpack://hubs/webpack/runtime/define property getters","webpack://hubs/webpack/runtime/ensure chunk","webpack://hubs/webpack/runtime/get javascript chunk filename","webpack://hubs/webpack/runtime/get mini-css chunk filename","webpack://hubs/webpack/runtime/global","webpack://hubs/webpack/runtime/hasOwnProperty shorthand","webpack://hubs/webpack/runtime/make namespace object","webpack://hubs/webpack/runtime/node module decorator","webpack://hubs/webpack/runtime/runtimeId","webpack://hubs/webpack/runtime/publicPath","webpack://hubs/webpack/runtime/jsonp chunk loading","webpack://hubs/webpack/startup"],"sourcesContent":["AFRAME.registerComponent(\"action-to-event\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    event: { type: \"string\" },\n    withPermission: { type: \"string\" }\n  },\n\n  init() {\n    this.needsPermission = !!this.data.withPermission;\n    this.updatePermissions = () => {\n      if (!this.needsPermission || !window.APP.hubChannel) return;\n      this.hasPermission = window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    };\n  },\n\n  play() {\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updatePermissions);\n    this.updatePermissions();\n  },\n\n  pause() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updatePermissions);\n  },\n\n  tick() {\n    if (this.needsPermission && !this.hasPermission) return;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (userinput.get(this.data.path)) {\n      this.el.emit(this.data.event);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-remove\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    requireOwnership: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (!userinput.get(this.data.path)) return;\n    if (this.data.requireOwnership && this.networkedEl && !NAF.utils.isMine(this.networkedEl)) return;\n\n    this.el.parentNode.removeChild(this.el);\n  }\n});\n","AFRAME.registerComponent(\"ambient-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    this.light = new THREE.AmbientLight();\n    this.el.setObject3D(\"ambient-light\", this.light);\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n      this.light.color.convertSRGBToLinear();\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"ambient-light\");\n  }\n});\n","/* eslint-disable */\n\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\n// scenario where the transform changes on an object during an animation.\n//\n// Changes are identified w comment // hubs\n//\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\n// it erroneously restarts.\n\nvar anime = require(\"animejs\").default;\nvar components = AFRAME.components; // hubs\nvar registerComponent = AFRAME.registerComponent; // hubs\n//var THREE = require('../lib/three'); // hubs\nvar utils = AFRAME.utils; // hubs\n\ndelete AFRAME.components.animation; // hubs\n\nvar colorHelperFrom = new THREE.Color();\nvar colorHelperTo = new THREE.Color();\n\n/**\n * Split a delimited component property string (e.g., `material.color`) to an object\n * containing `component` name and `property` name. If there is no delimiter, just return the\n * string back.\n *\n * Cache arrays from splitting strings via delimiter to save on memory.\n *\n * @param {string} str - e.g., `material.opacity`.\n * @param {string} delimiter - e.g., `.`.\n * @returns {array} e.g., `['material', 'opacity']`.\n */\nvar propertyPathCache = {};\nfunction getComponentPropertyPath(str, delimiter) {\n  delimiter = delimiter || \".\";\n  if (!propertyPathCache[delimiter]) {\n    propertyPathCache[delimiter] = {};\n  }\n  if (str.indexOf(delimiter) !== -1) {\n    propertyPathCache[delimiter][str] = str.split(delimiter);\n  } else {\n    propertyPathCache[delimiter][str] = str;\n  }\n  return propertyPathCache[delimiter][str];\n}\n\n/**\n * Get component property using encoded component name + component property name with a\n * delimiter.\n */\nconst getComponentProperty = function(el, name, delimiter) {\n  var splitName;\n  delimiter = delimiter || \".\";\n  if (name.indexOf(delimiter) !== -1) {\n    splitName = getComponentPropertyPath(name, delimiter);\n    if (splitName.constructor === String) {\n      return el.getAttribute(splitName);\n    }\n    return el.getAttribute(splitName[0])[splitName[1]];\n  }\n  return el.getAttribute(name);\n};\n\n/**\n * Set component property using encoded component name + component property name with a\n * delimiter.\n */\nconst setComponentProperty = function(el, name, value, delimiter) {\n  var splitName;\n  delimiter = delimiter || \".\";\n  if (name.indexOf(delimiter) !== -1) {\n    splitName = getComponentPropertyPath(name, delimiter);\n    if (splitName.constructor === String) {\n      el.setAttribute(splitName, value);\n    } else {\n      el.setAttribute(splitName[0], splitName[1], value);\n    }\n    return;\n  }\n  el.setAttribute(name, value);\n};\n\nvar splitCache = {};\n\nvar TYPE_COLOR = \"color\";\nvar PROP_POSITION = \"position\";\nvar PROP_ROTATION = \"rotation\";\nvar PROP_SCALE = \"scale\";\nvar STRING_COMPONENTS = \"components\";\nvar STRING_OBJECT3D = \"object3D\";\n\n/**\n * Animation component for A-Frame using anime.js.\n *\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\n * boolean * flag * `isAnimationPlaying`.\n *\n * anime.js animation config for tweenining Javascript objects and values works as:\n *\n *  config = {\n *    targets: {foo: 0.0, bar: '#000'},\n *    foo: 1.0,\n *    bar: '#FFF'\n *  }\n *\n * The above will tween each property in `targets`. The `to` values are set in the root of\n * the config.\n *\n * @member {object} animation - anime.js instance.\n * @member {boolean} animationIsPlaying - Control if animation is playing.\n */\nmodule.exports.Component = registerComponent(\"animation\", {\n  schema: {\n    autoplay: { default: true },\n    delay: { default: 0 },\n    dir: { default: \"\" },\n    dur: { default: 1000 },\n    easing: { default: \"easeInQuad\" },\n    elasticity: { default: 400 },\n    enabled: { default: true },\n    from: { default: \"\" },\n    loop: {\n      default: 0,\n      parse: function(value) {\n        // Boolean or integer.\n        if (value === true || value === \"true\") {\n          return true;\n        }\n        if (value === false || value === \"false\") {\n          return false;\n        }\n        return parseInt(value, 10);\n      }\n    },\n    property: { default: \"\" },\n    startEvents: { type: \"array\" },\n    pauseEvents: { type: \"array\" },\n    resumeEvents: { type: \"array\" },\n    round: { default: false },\n    to: { default: \"\" },\n    type: { default: \"\" },\n    isRawProperty: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    var self = this;\n\n    this.eventDetail = { name: this.attrName };\n    this.time = 0;\n\n    this.animation = null;\n    this.animationIsPlaying = false;\n    this.onStartEvent = this.onStartEvent.bind(this);\n    this.beginAnimation = this.beginAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.resumeAnimation = this.resumeAnimation.bind(this);\n\n    this.fromColor = {};\n    this.toColor = {};\n    this.targets = {};\n    this.targetsArray = [];\n\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\n\n    this.config = {\n      complete: function() {\n        self.animationIsPlaying = false;\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\n        if (self.id) {\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\n        }\n      }\n    };\n  },\n\n  update: function(oldData) {\n    var config = this.config;\n    var data = this.data;\n\n    this.animationIsPlaying = false;\n\n    if (!this.data.enabled) {\n      return;\n    }\n\n    if (!data.property) {\n      return;\n    }\n\n    // Base config.\n    config.autoplay = false;\n    config.direction = data.dir;\n    config.duration = data.dur;\n    config.easing = data.easing;\n    config.elasticity = data.elasticity;\n    config.loop = data.loop;\n    config.round = data.round;\n\n    // Start new animation.\n    this.createAndStartAnimation();\n  },\n\n  tick: function(t, dt) {\n    if (!this.animationIsPlaying) {\n      return;\n    }\n    this.time += dt;\n    this.animation.tick(this.time);\n  },\n\n  remove: function() {\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  pause: function() {\n    this.paused = true;\n    this.pausedWasPlaying = this.animationIsPlaying;\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  /**\n   * `play` handler only for resuming scene.\n   */\n  play: function() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    this.addEventListeners();\n    if (this.pausedWasPlaying) {\n      this.resumeAnimation();\n      this.pausedWasPlaying = false;\n    }\n  },\n\n  /**\n   * Start animation from scratch.\n   */\n  createAndStartAnimation: function() {\n    var data = this.data;\n\n    this.updateConfig();\n    this.animationIsPlaying = false;\n    this.animation = anime(this.config);\n\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n    this.addEventListeners();\n\n    // Wait for start events for animation.\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\n      return;\n    }\n\n    // Delay animation.\n    if (data.delay) {\n      // hubs\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\n      return;\n    }\n\n    // Play animation.\n    this.beginAnimation();\n  },\n\n  /**\n   * This is before animation start (including from startEvents).\n   * Set to initial state (config.from, time = 0, seekTime = 0).\n   */\n  beginAnimation: function() {\n    this.updateConfig();\n    this.time = 0;\n    this.animationIsPlaying = true;\n    this.stopRelatedAnimations();\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\n  },\n\n  pauseAnimation: function() {\n    this.animationIsPlaying = false;\n  },\n\n  resumeAnimation: function() {\n    this.animationIsPlaying = true;\n  },\n\n  /**\n   * startEvents callback.\n   */\n  onStartEvent: function() {\n    if (!this.data.enabled) {\n      return;\n    }\n\n    this.updateConfig();\n    if (this.animation) {\n      this.animation.pause();\n    }\n    this.animation = anime(this.config);\n\n    // Include the delay before each start event.\n    if (this.data.delay) {\n      setTimeout(this.beginAnimation, this.data.delay);\n      return;\n    }\n    this.beginAnimation();\n  },\n\n  /**\n   * rawProperty: true and type: color;\n   */\n  updateConfigForRawColor: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var key;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\n      return;\n    }\n\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\n    to = data.to;\n\n    // Use r/g/b vector for color type.\n    this.setColorConfig(from, to);\n    from = this.fromColor;\n    to = this.toColor;\n\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target;\n        // For animation timeline.\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\n          return;\n        }\n\n        setRawProperty(el, data.property, value, data.type);\n      };\n    })();\n  },\n\n  /**\n   * Stuff property into generic `property` key.\n   */\n  updateConfigForDefault: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var isBoolean;\n    var isNumber;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\n      return;\n    }\n\n    if (data.from === \"\") {\n      // Infer from.\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\n    } else {\n      // Explicit from.\n      from = data.from;\n    }\n\n    to = data.to;\n\n    isNumber = !isNaN(from || to);\n    if (isNumber) {\n      from = parseFloat(from);\n      to = parseFloat(to);\n    } else {\n      from = from ? from.toString() : from;\n      to = to ? to.toString() : to;\n    }\n\n    // Convert booleans to integer to allow boolean flipping.\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\n    if (isBoolean) {\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\n    }\n\n    this.targets.aframeProperty = from;\n    config.targets = this.targets;\n    config.aframeProperty = to;\n    config.update = (function() {\n      var lastValue;\n\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target.aframeProperty;\n\n        // Need to do a last value check for animation timeline since all the tweening\n        // begins simultaenously even if the value has not changed. Also better for perf\n        // anyways.\n        if (value === lastValue) {\n          return;\n        }\n        lastValue = value;\n\n        if (isBoolean) {\n          value = value >= 1;\n        }\n\n        if (isRawProperty(data)) {\n          setRawProperty(el, data.property, value, data.type);\n        } else {\n          setComponentProperty(el, data.property, value);\n        }\n      };\n    })();\n  },\n\n  /**\n   * Extend x/y/z/w onto the config.\n   * Update vector by modifying object3D.\n   */\n  updateConfigForVector: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var key;\n    var from;\n    var to;\n\n    // Parse coordinates.\n    from =\n      data.from !== \"\"\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\n    to = utils.coordinates.parse(data.to);\n\n    if (data.property === PROP_ROTATION) {\n      toRadians(from);\n      toRadians(to);\n    }\n\n    // Set to and from.\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    // If animating object3D transformation, run more optimized updater.\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\n      config.update = (function() {\n        var lastValue = {};\n        return function(anim) {\n          var value = anim.animatables[0].target;\n\n          if (data.property === PROP_SCALE) {\n            value.x = Math.max(0.0001, value.x);\n            value.y = Math.max(0.0001, value.y);\n            value.z = Math.max(0.0001, value.z);\n          }\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          el.object3D[data.property].set(value.x, value.y, value.z);\n          el.object3D.matrixNeedsUpdate = true; // hubs\n        };\n      })();\n      return;\n    }\n\n    // Animating some vector.\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value = anim.animations[0].target;\n\n        // Animate rotation through radians.\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n        setComponentProperty(el, data.property, value);\n      };\n    })();\n  },\n\n  /**\n   * Update the config before each run.\n   */\n  updateConfig: function() {\n    var propType;\n\n    // Route config type.\n    propType = getPropertyType(this.el, this.data.property);\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\n      this.updateConfigForRawColor();\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\n      this.updateConfigForVector();\n    } else {\n      this.updateConfigForDefault();\n    }\n  },\n\n  /**\n   * Wait for component to initialize.\n   */\n  waitComponentInitRawProperty: function(cb) {\n    var componentName;\n    var data = this.data;\n    var el = this.el;\n    var self = this;\n\n    if (data.from !== \"\") {\n      return false;\n    }\n\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\n      return false;\n    }\n\n    componentName = splitDot(data.property)[1];\n    if (el.components[componentName]) {\n      return false;\n    }\n\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\n      if (evt.detail.name !== componentName) {\n        return;\n      }\n      cb();\n      // Since the config was created async, create the animation now since we missed it\n      // earlier.\n      self.animation = anime(self.config);\n      el.removeEventListener(\"componentinitialized\", wait);\n    });\n    return true;\n  },\n\n  /**\n   * Make sure two animations on the same property don't fight each other.\n   * e.g., animation__mouseenter=\"property: material.opacity\"\n   *       animation__mouseleave=\"property: material.opacity\"\n   */\n  stopRelatedAnimations: function() {\n    var component;\n    var componentName;\n    for (componentName in this.el.components) {\n      component = this.el.components[componentName];\n      if (componentName === this.attrName) {\n        continue;\n      }\n      if (component.name !== \"animation\") {\n        continue;\n      }\n      if (!component.animationIsPlaying) {\n        continue;\n      }\n      if (component.data.property !== this.data.property) {\n        continue;\n      }\n      component.animationIsPlaying = false;\n    }\n  },\n\n  addEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    addEventListeners(el, data.startEvents, this.onStartEvent);\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  removeEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  // hubs\n  cancelDelayedStart: function() {\n    if (this.delayTimeout) {\n      clearTimeout(this.delayTimeout);\n      this.delayTimeout = null;\n    }\n  },\n\n  setColorConfig: function(from, to) {\n    colorHelperFrom.set(from);\n    colorHelperTo.set(to);\n    from = this.fromColor;\n    to = this.toColor;\n    from.r = colorHelperFrom.r;\n    from.g = colorHelperFrom.g;\n    from.b = colorHelperFrom.b;\n    to.r = colorHelperTo.r;\n    to.g = colorHelperTo.g;\n    to.b = colorHelperTo.b;\n  }\n});\n\n/**\n * Given property name, check schema to see what type we are animating.\n * We just care whether the property is a vector.\n */\nfunction getPropertyType(el, property) {\n  var component;\n  var componentName;\n  var split;\n  var propertyName;\n\n  split = property.split(\".\");\n  componentName = split[0];\n  propertyName = split[1];\n  component = el.components[componentName] || components[componentName];\n\n  // Primitives.\n  if (!component) {\n    return null;\n  }\n\n  // Dynamic schema. We only care about vectors anyways.\n  if (propertyName && !component.schema[propertyName]) {\n    return null;\n  }\n\n  // Multi-prop.\n  if (propertyName) {\n    return component.schema[propertyName].type;\n  }\n\n  // Single-prop.\n  return component.schema.type;\n}\n\n/**\n * Convert object to radians.\n */\nfunction toRadians(obj) {\n  obj.x = THREE.MathUtils.degToRad(obj.x);\n  obj.y = THREE.MathUtils.degToRad(obj.y);\n  obj.z = THREE.MathUtils.degToRad(obj.z);\n}\n\nfunction addEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.addEventListener(eventNames[i], handler);\n  }\n}\n\nfunction removeEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.removeEventListener(eventNames[i], handler);\n  }\n}\n\nfunction getRawProperty(el, path) {\n  var i;\n  var split;\n  var value;\n  split = splitDot(path);\n  value = el;\n  for (i = 0; i < split.length; i++) {\n    value = value[split[i]];\n  }\n  return value;\n}\n\nfunction setRawProperty(el, path, value, type) {\n  var i;\n  var split;\n  var propertyName;\n  var targetValue;\n\n  if (path.startsWith(\"object3D.rotation\")) {\n    value = THREE.MathUtils.degToRad(value);\n  }\n\n  // Walk.\n  split = splitDot(path);\n  targetValue = el;\n  for (i = 0; i < split.length - 1; i++) {\n    targetValue = targetValue[split[i]];\n  }\n  propertyName = split[split.length - 1];\n\n  // Raw color.\n  if (type === TYPE_COLOR) {\n    if (\"r\" in targetValue[propertyName]) {\n      targetValue[propertyName].r = value.r;\n      targetValue[propertyName].g = value.g;\n      targetValue[propertyName].b = value.b;\n    } else {\n      targetValue[propertyName].x = value.r;\n      targetValue[propertyName].y = value.g;\n      targetValue[propertyName].z = value.b;\n    }\n    return;\n  }\n\n  targetValue[propertyName] = value;\n}\n\nfunction splitDot(path) {\n  if (path in splitCache) {\n    return splitCache[path];\n  }\n  splitCache[path] = path.split(\".\");\n  return splitCache[path];\n}\n\nfunction isRawProperty(data) {\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\n}\n","const DEBUG_BBAA_COLOR = 0x49ef4;\n\nconst debugMaterial = new THREE.MeshBasicMaterial({\n  color: DEBUG_BBAA_COLOR,\n  transparent: true,\n  opacity: 0.25,\n  side: THREE.DoubleSide\n});\n\nAFRAME.registerComponent(\"audio-zone\", {\n  schema: {\n    enabled: { default: true },\n    inOut: { default: true },\n    outIn: { default: true },\n    debuggable: { default: true }\n  },\n\n  init() {\n    const debugGeometry = new THREE.BoxGeometry();\n    this.debugMesh = new THREE.Mesh(debugGeometry, debugMaterial);\n    this.debugMesh.el = this.el.object3D.el;\n    const debugBBAA = new THREE.BoxHelper(this.debugMesh, DEBUG_BBAA_COLOR);\n    this.el.object3D.add(debugBBAA);\n    this.el.object3D.updateMatrixWorld(true);\n\n    // In some cases (ie. the scene page) these systems might not exist\n    // so we need to check if the do before registering.\n    this.el.sceneEl.systems[\"audio-debug\"]?.registerZone(this);\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.registerZone(this);\n\n    this.enableDebug(window.APP.store.state.preferences.showAudioDebugPanel);\n  },\n\n  remove() {\n    // In some cases (ie. the scene page) these systems might not exist\n    // so we need to check if the do before unregistering.\n    this.el.sceneEl.systems[\"audio-debug\"]?.unregisterZone(this);\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.unregisterZone(this);\n  },\n\n  update() {\n    this.enableDebug(this.data.debuggable && window.APP.store.state.preferences.showAudioDebugPanel);\n  },\n\n  isEnabled() {\n    return this.data.enabled;\n  },\n\n  getBoundingBox: (function() {\n    const bbaa = new THREE.Box3();\n    return function() {\n      return bbaa.copy(this.debugMesh.geometry.boundingBox).applyMatrix4(this.el.object3D.matrixWorld);\n    };\n  })(),\n\n  enableDebug(debuggable) {\n    this.data.debuggable = debuggable;\n    this.el.object3D.visible = debuggable;\n  },\n\n  getAudioParams() {\n    return APP.audioOverrides.get(this.el);\n  },\n\n  contains(position) {\n    return this.getBoundingBox().containsPoint(position);\n  }\n});\n","AFRAME.registerComponent(\"avatar-inspect-collider\", {\n  play() {\n    this.el.setObject3D(\n      \"avatar-inspect-collider\",\n      new THREE.Mesh(\n        new THREE.BoxGeometry(0.3, 0.8, 0.3),\n        new THREE.MeshBasicMaterial({\n          visible: false\n        })\n      )\n    );\n  }\n});\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n// Billboard component that only updates visible objects and only those in the camera view on mobile VR.\n// TODO billboarding assumes a single camera viewpoint but with video-texture-source, mirrors, and camera tools this is no longer valid\nAFRAME.registerComponent(\"billboard\", {\n  schema: {\n    onlyY: { type: \"boolean\" }\n  },\n  init: function() {\n    this._updateBillboard = this._updateBillboard.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateIsInView, \"billboards\");\n    }\n  },\n  remove() {\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateIsInView, \"billboards\");\n    }\n  },\n\n  tick() {\n    if (this.isInView || !isMobileVR) {\n      this._updateBillboard();\n    }\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const box = new THREE.Box3();\n    const boxTemp = new THREE.Box3();\n\n    const expandBox = o => {\n      if (o.geometry) {\n        o.updateMatrices();\n        o.geometry.computeBoundingBox();\n        boxTemp.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld);\n        box.expandByPoint(boxTemp.min);\n        box.expandByPoint(boxTemp.max);\n      }\n    };\n\n    const isInViewOfCamera = (obj, screenCamera) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromProjectionMatrix(frustumMatrix);\n      box.makeEmpty();\n      obj.traverse(expandBox);\n\n      // NOTE: not using box.setFromObject here because text nodes do not have Z values in their geometry buffer,\n      // and that routine ultimately assumes they do.\n      return frustum.intersectsBox(box);\n    };\n\n    return function() {\n      if (!this.el.object3D.visible) {\n        this.isInView = false;\n        return;\n      }\n\n      if (!this.playerCamera) {\n        this.playerCamera = document.getElementById(\"viewing-camera\").getObject3D(\"camera\");\n      }\n\n      if (!this.playerCamera) return;\n\n      this.isInView = this.el.sceneEl.is(\"vr-mode\") ? true : isInViewOfCamera(this.el.object3D, this.playerCamera);\n    };\n  })(),\n\n  _updateBillboard: (function() {\n    const targetPos = new THREE.Vector3();\n    const worldPos = new THREE.Vector3();\n    return function() {\n      if (!this.el.object3D.visible) return;\n\n      const camera = this.el.sceneEl.camera;\n      const object3D = this.el.object3D;\n\n      if (camera) {\n        // Set the camera world position as the target.\n        targetPos.setFromMatrixPosition(camera.matrixWorld);\n\n        if (this.data.onlyY) {\n          object3D.getWorldPosition(worldPos);\n          targetPos.y = worldPos.y;\n        }\n        object3D.lookAt(targetPos);\n\n        object3D.matrixNeedsUpdate = true;\n      }\n    };\n  })()\n});\n","/**\n * Registers a click handler and invokes the block method on the NAF adapter for the owner associated with its entity.\n * @namespace network\n * @component block-button\n */\nAFRAME.registerComponent(\"block-button\", {\n  init() {\n    this.onClick = () => {\n      this.block(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  block(clientId) {\n    window.APP.hubChannel.hide(clientId);\n  }\n});\n","/**\n * Toggles the position of 2 bones into \"on\" and \"off\" positions to indicate mute state.\n * @namespace avatar\n * @component bone-mute-state-indicator\n */\n// TODO: Remove this\nAFRAME.registerComponent(\"bone-mute-state-indicator\", {\n  schema: {\n    unmutedBoneName: { default: \"Watch_Joint_MicON\" },\n    mutedBoneName: { default: \"Watch_Joint_Muted\" },\n    onPos: { default: 0.81 },\n    offPos: { default: 0.5 }\n  },\n\n  init() {\n    this.onStateToggled = this.onStateToggled.bind(this);\n    this.el.addEventListener(\"model-loaded\", () => {\n      this.unmutedBone = this.el.object3D.getObjectByName(this.data.unmutedBoneName);\n      this.mutedBone = this.el.object3D.getObjectByName(this.data.mutedBoneName);\n      this.modelLoaded = true;\n\n      this.updateMuteState();\n    });\n\n    this.onMicStateChanged = () => {\n      this.updateMuteState();\n    };\n  },\n\n  play() {\n    APP.dialog.on(\"mic-state-changed\", this.onMicStateChanged);\n  },\n\n  pause() {\n    APP.dialog.off(\"mic-state-changed\", this.onMicStateChanged);\n  },\n\n  updateMuteState() {\n    if (!this.modelLoaded) return;\n    const muted = !APP.mediaDevicesManager.isMicEnabled;\n    this.mutedBone.position.y = muted ? this.data.onPos : this.data.offPos;\n    this.unmutedBone.position.y = !muted ? this.data.onPos : this.data.offPos;\n    this.mutedBone.matrixNeedsUpdate = true;\n    this.unmutedBone.matrixNeedsUpdate = true;\n  }\n});\n","AFRAME.registerComponent(\"close-vr-notice-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"action_vr_notice_closed\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","/**\n * Sets the CSS class on an entity.\n * @component css-class\n */\nAFRAME.registerComponent(\"css-class\", {\n  schema: {\n    type: \"string\"\n  },\n  multiple: true,\n  init() {\n    this.el.classList.add(this.data);\n  },\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.el.classList.remove(oldData);\n      this.el.classList.add(this.data);\n    }\n  },\n  remove() {\n    this.el.classList.remove(this.data);\n  }\n});\n","/**\n * Logs all events dispatched on an entity\n * @namespace debug\n * @component log-events\n */\nAFRAME.registerComponent(\"log-events\", {\n  init: function() {\n    const el = this.el;\n    const log = this.log.bind(this);\n    const origDispatch = this.el.dispatchEvent;\n    this.el.dispatchEvent = function() {\n      log(Array.from(arguments));\n      return origDispatch.apply(el, arguments);\n    };\n  },\n  log: function([e]) {\n    if ([\"componentchanged\"].includes(e.type)) return;\n    let firstObject = true;\n    const replacer = (k, x) => {\n      if (!x) return x;\n      if (typeof x === \"object\" && x.length === undefined) {\n        if (firstObject) {\n          firstObject = false;\n          return x;\n        }\n        return \"[object]\";\n      }\n      return x;\n    };\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\n  }\n});\n\n/**\n * Logs all life cycle phases on an entity.\n * @namespace debug\n * @component lifecycle-checker\n */\nAFRAME.registerComponent(\"lifecycle-checker\", {\n  schema: {\n    name: { type: \"string\" },\n    tick: { default: false }\n  },\n  init: function() {\n    this.log(\"init\");\n  },\n  update: function() {\n    this.log(\"update\");\n  },\n  tick: function() {\n    if (this.data.tick) {\n      this.log(\"tick\");\n    }\n  },\n  remove: function() {\n    this.log(\"remove\");\n  },\n  pause: function() {\n    this.log(\"pause\");\n  },\n  play: function() {\n    this.log(\"play\");\n  },\n\n  log: function(method) {\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\n  }\n});\n","AFRAME.registerComponent(\"directional-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    this.light = new THREE.DirectionalLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.el.setObject3D(\"directional-light\", this.light);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      color.convertSRGBToLinear();\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n\n    this.light.shadow.camera.matrixNeedsUpdate = true;\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"directional-light\");\n  }\n});\n","AFRAME.registerComponent(\"disable-frustum-culling\", {\n  init() {\n    this.el.object3D.traverse(o => (o.frustumCulled = false));\n  }\n});\n","const COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"drop-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"floaty-object\", { modifyGravityOnRelease: false });\n      this.targetEl.setAttribute(\"body-helper\", {\n        type: \"dynamic\",\n        gravity: { x: 0, y: -9.8, z: 0 },\n        angularDamping: 0.01,\n        linearDamping: 0.01,\n        linearSleepingThreshold: 1.6,\n        angularSleepingThreshold: 2.5,\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n      });\n\n      const physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n      if (this.targetEl.components[\"body-helper\"].uuid) {\n        physicsSystem.activateBody(this.targetEl.components[\"body-helper\"].uuid);\n      }\n\n      // Remove drop button after using it\n      this.el.parentNode.removeChild(this.el);\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","/**\n * Floats a duck based on its scale.\n * @component duck\n */\nAFRAME.registerComponent(\"duck\", {\n  schema: {\n    initialForce: { default: 0 },\n    maxForce: { default: 6.5 },\n    maxScale: { default: 5 }\n  },\n\n  init: function() {\n    this.initialScale = this.el.object3D.scale.x;\n    this.maxScale = this.data.maxScale * this.initialScale;\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n      this.networkedEntity = networkedEntity;\n\n      this.initialScale = this.networkedEntity.object3D.scale.x;\n      this.maxScale = this.data.maxScale * this.initialScale;\n    });\n  },\n\n  tick: function() {\n    if (!this.networkedEntity || NAF.utils.isMine(this.networkedEntity)) {\n      const entity = this.networkedEntity || this.el;\n      const currentScale = entity.object3D.scale.x;\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\n      const force = ratio * this.data.maxForce;\n      if (force > 0) {\n        const angle = Math.random() * Math.PI * 2;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        entity.setAttribute(\"body-helper\", { gravity: { x, y: force, z } });\n      }\n    }\n  }\n});\n","AFRAME.registerComponent(\"emit-scene-event-on-remove\", {\n  schema: {\n    event: { default: null }\n  },\n\n  remove() {\n    if (this.data.event) {\n      this.el.sceneEl.emit(this.data.event, { el: this.el });\n    }\n  }\n});\n","AFRAME.registerComponent(\"emit-state-change\", {\n  multiple: true,\n  schema: {\n    state: { type: \"string\" },\n    transform: { type: \"string\", oneof: [\"rising\", \"falling\"] },\n    event: { type: \"string\" }\n  },\n\n  init() {\n    this.stateadded = this.stateadded.bind(this);\n    this.stateremoved = this.stateremoved.bind(this);\n  },\n\n  stateadded(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n  stateremoved(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n\n  update() {\n    this.el.removeEventListener(\"stateadded\", this.stateadded);\n    this.el.removeEventListener(\"stateremoved\", this.stateremoved);\n\n    if (this.data.transform === \"rising\") {\n      this.el.addEventListener(\"stateadded\", this.stateadded);\n    }\n    if (this.data.transform === \"falling\") {\n      this.el.addEventListener(\"stateremoved\", this.stateremoved);\n    }\n  }\n});\n","/**\n * Listens to events from an event source and re-emits them on this entity\n * @component event-repeater\n */\nAFRAME.registerComponent(\"event-repeater\", {\n  schema: {\n    eventSource: { type: \"selector\" },\n    events: { type: \"array\" }\n  },\n\n  play: function() {\n    this.data.eventListeners = [];\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\n    }\n  },\n\n  pause: function() {\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\n    }\n    this.data.eventListeners = [];\n  },\n\n  _handleEvent: function(event, e) {\n    this.el.emit(event, e.detail);\n  }\n});\n","/**\n * Creates a box around the element (assumed to be the camera's PoV) which can be used for fade-to-black.\n */\n\nconst FADE_DURATION_MS = 750;\n\nAFRAME.registerComponent(\"fader\", {\n  schema: {\n    direction: { type: \"string\", default: \"none\" } // \"in\", \"out\", or \"none\"\n  },\n\n  init() {\n    const mesh = new THREE.Mesh(\n      new THREE.BoxGeometry(),\n      new THREE.MeshBasicMaterial({ color: 0x0, side: THREE.BackSide, opacity: 0, transparent: true, fog: false })\n    );\n    mesh.scale.x = mesh.scale.y = 1;\n    mesh.scale.z = 0.15;\n    mesh.matrixNeedsUpdate = true;\n    this.el.object3DMap.camera.add(mesh);\n    this.mesh = mesh;\n  },\n\n  fadeOut() {\n    return this.beginTransition(\"out\");\n  },\n\n  fadeIn() {\n    return this.beginTransition(\"in\");\n  },\n\n  async beginTransition(direction) {\n    if (this._resolveFinish) {\n      throw new Error(\"Cannot fade while a fade is happening.\");\n    }\n\n    this.el.setAttribute(\"fader\", { direction });\n\n    return new Promise(res => {\n      if (this.mesh.material.opacity === (direction == \"in\" ? 0 : 1)) {\n        res();\n      } else {\n        this._resolveFinish = res;\n      }\n    });\n  },\n\n  tick(t, dt) {\n    const mat = this.mesh.material;\n    this.mesh.visible = this.data.direction === \"out\" || mat.opacity !== 0;\n    if (!this.mesh.visible) return;\n\n    if (this.data.direction === \"in\") {\n      mat.opacity = Math.max(0, mat.opacity - (1.0 / FADE_DURATION_MS) * Math.min(dt, 50));\n    } else if (this.data.direction === \"out\") {\n      mat.opacity = Math.min(1, mat.opacity + (1.0 / FADE_DURATION_MS) * Math.min(dt, 50));\n    }\n\n    if (mat.opacity === 0 || mat.opacity === 1) {\n      if (this.data.direction !== \"none\") {\n        if (this._resolveFinish) {\n          this._resolveFinish();\n          this._resolveFinish = null;\n        }\n      }\n\n      this.el.setAttribute(\"fader\", { direction: \"none\" });\n    }\n  }\n});\n","AFRAME.registerComponent(\"follow-in-fov\", {\n  schema: {\n    target: { type: \"selector\" },\n    offset: { type: \"vec3\" },\n    speed: { type: \"number\", default: 0.003 },\n    angle: { type: \"number\", default: 45 }\n  },\n\n  init() {\n    this.targetPos = new THREE.Vector3();\n    this.offset = new THREE.Vector3();\n    this.offset.copy(this.data.offset);\n\n    this.snappedRot = new THREE.Euler();\n    this.snappedQ = new THREE.Quaternion();\n    this.snappedXForm = new THREE.Matrix4();\n    this.snappedXFormWorld = new THREE.Matrix4();\n    this.tempVector = new THREE.Vector3();\n  },\n\n  tick(t, dt) {\n    if (!this.el.object3D.visible) return;\n    if (!this.data.target) return;\n\n    const obj = this.el.object3D;\n    const target = this.data.target.object3D;\n\n    // Slow updating position if the element or any subelement is hovered.\n    let isHovered = false;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    const hoveredEl = interaction.state.rightRemote.hovered || interaction.state.leftRemote.hovered;\n\n    if (hoveredEl) {\n      let el = hoveredEl;\n\n      while (el) {\n        if (this.el === el) {\n          isHovered = true;\n          break;\n        }\n\n        el = el.parentNode;\n      }\n    }\n\n    if (!isHovered) {\n      this._hoveredFrames = 0;\n    } else {\n      this._hoveredFrames += 1;\n    }\n\n    // Compute position + rotation by projecting offset along a downward ray in target space,\n    // and mask out Z rotation.\n    this._applyMaskedTargetRotation(\n      -this.data.angle * THREE.MathUtils.DEG2RAD,\n      target.rotation.y,\n      0,\n      this.snappedXFormWorld\n    );\n\n    this.targetPos.copy(this.offset);\n    this.targetPos.applyMatrix4(this.snappedXFormWorld);\n\n    if (obj.parent) {\n      obj.parent.worldToLocal(this.targetPos);\n    }\n\n    if (!this.started) {\n      obj.position.copy(this.targetPos);\n      this.started = true;\n    } else {\n      // Slow down movement if hovering by dampening speed each frame.\n      const speed = this._hoveredFrames\n        ? this.data.speed * (1.0 / ((this._hoveredFrames + 5.0) * 0.2))\n        : this.data.speed;\n      const t = speed * dt;\n\n      obj.position.set(\n        obj.position.x + (this.targetPos.x - obj.position.x) * t,\n        obj.position.y + (this.targetPos.y - obj.position.y) * t,\n        obj.position.z + (this.targetPos.z - obj.position.z) * t\n      );\n    }\n\n    this.snappedXFormWorld.decompose(this.tempVector, obj.quaternion, this.tempVector);\n    obj.matrixNeedsUpdate = true;\n  },\n\n  reset() {\n    this.started = false;\n  },\n\n  _applyMaskedTargetRotation(x, y, z, to) {\n    const target = this.data.target.object3D;\n    this.snappedRot.set(x, y, z, target.rotation.order);\n    this.snappedQ.setFromEuler(this.snappedRot);\n\n    this.snappedXForm.compose(\n      target.position,\n      this.snappedQ,\n      target.scale\n    );\n\n    to.multiplyMatrices(target.parent.matrixWorld, this.snappedXForm);\n  }\n});\n","/**\n * Frustrum-based object visibilty\n * @component frustrum\n */\nAFRAME.registerComponent(\"frustrum\", {\n  schema: {\n    culled: { type: \"boolean\", default: true }\n  },\n\n  update: function() {\n    this.updateDescendants(this.data.culled);\n  },\n\n  remove: function() {\n    this.updateDescendants(true);\n  },\n\n  updateDescendants: function(culled) {\n    this.el.object3D.traverse(function(node) {\n      if (!(node instanceof THREE.Mesh)) {\n        return;\n      }\n      node.frustumCulled = culled;\n    });\n  }\n});\n","/* global CANNON */\nAFRAME.registerComponent(\"heightfield\", {\n  init() {\n    this.el.addEventListener(\"componentinitialized\", e => {\n      if (e.detail.name === \"static-body\") {\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\n      }\n    });\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\n  },\n  generateAndAddHeightfield(body) {\n    const { offset, distance, data } = this.data;\n\n    const orientation = new CANNON.Quaternion();\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\n\n    const rotation = new CANNON.Quaternion();\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\n    rotation.mult(orientation, orientation);\n\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\n\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\n\n    body.addShape(shape, cannonOffset, orientation);\n  }\n});\n","AFRAME.registerComponent(\"hemisphere-light\", {\n  schema: {\n    skyColor: { type: \"color\" },\n    groundColor: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    this.light = new THREE.HemisphereLight();\n    this.light.position.set(0, 0, 0);\n    this.light.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"hemisphere-light\", this.light);\n  },\n\n  update(prevData) {\n    if (this.data.skyColor !== prevData.skyColor) {\n      this.light.color.set(this.data.skyColor);\n    }\n\n    if (this.data.groundColor !== prevData.groundColor) {\n      this.light.groundColor.set(this.data.groundColor);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"hemisphere-light\");\n  }\n});\n","AFRAME.registerComponent(\"hide-when-pinned-and-forbidden\", {\n  schema: {\n    // Hide regardless of being forbidden.\n    whenPinned: { type: \"boolean\" }\n  },\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    if (!this.targetEl) return;\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n\n    if (this.data.whenPinned) {\n      this.el.object3D.visible = !isPinned;\n    } else {\n      const pinnedAndForbidden = isPinned && !window.APP.hubChannel.canOrWillIfCreator(\"pin_objects\");\n      this.el.object3D.visible = !pinnedAndForbidden;\n    }\n  }\n});\n","/**\n * Hides entities based on the scene's quality mode\n * @namespace environment\n * @component hide-when-quality\n */\nAFRAME.registerComponent(\"hide-when-quality\", {\n  schema: { type: \"string\", default: \"low\" },\n\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.updateComponentState(window.APP.store.state.preferences.materialQualitySetting);\n    }\n  },\n\n  updateComponentState(quality) {\n    this.el.setAttribute(\"visible\", quality !== this.data);\n  }\n});\n","AFRAME.registerComponent(\"hover-menu\", {\n  multiple: true,\n  schema: {\n    template: { type: \"selector\" },\n    isFlat: { default: true },\n    dim: { default: true },\n    withPermission: { type: \"string\" }\n  },\n\n  async init() {\n    this.onFrozenStateChange = this.onFrozenStateChange.bind(this);\n    this.hovering = false;\n    await this.getHoverMenu();\n    this.applyHoverState();\n  },\n\n  getHoverMenu() {\n    if (this.menuPromise) return this.menuPromise;\n    return (this.menuPromise = new Promise(resolve => {\n      const menu = this.el.appendChild(document.importNode(this.data.template.content, true).children[0]);\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n      setTimeout(() => {\n        this.menu = menu;\n\n        // HACK workaround for now due to position-at-box-shape-border having problems\n        // with nested entities, when using 'mirror' viewing.\n        //\n        // TODO Revisit once that component is removed/deprecated. If we disable repositioning,\n        // the menu will only appear on the front of the object (which is fine for our purposes)\n        const isMirroredMedia = this.el.parentEl.id === \"media-mirror-target\";\n        const enableRepositioning = !isMirroredMedia;\n\n        if (enableRepositioning) {\n          this.el.setAttribute(\"position-at-border\", {\n            target: \".hover-container\",\n            isFlat: this.data.isFlat,\n            animate: false,\n            scale: false\n          });\n        } else {\n          const hoverContainer = this.el.querySelector(\".hover-container\");\n          hoverContainer.object3D.position.z = 0.001;\n          hoverContainer.object3D.matrixNeedsUpdate = true;\n        }\n\n        resolve(this.menu);\n      });\n    }));\n  },\n\n  onFrozenStateChange(e) {\n    if (!e.detail === \"frozen\") return;\n    this.applyHoverState();\n  },\n\n  applyHoverState() {\n    if (!this.menu) return;\n    const allowed = !this.data.withPermission || window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    this.menu.object3D.visible = allowed && !this.el.sceneEl.is(\"frozen\") && this.hovering;\n    if (this.data.dim && this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) {\n      this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible ? 0.5 : 1);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onFrozenStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onFrozenStateChange);\n  }\n});\n","/**\n * A button with an image, tooltip, hover states.\n * @namespace ui\n * @component icon-button\n */\nAFRAME.registerComponent(\"icon-button\", {\n  schema: {\n    image: { type: \"string\" },\n    hoverImage: { type: \"string\" },\n    activeImage: { type: \"string\" },\n    activeHoverImage: { type: \"string\" },\n    disabledImage: { type: \"string\" },\n    active: { type: \"boolean\" },\n    disabled: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = true;\n      }\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = false;\n      }\n      this.updateButtonState();\n    };\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    const active = this.data.active;\n    const disabled = this.data.disabled;\n\n    let image;\n    if (disabled) {\n      image = \"disabledImage\";\n    } else if (active) {\n      image = hovering ? \"activeHoverImage\" : \"activeImage\";\n    } else {\n      image = hovering ? \"hoverImage\" : \"image\";\n    }\n\n    if (this.el.components.sprite) {\n      if (this.data[image]) {\n        this.el.setAttribute(\"sprite\", \"name\", this.data[image]);\n      } else {\n        console.warn(`No ${image} image on me.`, this);\n      }\n    } else {\n      console.error(\"No sprite.\");\n    }\n\n    if (this.data.tooltip && hovering) {\n      const tooltipText =\n        (this.data.active ? this.data.activeTooltipText : this.data.tooltipText) + (disabled ? \" Disabled\" : \"\");\n      this.data.tooltip.querySelector(\"[text]\").setAttribute(\"text\", \"value\", tooltipText);\n    }\n  }\n});\n","AFRAME.registerComponent(\"inject-main-camera-here\", {\n  init() {\n    // This is what actually puts the camera into the scene graph.\n    // Ideally we would just be doing this ourselves, but we have to do it after the entity we want to parent it to is created\n    // TODO any references to this entity should instead get the camera reference from the camera system\n    this.el.setObject3D(\"camera\", this.el.sceneEl.camera);\n  }\n});\n","AFRAME.registerComponent(\"inspect-button\", {\n  tick() {\n    if (!this.initializedInTick) {\n      // initialize in tick so that parent's `tags` component has been initialized\n      this.initializedInTick = true;\n      this.el.object3D.addEventListener(\"holdable-button-down\", () => {\n        this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.inspect(this.el, 1.5);\n      });\n      this.el.object3D.addEventListener(\"holdable-button-up\", () => {\n        this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.uninspect();\n      });\n    }\n  }\n});\n","AFRAME.registerComponent(\"inspect-pivot-child-selector\", {\n  schema: {\n    selector: { type: \"string\" }\n  }\n});\n","AFRAME.registerComponent(\"kick-button\", {\n  init() {\n    this.onClick = () => {\n      this.kick(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async kick(clientId) {\n    this.el.sceneEl.emit(\"action_kick_client\", { clientId });\n  }\n});\n","// AFRAME.registerComponent(\"leave-room-button\", {\n//   init() {\n//     this.onClick = () => {\n//       this.el.sceneEl.emit(\"leave_room_requested\");\n//     };\n//   },\n\n//   play() {\n//     this.el.object3D.addEventListener(\"interact\", this.onClick);\n//   },\n\n//   pause() {\n//     this.el.object3D.removeEventListener(\"interact\", this.onClick);\n//   }\n// });\nAFRAME.registerComponent(\"leave-room-button\", {\n  init() {\n    this.onClick = () => {\n      // Close the browser\n      window.close();\n    };\n    this.el.sceneEl.addEventListener(\"leave_room_requested\", this.onClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"leave_room_requested\", this.onClick);\n  }\n});","AFRAME.registerComponent(\"mute-button\", {\n  init() {\n    this.onClick = () => {\n      this.mute(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async mute(clientId) {\n    this.el.sceneEl.emit(\"action_mute_client\", { clientId });\n  }\n});\n","/**\n * Stores networked avatar state.\n * @namespace avatar\n * @component networked-avatar\n */\nAFRAME.registerComponent(\"networked-avatar\", {\n  schema: {\n    left_hand_pose: { default: 0 },\n    right_hand_pose: { default: 0 }\n  }\n});\n","/* global AFRAME performance */\n/**\n * Limits networked interactables to a maximum number at any given time\n * @namespace network\n * @component networked-counter\n */\nAFRAME.registerComponent(\"networked-counter\", {\n  schema: {\n    max: { default: 3 }\n  },\n\n  init() {\n    this.timestamps = new Map();\n    this.el.object3D.visible = false;\n  },\n\n  remove() {\n    this.timestamps.clear();\n  },\n\n  count() {\n    return this.timestamps.size;\n  },\n\n  register(el) {\n    if (this.data.max <= 0 || this.timestamps.has(el)) return;\n\n    this.timestamps.set(el, performance.now());\n    if (this.timestamps.size > this.data.max) {\n      this._destroyOldest();\n    }\n  },\n\n  deregister(el) {\n    if (!this.timestamps.has(el)) return;\n    this.timestamps.delete(el);\n  },\n\n  _destroyOldest() {\n    const interaction = this.el.sceneEl.systems.interaction;\n    let oldestEl = null,\n      minTs = Number.MAX_VALUE;\n    this.timestamps.forEach((ts, el) => {\n      if (ts < minTs && !interaction.isHeld(el) && NAF.utils.isMine(el)) {\n        oldestEl = el;\n        minTs = ts;\n      }\n    });\n    this._destroy(oldestEl);\n  },\n\n  _destroy(el) {\n    // Pause the entity so that it won't just re-register itself immediately in owned-object-limiter.\n    el.pause();\n    // networked-interactable's remove will also call deregister, but it will happen async so we do it here as well.\n    this.deregister(el);\n    if (el.parentNode) {\n      el.parentNode.removeChild(el);\n    }\n  }\n});\n","AFRAME.registerComponent(\"optional-alternative-to-not-hide\", {});\n","/* global performance */\nAFRAME.registerComponent(\"owned-object-cleanup-timeout\", {\n  schema: {\n    ttl: { default: 0 }\n  },\n\n  init() {\n    this.timeout = performance.now() + this.data.ttl * 1000;\n  },\n\n  tick() {\n    if (!this.el.components[\"networked\"] || !NAF.utils.isMine(this.el)) {\n      return;\n    }\n\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n\n    if (isHeld) {\n      this.timeout = performance.now() + this.data.ttl * 1000;\n      return;\n    }\n\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\n\n    if (!isPinned && performance.now() >= this.timeout) {\n      this.el.parentNode.removeChild(this.el);\n    }\n  }\n});\n","/* global AFRAME NAF performance */\nAFRAME.registerComponent(\"owned-object-limiter\", {\n  schema: {\n    counter: { type: \"selector\" }\n  },\n\n  init() {\n    this.counter = this.data.counter.components[\"networked-counter\"];\n  },\n\n  tick() {\n    this._syncCounterRegistration();\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n    if (!isHeld && this.wasHeld && this.counter.timestamps.has(this.el)) {\n      this.counter.timestamps.set(this.el, performance.now());\n    }\n    this.wasHeld = isHeld;\n  },\n\n  remove() {\n    this.counter.deregister(this.el);\n  },\n\n  _syncCounterRegistration() {\n    if (!this.el.components[\"networked\"]) return;\n\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\n\n    if (NAF.utils.isMine(this.el) && !isPinned) {\n      this.counter.register(this.el);\n    } else {\n      this.counter.deregister(this.el);\n    }\n  }\n});\n","const SYNC_DURATION_MS = 5000;\n\n// HACK this is a hacky component that is used to mitigate the situation where a first sync is missed on critical\n// networked elements. (At the time of this writing, specifically just the user's avatar.) The motivation\n// is that there have been a variety of issues resulting in missed avatar instantiation messages, and\n// this is meant to ensure we recover from those in the cases where they occur.\n//\n// This component, when added, will re-send a isFirstSync message for the networked object is it attached to\n// every SYNC_DURATION_MS milliseconds.\nAFRAME.registerComponent(\"periodic-full-syncs\", {\n  init() {\n    this.lastSync = 0;\n  },\n\n  tick() {\n    const now = performance.now();\n\n    if (now - this.lastSync >= SYNC_DURATION_MS && this.el.components && this.el.components.networked) {\n      this.lastSync = now;\n\n      // Sends an undirected first sync message.\n      this.el.components.networked.syncAll(null, true);\n    }\n  }\n});\n","AFRAME.registerComponent(\"point-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    this.light = new THREE.PointLight();\n    this.light.shadow.camera.matrixAutoUpdate = true;\n    this.el.setObject3D(\"point-light\", this.light);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      color.convertSRGBToLinear();\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"point-light\");\n  }\n});\n","AFRAME.registerComponent(\"replay\", {\n  init: function() {\n    this.playhead = 0;\n    this.poseIndex = 0;\n  },\n\n  tick: function(t, dt) {\n    let overflow = false;\n    while (!overflow && this.playhead >= this.poses[this.poseIndex].timestamp) {\n      this.el.setAttribute(\"position\", this.poses[this.poseIndex].position);\n      this.el.setAttribute(\"rotation\", this.poses[this.poseIndex].rotation);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.poseIndex += 1;\n      overflow = this.poseIndex === this.poses.length;\n    }\n\n    this.playhead += dt;\n\n    if (overflow) {\n      this.playhead = 0;\n      this.poseIndex = 0;\n    }\n  }\n});\n","/* global NAF */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"set-unowned-body-kinematic\", {\n  init() {\n    this.setBodyKinematic = this.setBodyKinematic.bind(this);\n  },\n  play() {\n    this.el.addEventListener(\"ownership-lost\", this.setBodyKinematic);\n\n    if (!this.didThisOnce) {\n      // Do this in play instead of init so that the ammo-body and networked components are done\n      this.didThisOnce = true;\n\n      if (!this.el.components.networked || !NAF.utils.isMine(this.el)) {\n        this.setBodyKinematic();\n      }\n    }\n  },\n  pause() {\n    this.el.removeEventListener(\"ownership-lost\", this.setBodyKinematic);\n  },\n  setBodyKinematic() {\n    this.el.setAttribute(\"body-helper\", {\n      type: \"kinematic\",\n      collisionFilterMask: COLLISION_LAYERS.UNOWNED_INTERACTABLE\n    });\n  }\n});\n","AFRAME.registerComponent(\"set-yxz-order\", {\n  init: function() {\n    this.el.object3D.rotation.order = \"YXZ\";\n  }\n});\n","AFRAME.registerComponent(\"spot-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    innerConeAngle: { default: 0 },\n    outerConeAngle: { default: Math.PI / 4.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    this.light = new THREE.SpotLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.light.matrixNeedsUpdate = true;\n    this.light.target.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"spot-light\", this.light);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\n      light.angle = this.data.outerConeAngle;\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"spot-light\");\n  }\n});\n","/**\n * A button with text\n * @namespace ui\n * @component text-button\n */\nAFRAME.registerComponent(\"text-button\", {\n  schema: {\n    textHoverColor: { type: \"string\" },\n    textColor: { type: \"string\" },\n    backgroundHoverColor: { type: \"string\" },\n    backgroundColor: { type: \"string\" }\n  },\n\n  init() {\n    // TODO: This is a bit of a hack to deal with position \"component\" not setting matrixNeedsUpdate. Come up with a better solution.\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n    this.textEl = this.el.querySelector(\"[text]\");\n\n    if (this.el.getObject3D(\"mesh\")) {\n      this.el.components.slice9.plane.material.toneMapped = false;\n    } else {\n      this.el.addEventListener(\n        \"object3dset\",\n        () => {\n          this.el.components.slice9.plane.material.toneMapped = false;\n        },\n        { once: true }\n      );\n    }\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    this.el.setAttribute(\"slice9\", \"color\", hovering ? this.data.backgroundHoverColor : this.data.backgroundColor);\n\n    if (this.textEl) {\n      this.textEl.setAttribute(\"text\", \"color\", hovering ? this.data.textHoverColor : this.data.textColor);\n    }\n  }\n});\n\nconst noop = function() {};\n// TODO: this should ideally be fixed upstream somehow but its pretty tricky since text is just a geometry not a different type of Object3D, and Object3D is what handles raycast checks.\nAFRAME.registerComponent(\"text-raycast-hack\", {\n  dependencies: [\"text\"],\n  init() {\n    this.el.getObject3D(\"text\").raycast = noop;\n  }\n});\n","/**\n * Drawing Manager\n * Manages what networked-drawings are available to pen components\n * @namespace drawing\n * @component drawing-manager\n */\nAFRAME.registerComponent(\"drawing-manager\", {\n  schema: {\n    penSpawner: { type: \"selector\" }\n  },\n\n  init() {\n    this.el.object3D.visible = false;\n    this.drawingToPen = new Map();\n    this.data.penSpawner.addEventListener(\"spawned-entity-created\", () => {\n      if (!this.drawingEl) {\n        this.createDrawing();\n      }\n    });\n  },\n\n  createDrawing() {\n    if (!this.createDrawingPromise) {\n      this.createDrawingPromise = new Promise(resolve => {\n        this.drawingEl = document.createElement(\"a-entity\");\n        this.drawingEl.setAttribute(\"networked\", \"template: #interactable-drawing\");\n        this.el.sceneEl.appendChild(this.drawingEl);\n\n        const handNetworkedDrawingInit = e => {\n          if (e.detail.name === \"networked-drawing\") {\n            this.drawing = this.drawingEl.components[\"networked-drawing\"];\n            this.drawingEl.removeEventListener(\"componentinitialized\", handNetworkedDrawingInit);\n            resolve();\n          }\n        };\n\n        this.drawingEl.addEventListener(\"componentinitialized\", handNetworkedDrawingInit);\n      });\n    }\n    return this.createDrawingPromise;\n  },\n\n  destroyDrawing(networkedDrawing) {\n    if (this.drawing === networkedDrawing) {\n      this.drawingToPen.delete(this.drawing);\n      this.drawing = null;\n      this.drawingEl = null;\n      this.createDrawingPromise = null;\n      this.getDrawingPromise = null;\n    }\n  },\n\n  getDrawing(pen) {\n    //TODO: future handling of multiple drawings\n    if (!this.getDrawingPromise) {\n      this.getDrawingPromise = new Promise((resolve, reject) => {\n        if (!this.drawingEl) {\n          this.createDrawing().then(() => {\n            this.drawingToPen.set(this.drawing, pen);\n            resolve(this.drawing);\n          });\n        } else if (\n          this.drawing &&\n          (!this.drawingToPen.has(this.drawing) || this.drawingToPen.get(this.drawing) === pen)\n        ) {\n          this.drawingToPen.set(this.drawing, pen);\n          resolve(this.drawing);\n        } else {\n          reject();\n        }\n      });\n    }\n    return this.getDrawingPromise;\n  },\n\n  returnDrawing(pen) {\n    if (this.drawingToPen.has(this.drawing) && this.drawingToPen.get(this.drawing) === pen) {\n      this.drawingToPen.delete(this.drawing);\n    }\n  }\n});\n","AFRAME.registerComponent(\"track-pose\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n\n  play() {\n    if (!this.didRegister) {\n      this.didRegister = true;\n      this.el.sceneEl.systems[\"hubs-systems\"].cursorPoseTrackingSystem.register(this.el.object3D, this.data.path);\n    }\n  },\n  remove() {\n    if (this.didRegister) {\n      this.el.sceneEl.systems[\"hubs-systems\"].cursorPoseTrackingSystem.unregister(this.el.object3D);\n    }\n  }\n});\n","const sizeVec = new THREE.Vector3();\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\nconst colliderWorldPositionVec = new THREE.Vector3();\n\nAFRAME.registerComponent(\"trigger-volume\", {\n  schema: {\n    colliders: { type: \"selectorAll\" },\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    target: { type: \"selector\" },\n    enterComponent: { type: \"string\" },\n    enterProperty: { type: \"string\" },\n    enterValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    },\n    leaveComponent: { type: \"string\" },\n    leaveProperty: { type: \"string\" },\n    leaveValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n  init() {\n    this.boundingBox = new THREE.Box3();\n    this.collidingLastFrame = {};\n  },\n  update() {\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\n    sizeVec.copy(this.data.size);\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\n  },\n  tick() {\n    if (!this.data.target) return;\n\n    const colliders = this.data.colliders;\n\n    for (let i = 0; i < colliders.length; i++) {\n      const collider = colliders[i];\n      const object3D = collider.object3D;\n\n      object3D.getWorldPosition(colliderWorldPositionVec);\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\n\n      if (isColliding && !collidingLastFrame) {\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\n      } else if (!isColliding && collidingLastFrame) {\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\n      }\n\n      this.collidingLastFrame[object3D.id] = isColliding;\n    }\n  }\n});\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\nAFRAME.registerComponent(\"video-pause-state\", {\n  schema: {\n    paused: { default: false }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.videoComponent = this.el.components[\"media-video\"];\n\n    if (this.videoComponent) {\n      this.onVideoLoaded();\n    } else {\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\n    }\n  },\n\n  onVideoLoaded() {\n    this.videoComponent = this.el.components[\"media-video\"];\n    this.video = this.videoComponent.video;\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\n  },\n\n  onPauseStateChange() {\n    this.el.setAttribute(\"paused\", this.video.paused);\n  },\n\n  update() {\n    if (this.video && this.data.paused !== this.video.paused) {\n      this.videoComponent.togglePlaying();\n    }\n  },\n\n  remove() {\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n    }\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\n  }\n});\n","AFRAME.registerComponent(\"visibility-by-path\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const shouldBeVisible = !!userinput.get(this.data.path);\n    if (this.el.object3D.visible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  }\n});\n","AFRAME.registerComponent(\"visibility-on-content-types\", {\n  schema: {\n    contentTypes: { type: \"string\" }, // Space separate content types. Or partial type, like video/\n    contentSubtype: { type: \"string\" },\n    visible: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(el => {\n        this.networkedEl = el;\n        el.addEventListener(\"media_resolved\", ({ detail: { contentType } }) => this.updateVisibility(contentType));\n        this.updateVisibility();\n      })\n      .catch(() => {\n        // Non-networked, do not handle for now.\n      });\n  },\n\n  updateVisibility(contentType) {\n    const mediaLoader = this.networkedEl.components[\"media-loader\"];\n    const mediaImage = this.networkedEl.components[\"media-image\"];\n    const mediaVideo = this.networkedEl.components[\"media-video\"];\n    const mediaPdf = this.networkedEl.components[\"media-pdf\"];\n    const currentContentType =\n      contentType ||\n      (mediaVideo && mediaVideo.data.contentType) ||\n      (mediaImage && mediaImage.data.contentType) ||\n      (mediaPdf && mediaPdf.data.contentType);\n\n    let matchesType = !this.data.contentTypes;\n\n    if (this.data.contentTypes && currentContentType) {\n      for (const contentType of this.data.contentTypes.split(\" \")) {\n        const targetContentType = currentContentType.toLowerCase().split(\";\")[0];\n\n        if (\n          targetContentType === contentType ||\n          (contentType.endsWith(\"/\") && targetContentType.startsWith(contentType))\n        ) {\n          matchesType = true;\n          break;\n        }\n      }\n    }\n\n    const matchesSubtype =\n      !this.data.contentSubtype ||\n      (mediaLoader.data.contentSubtype && mediaLoader.data.contentSubtype === this.data.contentSubtype);\n    const matches = !!(matchesType && matchesSubtype);\n    this.el.object3D.visible = this.data.visible ? matches : !matches;\n  }\n});\n","AFRAME.registerComponent(\"visible-if-permitted\", {\n  schema: {\n    type: \"string\"\n  },\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.updateVisibility();\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\n  },\n  updateVisibility() {\n    this.el.object3D.visible = this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data);\n  },\n  remove() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\n  }\n});\n","/**\n * Toggles the visibility of this entity based on networked ownership\n * @namespace ui\n * @component visible-to-owner\n */\nAFRAME.registerComponent(\"visible-to-owner\", {\n  init() {\n    this.onStateChange = e => {\n      this.el.setAttribute(\"visible\", e.detail.newOwner === NAF.clientId);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      el.addEventListener(\"ownership-changed\", this.onStateChange);\n      this.el.setAttribute(\"visible\", NAF.utils.isMine(el));\n    });\n  }\n});\n","let bit = 0;\nconst nextBit = () => 1 << bit++;\nconst CL = {\n  ALL: -1,\n  NONE: 0,\n  INTERACTABLES: nextBit(),\n  ENVIRONMENT: nextBit(),\n  AVATAR: nextBit(),\n  HANDS: nextBit(),\n  MEDIA_FRAMES: nextBit()\n};\n\n// @TODO we should split these \"sets\" off into something other than COLLISION_LAYERS or at least name\n// them differently to indicate they are a combination of multiple bits\nCL.DEFAULT_INTERACTABLE = CL.INTERACTABLES | CL.ENVIRONMENT | CL.AVATAR | CL.HANDS | CL.MEDIA_FRAMES;\nCL.UNOWNED_INTERACTABLE = CL.INTERACTABLES | CL.HANDS | CL.MEDIA_FRAMES;\nCL.DEFAULT_SPAWNER = CL.INTERACTABLES | CL.HANDS;\n\nconst PRIVACY = \"https://www.mozilla.org/en-US/privacy/hubs/\";\nconst TERMS = \"https://www.mozilla.org/en-US/about/legal/terms/hubs/\";\n\nmodule.exports = {\n  COLLISION_LAYERS: CL,\n  PRIVACY,\n  TERMS\n};\n","// Primary language tags for those languages we support\nexport const AVAILABLE_LOCALES = {\n  en: \"English\",\n  \"zh-cn\": \"简体中文\",\n  pt: \"Portugês (Brasil)\",\n  ja: \"日本語\",\n  es: \"Español\",\n  ru: \"Pусский\",\n  fr: \"Français\",\n  ko: \"한국어\",\n  de: \"Deutsch\",\n  \"zh-tw\": \"繁體中文\"\n};\n\n// Map from alternative primary language tags to those we support\nexport const FALLBACK_LOCALES = {\n  jp: \"ja\"\n};\n","import configs from \"./configs\";\nimport { AVAILABLE_LOCALES, FALLBACK_LOCALES } from \"../assets/locales/locale_config\";\n\n// These are set in the admin panel and are only included as fallbacks.\nconst defaultLocaleData = {\n  \"app-name\": \"App\",\n  \"editor-name\": \"Scene Editor\",\n  \"contact-email\": \"app@company.com\",\n  \"company-name\": \"Company\",\n  \"share-hashtag\": \"#app\",\n  \"app-description\": \"Gather share and collaborate together in a virtual, private and safe space\",\n  \"app-tagline\": \"Private social VR in your web browser\"\n};\n\nconst DEFAULT_LOCALE = \"en\";\nconst cachedMessages = new Map();\n\nlet _locale = DEFAULT_LOCALE;\nlet _localeData = defaultLocaleData;\n\nfunction findLocale(locale) {\n  const locales = (() => {\n    if (navigator.languages) {\n      return [...navigator.languages];\n    }\n    if (navigator.language) {\n      return [navigator.language];\n    }\n    if (navigator.userLanguage) {\n      return [navigator.userLanguage];\n    }\n  })();\n\n  if (locale && locale !== \"browser\") {\n    locales.unshift(locale);\n  }\n\n  for (let i = 0; i < locales.length; i++) {\n    const curLocale = locales[i];\n    if (AVAILABLE_LOCALES.hasOwnProperty(curLocale)) {\n      return curLocale;\n    }\n    if (FALLBACK_LOCALES.hasOwnProperty(curLocale)) {\n      FALLBACK_LOCALES.hasOwnProperty(curLocale);\n    }\n    // Also check the primary language subtag in case\n    // we do not have an entry for full tag\n    // See https://en.wikipedia.org/wiki/IETF_language_tag#Syntax_of_language_tags\n    // and https://github.com/mozilla/hubs/pull/3350/files#diff-70ef5717d3da03ef288e8d15c2fda32c5237d7f37074421496f22403e4475bf1R16\n    const primaryLanguageSubtag = curLocale.split(\"-\")[0].toLowerCase();\n    if (AVAILABLE_LOCALES.hasOwnProperty(primaryLanguageSubtag)) {\n      return primaryLanguageSubtag;\n    }\n    if (FALLBACK_LOCALES.hasOwnProperty(primaryLanguageSubtag)) {\n      return FALLBACK_LOCALES[primaryLanguageSubtag];\n    }\n  }\n  return DEFAULT_LOCALE;\n}\n\nexport function setLocale(locale) {\n  const resolvedLocale = findLocale(locale);\n\n  if (resolvedLocale === DEFAULT_LOCALE) {\n    _locale = resolvedLocale;\n    _localeData = defaultLocaleData;\n    window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n  } else {\n    if (cachedMessages.has(resolvedLocale)) {\n      _locale = resolvedLocale;\n      window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n    } else {\n      import(`../assets/locales/${resolvedLocale}.json`).then(({ default: localeData }) => {\n        _locale = resolvedLocale;\n        _localeData = localeData;\n        window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n      });\n    }\n  }\n}\n\nconst interval = window.setInterval(() => {\n  if (window.APP && window.APP.store) {\n    window.clearInterval(interval);\n    setLocale(window.APP.store.state.preferences.locale);\n    window.APP.store.addEventListener(\"statechanged\", () => {\n      setLocale(window.APP.store.state.preferences.locale);\n    });\n  }\n}, 100);\n\nexport const getLocale = () => {\n  return _locale;\n};\n\nexport const getMessage = key => {\n  return _localeData[key];\n};\n\n// TODO: This should be removed, lets not inject app config data up front but rather via variables so that defaultMessage works properly.\nexport const getMessages = () => {\n  if (cachedMessages.has(_locale)) {\n    return cachedMessages.get(_locale);\n  }\n\n  // Swap in translations specified via the admin panel\n  if (configs.APP_CONFIG && configs.APP_CONFIG.translations && configs.APP_CONFIG.translations[_locale]) {\n    const configTranslations = configs.APP_CONFIG.translations[_locale];\n    for (const messageKey in configTranslations) {\n      if (!configTranslations.hasOwnProperty(messageKey)) continue;\n      if (!configTranslations[messageKey]) continue;\n      _localeData[messageKey] = configTranslations[messageKey];\n    }\n  }\n\n  const entries = [];\n  for (const key in _localeData) {\n    if (!_localeData.hasOwnProperty(key)) continue;\n    entries.push([key, _localeData[key]]);\n  }\n\n  const messages = entries\n    .map(([key, message]) => [\n      key,\n      // Replace nested message keys (e.g. %app-name%) with their messages.\n      message.replace(/%([\\w-.]+)%/i, (_match, subkey) => _localeData[subkey])\n    ])\n    .reduce((acc, entry) => {\n      acc[entry[0]] = entry[1];\n      return acc;\n    }, {});\n\n  cachedMessages.set(_locale, messages);\n  return messages;\n};\n","import appLogo from \"../assets/images/app-logo.png\";\nimport appLogoDark from \"../assets/images/app-logo-dark.png\";\nimport companyLogo from \"../assets/images/company-logo.png\";\nimport homeHeroBackground from \"../assets/images/home-hero-background-unbranded.png\";\nimport sceneEditorLogo from \"../assets/images/editor-logo.png\";\nimport { getLocale, getMessage } from \"./i18n\";\n\n// Read configs from global variable if available, otherwise use the process.env injected from build.\nconst configs = {};\nlet isAdmin = false;\n[\n  \"RETICULUM_SERVER\",\n  \"THUMBNAIL_SERVER\",\n  \"CORS_PROXY_SERVER\",\n  \"NON_CORS_PROXY_DOMAINS\",\n  \"SENTRY_DSN\",\n  \"GA_TRACKING_ID\",\n  \"SHORTLINK_DOMAIN\",\n  \"BASE_ASSETS_PATH\",\n  \"UPLOADS_HOST\"\n].forEach(x => {\n  const el = document.querySelector(`meta[name='env:${x.toLowerCase()}']`);\n  configs[x] = el ? el.getAttribute(\"content\") : process.env[x];\n\n  const BASE_ASSETS_PATH_KEY = \"BASE_ASSETS_PATH\";\n  if (x === BASE_ASSETS_PATH_KEY && configs[BASE_ASSETS_PATH_KEY]) {\n    // BASE_ASSETS_PATH might be a relative URL like \"/\" when it is set in\n    // .env or .defaults.env when running locally. We need to convert that\n    // to an absolute URL.\n    if (!configs[BASE_ASSETS_PATH_KEY].startsWith(\"http\")) {\n      configs[BASE_ASSETS_PATH_KEY] = new URL(configs[BASE_ASSETS_PATH_KEY], window.location).toString();\n    }\n\n    // eslint-disable-next-line no-undef\n    __webpack_public_path__ = configs[BASE_ASSETS_PATH_KEY];\n  }\n});\n\n// Custom clients do not use <meta> tags for passing data, so if thumbnail_server meta tag exists, it is not a custom client\nconst hasThumbnailServerMetaTag = !!document.querySelector(\"meta[name='env:thumbnail_server']\");\nconfigs.IS_LOCAL_OR_CUSTOM_CLIENT = !hasThumbnailServerMetaTag;\n\n// Also include configs that reticulum injects as a script in the page head.\n\nconfigs.AVAILABLE_INTEGRATIONS = window.AVAILABLE_INTEGRATIONS || {};\n\nif (process.env.APP_CONFIG) {\n  window.APP_CONFIG = process.env.APP_CONFIG;\n}\n\nif (window.APP_CONFIG) {\n  configs.APP_CONFIG = window.APP_CONFIG;\n  const { theme } = configs.APP_CONFIG;\n  if (theme) {\n    const colorVars = [];\n    for (const key in theme) {\n      if (!theme.hasOwnProperty(key)) continue;\n      colorVars.push(`--${key}: ${theme[key]};`);\n    }\n    const style = document.createElement(\"style\");\n    style.innerHTML = `:root{${colorVars.join(\"\\n\")}}`;\n    document.head.insertBefore(style, document.head.firstChild);\n  }\n\n  if (!configs.APP_CONFIG.features) {\n    configs.APP_CONFIG.features = {};\n  }\n} else {\n  configs.APP_CONFIG = {\n    features: {}\n  };\n}\n\nconst isLocalDevelopment = process.env.NODE_ENV === \"development\";\n\nconfigs.feature = featureName => {\n  const value = configs.APP_CONFIG && configs.APP_CONFIG.features && configs.APP_CONFIG.features[featureName];\n  if (typeof value === \"boolean\" || featureName === \"enable_spoke\") {\n    const forceEnableSpoke = featureName === \"enable_spoke\" && isAdmin;\n    return forceEnableSpoke || value;\n  } else {\n    return value;\n  }\n};\n\nlet localDevImages = {};\nif (isLocalDevelopment) {\n  localDevImages = {\n    logo: appLogo,\n    logo_dark: appLogoDark,\n    company_logo: companyLogo,\n    editor_logo: sceneEditorLogo,\n    home_background: homeHeroBackground\n  };\n}\n\nconfigs.image = (imageName, cssUrl) => {\n  const url =\n    (configs.APP_CONFIG && configs.APP_CONFIG.images && configs.APP_CONFIG.images[imageName]) ||\n    localDevImages[imageName];\n  return url && cssUrl ? `url(${url})` : url;\n};\n\nconfigs.link = (linkName, defaultValue) => {\n  return (configs.APP_CONFIG && configs.APP_CONFIG.links && configs.APP_CONFIG.links[linkName]) || defaultValue;\n};\n\nconfigs.setIsAdmin = _isAdmin => {\n  isAdmin = _isAdmin;\n};\nconfigs.isAdmin = () => isAdmin;\n\nconfigs.integration = integration => {\n  const availableIntegrations = configs.AVAILABLE_INTEGRATIONS;\n  // AVAILABLE_INTEGRATIONS has no properties defined on the dev server, but does support all integrations.\n  return !availableIntegrations.hasOwnProperty(integration) || availableIntegrations[integration];\n};\n\nconfigs.translation = key => {\n  const locale = getLocale();\n  const translationsConfig = (configs.APP_CONFIG && configs.APP_CONFIG.translations) || {};\n\n  return (\n    (translationsConfig[locale] && translationsConfig[locale][key]) ||\n    (translationsConfig.en && translationsConfig.en[key]) ||\n    getMessage(key) ||\n    \"\"\n  );\n};\n\nexport default configs;\n","import configs from \"./configs\";\nexport function getCurrentHubId() {\n  const qs = new URLSearchParams(location.search);\n  const defaultRoomId = configs.feature(\"default_room_id\");\n\n  return (\n    qs.get(\"hub_id\") ||\n    (document.location.pathname === \"/\" && defaultRoomId\n      ? defaultRoomId\n      : document.location.pathname.substring(1).split(\"/\")[0])\n  );\n}\n\nexport function updateVRHudPresenceCount({ presence }) {\n  const occupantCount = Object.getOwnPropertyNames(presence.state).length;\n  const vrHudPresenceCount = document.querySelector(\"#hud-presence-count\");\n  vrHudPresenceCount.setAttribute(\"text\", \"value\", occupantCount.toString());\n}\nexport function updateSceneCopresentState(presence, scene) {\n  const occupantCount = Object.getOwnPropertyNames(presence.state).length;\n  if (occupantCount > 1) {\n    scene.addState(\"copresent\");\n  } else {\n    scene.removeState(\"copresent\");\n  }\n}\n\nexport function createHubChannelParams({\n  permsToken,\n  profile,\n  pushSubscriptionEndpoint,\n  isMobile,\n  isMobileVR,\n  isEmbed,\n  hubInviteId,\n  authToken\n}) {\n  return {\n    profile,\n    push_subscription_endpoint: pushSubscriptionEndpoint,\n    auth_token: authToken || null,\n    perms_token: permsToken || null,\n    context: {\n      mobile: isMobile || isMobileVR,\n      embed: isEmbed,\n      hmd: isMobileVR\n    },\n    hub_invite_id: hubInviteId\n  };\n}\n","import { themes } from \"../react-components/styles/theme\";\n\nexport function getColorSchemePref() {\n  const darkmodeQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n  const darkMode = darkmodeQuery.matches;\n  return (darkMode && themes.find(t => t.darkModeDefault)) || themes.find(t => t.default);\n}\n","import { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { getColorSchemePref } from \"../../utils/get-color-scheme-pref\";\nimport configs from \"../../utils/configs\";\n\nlet config = process.env.APP_CONFIG;\n\n// Storybook includes environment variables as a string\n// https://storybook.js.org/docs/react/configure/environment-variables\nif (!config && process.env.STORYBOOK_APP_CONFIG) {\n  config = JSON.parse(process.env.STORYBOOK_APP_CONFIG);\n}\n\nif (!config) {\n  config = window.APP_CONFIG;\n}\n\nif (config?.theme?.error) {\n  console.error(\n    `Custom themes failed to load.\\n${config.theme.error}\\nIf you are an admin, reconfigure your themes in the admin panel.`\n  );\n}\n\nexport const defaultTheme = \"default\";\n\nexport const themes = config?.theme?.themes || [];\n\nfunction useDarkMode() {\n  const [darkMode, setDarkMode] = useState(false);\n\n  const changeListener = useCallback(\n    event => {\n      setDarkMode(event.matches);\n    },\n    [setDarkMode]\n  );\n\n  useEffect(() => {\n    const darkmodeQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n\n    setDarkMode(darkmodeQuery.matches);\n\n    // This is a workaround for old Safari.\n    // Prior to Safari 14, MediaQueryList is based on EventTarget, so you must use\n    // addListener() and removeListener() to observe media query lists.\n    // https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/addListener\n    // We may remove this workaround when no one will use Safari 13 or before.\n    if (darkmodeQuery.addEventListener) {\n      darkmodeQuery.addEventListener(\"change\", changeListener);\n    } else {\n      darkmodeQuery.addListener(changeListener);\n    }\n\n    return () => {\n      if (darkmodeQuery.removeEventListener) {\n        darkmodeQuery.removeEventListener(\"change\", changeListener);\n      } else {\n        darkmodeQuery.removeListener(changeListener);\n      }\n    };\n  }, [changeListener]);\n\n  return darkMode;\n}\n\nexport function useTheme(themeId) {\n  const darkMode = useDarkMode();\n\n  useEffect(() => {\n    // Themes can come from an external source. Ensure it is an array.\n    if (!Array.isArray(themes)) return;\n\n    let theme;\n\n    if (themeId) {\n      theme = themes.find(t => t.id === themeId);\n    }\n\n    if (!theme && darkMode) {\n      theme = themes.find(t => t.darkModeDefault);\n    }\n\n    if (!theme) {\n      theme = themes.find(t => t.default);\n    }\n\n    if (!theme) {\n      return;\n    }\n\n    const variables = [];\n\n    for (const key in theme.variables) {\n      if (!theme.variables.hasOwnProperty(key)) continue;\n      variables.push(`--${key}: ${theme.variables[key]};`);\n    }\n\n    const styleTag = document.createElement(\"style\");\n\n    styleTag.innerHTML = `:root {\n        ${variables.join(\"\\n\")}\n      }`;\n\n    document.head.appendChild(styleTag);\n\n    return () => {\n      document.head.removeChild(styleTag);\n    };\n  }, [themeId, darkMode]);\n}\n\nfunction getCurrentTheme() {\n  if (!Array.isArray(themes)) return;\n\n  const preferredThemeId = window.APP?.store?.state?.preferences?.theme;\n  if (preferredThemeId) {\n    return themes.find(t => t.id === preferredThemeId);\n  } else {\n    return getColorSchemePref();\n  }\n}\n\nfunction getAppLogo(darkMode) {\n  const theme = getCurrentTheme();\n  const shouldUseDarkLogo = theme ? theme.darkModeDefault : darkMode;\n  return (shouldUseDarkLogo && configs.image(\"logo_dark\")) || configs.image(\"logo\");\n}\n\nexport function useLogo() {\n  const darkMode = useDarkMode();\n  return getAppLogo(darkMode);\n}\n\nexport function useThemeFromStore(store) {\n  const [themeId, setThemeId] = useState(store?.state?.preferences?.theme);\n\n  useEffect(() => {\n    function onStoreChanged() {\n      const nextThemeId = store.state?.preferences?.theme;\n\n      if (themeId !== nextThemeId) {\n        setThemeId(nextThemeId);\n      }\n    }\n\n    if (store) {\n      store.addEventListener(\"statechanged\", onStoreChanged);\n    }\n\n    return () => {\n      if (store) {\n        store.removeEventListener(\"statechanged\", onStoreChanged);\n      }\n    };\n  });\n\n  useTheme(themeId);\n}\n\nexport function ThemeProvider({ store, children }) {\n  useThemeFromStore(store);\n  return children;\n}\n\nThemeProvider.propTypes = {\n  store: PropTypes.object,\n  children: PropTypes.node\n};\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n\nexport const waitForDOMContentLoaded = function() {\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\n    return Promise.resolve(null);\n  } else {\n    return waitForEvent(\"DOMContentLoaded\", window);\n  }\n};\n\nexport const sleep = function(milliseconds) {\n  return new Promise(resolve => {\n    setTimeout(resolve, milliseconds);\n  });\n};\n","import { themes } from \"../react-components/styles/theme\";\nimport { waitForDOMContentLoaded } from \"./async-utils\";\nimport configs from \"./configs\";\n\n// Node these should be synchronized with the top of shared.scss\nconst DEFAULT_ACTION_COLOR = \"#FF3464\";\nconst DEFAULT_ACTION_COLOR_LIGHT = \"#FF74A4\";\n\nconst DEFAULT_COLORS = {\n  \"action-color\": DEFAULT_ACTION_COLOR,\n  \"action-label-color\": DEFAULT_ACTION_COLOR,\n  \"action-color-disabled\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-color-highlight\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-text-color\": \"#FFFFFF\",\n  \"action-subtitle-color\": \"#F0F0F0\",\n  \"notice-background-color\": \"#2F80ED\",\n  \"notice-text-color\": \"#FFFFFF\",\n  \"favorited-color\": \"#FFC000\",\n  \"nametag-color\": \"#000000\",\n  \"nametag-volume-color\": \"#7ED320\",\n  \"nametag-text-color\": \"#FFFFFF\",\n  \"nametag-border-color\": \"#7ED320\",\n  \"nametag-border-color-raised-hand\": \"#FFCD74\"\n};\n\nfunction getThemeColor(name) {\n  const themeId = window.APP?.store?.state?.preferences?.theme;\n\n  const theme =\n    (themeId && configs.APP_CONFIG?.theme?.themes?.find(theme => theme.id === themeId)) ||\n    configs.APP_CONFIG?.theme?.themes?.find(theme => theme.default === true);\n  if (theme?.variables?.[name]) {\n    return theme.variables[name];\n  }\n\n  return DEFAULT_COLORS[name];\n}\n\nfunction activateTheme() {\n  const actionColor = getThemeColor(\"action-color\");\n  const actionHoverColor = getThemeColor(\"action-color-highlight\");\n\n  if (document.querySelector(\"#rounded-text-button\")) {\n    // NOTE, using the object-based {} setAttribute variant in a-frame\n    // seems to not work in Firefox here -- the entities with the mixins are not\n    // updated.\n    document\n      .querySelector(\"#rounded-text-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-text-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n\n    document\n      .querySelector(\"#rounded-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n  }\n\n  window.dispatchEvent(new CustomEvent(\"update_theme\"));\n}\n\nconst onStoreChanged = (function() {\n  let themeId;\n  return function onStoreChanged() {\n    const newThemeId = window.APP?.store?.state?.preferences?.theme;\n    if (themeId !== newThemeId) {\n      themeId = newThemeId;\n      activateTheme();\n    }\n  };\n})();\n\nwaitForDOMContentLoaded().then(() => {\n  if (configs.APP_CONFIG && configs.APP_CONFIG.theme && configs.APP_CONFIG.theme[\"dark-theme\"]) {\n    document.body.classList.add(\"dark-theme\");\n  } else {\n    document.body.classList.add(\"light-theme\");\n  }\n  activateTheme();\n  window.APP?.store?.addEventListener(\"statechanged\", onStoreChanged);\n});\n\nfunction applyThemeToTextButton(el, highlighted) {\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundColor\",\n    highlighted ? getThemeColor(\"action-color-highlight\") : getThemeColor(\"action-color\")\n  );\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundHoverColor\",\n    highlighted ? \"#aaa\" : getThemeColor(\"action-color-highlight\")\n  );\n}\n\nfunction getDefaultTheme() {\n  return themes.find(t => t.default) || themes[0];\n}\n\nexport { applyThemeToTextButton, getThemeColor, getDefaultTheme };\n","// from https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\nfunction detectTouchScreen() {\n  let hasTouchScreen = false;\n  if (\"maxTouchPoints\" in navigator) {\n    hasTouchScreen = navigator.maxTouchPoints > 0;\n  } else if (\"msMaxTouchPoints\" in navigator) {\n    hasTouchScreen = navigator.msMaxTouchPoints > 0;\n  } else {\n    const mQ = window.matchMedia && matchMedia(\"(pointer:coarse)\");\n    if (mQ && mQ.media === \"(pointer:coarse)\") {\n      hasTouchScreen = !!mQ.matches;\n    } else if (\"orientation\" in window) {\n      hasTouchScreen = true; // deprecated, but good fallback\n    } else {\n      // Only as a last resort, fall back to user agent sniffing\n      const UA = navigator.userAgent;\n      hasTouchScreen =\n        /\\b(BlackBerry|webOS|iPhone|IEMobile)\\b/i.test(UA) || /\\b(Android|Windows Phone|iPad|iPod)\\b/i.test(UA);\n    }\n  }\n  return hasTouchScreen;\n}\n\nlet hackyMobileSafariTestValue = null;\n\n// HACK for https://github.com/mozilla/hubs/issues/1813\n// Touchscreen controls depend on iPad and iPhone detection,\n// which recently regressed. For UA matching \"Macintosh\", enable\n// touchscreen controls if there exists a touchscreen.\n// We cannot always enable touchscreen controls when a touchscreen\n// is present until we fix conflicts between simultaneous mouse\n// and touchscreen interactions.\nexport function hackyMobileSafariTest() {\n  if (hackyMobileSafariTestValue === null) {\n    hackyMobileSafariTestValue = /\\b(Macintosh|iPad|iPhone)\\b/i.test(navigator.userAgent) && detectTouchScreen();\n  }\n\n  return hackyMobileSafariTestValue;\n  // e.g. Match\n  // Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.1 Safari/605.1.15\n  // but not\n  // \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36\"\n}\n","import { hackyMobileSafariTest } from \"./detect-touchscreen\";\n\nconst MOBILE_RE = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i;\nconst TABLET_RE = /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;\n\nexport function isAndroid() {\n  return /Android/.test(window.navigator.userAgent);\n}\n\n// from https://stackoverflow.com/questions/57776001/how-to-detect-ipad-pro-as-ipad-using-javascript\nfunction isIpadOS() {\n  return window.navigator.maxTouchPoints && window.navigator.maxTouchPoints > 2 && /MacIntel/.test(navigator.platform);\n}\n\n// lifted from https://github.com/aframevr/aframe/blob/master/src/utils/device.js to ensure consistency\nexport function isIOS() {\n  return /iPad|iPhone|iPod/.test(window.navigator.platform) || isIpadOS();\n}\n\nfunction isTablet(mockUserAgent) {\n  const userAgent = mockUserAgent || window.navigator.userAgent;\n  return isIpadOS() || /ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(userAgent);\n}\n\nfunction isR7() {\n  return /R7 Build/.test(window.navigator.userAgent);\n}\n\nfunction isOculusBrowser() {\n  return /(OculusBrowser)/i.test(window.navigator.userAgent);\n}\n\nfunction isFirefoxReality() {\n  return /(Mobile VR)/i.test(window.navigator.userAgent);\n}\n\nexport function isMobileVR() {\n  return isOculusBrowser() || isFirefoxReality();\n}\n\nconst isMobile = (function() {\n  let _isMobile = false;\n  (function(a) {\n    // eslint-disable-next-line no-useless-escape\n    if (MOBILE_RE.test(a) || TABLET_RE.test(a.substr(0, 4))) {\n      _isMobile = true;\n    }\n    if (isIOS() || isTablet() || isR7()) {\n      _isMobile = true;\n    }\n    if (hackyMobileSafariTest()) {\n      _isMobile = true;\n    }\n    if (isMobileVR()) {\n      _isMobile = false;\n    }\n  })(window.navigator.userAgent || window.navigator.vendor || window.opera);\n\n  return function() {\n    return _isMobile;\n  };\n})();\n\nexport default isMobile;\n","import isMobile from \"./is-mobile\";\n\n/**\n * Checks if browser is mobile and not stand-alone dedicated vr device.\n * @return {Boolean} True if mobile browser detected.\n */\nAFRAME.utils.device.isMobile = isMobile;\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*,naf-dialog-adapter:*,mediasoup*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer({ forceWebVR: true });\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.getContext().getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n\nexport function getWebGLVersion(renderer) {\n  const gl = renderer.getContext();\n  return gl.getParameter(gl.VERSION).split(\" \")[1];\n}\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport defaultAvatar from \"../assets/models/DefaultAvatar.glb\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction chooseRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${chooseRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport async function fetchRandomDefaultAvatarId() {\n  const defaultAvatarEndpoint = \"/api/v1/media/search?filter=default&source=avatar_listings\";\n  const defaultAvatars = (await fetchReticulumAuthenticated(defaultAvatarEndpoint)).entries || [];\n  if (defaultAvatars.length === 0) {\n    // If reticulum doesn't return any default avatars, just default to the duck model. This should only happen\n    // when running against a fresh reticulum server, e.g. a local ret instance.\n    return new URL(defaultAvatar, location.href).href;\n  }\n  const avatarIds = defaultAvatars.map(avatar => avatar.id);\n  return chooseRandom(avatarIds);\n}\n","export const MediaDevicesEvents = Object.freeze({\n  PERMISSIONS_STATUS_CHANGED: \"permissions_status_changed\",\n  MIC_SHARE_STARTED: \"mic_share_started\",\n  MIC_SHARE_ENDED: \"mic_share_ended\",\n  VIDEO_SHARE_STARTED: \"video_share_started\",\n  VIDEO_SHARE_ENDED: \"video_share_ended\",\n  DEVICE_CHANGE: \"devicechange\"\n});\n\nexport const PermissionStatus = Object.freeze({\n  GRANTED: \"granted\",\n  DENIED: \"denied\",\n  PROMPT: \"prompt\"\n});\n\nexport const MediaDevices = Object.freeze({\n  MICROPHONE: \"microphone\",\n  SPEAKERS: \"speakers\",\n  CAMERA: \"camera\",\n  SCREEN: \"screen\"\n});\n\nexport const NO_DEVICE_ID = \"none\";\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\nimport { qsGet } from \"../utils/qs_truthy.js\";\nimport detectMobile, { isAndroid, isMobileVR } from \"../utils/is-mobile\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { fetchRandomDefaultAvatarId, generateRandomName } from \"../utils/identity.js\";\nimport { NO_DEVICE_ID } from \"../utils/media-devices-utils.js\";\nimport { getDefaultTheme } from \"../utils/theme.js\";\n\nconst defaultMaterialQuality = (function() {\n  const MATERIAL_QUALITY_OPTIONS = [\"low\", \"medium\", \"high\"];\n\n  // HACK: AFRAME is not available on all pages, so we catch the ReferenceError.\n  // We could move AFRAME's device utils into a separate package (or into this repo)\n  // if we wanted to use these checks without having to import all of AFRAME.\n  const isMobile = window.AFRAME && (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR());\n  if (isMobile) {\n    const qsMobileDefault = qsGet(\"default_mobile_material_quality\");\n    if (qsMobileDefault && MATERIAL_QUALITY_OPTIONS.indexOf(qsMobileDefault) !== -1) {\n      return qsMobileDefault;\n    }\n    return \"low\";\n  }\n\n  const qsDefault = qsGet(\"default_material_quality\");\n  if (qsDefault && MATERIAL_QUALITY_OPTIONS.indexOf(qsDefault) !== -1) {\n    return qsDefault;\n  }\n\n  return \"high\";\n})();\n\n// WebAudio on Android devices (only non-VR devices?) seems to have\n// a bug and audio can be broken if there are many people in a room.\n// We have reported the problem to the Android devs. We found that\n// using equal power panning mode can mitigate the problem so we\n// use low audio panning quality (= equal power mode) by default\n// on Android as workaround until the root issue is fixed on\n// Android end. See\n//   - https://github.com/mozilla/hubs/issues/5057\n//   - https://bugs.chromium.org/p/chromium/issues/detail?id=1308962\nconst defaultAudioPanningQuality = () => {\n  return isAndroid() && !isMobileVR() ? \"Low\" : \"High\";\n};\n\n//workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1626081 : disable echoCancellation, noiseSuppression, autoGainControl\nconst isFirefoxReality = window.AFRAME?.utils.device.isMobileVR() && navigator.userAgent.match(/Firefox/);\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z가-힣0-9_~ -]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        // personalAvatarId is obsolete, but we need it here for backwards compatibility.\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" },\n        hasOpenedShare: { type: \"boolean\" },\n        entryCount: { type: \"number\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" },\n        micMuted: { type: \"bool\" }\n      }\n    },\n\n    preferences: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        shouldPromptForRefresh: { type: \"bool\", default: false },\n        // Preferred media will be set dynamically\n        preferredMic: { type: \"string\", default: NO_DEVICE_ID },\n        preferredSpeakers: { type: \"string\", default: NO_DEVICE_ID },\n        preferredCamera: { type: \"string\", default: NO_DEVICE_ID },\n        muteMicOnEntry: { type: \"bool\", default: false },\n        disableLeftRightPanning: { type: \"bool\", default: false },\n        audioNormalization: { type: \"bool\", default: 0.0 },\n        invertTouchscreenCameraMove: { type: \"bool\", default: true },\n        enableOnScreenJoystickLeft: { type: \"bool\", default: detectMobile() },\n        enableOnScreenJoystickRight: { type: \"bool\", default: detectMobile() },\n        enableGyro: { type: \"bool\", default: true },\n        animateWaypointTransitions: { type: \"bool\", default: true },\n        showFPSCounter: { type: \"bool\", default: false },\n        allowMultipleHubsInstances: { type: \"bool\", default: false },\n        disableIdleDetection: { type: \"bool\", default: false },\n        fastRoomSwitching: { type: \"bool\", default: false },\n        lazyLoadSceneMedia: { type: \"bool\", default: false },\n        preferMobileObjectInfoPanel: { type: \"bool\", default: false },\n        // if unset, maxResolution = screen resolution\n        maxResolutionWidth: { type: \"number\", default: undefined },\n        maxResolutionHeight: { type: \"number\", default: undefined },\n        globalVoiceVolume: { type: \"number\", default: 100 },\n        globalMediaVolume: { type: \"number\", default: 100 },\n        globalSFXVolume: { type: \"number\", default: 100 },\n        snapRotationDegrees: { type: \"number\", default: 45 },\n        materialQualitySetting: { type: \"string\", default: defaultMaterialQuality },\n        enableDynamicShadows: { type: \"bool\", default: false },\n        disableSoundEffects: { type: \"bool\", default: false },\n        disableMovement: { type: \"bool\", default: false },\n        disableBackwardsMovement: { type: \"bool\", default: false },\n        disableStrafing: { type: \"bool\", default: false },\n        disableTeleporter: { type: \"bool\", default: false },\n        disableAutoPixelRatio: { type: \"bool\", default: false },\n        movementSpeedModifier: { type: \"number\", default: 1 },\n        disableEchoCancellation: { type: \"bool\", default: isFirefoxReality },\n        disableNoiseSuppression: { type: \"bool\", default: isFirefoxReality },\n        disableAutoGainControl: { type: \"bool\", default: isFirefoxReality },\n        locale: { type: \"string\", default: \"browser\" },\n        showRtcDebugPanel: { type: \"bool\", default: false },\n        showAudioDebugPanel: { type: \"bool\", default: false },\n        enableAudioClipping: { type: \"bool\", default: false },\n        audioClippingThreshold: { type: \"number\", default: 0.015 },\n        audioPanningQuality: { type: \"string\", default: defaultAudioPanningQuality() },\n        theme: { type: \"string\", default: getDefaultTheme()?.name },\n        cursorSize: { type: \"number\", default: 1 },\n        nametagVisibility: { type: \"string\", default: \"showAll\" },\n        nametagVisibilityDistance: { type: \"number\", default: 5 },\n        avatarVoiceLevels: { type: \"object\" }\n      }\n    },\n\n    // Legacy\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    confirmedBroadcastedRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    },\n\n    embedTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          embedToken: { type: \"string\" }\n        }\n      }\n    },\n\n    onLoadActions: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          action: { type: \"string\" },\n          args: { type: \"object\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    preferences: { $ref: \"#/definitions/preferences\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    this._preferences = {};\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n\n    // When storage is updated in another window\n    window.addEventListener(\"storage\", e => {\n      if (e.key !== LOCAL_STORE_KEY) return;\n      delete this[STORE_STATE_CACHE_KEY];\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    });\n\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      confirmedBroadcastedRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: [],\n      embedTokens: [],\n      onLoadActions: [],\n      preferences: {}\n    });\n\n    this._shouldResetAvatarOnInit = false;\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this._shouldResetAvatarOnInit = true;\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n\n    this._signOutOnExpiredAuthToken();\n\n    const maybeDispatchThemeChanged = (() => {\n      let previous;\n      return () => {\n        const current = this.state.preferences.theme;\n        if ((previous || current) && previous !== current) {\n          this.dispatchEvent(new CustomEvent(\"themechanged\", { detail: { current, previous } }));\n        }\n        previous = current;\n      };\n    })();\n    this.addEventListener(\"statechanged\", maybeDispatchThemeChanged);\n  }\n\n  _signOutOnExpiredAuthToken = () => {\n    if (!this.state.credentials.token) return;\n\n    const expiry = jwtDecode(this.state.credentials.token).exp * 1000;\n    if (expiry <= Date.now()) {\n      this.update({ credentials: { token: null, email: null } });\n    }\n  };\n\n  initProfile = async () => {\n    if (this._shouldResetAvatarOnInit) {\n      await this.resetToRandomDefaultAvatar();\n    } else {\n      this.update({\n        profile: { avatarId: await fetchRandomDefaultAvatarId(), ...(this.state.profile || {}) }\n      });\n    }\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomDefaultAvatar = async () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), avatarId: await fetchRandomDefaultAvatarId() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      const state = (this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY)));\n      if (!state.preferences) state.preferences = {};\n      this._preferences = { ...state.preferences }; // cache prefs without injected defaults\n      // inject default values\n      for (const [key, props] of Object.entries(SCHEMA.definitions.preferences.properties)) {\n        if (!props.hasOwnProperty(\"default\")) continue;\n        if (!state.preferences.hasOwnProperty(key)) {\n          state.preferences[key] = props.default;\n        } else if (state.preferences[key] === props.default) {\n          delete this._preferences[key];\n        }\n      }\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedBroadcastedRooms() {\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\n  }\n\n  resetTipActivityFlags() {\n    this.update({\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\n    });\n  }\n\n  bumpEntryCount() {\n    const currentEntryCount = this.state.activity.entryCount || 0;\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\n  }\n\n  // Sets a one-time action to perform the next time the page loads\n  enqueueOnLoadAction(action, args) {\n    this.update({ onLoadActions: [{ action, args }] });\n  }\n\n  executeOnLoadActions(sceneEl) {\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\n      const { action, args } = this.state.onLoadActions[i];\n\n      if (action === \"emit_scene_event\") {\n        sceneEl.emit(args.event, args.detail);\n      }\n    }\n\n    this.clearOnLoadActions();\n  }\n\n  clearOnLoadActions() {\n    this.clearStoredArray(\"onLoadActions\");\n  }\n\n  clearStoredArray(key) {\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    const update = {};\n    update[key] = [];\n\n    this.update(update, { arrayMerge: overwriteMerge });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge({ ...this.state, preferences: this._preferences }, newState, mergeOpts);\n    const { valid, errors } = validator.validate(finalState, SCHEMA);\n\n    // Cleanup unsupported properties\n    if (!valid) {\n      errors.forEach(error => {\n        console.error(`Removing invalid preference from store: ${error.message}`);\n        delete error.instance[error.argument];\n      });\n    }\n\n    if (newState.preferences) {\n      // clear preference if equal to default value so that, when client is updated with different defaults,\n      // new defaults will apply without user action\n      for (const [key, value] of Object.entries(finalState.preferences)) {\n        if (\n          SCHEMA.definitions.preferences.properties[key]?.hasOwnProperty(\"default\") &&\n          value === SCHEMA.definitions.preferences.properties[key].default\n        ) {\n          delete finalState.preferences[key];\n        }\n      }\n      this._preferences = finalState.preferences;\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    if (newState.profile !== undefined) {\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\n    }\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n\n  get schema() {\n    return SCHEMA;\n  }\n}\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\nimport configs from \"../utils/configs\";\nimport { sleep } from \"../utils/async-utils\";\n\nimport Store from \"../storage/store\";\n\nexport function hasReticulumServer() {\n  return !!configs.RETICULUM_SERVER;\n}\n\nexport function isLocalClient() {\n  return hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER;\n}\n\nexport function hubUrl(hubId, extraParams, slug) {\n  if (!hubId) {\n    if (isLocalClient()) {\n      hubId = new URLSearchParams(location.search).get(\"hub_id\");\n    } else {\n      hubId = location.pathname.split(\"/\")[1];\n    }\n  }\n\n  let url;\n  if (isLocalClient()) {\n    url = new URL(`/hub.html`, location.href);\n    url.searchParams.set(\"hub_id\", hubId);\n  } else {\n    const maybeSlug = slug ? `/${slug}` : \"\";\n    url = new URL(`/${hubId}${maybeSlug}`, location.href);\n  }\n\n  for (const key in extraParams) {\n    if (extraParams.hasOwnProperty(key)) {\n      url.searchParams.set(key, extraParams[key]);\n    }\n  }\n\n  return url;\n}\n\nconst resolverLink = document.createElement(\"a\");\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport function getReticulumFetchUrl(path, absolute = false, host = null, port = null) {\n  if (host || hasReticulumServer()) {\n    return `https://${host || configs.RETICULUM_SERVER}${port ? `:${port}` : \"\"}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nexport function getUploadsUrl(path, absolute = false, host = null, port = null) {\n  // If the Hubs Cloud stack is configured to use Cloudflare, we need to ignore the configured UPLOADS_HOST\n  // since reticulum will only serve uploads via the Cloudflare worker. BASE_ASSETS_PATH will have been\n  // correctly configured to use the Cloudflare worker, though we only need the hostname,\n  // not the full assets URL.\n  const isUsingCloudflare = configs.BASE_ASSETS_PATH.includes(\"workers.dev\");\n  const uploadsHost = isUsingCloudflare ? new URL(configs.BASE_ASSETS_PATH).hostname : configs.UPLOADS_HOST;\n  return uploadsHost\n    ? `https://${uploadsHost}${port ? `:${port}` : \"\"}${path}`\n    : getReticulumFetchUrl(path, absolute, host, port);\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nlet directReticulumHostAndPort;\n\nasync function refreshDirectReticulumHostAndPort() {\n  const qs = new URLSearchParams(location.search);\n  let host = qs.get(\"phx_host\");\n  const reticulumMeta = await getReticulumMeta();\n  host = host || configs.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\n  const port =\n    qs.get(\"phx_port\") ||\n    (hasReticulumServer() ? new URL(`${document.location.protocol}//${configs.RETICULUM_SERVER}`).port : \"443\");\n  directReticulumHostAndPort = { host, port };\n}\n\nexport function getDirectReticulumFetchUrl(path, absolute = false) {\n  if (!directReticulumHostAndPort) {\n    console.warn(\"Cannot call getDirectReticulumFetchUrl before connectToReticulum. Returning non-direct url.\");\n    return getReticulumFetchUrl(path, absolute);\n  }\n\n  const { host, port } = directReticulumHostAndPort;\n  return getReticulumFetchUrl(path, absolute, host, port);\n}\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function connectToReticulum(debug = false, params = null, socketClass = Socket) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    await refreshDirectReticulumHostAndPort();\n    const { host, port } = directReticulumHostAndPort;\n    const protocol =\n      qs.get(\"phx_protocol\") ||\n      configs.RETICULUM_SOCKET_PROTOCOL ||\n      (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n\n    return `${protocol}//${host}${port ? `:${port}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new socketClass(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: { \"content-type\": \"application/json\" },\n    method\n  };\n  if (token) {\n    params.headers.authorization = `bearer ${token}`;\n  }\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  const payload = { hub: { name: name || generateHubName() } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n\n    // Don't need to store the embed token if there's no creator assignment token, since that means\n    // we are the owner and will get the embed token on page load.\n    const embedToken = hub.embed_token;\n\n    if (embedToken) {\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\n    }\n  }\n\n  if (isLocalClient()) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceEntryForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0]) || {};\n}\n\nexport function getPresenceContextForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\n}\n\nfunction migrateBindings(oldChannel, newChannel) {\n  const doNotDuplicate = [\"phx_close\", \"phx_error\", \"phx_reply\", \"presence_state\", \"presence_diff\"];\n  const shouldDuplicate = event => {\n    return !event.startsWith(\"chan_reply_\") && !doNotDuplicate.includes(event);\n  };\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    if (shouldDuplicate(item.event)) {\n      newChannel.bindings.push(item);\n    }\n  }\n  newChannel.bindingRef = oldChannel.bindingRef;\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  migrateBindings(oldChannel, channel);\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n\nexport function migrateToChannel(oldChannel, newChannel) {\n  migrateBindings(oldChannel, newChannel);\n\n  return new Promise((resolve, reject) => {\n    newChannel\n      .join()\n      .receive(\"ok\", data => {\n        oldChannel.leave();\n        oldChannel.bindings = [];\n        resolve(data);\n      })\n      .receive(\"error\", data => {\n        newChannel.leave();\n        reject(data);\n      });\n  });\n}\n\nexport function discordBridgesForPresences(presences) {\n  const channels = [];\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.profile && m.profile.discordBridges) {\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n      }\n    }\n  }\n  return channels;\n}\n\nexport function hasEmbedPresences(presences) {\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.context && m.context.embed) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nexport function denoisePresence({ onJoin, onLeave, onChange }) {\n  return {\n    rawOnJoin: (key, beforeJoin, afterJoin) => {\n      if (beforeJoin === undefined) {\n        onJoin(key, afterJoin.metas[0]);\n      }\n    },\n    rawOnLeave: (key, remaining, removed) => {\n      if (remaining.metas.length === 0) {\n        onLeave(key, removed.metas[0]);\n      } else {\n        onChange(key, removed.metas[removed.metas.length - 1], remaining.metas[remaining.metas.length - 1]);\n      }\n    }\n  };\n}\n\nexport function presenceEventsForHub(events) {\n  const onJoin = (key, meta) => {\n    events.trigger(`hub:join`, { key, meta });\n  };\n  const onLeave = (key, meta) => {\n    events.trigger(`hub:leave`, { key, meta });\n  };\n  const onChange = (key, previous, current) => {\n    events.trigger(`hub:change`, { key, previous, current });\n  };\n  return {\n    onJoin,\n    onLeave,\n    onChange\n  };\n}\n\nexport const tryGetMatchingMeta = async ({ ret_pool, ret_version }, shouldAbandonMigration) => {\n  const backoffMS = 5000;\n  const randomMS = 15000;\n  const maxAttempts = 10;\n  let didMatchMeta = false;\n  let attempt = 0;\n  while (!didMatchMeta && attempt < maxAttempts && !shouldAbandonMigration()) {\n    try {\n      // Add randomness to the first request avoid flooding reticulum.\n      const delayMS = attempt * backoffMS + (attempt === 0 ? Math.random() * randomMS : 0);\n      console.log(\n        `[reconnect] Getting reticulum meta in ${Math.ceil(delayMS / 1000)} seconds.${\n          attempt ? ` (Attempt ${attempt + 1} of ${maxAttempts})` : \"\"\n        }`\n      );\n      await sleep(delayMS);\n      invalidateReticulumMeta();\n      console.log(`[reconnect] Getting reticulum meta.${attempt ? ` (Attempt ${attempt + 1} of ${maxAttempts})` : \"\"}`);\n      const { pool, version } = await getReticulumMeta();\n      didMatchMeta = ret_pool === pool && ret_version === version;\n    } catch {\n      didMatchMeta = false;\n    }\n\n    attempt = attempt + 1;\n  }\n  return didMatchMeta;\n};\n","export function transportForChannel(channel, reliable = true) {\n  return (clientId, dataType, data) => {\n    const payload = { dataType, data };\n\n    if (clientId) {\n      payload.clientId = clientId;\n    }\n\n    const isOpen = channel.socket.connectionState() === \"open\";\n\n    if (isOpen || reliable) {\n      const hasFirstSync =\n        payload.dataType === \"um\" ? payload.data.d.find(r => r.isFirstSync) : payload.data.isFirstSync;\n\n      if (hasFirstSync) {\n        if (isOpen) {\n          channel.push(\"naf\", payload);\n        } else {\n          // Memory is re-used, so make a copy\n          channel.push(\"naf\", AFRAME.utils.clone(payload));\n        }\n      } else {\n        // Optimization: Strip isFirstSync and send payload as a string to reduce server parsing.\n        // The server will not parse messages without isFirstSync keys when sent to the nafr event.\n        //\n        // The client must assume any payload that does not have a isFirstSync key is not a first sync.\n        const nafrPayload = AFRAME.utils.clone(payload);\n        if (nafrPayload.dataType === \"um\") {\n          for (let i = 0; i < nafrPayload.data.d.length; i++) {\n            delete nafrPayload.data.d[i].isFirstSync;\n          }\n        } else {\n          delete nafrPayload.data.isFirstSync;\n        }\n\n        channel.push(\"nafr\", { naf: JSON.stringify(nafrPayload) });\n      }\n    }\n  };\n}\n","import { defineComponent, setDefaultSize, setRemovedRecycleThreshold, Types } from \"bitecs\";\n\n// TODO this has to happen before all components are defined. Is there a better spot to be doing this?\nsetDefaultSize(10000);\nsetRemovedRecycleThreshold(0.2);\n\nexport const $isStringType = Symbol(\"isStringType\");\n\nexport const Networked = defineComponent({\n  id: Types.ui32,\n  creator: Types.ui32,\n  owner: Types.ui32,\n\n  lastOwnerTime: Types.ui32\n});\nNetworked.id[$isStringType] = true;\nNetworked.creator[$isStringType] = true;\nNetworked.owner[$isStringType] = true;\n\nexport const Owned = defineComponent();\nexport const NetworkedMediaFrame = defineComponent({\n  capturedNid: Types.ui32,\n  scale: [Types.f32, 3]\n});\nNetworkedMediaFrame.capturedNid[$isStringType] = true;\n\nexport const MediaFrame = defineComponent({\n  capturedNid: Types.ui32,\n  scale: [Types.f32, 3],\n  mediaType: Types.ui8,\n  bounds: [Types.f32, 3],\n  preview: Types.eid,\n  previewingNid: Types.eid\n});\nexport const Text = defineComponent();\nexport const Slice9 = defineComponent({\n  insets: [Types.ui32, 4],\n  size: [Types.f32, 2]\n});\n\nexport const NetworkedTransform = defineComponent({\n  position: [Types.f32, 3],\n  rotation: [Types.f32, 4],\n  scale: [Types.f32, 3]\n});\n\nexport const AEntity = defineComponent();\nexport const Object3DTag = defineComponent();\nexport const GLTFModel = defineComponent();\nexport const CursorRaycastable = defineComponent();\nexport const RemoteHoverTarget = defineComponent();\nexport const NotRemoteHoverTarget = defineComponent();\nexport const Holdable = defineComponent();\nexport const RemoveNetworkedEntityButton = defineComponent();\nexport const Interacted = defineComponent();\n\nexport const HandRight = defineComponent();\nexport const HandLeft = defineComponent();\nexport const RemoteRight = defineComponent();\nexport const RemoteLeft = defineComponent();\nexport const HoveredHandRight = defineComponent();\nexport const HoveredHandLeft = defineComponent();\nexport const HoveredRemoteRight = defineComponent();\nexport const HoveredRemoteLeft = defineComponent();\nexport const HeldHandRight = defineComponent();\nexport const HeldHandLeft = defineComponent();\nexport const HeldRemoteRight = defineComponent();\nexport const HeldRemoteLeft = defineComponent();\nexport const Held = defineComponent();\nexport const OffersRemoteConstraint = defineComponent();\nexport const HandCollisionTarget = defineComponent();\nexport const OffersHandConstraint = defineComponent();\nexport const TogglesHoveredActionSet = defineComponent();\n\nexport const HoverButton = defineComponent({ type: Types.ui8 });\nexport const TextButton = defineComponent({ labelRef: Types.eid });\nexport const HoldableButton = defineComponent();\nexport const SingleActionButton = defineComponent();\n\nexport const Pen = defineComponent();\nexport const HoverMenuChild = defineComponent();\nexport const Static = defineComponent();\nexport const Inspectable = defineComponent();\nexport const PreventAudioBoost = defineComponent();\nexport const IgnoreSpaceBubble = defineComponent();\nexport const Rigidbody = defineComponent({\n  bodyId: Types.ui16,\n  collisionGroup: Types.ui32,\n  collisionMask: Types.ui32,\n  flags: Types.ui8,\n  gravity: Types.f32\n});\nexport const PhysicsShape = defineComponent({ bodyId: Types.ui16, shapeId: Types.ui16, halfExtents: [Types.f32, 3] });\nexport const Pinnable = defineComponent();\nexport const Pinned = defineComponent();\nexport const DestroyAtExtremeDistance = defineComponent();\n\nexport const MediaLoading = defineComponent();\n\nexport const FloatyObject = defineComponent({ flags: Types.ui8, releaseGravity: Types.f32 });\nexport const MakeKinematicOnRelease = defineComponent();\n\nexport const CameraTool = defineComponent({\n  snapTime: Types.f32,\n  state: Types.ui8,\n  captureDurIdx: Types.ui8,\n  trackTarget: Types.eid,\n\n  snapMenuRef: Types.eid,\n  button_next: Types.eid,\n  button_prev: Types.eid,\n  snapRef: Types.eid,\n  cancelRef: Types.eid,\n  recVideoRef: Types.eid,\n  screenRef: Types.eid,\n  selfieScreenRef: Types.eid,\n  cameraRef: Types.eid,\n  countdownLblRef: Types.eid,\n  captureDurLblRef: Types.eid,\n  sndToggleRef: Types.eid\n});\nexport const MyCameraTool = defineComponent();\n","// Brief overview of client authorization can be found in the wiki:\n\nimport { hasComponent } from \"bitecs\";\nimport { HoldableButton } from \"../bit-components\";\n\n// https://github.com/mozilla/hubs/wiki/Hubs-authorization\nexport function showHoverEffect(el) {\n  const isFrozen = el.sceneEl.is(\"frozen\");\n  const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\n  const isSpawner = !!el.components[\"super-spawner\"];\n  const isEmojiSpawner = isSpawner && el.components[\"super-spawner\"].data.template === \"#interactable-emoji\";\n  const isEmoji = !!el.components.emoji;\n  const canMove =\n    (isEmoji || isEmojiSpawner\n      ? window.APP.hubChannel.can(\"spawn_emoji\")\n      : window.APP.hubChannel.can(\"spawn_and_move_media\")) &&\n    (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n  return (isSpawner || !isPinned || isFrozen) && canMove;\n}\n\nexport function canMove(entity) {\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n  const networkedTemplate = entity && entity.components.networked && entity.components.networked.data.template;\n  const isPen = networkedTemplate === \"#interactable-pen\";\n  const spawnerTemplate =\n    entity && entity.components[\"super-spawner\"] && entity.components[\"super-spawner\"].data.template;\n  const isEmojiSpawner = spawnerTemplate === \"#interactable-emoji\";\n  const isEmoji = !!entity.components.emoji;\n  return (\n    hasComponent(APP.world, HoldableButton, entity.eid) ||\n    ((isEmoji || isEmojiSpawner\n      ? window.APP.hubChannel.can(\"spawn_emoji\")\n      : window.APP.hubChannel.can(\"spawn_and_move_media\")) &&\n      (!isPinned || window.APP.hubChannel.can(\"pin_objects\")) &&\n      (!isPen || window.APP.hubChannel.can(\"spawn_drawing\")))\n  );\n}\n\nfunction indexForComponent(component, schema) {\n  const fullComponent = typeof component === \"string\";\n  const componentName = fullComponent ? component : component.component;\n\n  if (fullComponent) {\n    return schema.components.findIndex(schemaComponent => schemaComponent === componentName);\n  } else {\n    return schema.components.findIndex(\n      schemaComponent => schemaComponent.component === componentName && schemaComponent.property === component.property\n    );\n  }\n}\n\nlet nonAuthorizedSchemas = null;\nfunction initializeNonAuthorizedSchemas() {\n  /*\n  Takes the NAF schemas defined in network-schemas.js and produces a data structure of template name to non-authorized\n  component indices:\n  {\n    \"#interactable-media\": [\"4\", \"5\", \"6\"]\n  }\n  */\n  nonAuthorizedSchemas = {};\n  const { schemaDict } = NAF.schemas;\n  for (const template in schemaDict) {\n    if (!schemaDict.hasOwnProperty(template)) continue;\n    const schema = schemaDict[template];\n    nonAuthorizedSchemas[template] = (schema.nonAuthorizedComponents || [])\n      .map(nonAuthorizedComponent => indexForComponent(nonAuthorizedComponent, schema))\n      .map(index => index.toString());\n  }\n}\n\nfunction sanitizeMessageData(template, data) {\n  if (nonAuthorizedSchemas === null) {\n    initializeNonAuthorizedSchemas();\n  }\n  const nonAuthorizedIndices = nonAuthorizedSchemas[template];\n  for (const index in data.components) {\n    if (!data.components.hasOwnProperty(index)) continue;\n    if (!nonAuthorizedIndices.includes(index)) {\n      data.components[index] = null;\n    }\n  }\n  return data;\n}\n\nfunction authorizeEntityManipulation(entityMetadata, sender, senderPermissions) {\n  const { template, creator, isPinned } = entityMetadata;\n  const isCreator = sender === creator;\n\n  if (template.endsWith(\"-waypoint-avatar\") || template.endsWith(\"-media-frame\")) {\n    return true;\n  } else if (template.endsWith(\"-avatar\")) {\n    return isCreator;\n  } else if (template.endsWith(\"-media\")) {\n    return (!isPinned || senderPermissions.pin_objects) && (isCreator || senderPermissions.spawn_and_move_media);\n  } else if (template.endsWith(\"-camera\")) {\n    return isCreator || senderPermissions.spawn_camera;\n  } else if (template.endsWith(\"-pen\") || template.endsWith(\"-drawing\")) {\n    return isCreator || senderPermissions.spawn_drawing;\n  } else if (template.endsWith(\"-emoji\")) {\n    return isCreator || senderPermissions.spawn_emoji;\n  } else {\n    return false;\n  }\n}\n\nfunction getPendingOrExistingEntityMetadata(networkId) {\n  const pendingData = NAF.connection.adapter.getPendingDataForNetworkId(networkId);\n\n  if (pendingData) {\n    if (pendingData.owner) {\n      // If owner is no longer present, give up.\n      const presenceState = window.APP.hubChannel.presence.state[pendingData.owner];\n      if (!presenceState) return;\n    }\n\n    const { template, creator } = pendingData;\n    const schema = NAF.schemas.schemaDict[template];\n    const pinnableComponent = pendingData.components[indexForComponent(\"pinnable\", schema)];\n    const isPinned = pinnableComponent && pinnableComponent.pinned;\n    return { template, creator, isPinned };\n  }\n\n  const entity = NAF.entities.getEntity(networkId);\n  if (!entity) return null;\n\n  const { template, creator } = entity.components.networked.data;\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n  return { template, creator, isPinned };\n}\n\nfunction authorizeOrSanitizeMessageData(data, sender, senderPermissions) {\n  const entityMetadata = getPendingOrExistingEntityMetadata(data.networkId);\n  if (!entityMetadata) return false;\n\n  if (authorizeEntityManipulation(entityMetadata, sender, senderPermissions)) {\n    return true;\n  } else {\n    const { template } = entityMetadata;\n    sanitizeMessageData(template, data);\n    return true;\n  }\n}\n\n// If we receive a sync from a persistent object that we don't have an entity for yet, it must be a scene-owned object\n// (since we guarantee that pinned objects are loaded before connecting NAF).\n// Since we need to get metadata (the template id in particular) from the entity, we must stash these messages until\n// the scene has loaded.\n// Components which require this data must call applyPersistentSync after they are initialized\nconst persistentSyncs = {};\nfunction stashPersistentSync(message, entityData) {\n  if (!persistentSyncs[entityData.networkId]) {\n    persistentSyncs[entityData.networkId] = {\n      dataType: \"u\",\n      data: entityData,\n      clientId: message.clientId,\n      from_session_id: message.from_session_id\n    };\n  } else {\n    const currentData = persistentSyncs[entityData.networkId].data;\n    const currentComponents = currentData.components;\n    Object.assign(currentData, entityData);\n    currentData.components = Object.assign(currentComponents, entityData.components);\n  }\n}\n\nconst emptyObject = {};\nexport function authorizeOrSanitizeMessage(message) {\n  const { dataType, from_session_id } = message;\n\n  if (dataType === \"u\" && message.data.isFirstSync && !message.data.persistent) {\n    // The server has already authorized first sync messages that result in an instantiation.\n    return message;\n  }\n\n  const presenceState = window.APP.hubChannel.presence.state[from_session_id];\n\n  if (!presenceState) {\n    // We've received a manipulation message from a user that we don't have presence state for yet.\n    // Since we can't make a judgement about their permissions, we'll have to ignore the message.\n    return emptyObject;\n  }\n\n  const senderPermissions = presenceState.metas[0].permissions;\n\n  if (dataType === \"um\") {\n    let sanitizedAny = false;\n    let stashedAny = false;\n    for (const index in message.data.d) {\n      if (!message.data.d.hasOwnProperty(index)) continue;\n      const entityData = message.data.d[index];\n      if (entityData.persistent && !NAF.entities.getEntity(entityData.networkId)) {\n        stashPersistentSync(message, entityData);\n        message.data.d[index] = null;\n        stashedAny = true;\n      } else {\n        const authorizedOrSanitized = authorizeOrSanitizeMessageData(entityData, from_session_id, senderPermissions);\n        if (!authorizedOrSanitized) {\n          message.data.d[index] = null;\n          sanitizedAny = true;\n        }\n      }\n    }\n\n    if (sanitizedAny || stashedAny) {\n      message.data.d = message.data.d.filter(x => x != null);\n    }\n\n    return message;\n  } else if (dataType === \"u\") {\n    if (message.data.persistent && !NAF.entities.getEntity(message.data.networkId)) {\n      persistentSyncs[message.data.networkId] = message;\n      return emptyObject;\n    } else {\n      const authorizedOrSanitized = authorizeOrSanitizeMessageData(message.data, from_session_id, senderPermissions);\n      if (authorizedOrSanitized) {\n        return message;\n      } else {\n        return emptyObject;\n      }\n    }\n  } else if (dataType === \"r\") {\n    const entityMetadata = getPendingOrExistingEntityMetadata(message.data.networkId);\n    if (!entityMetadata) return emptyObject;\n    if (authorizeEntityManipulation(entityMetadata, from_session_id, senderPermissions)) {\n      return message;\n    } else {\n      return emptyObject;\n    }\n  } else {\n    // Fall through for other data types. Namely, \"drawing-<networkId>\" messages at the moment.\n    return message;\n  }\n}\n\nexport function applyPersistentSync(networkId) {\n  if (!persistentSyncs[networkId]) return;\n  NAF.connection.adapter.handleIncomingNAF(persistentSyncs[networkId]);\n  delete persistentSyncs[networkId];\n}\n","import { transportForChannel } from \"./transport-for-channel\";\nimport { authorizeOrSanitizeMessage } from \"./utils/permissions-utils\";\n\n// TODO: Use the websocket connection, not HEAD requests\nconst getTimeOffsetToServer = async () => {\n  const precision = 1000;\n  const clientSentTime = Date.now();\n  const serverReceivedTime =\n    new Date(\n      (await fetch(document.location.href, {\n        method: \"HEAD\",\n        cache: \"no-cache\"\n      })).headers.get(\"Date\")\n    ).getTime() +\n    precision / 2;\n  const clientReceivedTime = Date.now();\n  const serverTime = serverReceivedTime + (clientReceivedTime - clientSentTime) / 2;\n  const offset = serverTime - clientReceivedTime;\n  return offset;\n};\n\nconst getAverageTimeOffset = (() => {\n  let average = 0;\n  const numOffsetsToGather = 10;\n  const offsets = [];\n  let n = 0;\n\n  const update = async () => {\n    offsets[n % numOffsetsToGather] = await getTimeOffsetToServer();\n    n = n + 1;\n    average = offsets.reduce((acc, offset) => (acc += offset), 0) / offsets.length;\n    if (offsets.length == numOffsetsToGather) {\n      setTimeout(update, 5 * 60 * 1000);\n    } else {\n      update();\n    }\n  };\n\n  update();\n\n  return () => {\n    return average;\n  };\n})();\n\nexport default class PhoenixAdapter {\n  constructor() {\n    this.refs = new Map();\n    // TODO: Frozen messages can be handled outside this class.\n    this.frozenUpdates = new Map();\n    this._blockedClients = new Map();\n  }\n  setServerUrl() {}\n  setApp() {}\n  setRoom() {}\n  setWebRtcOptions() {}\n  setServerConnectListeners(nafConnectSuccess, nafConnectFailed) {\n    this.nafConnectSuccess = nafConnectSuccess;\n    this.nafConnectFailed = nafConnectFailed;\n  }\n  setRoomOccupantListener() {}\n  setDataChannelListeners(nafOccupantJoined, nafOccupantLeave, nafMessageReceived) {\n    this.nafOccupantJoined = nafOccupantJoined;\n    this.nafOccupantLeave = nafOccupantLeave;\n    this.nafMessageReceived = nafMessageReceived;\n  }\n  async connect() {\n    this.refs.set(\"naf\", this.hubChannel.channel.on(\"naf\", this.handleIncomingNAF));\n    this.refs.set(\"nafr\", this.hubChannel.channel.on(\"nafr\", this.handleIncomingNAFR));\n\n    this.nafConnectSuccess(this.session_id);\n    this.reliableTransport = transportForChannel(this.hubChannel.channel, true);\n    this.unreliableTransport = transportForChannel(this.hubChannel.channel, false);\n\n    this.hubChannel.presence.list(key => key).forEach(this.nafOccupantJoined);\n    this.refs.set(\"hub:join\", this.events.on(`hub:join`, ({ key }) => this.nafOccupantJoined(key)));\n    this.refs.set(\"hub:leave\", this.events.on(`hub:leave`, ({ key }) => this.nafOccupantLeave(key)));\n  }\n  shouldStartConnectionTo() {}\n  startStreamConnection() {}\n  closeStreamConnection() {}\n  getConnectStatus() {}\n\n  getMediaStream() {\n    return Promise.reject(\"getMediaStream not implemented in phoenix-adapter\");\n  }\n\n  getServerTime() {\n    return Date.now() + getAverageTimeOffset();\n  }\n\n  sendData(clientId, dataType, data) {\n    this.unreliableTransport(clientId, dataType, data);\n  }\n  sendDataGuaranteed(clientId, dataType, data) {\n    this.reliableTransport(clientId, dataType, data);\n  }\n  broadcastData(dataType, data) {\n    this.unreliableTransport(undefined, dataType, data);\n  }\n  broadcastDataGuaranteed(dataType, data) {\n    this.reliableTransport(undefined, dataType, data);\n  }\n\n  disconnect() {\n    this.hubChannel.presence.list(key => key).forEach(this.nafOccupantLeave);\n    this.hubChannel.channel.off(\"naf\", this.refs.get(\"naf\"));\n    this.hubChannel.channel.off(\"nafr\", this.refs.get(\"nafr\"));\n    this.events.off(\"hub:join\", this.refs.get(\"hub:join\"));\n    this.events.off(\"hub:leave\", this.refs.get(\"hub:leave\"));\n    this.refs.delete(\"naf\");\n    this.refs.delete(\"nafr\");\n    this.refs.delete(\"hub:join\");\n    this.refs.delete(\"hub:leave\");\n  }\n\n  toggleFreeze() {\n    if (this.frozen) {\n      this.unfreeze();\n    } else {\n      this.freeze();\n    }\n  }\n\n  freeze() {\n    this.frozen = true;\n  }\n\n  unfreeze() {\n    this.frozen = false;\n    this.flushPendingUpdates();\n  }\n\n  flushPendingUpdates() {\n    for (const [networkId, message] of this.frozenUpdates) {\n      const data = this.getPendingData(networkId, message);\n      if (!data) continue;\n\n      // Override the data type on \"um\" messages types, since we extract entity updates from \"um\" messages into\n      // individual frozenUpdates in storeSingleMessage.\n      const dataType = message.dataType === \"um\" ? \"u\" : message.dataType;\n\n      this.nafMessageReceived(null, dataType, data, message.source);\n    }\n    this.frozenUpdates.clear();\n  }\n\n  getPendingData(networkId, message) {\n    if (!message) return null;\n\n    const data = message.dataType === \"um\" ? this.dataForUpdateMultiMessage(networkId, message) : message.data;\n\n    // Ignore messages from users that we may have blocked while frozen.\n    if (data.owner && this._blockedClients.has(data.owner)) return null;\n\n    return data;\n  }\n\n  // Used externally\n  getPendingDataForNetworkId(networkId) {\n    return this.getPendingData(networkId, this.frozenUpdates.get(networkId));\n  }\n\n  handleIncomingNAF = data => {\n    const message = authorizeOrSanitizeMessage(data);\n    const source = \"phx-reliable\";\n    if (!message.dataType) return;\n\n    message.source = source;\n\n    if (this.frozen && (message.dataType === \"um\" || message.dataType === \"u\")) {\n      this.storeMessage(message);\n    } else {\n      this.nafMessageReceived(message.from_session_id, message.dataType, message.data, message.source);\n    }\n  };\n  handleIncomingNAFR = ({ from_session_id, naf: unparsedData }) => {\n    // Server optimization: server passes through unparsed NAF message, we must now parse it.\n    const data = JSON.parse(unparsedData);\n    data.from_session_id = from_session_id;\n    this.handleIncomingNAF(data);\n  };\n\n  storeMessage(message) {\n    if (message.dataType === \"um\") {\n      // UpdateMulti\n      for (let i = 0, l = message.data.d.length; i < l; i++) {\n        this.storeSingleMessage(message, i);\n      }\n    } else {\n      this.storeSingleMessage(message);\n    }\n  }\n\n  storeSingleMessage(message, index) {\n    const data = index !== undefined ? message.data.d[index] : message.data;\n    const dataType = message.dataType;\n\n    const networkId = data.networkId;\n\n    if (!this.frozenUpdates.has(networkId)) {\n      this.frozenUpdates.set(networkId, message);\n    } else {\n      const storedMessage = this.frozenUpdates.get(networkId);\n      const storedData =\n        storedMessage.dataType === \"um\" ? this.dataForUpdateMultiMessage(networkId, storedMessage) : storedMessage.data;\n\n      // Avoid updating components if the entity data received did not come from the current owner.\n      const isOutdatedMessage = data.lastOwnerTime < storedData.lastOwnerTime;\n      const isContemporaneousMessage = data.lastOwnerTime === storedData.lastOwnerTime;\n      if (isOutdatedMessage || (isContemporaneousMessage && storedData.owner > data.owner)) {\n        return;\n      }\n\n      if (dataType === \"r\") {\n        const createdWhileFrozen = storedData && storedData.isFirstSync;\n        if (createdWhileFrozen) {\n          // If the entity was created and deleted while frozen, don't bother conveying anything to the consumer.\n          this.frozenUpdates.delete(networkId);\n        } else {\n          // Delete messages override any other messages for this entity\n          this.frozenUpdates.set(networkId, message);\n        }\n      } else {\n        // merge in component updates\n        if (storedData.components && data.components) {\n          Object.assign(storedData.components, data.components);\n        }\n      }\n    }\n  }\n  dataForUpdateMultiMessage(networkId, message) {\n    // \"d\" is an array of entity datas, where each item in the array represents a unique entity and contains\n    // metadata for the entity, and an array of components that have been updated on the entity.\n    // This method finds the data corresponding to the given networkId.\n    for (let i = 0, l = message.data.d.length; i < l; i++) {\n      const data = message.data.d[i];\n\n      if (data.networkId === networkId) {\n        return data;\n      }\n    }\n\n    return null;\n  }\n\n  block(clientId) {\n    this._blockedClients.set(clientId, true);\n  }\n\n  unblock(clientId) {\n    this._blockedClients.delete(clientId);\n  }\n}\n\nNAF.adapters.register(\"phoenix\", PhoenixAdapter);\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","export function addAnimationComponents(modelEl) {\n  if (!modelEl.components[\"animation-mixer\"]) {\n    return;\n  }\n\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\n    modelEl.setAttribute(\"loop-animation\", \"\");\n  }\n}\n","import * as mediasoupClient from \"mediasoup-client\";\nimport protooClient from \"protoo-client\";\nimport { debug as newDebug } from \"debug\";\nimport EventEmitter from \"eventemitter3\";\nimport { MediaDevices } from \"./utils/media-devices-utils\";\n\n// Used for VP9 webcam video.\n//const VIDEO_KSVC_ENCODINGS = [{ scalabilityMode: \"S3T3_KEY\" }];\n\n// Used for VP9 desktop sharing.\n//const VIDEO_SVC_ENCODINGS = [{ scalabilityMode: \"S3T3\", dtx: true }];\n\n// TODO\n// - look into requestConsumerKeyframe\n// - look into applyNetworkThrottle\n// SFU todo\n// - remove active speaker stuff\n// - remove score stuff\n\n// Based upon mediasoup-demo RoomClient\n\nconst debug = newDebug(\"naf-dialog-adapter:debug\");\n//const warn = newDebug(\"naf-dialog-adapter:warn\");\nconst error = newDebug(\"naf-dialog-adapter:error\");\nconst info = newDebug(\"naf-dialog-adapter:info\");\n\nconst PC_PROPRIETARY_CONSTRAINTS = {\n  optional: [{ googDscp: true }]\n};\n\nconst WEBCAM_SIMULCAST_ENCODINGS = [\n  { scaleResolutionDownBy: 4, maxBitrate: 500000 },\n  { scaleResolutionDownBy: 2, maxBitrate: 1000000 },\n  { scaleResolutionDownBy: 1, maxBitrate: 5000000 }\n];\n\n// Used for simulcast screen sharing.\nconst SCREEN_SHARING_SIMULCAST_ENCODINGS = [{ dtx: true, maxBitrate: 1500000 }, { dtx: true, maxBitrate: 6000000 }];\n\nexport const DIALOG_CONNECTION_CONNECTED = \"dialog-connection-connected\";\nexport const DIALOG_CONNECTION_ERROR_FATAL = \"dialog-connection-error-fatal\";\n\nexport class DialogAdapter extends EventEmitter {\n  constructor() {\n    super();\n\n    this._micShouldBeEnabled = false;\n    this._micProducer = null;\n    this._cameraProducer = null;\n    this._shareProducer = null;\n    this._localMediaStream = null;\n    this._consumers = new Map();\n    this._pendingMediaRequests = new Map();\n    this._blockedClients = new Map();\n    this._forceTcp = false;\n    this._forceTurn = false;\n    this._iceTransportPolicy = null;\n    this.scene = null;\n    this._serverParams = {};\n    this._consumerStats = {};\n  }\n\n  get consumerStats() {\n    return this._consumerStats;\n  }\n\n  get downlinkBwe() {\n    return this._downlinkBwe;\n  }\n\n  getIceServers(host, port, turn) {\n    const iceServers = [];\n\n    this._serverUrl = `wss://${host}:${port}`;\n\n    if (turn && turn.enabled) {\n      turn.transports.forEach(ts => {\n        // Try both TURN DTLS and TCP/TLS\n        if (!this._forceTcp) {\n          iceServers.push({\n            urls: `turns:${host}:${ts.port}`,\n            username: turn.username,\n            credential: turn.credential\n          });\n        }\n\n        iceServers.push({\n          urls: `turns:${host}:${ts.port}?transport=tcp`,\n          username: turn.username,\n          credential: turn.credential\n        });\n      });\n      iceServers.push({ urls: \"stun:stun1.l.google.com:19302\" });\n    } else {\n      iceServers.push({ urls: \"stun:stun1.l.google.com:19302\" }, { urls: \"stun:stun2.l.google.com:19302\" });\n    }\n\n    return iceServers;\n  }\n\n  /**\n   * Gets transport/consumer/producer stats on the server side.\n   */\n  async getServerStats() {\n    if (!this._protoo.connected) {\n      // Signaling channel not connected, no reason to get remote RTC stats.\n      return;\n    }\n\n    const result = {};\n    try {\n      if (!this._sendTransport?._closed) {\n        const sendTransport = (result[this._sendTransport.id] = {});\n        sendTransport.name = \"Send\";\n        sendTransport.stats = await this._protoo.request(\"getTransportStats\", {\n          transportId: this._sendTransport.id\n        });\n        result[this._sendTransport.id][\"producers\"] = {};\n        for (const producer of this._sendTransport._producers) {\n          const id = producer[0];\n          result[this._sendTransport.id][\"producers\"][id] = await this._protoo.request(\"getProducerStats\", {\n            producerId: id\n          });\n        }\n      }\n      if (!this._recvTransport?._closed) {\n        const recvTransport = (result[this._recvTransport.id] = {});\n        recvTransport.name = \"Receive\";\n        recvTransport.stats = await this._protoo.request(\"getTransportStats\", {\n          transportId: this._recvTransport.id\n        });\n        result[this._recvTransport.id][\"consumers\"] = {};\n        for (const consumer of this._recvTransport._consumers) {\n          const id = consumer[0];\n          result[this._recvTransport.id][\"consumers\"][id] = await this._protoo.request(\"getConsumerStats\", {\n            consumerId: id\n          });\n        }\n      }\n      return result;\n    } catch (e) {\n      this.emitRTCEvent(\"error\", \"Adapter\", () => `Error getting the server status: ${e}`);\n      return { error: `Error getting the server status: ${e}` };\n    }\n  }\n\n  async iceRestart(transport) {\n    // Force an ICE restart to gather new candidates and trigger a reconnection\n    this.emitRTCEvent(\n      \"log\",\n      \"RTC\",\n      () => `Restarting ${transport.id === this._sendTransport.id ? \"send\" : \"receive\"} transport ICE`\n    );\n    const iceParameters = await this._protoo.request(\"restartIce\", { transportId: transport.id });\n    await transport.restartIce({ iceParameters });\n  }\n\n  async recreateSendTransport(iceServers) {\n    this.emitRTCEvent(\"log\", \"RTC\", () => `Recreating send transport ICE`);\n    await this.closeSendTransport();\n    await this.createSendTransport(iceServers);\n  }\n\n  /**\n   * Restart ICE in the underlying send peerconnection.\n   */\n  async restartSendICE() {\n    // Do not restart ICE if Signaling is disconnected.\n    if (!this._protoo || !this._protoo.connected) {\n      return;\n    }\n\n    try {\n      if (!this._sendTransport?._closed) {\n        await this.iceRestart(this._sendTransport);\n      } else {\n        // If the transport is closed but the signaling is connected, we try to recreate\n        const { host, port, turn } = this._serverParams;\n        const iceServers = this.getIceServers(host, port, turn);\n        await this.recreateSendTransport(iceServers);\n      }\n    } catch (err) {\n      this.emitRTCEvent(\"error\", \"RTC\", () => `Send transport [recreate] failed: ${err}`);\n    }\n  }\n\n  /**\n   * Checks the Send Transport ICE status and restarts it in case is in failed state.\n   * This is called by the Send Transport \"connectionstatechange\" event listener.\n   * @param {boolean} connectionState The transport connnection state (ICE connection state)\n   */\n  checkSendIceStatus(connectionState) {\n    // If the ICE connection state is failed, we force an ICE restart\n    if (connectionState === \"failed\") {\n      this.restartSendICE();\n    }\n  }\n\n  async recreateRecvTransport(iceServers) {\n    this.emitRTCEvent(\"log\", \"RTC\", () => `Recreating receive transport ICE`);\n    await this.closeRecvTransport();\n    await this.createRecvTransport(iceServers);\n    await this._protoo.request(\"refreshConsumers\");\n  }\n\n  /**\n   * Restart ICE in the underlying receive peerconnection.\n   * @param {boolean} force Forces the execution of the reconnect.\n   */\n  async restartRecvICE() {\n    if (!this._protoo || !this._protoo.connected) {\n      return;\n    }\n\n    try {\n      if (!this._recvTransport?._closed) {\n        await this.iceRestart(this._recvTransport);\n      } else {\n        // If the transport is closed but the signaling is connected, we try to recreate\n        const { host, port, turn } = this._serverParams;\n        const iceServers = this.getIceServers(host, port, turn);\n        await this.recreateRecvTransport(iceServers);\n      }\n    } catch (err) {\n      this.emitRTCEvent(\"error\", \"RTC\", () => `Receive transport [recreate] failed: ${err}`);\n    }\n  }\n\n  /**\n   * Checks the ReeceiveReeceive Transport ICE status and restarts it in case is in failed state.\n   * This is called by the Reeceive Transport \"connectionstatechange\" event listener.\n   * @param {boolean} connectionState The transport connection state (ICE connection state)\n   */\n  checkRecvIceStatus(connectionState) {\n    // If the ICE connection state is failed, we force an ICE restart\n    if (connectionState === \"failed\") {\n      this.restartRecvICE();\n    }\n  }\n\n  async connect({\n    serverUrl,\n    roomId,\n    joinToken,\n    serverParams,\n    scene,\n    clientId,\n    forceTcp,\n    forceTurn,\n    iceTransportPolicy\n  }) {\n    this._serverUrl = serverUrl;\n    this._roomId = roomId;\n    this._joinToken = joinToken;\n    this._serverParams = serverParams;\n    this._clientId = clientId;\n    this.scene = scene;\n    this._forceTcp = forceTcp;\n    this._forceTurn = forceTurn;\n    this._iceTransportPolicy = iceTransportPolicy;\n\n    const urlWithParams = new URL(this._serverUrl);\n    urlWithParams.searchParams.append(\"roomId\", this._roomId);\n    urlWithParams.searchParams.append(\"peerId\", this._clientId);\n\n    // TODO: Establishing connection could take a very long time.\n    //       Inform the user if we are stuck here.\n    const protooTransport = new protooClient.WebSocketTransport(urlWithParams.toString(), {\n      retry: { retries: 2 }\n    });\n    this._protoo = new protooClient.Peer(protooTransport);\n\n    this._protoo.on(\"disconnected\", () => {\n      this.emitRTCEvent(\"info\", \"Signaling\", () => `Disconnected`);\n      this.cleanUpLocalState();\n    });\n\n    this._protoo.on(\"failed\", attempt => {\n      this.emitRTCEvent(\"error\", \"Signaling\", () => `Failed: ${attempt}, retrying...`);\n    });\n\n    this._protoo.on(\"close\", async () => {\n      // We explicitly disconnect event handlers when closing the socket ourselves,\n      // so if we get into here, we were not the ones closing the connection.\n      this.emitRTCEvent(\"error\", \"Signaling\", () => `Closed`);\n      this._retryConnectWithNewHost();\n    });\n\n    // eslint-disable-next-line no-unused-vars\n    this._protoo.on(\"request\", async (request, accept, reject) => {\n      this.emitRTCEvent(\"info\", \"Signaling\", () => `Request [${request.method}]: ${request.data?.id}`);\n      debug('proto \"request\" event [method:%s, data:%o]', request.method, request.data?.id);\n\n      switch (request.method) {\n        case \"newConsumer\": {\n          const {\n            peerId,\n            producerId,\n            id,\n            kind,\n            rtpParameters,\n            /*type, */ appData /*, producerPaused */\n          } = request.data;\n\n          try {\n            const consumer = await this._recvTransport.consume({\n              id,\n              producerId,\n              kind,\n              rtpParameters,\n              appData: { ...appData, peerId } // Trick.\n            });\n\n            // Store in the map.\n            this._consumers.set(consumer.id, consumer);\n\n            consumer.on(\"transportclose\", () => {\n              this.emitRTCEvent(\"error\", \"RTC\", () => `Consumer transport closed`);\n              this.removeConsumer(consumer.id);\n            });\n\n            if (kind === \"video\") {\n              const { spatialLayers, temporalLayers } = mediasoupClient.parseScalabilityMode(\n                consumer.rtpParameters.encodings[0].scalabilityMode\n              );\n\n              this._consumerStats[consumer.id] = this._consumerStats[consumer.id] || {};\n              this._consumerStats[consumer.id][\"spatialLayers\"] = spatialLayers;\n              this._consumerStats[consumer.id][\"temporalLayers\"] = temporalLayers;\n            }\n\n            // We are ready. Answer the protoo request so the server will\n            // resume this Consumer (which was paused for now if video).\n            accept();\n\n            this.resolvePendingMediaRequestForTrack(peerId, consumer.track);\n\n            // Notify of an stream update event\n            this.emit(\"stream_updated\", peerId, kind);\n          } catch (err) {\n            this.emitRTCEvent(\"error\", \"Adapter\", () => `Error: ${err}`);\n            error('\"newConsumer\" request failed:%o', err);\n\n            throw err;\n          }\n\n          break;\n        }\n      }\n    });\n\n    this._protoo.on(\"notification\", notification => {\n      debug('proto \"notification\" event [method:%s, data:%o]', notification.method, notification.data);\n\n      switch (notification.method) {\n        case \"newPeer\": {\n          break;\n        }\n\n        case \"peerClosed\": {\n          const { peerId } = notification.data;\n          this.closePeer(peerId);\n\n          break;\n        }\n\n        case \"consumerClosed\": {\n          const { consumerId } = notification.data;\n          const consumer = this._consumers.get(consumerId);\n\n          if (!consumer) {\n            info(`consumerClosed event received without related consumer: ${consumerId}`);\n            break;\n          }\n\n          consumer.close();\n          this.removeConsumer(consumer.id);\n\n          break;\n        }\n\n        case \"peerBlocked\": {\n          const { peerId } = notification.data;\n          document.body.dispatchEvent(new CustomEvent(\"blocked\", { detail: { clientId: peerId } }));\n\n          break;\n        }\n\n        case \"peerUnblocked\": {\n          const { peerId } = notification.data;\n          document.body.dispatchEvent(new CustomEvent(\"unblocked\", { detail: { clientId: peerId } }));\n\n          break;\n        }\n\n        case \"downlinkBwe\": {\n          this._downlinkBwe = notification.data;\n          break;\n        }\n\n        case \"consumerLayersChanged\": {\n          const { consumerId, spatialLayer, temporalLayer } = notification.data;\n\n          const consumer = this._consumers.get(consumerId);\n\n          if (!consumer) {\n            info(`consumerLayersChanged event received without related consumer: ${consumerId}`);\n            break;\n          }\n\n          this._consumerStats[consumerId] = this._consumerStats[consumerId] || {};\n          this._consumerStats[consumerId][\"spatialLayer\"] = spatialLayer;\n          this._consumerStats[consumerId][\"temporalLayer\"] = temporalLayer;\n\n          // TODO: If spatialLayer/temporalLayer are null, that's probably because the current downlink\n          // it's not enough forany spatial layer bitrate. In that case the server has paused the consumer.\n          // At this point we it would be nice to give the user some visual cue that this stream is paused.\n          // ie. A grey overlay with some icon or replacing the video stream por a generic person image.\n          break;\n        }\n\n        case \"consumerScore\": {\n          const { consumerId, score } = notification.data;\n\n          const consumer = this._consumers.get(consumerId);\n\n          if (!consumer) {\n            info(`consumerScore event received without related consumer: ${consumerId}`);\n            break;\n          }\n\n          this._consumerStats[consumerId] = this._consumerStats[consumerId] || {};\n          this._consumerStats[consumerId][\"score\"] = score;\n        }\n      }\n    });\n\n    return new Promise((resolve, reject) => {\n      this._protoo.on(\"open\", async () => {\n        this.emitRTCEvent(\"info\", \"Signaling\", () => `Open`);\n\n        try {\n          await this._joinRoom();\n          resolve();\n          this.emit(DIALOG_CONNECTION_CONNECTED);\n        } catch (err) {\n          this.emitRTCEvent(\"warn\", \"Adapter\", () => `Error during connect: ${error}`);\n          reject(err);\n          this.emit(DIALOG_CONNECTION_ERROR_FATAL);\n        }\n      });\n    });\n  }\n\n  async _retryConnectWithNewHost() {\n    this.cleanUpLocalState();\n    this._protoo.removeAllListeners();\n    const serverParams = await APP.hubChannel.getHost();\n    const { host, port } = serverParams;\n    const newServerUrl = `wss://${host}:${port}`;\n    if (this._serverUrl === newServerUrl) {\n      console.error(\"Reconnect to dialog failed.\");\n      this.emit(DIALOG_CONNECTION_ERROR_FATAL);\n      return;\n    }\n    console.log(`The Dialog server has changed to ${newServerUrl}, reconnecting with the new server...`);\n    await this.connect({\n      serverUrl: newServerUrl,\n      roomId: this._roomId,\n      joinToken: APP.hubChannel.token,\n      serverParams,\n      scene: this.scene,\n      clientId: this._clientId,\n      forceTcp: this._forceTcp,\n      forceTurn: this._forceTurn,\n      iceTransportPolicy: this._iceTransportPolicy\n    });\n  }\n\n  closePeer(peerId) {\n    const pendingMediaRequests = this._pendingMediaRequests.get(peerId);\n\n    if (pendingMediaRequests) {\n      const msg = \"The user disconnected before the media stream was resolved.\";\n      info(msg);\n\n      if (pendingMediaRequests.audio) {\n        pendingMediaRequests.audio.resolve(null);\n      }\n\n      if (pendingMediaRequests.video) {\n        pendingMediaRequests.video.resolve(null);\n      }\n\n      this._pendingMediaRequests.delete(peerId);\n    }\n  }\n\n  resolvePendingMediaRequestForTrack(clientId, track) {\n    const requests = this._pendingMediaRequests.get(clientId);\n\n    if (requests && requests[track.kind]) {\n      const resolve = requests[track.kind].resolve;\n      delete requests[track.kind];\n      resolve(new MediaStream([track]));\n    }\n\n    if (requests && Object.keys(requests).length === 0) {\n      this._pendingMediaRequests.delete(clientId);\n    }\n  }\n\n  removeConsumer(consumerId) {\n    this.emitRTCEvent(\"info\", \"RTC\", () => `Consumer removed: ${consumerId}`);\n    this._consumers.delete(consumerId);\n  }\n\n  getMediaStream(clientId, kind = \"audio\") {\n    let track;\n\n    if (this._clientId === clientId) {\n      if (kind === \"audio\" && this._micProducer) {\n        track = this._micProducer.track;\n      } else if (kind === \"video\") {\n        if (this._cameraProducer && !this._cameraProducer.closed) {\n          track = this._cameraProducer.track;\n        } else if (this._shareProducer && !this._shareProducer.closed) {\n          track = this._shareProducer.track;\n        }\n      }\n    } else {\n      this._consumers.forEach(consumer => {\n        if (consumer.appData.peerId === clientId && kind == consumer.track.kind) {\n          track = consumer.track;\n        }\n      });\n    }\n\n    if (track) {\n      debug(`Already had ${kind} for ${clientId}`);\n      return Promise.resolve(new MediaStream([track]));\n    } else {\n      debug(`Waiting on ${kind} for ${clientId}`);\n      if (!this._pendingMediaRequests.has(clientId)) {\n        this._pendingMediaRequests.set(clientId, {});\n      }\n\n      const requests = this._pendingMediaRequests.get(clientId);\n      const promise = new Promise((resolve, reject) => (requests[kind] = { resolve, reject }));\n      requests[kind].promise = promise;\n      promise.catch(e => {\n        this.emitRTCEvent(\"error\", \"Adapter\", () => `getMediaStream error: ${e}`);\n        console.warn(`${clientId} getMediaStream Error`, e);\n      });\n      return promise;\n    }\n  }\n\n  async createSendTransport(iceServers) {\n    // Create mediasoup Transport for sending (unless we don't want to produce).\n    const sendTransportInfo = await this._protoo.request(\"createWebRtcTransport\", {\n      producing: true,\n      consuming: false,\n      sctpCapabilities: undefined\n    });\n\n    this._sendTransport = this._mediasoupDevice.createSendTransport({\n      id: sendTransportInfo.id,\n      iceParameters: sendTransportInfo.iceParameters,\n      iceCandidates: sendTransportInfo.iceCandidates,\n      dtlsParameters: sendTransportInfo.dtlsParameters,\n      sctpParameters: sendTransportInfo.sctpParameters,\n      iceServers,\n      iceTransportPolicy: this._iceTransportPolicy,\n      proprietaryConstraints: PC_PROPRIETARY_CONSTRAINTS\n    });\n\n    this._sendTransport.on(\"connect\", (\n      { dtlsParameters },\n      callback,\n      errback // eslint-disable-line no-shadow\n    ) => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [connect]`);\n      this._sendTransport.observer.on(\"close\", () => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [close]`);\n      });\n      this._sendTransport.observer.on(\"newproducer\", producer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [newproducer]: ${producer.id}`);\n      });\n      this._sendTransport.observer.on(\"newconsumer\", consumer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [newconsumer]: ${consumer.id}`);\n      });\n\n      this._protoo\n        .request(\"connectWebRtcTransport\", {\n          transportId: this._sendTransport.id,\n          dtlsParameters\n        })\n        .then(callback)\n        .catch(errback);\n    });\n\n    this._sendTransport.on(\"connectionstatechange\", connectionState => {\n      let level = \"info\";\n      if (connectionState === \"failed\" || connectionState === \"disconnected\") {\n        level = \"error\";\n      }\n      this.emitRTCEvent(level, \"RTC\", () => `Send transport [connectionstatechange]: ${connectionState}`);\n\n      this.checkSendIceStatus(connectionState);\n    });\n\n    this._sendTransport.on(\"produce\", async ({ kind, rtpParameters, appData }, callback, errback) => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Send transport [produce]: ${kind}`);\n      try {\n        // eslint-disable-next-line no-shadow\n        const { id } = await this._protoo.request(\"produce\", {\n          transportId: this._sendTransport.id,\n          kind,\n          rtpParameters,\n          appData\n        });\n\n        callback({ id });\n      } catch (error) {\n        this.emitRTCEvent(\"error\", \"Signaling\", () => `[produce] error: ${error}`);\n        errback(error);\n      }\n    });\n  }\n\n  async closeSendTransport() {\n    if (this._micProducer) {\n      this._micProducer.close();\n      this._protoo?.connected && this._protoo?.request(\"closeProducer\", { producerId: this._micProducer.id });\n      this._micProducer = null;\n    }\n\n    if (this._videoProducer) {\n      this._videoProducer.close();\n      this._protoo?.connected && this._protoo?.request(\"closeProducer\", { producerId: this._videoProducer.id });\n      this._videoProducer = null;\n    }\n\n    // TODO: If _sendTransport is falsey then return\n    const transportId = this._sendTransport?.id;\n    if (this._sendTransport && !this._sendTransport._closed) {\n      this._sendTransport.close();\n      this._sendTransport = null;\n    }\n\n    if (this._protoo?.connected) {\n      try {\n        await this._protoo.request(\"closeWebRtcTransport\", { transportId });\n      } catch (err) {\n        error(err);\n      }\n    }\n  }\n\n  async createRecvTransport(iceServers) {\n    // Create mediasoup Transport for sending (unless we don't want to consume).\n    const recvTransportInfo = await this._protoo.request(\"createWebRtcTransport\", {\n      producing: false,\n      consuming: true,\n      sctpCapabilities: undefined\n    });\n\n    this._recvTransport = this._mediasoupDevice.createRecvTransport({\n      id: recvTransportInfo.id,\n      iceParameters: recvTransportInfo.iceParameters,\n      iceCandidates: recvTransportInfo.iceCandidates,\n      dtlsParameters: recvTransportInfo.dtlsParameters,\n      sctpParameters: recvTransportInfo.sctpParameters,\n      iceServers,\n      iceTransportPolicy: this._iceTransportPolicy\n    });\n\n    this._recvTransport.on(\"connect\", (\n      { dtlsParameters },\n      callback,\n      errback // eslint-disable-line no-shadow\n    ) => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [connect]`);\n      this._recvTransport.observer.on(\"close\", () => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [close]`);\n      });\n      this._recvTransport.observer.on(\"newproducer\", producer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [newproducer]: ${producer.id}`);\n      });\n      this._recvTransport.observer.on(\"newconsumer\", consumer => {\n        this.emitRTCEvent(\"info\", \"RTC\", () => `Receive transport [newconsumer]: ${consumer.id}`);\n      });\n\n      this._protoo\n        .request(\"connectWebRtcTransport\", {\n          transportId: this._recvTransport.id,\n          dtlsParameters\n        })\n        .then(callback)\n        .catch(errback);\n    });\n\n    this._recvTransport.on(\"connectionstatechange\", connectionState => {\n      let level = \"info\";\n      if (connectionState === \"failed\" || connectionState === \"disconnected\") {\n        level = \"error\";\n      }\n      this.emitRTCEvent(level, \"RTC\", () => `Receive transport [connectionstatechange]: ${connectionState}`);\n\n      this.checkRecvIceStatus(connectionState);\n    });\n  }\n\n  async closeRecvTransport() {\n    const transportId = this._recvTransport?.id;\n    if (this._recvTransport && !this._recvTransport._closed) {\n      this._recvTransport.close();\n      this._recvTransport = null;\n    }\n    if (this._protoo?.connected) {\n      try {\n        await this._protoo.request(\"closeWebRtcTransport\", { transportId });\n      } catch (err) {\n        error(err);\n      }\n    }\n  }\n\n  async _joinRoom() {\n    debug(\"_joinRoom()\");\n\n    this._mediasoupDevice = new mediasoupClient.Device({});\n\n    const routerRtpCapabilities = await this._protoo.request(\"getRouterRtpCapabilities\");\n\n    await this._mediasoupDevice.load({ routerRtpCapabilities });\n\n    const { host, port, turn } = this._serverParams;\n    const iceServers = this.getIceServers(host, port, turn);\n\n    await this.createSendTransport(iceServers);\n    await this.createRecvTransport(iceServers);\n\n    await this._protoo.request(\"join\", {\n      displayName: this._clientId,\n      device: this._device,\n      rtpCapabilities: this._mediasoupDevice.rtpCapabilities,\n      sctpCapabilities: this._useDataChannel ? this._mediasoupDevice.sctpCapabilities : undefined,\n      token: this._joinToken\n    });\n\n    if (this._localMediaStream) {\n      // TODO: Refactor to be \"Create producers\"\n      await this.setLocalMediaStream(this._localMediaStream);\n    }\n  }\n\n  async setLocalMediaStream(stream) {\n    if (!this._sendTransport) {\n      console.error(\"Tried to setLocalMediaStream before a _sendTransport existed\");\n      return;\n    }\n    this.emitRTCEvent(\"info\", \"RTC\", () => `Creating missing producers`);\n    let sawAudio = false;\n    let sawVideo = false;\n\n    await Promise.all(\n      stream.getTracks().map(async track => {\n        if (track.kind === \"audio\") {\n          sawAudio = true;\n\n          // TODO multiple audio tracks?\n          if (this._micProducer) {\n            if (this._micProducer.track !== track) {\n              this._micProducer.track.stop();\n              this._micProducer.replaceTrack(track);\n            }\n          } else {\n            // stopTracks = false because otherwise the track will end during a temporary disconnect\n            this._micProducer = await this._sendTransport.produce({\n              track,\n              pause: !this._micShouldBeEnabled,\n              stopTracks: false,\n              codecOptions: { opusStereo: false, opusDtx: true },\n              zeroRtpOnPause: true,\n              disableTrackOnPause: true\n            });\n\n            this._micProducer.on(\"transportclose\", () => {\n              this.emitRTCEvent(\"info\", \"RTC\", () => `Mic transport closed`);\n              this._micProducer = null;\n            });\n\n            this.emit(\"mic-state-changed\", { enabled: this.isMicEnabled });\n          }\n        } else {\n          sawVideo = true;\n\n          if (track._hubs_contentHint === MediaDevices.SCREEN) {\n            await this.disableCamera();\n            await this.enableShare(track);\n          } else if (track._hubs_contentHint === MediaDevices.CAMERA) {\n            await this.disableShare();\n            await this.enableCamera(track);\n          }\n        }\n\n        this.resolvePendingMediaRequestForTrack(this._clientId, track);\n      })\n    );\n\n    if (!sawAudio && this._micProducer) {\n      this._protoo.request(\"closeProducer\", { producerId: this._micProducer.id });\n      this._micProducer.close();\n      this._micProducer = null;\n    }\n    if (!sawVideo) {\n      this.disableCamera();\n      this.disableShare();\n    }\n    this._localMediaStream = stream;\n  }\n\n  async enableCamera(track) {\n    // stopTracks = false because otherwise the track will end during a temporary disconnect\n    this._cameraProducer = await this._sendTransport.produce({\n      track,\n      stopTracks: false,\n      codecOptions: { videoGoogleStartBitrate: 1000 },\n      encodings: WEBCAM_SIMULCAST_ENCODINGS,\n      zeroRtpOnPause: true,\n      disableTrackOnPause: true\n    });\n\n    this._cameraProducer.on(\"transportclose\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Camera transport closed`);\n      this.disableCamera();\n    });\n    this._cameraProducer.observer.on(\"trackended\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Camera track ended`);\n      this.disableCamera();\n    });\n  }\n\n  async disableCamera() {\n    if (!this._cameraProducer) return;\n\n    this._cameraProducer.close();\n\n    try {\n      if (!this._sendTransport.closed) {\n        await this._protoo.request(\"closeProducer\", { producerId: this._cameraProducer.id });\n      }\n    } catch (error) {\n      console.error(`disableCamera(): ${error}`);\n    }\n\n    this._cameraProducer = null;\n  }\n\n  async enableShare(track) {\n    // stopTracks = false because otherwise the track will end during a temporary disconnect\n    this._shareProducer = await this._sendTransport.produce({\n      track,\n      stopTracks: false,\n      codecOptions: { videoGoogleStartBitrate: 1000 },\n      encodings: SCREEN_SHARING_SIMULCAST_ENCODINGS,\n      zeroRtpOnPause: true,\n      disableTrackOnPause: true,\n      appData: {\n        share: true\n      }\n    });\n\n    this._shareProducer.on(\"transportclose\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Desktop Share transport closed`);\n      this.disableShare();\n    });\n    this._shareProducer.observer.on(\"trackended\", () => {\n      this.emitRTCEvent(\"info\", \"RTC\", () => `Desktop Share transport track ended`);\n      this.disableShare();\n    });\n  }\n\n  async disableShare() {\n    if (!this._shareProducer) return;\n\n    this._shareProducer.close();\n\n    try {\n      if (!this._sendTransport.closed) {\n        await this._protoo.request(\"closeProducer\", { producerId: this._shareProducer.id });\n      }\n    } catch (error) {\n      console.error(`disableShare(): ${error}`);\n    }\n\n    this._shareProducer = null;\n  }\n\n  toggleMicrophone() {\n    if (this.isMicEnabled) {\n      this.enableMicrophone(false);\n    } else {\n      this.enableMicrophone(true);\n    }\n  }\n\n  enableMicrophone(enabled) {\n    if (!this._micProducer) {\n      console.error(\"Tried to toggle mic but there's no producer.\");\n      return;\n    }\n\n    if (enabled && !this.isMicEnabled) {\n      this._micProducer.resume();\n      this._protoo.request(\"resumeProducer\", { producerId: this._micProducer.id });\n    } else if (!enabled && this.isMicEnabled) {\n      this._micProducer.pause();\n      this._protoo.request(\"pauseProducer\", { producerId: this._micProducer.id });\n    }\n    this._micShouldBeEnabled = enabled;\n    this.emit(\"mic-state-changed\", { enabled: this.isMicEnabled });\n  }\n\n  get isMicEnabled() {\n    return this._micProducer && !this._micProducer.paused;\n  }\n\n  cleanUpLocalState() {\n    this._sendTransport && this._sendTransport.close();\n    this._sendTransport = null;\n    this._recvTransport && this._recvTransport.close();\n    this._recvTransport = null;\n    this._micProducer = null;\n    this._shareProducer = null;\n    this._cameraProducer = null;\n  }\n\n  disconnect() {\n    debug(\"disconnect()\");\n    this.cleanUpLocalState();\n    if (this._protoo) {\n      this._protoo.removeAllListeners();\n      if (this._protoo.connected) {\n        this._protoo.close();\n        this.emitRTCEvent(\"info\", \"Signaling\", () => `[close]`);\n      }\n    }\n  }\n\n  kick(clientId) {\n    return this._protoo\n      .request(\"kick\", {\n        room_id: this.room,\n        user_id: clientId,\n        token: this._joinToken\n      })\n      .then(() => {\n        document.body.dispatchEvent(new CustomEvent(\"kicked\", { detail: { clientId: clientId } }));\n      });\n  }\n\n  block(clientId) {\n    return this._protoo.request(\"block\", { whom: clientId }).then(() => {\n      this._blockedClients.set(clientId, true);\n      document.body.dispatchEvent(new CustomEvent(\"blocked\", { detail: { clientId: clientId } }));\n    });\n  }\n\n  unblock(clientId) {\n    return this._protoo.request(\"unblock\", { whom: clientId }).then(() => {\n      this._blockedClients.delete(clientId);\n      document.body.dispatchEvent(new CustomEvent(\"unblocked\", { detail: { clientId: clientId } }));\n    });\n  }\n\n  emitRTCEvent(level, tag, msgFunc) {\n    if (!window.APP.store.state.preferences.showRtcDebugPanel) return;\n    const time = new Date().toLocaleTimeString(\"en-US\", {\n      hour12: false,\n      hour: \"numeric\",\n      minute: \"numeric\",\n      second: \"numeric\"\n    });\n    this.scene.emit(\"rtc_event\", { level, tag, time, msg: msgFunc() });\n  }\n}\n","/* global APP*/\nimport { getReticulumFetchUrl, hubUrl } from \"./utils/phoenix-utils\";\nimport { updateEnvironmentForHub, getSceneUrlForHub, updateUIForHub, remountUI } from \"./hub\";\n\nfunction unloadRoomObjects() {\n  document.querySelectorAll(\"[pinnable]\").forEach(el => {\n    if (el.components.pinnable.data.pinned) {\n      el.parentNode.removeChild(el);\n    }\n  });\n\n  // Clean up empty object.gltf nodes\n  document.querySelectorAll(\"#objects-scene .Room_Objects\").forEach(el => {\n    if (!el.children.length) {\n      el.parentNode.parentNode.removeChild(el.parentNode);\n    }\n  });\n}\n\nfunction loadRoomObjects(hubId) {\n  const objectsScene = document.querySelector(\"#objects-scene\");\n  const objectsUrl = getReticulumFetchUrl(`/${hubId}/objects.gltf`);\n  const objectsEl = document.createElement(\"a-entity\");\n  objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\n  objectsScene.appendChild(objectsEl);\n}\n\nexport async function changeHub(hubId, addToHistory = true) {\n  if (hubId === APP.hub.hub_id) {\n    console.log(\"Change hub called with the current hub id. This is a noop.\");\n    return;\n  }\n  // Suppress on-screen join and leave messages until we receive a sync.\n  APP.hideHubPresenceEvents = true;\n  const scene = AFRAME.scenes[0];\n\n  let data;\n  try {\n    data = await APP.hubChannel.migrateToHub(hubId);\n  } catch (e) {\n    console.warn(`Failed to join hub ${hubId}: ${e.reason}|${e.message}`);\n    APP.messageDispatch.log(\"joinFailed\", { message: e.message });\n    return;\n  }\n\n  const hub = data.hubs[0];\n\n  if (addToHistory) {\n    window.history.pushState(null, null, hubUrl(hubId, {}, hub.slug));\n  }\n\n  APP.hub = hub;\n  updateUIForHub(hub, APP.hubChannel);\n  scene.emit(\"hub_updated\", { hub });\n\n  APP.subscriptions.setSubscribed(data.subscriptions.web_push);\n\n  remountUI({\n    hubIsBound: data.hub_requires_oauth,\n    initialIsFavorited: data.subscriptions.favorites\n  });\n\n  NAF.entities.removeRemoteEntities();\n  await NAF.connection.adapter.disconnect();\n  await APP.dialog.disconnect();\n  unloadRoomObjects();\n  NAF.connection.connectedClients = {};\n  NAF.connection.activeDataChannels = {};\n\n  NAF.room = hub.hub_id;\n\n  if (\n    document.querySelector(\"#environment-scene\").childNodes[0].components[\"gltf-model-plus\"].data.src !==\n    (await getSceneUrlForHub(hub))\n  ) {\n    const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\n    fader.fadeOut().then(() => {\n      scene.emit(\"reset_scene\");\n      updateEnvironmentForHub(hub, APP.entryManager);\n    });\n  }\n\n  APP.retChannel.push(\"change_hub\", { hub_id: hub.hub_id });\n\n  await Promise.all([\n    APP.dialog.connect({\n      serverUrl: `wss://${hub.host}:${hub.port}`,\n      roomId: hub.hub_id,\n      joinToken: data.perms_token,\n      serverParams: { host: hub.host, port: hub.port, turn: hub.turn },\n      scene,\n      clientId: APP.dialog._clientId,\n      forceTcp: APP.dialog._forceTcp,\n      forceTurn: APP.dialog._forceTurn,\n      iceTransportPolicy: APP.dialog._iceTransportPolicy\n    }),\n\n    NAF.connection.adapter.connect()\n  ]);\n\n  loadRoomObjects(hubId);\n\n  APP.hubChannel.sendEnteredEvent();\n\n  APP.messageDispatch.receive({\n    type: \"hub_changed\",\n    hubName: hub.name,\n    showLineBreak: true\n  });\n}\nwindow.changeHub = changeHub;\n\n// TODO see if there is a better way to do this with react router\nwindow.addEventListener(\"popstate\", function() {\n  if (!APP.store.state.preferences.fastRoomSwitching) return;\n  const qs = new URLSearchParams(location.search);\n  const newHubId = qs.get(\"hub_id\") || document.location.pathname.substring(1).split(\"/\")[0];\n  if (newHubId !== APP.hub.hub_id) {\n    changeHub(newHubId, false);\n  }\n});\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\n\nconst components = [];\nexport class AnimationMixerSystem {\n  tick(dt) {\n    for (let i = 0; i < components.length; i++) {\n      const cmp = components[i];\n      if (cmp.mixer) {\n        cmp.mixer.update(dt / 1000);\n      }\n    }\n  }\n}\n\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n  play() {\n    components.push(this);\n  },\n  pause() {\n    components.splice(components.indexOf(this), 1);\n  }\n});\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n\nexport function findComponentsInNearestAncestor(entity, componentName) {\n  const components = [];\n  while (entity) {\n    if (entity.components) {\n      for (const c in entity.components) {\n        if (entity.components[c].name === componentName) {\n          components.push(entity.components[c]);\n        }\n      }\n    }\n    if (components.length) {\n      return components;\n    }\n    entity = entity.parentNode;\n  }\n  return components;\n}\n","export function easeOutQuadratic(t) {\n  return t * (2 - t);\n}\n// Adapted from\n// https://github.com/d3/d3-ease/blob/master/src/elastic.js#L18\nexport const elasticOut = (function() {\n  const tau = 2 * Math.PI,\n    a = 1,\n    p = 0.3 / tau,\n    s = Math.asin(1) * p;\n  return function elasticOut(t) {\n    return 1 - a * Math.pow(2, -10 * (t = +t)) * Math.sin((t + s) / p);\n  };\n})();\n","// Provides a global registry of running components\nexport function registerComponentInstance(component, name) {\n  window.APP.componentRegistry = window.APP.componentRegistry || {};\n  window.APP.componentRegistry[name] = window.APP.componentRegistry[name] || [];\n  window.APP.componentRegistry[name].push(component);\n}\n\nexport function deregisterComponentInstance(component, name) {\n  if (!window.APP.componentRegistry || !window.APP.componentRegistry[name]) return;\n  window.APP.componentRegistry[name].splice(window.APP.componentRegistry[name].indexOf(component), 1);\n}\n\nexport function getCurrentStreamer() {\n  if (!window.APP || !window.APP.componentRegistry || !window.APP.hubChannel || !window.APP.hubChannel.presence)\n    return null;\n  const playerInfos = window.APP.componentRegistry[\"player-info\"] || [];\n  const presences = window.APP.hubChannel.presence.state;\n\n  for (let i = 0; i < playerInfos.length; i++) {\n    const playerInfo = playerInfos[i];\n    const presence = presences[playerInfo.playerSessionId];\n\n    if (presence && presence.metas[0] && presence.metas[0].streaming) {\n      return playerInfo;\n    }\n  }\n\n  return null;\n}\n\nexport function getPlayerInfo(sessionId) {\n  const playerInfos = window.APP?.componentRegistry[\"player-info\"] || [];\n  return playerInfos.find(info => {\n    return info.playerSessionId === sessionId;\n  });\n}\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { easeOutQuadratic } from \"../utils/easing\";\nimport { registerComponentInstance, deregisterComponentInstance } from \"../utils/component-utils\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\n\n// This computation is expensive, so we run on at most one avatar per frame, including quiet avatars.\n// However if we detect an avatar is seen speaking (its volume is above DISABLE_AT_VOLUME_THRESHOLD)\n// then we continue analysis for at least DISABLE_GRACE_PERIOD_MS and disable doing it every frame if\n// the avatar is quiet during that entire duration (eg they are muted)\nconst DISABLE_AT_VOLUME_THRESHOLD = 0.00001;\nconst DISABLE_GRACE_PERIOD_MS = 10000;\nconst IS_TALKING_THRESHOLD_MS = 1000;\nconst MIN_VOLUME_THRESHOLD = 0.08;\n\nconst calculateVolume = (analyser, levels) => {\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n  analyser.getByteTimeDomainData(levels);\n  let sum = 0;\n  for (let i = 0; i < levels.length; i++) {\n    const amplitude = (levels[i] - 128) / 128;\n    sum += amplitude * amplitude;\n  }\n  const currVolume = Math.sqrt(sum / levels.length);\n  return currVolume;\n};\n\nfunction updateVolume(component) {\n  const newRawVolume = calculateVolume(component.analyser, component.levels);\n\n  const newPerceivedVolume = Math.log(THREE.MathUtils.mapLinear(newRawVolume, 0, 1, 1, Math.E));\n\n  component.volume = newPerceivedVolume < MIN_VOLUME_THRESHOLD ? 0 : newPerceivedVolume;\n\n  const s = component.volume > component.prevVolume ? 0.35 : 0.3;\n  component.volume = s * component.volume + (1 - s) * component.prevVolume;\n  component.prevVolume = component.volume;\n}\n\n/**\n * Updates a `volume` property based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.disableUpdates = true;\n    this.avatarIsTalking = false;\n\n    this._updateAnalysis = this._updateAnalysis.bind(this);\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"audio-analyser\");\n    this.el.addEventListener(\n      \"sound-source-set\",\n      event => {\n        const ctx = THREE.AudioContext.getContext();\n        this.analyser = ctx.createAnalyser();\n        this.analyser.fftSize = 32;\n        this.levels = new Uint8Array(this.analyser.fftSize);\n        event.detail.soundSource.connect(this.analyser);\n      },\n      { once: true }\n    );\n\n    this.playerSessionId = findAncestorWithComponent(this.el, \"player-info\").components[\"player-info\"].playerSessionId;\n    registerComponentInstance(this, \"networked-audio-analyser\");\n  },\n\n  remove: function() {\n    deregisterComponentInstance(this, \"networked-audio-analyser\");\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"audio-analyser\");\n  },\n\n  tick: function(t) {\n    if (!this.disableUpdates) {\n      this._updateAnalysis(t);\n    }\n  },\n\n  _runScheduledWork: function() {\n    if (this.disableUpdates) {\n      this._updateAnalysis();\n    }\n  },\n\n  // Updates the analysis/volume. If t is passed, that implies this is called via tick\n  // and so as a performance optimization will check to see if it's been at least DISABLE_GRACE_PERIOD_MS\n  // since the last volume was seen above DISABLE_AT_VOLUME_THRESHOLD, and if so, will disable\n  // tick updates until the volume exceeds the level again.\n  _updateAnalysis: function(t) {\n    if (!this.analyser) return;\n\n    updateVolume(this);\n\n    if (this.volume < DISABLE_AT_VOLUME_THRESHOLD) {\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - DISABLE_GRACE_PERIOD_MS) {\n        this.disableUpdates = true;\n      }\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - IS_TALKING_THRESHOLD_MS) {\n        this.avatarIsTalking = false;\n      }\n    } else {\n      if (t) {\n        this.lastSeenVolume = t;\n      }\n\n      this.disableUpdates = false;\n      this.avatarIsTalking = true;\n    }\n  }\n});\n\nfunction getAnalyser(el) {\n  // Is this the local player\n  const ikRootEl = findAncestorWithComponent(el, \"ik-root\");\n  if (ikRootEl && ikRootEl.id === \"avatar-rig\") {\n    return el.sceneEl.systems[\"local-audio-analyser\"];\n  } else {\n    const analyserEl = findAncestorWithComponent(el, \"networked-audio-analyser\");\n    if (!analyserEl) return null;\n    return analyserEl.components[\"networked-audio-analyser\"];\n  }\n}\n\n/**\n * Calculates volume of the local audio stream.\n */\nAFRAME.registerSystem(\"local-audio-analyser\", {\n  init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n\n    this.onMicEnabled = this.onMicEnabled.bind(this);\n    this.el.addEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, this.onMicEnabled);\n  },\n\n  remove() {\n    this.el.removeEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, this.onMicEnabled);\n  },\n\n  onMicEnabled() {\n    const audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n    this.analyser = audioSystem.outboundAnalyser;\n    this.levels = audioSystem.analyserLevels;\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // TODO Ideally, when muted no audio should ever even make it into the analyser to begin with\n    if (APP.dialog.isMicEnabled) {\n      updateVolume(this);\n    } else {\n      this.prevVolume = this.volume;\n      this.volume = 0;\n    }\n  }\n});\n\n/**\n * Sets an entity's scale base on the volume of an audio-analyser in a parent entity.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 1.5 }\n  },\n\n  async init() {\n    await waitForDOMContentLoaded();\n    this.cameraEl = document.getElementById(\"viewing-camera\");\n  },\n\n  tick() {\n    if (!this.cameraEl) return;\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\n\n    this.el.object3D.scale.setScalar(\n      THREE.MathUtils.mapLinear(this.analyser?.volume || 0, 0, 1, this.data.minScale, this.data.maxScale)\n    );\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n\n/**\n * Animates a morph target based on an audio-analyser in a parent entity\n * @namespace avatar\n * @component morph-audio-feedback\n */\nAFRAME.registerComponent(\"morph-audio-feedback\", {\n  schema: {\n    name: { default: \"\" },\n    minValue: { default: 0 },\n    maxValue: { default: 2 }\n  },\n\n  init() {\n    const meshes = [];\n    if (this.el.object3DMap.skinnedmesh) {\n      meshes.push(this.el.object3DMap.skinnedmesh);\n    } else if (this.el.object3DMap.group) {\n      // skinned mesh with multiple materials\n      this.el.object3DMap.group.traverse(o => o.isSkinnedMesh && meshes.push(o));\n    }\n    if (meshes.length) {\n      this.morphs = meshes\n        .map(mesh => ({ mesh, morphNumber: mesh.morphTargetDictionary[this.data.name] }))\n        .filter(m => m.morphNumber !== undefined);\n    }\n  },\n\n  tick() {\n    if (!this.morphs || !this.morphs.length) return;\n\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\n\n    const { minValue, maxValue } = this.data;\n    const morphValue = THREE.MathUtils.mapLinear(\n      easeOutQuadratic(this.analyser ? this.analyser.volume : 0),\n      0,\n      1,\n      minValue,\n      maxValue\n    );\n    for (let i = 0; i < this.morphs.length; i++) {\n      this.morphs[i].mesh.morphTargetInfluences[this.morphs[i].morphNumber] = morphValue;\n    }\n  }\n});\n\nconst SPRITE_NAMES = {\n  MIC: [\"mic-0.png\", \"mic-1.png\", \"mic-2.png\", \"mic-3.png\", \"mic-4.png\", \"mic-5.png\", \"mic-6.png\", \"mic-7.png\"],\n  MIC_HOVER: [\n    \"mic-0_hover.png\",\n    \"mic-1_hover.png\",\n    \"mic-2_hover.png\",\n    \"mic-3_hover.png\",\n    \"mic-4_hover.png\",\n    \"mic-5_hover.png\",\n    \"mic-6_hover.png\",\n    \"mic-7_hover.png\"\n  ],\n  MIC_OFF: [\n    \"mic-off-0.png\",\n    \"mic-off-1.png\",\n    \"mic-off-2.png\",\n    \"mic-off-3.png\",\n    \"mic-off-4.png\",\n    \"mic-off-5.png\",\n    \"mic-off-6.png\",\n    \"mic-off-7.png\"\n  ],\n  MIC_OFF_HOVER: [\n    \"mic-off-0_hover.png\",\n    \"mic-off-1_hover.png\",\n    \"mic-off-2_hover.png\",\n    \"mic-off-3_hover.png\",\n    \"mic-off-4_hover.png\",\n    \"mic-off-5_hover.png\",\n    \"mic-off-6_hover.png\",\n    \"mic-off-7_hover.png\"\n  ]\n};\n\nexport function micLevelForVolume(volume) {\n  return THREE.MathUtils.clamp(Math.ceil(THREE.MathUtils.mapLinear(volume - 0.05, 0, 1, 0, 7)), 0, 7);\n}\n\nAFRAME.registerComponent(\"mic-button\", {\n  schema: {\n    active: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.prevSpriteName = \"\";\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.hovering = false;\n    this.onHover = () => {\n      this.hovering = true;\n      this.data.tooltip.setAttribute(\"visible\", true);\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.data.tooltip.setAttribute(\"visible\", false);\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    if (this.data.tooltip) {\n      this.textEl = this.data.tooltip.querySelector(\"[text]\");\n    }\n  },\n\n  tick() {\n    const audioAnalyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\n    const active = this.data.active;\n    const hovering = this.hovering;\n    const spriteNames =\n      SPRITE_NAMES[active ? (hovering ? \"MIC_HOVER\" : \"MIC\") : hovering ? \"MIC_OFF_HOVER\" : \"MIC_OFF\"];\n    const level = micLevelForVolume(audioAnalyser.volume);\n    const spriteName = spriteNames[level];\n    if (spriteName !== this.prevSpriteName) {\n      this.prevSpriteName = spriteName;\n      this.el.setAttribute(\"sprite\", \"name\", spriteName);\n    }\n\n    if (this.data.tooltip && hovering) {\n      this.textEl = this.textEl || this.data.tooltip.querySelector(\"[text]\");\n      this.textEl.setAttribute(\"text\", \"value\", active ? this.data.activeTooltipText : this.data.tooltipText);\n    }\n  }\n});\n","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"application/vnd.apple.mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"application/x-mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\nconst srcSuffixLookupMap = {\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.toLowerCase().startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  if (src) {\n    for (const suffix in srcSuffixLookupMap) {\n      if (src.toLowerCase().endsWith(suffix)) {\n        const types = srcSuffixLookupMap[suffix];\n        return objectTypeForOrigin(contentOrigin, ...types);\n      }\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","export default \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n  float ratio = 0.0;\\n  float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\";","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function updateMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material = object3D.material.map(fn);\n  } else {\n    object3D.material = fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return [];\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return [fn(object3D.material)];\n  }\n}\n\n// HubsMeshBasicMaterial exists because we need to be able to set the emissiveMap in the avatar preview.\n// It also allows the material to be properly copied/cloned.\nclass HubsMeshBasicMaterial extends THREE.MeshBasicMaterial {\n  static fromMeshStandardMaterial(source) {\n    const material = new HubsMeshBasicMaterial();\n\n    THREE.Material.prototype.copy.call(material, source);\n\n    material.color.copy(source.color);\n\n    material.emissive.copy(source.emissive);\n    material.emissiveIntensity = source.emissiveIntensity;\n    material.emissiveMap = source.emissiveMap;\n\n    material.map = source.map;\n\n    material.lightMap = source.lightMap;\n    // See https://github.com/mrdoob/three.js/pull/23613 for \"* Math.PI\"\n    material.lightMapIntensity = source.lightMapIntensity * Math.PI;\n\n    material.aoMap = source.aoMap;\n    material.aoMapIntensity = source.aoMapIntensity;\n\n    material.alphaMap = source.alphaMap;\n\n    material.wireframe = source.wireframe;\n    material.wireframeLinewidth = source.wireframeLinewidth;\n    material.wireframeLinecap = source.wireframeLinecap;\n    material.wireframeLinejoin = source.wireframeLinejoin;\n\n    return material;\n  }\n\n  constructor({ emissive, emissiveMap, emissiveIntensity, ...rest } = {}) {\n    super(rest);\n    this._emissive = { value: emissive || new THREE.Color() };\n    this._emissiveIntensity = { value: emissiveIntensity === undefined ? 1 : emissiveIntensity };\n    this._emissiveMap = { value: emissiveMap };\n  }\n\n  get emissive() {\n    return this._emissive.value;\n  }\n\n  set emissive(emissive) {\n    this._emissive.value = emissive;\n  }\n\n  get emissiveIntensity() {\n    return this._emissiveIntensity.value;\n  }\n\n  set emissiveIntensity(emissiveIntensity) {\n    this._emissiveIntensity.value = emissiveIntensity;\n  }\n\n  get emissiveMap() {\n    return this._emissiveMap.value;\n  }\n\n  set emissiveMap(emissiveMap) {\n    this._emissiveMap.value = emissiveMap;\n  }\n\n  copy(source) {\n    super.copy(source);\n    this.emissive.copy(source.emissive);\n    this.emissiveIntensity = source.emissiveIntensity;\n    this.emissiveMap = source.emissiveMap;\n    return this;\n  }\n\n  onBeforeCompile = shader => {\n    // This patch to the MeshBasicMaterial adds support for emissive maps.\n    shader.uniforms.emissive = this._emissive;\n    shader.uniforms.emissiveIntensity = this._emissiveIntensity;\n    shader.uniforms.emissiveMap = this._emissiveMap;\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <lightmap_pars_fragment>\",\n      `#include <lightmap_pars_fragment>\n      uniform vec3 emissive;\n      uniform sampler2D emissiveMap;\n      `\n    );\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <envmap_fragment>\",\n      `#include <envmap_fragment>\n\n      vec3 totalEmissiveRadiance = emissive;\n      #include <emissivemap_fragment>\n      outgoingLight += totalEmissiveRadiance;\n\n      `\n    );\n  };\n}\n\nclass HubsMeshPhongMaterial extends THREE.MeshPhongMaterial {\n  static fromMeshStandardMaterial(source) {\n    const material = new HubsMeshPhongMaterial();\n\n    THREE.Material.prototype.copy.call(material, source);\n\n    material.color.copy(source.color);\n\n    material.map = source.map;\n\n    material.lightMap = source.lightMap;\n    material.lightMapIntensity = source.lightMapIntensity;\n\n    material.aoMap = source.aoMap;\n    material.aoMapIntensity = source.aoMapIntensity;\n\n    material.emissive.copy(source.emissive);\n    material.emissiveMap = source.emissiveMap;\n    material.emissiveIntensity = source.emissiveIntensity;\n\n    material.normalMapType = source.normalMapType;\n    material.normalMap = source.normalMap;\n    material.normalScale.copy(source.normalScale);\n\n    material.bumpMap = source.bumpMap;\n    material.bumpScale = source.bumpScale;\n\n    material.displacementMap = source.displacementMap;\n    material.displacementScale = source.displacementScale;\n    material.displacementBias = source.displacementBias;\n\n    material.alphaMap = source.alphaMap;\n\n    material.reflectivity = 0.5;\n    material.refractionRatio = source.refractionRatio;\n\n    material.wireframe = source.wireframe;\n    material.wireframeLinewidth = source.wireframeLinewidth;\n    material.wireframeLinecap = source.wireframeLinecap;\n    material.wireframeLinejoin = source.wireframeLinejoin;\n\n    return material;\n  }\n\n  onBeforeCompile = shader => {\n    // This patch to MeshPhongMaterial adds support for tangent space normal maps.\n    shader.vertexShader = shader.vertexShader.replace(\n      \"varying vec3 vNormal;\",\n      `varying vec3 vNormal;\n      #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n      #endif\n      `\n    );\n    shader.vertexShader = shader.vertexShader.replace(\n      \"vNormal = normalize( transformedNormal );\",\n      `vNormal = normalize( transformedNormal );\n      \n        #ifdef USE_TANGENT\n      \n          vTangent = normalize( transformedTangent );\n          vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n      \n        #endif\n      `\n    );\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <lights_phong_pars_fragment>\",\n      `#include <lights_phong_pars_fragment>\n      #ifndef FLAT_SHADED\n\n        #ifdef USE_TANGENT\n          varying vec3 vTangent;\n          varying vec3 vBitangent;\n        #endif\n\n      #endif\n      `\n    );\n  };\n}\n\nexport function convertStandardMaterial(source, quality) {\n  if (!source.isMeshStandardMaterial) {\n    return source;\n  }\n\n  if (quality === \"medium\") {\n    return HubsMeshPhongMaterial.fromMeshStandardMaterial(source);\n  } else if (quality === \"low\") {\n    return HubsMeshBasicMaterial.fromMeshStandardMaterial(source);\n  }\n\n  return source;\n}\n\nexport function disposeTexture(texture) {\n  if (texture.dash) {\n    texture.dash.reset();\n  }\n\n  if (texture.image instanceof HTMLVideoElement) {\n    const video = texture.image;\n    video.pause();\n    video.src = \"\";\n    video.load();\n  }\n\n  if (texture.hls) {\n    texture.hls.stopLoad();\n    texture.hls.detachMedia();\n    texture.hls.destroy();\n    texture.hls = null;\n  }\n\n  texture.dispose();\n}\n","import { isIOS as detectIOS } from \"../utils/is-mobile\";\n\nconst isIOS = detectIOS();\n\n// Disable ImageBitmap for Firefox so far because\n// createImageBitmap() with option fails on Firefox due to the bug.\n// Three.js ImageBitmapLoader passes {colorSpaceConversion: 'none'} option.\n// Without the option, the rendering result can be wrong if image file has ICC profiles.\n// See https://github.com/mrdoob/three.js/pull/21336\nconst HAS_IMAGE_BITMAP =\n  window.createImageBitmap !== undefined && /Firefox/.test(navigator.userAgent) === false && !isIOS;\nexport const TEXTURES_FLIP_Y = !HAS_IMAGE_BITMAP;\n\n// Browsers on iOS devices can crash if huge or many textures are used in a room.\n// Perhaps huge VRAM usage may cause it. We already reported it to the webkit devs.\n// Until the root issue is fixed on iOS end, we resize huge texture images in the\n// low material quality mode as workaround. It isn't a perfect solution but it\n// should mitigate the problem. Also disable image bitmap (See the above)\n// because huge textures resize + image bitmap can still even crash browsers.\n//\n// See\n//   - https://github.com/mozilla/hubs/issues/5295\n//   - https://bugs.webkit.org/show_bug.cgi?id=241478\n\nconst IOS_TEXTURE_MAX_WIDTH = 2048;\nconst IOS_TEXTURE_MAX_HEIGHT = 2048;\n\nfunction resizeIfNeeded(texture) {\n  if (!isIOS || window.APP.store.state.preferences.materialQualitySetting !== \"low\") {\n    return texture;\n  }\n\n  const image = texture.image;\n\n  // Just in case.\n  if (!image || image.width === undefined || image.height === undefined) {\n    return texture;\n  }\n\n  if (image.width <= IOS_TEXTURE_MAX_WIDTH && image.height <= IOS_TEXTURE_MAX_HEIGHT) {\n    return texture;\n  }\n\n  const conversionRatio = Math.min(IOS_TEXTURE_MAX_WIDTH / image.width, IOS_TEXTURE_MAX_HEIGHT / image.height);\n\n  const newWidth = Math.round(image.width * conversionRatio);\n  const newHeight = Math.round(image.height * conversionRatio);\n\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = newWidth;\n  canvas.height = newHeight;\n  const context = canvas.getContext(\"2d\");\n  context.drawImage(image, 0, 0, newWidth, newHeight);\n\n  texture.image = canvas;\n\n  if (image.close !== undefined) {\n    image.close();\n  }\n\n  texture.format = THREE.RGBAFormat;\n  texture.type = THREE.UnsignedByteType;\n  return texture;\n}\n\nexport default class HubsTextureLoader extends THREE.TextureLoader {\n  constructor(manager) {\n    super(manager);\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const callback = texture => {\n      resizeIfNeeded(texture);\n      if (onLoad) {\n        onLoad(texture);\n      }\n    };\n\n    const texture = HAS_IMAGE_BITMAP\n      ? this._loadImageBitmapTexture(url, callback, onProgress, onError)\n      : super.load(url, callback, onProgress, onError);\n\n    texture.onUpdate = function() {\n      // Delete texture data once it has been uploaded to the GPU\n      texture.image.close && texture.image.close();\n      texture.image = null;\n    };\n\n    return texture;\n  }\n\n  async loadAsync(url, onProgress) {\n    return new Promise((resolve, reject) => {\n      this.load(url, resolve, onProgress, reject);\n    });\n  }\n\n  _loadImageBitmapTexture(url, onLoad, onProgress, onError) {\n    const texture = new THREE.Texture();\n    const loader = new THREE.ImageBitmapLoader(this.manager);\n    loader.setCrossOrigin(this.crossOrigin);\n    loader.setPath(this.path);\n\n    loader.load(\n      url,\n      bitmap => {\n        texture.image = bitmap;\n        texture.needsUpdate = true;\n\n        // We close the image bitmap when it's uploaded to texture.\n        // Closed image bitmap can't be reused so we remove the cache\n        // added in ImageBitmapLoader.\n        // You can remove this line once we entirely disable THREE.Cache.\n        THREE.Cache.remove(this.manager.resolveURL(url));\n\n        if (onLoad !== undefined) {\n          onLoad(texture);\n        }\n      },\n      onProgress,\n      onError\n    );\n\n    texture.flipY = false;\n    return texture;\n  }\n}\n","import { showHoverEffect } from \"../utils/permissions-utils\";\n\nconst interactorOneTransform = [];\nconst interactorTwoTransform = [];\n\nexport const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MeshPhongMaterial\"];\n/**\n * Applies effects to a hoverable based on hover state.\n * @namespace interactables\n * @component hoverable-visuals\n */\nAFRAME.registerComponent(\"hoverable-visuals\", {\n  schema: {\n    enableSweepingEffect: { type: \"boolean\", default: true }\n  },\n  init() {\n    // uniforms and boundingSphere are set from the component responsible for loading the mesh.\n    this.uniforms = null;\n    this.geometryRadius = 0;\n\n    this.sweepParams = [0, 0];\n  },\n  remove() {\n    this.uniforms = null;\n    this.boundingBox = null;\n\n    const isMobile = AFRAME.utils.device.isMobile();\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\n    this.isTouchscreen = isMobile && !isMobileVR;\n  },\n  tick(time) {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const showEffect = showHoverEffect(this.el);\n    const toggling = this.el.sceneEl.systems[\"hubs-systems\"].cursorTogglingSystem;\n\n    let interactorOne, interactorTwo;\n    const interaction = this.el.sceneEl.systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    if (interaction.state.leftHand.hovered === this.el && !interaction.state.leftHand.held) {\n      interactorOne = interaction.options.leftHand.entity.object3D;\n    }\n    if (\n      interaction.state.leftRemote.hovered === this.el &&\n      !interaction.state.leftRemote.held &&\n      !toggling.leftToggledOff\n    ) {\n      interactorOne = interaction.options.leftRemote.entity.object3D;\n    }\n    if (\n      interaction.state.rightRemote.hovered === this.el &&\n      !interaction.state.rightRemote.held &&\n      !toggling.rightToggledOff\n    ) {\n      interactorTwo = interaction.options.rightRemote.entity.object3D;\n    }\n    if (interaction.state.rightHand.hovered === this.el && !interaction.state.rightHand.held) {\n      interactorTwo = interaction.options.rightHand.entity.object3D;\n    }\n\n    if (interactorOne) {\n      interactorOne.matrixWorld.toArray(interactorOneTransform);\n    }\n    if (interactorTwo) {\n      interactorTwo.matrixWorld.toArray(interactorTwoTransform);\n    }\n\n    if (interactorOne || interactorTwo || isFrozen) {\n      const worldY = this.el.object3D.matrixWorld.elements[13];\n      const ms1 = this.el.object3D.matrixWorld.elements[4];\n      const ms2 = this.el.object3D.matrixWorld.elements[5];\n      const ms3 = this.el.object3D.matrixWorld.elements[6];\n      const worldScale = Math.sqrt(ms1 * ms1 + ms2 * ms2 + ms3 * ms3);\n      const scaledRadius = worldScale * this.geometryRadius;\n      this.sweepParams[0] = worldY - scaledRadius;\n      this.sweepParams[1] = worldY + scaledRadius;\n    }\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_EnableSweepingEffect.value = this.data.enableSweepingEffect && showEffect;\n      uniform.hubs_IsFrozen.value = isFrozen;\n      uniform.hubs_SweepParams.value = this.sweepParams;\n\n      uniform.hubs_HighlightInteractorOne.value = !!interactorOne && showEffect && !this.isTouchscreen;\n      uniform.hubs_InteractorOnePos.value[0] = interactorOneTransform[12];\n      uniform.hubs_InteractorOnePos.value[1] = interactorOneTransform[13];\n      uniform.hubs_InteractorOnePos.value[2] = interactorOneTransform[14];\n\n      uniform.hubs_HighlightInteractorTwo.value = !!interactorTwo && showEffect && !this.isTouchscreen;\n      uniform.hubs_InteractorTwoPos.value[0] = interactorTwoTransform[12];\n      uniform.hubs_InteractorTwoPos.value[1] = interactorTwoTransform[13];\n      uniform.hubs_InteractorTwoPos.value[2] = interactorTwoTransform[14];\n\n      if (interactorOne || interactorTwo || isFrozen) {\n        uniform.hubs_Time.value = time;\n      }\n    }\n  }\n});\n","import { hasReticulumServer } from \"./phoenix-utils\";\nimport configs from \"./configs\";\n\nconst nonCorsProxyDomains = (configs.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (configs.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(configs.CORS_PROXY_SERVER.split(\":\")[0]);\n}\nnonCorsProxyDomains.push(document.location.hostname);\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\",\n  basis: \"image/basis\",\n  ktx2: \"image/ktx2\",\n  m3u8: \"application/vnd.apple.mpegurl\",\n  mpd: \"application/dash+xml\"\n};\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url).replace(/=+$/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  let extension = \"\";\n  try {\n    const pathParts = new URL(url).pathname.split(\".\");\n\n    if (pathParts.length > 1) {\n      const extensionCandidate = pathParts.pop();\n      if (commonKnownContentTypes[extensionCandidate]) {\n        extension = `.${extensionCandidate}`;\n      }\n    }\n  } catch (e) {\n    extension = \".png\";\n  }\n\n  // HACK: the extension is needed to ensure CDN caching on Cloudflare\n  const thumbnailUrl = `https://${configs.THUMBNAIL_SERVER}/thumbnail/${farsparkEncodeUrl(\n    url\n  )}${extension}?w=${width}&h=${height}`;\n\n  try {\n    const urlHostname = new URL(url).hostname;\n\n    if (hasReticulumServer()) {\n      const retHostname = new URL(`https://${configs.RETICULUM_SERVER}`).hostname;\n      if (retHostname === urlHostname) return url;\n    }\n  } catch (e) {\n    return thumbnailUrl;\n  }\n\n  return thumbnailUrl;\n};\n\nexport const isNonCorsProxyDomain = hostname => {\n  return nonCorsProxyDomains.find(domain => hostname.endsWith(domain));\n};\n\nexport const proxiedUrlFor = url => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  // Skip known domains that do not require CORS proxying.\n  try {\n    const parsedUrl = new URL(url);\n    if (isNonCorsProxyDomain(parsedUrl.hostname)) return url;\n  } catch (e) {\n    // Ignore\n  }\n\n  return `https://${configs.CORS_PROXY_SERVER}/${url}`;\n};\n\nexport function getAbsoluteUrl(baseUrl, relativeUrl) {\n  return new URL(relativeUrl, baseUrl);\n}\n\nexport function getAbsoluteHref(baseUrl, relativeUrl) {\n  return getAbsoluteUrl(baseUrl, relativeUrl).href;\n}\n\n// Note these files are configured in webpack.config.js to be handled with file-loader, so this will be a string containing the file paths\nimport basisJsUrl from \"three/examples/js/libs/basis/basis_transcoder.js\";\nimport dracoWrapperJsUrl from \"three/examples/js/libs/draco/gltf/draco_wasm_wrapper.js\";\nimport basisWasmUrl from \"three/examples/js/libs/basis/basis_transcoder.wasm\";\nimport dracoWasmUrl from \"three/examples/js/libs/draco/gltf/draco_decoder.wasm\";\n\nexport const rewriteBasisTranscoderUrls = function (url) {\n  if (url === \"basis_transcoder.js\") {\n    return basisJsUrl;\n  } else if (url === \"basis_transcoder.wasm\") {\n    return basisWasmUrl;\n  }\n  return url;\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  // Intercept loading of basis transcoder with content hashed urls\n  if (url === \"basis_transcoder.js\") {\n    return basisJsUrl;\n  } else if (url === \"basis_transcoder.wasm\") {\n    return basisWasmUrl;\n  } else if (url === \"draco_wasm_wrapper.js\") {\n    return dracoWrapperJsUrl;\n  } else if (url === \"draco_decoder.wasm\") {\n    return dracoWasmUrl;\n  }\n\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return proxiedUrlFor(url);\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (configs.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nconst dataUrlRegex = /data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/;\n\nexport const guessContentType = url => {\n  if (!url) return;\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  if (url.startsWith(\"data:\")) {\n    const matches = dataUrlRegex.exec(url);\n    if (matches.length > 0) {\n      matches[1];\n    }\n  }\n  const extension = new URL(url, window.location).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nconst originIsHubsServer = new Map();\nasync function isHubsServer(url) {\n  if (!url) return false;\n  if (!url.startsWith(\"http\")) {\n    url = \"https://\" + url;\n  }\n  const { origin } = new URL(url);\n\n  if (originIsHubsServer.has(origin)) {\n    return originIsHubsServer.get(origin);\n  }\n\n  let isHubsServer;\n  try {\n    isHubsServer = (await fetch(proxiedUrlFor(origin), { method: \"HEAD\" })).headers.has(\"hub-name\");\n  } catch (e) {\n    isHubsServer = false;\n  }\n  originIsHubsServer.set(origin, isHubsServer);\n  return isHubsServer;\n}\n\nconst hubsSceneRegex = /https?:\\/\\/[^/]+\\/scenes\\/[a-zA-Z0-9]{7}(?:\\/|$)/;\nconst hubsAvatarRegex = /https?:\\/\\/[^/]+\\/avatars\\/(?<id>[a-zA-Z0-9]{7})(?:\\/|$)/;\nconst hubsRoomRegex = /(https?:\\/\\/)?[^/]+\\/(?<id>[a-zA-Z0-9]{7})(?:\\/|$)/;\n\nexport const isLocalHubsUrl = async url =>\n  (await isHubsServer(url)) && new URL(url).origin === document.location.origin;\n\nexport const isHubsSceneUrl = async url => (await isHubsServer(url)) && hubsSceneRegex.test(url);\nexport const isLocalHubsSceneUrl = async url => (await isHubsSceneUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsAvatarUrl = async url => (await isHubsServer(url)) && hubsAvatarRegex.test(url);\nexport const isLocalHubsAvatarUrl = async url => (await isHubsAvatarUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsRoomUrl = async url =>\n  (await isHubsServer(url)) &&\n  !(await isHubsAvatarUrl(url)) &&\n  !(await isHubsSceneUrl(url)) &&\n  url.match(hubsRoomRegex)?.groups.id;\n\nexport const isHubsDestinationUrl = async url =>\n  (await isHubsServer(url)) && ((await isHubsSceneUrl(url)) || (await isHubsRoomUrl(url)));\n\nexport const idForAvatarUrl = url => {\n  const match = url.match(hubsAvatarRegex);\n  if (match) {\n    return match.groups.id;\n  }\n  return null;\n};\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl, getDirectReticulumFetchUrl } from \"./phoenix-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\nimport { updateMaterials } from \"./material-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { validMaterials } from \"../components/hoverable-visuals\";\nimport { proxiedUrlFor, guessContentType } from \"../utils/media-url-utils\";\nimport { isIOS as detectIOS } from \"./is-mobile\";\nimport Linkify from \"linkify-it\";\nimport tlds from \"tlds\";\n\nimport anime from \"animejs\";\n\nexport const MediaType = {\n  MODEL: 1 << 0,\n  IMAGE: 1 << 1,\n  VIDEO: 1 << 2,\n  PDF: 1 << 3\n};\nMediaType.ALL = MediaType.MODEL | MediaType.IMAGE | MediaType.VIDEO | MediaType.PDF;\nMediaType.ALL_2D = MediaType.IMAGE | MediaType.VIDEO | MediaType.PDF;\n\nconst linkify = Linkify();\nlinkify.tlds(tlds);\n\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\nconst getDirectMediaAPIEndpoint = () => getDirectReticulumFetchUrl(\"/api/v1/media\");\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobile();\n\n// Map<String, Promise<Object>\nconst resolveUrlCache = new Map();\nexport const getDefaultResolveQuality = (is360 = false) => {\n  const useLowerQuality = isMobile || isMobileVR;\n  return !is360 ? (useLowerQuality ? \"low\" : \"high\") : useLowerQuality ? \"low_360\" : \"high_360\";\n};\n\nexport const resolveUrl = async (url, quality = null, version = 1, bustCache) => {\n  const key = `${url}_${version}`;\n  if (!bustCache && resolveUrlCache.has(key)) return resolveUrlCache.get(key);\n\n  const resultPromise = fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, quality: quality || getDefaultResolveQuality() }, version })\n  }).then(async response => {\n    if (!response.ok) {\n      const message = `Error resolving url \"${url}\":`;\n      try {\n        const body = await response.text();\n        throw new Error(message + \" \" + body);\n      } catch (e) {\n        throw new Error(message + \" \" + response.statusText);\n      }\n    }\n    return response.json();\n  });\n\n  resolveUrlCache.set(key, resultPromise);\n  return resultPromise;\n};\n\nexport const upload = (file, desiredContentType) => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n\n  if (desiredContentType) {\n    formData.append(\"desired_content_type\", desiredContentType);\n  }\n\n  // To eliminate the extra hop and avoid proxy timeouts, upload files directly\n  // to a reticulum host.\n  return fetch(getDirectMediaAPIEndpoint(), {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nfunction getLatestMediaVersionOfSrc(src) {\n  const els = document.querySelectorAll(\"[media-loader]\");\n  let version = 1;\n\n  for (const el of els) {\n    const loader = el.components[\"media-loader\"];\n\n    if (loader.data && loader.data.src === src) {\n      version = Math.max(version, loader.data.version);\n    }\n  }\n\n  return version;\n}\n\nexport function coerceToUrl(urlOrText) {\n  if (!linkify.test(urlOrText)) return urlOrText;\n\n  // See: https://github.com/Soapbox/linkifyjs/blob/master/src/linkify.js#L52\n  return urlOrText.indexOf(\"://\") >= 0 ? urlOrText : `https://${urlOrText}`;\n}\n\nexport const addMedia = (\n  src,\n  template,\n  contentOrigin,\n  contentSubtype = null,\n  resolve = false,\n  fitToBox = false,\n  animate = true,\n  mediaOptions = {},\n  networked = true,\n  parentEl = null,\n  linkedEl = null\n) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n\n  const nid = NAF.utils.createNetworkId();\n  if (networked) {\n    entity.setAttribute(\"networked\", { template: template, networkId: nid });\n  } else {\n    const templateBody = document\n      .importNode(document.body.querySelector(template).content, true)\n      .firstElementChild.cloneNode(true);\n    const elAttrs = templateBody.attributes;\n\n    // Merge root element attributes with this entity\n    for (let attrIdx = 0; attrIdx < elAttrs.length; attrIdx++) {\n      entity.setAttribute(elAttrs[attrIdx].name, elAttrs[attrIdx].value);\n    }\n\n    // Append all child elements\n    while (templateBody.firstElementChild) {\n      entity.appendChild(templateBody.firstElementChild);\n    }\n  }\n\n  const needsToBeUploaded = src instanceof File;\n\n  // If we're re-pasting an existing src in the scene, we should use the latest version\n  // seen across any other entities. Otherwise, start with version 1.\n  const version = getLatestMediaVersionOfSrc(src);\n\n  entity.setAttribute(\"media-loader\", {\n    fitToBox,\n    resolve,\n    animate,\n    src: typeof src === \"string\" ? coerceToUrl(src) || src : \"\",\n    version,\n    contentSubtype,\n    fileIsOwned: !needsToBeUploaded,\n    linkedEl,\n    mediaOptions\n  });\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  (parentEl || scene).appendChild(entity);\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    // Video camera videos are converted to mp4 for compatibility\n    const desiredContentType = contentSubtype === \"video-camera\" ? \"video/mp4\" : src.type || guessContentType(src.name);\n\n    upload(src, desiredContentType)\n      .then(response => {\n        const srcUrl = new URL(proxiedUrlFor(response.origin));\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport const cloneMedia = (sourceEl, template, src = null, networked = true, link = false, parentEl = null) => {\n  if (!src) {\n    ({ src } = sourceEl.components[\"media-loader\"].data);\n  }\n\n  const { contentSubtype, fitToBox, mediaOptions } = sourceEl.components[\"media-loader\"].data;\n\n  return addMedia(\n    src,\n    template,\n    ObjectContentOrigins.URL,\n    contentSubtype,\n    true,\n    fitToBox,\n    false,\n    mediaOptions,\n    networked,\n    parentEl,\n    link ? sourceEl : null\n  );\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const shaderUniforms = [];\n\n  obj.traverse(object => {\n    if (!object.material || object.isTroikaText) return;\n\n    // TODO this does not really belong here\n    object.reflectionProbeMode = \"dynamic\";\n\n    updateMaterials(object, material => {\n      if (material.hubs_InjectedCustomShaderChunks) return material;\n      if (!validMaterials.includes(material.type)) {\n        return material;\n      }\n\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\n      // hover/toggle state, so for now just skip these while we figure out a more correct\n      // solution.\n      if (\n        object.el &&\n        (object.el.classList.contains(\"ui\") ||\n          object.el.classList.contains(\"hud\") ||\n          object.el.getAttribute(\"text-button\"))\n      )\n        return material;\n\n      const newMaterial = material.clone();\n      newMaterial.onBeforeCompile = (shader, renderer) => {\n        if (shader.vertexShader.indexOf(\"#include <skinning_vertex>\") == -1) return;\n\n        if (material.onBeforeCompile) {\n          material.onBeforeCompile(shader, renderer);\n        }\n\n        shader.uniforms.hubs_IsFrozen = { value: false };\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n        shader.uniforms.hubs_Time = { value: 0 };\n\n        shader.vertexShader =\n          [\n            \"varying vec3 hubs_WorldPosition;\",\n            \"uniform bool hubs_IsFrozen;\",\n            \"uniform bool hubs_HighlightInteractorOne;\",\n            \"uniform bool hubs_HighlightInteractorTwo;\\n\"\n          ].join(\"\\n\") +\n          shader.vertexShader.replace(\n            \"#include <skinning_vertex>\",\n            `#include <skinning_vertex>\n             if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n              vec4 wt = modelMatrix * vec4(transformed, 1);\n\n              // Used in the fragment shader below.\n              hubs_WorldPosition = wt.xyz;\n            }`\n          );\n\n        shader.fragmentShader =\n          [\n            \"varying vec3 hubs_WorldPosition;\",\n            \"uniform bool hubs_IsFrozen;\",\n            \"uniform bool hubs_EnableSweepingEffect;\",\n            \"uniform vec2 hubs_SweepParams;\",\n            \"uniform bool hubs_HighlightInteractorOne;\",\n            \"uniform vec3 hubs_InteractorOnePos;\",\n            \"uniform bool hubs_HighlightInteractorTwo;\",\n            \"uniform vec3 hubs_InteractorTwoPos;\",\n            \"uniform float hubs_Time;\\n\"\n          ].join(\"\\n\") +\n          shader.fragmentShader.replace(\n            \"#include <output_fragment>\",\n            \"#include <output_fragment>\\n\" + mediaHighlightFrag\n          );\n\n        shaderUniforms.push(shader.uniforms);\n      };\n      newMaterial.needsUpdate = true;\n      newMaterial.hubs_InjectedCustomShaderChunks = true;\n      return newMaterial;\n    });\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n\nconst mediaPos = new THREE.Vector3();\n\nexport function addAndArrangeMedia(el, media, contentSubtype, snapCount, mirrorOrientation = false, distance = 0.75) {\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, contentSubtype, false);\n\n  const pos = el.object3D.position;\n\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\n  entity.object3D.rotation.copy(el.object3D.rotation);\n\n  if (mirrorOrientation) {\n    entity.object3D.rotateY(Math.PI);\n  }\n\n  // Generate photos in a circle around camera, starting from the bottom.\n  // Prevent z-fighting but place behind viewfinder\n  const idx = (snapCount % 6) + 3;\n\n  mediaPos.set(\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * distance,\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * distance,\n    -0.05 + idx * 0.001\n  );\n\n  el.object3D.localToWorld(mediaPos);\n  entity.object3D.visible = false;\n\n  const handler = () => {\n    entity.object3D.visible = true;\n    entity.setAttribute(\"animation__photo_pos\", {\n      property: \"position\",\n      dur: 800,\n      from: { x: pos.x, y: pos.y, z: pos.z },\n      to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\n      easing: \"easeOutElastic\"\n    });\n  };\n\n  let eventType = null;\n\n  if (contentSubtype.startsWith(\"photo\")) {\n    entity.addEventListener(\"image-loaded\", handler, { once: true });\n    eventType = \"photo\";\n  } else if (contentSubtype.startsWith(\"video\")) {\n    entity.addEventListener(\"video-loaded\", handler, { once: true });\n    eventType = \"video\";\n  } else {\n    console.error(\"invalid type \" + contentSubtype);\n    return;\n  }\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      el.emit(`${eventType}_taken`, entity.components[\"media-loader\"].data.src);\n    },\n    { once: true }\n  );\n\n  return { entity, orientation };\n}\n\nexport const textureLoader = new HubsTextureLoader().setCrossOrigin(\"anonymous\");\n\nexport async function createImageTexture(url, filter) {\n  let texture;\n\n  if (filter) {\n    const image = new Image();\n    image.crossOrigin = \"anonymous\";\n    const load = new Promise(res => image.addEventListener(\"load\", res, { once: true }));\n    image.src = url;\n    await load;\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0);\n    await filter(ctx, image.width, image.height);\n\n    texture = new THREE.CanvasTexture(canvas);\n  } else {\n    try {\n      texture = await textureLoader.loadAsync(url);\n    } catch (e) {\n      throw new Error(`'${url}' could not be fetched (Error code: ${e.status}; Response: ${e.statusText})`);\n    }\n  }\n\n  texture.encoding = THREE.sRGBEncoding;\n  texture.anisotropy = 4;\n\n  return texture;\n}\n\nconst isIOS = detectIOS();\n\n/**\n * Create video element to be used as a texture.\n *\n * @param {string} src - Url to a video file.\n * @returns {Element} Video element.\n */\nexport function createVideoOrAudioEl(type) {\n  const el = document.createElement(type);\n  el.setAttribute(\"playsinline\", \"\");\n  el.setAttribute(\"webkit-playsinline\", \"\");\n  // iOS Safari requires the autoplay attribute, or it won't play the video at all.\n  el.autoplay = true;\n  // iOS Safari will not play videos without user interaction. We mute the video so that it can autoplay and then\n  // allow the user to unmute it with an interaction in the unmute-video-button component.\n  el.muted = isIOS;\n  el.preload = \"auto\";\n  el.crossOrigin = \"anonymous\";\n  // Audio should default to zero or it be heard before it is positioning and adjusted\n  el.volume = 0;\n  return el;\n}\n\nexport function addMeshScaleAnimation(mesh, initialScale, onComplete) {\n  const step = (function() {\n    const lastValue = {};\n    return function(anim) {\n      const value = anim.animatables[0].target;\n\n      value.x = Math.max(Number.MIN_VALUE, value.x);\n      value.y = Math.max(Number.MIN_VALUE, value.y);\n      value.z = Math.max(Number.MIN_VALUE, value.z);\n\n      // For animation timeline.\n      if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n        return;\n      }\n\n      lastValue.x = value.x;\n      lastValue.y = value.y;\n      lastValue.z = value.z;\n\n      mesh.scale.set(value.x, value.y, value.z);\n      mesh.matrixNeedsUpdate = true;\n    };\n  })();\n\n  const config = {\n    duration: 400,\n    easing: \"easeOutElastic\",\n    elasticity: 400,\n    loop: 0,\n    round: false,\n    x: mesh.scale.x,\n    y: mesh.scale.y,\n    z: mesh.scale.z,\n    targets: [initialScale],\n    update: anim => step(anim),\n    complete: anim => {\n      step(anim);\n      if (onComplete) onComplete();\n    }\n  };\n\n  mesh.scale.copy(initialScale);\n  mesh.matrixNeedsUpdate = true;\n\n  return anime(config);\n}\n\nexport function closeExistingMediaMirror() {\n  const mirrorTarget = document.querySelector(\"#media-mirror-target\");\n\n  // Remove old mirror target media element\n  if (mirrorTarget.firstChild) {\n    mirrorTarget.firstChild.setAttribute(\"animation__remove\", {\n      property: \"scale\",\n      dur: 200,\n      to: { x: 0.01, y: 0.01, z: 0.01 },\n      easing: \"easeInQuad\"\n    });\n\n    return new Promise(res => {\n      mirrorTarget.firstChild.addEventListener(\"animationcomplete\", () => {\n        mirrorTarget.removeChild(mirrorTarget.firstChild);\n        mirrorTarget.parentEl.object3D.visible = false;\n        res();\n      });\n    });\n  }\n}\n\nexport function hasAudioTracks(el) {\n  if (!el) return false;\n\n  // `audioTracks` is the \"correct\" way to check this but is not implemented by most browsers\n  // The rest of the checks are a bit of a race condition, but when loading videos we wait for\n  // the first frame to load, so audio should exist by then. We special case audio-only by checkin\n  // for a 0 size video. Not great...\n  if (el.audioTracks !== undefined) {\n    return el.audioTracks.length > 0;\n  } else if (el.videoWidth === 0 && el.videoHeight === 0) {\n    return true;\n  } else if (el.mozHasAudio !== undefined) {\n    return el.mozHasAudio;\n  } else if (el.webkitAudioDecodedByteCount !== undefined) {\n    return el.webkitAudioDecodedByteCount > 0;\n  } else {\n    return false;\n  }\n}\n","/* global AFRAME */\nimport { textureLoader } from \"../utils/media-utils\";\n\nimport actionButtonSrc from \"../assets/hud/action_button.9.png\";\nimport buttonSrc from \"../assets/hud/button.9.png\";\nimport nametagSrc from \"../assets/hud/nametag.9.png\";\nimport nametagBorderSrc from \"../assets/hud/nametag-border.9.png\";\n\nconst textures = {\n  \"action-button\": {\n    tex: textureLoader.load(actionButtonSrc),\n    width: 128,\n    height: 128\n  },\n  button: {\n    tex: textureLoader.load(buttonSrc),\n    width: 128,\n    height: 128\n  },\n  nametag: {\n    tex: textureLoader.load(nametagSrc),\n    width: 128,\n    height: 128\n  },\n  \"nametag-border\": {\n    tex: textureLoader.load(nametagBorderSrc),\n    width: 128,\n    height: 128\n  }\n};\n\nfunction parseSide(side) {\n  switch (side) {\n    case \"back\": {\n      return THREE.BackSide;\n    }\n    case \"double\": {\n      return THREE.DoubleSide;\n    }\n    default: {\n      // Including case `front`.\n      return THREE.FrontSide;\n    }\n  }\n}\n\n/**\n * Slice9 component for A-Frame.\n */\nAFRAME.registerComponent(\"slice9\", {\n  schema: {\n    alphaTest: { default: 0.0 },\n    bottom: { default: 0, min: 0 },\n    color: { type: \"color\", default: \"#fff\" },\n    debug: { default: false },\n    height: { default: 1, min: 0 },\n    left: { default: 0, min: 0 },\n    opacity: { default: 1.0, min: 0, max: 1 },\n    padding: { default: 0.1, min: 0.01 },\n    right: { default: 0, min: 0 },\n    side: { default: \"front\", oneOf: [\"front\", \"back\", \"double\"] },\n    src: { oneOf: Object.keys(textures) },\n    top: { default: 0, min: 0 },\n    transparent: { default: true },\n    width: { default: 1, min: 0 },\n    usingCustomMaterial: { default: false },\n    usingAtlas: { default: false },\n    uvAtlasMin: { type: \"vec2\" },\n    uvAtlasMax: { type: \"vec2\" }\n  },\n\n  init: function() {\n    const data = this.data;\n\n    this.textureSrc = null;\n\n    const geometry = (this.geometry = new THREE.PlaneBufferGeometry(data.width, data.height, 3, 3));\n\n    // Create mesh.\n    if (data.usingCustomMaterial) {\n      this.plane = new THREE.Mesh(geometry);\n    } else {\n      const material = new THREE.MeshBasicMaterial({\n        alphaTest: data.alphaTest,\n        color: data.color,\n        opacity: data.opacity,\n        transparent: data.transparent,\n        wireframe: data.debug\n      });\n      this.plane = new THREE.Mesh(geometry, material);\n    }\n    this.el.setObject3D(\"mesh\", this.plane);\n  },\n\n  // TODO use updateSlice9Geometry\n  regenerateMesh: function() {\n    const data = this.data;\n    let height;\n    const pos = this.geometry.attributes.position.array;\n    const uvs = this.geometry.attributes.uv.array;\n    let width;\n\n    if (this.plane.material && !this.plane.material.map) {\n      return;\n    }\n\n    /*\n      0--1------------------------------2--3\n      |  |                              |  |\n      4--5------------------------------6--7\n      |  |                              |  |\n      |  |                              |  |\n      |  |                              |  |\n      8--9-----------------------------10--11\n      |  |                              |  |\n      12-13----------------------------14--15\n    */\n    function setPos(id, x, y) {\n      pos[3 * id] = x;\n      pos[3 * id + 1] = y;\n    }\n\n    function setUV(id, u, v) {\n      if (data.usingAtlas) {\n        u = data.uvAtlasMin.x + u * (data.uvAtlasMax.x - data.uvAtlasMin.x);\n        v = data.uvAtlasMin.y + v * (data.uvAtlasMax.y - data.uvAtlasMin.y);\n      }\n      uvs[2 * id] = u;\n      uvs[2 * id + 1] = v;\n    }\n\n    // Update UVS\n    if (data.usingCustomMaterial) {\n      height = 1;\n      width = 1;\n    } else {\n      height = textures[data.src].height;\n      width = textures[data.src].width;\n    }\n    const uv = {\n      left: data.left / width,\n      right: data.right / width,\n      top: data.top / height,\n      bottom: data.bottom / height\n    };\n\n    setUV(1, uv.left, 1);\n    setUV(2, uv.right, 1);\n\n    setUV(4, 0, uv.bottom);\n    setUV(5, uv.left, uv.bottom);\n    setUV(6, uv.right, uv.bottom);\n    setUV(7, 1, uv.bottom);\n\n    setUV(8, 0, uv.top);\n    setUV(9, uv.left, uv.top);\n    setUV(10, uv.right, uv.top);\n    setUV(11, 1, uv.top);\n\n    setUV(13, uv.left, 0);\n    setUV(14, uv.right, 0);\n\n    if (data.usingAtlas) {\n      setUV(0, 0, 1);\n      setUV(3, 1, 1);\n      setUV(12, 0, 0);\n      setUV(15, 1, 0);\n    }\n\n    // Update vertex positions\n    const w2 = data.width / 2;\n    const h2 = data.height / 2;\n    const left = -w2 + data.padding;\n    const right = w2 - data.padding;\n    const top = h2 - data.padding;\n    const bottom = -h2 + data.padding;\n\n    setPos(0, -w2, h2);\n    setPos(1, left, h2);\n    setPos(2, right, h2);\n    setPos(3, w2, h2);\n\n    setPos(4, -w2, top);\n    setPos(5, left, top);\n    setPos(6, right, top);\n    setPos(7, w2, top);\n\n    setPos(8, -w2, bottom);\n    setPos(9, left, bottom);\n    setPos(10, right, bottom);\n    setPos(11, w2, bottom);\n\n    setPos(13, left, -h2);\n    setPos(14, right, -h2);\n    setPos(12, -w2, -h2);\n    setPos(15, w2, -h2);\n\n    this.geometry.attributes.position.needsUpdate = true;\n    this.geometry.attributes.uv.needsUpdate = true;\n  },\n\n  update: function(oldData) {\n    const data = this.data;\n    const diff = AFRAME.utils.diff(data, oldData);\n\n    // Update material if using built-in material.\n    if (!data.usingCustomMaterial) {\n      this.plane.material.alphaTest = data.alphaTest;\n      this.plane.material.color.setStyle(data.color);\n      this.plane.material.opacity = data.opacity;\n      this.plane.material.transparent = data.transparent;\n      this.plane.material.wireframe = data.debug;\n      this.plane.material.side = parseSide(data.side);\n      this.plane.material.needsUpdate = true;\n      if (\"src\" in diff) {\n        this.updateMap();\n      }\n    }\n\n    if (\n      \"width\" in diff ||\n      \"height\" in diff ||\n      \"padding\" in diff ||\n      \"left\" in diff ||\n      \"top\" in diff ||\n      \"bottom\" in diff ||\n      \"right\" in diff\n    ) {\n      this.regenerateMesh();\n    }\n  },\n\n  setMap(texture) {\n    this.plane.material.map = texture;\n    this.plane.material.needsUpdate = true;\n    this.regenerateMesh();\n  },\n\n  /**\n   * Update `src` if using built-in material.\n   */\n  updateMap: function() {\n    const src = this.data.src;\n\n    if (src) {\n      if (src === this.textureSrc) {\n        return;\n      }\n      // Texture added or changed.\n      this.textureSrc = src;\n      this.setMap(textures[src].tex);\n      return;\n    }\n\n    // Texture removed.\n    if (!this.plane.material.map) {\n      return;\n    }\n\n    this.setMap(null);\n  },\n\n  remove() {\n    this.geometry?.dispose();\n  }\n});\n","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer, args = {}) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage(Object.assign(args, { id, payload: data }), transfer);\n    return promise;\n  };\n}\n","// NOTE when changing be sure to check hardcoded mask values in hub.html\nexport const Layers = {\n  // These 3 layers are hardcoded in THREE\n  CAMERA_LAYER_DEFAULT: 0,\n  CAMERA_LAYER_XR_LEFT_EYE: 1,\n  CAMERA_LAYER_XR_RIGHT_EYE: 2,\n\n  CAMERA_LAYER_REFLECTION: 3,\n  CAMERA_LAYER_INSPECT: 4,\n  CAMERA_LAYER_VIDEO_TEXTURE_TARGET: 5,\n\n  CAMERA_LAYER_THIRD_PERSON_ONLY: 6,\n  CAMERA_LAYER_FIRST_PERSON_ONLY: 7,\n  CAMERA_LAYER_UI: 8\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    mask: { default: Layers.CAMERA_LAYER_DEFAULT },\n    recursive: { default: false }\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"object3dset\", this.update);\n  },\n  update() {\n    const obj = this.el.object3D;\n    if (this.data.recursive) {\n      obj.traverse(o => (o.layers.mask = this.data.mask));\n    } else {\n      obj.layers.mask = this.data.mask;\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"object3dset\", this.update);\n  }\n});\n","const tempVector3 = new THREE.Vector3();\nconst tempQuaternion = new THREE.Quaternion();\n\nexport function getLastWorldPosition(src, target) {\n  src.updateMatrices();\n  target.setFromMatrixPosition(src.matrixWorld);\n  return target;\n}\n\nexport function getLastWorldQuaternion(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\n  return target;\n}\n\nexport function getLastWorldScale(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\n  return target;\n}\n\nexport function disposeMaterial(mtrl) {\n  if (mtrl.map) mtrl.map.dispose();\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\n  if (mtrl.envMap) mtrl.envMap.dispose();\n  if (mtrl.aoMap) mtrl.aoMap.dispose();\n  if (mtrl.metalnessMap) mtrl.metalnessMap.dispose();\n  if (mtrl.roughnessMap) mtrl.roughnessMap.dispose();\n  if (mtrl.emissiveMap) mtrl.emissiveMap.dispose();\n  mtrl.dispose();\n}\n\nexport function disposeNode(node) {\n  if (!(node instanceof THREE.Mesh)) return;\n\n  if (node.geometry) {\n    node.geometry.dispose();\n  }\n\n  if (node.material) {\n    if (Array.isArray(node.material)) {\n      node.material.forEach(disposeMaterial);\n    } else {\n      disposeMaterial(node.material);\n    }\n  }\n}\n\nconst IDENTITY = new THREE.Matrix4().identity();\nconst tempMatrix4 = new THREE.Matrix4();\nconst EPSILON = 0.00000000001;\nexport function setMatrixWorld(object3D, m) {\n  if (!object3D.matrixIsModified) {\n    object3D.applyMatrix4(IDENTITY); // hack around our matrix optimizations\n  }\n  tempMatrix4.copy(object3D.matrixWorld);\n  object3D.matrixWorld.copy(m);\n  if (object3D.parent) {\n    object3D.parent.updateMatrices();\n    object3D.matrix\n      .copy(object3D.parent.matrixWorld)\n      .invert()\n      .multiply(m);\n  } else {\n    object3D.matrix.copy(m);\n  }\n  object3D.matrix.decompose(object3D.position, object3D.quaternion, object3D.scale);\n  if (tempMatrix4.near(object3D.matrixWorld, EPSILON)) {\n    object3D.matrixWorld.copy(tempMatrix4);\n  } else {\n    object3D.childrenNeedMatrixWorldUpdate = true;\n  }\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\n// Supports the following PropertyBinding path formats:\n// uuid.propertyName\n// uuid.propertyName[propertyIndex]\n// uuid.objectName[objectIndex].propertyName[propertyIndex]\n// Does not support property bindings that use object3D names or parent nodes\nfunction cloneKeyframeTrack(sourceKeyframeTrack, cloneUUIDLookup) {\n  const { nodeName: uuid, objectName, objectIndex, propertyName, propertyIndex } = THREE.PropertyBinding.parseTrackName(\n    sourceKeyframeTrack.name\n  );\n\n  let path = \"\";\n\n  if (uuid !== undefined) {\n    const clonedUUID = cloneUUIDLookup.get(uuid);\n\n    if (clonedUUID === undefined) {\n      console.warn(`Could not find KeyframeTrack target with uuid: \"${uuid}\"`);\n    }\n\n    path += clonedUUID;\n  }\n\n  if (objectName !== undefined) {\n    path += \".\" + objectName;\n  }\n\n  if (objectIndex !== undefined) {\n    path += \"[\" + objectIndex + \"]\";\n  }\n\n  if (propertyName !== undefined) {\n    path += \".\" + propertyName;\n  }\n\n  if (propertyIndex !== undefined) {\n    path += \"[\" + propertyIndex + \"]\";\n  }\n\n  const clonedKeyframeTrack = sourceKeyframeTrack.clone();\n  clonedKeyframeTrack.name = path;\n\n  return clonedKeyframeTrack;\n}\n\nfunction cloneAnimationClip(sourceAnimationClip, cloneUUIDLookup) {\n  const clonedTracks = sourceAnimationClip.tracks.map(keyframeTrack =>\n    cloneKeyframeTrack(keyframeTrack, cloneUUIDLookup)\n  );\n  return new THREE.AnimationClip(sourceAnimationClip.name, sourceAnimationClip.duration, clonedTracks);\n}\n\nexport function cloneObject3D(source, preserveUUIDs) {\n  const cloneLookup = new Map();\n  const cloneUUIDLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, (sourceNode, clonedNode) => {\n    cloneLookup.set(sourceNode, clonedNode);\n  });\n\n  source.traverse(sourceNode => {\n    const clonedNode = cloneLookup.get(sourceNode);\n\n    if (preserveUUIDs) {\n      clonedNode.uuid = sourceNode.uuid;\n    }\n\n    cloneUUIDLookup.set(sourceNode.uuid, clonedNode.uuid);\n  });\n\n  source.traverse(sourceNode => {\n    const clonedNode = cloneLookup.get(sourceNode);\n\n    if (!clonedNode) {\n      return;\n    }\n\n    if (sourceNode.animations) {\n      clonedNode.animations = sourceNode.animations.map(animationClip =>\n        cloneAnimationClip(animationClip, cloneUUIDLookup)\n      );\n    }\n\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n\n    if ((clonedNode.isDirectionalLight || clonedNode.isSpotLight) && sourceNode.target) {\n      clonedNode.target = cloneLookup.get(sourceNode.target);\n    }\n\n    if (!sourceNode.isSkinnedMesh) return;\n\n    const sourceBones = sourceNode.skeleton.bones;\n\n    clonedNode.skeleton = sourceNode.skeleton.clone();\n\n    clonedNode.skeleton.bones = sourceBones.map(sourceBone => {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedNode.bind(clonedNode.skeleton, sourceNode.bindMatrix);\n  });\n\n  return clone;\n}\n\nexport function findNode(root, pred) {\n  let nodes = [root];\n  while (nodes.length) {\n    const node = nodes.shift();\n    if (pred(node)) return node;\n    if (node.children) nodes = nodes.concat(node.children);\n  }\n  return null;\n}\n\nexport const interpolateAffine = (function() {\n  const mat4 = new THREE.Matrix4();\n  const end = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  const start = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  const interpolated = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  return function(startMat4, endMat4, progress, outMat4) {\n    start.quaternion.setFromRotationMatrix(mat4.extractRotation(startMat4));\n    end.quaternion.setFromRotationMatrix(mat4.extractRotation(endMat4));\n    interpolated.quaternion.slerpQuaternions(start.quaternion, end.quaternion, progress);\n    interpolated.position.lerpVectors(\n      start.position.setFromMatrixColumn(startMat4, 3),\n      end.position.setFromMatrixColumn(endMat4, 3),\n      progress\n    );\n    interpolated.scale.lerpVectors(\n      start.scale.setFromMatrixScale(startMat4),\n      end.scale.setFromMatrixScale(endMat4),\n      progress\n    );\n    return outMat4.compose(\n      interpolated.position,\n      interpolated.quaternion,\n      interpolated.scale\n    );\n  };\n})();\n\nexport const squareDistanceBetween = (function() {\n  const posA = new THREE.Vector3();\n  const posB = new THREE.Vector3();\n  return function(objA, objB) {\n    objA.updateMatrices();\n    objB.updateMatrices();\n    posA.setFromMatrixColumn(objA.matrixWorld, 3);\n    posB.setFromMatrixColumn(objB.matrixWorld, 3);\n    return posA.distanceToSquared(posB);\n  };\n})();\n\nexport function isAlmostUniformVector3(v, epsilonHalf = 0.005) {\n  return Math.abs(v.x - v.y) < epsilonHalf && Math.abs(v.x - v.z) < epsilonHalf;\n}\nexport function almostEqual(a, b, epsilon = 0.01) {\n  return Math.abs(a - b) < epsilon;\n}\n\nexport const affixToWorldUp = (function() {\n  const inRotationMat4 = new THREE.Matrix4();\n  const inForward = new THREE.Vector3();\n  const outForward = new THREE.Vector3();\n  const outSide = new THREE.Vector3();\n  const worldUp = new THREE.Vector3(); // Could be called \"outUp\"\n  const v = new THREE.Vector3();\n  const inMat4Copy = new THREE.Matrix4();\n  return function affixToWorldUp(inMat4, outMat4) {\n    inRotationMat4.identity().extractRotation(inMat4Copy.copy(inMat4));\n    inForward.setFromMatrixColumn(inRotationMat4, 2).multiplyScalar(-1);\n    outForward\n      .copy(inForward)\n      .sub(v.copy(inForward).projectOnVector(worldUp.set(0, 1, 0)))\n      .normalize();\n    outSide.crossVectors(outForward, worldUp);\n    outMat4.makeBasis(outSide, worldUp, outForward.multiplyScalar(-1));\n    outMat4.scale(v.setFromMatrixScale(inMat4Copy));\n    outMat4.setPosition(v.setFromMatrixColumn(inMat4Copy, 3));\n    return outMat4;\n  };\n})();\n\nexport const calculateCameraTransformForWaypoint = (function() {\n  const upAffixedCameraTransform = new THREE.Matrix4();\n  const upAffixedWaypointTransform = new THREE.Matrix4();\n  const detachFromWorldUp = new THREE.Matrix4();\n  return function calculateCameraTransformForWaypoint(cameraTransform, waypointTransform, outMat4) {\n    affixToWorldUp(cameraTransform, upAffixedCameraTransform);\n    detachFromWorldUp\n      .copy(upAffixedCameraTransform)\n      .invert()\n      .multiply(cameraTransform);\n    affixToWorldUp(waypointTransform, upAffixedWaypointTransform);\n    outMat4.copy(upAffixedWaypointTransform).multiply(detachFromWorldUp);\n  };\n})();\n\nexport const calculateViewingDistance = (function() {\n  return function calculateViewingDistance(fov, aspect, box, center, vrMode) {\n    const halfYExtents = Math.max(Math.abs(box.max.y - center.y), Math.abs(center.y - box.min.y));\n    const halfXExtents = Math.max(Math.abs(box.max.x - center.x), Math.abs(center.x - box.min.x));\n    const halfVertFOV = THREE.MathUtils.degToRad(fov / 2);\n    const halfHorFOV = Math.atan(Math.tan(halfVertFOV) * aspect) * (vrMode ? 0.5 : 1);\n    const margin = 1.05;\n    const length1 = Math.abs((halfYExtents * margin) / Math.tan(halfVertFOV));\n    const length2 = Math.abs((halfXExtents * margin) / Math.tan(halfHorFOV));\n    const length3 = Math.abs(box.max.z - center.z) + Math.max(length1, length2);\n    const length = vrMode ? Math.max(0.25, length3) : length3;\n    return length || 1.25;\n  };\n})();\n\nexport const rotateInPlaceAroundWorldUp = (function() {\n  const inMat4Copy = new THREE.Matrix4();\n  const startRotation = new THREE.Matrix4();\n  const endRotation = new THREE.Matrix4();\n  const v = new THREE.Vector3();\n  return function rotateInPlaceAroundWorldUp(inMat4, theta, outMat4) {\n    inMat4Copy.copy(inMat4);\n    return outMat4\n      .copy(endRotation.makeRotationY(theta).multiply(startRotation.extractRotation(inMat4Copy)))\n      .scale(v.setFromMatrixScale(inMat4Copy))\n      .setPosition(v.setFromMatrixPosition(inMat4Copy));\n  };\n})();\n\nexport const childMatch = (function() {\n  const inverseParentWorld = new THREE.Matrix4();\n  const childRelativeToParent = new THREE.Matrix4();\n  const childInverse = new THREE.Matrix4();\n  const newParentMatrix = new THREE.Matrix4();\n  // transform the parent such that its child matches the target\n  return function childMatch(parent, child, target) {\n    parent.updateMatrices();\n    inverseParentWorld.copy(parent.matrixWorld).invert();\n    child.updateMatrices();\n    childRelativeToParent.multiplyMatrices(inverseParentWorld, child.matrixWorld);\n    childInverse.copy(childRelativeToParent).invert();\n    newParentMatrix.multiplyMatrices(target, childInverse);\n    setMatrixWorld(parent, newParentMatrix);\n  };\n})();\n\nexport function createPlaneBufferGeometry(width, height, widthSegments, heightSegments, flipY = true) {\n  const geometry = new THREE.PlaneBufferGeometry(width, height, widthSegments, heightSegments);\n  // Three.js seems to assume texture flipY is true for all its built in geometry\n  // but we turn this off on our texture loader since createImageBitmap in Firefox\n  // does not support flipping. Then we flip the uv for flipY = false texture.\n  if (flipY === false) {\n    const uv = geometry.getAttribute(\"uv\");\n    for (let i = 0; i < uv.count; i++) {\n      uv.setY(i, 1.0 - uv.getY(i));\n    }\n  }\n  return geometry;\n}\n\nimport { Layers } from \"../components/layers\";\n\n// This code is from three-vrm. We will likely be using that in the future and this inlined code can go away\nfunction excludeTriangles(triangles, bws, skinIndex, exclude) {\n  let count = 0;\n  if (bws != null && bws.length > 0) {\n    for (let i = 0; i < triangles.length; i += 3) {\n      const a = triangles[i];\n      const b = triangles[i + 1];\n      const c = triangles[i + 2];\n      const bw0 = bws[a];\n      const skin0 = skinIndex[a];\n\n      if (bw0[0] > 0 && exclude.includes(skin0[0])) continue;\n      if (bw0[1] > 0 && exclude.includes(skin0[1])) continue;\n      if (bw0[2] > 0 && exclude.includes(skin0[2])) continue;\n      if (bw0[3] > 0 && exclude.includes(skin0[3])) continue;\n\n      const bw1 = bws[b];\n      const skin1 = skinIndex[b];\n      if (bw1[0] > 0 && exclude.includes(skin1[0])) continue;\n      if (bw1[1] > 0 && exclude.includes(skin1[1])) continue;\n      if (bw1[2] > 0 && exclude.includes(skin1[2])) continue;\n      if (bw1[3] > 0 && exclude.includes(skin1[3])) continue;\n\n      const bw2 = bws[c];\n      const skin2 = skinIndex[c];\n      if (bw2[0] > 0 && exclude.includes(skin2[0])) continue;\n      if (bw2[1] > 0 && exclude.includes(skin2[1])) continue;\n      if (bw2[2] > 0 && exclude.includes(skin2[2])) continue;\n      if (bw2[3] > 0 && exclude.includes(skin2[3])) continue;\n\n      triangles[count++] = a;\n      triangles[count++] = b;\n      triangles[count++] = c;\n    }\n  }\n  return count;\n}\n\nfunction createErasedMesh(src, erasingBonesIndex) {\n  const dst = new THREE.SkinnedMesh(src.geometry.clone(), src.material);\n  dst.name = `${src.name}(headless)`;\n  dst.frustumCulled = src.frustumCulled;\n  dst.layers.set(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n\n  const geometry = dst.geometry;\n\n  const skinIndexAttr = geometry.getAttribute(\"skinIndex\").array;\n  const skinIndex = [];\n  for (let i = 0; i < skinIndexAttr.length; i += 4) {\n    skinIndex.push([skinIndexAttr[i], skinIndexAttr[i + 1], skinIndexAttr[i + 2], skinIndexAttr[i + 3]]);\n  }\n\n  const skinWeightAttr = geometry.getAttribute(\"skinWeight\").array;\n  const skinWeight = [];\n  for (let i = 0; i < skinWeightAttr.length; i += 4) {\n    skinWeight.push([skinWeightAttr[i], skinWeightAttr[i + 1], skinWeightAttr[i + 2], skinWeightAttr[i + 3]]);\n  }\n\n  const index = geometry.getIndex();\n  if (!index) {\n    throw new Error(\"The geometry doesn't have an index buffer\");\n  }\n  const oldTriangles = Array.from(index.array);\n\n  const count = excludeTriangles(oldTriangles, skinWeight, skinIndex, erasingBonesIndex);\n  const newTriangle = [];\n  for (let i = 0; i < count; i++) {\n    newTriangle[i] = oldTriangles[i];\n  }\n  geometry.setIndex(newTriangle);\n\n  if (src.onBeforeRender) {\n    dst.onBeforeRender = src.onBeforeRender;\n  }\n\n  dst.bind(new THREE.Skeleton(src.skeleton.bones, src.skeleton.boneInverses), new THREE.Matrix4());\n\n  return dst;\n}\n\nfunction isEraseTarget(bone) {\n  return bone.name === \"Head\" || (bone.parent && isEraseTarget(bone.parent));\n}\n\nexport function createHeadlessModelForSkinnedMesh(mesh) {\n  const eraseBoneIndexes = [];\n  mesh.skeleton.bones.forEach((bone, index) => {\n    if (isEraseTarget(bone)) eraseBoneIndexes.push(index);\n  });\n\n  if (!eraseBoneIndexes.length) {\n    mesh.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n    mesh.layers.enable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n    return;\n  }\n\n  mesh.layers.set(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n\n  return createErasedMesh(mesh, eraseBoneIndexes);\n}\n\nexport function createModelForSkinnedMesh(mesh) {\n  return createErasedMesh(mesh, []);\n}\n\nexport const isFacingCamera = (function() {\n  const objWorldDir = new THREE.Vector3();\n  const objWorld = new THREE.Vector3();\n  const camWorld = new THREE.Vector3();\n  return function isFacingCamera(obj) {\n    const playerCamera = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n    playerCamera.getWorldPosition(camWorld);\n    obj.getWorldPosition(objWorld);\n    obj.getWorldDirection(objWorldDir);\n    return objWorldDir.dot(objWorld.sub(camWorld)) < 0;\n  };\n})();\n","import nextTick from \"../utils/next-tick\";\nimport { updateMaterials, mapMaterials, convertStandardMaterial } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-url-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nimport { disposeNode, cloneObject3D } from \"../utils/three-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { KTX2Loader } from \"three/examples/jsm/loaders/KTX2Loader\";\nimport { RGBELoader } from \"three/examples/jsm/loaders/RGBELoader\";\nimport { BasisTextureLoader } from \"three/examples/jsm/loaders/BasisTextureLoader\";\nimport { DRACOLoader } from \"three/examples/jsm/loaders/DRACOLoader\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\n\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nclass GLTFCache {\n  cache = new Map();\n\n  set(src, gltf) {\n    this.cache.set(src, {\n      gltf,\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached gltf ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    if (cacheItem.count <= 0) {\n      cacheItem.gltf.scene.traverse(disposeNode);\n      this.cache.delete(src);\n    }\n  }\n}\nexport const gltfCache = new GLTFCache();\nconst inflightGltfs = new Map();\n\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    console.warn(`Inflator failed. \"${componentName}\" component does not exist.`);\n    return;\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n\n      if (\n        geo.attributes.position.isInterleavedBufferAttribute ||\n        (geo.index && geo.index.isInterleavedBufferAttribute)\n      ) {\n        console.warn(\"Skipping generaton of MeshBVH for interleaved geoemtry as it is not supported\");\n        return;\n      }\n\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.scene.animations,\n    scene: cloneObject3D(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\nfunction getHubsComponentsFromMaterial(node) {\n  const material = node.material;\n\n  if (!material) {\n    return null;\n  }\n\n  return getHubsComponents(material);\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function (indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n  const materialComponents = getHubsComponentsFromMaterial(node);\n\n  const nodeHasBehavior = !!entityComponents || !!materialComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that templates can be attached to the correct AFrame entity.\n  el.object3D.name = node.name;\n\n  // Set the uuid of the `THREE.Group` to match the uuid of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.uuid = node.uuid;\n  node.uuid = THREE.MathUtils.generateUUID();\n\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  if (node.morphTargetInfluences) {\n    node.parent.morphTargetInfluences = node.morphTargetInfluences;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nasync function inflateComponents(inflatedEntity, indexToEntityMap) {\n  let isFirstInflation = true;\n  const objectInflations = [];\n\n  inflatedEntity.object3D.traverse(async object3D => {\n    const objectInflation = {};\n    objectInflation.promise = new Promise(resolve => (objectInflation.resolve = resolve));\n    objectInflations.push(objectInflation);\n\n    if (!isFirstInflation) {\n      await objectInflations.shift().promise;\n    }\n    isFirstInflation = false;\n\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    function resolveNodeRefs(componentData) {\n      for (const propName in componentData) {\n        const value = componentData[propName];\n        const type = value?.__mhc_link_type;\n        if (type === \"node\" && value.index !== undefined) {\n          if (indexToEntityMap[value.index]) {\n            componentData[propName] = indexToEntityMap[value.index].object3D;\n          } else {\n            console.warn(\"inflateComponents: invalid node reference\", propName);\n            componentData[propName] = null;\n          }\n        }\n      }\n      return componentData;\n    }\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          await inflator(\n            el,\n            componentName,\n            resolveNodeRefs(entityComponents[prop]),\n            entityComponents,\n            indexToEntityMap\n          );\n        }\n      }\n    }\n\n    const materialComponents = getHubsComponentsFromMaterial(object3D);\n\n    if (materialComponents && el) {\n      for (const prop in materialComponents) {\n        if (materialComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          await inflator(\n            el,\n            componentName,\n            resolveNodeRefs(materialComponents[prop]),\n            materialComponents,\n            indexToEntityMap\n          );\n        }\n      }\n    }\n\n    objectInflation.resolve();\n  });\n\n  await objectInflations.shift().promise;\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction getHubsComponentsExtension(node) {\n  if (node.extensions && node.extensions.MOZ_hubs_components) {\n    return node.extensions.MOZ_hubs_components;\n  } else if (node.extensions && node.extensions.HUBS_components) {\n    return node.extensions.HUBS_components;\n  } else if (node.extras && node.extras.gltfExtensions && node.extras.gltfExtensions.MOZ_hubs_components) {\n    return node.extras.gltfExtensions.MOZ_hubs_components;\n  }\n}\n\n// Versions are documented here: https://github.com/mozilla/hubs/wiki/MOZ_hubs_components-Changelog\n// Make sure to update the wiki and Spoke when bumping a version\nfunction runMigration(version, json) {\n  if (version < 2) {\n    //old heightfields will be on the same node as the nav-mesh, delete those\n    const oldHeightfieldNode = json.nodes.find(node => {\n      const components = getHubsComponentsExtension(node);\n      return components && components.heightfield && components[\"nav-mesh\"];\n    });\n    if (oldHeightfieldNode) {\n      if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.MOZ_hubs_components) {\n        delete oldHeightfieldNode.extensions.MOZ_hubs_components.heightfield;\n      } else if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.HUBS_components) {\n        delete oldHeightfieldNode.extensions.HUBS_components.heightfield;\n      } else if (\n        oldHeightfieldNode.extras &&\n        oldHeightfieldNode.extras.gltfExtensions &&\n        oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components\n      ) {\n        delete oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components;\n      }\n    }\n  }\n\n  if (version < 4) {\n    // Lights prior to version 4 should treat range === 0 as if it has zero decay\n    if (json.nodes) {\n      for (const node of json.nodes) {\n        const components = getHubsComponentsExtension(node);\n\n        if (!components) {\n          continue;\n        }\n\n        const light = components[\"spot-light\"] || components[\"point-light\"];\n\n        if (light && light.range === 0) {\n          light.decay = 0;\n        }\n      }\n    }\n  }\n}\n\nlet ktxLoader;\nlet dracoLoader;\n\nclass GLTFHubsPlugin {\n  constructor(parser, jsonPreprocessor) {\n    this.parser = parser;\n    this.jsonPreprocessor = jsonPreprocessor;\n\n    // We override glTF parser textureLoader with our HubsTextureLoader for\n    // 1. Clean up the texture image related resources after it is uploaded to WebGL texture\n    // 2. Use ImageBitmapLoader if it is available. The latest official Three.js (r128) glTF loader\n    //    attempts to use ImageBitmapLoader if it is avaiable except for Firefox.\n    //    But we want to use ImageBitmapLoader even for Firefox so we need this overriding hack.\n    // But overriding the textureLoader is hacky and it can cause future potential problems\n    // especially in upstraming Three.js. So ideally we should replace this hack\n    // with the one using more proper APIs like plugin system at some point.\n    // Note: Be careful when replacing our Three.js fork with the official upstraming one that\n    //       the latest ImageBitmapLoader passes the second argument to createImageBitmap()\n    //       but currently createImageBitmap() on Firefox fails if the second argument is defined.\n    //       https://bugzilla.mozilla.org/show_bug.cgi?id=1367251\n    //       and this is the reason why the official glTF loader doesn't use ImageBitmapLoader\n    //       for Firefox. We will need a workaround for that.\n    parser.textureLoader = new HubsTextureLoader(parser.options.manager);\n  }\n\n  beforeRoot() {\n    const parser = this.parser;\n    const jsonPreprocessor = this.jsonPreprocessor;\n\n    //\n    if (jsonPreprocessor) {\n      parser.json = jsonPreprocessor(parser.json);\n    }\n\n    // Ideally Hubs components stuffs should be handled in MozHubsComponents plugin?\n    let version = 0;\n    if (\n      parser.json.extensions &&\n      parser.json.extensions.MOZ_hubs_components &&\n      parser.json.extensions.MOZ_hubs_components.hasOwnProperty(\"version\")\n    ) {\n      version = parser.json.extensions.MOZ_hubs_components.version;\n    }\n    runMigration(version, parser.json);\n\n    // Note: Here may be rewritten with the one with parser.associations\n    const nodes = parser.json.nodes;\n    if (nodes) {\n      for (let i = 0; i < nodes.length; i++) {\n        const node = nodes[i];\n\n        if (!node.extras) {\n          node.extras = {};\n        }\n\n        node.extras.gltfIndex = i;\n      }\n    }\n  }\n\n  afterRoot(gltf) {\n    gltf.scene.traverse(object => {\n      // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n      // @TODO: Should this be fixed in the gltf loader?\n      object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n      const materialQuality = window.APP.store.state.preferences.materialQualitySetting;\n      updateMaterials(object, material => convertStandardMaterial(material, materialQuality));\n    });\n\n    // Replace animation target node name with the node uuid.\n    // I assume track name is 'nodename.property'.\n    if (gltf.animations) {\n      for (const animation of gltf.animations) {\n        for (const track of animation.tracks) {\n          const parsedPath = THREE.PropertyBinding.parseTrackName(track.name);\n          for (const scene of gltf.scenes) {\n            const node = THREE.PropertyBinding.findNode(scene, parsedPath.nodeName);\n            if (node) {\n              track.name = track.name.replace(/^[^.]*\\./, node.uuid + \".\");\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    //\n    gltf.scene.animations = gltf.animations;\n  }\n}\n\nclass GLTFHubsComponentsExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_hubs_components\";\n  }\n\n  afterRoot({ scenes, parser }) {\n    const deps = [];\n\n    const resolveComponents = (gltfRootType, obj) => {\n      const idx = parser.associations.get(obj)?.[gltfRootType];\n      if (idx === undefined) return;\n      const ext = parser.json[gltfRootType][idx].extensions?.[this.name];\n      if (!ext) return;\n\n      // TODO putting this into userData is a bit silly, we should just inflate here, but entities need to be inflated first...\n      obj.userData.gltfExtensions = Object.assign(obj.userData.gltfExtensions || {}, {\n        MOZ_hubs_components: ext\n      });\n\n      for (const componentName in ext) {\n        const props = ext[componentName];\n        for (const propName in props) {\n          const value = props[propName];\n          const type = value?.__mhc_link_type;\n          if (type && value.index !== undefined) {\n            deps.push(\n              parser.getDependency(type, value.index).then(loadedDep => {\n                // TODO similar to above, this logic being spread out in multiple places is not great...\n                // Node refences are assumed to always be in the scene graph. These referneces are late-resolved in inflateComponents\n                // otherwise they will need to be updated when cloning (which happens as part of caching).\n                if (type === \"node\") return;\n\n                if (type === \"texture\" && !parser.json.textures[value.index].extensions?.MOZ_texture_rgbe) {\n                  // For now assume all non HDR textures linked in hubs components are sRGB.\n                  // We can allow this to be overriden later if needed\n                  loadedDep.encoding = THREE.sRGBEncoding;\n                }\n\n                props[propName] = loadedDep;\n\n                return loadedDep;\n              })\n            );\n          }\n        }\n      }\n    };\n\n    for (let i = 0; i < scenes.length; i++) {\n      // TODO this should be done by GLTLoader\n      parser.associations.set(scenes[i], { scenes: i });\n      scenes[i].traverse(obj => {\n        resolveComponents(\"scenes\", obj);\n        resolveComponents(\"nodes\", obj);\n        mapMaterials(obj, resolveComponents.bind(this, \"materials\"));\n      });\n    }\n\n    return Promise.all(deps);\n  }\n}\n\nclass GLTFHubsLightMapExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_lightmap\";\n  }\n\n  // @TODO: Ideally we should use extendMaterialParams hook.\n  //        But the current official glTF loader doesn't fire extendMaterialParams\n  //        hook for unlit and specular-glossiness materials.\n  //        So using loadMaterial hook as workaround so far.\n  //        Cons is loadMaterial hook is fired as _invokeOne so\n  //        if other plugins defining loadMaterial is registered\n  //        there is a chance that this light map extension handler isn't called.\n  //        The glTF loader should be updated to remove the limitation.\n  loadMaterial(materialIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const materialDef = json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = materialDef.extensions[this.name];\n\n    const pending = [];\n\n    pending.push(parser.loadMaterial(materialIndex));\n    pending.push(parser.getDependency(\"texture\", extensionDef.index));\n\n    return Promise.all(pending).then(results => {\n      const material = results[0];\n      const lightMap = results[1];\n      material.lightMap = lightMap;\n      material.lightMapIntensity = extensionDef.intensity !== undefined ? extensionDef.intensity : 1;\n\n      // See https://github.com/mrdoob/three.js/pull/23613\n      if (material.isMeshBasicMaterial) {\n        material.lightMapIntensity *= Math.PI;\n      }\n\n      return material;\n    });\n  }\n}\n\nclass GLTFHubsTextureBasisExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_HUBS_texture_basis\";\n    this.basisLoader = null;\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    if (this.basisLoader === null) {\n      this.basisLoader = new BasisTextureLoader(parser.options.manager).detectSupport(AFRAME.scenes[0].renderer);\n    }\n\n    if (!this.basisLoader) {\n      // @TODO: Display warning (only if the extension is in extensionsRequired)?\n      return null;\n    }\n\n    console.warn(`The ${this.name} extension is deprecated, you should use KHR_texture_basisu instead.`);\n\n    const extensionDef = textureDef.extensions[this.name];\n    const source = extensionDef.source;\n\n    return parser.loadTextureImage(textureIndex, source, this.basisLoader);\n  }\n}\n\nclass GLTFMozTextureRGBE {\n  constructor(parser, loader) {\n    this.parser = parser;\n    this.loader = loader;\n    this.name = \"MOZ_texture_rgbe\";\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = textureDef.extensions[this.name];\n    const source = extensionDef.source;\n    return parser.loadTextureImage(textureIndex, source, this.loader).then(t => {\n      // TODO pretty severe artifacting when using mipmaps, disable for now\n      if (t.minFilter == THREE.NearestMipmapNearestFilter || t.minFilter == THREE.NearestMipmapLinearFilter) {\n        t.minFilter = THREE.NearestFilter;\n      } else if (t.minFilter == THREE.LinearMipmapNearestFilter || t.minFilter == THREE.LinearMipmapLinearFilter) {\n        t.minFilter = THREE.LinearFilter;\n      }\n      return t;\n    });\n  }\n}\n\nexport async function loadGLTF(src, contentType, onProgress, jsonPreprocessor) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType && (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\"))) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new GLTFLoader(loadingManager);\n  gltfLoader\n    .register(parser => new GLTFHubsComponentsExtension(parser))\n    .register(parser => new GLTFHubsPlugin(parser, jsonPreprocessor))\n    .register(parser => new GLTFHubsLightMapExtension(parser))\n    .register(parser => new GLTFHubsTextureBasisExtension(parser))\n    .register(parser => new GLTFMozTextureRGBE(parser, new RGBELoader().setDataType(THREE.HalfFloatType)));\n\n  // TODO some models are loaded before the renderer exists. This is likely things like the camera tool and loading cube.\n  // They don't currently use KTX textures but if they did this would be an issue. Fixing this is hard but is part of\n  // \"taking control of the render loop\" which is something we want to tackle for many reasons.\n  if (!ktxLoader && AFRAME && AFRAME.scenes && AFRAME.scenes[0]) {\n    ktxLoader = new KTX2Loader(loadingManager).detectSupport(AFRAME.scenes[0].renderer);\n  }\n  if (!dracoLoader && AFRAME && AFRAME.scenes && AFRAME.scenes[0]) {\n    dracoLoader = new DRACOLoader(loadingManager);\n  }\n\n  if (ktxLoader) {\n    gltfLoader.setKTX2Loader(ktxLoader);\n  }\n  if (dracoLoader) {\n    gltfLoader.setDRACOLoader(dracoLoader);\n  }\n\n  return new Promise((resolve, reject) => {\n    gltfLoader.load(gltfUrl, resolve, onProgress, reject);\n  }).finally(() => {\n    if (fileMap) {\n      // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n      Object.keys(fileMap).forEach(URL.revokeObjectURL);\n    }\n  });\n}\n\nexport async function loadModel(src, contentType = null, useCache = false, jsonPreprocessor = null) {\n  console.log(`Loading model ${src}`);\n  if (useCache) {\n    if (gltfCache.has(src)) {\n      gltfCache.retain(src);\n      return cloneGltf(gltfCache.get(src).gltf);\n    } else {\n      if (inflightGltfs.has(src)) {\n        const gltf = await inflightGltfs.get(src);\n        gltfCache.retain(src);\n        return cloneGltf(gltf);\n      } else {\n        const promise = loadGLTF(src, contentType, null, jsonPreprocessor);\n        inflightGltfs.set(src, promise);\n        const gltf = await promise;\n        inflightGltfs.delete(src);\n        gltfCache.set(src, gltf);\n        return cloneGltf(gltf);\n      }\n    }\n  } else {\n    return loadGLTF(src, contentType, null, jsonPreprocessor);\n  }\n}\n\nfunction resolveAsset(src) {\n  // If the src attribute is a selector, get the url from the asset item.\n  if (src && src.charAt(0) === \"#\") {\n    const assetEl = document.getElementById(src.substring(1));\n    if (assetEl) {\n      return assetEl.getAttribute(\"src\");\n    }\n  }\n  return src;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * allowed components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    // This can be set externally if a consumer wants to do some node preprocssing.\n    this.jsonPreprocessor = null;\n\n    this.loadTemplates();\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  update() {\n    this.applySrc(resolveAsset(this.data.src), this.data.contentType);\n  },\n\n  remove() {\n    if (this.data.useCache) {\n      const src = resolveAsset(this.data.src);\n      if (src) {\n        gltfCache.release(src);\n      }\n    }\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      if (src === this.lastSrc) return;\n\n      const lastSrc = this.lastSrc;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await loadModel(src, contentType, this.data.useCache, this.jsonPreprocessor);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene;\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(this.model.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        object3DToSet.visible = false;\n\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        await inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      if (lastSrc && this.data.useCache) {\n        gltfCache.release(lastSrc);\n      }\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      object3DToSet.visible = true;\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: object3DToSet });\n    } catch (e) {\n      gltfCache.release(src);\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","\nimport worker from \"!!../../node_modules/worker-loader/dist/runtime/inline.js\";\n\nexport default function Worker_fn() {\n  return worker(\"!function(){\\\"use strict\\\";var e,t,i=(e=function(e,t){var i=\\\"undefined\\\"!=typeof Uint8Array&&\\\"undefined\\\"!=typeof Uint16Array&&\\\"undefined\\\"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if(\\\"object\\\"!=typeof i)throw new TypeError(i+\\\"must be non-object\\\");for(var a in i)n(i,a)&&(e[a]=i[a])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,i,n,a){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+n),a);else for(var r=0;r<n;r++)e[a+r]=t[i+r]},flattenChunks:function(e){var t,i,n,a,r,o;for(n=0,t=0,i=e.length;t<i;t++)n+=e[t].length;for(o=new Uint8Array(n),a=0,t=0,i=e.length;t<i;t++)r=e[t],o.set(r,a),a+=r.length;return o}},r={arraySet:function(e,t,i,n,a){for(var r=0;r<n;r++)e[a+r]=t[i+r]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,r))},t.setTyped(i)},e(t={exports:{}},t.exports),t.exports);i.assign,i.shrinkBuf,i.setTyped,i.Buf8,i.Buf16,i.Buf32;var n=function(e,t,i,n){for(var a=65535&e|0,r=e>>>16&65535|0,o=0;0!==i;){i-=o=i>2e3?2e3:i;do{r=r+(a=a+t[n++]|0)|0}while(--o);a%=65521,r%=65521}return a|r<<16|0},a=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}(),r=function(e,t,i,n){var r=a,o=n+i;e^=-1;for(var s=n;s<o;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},o=function(e,t){var i,n,a,r,o,s,f,l,d,c,h,u,w,b,p,m,k,v,g,y,x,_,B,A,U;i=e.state,n=e.next_in,A=e.input,a=n+(e.avail_in-5),r=e.next_out,U=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),f=i.dmax,l=i.wsize,d=i.whave,c=i.wnext,h=i.window,u=i.hold,w=i.bits,b=i.lencode,p=i.distcode,m=(1<<i.lenbits)-1,k=(1<<i.distbits)-1;e:do{w<15&&(u+=A[n++]<<w,w+=8,u+=A[n++]<<w,w+=8),v=b[u&m];t:for(;;){if(u>>>=g=v>>>24,w-=g,0==(g=v>>>16&255))U[r++]=65535&v;else{if(!(16&g)){if(0==(64&g)){v=b[(65535&v)+(u&(1<<g)-1)];continue t}if(32&g){i.mode=12;break e}e.msg=\\\"invalid literal/length code\\\",i.mode=30;break e}y=65535&v,(g&=15)&&(w<g&&(u+=A[n++]<<w,w+=8),y+=u&(1<<g)-1,u>>>=g,w-=g),w<15&&(u+=A[n++]<<w,w+=8,u+=A[n++]<<w,w+=8),v=p[u&k];i:for(;;){if(u>>>=g=v>>>24,w-=g,!(16&(g=v>>>16&255))){if(0==(64&g)){v=p[(65535&v)+(u&(1<<g)-1)];continue i}e.msg=\\\"invalid distance code\\\",i.mode=30;break e}if(x=65535&v,w<(g&=15)&&(u+=A[n++]<<w,(w+=8)<g&&(u+=A[n++]<<w,w+=8)),(x+=u&(1<<g)-1)>f){e.msg=\\\"invalid distance too far back\\\",i.mode=30;break e}if(u>>>=g,w-=g,x>(g=r-o)){if((g=x-g)>d&&i.sane){e.msg=\\\"invalid distance too far back\\\",i.mode=30;break e}if(_=0,B=h,0===c){if(_+=l-g,g<y){y-=g;do{U[r++]=h[_++]}while(--g);_=r-x,B=U}}else if(c<g){if(_+=l+c-g,(g-=c)<y){y-=g;do{U[r++]=h[_++]}while(--g);if(_=0,c<y){y-=g=c;do{U[r++]=h[_++]}while(--g);_=r-x,B=U}}}else if(_+=c-g,g<y){y-=g;do{U[r++]=h[_++]}while(--g);_=r-x,B=U}for(;y>2;)U[r++]=B[_++],U[r++]=B[_++],U[r++]=B[_++],y-=3;y&&(U[r++]=B[_++],y>1&&(U[r++]=B[_++]))}else{_=r-x;do{U[r++]=U[_++],U[r++]=U[_++],U[r++]=U[_++],y-=3}while(y>2);y&&(U[r++]=U[_++],y>1&&(U[r++]=U[_++]))}break}}break}}while(n<a&&r<s);n-=y=w>>3,u&=(1<<(w-=y<<3))-1,e.next_in=n,e.next_out=r,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=r<s?s-r+257:257-(r-s),i.hold=u,i.bits=w},s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],c=function(e,t,n,a,r,o,c,h){var u,w,b,p,m,k,v,g,y,x=h.bits,_=0,B=0,A=0,U=0,C=0,S=0,T=0,R=0,z=0,E=0,L=null,j=0,O=new i.Buf16(16),D=new i.Buf16(16),H=null,I=0;for(_=0;_<=15;_++)O[_]=0;for(B=0;B<a;B++)O[t[n+B]]++;for(C=x,U=15;U>=1&&0===O[U];U--);if(C>U&&(C=U),0===U)return r[o++]=20971520,r[o++]=20971520,h.bits=1,0;for(A=1;A<U&&0===O[A];A++);for(C<A&&(C=A),R=1,_=1;_<=15;_++)if(R<<=1,(R-=O[_])<0)return-1;if(R>0&&(0===e||1!==U))return-1;for(D[1]=0,_=1;_<15;_++)D[_+1]=D[_]+O[_];for(B=0;B<a;B++)0!==t[n+B]&&(c[D[t[n+B]]++]=B);if(0===e?(L=H=c,k=19):1===e?(L=s,j-=257,H=f,I-=257,k=256):(L=l,H=d,k=-1),E=0,B=0,_=A,m=o,S=C,T=0,b=-1,p=(z=1<<C)-1,1===e&&z>852||2===e&&z>592)return 1;for(;;){v=_-T,c[B]<k?(g=0,y=c[B]):c[B]>k?(g=H[I+c[B]],y=L[j+c[B]]):(g=96,y=0),u=1<<_-T,A=w=1<<S;do{r[m+(E>>T)+(w-=u)]=v<<24|g<<16|y|0}while(0!==w);for(u=1<<_-1;E&u;)u>>=1;if(0!==u?(E&=u-1,E+=u):E=0,B++,0==--O[_]){if(_===U)break;_=t[n+c[B]]}if(_>C&&(E&p)!==b){for(0===T&&(T=C),m+=A,R=1<<(S=_-T);S+T<U&&!((R-=O[S+T])<=0);)S++,R<<=1;if(z+=1<<S,1===e&&z>852||2===e&&z>592)return 1;r[b=E&p]=C<<24|S<<16|m-o|0}}return 0!==E&&(r[m+E]=_-T<<24|64<<16|0),h.bits=C,0},h=-2,u=12,w=30;function b(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function p(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function m(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=\\\"\\\",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):h}function k(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,m(e)):h}function v(e,t){var i,n;return e&&e.state?(n=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?h:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,k(e))):h}function g(e,t){var i,n;return e?(n=new p,e.state=n,n.window=null,0!==(i=v(e,t))&&(e.state=null),i):h}var y,x,_=!0;function B(e){if(_){var t;for(y=new i.Buf32(512),x=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(c(1,e.lens,0,288,y,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;c(2,e.lens,0,32,x,0,e.work,{bits:5}),_=!1}e.lencode=y,e.lenbits=9,e.distcode=x,e.distbits=5}function A(e,t,n,a){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),a>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((r=o.wsize-o.wnext)>a&&(r=a),i.arraySet(o.window,t,n-a,r,o.wnext),(a-=r)?(i.arraySet(o.window,t,n-a,a,0),o.wnext=a,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}var U={inflateReset:k,inflateReset2:v,inflateResetKeep:m,inflateInit:function(e){return g(e,15)},inflateInit2:g,inflate:function(e,t){var a,s,f,l,d,p,m,k,v,g,y,x,_,U,C,S,T,R,z,E,L,j,O,D,H=0,I=new i.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return h;(a=e.state).mode===u&&(a.mode=13),d=e.next_out,f=e.output,m=e.avail_out,l=e.next_in,s=e.input,p=e.avail_in,k=a.hold,v=a.bits,g=p,y=m,j=0;e:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;v<16;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(2&a.wrap&&35615===k){a.check=0,I[0]=255&k,I[1]=k>>>8&255,a.check=r(a.check,I,2,0),k=0,v=0,a.mode=2;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&k)<<8)+(k>>8))%31){e.msg=\\\"incorrect header check\\\",a.mode=w;break}if(8!=(15&k)){e.msg=\\\"unknown compression method\\\",a.mode=w;break}if(v-=4,L=8+(15&(k>>>=4)),0===a.wbits)a.wbits=L;else if(L>a.wbits){e.msg=\\\"invalid window size\\\",a.mode=w;break}a.dmax=1<<L,e.adler=a.check=1,a.mode=512&k?10:u,k=0,v=0;break;case 2:for(;v<16;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(a.flags=k,8!=(255&a.flags)){e.msg=\\\"unknown compression method\\\",a.mode=w;break}if(57344&a.flags){e.msg=\\\"unknown header flags set\\\",a.mode=w;break}a.head&&(a.head.text=k>>8&1),512&a.flags&&(I[0]=255&k,I[1]=k>>>8&255,a.check=r(a.check,I,2,0)),k=0,v=0,a.mode=3;case 3:for(;v<32;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}a.head&&(a.head.time=k),512&a.flags&&(I[0]=255&k,I[1]=k>>>8&255,I[2]=k>>>16&255,I[3]=k>>>24&255,a.check=r(a.check,I,4,0)),k=0,v=0,a.mode=4;case 4:for(;v<16;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}a.head&&(a.head.xflags=255&k,a.head.os=k>>8),512&a.flags&&(I[0]=255&k,I[1]=k>>>8&255,a.check=r(a.check,I,2,0)),k=0,v=0,a.mode=5;case 5:if(1024&a.flags){for(;v<16;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}a.length=k,a.head&&(a.head.extra_len=k),512&a.flags&&(I[0]=255&k,I[1]=k>>>8&255,a.check=r(a.check,I,2,0)),k=0,v=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(1024&a.flags&&((x=a.length)>p&&(x=p),x&&(a.head&&(L=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),i.arraySet(a.head.extra,s,l,x,L)),512&a.flags&&(a.check=r(a.check,s,x,l)),p-=x,l+=x,a.length-=x),a.length))break e;a.length=0,a.mode=7;case 7:if(2048&a.flags){if(0===p)break e;x=0;do{L=s[l+x++],a.head&&L&&a.length<65536&&(a.head.name+=String.fromCharCode(L))}while(L&&x<p);if(512&a.flags&&(a.check=r(a.check,s,x,l)),p-=x,l+=x,L)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=8;case 8:if(4096&a.flags){if(0===p)break e;x=0;do{L=s[l+x++],a.head&&L&&a.length<65536&&(a.head.comment+=String.fromCharCode(L))}while(L&&x<p);if(512&a.flags&&(a.check=r(a.check,s,x,l)),p-=x,l+=x,L)break e}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(512&a.flags){for(;v<16;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(k!==(65535&a.check)){e.msg=\\\"header crc mismatch\\\",a.mode=w;break}k=0,v=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=u;break;case 10:for(;v<32;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}e.adler=a.check=b(k),k=0,v=0,a.mode=11;case 11:if(0===a.havedict)return e.next_out=d,e.avail_out=m,e.next_in=l,e.avail_in=p,a.hold=k,a.bits=v,2;e.adler=a.check=1,a.mode=u;case u:if(5===t||6===t)break e;case 13:if(a.last){k>>>=7&v,v-=7&v,a.mode=27;break}for(;v<3;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}switch(a.last=1&k,v-=1,3&(k>>>=1)){case 0:a.mode=14;break;case 1:if(B(a),a.mode=20,6===t){k>>>=2,v-=2;break e}break;case 2:a.mode=17;break;case 3:e.msg=\\\"invalid block type\\\",a.mode=w}k>>>=2,v-=2;break;case 14:for(k>>>=7&v,v-=7&v;v<32;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if((65535&k)!=(k>>>16^65535)){e.msg=\\\"invalid stored block lengths\\\",a.mode=w;break}if(a.length=65535&k,k=0,v=0,a.mode=15,6===t)break e;case 15:a.mode=16;case 16:if(x=a.length){if(x>p&&(x=p),x>m&&(x=m),0===x)break e;i.arraySet(f,s,l,x,d),p-=x,l+=x,m-=x,d+=x,a.length-=x;break}a.mode=u;break;case 17:for(;v<14;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(a.nlen=257+(31&k),k>>>=5,v-=5,a.ndist=1+(31&k),k>>>=5,v-=5,a.ncode=4+(15&k),k>>>=4,v-=4,a.nlen>286||a.ndist>30){e.msg=\\\"too many length or distance symbols\\\",a.mode=w;break}a.have=0,a.mode=18;case 18:for(;a.have<a.ncode;){for(;v<3;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}a.lens[N[a.have++]]=7&k,k>>>=3,v-=3}for(;a.have<19;)a.lens[N[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,O={bits:a.lenbits},j=c(0,a.lens,0,19,a.lencode,0,a.work,O),a.lenbits=O.bits,j){e.msg=\\\"invalid code lengths set\\\",a.mode=w;break}a.have=0,a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;S=(H=a.lencode[k&(1<<a.lenbits)-1])>>>16&255,T=65535&H,!((C=H>>>24)<=v);){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(T<16)k>>>=C,v-=C,a.lens[a.have++]=T;else{if(16===T){for(D=C+2;v<D;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(k>>>=C,v-=C,0===a.have){e.msg=\\\"invalid bit length repeat\\\",a.mode=w;break}L=a.lens[a.have-1],x=3+(3&k),k>>>=2,v-=2}else if(17===T){for(D=C+3;v<D;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}v-=C,L=0,x=3+(7&(k>>>=C)),k>>>=3,v-=3}else{for(D=C+7;v<D;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}v-=C,L=0,x=11+(127&(k>>>=C)),k>>>=7,v-=7}if(a.have+x>a.nlen+a.ndist){e.msg=\\\"invalid bit length repeat\\\",a.mode=w;break}for(;x--;)a.lens[a.have++]=L}}if(a.mode===w)break;if(0===a.lens[256]){e.msg=\\\"invalid code -- missing end-of-block\\\",a.mode=w;break}if(a.lenbits=9,O={bits:a.lenbits},j=c(1,a.lens,0,a.nlen,a.lencode,0,a.work,O),a.lenbits=O.bits,j){e.msg=\\\"invalid literal/lengths set\\\",a.mode=w;break}if(a.distbits=6,a.distcode=a.distdyn,O={bits:a.distbits},j=c(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,O),a.distbits=O.bits,j){e.msg=\\\"invalid distances set\\\",a.mode=w;break}if(a.mode=20,6===t)break e;case 20:a.mode=21;case 21:if(p>=6&&m>=258){e.next_out=d,e.avail_out=m,e.next_in=l,e.avail_in=p,a.hold=k,a.bits=v,o(e,y),d=e.next_out,f=e.output,m=e.avail_out,l=e.next_in,s=e.input,p=e.avail_in,k=a.hold,v=a.bits,a.mode===u&&(a.back=-1);break}for(a.back=0;S=(H=a.lencode[k&(1<<a.lenbits)-1])>>>16&255,T=65535&H,!((C=H>>>24)<=v);){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(S&&0==(240&S)){for(R=C,z=S,E=T;S=(H=a.lencode[E+((k&(1<<R+z)-1)>>R)])>>>16&255,T=65535&H,!(R+(C=H>>>24)<=v);){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}k>>>=R,v-=R,a.back+=R}if(k>>>=C,v-=C,a.back+=C,a.length=T,0===S){a.mode=26;break}if(32&S){a.back=-1,a.mode=u;break}if(64&S){e.msg=\\\"invalid literal/length code\\\",a.mode=w;break}a.extra=15&S,a.mode=22;case 22:if(a.extra){for(D=a.extra;v<D;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}a.length+=k&(1<<a.extra)-1,k>>>=a.extra,v-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=23;case 23:for(;S=(H=a.distcode[k&(1<<a.distbits)-1])>>>16&255,T=65535&H,!((C=H>>>24)<=v);){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(0==(240&S)){for(R=C,z=S,E=T;S=(H=a.distcode[E+((k&(1<<R+z)-1)>>R)])>>>16&255,T=65535&H,!(R+(C=H>>>24)<=v);){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}k>>>=R,v-=R,a.back+=R}if(k>>>=C,v-=C,a.back+=C,64&S){e.msg=\\\"invalid distance code\\\",a.mode=w;break}a.offset=T,a.extra=15&S,a.mode=24;case 24:if(a.extra){for(D=a.extra;v<D;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}a.offset+=k&(1<<a.extra)-1,k>>>=a.extra,v-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg=\\\"invalid distance too far back\\\",a.mode=w;break}a.mode=25;case 25:if(0===m)break e;if(x=y-m,a.offset>x){if((x=a.offset-x)>a.whave&&a.sane){e.msg=\\\"invalid distance too far back\\\",a.mode=w;break}x>a.wnext?(x-=a.wnext,_=a.wsize-x):_=a.wnext-x,x>a.length&&(x=a.length),U=a.window}else U=f,_=d-a.offset,x=a.length;x>m&&(x=m),m-=x,a.length-=x;do{f[d++]=U[_++]}while(--x);0===a.length&&(a.mode=21);break;case 26:if(0===m)break e;f[d++]=a.length,m--,a.mode=21;break;case 27:if(a.wrap){for(;v<32;){if(0===p)break e;p--,k|=s[l++]<<v,v+=8}if(y-=m,e.total_out+=y,a.total+=y,y&&(e.adler=a.check=a.flags?r(a.check,f,y,d-y):n(a.check,f,y,d-y)),y=m,(a.flags?k:b(k))!==a.check){e.msg=\\\"incorrect data check\\\",a.mode=w;break}k=0,v=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;v<32;){if(0===p)break e;p--,k+=s[l++]<<v,v+=8}if(k!==(4294967295&a.total)){e.msg=\\\"incorrect length check\\\",a.mode=w;break}k=0,v=0}a.mode=29;case 29:j=1;break e;case w:j=-3;break e;case 31:return-4;default:return h}return e.next_out=d,e.avail_out=m,e.next_in=l,e.avail_in=p,a.hold=k,a.bits=v,(a.wsize||y!==e.avail_out&&a.mode<w&&(a.mode<27||4!==t))&&A(e,e.output,e.next_out,y-e.avail_out)?(a.mode=31,-4):(g-=e.avail_in,y-=e.avail_out,e.total_in+=g,e.total_out+=y,a.total+=y,a.wrap&&y&&(e.adler=a.check=a.flags?r(a.check,f,y,e.next_out-y):n(a.check,f,y,e.next_out-y)),e.data_type=a.bits+(a.last?64:0)+(a.mode===u?128:0)+(20===a.mode||15===a.mode?256:0),(0===g&&0===y||4===t)&&0===j&&(j=-5),j)},inflateEnd:function(e){if(!e||!e.state)return h;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?h:(i.head=t,t.done=!1,0):h},inflateSetDictionary:function(e,t){var i,a=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?h:11===i.mode&&n(1,t,a,0)!==i.check?-3:A(e,t,a,a)?(i.mode=31,-4):(i.havedict=1,0):h},inflateInfo:\\\"pako inflate (from Nodeca project)\\\"},C=!0,S=!0;try{String.fromCharCode.apply(null,[0])}catch(e){C=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){S=!1}for(var T=new i.Buf8(256),R=0;R<256;R++)T[R]=R>=252?6:R>=248?5:R>=240?4:R>=224?3:R>=192?2:1;T[254]=T[254]=1;var z=function(e){var t,n,a,r,o,s=e.length,f=0;for(r=0;r<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(a=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(a-56320),r++),f+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(f),o=0,r=0;o<f;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(a=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(a-56320),r++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},E=function(e,t){var n,a,r,o,s=t||e.length,f=new Array(2*s);for(a=0,n=0;n<s;)if((r=e[n++])<128)f[a++]=r;else if((o=T[r])>4)f[a++]=65533,n+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&n<s;)r=r<<6|63&e[n++],o--;o>1?f[a++]=65533:r<65536?f[a++]=r:(r-=65536,f[a++]=55296|r>>10&1023,f[a++]=56320|1023&r)}return function(e,t){if(t<65537&&(e.subarray&&S||!e.subarray&&C))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n=\\\"\\\",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}(f,a)},L=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+T[e[i]]>t?i:t},j={2:\\\"need dictionary\\\",1:\\\"stream end\\\",0:\\\"\\\",\\\"-1\\\":\\\"file error\\\",\\\"-2\\\":\\\"stream error\\\",\\\"-3\\\":\\\"data error\\\",\\\"-4\\\":\\\"insufficient memory\\\",\\\"-5\\\":\\\"buffer error\\\",\\\"-6\\\":\\\"incompatible version\\\"},O=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\\\"\\\",this.state=null,this.data_type=2,this.adler=0},D=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\\\"\\\",this.comment=\\\"\\\",this.hcrc=0,this.done=!1},H=Object.prototype.toString;function I(e){if(!(this instanceof I))return new I(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:\\\"\\\"},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg=\\\"\\\",this.ended=!1,this.chunks=[],this.strm=new O,this.strm.avail_out=0;var n=U.inflateInit2(this.strm,t.windowBits);if(0!==n)throw new Error(j[n]);this.header=new D,U.inflateGetHeader(this.strm,this.header)}function N(e,t){var i=new I(t);if(i.push(e,!0),i.err)throw i.msg||j[i.err];return i.result}I.prototype.push=function(e,t){var n,a,r,o,s,f,l=this.strm,d=this.options.chunkSize,c=this.options.dictionary,h=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,\\\"string\\\"==typeof e?l.input=function(e){for(var t=new i.Buf8(e.length),n=0,a=t.length;n<a;n++)t[n]=e.charCodeAt(n);return t}(e):\\\"[object ArrayBuffer]\\\"===H.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new i.Buf8(d),l.next_out=0,l.avail_out=d),2===(n=U.inflate(l,0))&&c&&(f=\\\"string\\\"==typeof c?z(c):\\\"[object ArrayBuffer]\\\"===H.call(c)?new Uint8Array(c):c,n=U.inflateSetDictionary(this.strm,f)),-5===n&&!0===h&&(n=0,h=!1),1!==n&&0!==n)return this.onEnd(n),this.ended=!0,!1;l.next_out&&(0!==l.avail_out&&1!==n&&(0!==l.avail_in||4!==a&&2!==a)||(\\\"string\\\"===this.options.to?(r=L(l.output,l.next_out),o=l.next_out-r,s=E(l.output,r),l.next_out=o,l.avail_out=d-o,o&&i.arraySet(l.output,l.output,r,o,0),this.onData(s)):this.onData(i.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(h=!0)}while((l.avail_in>0||0===l.avail_out)&&1!==n);return 1===n&&(a=4),4===a?(n=U.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),l.avail_out=0,!0)},I.prototype.onData=function(e){this.chunks.push(e)},I.prototype.onEnd=function(e){0===e&&(\\\"string\\\"===this.options.to?this.result=this.chunks.join(\\\"\\\"):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var J={Inflate:I,inflate:N,inflateRaw:function(e,t){return(t=t||{}).raw=!0,N(e,t)},ungzip:N},P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e),this.dataView=new DataView(t),this.position=0}return e.prototype.skip=function(e){this.position+=e},e.prototype.readBytes=function(e){var t=4===e?\\\"getUint32\\\":2===e?\\\"getUint16\\\":\\\"getUint8\\\",i=this.position;return this.position+=e,this.dataView[t](i,!0)},e}(),$=function(e){for(var t=new P(e),i={};;){var n=t.readBytes(4);if(67324752!==n){if(33639248!==n)break;M(t)}else{var a=G(t);i[a.name]={buffer:a.buffer}}}return i},G=function(e){var t=0,i=void 0;e.skip(4);var n=e.readBytes(2);e.skip(8);var a=e.readBytes(4);e.skip(4);var r=e.readBytes(2),o=e.readBytes(2),s=[],f=new Uint8Array(a);for(t=0;t<r;t++)s.push(String.fromCharCode(e.readBytes(1)));for(e.skip(o),t=0;t<a;t++)f[t]=e.readBytes(1);switch(n){case 0:i=f;break;case 8:i=new Uint8Array(J.inflate(f,{raw:!0}));break;default:console.log(s.join(\\\"\\\")+\\\": unsupported compression type\\\"),i=f}return{name:s.join(\\\"\\\"),buffer:i}},M=function(e){e.skip(24);var t=e.readBytes(2),i=e.readBytes(2),n=e.readBytes(2);e.skip(12),e.skip(t),e.skip(i),e.skip(n)},V=\\\"function\\\"==typeof Promise?Promise:function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e);var i=function(){};return t((function(){i()})),{then:function(e){i=e}}},q=0,F=void 0,K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e),this._id=q,this._listeners={},this.url=t,this.files=null,q++}return e.unzip=function(t){return new V((function(i){var n=new e,a=new FileReader;a.onload=function(e){var t=e.target.result;n.files=$(t),i(n)},t instanceof Blob&&a.readAsArrayBuffer(t)}))},e.prototype.load=function(){var e=this;return new V((function(t){var i=Date.now(),n=new XMLHttpRequest;n.open(\\\"GET\\\",e.url,!0),n.responseType=\\\"arraybuffer\\\",n.onprogress=function(t){e.dispatch({type:\\\"progress\\\",loaded:t.loaded,total:t.total,elapsedTime:Date.now()-i})},n.onload=function(){e.files=$(n.response),e.dispatch({type:\\\"load\\\",elapsedTime:Date.now()-i}),t()},n.send()}))},e.prototype.extractAsBlobUrl=function(e,t){if(this.files[e].url)return this.files[e].url;var i=new Blob([this.files[e].buffer],{type:t});return this.files[e].url=URL.createObjectURL(i),this.files[e].url},e.prototype.extractAsText=function(e){var t=this.files[e].buffer;if(\\\"undefined\\\"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var i=\\\"\\\",n=0,a=t.length;n<a;n++)i+=String.fromCharCode(t[n]);return decodeURIComponent(escape(i))},e.prototype.extractAsJSON=function(e){return JSON.parse(this.extractAsText(e))},e.prototype.loadThreeJSON=function(e){var t=this,i=this.extractAsJSON(e),n=e.replace(/\\\\/.+\\\\.json$/,\\\"/\\\"),a=\\\"__ziploader_\\\"+this._id+\\\"__\\\",r=new RegExp(a);return-1!==!F.Loader.Handlers.handlers.indexOf(r)&&F.Loader.Handlers.add(r,{load:function(e){return t.loadThreeTexture(e.replace(r,\\\"\\\"))}}),F.JSONLoader.prototype.parse(i,a+n)},e.prototype.loadThreeTexture=function(e){var t=new F.Texture,i=/\\\\.jpg$/.test(e)?\\\"image/jpeg\\\":/\\\\.png$/.test(e)?\\\"image/png\\\":/\\\\.gif$/.test(e)?\\\"image/gif\\\":void 0,n=new Blob([this.files[e].buffer],{type:i});return t.image=new Image,t.image.addEventListener(\\\"load\\\",(function e(){t.needsUpdate=!0,t.image.removeEventListener(\\\"load\\\",e),URL.revokeObjectURL(t.image.src)})),t.image.src=URL.createObjectURL(n),t},e.prototype.on=function(e,t){this._listeners[e]||(this._listeners[e]=[]),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)},e.prototype.off=function(e,t){var i=this._listeners[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},e.prototype.dispatch=function(e){var t=this._listeners[e.type];if(t){e.target=this;for(var i=t.length,n=0;n<i;n++)t[n].call(this,e)}},e.prototype.clear=function(e){if(e)return URL.revokeObjectURL(this.files[e].url),void delete this.files[e];for(var t in this.files)URL.revokeObjectURL(this.files[t].url);if(delete this.files,F){var i=\\\"__ziploader_\\\"+this._id+\\\"__\\\";F.Loader.Handlers.handlers.some((function(e,t){if(e instanceof RegExp&&e.source===i)return F.Loader.Handlers.handlers.splice(t,2),!0}))}},e.install=function(e){e.THREE&&(F=e.THREE)},e}();function X(e,t,i,n,a,r,o){try{var s=e[r](o),f=s.value}catch(e){return void i(e)}s.done?t(f):Promise.resolve(f).then(n,a)}function Q(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var r=e.apply(t,i);function o(e){X(r,n,a,o,s,\\\"next\\\",e)}function s(e){X(r,n,a,o,s,\\\"throw\\\",e)}o(void 0)}))}}function W(){return(W=Q((function*(e){const t=new K(e);return t.load().then((()=>{const e={},i=i=>(e[i]=e[i]||t.extractAsBlobUrl(i),e[i]),n=JSON.parse(t.extractAsText(\\\"scene.gltf\\\"));return n.buffers&&n.buffers.forEach((e=>e.uri=i(e.uri))),n.images&&n.images.forEach((e=>e.uri=i(e.uri))),e[\\\"scene.gtlf\\\"]=URL.createObjectURL(new Blob([JSON.stringify(n,null,2)],{type:\\\"text/plain\\\"})),e}))}))).apply(this,arguments)}self.onmessage=function(){var e=Q((function*(e){try{const t=yield function(e){return W.apply(this,arguments)}(e.data.payload);self.postMessage({id:e.data.id,result:t})}catch(t){self.postMessage({id:e.data.id,err:t.message})}}));return function(t){return e.apply(this,arguments)}}()}();\\n\", \"Worker\", undefined, undefined);\n}\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    paused: { type: \"boolean\", default: false },\n    /* DEPRECATED: Use activeClipIndex instead since animation names are not unique */\n    clip: { type: \"string\", default: \"\" },\n    activeClipIndex: { type: \"int\", default: 0 },\n    activeClipIndices: { type: \"array\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n    this.currentActions = [];\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n  },\n\n  update(oldData) {\n    if (this.mixerEl) {\n      if (oldData.clip !== this.data.clip || oldData.activeClipIndex !== this.data.activeClipIndex) {\n        this.updateClip();\n      }\n\n      if (oldData.paused !== this.data.paused) {\n        for (let i = 0; i < this.currentActions.length; i++) {\n          this.currentActions[i].paused = this.data.paused;\n        }\n      }\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const { clip: clipName, activeClipIndex } = this.data;\n    const { activeClipIndices } = this.data;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clips = [];\n    if (activeClipIndices && activeClipIndices.length > 0) {\n      // Support for Spoke->Hubs activeClipIndices struct\n      clips = activeClipIndices.map(index => animations[index]);\n    } else {\n      // Support for old Spoke->Hubs { clipName, activeClipIndex } struct. Still used for Blender imports.\n      if (clipName !== \"\") {\n        const clipNames = clipName.split(\",\");\n        for (let i = 0; i < clipNames.length; i++) {\n          const n = clipNames[i];\n          const a = animations.find(({ name }) => name === n);\n          if (a) {\n            clips.push(a);\n          } else {\n            console.warn(`Could not find animation named '${n}' in ${this.el.className}`);\n          }\n        }\n      } else {\n        clips = [animations[activeClipIndex]];\n      }\n    }\n\n    if (!(clips && clips.length)) return;\n\n    this.currentActions.length = 0;\n\n    for (let i = 0; i < clips.length; i++) {\n      const action = mixer.clipAction(clips[i], this.el.object3D);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.currentActions.push(action);\n    }\n  },\n\n  destroy() {\n    for (let i = 0; i < this.currentActions.length; i++) {\n      this.currentActions[i].enabled = false;\n      this.currentActions[i].stop();\n    }\n    this.currentActions.length = 0;\n  }\n});\n","const textureToData = new Map();\nconst registeredTextures = [];\n\nexport class UVScrollSystem {\n  tick(dt) {\n    for (let i = 0; i < registeredTextures.length; i++) {\n      const map = registeredTextures[i];\n      const { offset, instances } = textureToData.get(map);\n      const { component } = instances[0];\n\n      offset.addScaledVector(component.data.speed, dt / 1000);\n\n      offset.x = offset.x % 1.0;\n      offset.y = offset.y % 1.0;\n\n      const increment = component.data.increment;\n      map.offset.x = increment.x ? offset.x - (offset.x % increment.x) : offset.x;\n      map.offset.y = increment.y ? offset.y - (offset.y % increment.y) : offset.y;\n    }\n  }\n}\n\n/**\n * Animate the UV offset of a mesh's material\n * @component uv-scroll\n */\nAFRAME.registerComponent(\"uv-scroll\", {\n  schema: {\n    speed: { type: \"vec2\", default: { x: 0, y: 0 } },\n    increment: { type: \"vec2\", default: { x: 0, y: 0 } }\n  },\n  play() {\n    const mesh = this.el.getObject3D(\"mesh\") || this.el.getObject3D(\"skinnedmesh\");\n    const material = mesh && mesh.material;\n    if (material) {\n      // We store mesh here instead of the material directly because we end up swapping out the material in injectCustomShaderChunks.\n      // We need material in the first place because of MobileStandardMaterial\n      const instance = { component: this, mesh };\n\n      this.instance = instance;\n      this.map = material.map || material.emissiveMap;\n\n      if (this.map && !textureToData.has(this.map)) {\n        textureToData.set(this.map, {\n          offset: new THREE.Vector2(),\n          instances: [instance]\n        });\n        registeredTextures.push(this.map);\n      } else if (!this.map) {\n        console.warn(\"Ignoring uv-scroll added to mesh with no scrollable texture.\");\n      } else {\n        console.warn(\n          \"Multiple uv-scroll instances added to objects sharing a texture, only the speed/increment from the first one will have any effect\"\n        );\n        textureToData.get(this.map).instances.push(instance);\n      }\n    }\n  },\n\n  pause() {\n    if (this.map) {\n      const instances = textureToData.get(this.map).instances;\n      instances.splice(instances.indexOf(this.instance), 1);\n      // If this was the last uv-scroll component for a given texture\n      if (!instances.length) {\n        textureToData.delete(this.map);\n        registeredTextures.splice(registeredTextures.indexOf(this.map), 1);\n      }\n    }\n  }\n});\n","function isVisibleUpToRoot(node, root) {\n  let child = node;\n  while (child) {\n    if (child === root) return true;\n    if (!child.visible) return false;\n    child = child.parent;\n  }\n  console.error(`Root ${root} is not an ancestor of node ${node}`);\n  return false;\n}\n\n// HACK Troika Text GlyphGeometry doesn't play nicely with this code. Also it's infinitely thin.\n// We don't particularly care about it's bounds, but its important that they are non zero since\n// other code checks for that case. Fudge it for now with a very small static box.\nconst FAKE_TROIKA_BOUNDS = new THREE.Box3(\n  new THREE.Vector3(-0.001, -0.001, -0.001),\n  new THREE.Vector3(0.001, 0.001, 0.001)\n);\n\n// TODO This whole function is suspect for manually computing bounding boxes when geometry already has code for this\nexport const computeLocalBoundingBox = (function() {\n  const vertex = new THREE.Vector3();\n  const rootInverse = new THREE.Matrix4();\n  const toRootSpace = new THREE.Matrix4();\n  return function computeLocalBoundingBox(root, box, excludeInvisible) {\n    box.makeEmpty();\n    root.updateMatrices();\n    rootInverse.copy(root.matrixWorld).invert();\n    root.traverse(node => {\n      if (excludeInvisible && !isVisibleUpToRoot(node, root)) {\n        return;\n      }\n      node.updateMatrices();\n      toRootSpace.multiplyMatrices(rootInverse, node.matrixWorld);\n      if (node.geometry) {\n        if (node.isTroikaText) {\n          box.union(FAKE_TROIKA_BOUNDS);\n        } else if (node.geometry.isGeometry) {\n          for (let i = 0; i < node.geometry.vertices; i++) {\n            vertex.copy(node.geometry.vertices[i]).applyMatrix4(toRootSpace);\n            if (isNaN(vertex.x)) continue;\n            box.expandByPoint(vertex);\n          }\n        } else if (node.geometry.isBufferGeometry && node.geometry.attributes.position) {\n          const array = node.geometry.attributes.position.array;\n          const itemSize = node.geometry.attributes.position.itemSize;\n          for (let i = 0; i < node.geometry.attributes.position.count; i++) {\n            if (itemSize === 2) {\n              vertex.set(array[2 * i], array[2 * i + 1], 0);\n            } else if (itemSize === 3) {\n              vertex.fromBufferAttribute(node.geometry.attributes.position, i);\n            } else {\n              return;\n            }\n            vertex.applyMatrix4(toRootSpace);\n            if (isNaN(vertex.x)) continue;\n            box.expandByPoint(vertex);\n          }\n        }\n      }\n    });\n  };\n})();\n\n// Computes an AABB that surrounds the object in question and all of its children.\n// Note that if the children have rotations, this probably won't return the tightest\n// possible AABB -- we could return a tighter one if we examined all of the vertices\n// of the geometry for ourselves, but we don't care enough for what we're using this\n// for to do so much work.\nexport const computeObjectAABB = (function() {\n  const bounds = new THREE.Box3();\n  return function computeObjectAABB(root, target, excludeInvisible) {\n    target.makeEmpty();\n    root.updateMatrices();\n    root.traverse(node => {\n      if (excludeInvisible && !isVisibleUpToRoot(node, root)) {\n        return;\n      }\n      node.updateMatrices();\n      const geometry = node.geometry;\n      if (geometry != null) {\n        if (geometry.boundingBox == null) {\n          geometry.computeBoundingBox();\n        }\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\n      }\n    });\n    return target;\n  };\n})();\n\nconst rotation = new THREE.Euler();\nexport function getBox(entity, boxRoot, worldSpace) {\n  const box = new THREE.Box3();\n\n  rotation.copy(entity.object3D.rotation);\n  entity.object3D.rotation.set(0, 0, 0);\n\n  entity.object3D.updateMatrices(true, true);\n  boxRoot.updateMatrices(true, true);\n  boxRoot.updateMatrixWorld(true);\n\n  computeObjectAABB(boxRoot, box, false);\n\n  if (!box.isEmpty()) {\n    if (!worldSpace) {\n      entity.object3D.worldToLocal(box.min);\n      entity.object3D.worldToLocal(box.max);\n    }\n    entity.object3D.rotation.copy(rotation);\n    entity.object3D.matrixNeedsUpdate = true;\n  }\n\n  boxRoot.matrixWorldNeedsUpdate = true;\n  boxRoot.updateMatrices();\n\n  return box;\n}\n\nexport function getScaleCoefficient(length, box) {\n  if (box.isEmpty()) return 1.0;\n\n  const { max, min } = box;\n  const dX = Math.abs(max.x - min.x);\n  const dY = Math.abs(max.y - min.y);\n  const dZ = Math.abs(max.z - min.z);\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\n  return length / lengthOfLongestComponent;\n}\n","// TODO: Reintroduce audio normalization\n// import { AudioNormalizer } from \"../utils/audio-normalizer\";\n\nexport const DISTANCE_MODEL_OPTIONS = [\"linear\", \"inverse\", \"exponential\"];\n\nexport const SourceType = Object.freeze({\n  MEDIA_VIDEO: 0,\n  AVATAR_AUDIO_SOURCE: 1,\n  SFX: 2,\n  AUDIO_TARGET: 3,\n  AUDIO_ZONE: 4\n});\n\nexport const AudioType = {\n  Stereo: \"stereo\",\n  PannerNode: \"pannernode\"\n};\n\nexport const DistanceModelType = {\n  Linear: \"linear\",\n  Inverse: \"inverse\",\n  Exponential: \"exponential\"\n};\n\nexport const PanningModelType = Object.freeze({\n  HRTF: \"HRTF\",\n  EqualPower: \"equalpower\"\n});\n\nexport const AvatarAudioDefaults = Object.freeze({\n  audioType: AudioType.PannerNode,\n  distanceModel: DistanceModelType.Inverse,\n  panningModel: PanningModelType.HRTF,\n  rolloffFactor: 5,\n  refDistance: 5,\n  maxDistance: 10000,\n  coneInnerAngle: 180,\n  coneOuterAngle: 360,\n  coneOuterGain: 0.9,\n  gain: 1.0\n});\n\nexport const MediaAudioDefaults = Object.freeze({\n  audioType: AudioType.PannerNode,\n  distanceModel: DistanceModelType.Inverse,\n  panningModel: PanningModelType.HRTF,\n  rolloffFactor: 5,\n  refDistance: 5,\n  maxDistance: 10000,\n  coneInnerAngle: 360,\n  coneOuterAngle: 0,\n  coneOuterGain: 0.9,\n  gain: 0.5\n});\n\nexport const TargetAudioDefaults = Object.freeze({\n  audioType: AudioType.PannerNode,\n  distanceModel: DistanceModelType.Inverse,\n  panningModel: PanningModelType.HRTF,\n  rolloffFactor: 5,\n  refDistance: 8,\n  maxDistance: 10000,\n  coneInnerAngle: 170,\n  coneOuterAngle: 300,\n  coneOuterGain: 0.3,\n  gain: 1.0\n});\n\nexport const GAIN_TIME_CONST = 0.2;\n","import {\n  AudioType,\n  SourceType,\n  PanningModelType,\n  MediaAudioDefaults,\n  AvatarAudioDefaults,\n  TargetAudioDefaults\n} from \"./components/audio-params\";\n\nconst defaultSettingsForSourceType = Object.freeze(\n  new Map([\n    [SourceType.MEDIA_VIDEO, MediaAudioDefaults],\n    [SourceType.AVATAR_AUDIO_SOURCE, AvatarAudioDefaults],\n    [SourceType.AUDIO_TARGET, TargetAudioDefaults]\n  ])\n);\n\nfunction applySettings(audio, settings) {\n  if (audio.panner) {\n    audio.setDistanceModel(settings.distanceModel);\n    audio.setRolloffFactor(settings.rolloffFactor);\n    audio.setRefDistance(settings.refDistance);\n    audio.setMaxDistance(settings.maxDistance);\n    audio.panner.panningModel = settings.panningModel;\n    audio.panner.coneInnerAngle = settings.coneInnerAngle;\n    audio.panner.coneOuterAngle = settings.coneOuterAngle;\n    audio.panner.coneOuterGain = settings.coneOuterGain;\n  }\n  audio.gain.gain.setTargetAtTime(settings.gain, audio.context.currentTime, 0.1);\n}\n\nexport function getOverriddenPanningModelType() {\n  switch (APP.store.state.preferences.audioPanningQuality) {\n    case \"High\":\n      return PanningModelType.HRTF;\n    case \"Low\":\n      return PanningModelType.EqualPower;\n    default:\n      return null;\n  }\n}\n\nexport function getCurrentAudioSettings(el) {\n  const sourceType = APP.sourceType.get(el);\n  const defaults = defaultSettingsForSourceType.get(sourceType);\n  const sceneOverrides = APP.sceneAudioDefaults.get(sourceType);\n  const audioOverrides = APP.audioOverrides.get(el);\n  const audioDebugPanelOverrides = APP.audioDebugPanelOverrides.get(sourceType);\n  const zoneSettings = APP.zoneOverrides.get(el);\n  const preferencesOverrides = {};\n\n  const overriddenPanningModelType = getOverriddenPanningModelType();\n\n  if (overriddenPanningModelType !== null) {\n    preferencesOverrides.panningModel = overriddenPanningModelType;\n  }\n\n  if (APP.store.state.preferences.disableLeftRightPanning) {\n    preferencesOverrides.audioType = AudioType.Stereo;\n  }\n\n  const settings = Object.assign(\n    {},\n    defaults,\n    sceneOverrides,\n    audioOverrides,\n    audioDebugPanelOverrides,\n    zoneSettings,\n    preferencesOverrides\n  );\n\n  if (APP.clippingState.has(el) || APP.mutedState.has(el)) {\n    settings.gain = 0;\n  } else if (APP.gainMultipliers.has(el)) {\n    settings.gain = settings.gain * APP.gainMultipliers.get(el);\n  }\n\n  if (APP.supplementaryAttenuation.has(el)) {\n    settings.gain = settings.gain * APP.supplementaryAttenuation.get(el);\n  }\n\n  return settings;\n}\n\nexport function getCurrentAudioSettingsForSourceType(sourceType) {\n  const defaults = defaultSettingsForSourceType.get(sourceType);\n  const sceneOverrides = APP.sceneAudioDefaults.get(sourceType);\n  const audioDebugPanelOverrides = APP.audioDebugPanelOverrides.get(sourceType);\n  return Object.assign({}, defaults, sceneOverrides, audioDebugPanelOverrides);\n}\n\nexport function updateAudioSettings(el, audio) {\n  // Follow these rules and you'll have a good time:\n  // - If a THREE.Audio or THREE.PositionalAudio is created, call this function.\n  // - If audio settings change, call this function.\n  const settings = getCurrentAudioSettings(el);\n  if (\n    (audio.panner === undefined && settings.audioType === AudioType.PannerNode) ||\n    (audio.panner !== undefined && settings.audioType === AudioType.Stereo)\n  ) {\n    el.emit(\"audio_type_changed\");\n  }\n  applySettings(audio, settings);\n}\n\nexport function shouldAddSupplementaryAttenuation(el, audio) {\n  // Never add supplemental attenuation to audios that have a panner node;\n  // The panner node adds its own attenuation.\n  if (audio.panner) return false;\n\n  // This function must distinguish between Audios that are \"incidentally\"\n  // not PositionalAudios from Audios that are \"purposefully\" not PositionalAudios:\n  // - An audio is \"incidentally\" non-positional if it only non-positional\n  //     because the disableLeftRightPanning pref is set to true, or\n  //     because panner nodes are broken on a particular platform, or\n  //     because of something else like that.\n  // - An audio is \"purposefully\" non-positional if it was authored to be\n  //     a \"background sound\" or otherwise made that way \"on purpose\".\n  //\n  // Authoring tools like Spoke create components where \"audioType : stereo\"\n  // is used to indicate that audio should play in the background without\n  // left/right panning and without distance-based attenuation.\n  //\n  // Those components also include properties like distanceModel, rolloffFactor, etc,\n  // but these properties were assumed to be ignored by the client.\n  // Thus we cannot simply apply the attenuation values we would get if we calculated\n  // attenuation with the provided distanceModel, rolloffFactor, etc.\n  //\n  // Instead, we determine what the audioType would be if it were not for the\n  // \"incidental\" factors. In particular, we check if the audioType would have\n  // been PannerNode if we ignored the overrides due to disableLeftRightPanning and platform\n  // problems (e.g. Safari).\n  //\n  // If the audioType would have been PannerNode, then we should apply \"fake\",\n  // \"supplementary\" attenuation. Otherwise, the audio is purposefully a\n  // \"background sound\" and we should not apply supplementary attenuation.\n  const sourceType = APP.sourceType.get(el);\n  const defaults = defaultSettingsForSourceType.get(sourceType);\n  const sceneOverrides = APP.sceneAudioDefaults.get(sourceType);\n  const audioDebugPanelOverrides = APP.audioDebugPanelOverrides.get(sourceType);\n  const audioOverrides = APP.audioOverrides.get(el);\n  const zoneSettings = APP.zoneOverrides.get(el);\n  const settings = Object.assign({}, defaults, sceneOverrides, audioDebugPanelOverrides, audioOverrides, zoneSettings);\n  return settings.audioType === AudioType.PannerNode;\n}\n","/* global fetch THREE */\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\nimport URL_POP from \"../assets/sfx/pop.mp3\";\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\nimport URL_SPAWN_EMOJI from \"../assets/sfx/emoji.mp3\";\nimport URL_SPEAKER_TONE from \"../assets/sfx/tone.mp3\";\nimport { setMatrixWorld } from \"../utils/three-utils\";\nimport { SourceType } from \"../components/audio-params\";\nimport { getOverriddenPanningModelType } from \"../update-audio-settings\";\n\nlet soundEnum = 0;\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\nexport const SOUND_THAW = soundEnum++;\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\nexport const SOUND_TOGGLE_MIC = soundEnum++;\nexport const SOUND_TELEPORT_START = soundEnum++;\nexport const SOUND_TELEPORT_END = soundEnum++;\nexport const SOUND_WAYPOINT_START = soundEnum++;\nexport const SOUND_WAYPOINT_END = soundEnum++;\nexport const SOUND_SNAP_ROTATE = soundEnum++;\nexport const SOUND_SPAWN_PEN = soundEnum++;\nexport const SOUND_PEN_START_DRAW = soundEnum++;\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\nexport const SOUND_ENTER_SCENE = soundEnum++;\nexport const SOUND_QUACK = soundEnum++;\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\nexport const SOUND_FREEZE = soundEnum++;\nexport const SOUND_PIN = soundEnum++;\nexport const SOUND_MEDIA_LOADING = soundEnum++;\nexport const SOUND_MEDIA_LOADED = soundEnum++;\nexport const SOUND_CAMERA_TOOL_COUNTDOWN = soundEnum++;\nexport const SOUND_PREFERENCE_MENU_HOVER = soundEnum++;\nexport const SOUND_SPAWN_EMOJI = soundEnum++;\nexport const SOUND_SPEAKER_TONE = soundEnum++;\n\n// Safari doesn't support the promise form of decodeAudioData, so we polyfill it.\nfunction decodeAudioData(audioContext, arrayBuffer) {\n  return new Promise((resolve, reject) => {\n    audioContext.decodeAudioData(arrayBuffer, resolve, reject);\n  });\n}\n\nexport class SoundEffectsSystem {\n  constructor(scene) {\n    this.pendingAudioSourceNodes = [];\n    this.pendingPositionalAudios = [];\n    this.positionalAudiosStationary = [];\n    this.positionalAudiosFollowingObject3Ds = [];\n\n    this.audioContext = THREE.AudioContext.getContext();\n    this.scene = scene;\n\n    const soundsAndUrls = [\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\n      [SOUND_THAW, URL_TICK],\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\n      [SOUND_TOGGLE_MIC, URL_TICK],\n      [SOUND_CAMERA_TOOL_COUNTDOWN, URL_TICK],\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\n      [SOUND_WAYPOINT_START, URL_QUICK_TURN],\n      [SOUND_WAYPOINT_END, URL_TICK],\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\n      [SOUND_ENTER_SCENE, URL_WELCOME],\n      [SOUND_QUACK, URL_QUACK],\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\n      [SOUND_CHAT_MESSAGE, URL_POP],\n      [SOUND_FREEZE, URL_FREEZE],\n      [SOUND_PIN, URL_TACK],\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED],\n      [SOUND_PREFERENCE_MENU_HOVER, URL_FREEZE],\n      [SOUND_SPAWN_EMOJI, URL_SPAWN_EMOJI],\n      [SOUND_SPEAKER_TONE, URL_SPEAKER_TONE]\n    ];\n    const loading = new Map();\n    const load = url => {\n      let audioBufferPromise = loading.get(url);\n      if (!audioBufferPromise) {\n        audioBufferPromise = fetch(url)\n          .then(r => r.arrayBuffer())\n          .then(arrayBuffer => decodeAudioData(this.audioContext, arrayBuffer));\n        loading.set(url, audioBufferPromise);\n      }\n      return audioBufferPromise;\n    };\n    this.sounds = new Map();\n    soundsAndUrls.map(([sound, url]) => {\n      load(url).then(audioBuffer => {\n        this.sounds.set(sound, audioBuffer);\n      });\n    });\n\n    this.isDisabled = window.APP.store.state.preferences.disableSoundEffects;\n    window.APP.store.addEventListener(\"statechanged\", () => {\n      const shouldBeDisabled = window.APP.store.state.preferences.disableSoundEffects;\n      if (shouldBeDisabled && !this.isDisabled) {\n        this.stopAllPositionalAudios();\n        // TODO: Technically we should stop any other sounds that have been started,\n        // but we do not hold references to these and they're short-lived so I didn't bother.\n      }\n      this.isDisabled = shouldBeDisabled;\n    });\n  }\n\n  enqueueSound(sound, loop) {\n    if (this.isDisabled) return null;\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n    // The nodes are very inexpensive to create, according to\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\n    const source = this.audioContext.createBufferSource();\n    source.buffer = audioBuffer;\n    this.scene.systems[\"hubs-systems\"].audioSystem.addAudio({ sourceType: SourceType.SFX, node: source });\n    source.loop = loop;\n    this.pendingAudioSourceNodes.push(source);\n    return source;\n  }\n\n  enqueuePositionalSound(sound, loop) {\n    if (this.isDisabled) return null;\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const disablePositionalAudio = window.APP.store.state.preferences.disableLeftRightPanning;\n    const positionalAudio = disablePositionalAudio\n      ? new THREE.Audio(this.scene.audioListener)\n      : new THREE.PositionalAudio(this.scene.audioListener);\n    positionalAudio.setBuffer(audioBuffer);\n    positionalAudio.loop = loop;\n    if (!disablePositionalAudio) {\n      const overriddenPanningModelType = getOverriddenPanningModelType();\n      if (overriddenPanningModelType !== null) {\n        positionalAudio.panner.panningModel = overriddenPanningModelType;\n      }\n    }\n    this.pendingPositionalAudios.push(positionalAudio);\n    this.scene.systems[\"hubs-systems\"].audioSystem.addAudio({\n      sourceType: SourceType.SFX,\n      node: positionalAudio\n    });\n    return positionalAudio;\n  }\n\n  playPositionalSoundAt(sound, position, loop) {\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\n    if (!positionalAudio) return null;\n    positionalAudio.position.copy(position);\n    positionalAudio.matrixWorldNeedsUpdate = true;\n    this.positionalAudiosStationary.push(positionalAudio);\n  }\n\n  playPositionalSoundFollowing(sound, object3D, loop) {\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\n    if (!positionalAudio) return null;\n    this.positionalAudiosFollowingObject3Ds.push({ positionalAudio, object3D });\n    return positionalAudio;\n  }\n\n  playSoundOneShot(sound) {\n    return this.enqueueSound(sound, false);\n  }\n\n  playSoundLooped(sound) {\n    return this.enqueueSound(sound, true);\n  }\n\n  playSoundLoopedWithGain(sound) {\n    if (this.isDisabled) return null;\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const source = this.audioContext.createBufferSource();\n    const gain = this.audioContext.createGain();\n    source.buffer = audioBuffer;\n    source.connect(gain);\n    this.scene.systems[\"hubs-systems\"].audioSystem.addAudio({ sourceType: SourceType.SFX, node: gain });\n    source.loop = true;\n    this.pendingAudioSourceNodes.push(source);\n    return { gain, source };\n  }\n\n  stopSoundNode(node) {\n    const index = this.pendingAudioSourceNodes.indexOf(node);\n    if (index !== -1) {\n      this.pendingAudioSourceNodes.splice(index, 1);\n    } else {\n      node.stop();\n      this.scene.systems[\"hubs-systems\"].audioSystem.removeAudio({ node });\n    }\n  }\n\n  stopPositionalAudio(inPositionalAudio) {\n    const pendingIndex = this.pendingPositionalAudios.indexOf(inPositionalAudio);\n    if (pendingIndex !== -1) {\n      this.pendingPositionalAudios.splice(pendingIndex, 1);\n    } else {\n      if (inPositionalAudio.isPlaying) {\n        inPositionalAudio.stop();\n      }\n      if (inPositionalAudio.parent) {\n        inPositionalAudio.removeFromParent();\n      }\n    }\n    this.positionalAudiosStationary = this.positionalAudiosStationary.filter(\n      positionalAudio => positionalAudio !== inPositionalAudio\n    );\n    this.positionalAudiosFollowingObject3Ds = this.positionalAudiosFollowingObject3Ds.filter(\n      ({ positionalAudio }) => positionalAudio !== inPositionalAudio\n    );\n    this.scene.systems[\"hubs-systems\"].audioSystem.removeAudio({ node: inPositionalAudio });\n  }\n\n  stopAllPositionalAudios() {\n    for (let i = this.positionalAudiosStationary.length - 1; i >= 0; i--) {\n      const positionalAudio = this.positionalAudiosStationary[i];\n      this.stopPositionalAudio(positionalAudio);\n    }\n\n    for (let i = this.positionalAudiosFollowingObject3Ds.length - 1; i >= 0; i--) {\n      const positionalAudioAndObject3D = this.positionalAudiosFollowingObject3Ds[i];\n      const positionalAudio = positionalAudioAndObject3D.positionalAudio;\n      this.stopPositionalAudio(positionalAudio);\n    }\n  }\n\n  tick() {\n    if (this.isDisabled) {\n      return;\n    }\n\n    for (let i = 0; i < this.pendingAudioSourceNodes.length; i++) {\n      this.pendingAudioSourceNodes[i].start();\n    }\n    this.pendingAudioSourceNodes.length = 0;\n\n    for (let i = 0; i < this.pendingPositionalAudios.length; i++) {\n      const pendingPositionalAudio = this.pendingPositionalAudios[i];\n      this.scene.object3D.add(pendingPositionalAudio);\n      pendingPositionalAudio.play();\n    }\n    this.pendingPositionalAudios.length = 0;\n\n    for (let i = this.positionalAudiosStationary.length - 1; i >= 0; i--) {\n      const positionalAudio = this.positionalAudiosStationary[i];\n      if (!positionalAudio.isPlaying) {\n        this.stopPositionalAudio(positionalAudio);\n      }\n    }\n\n    for (let i = this.positionalAudiosFollowingObject3Ds.length - 1; i >= 0; i--) {\n      const positionalAudioAndObject3D = this.positionalAudiosFollowingObject3Ds[i];\n      const positionalAudio = positionalAudioAndObject3D.positionalAudio;\n      const object3D = positionalAudioAndObject3D.object3D;\n      if (!positionalAudio.isPlaying || !object3D.parent) {\n        this.stopPositionalAudio(positionalAudio);\n      } else {\n        object3D.updateMatrices();\n        setMatrixWorld(positionalAudio, object3D.matrixWorld);\n      }\n    }\n  }\n}\n","import { computeObjectAABB, getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport {\n  resolveUrl,\n  getDefaultResolveQuality,\n  injectCustomShaderChunks,\n  addMeshScaleAnimation,\n  closeExistingMediaMirror\n} from \"../utils/media-utils\";\nimport {\n  isNonCorsProxyDomain,\n  guessContentType,\n  proxiedUrlFor,\n  isHubsRoomUrl,\n  isLocalHubsSceneUrl,\n  isLocalHubsAvatarUrl\n} from \"../utils/media-url-utils\";\nimport { addAnimationComponents } from \"../utils/animation\";\n\nimport loadingObjectSrc from \"../assets/models/LoadingObject_Atom.glb\";\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\nimport { loadModel } from \"./gltf-model-plus\";\nimport { cloneObject3D, setMatrixWorld } from \"../utils/three-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nimport { SHAPE } from \"three-ammo/constants\";\nimport { addComponent, entityExists, removeComponent } from \"bitecs\";\nimport { MediaLoading } from \"../bit-components\";\n\nlet loadingObject;\n\nwaitForDOMContentLoaded().then(() => {\n  loadModel(loadingObjectSrc).then(gltf => {\n    loadingObject = gltf;\n  });\n});\n\nconst fetchContentType = url => {\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\n};\n\nAFRAME.registerComponent(\"media-loader\", {\n  schema: {\n    playSoundEffect: { default: true },\n    fileId: { type: \"string\" },\n    fileIsOwned: { type: \"boolean\" },\n    src: { type: \"string\" },\n    version: { type: \"number\", default: 1 }, // Used to force a re-resolution\n    fitToBox: { default: false },\n    moveTheParentNotTheMesh: { default: false },\n    resolve: { default: false },\n    contentType: { default: null },\n    contentSubtype: { default: null },\n    animate: { default: true },\n    linkedEl: { default: null }, // This is the element of which this is a linked derivative. See linked-media.js\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.onError = this.onError.bind(this);\n    this.showLoader = this.showLoader.bind(this);\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\n    this.handleLinkedElRemoved = this.handleLinkedElRemoved.bind(this);\n    this.refresh = this.refresh.bind(this);\n    this.animating = false;\n\n    try {\n      NAF.utils\n        .getNetworkedEntity(this.el)\n        .then(networkedEl => {\n          this.networkedEl = networkedEl;\n        })\n        .catch(() => {}); //ignore exception, entity might not be networked\n    } catch (e) {\n      // NAF may not exist on scene landing page\n    }\n  },\n\n  updateScale: (function() {\n    const center = new THREE.Vector3();\n    const originalMeshMatrix = new THREE.Matrix4();\n    const desiredObjectMatrix = new THREE.Matrix4();\n    const position = new THREE.Vector3();\n    const quaternion = new THREE.Quaternion();\n    const scale = new THREE.Vector3();\n    const box = new THREE.Box3();\n    return function(fitToBox, moveTheParentNotTheMesh) {\n      this.el.object3D.updateMatrices();\n      const mesh = this.el.getObject3D(\"mesh\");\n      mesh.updateMatrices();\n      if (moveTheParentNotTheMesh) {\n        if (fitToBox) {\n          console.warn(\n            \"Unexpected combination of inputs. Can fit the mesh to a box OR move the parent to the mesh, but did not expect to do both.\",\n            this.el\n          );\n        }\n        // Keep the mesh exactly where it is, but move the parent transform such that it aligns with the center of the mesh's bounding box.\n        originalMeshMatrix.copy(mesh.matrixWorld);\n        computeObjectAABB(mesh, box);\n        center.addVectors(box.min, box.max).multiplyScalar(0.5);\n        this.el.object3D.matrixWorld.decompose(position, quaternion, scale);\n        desiredObjectMatrix.compose(\n          center,\n          quaternion,\n          scale\n        );\n        setMatrixWorld(this.el.object3D, desiredObjectMatrix);\n        mesh.updateMatrices();\n        setMatrixWorld(mesh, originalMeshMatrix);\n      } else {\n        // Move the mesh such that the center of its bounding box is in the same position as the parent matrix position\n        const box = getBox(this.el, mesh);\n        const scaleCoefficient = fitToBox ? getScaleCoefficient(0.5, box) : 1;\n        const { min, max } = box;\n        center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\n        mesh.scale.multiplyScalar(scaleCoefficient);\n        mesh.position.sub(center);\n        mesh.matrixNeedsUpdate = true;\n      }\n    };\n  })(),\n\n  removeShape(id) {\n    if (this.el.getAttribute(\"shape-helper__\" + id)) {\n      this.el.removeAttribute(\"shape-helper__\" + id);\n    }\n  },\n\n  tick(t, dt) {\n    if (this.loaderMixer) {\n      this.loaderMixer.update(dt / 1000);\n    }\n  },\n\n  handleLinkedElRemoved(e) {\n    if (e.detail.name === \"media-loader\") {\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\n\n      // this should be revisited if we ever use media linking for something other than media mirroring UX --\n      // right now it is assumed if there is a linkedEl, this is the currently active mirrored media\n      closeExistingMediaMirror();\n    }\n  },\n\n  remove() {\n    if (this.data.linkedEl) {\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\n    }\n\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n    if (this.loadingSoundEffect) {\n      sfx.stopPositionalAudio(this.loadingSoundEffect);\n      this.loadingSoundEffect = null;\n    }\n    if (this.loadedSoundEffect) {\n      sfx.stopPositionalAudio(this.loadedSoundEffect);\n      this.loadedSoundEffect = null;\n    }\n  },\n\n  onError() {\n    this.el.removeAttribute(\"gltf-model-plus\");\n    this.el.removeAttribute(\"media-pager\");\n    this.el.removeAttribute(\"media-video\");\n    this.el.removeAttribute(\"audio-zone-source\");\n    this.el.removeAttribute(\"media-pdf\");\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\n    this.clearLoadingTimeout();\n  },\n\n  showLoader() {\n    if (this.el.object3DMap.mesh) {\n      this.clearLoadingTimeout();\n      return;\n    }\n    const useFancyLoader = !!loadingObject;\n\n    const mesh = useFancyLoader\n      ? cloneObject3D(loadingObject.scene)\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\n    this.el.setObject3D(\"mesh\", mesh);\n\n    this.updateScale(true, false);\n\n    if (useFancyLoader) {\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\n\n      this.loadingClip = this.loaderMixer.clipAction(mesh.animations[0]);\n      this.loadingScaleClip = this.loaderMixer.clipAction(\n        new THREE.AnimationClip(null, 1000, [\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\n        ])\n      );\n      setTimeout(() => {\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\n        this.el.setAttribute(\"shape-helper__loader\", { type: SHAPE.BOX });\n      }, 200);\n\n      this.loadingClip.play();\n      this.loadingScaleClip.play();\n    }\n\n    if (\n      this.el.sceneEl.is(\"entered\") &&\n      (!this.networkedEl || NAF.utils.isMine(this.networkedEl)) &&\n      this.data.playSoundEffect\n    ) {\n      this.loadingSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\n        SOUND_MEDIA_LOADING,\n        this.el.object3D,\n        true\n      );\n    }\n\n    delete this.showLoaderTimeout;\n  },\n\n  clearLoadingTimeout() {\n    clearTimeout(this.showLoaderTimeout);\n    if (this.loadingSoundEffect) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopPositionalAudio(this.loadingSoundEffect);\n      this.loadingSoundEffect = null;\n    }\n    if (this.loaderMixer) {\n      this.loadingClip.stop();\n      this.loadingScaleClip.stop();\n      delete this.loaderMixer;\n      delete this.loadingScaleClip;\n      delete this.loadingClip;\n    }\n    delete this.showLoaderTimeout;\n    this.removeShape(\"loader\");\n  },\n\n  updateHoverableVisuals: (function() {\n    const boundingBox = new THREE.Box3();\n    const boundingSphere = new THREE.Sphere();\n    return function() {\n      const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\n\n      if (hoverableVisuals) {\n        if (!this.injectedCustomShaderChunks) {\n          this.injectedCustomShaderChunks = true;\n          hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\n        }\n\n        boundingBox.setFromObject(this.el.object3DMap.mesh);\n        boundingBox.getBoundingSphere(boundingSphere);\n        hoverableVisuals.geometryRadius = boundingSphere.radius / this.el.object3D.scale.y;\n      }\n    };\n  })(),\n\n  onMediaLoaded(physicsShape = null, shouldUpdateScale) {\n    const el = this.el;\n    this.clearLoadingTimeout();\n\n    if (this.el.sceneEl.is(\"entered\") && this.data.playSoundEffect) {\n      this.loadedSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\n        SOUND_MEDIA_LOADED,\n        this.el.object3D,\n        false\n      );\n    }\n\n    const finish = () => {\n      this.animating = false;\n\n      if (physicsShape) {\n        el.setAttribute(\"shape-helper\", {\n          type: physicsShape,\n          minHalfExtent: 0.04\n        });\n      }\n\n      this.updateHoverableVisuals();\n\n      if (this.data.linkedEl) {\n        this.el.sceneEl.systems[\"linked-media\"].registerLinkage(this.data.linkedEl, this.el);\n        this.data.linkedEl.addEventListener(\"componentremoved\", this.handleLinkedElRemoved);\n      }\n\n      // TODO this does duplicate work in some cases, but finish() is the only consistent place to do it\n      this.contentBounds = getBox(this.el, this.el.getObject3D(\"mesh\")).getSize(new THREE.Vector3());\n\n      el.emit(\"media-loaded\");\n      if (el.eid && entityExists(APP.world, el.eid)) {\n        removeComponent(APP.world, MediaLoading, el.eid);\n      }\n    };\n\n    if (this.data.animate) {\n      if (!this.animating) {\n        this.animating = true;\n        if (shouldUpdateScale) this.updateScale(this.data.fitToBox, this.data.moveTheParentNotTheMesh);\n        const mesh = this.el.getObject3D(\"mesh\");\n        const scale = { x: 0.001, y: 0.001, z: 0.001 };\n        scale.x = mesh.scale.x < scale.x ? mesh.scale.x * 0.001 : scale.x;\n        scale.y = mesh.scale.y < scale.y ? mesh.scale.x * 0.001 : scale.y;\n        scale.z = mesh.scale.z < scale.z ? mesh.scale.x * 0.001 : scale.z;\n        addMeshScaleAnimation(mesh, scale, finish);\n      }\n    } else {\n      if (shouldUpdateScale) this.updateScale(this.data.fitToBox, this.data.moveTheParentNotTheMesh);\n      finish();\n    }\n  },\n\n  refresh() {\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n\n    // When we refresh, we bump the version to the current timestamp.\n    //\n    // The only use-case for refresh right now is re-fetching screenshots.\n    this.el.setAttribute(\"media-loader\", { version: Math.floor(Date.now() / 1000) });\n  },\n\n  async update(oldData, forceLocalRefresh) {\n    const { version, contentSubtype } = this.data;\n    let src = this.data.src;\n    if (!src) return;\n\n    const srcChanged = oldData.src !== src;\n    const versionChanged = !!(oldData.version && oldData.version !== version);\n\n    if (versionChanged) {\n      this.el.emit(\"media_refreshing\");\n\n      // Don't animate if its a refresh.\n      this.data.animate = false;\n\n      // Play the sound effect on a refresh only if we are the owner\n      this.data.playSoundEffect = NAF.utils.isMine(this.networkedEl);\n    }\n\n    if (forceLocalRefresh) {\n      this.el.removeAttribute(\"gltf-model-plus\");\n      this.el.removeAttribute(\"media-pager\");\n      this.el.removeAttribute(\"media-video\");\n      this.el.removeAttribute(\"audio-zone-source\");\n      this.el.removeAttribute(\"media-pdf\");\n      this.el.removeAttribute(\"media-image\");\n    }\n\n    try {\n      if ((forceLocalRefresh || srcChanged) && !this.showLoaderTimeout) {\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\n        addComponent(APP.world, MediaLoading, this.el.eid);\n      }\n\n      //check if url is an anchor hash e.g. #Spawn_Point_1\n      if (src.charAt(0) === \"#\") {\n        src = this.data.src = `${window.location.origin}${window.location.pathname}${window.location.search}${src}`;\n      }\n\n      let canonicalUrl = src;\n      let canonicalAudioUrl = null; // set non-null only if audio track is separated from video track (eg. 360 video)\n      let accessibleUrl = src;\n      let contentType = this.data.contentType;\n      let thumbnail;\n\n      const parsedUrl = new URL(src);\n\n      // We want to resolve and proxy some hubs urls, like rooms and scene links,\n      // but want to avoid proxying assets in order for this to work in dev environments\n      const isLocalModelAsset =\n        isNonCorsProxyDomain(parsedUrl.hostname) && (guessContentType(src) || \"\").startsWith(\"model/gltf\");\n\n      if (this.data.resolve && !src.startsWith(\"data:\") && !src.startsWith(\"hubs:\") && !isLocalModelAsset) {\n        const is360 = !!(this.data.mediaOptions.projection && this.data.mediaOptions.projection.startsWith(\"360\"));\n        const quality = getDefaultResolveQuality(is360);\n        const result = await resolveUrl(src, quality, version, forceLocalRefresh);\n        canonicalUrl = result.origin;\n\n        // handle protocol relative urls\n        if (canonicalUrl.startsWith(\"//\")) {\n          canonicalUrl = location.protocol + canonicalUrl;\n        }\n\n        canonicalAudioUrl = result.origin_audio;\n        if (canonicalAudioUrl && canonicalAudioUrl.startsWith(\"//\")) {\n          canonicalAudioUrl = location.protocol + canonicalAudioUrl;\n        }\n\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\n\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\n\n      // TODO we should probably just never return \"application/octet-stream\" as expectedContentType, since its not really useful\n      if (contentType === \"application/octet-stream\") {\n        contentType = guessContentType(canonicalUrl) || contentType;\n      }\n\n      // Some servers treat m3u8 playlists as \"audio/x-mpegurl\", we always want to treat them as HLS videos\n      if (contentType === \"audio/x-mpegurl\" || contentType === \"audio/mpegurl\") {\n        contentType = \"application/vnd.apple.mpegurl\";\n      }\n\n      // We don't want to emit media_resolved for index updates.\n      if (forceLocalRefresh || srcChanged) {\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\n      } else {\n        this.el.emit(\"media_refreshed\", { src, raw: accessibleUrl, contentType });\n      }\n\n      if (\n        contentType.startsWith(\"video/\") ||\n        contentType.startsWith(\"audio/\") ||\n        contentType.startsWith(\"application/dash\") ||\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\n      ) {\n        let linkedVideoTexture, linkedAudioSource, linkedMediaElementAudioSource;\n        if (this.data.linkedEl) {\n          const linkedMediaVideo = this.data.linkedEl.components[\"media-video\"];\n\n          linkedVideoTexture = linkedMediaVideo.videoTexture;\n          linkedAudioSource = linkedMediaVideo.audioSource;\n          linkedMediaElementAudioSource = linkedMediaVideo.mediaElementAudioSource;\n        }\n\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\n        const startTime = hashTime || qsTime || 0;\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"video-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\n          \"media-video\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            audioSrc: canonicalAudioUrl ? proxiedUrlFor(canonicalAudioUrl) : null,\n            time: startTime,\n            contentType,\n            linkedVideoTexture,\n            linkedAudioSource,\n            linkedMediaElementAudioSource\n          })\n        );\n        this.el.setAttribute(\"audio-zone-source\", {});\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else if (contentType.startsWith(\"image/\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n\n            if (contentSubtype === \"photo-camera\") {\n              this.el.setAttribute(\"hover-menu__photo\", {\n                template: \"#photo-hover-menu\",\n                isFlat: true\n              });\n            } else if (this.data.mediaOptions.href) {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", isFlat: true });\n            }\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            version,\n            contentType\n          })\n        );\n\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else if (contentType.startsWith(\"application/pdf\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.setAttribute(\n          \"media-pdf\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType\n          })\n        );\n        this.el.setAttribute(\"media-pager\", {});\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"pdf-loaded\",\n          () => {\n            this.clearLoadingTimeout();\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else if (\n        contentType.includes(\"application/octet-stream\") ||\n        contentType.includes(\"x-zip-compressed\") ||\n        contentType.startsWith(\"model/gltf\")\n      ) {\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"model-loaded\",\n          () => {\n            this.onMediaLoaded(SHAPE.HULL, true);\n            addAnimationComponents(this.el);\n          },\n          { once: true }\n        );\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\n        if (this.data.mediaOptions.hasOwnProperty(\"applyGravity\")) {\n          this.el.setAttribute(\"floaty-object\", {\n            modifyGravityOnRelease: !this.data.mediaOptions.applyGravity\n          });\n        }\n        this.el.setAttribute(\n          \"gltf-model-plus\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType: contentType,\n            inflate: true,\n            modelToWorldScale: this.data.fitToBox ? 0.0001 : 1.0\n          })\n        );\n      } else if (contentType.startsWith(\"text/html\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"audio-zone-source\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          async () => {\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\n\n            if (await isLocalHubsAvatarUrl(src)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#avatar-link-hover-menu\",\n                isFlat: true\n              });\n            } else if ((await isHubsRoomUrl(src)) || ((await isLocalHubsSceneUrl(src)) && mayChangeScene)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#hubs-destination-hover-menu\",\n                isFlat: true\n              });\n            } else {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", isFlat: true });\n            }\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: thumbnail,\n            version,\n            contentType: guessContentType(thumbnail) || \"image/png\"\n          })\n        );\n        if (this.el.components[\"position-at-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n        }\n        if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n          this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n        }\n      } else {\n        throw new Error(`Unsupported content type: ${contentType}`);\n      }\n    } catch (e) {\n      if (this.el.components[\"position-at-border__freeze\"]) {\n        this.el.setAttribute(\"position-at-border__freeze\", { isFlat: true });\n      }\n      if (this.el.components[\"position-at-border__freeze-unprivileged\"]) {\n        this.el.setAttribute(\"position-at-border__freeze-unprivileged\", { isFlat: true });\n      }\n      console.error(\"Error adding media\", e);\n      this.onError();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-pager\", {\n  schema: {\n    index: { default: 0 },\n    maxIndex: { default: 0 }\n  },\n\n  init() {\n    this.onNext = this.onNext.bind(this);\n    this.onPrev = this.onPrev.bind(this);\n    this.onSnap = this.onSnap.bind(this);\n    this.update = this.update.bind(this);\n\n    this.el.setAttribute(\"hover-menu__pager\", { template: \"#pager-hover-menu\", isFlat: true });\n    this.el.components[\"hover-menu__pager\"].getHoverMenu().then(menu => {\n      // If we got removed while waiting, do nothing.\n      if (!this.el.parentNode) return;\n\n      this.hoverMenu = menu;\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\n      this.snapButton = this.el.querySelector(\".snap-button [text-button]\");\n      this.pageLabel = this.el.querySelector(\".page-label\");\n\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\n      this.snapButton.object3D.addEventListener(\"interact\", this.onSnap);\n\n      this.update();\n      this.el.emit(\"pager-loaded\");\n    });\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkedEl.addEventListener(\"pinned\", this.update);\n        this.networkedEl.addEventListener(\"unpinned\", this.update);\n        window.APP.hubChannel.addEventListener(\"permissions_updated\", this.update);\n      })\n      .catch(() => {}); //ignore exception, entity might not be networked\n\n    this.el.addEventListener(\"pdf-loaded\", this.update);\n  },\n\n  async update(oldData) {\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      if (oldData && typeof oldData.index === \"number\" && oldData.index !== this.data.index) {\n        this.el.emit(\"owned-pager-page-changed\");\n      }\n    }\n\n    if (this.pageLabel) {\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.data.maxIndex + 1}`);\n    }\n\n    if (this.prevButton && this.nextButton) {\n      const pinnableElement = this.el.components[\"media-loader\"].data.linkedEl || this.el;\n      const isPinned = pinnableElement.components.pinnable && pinnableElement.components.pinnable.data.pinned;\n      this.prevButton.object3D.visible = this.nextButton.object3D.visible =\n        !isPinned || window.APP.hubChannel.can(\"pin_objects\");\n    }\n  },\n\n  onNext() {\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    const newIndex = Math.min(this.data.index + 1, this.data.maxIndex);\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\n  },\n\n  onPrev() {\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    const newIndex = Math.max(this.data.index - 1, 0);\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\n  },\n\n  onSnap() {\n    this.el.emit(\"pager-snap-clicked\");\n  },\n\n  remove() {\n    if (this.networkedEl) {\n      this.networkedEl.removeEventListener(\"pinned\", this.update);\n      this.networkedEl.removeEventListener(\"unpinned\", this.update);\n    }\n\n    this.nextButton.object3D.removeEventListener(\"interact\", this.onNext);\n    this.prevButton.object3D.removeEventListener(\"interact\", this.onPrev);\n    this.snapButton.object3D.removeEventListener(\"interact\", this.onSnap);\n\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.update);\n\n    this.el.removeEventListener(\"pdf-loaded\", this.update);\n  }\n});\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"quack\", {\n  schema: {\n    quackPercentage: { default: 1 },\n    specialQuackPercentage: { default: 0.01 }\n  },\n\n  init: function() {\n    this.wasInteracting = false;\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n      this.networkedEntity = networkedEntity;\n    });\n  },\n\n  tick: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const isInteracting = interaction.isHeld(this.networkedEntity || this.el);\n\n    if (isInteracting && !this.wasInteracting) {\n      this.quack();\n    }\n\n    this.wasInteracting = isInteracting;\n  },\n\n  quack: function() {\n    const rand = Math.random();\n    if (rand < this.data.specialQuackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n    } else if (rand < this.data.quackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n    }\n  }\n});\n","export const paths = {};\npaths.noop = \"/noop\";\npaths.actions = {};\npaths.actions.log = \"/actions/log\";\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\npaths.actions.angularVelocity = \"/actions/angularVelocity\";\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\npaths.actions.debugUserInput = {};\npaths.actions.debugUserInput.describeCurrentMasks = \"/actions/debugUserInput/describeCurrentMasks\";\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\npaths.actions.lobbyCameraDelta = \"/actions/lobbyCameraDelta\";\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\npaths.actions.dCharSpeed = \"/actions/dCharSpeed\";\npaths.actions.boost = \"/actions/boost\";\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\npaths.actions.spawnPen = \"/actions/spawnPen\";\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\npaths.actions.thaw = \"/actions/thaw\";\npaths.actions.muteMic = \"/actions/muteMic\";\npaths.actions.toggleFly = \"/actions/toggleFly\";\npaths.actions.toggleUI = \"/actions/toggleUI\";\npaths.actions.waypointDeltaDistance = \"/actions/waypointDeltaDistance\";\npaths.actions.focusChat = \"/actions/focusChat\";\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\npaths.actions.mediaExit = \"/actions/mediaExit\";\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\npaths.actions.transformModifier = \"/actions/transformModifier\";\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\npaths.actions.cursor = {};\npaths.actions.cursor.right = {};\npaths.actions.cursor.right.pose = \"/actions/cursor/right/Pose\";\npaths.actions.cursor.right.hideLine = \"/actions/cursor/right/HideLine\";\npaths.actions.cursor.right.grab = \"/actions/cursor/right/Grab\";\npaths.actions.cursor.right.drop = \"/actions/cursor/right/Drop\";\npaths.actions.cursor.right.modDelta = \"/actions/cursor/right/ModDelta\";\npaths.actions.cursor.right.startDrawing = \"/actions/cursor/right/StartDrawing\";\npaths.actions.cursor.right.stopDrawing = \"/actions/cursor/right/StopDrawing\";\npaths.actions.cursor.right.undoDrawing = \"/actions/cursor/right/UndoDrawing\";\npaths.actions.cursor.right.penNextColor = \"/actions/cursor/right/PenNextColor\";\npaths.actions.cursor.right.penPrevColor = \"/actions/cursor/right/PenPrevColor\";\npaths.actions.cursor.right.scalePenTip = \"/actions/cursor/right/ScalePenTip\";\npaths.actions.cursor.right.scaleGrabbedGrabbable = \"/actions/cursor/right/ScaleGrabbedGrabbable\";\npaths.actions.cursor.right.mediaVolumeMod = \"/actions/cursor/right//mediaVolumeMod\";\npaths.actions.cursor.right.takeSnapshot = \"/actions/cursor/right/TakeSnapshot\";\npaths.actions.cursor.right.wake = \"/actions/cursor/right/wake\";\npaths.actions.cursor.left = {};\npaths.actions.cursor.left.pose = \"/actions/cursor/left/Pose\";\npaths.actions.cursor.left.hideLine = \"/actions/cursor/left/HideLine\";\npaths.actions.cursor.left.grab = \"/actions/cursor/left/Grab\";\npaths.actions.cursor.left.drop = \"/actions/cursor/left/Drop\";\npaths.actions.cursor.left.modDelta = \"/actions/cursor/left/ModDelta\";\npaths.actions.cursor.left.startDrawing = \"/actions/cursor/left/StartDrawing\";\npaths.actions.cursor.left.stopDrawing = \"/actions/cursor/left/StopDrawing\";\npaths.actions.cursor.left.undoDrawing = \"/actions/cursor/left/UndoDrawing\";\npaths.actions.cursor.left.penNextColor = \"/actions/cursor/left/PenNextColor\";\npaths.actions.cursor.left.penPrevColor = \"/actions/cursor/left/PenPrevColor\";\npaths.actions.cursor.left.scalePenTip = \"/actions/cursor/left/ScalePenTip\";\npaths.actions.cursor.left.scaleGrabbedGrabbable = \"/actions/cursor/left/ScaleGrabbedGrabbable\";\npaths.actions.cursor.left.mediaVolumeMod = \"/actions/cursor/left//mediaVolumeMod\";\npaths.actions.cursor.left.takeSnapshot = \"/actions/cursor/left/TakeSnapshot\";\npaths.actions.cursor.left.wake = \"/actions/cursor/left/wake\";\npaths.actions.pen = {};\npaths.actions.pen.remove = \"/actions/pen/remove\";\npaths.actions.rightHand = {};\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\npaths.actions.rightHand.switchDrawMode = \"/actions/rightHandSwitchDrawMode\";\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\npaths.actions.leftHand = {};\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\npaths.actions.leftHand.switchDrawMode = \"/actions/leftHandSwitchDrawMode\";\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\npaths.actions.camera = {};\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\npaths.actions.startInspecting = \"/actions/startInspecting\";\npaths.actions.startInspectingSelf = \"/actions/startInspectingSelf\";\npaths.actions.stopInspecting = \"/actions/stopInspecting\";\npaths.actions.inspectZoom = \"/actions/inspectZoom\";\npaths.actions.inspectPanY = \"/actions/inspectPanY\";\npaths.actions.resetInspectView = \"/actions/resetInspectView\";\npaths.actions.nextCameraMode = \"/actions/nextCameraMode\";\npaths.actions.spawnEmoji0 = \"/actions/spawnEmoji0\";\npaths.actions.spawnEmoji1 = \"/actions/spawnEmoji1\";\npaths.actions.spawnEmoji2 = \"/actions/spawnEmoji2\";\npaths.actions.spawnEmoji3 = \"/actions/spawnEmoji3\";\npaths.actions.spawnEmoji4 = \"/actions/spawnEmoji4\";\npaths.actions.spawnEmoji5 = \"/actions/spawnEmoji5\";\npaths.actions.spawnEmoji6 = \"/actions/spawnEmoji6\";\npaths.haptics = {};\npaths.haptics.actuators = {};\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\n\npaths.device = {};\npaths.device.mouse = {};\npaths.device.mouse.coords = \"/device/mouse/coords\";\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\npaths.device.mouse.buttonMiddle = \"/device/mouse/buttonMiddle\";\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\npaths.device.smartMouse = {};\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\npaths.device.smartMouse.shouldMoveCamera = \"/device/smartMouse/shouldMoveCamera\";\npaths.device.touchscreen = {};\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\npaths.device.touchscreen.pinch = {};\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\npaths.device.touchscreen.anything = \"/device/touchscreen/anything\";\npaths.device.gyro = {};\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\npaths.device.hud = {};\npaths.device.hud.penButton = \"/device/hud/penButton\";\n\npaths.device.keyboard = {\n  map: new Map(),\n  key: function(k) {\n    let path = this.map.get(k);\n    if (path) {\n      return path;\n    }\n    path = `/device/keyboard/${k === \" \" ? \"space\" : k.toLowerCase()}`;\n    this.map.set(k, path);\n    return path;\n  }\n};\n\npaths.device.gamepad = gamepadIndex => ({\n  button: buttonIndex => ({\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\n  }),\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\n});\n\nconst xbox = \"/device/xbox/\";\npaths.device.xbox = {\n  v: name => `/vars/xbox/${name}`,\n  button: buttonName => ({\n    pressed: `${xbox}button/${buttonName}/pressed`,\n    touched: `${xbox}button/${buttonName}/touched`,\n    value: `${xbox}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${xbox}axis/${axisName}`;\n  },\n  axesSum: `${xbox}axis/sum`\n};\n\npaths.device.oculusgo = {\n  // TODO remove these in favor of the direct accessors\n  button: buttonName => ({\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\n    value: `/device/oculusgo/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/oculusgo/axis/${axisName}`;\n  },\n  //\n  trigger: {\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\n    touched: \"/device/oculusgo/button/trigger/touched\",\n    value: \"/device/oculusgo/button/trigger/value\"\n  },\n  touchpad: {\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\n    touched: \"/device/oculusgo/button/touchpad/touched\",\n    value: \"/device/oculusgo/button/touchpad/value\",\n    axisX: \"/device/oculusgo/axis/touchpadX\",\n    axisY: \"/device/oculusgo/axis/touchpadY\"\n  },\n  pose: \"/device/oculusgo/pose\",\n  matrix: \"/device/oculusgo/matrix\",\n  v: name => {\n    return `/vars/oculusgo/${name}`;\n  }\n};\n\nconst gearVRController = \"/device/gearVRController/\";\npaths.device.gearVRController = {\n  button: buttonName => ({\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\n    touched: `${gearVRController}button/${buttonName}/touched`,\n    value: `${gearVRController}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${gearVRController}axis/${axisName}`;\n  },\n  pose: `${gearVRController}pose`,\n  matrix: `${gearVRController}matrix`,\n  v: name => {\n    return `/vars/gearVRController/${name}`;\n  }\n};\n\nconst daydream = \"/device/daydream/\";\npaths.device.daydream = {\n  button: buttonName => ({\n    pressed: `${daydream}button/${buttonName}/pressed`,\n    touched: `${daydream}button/${buttonName}/touched`,\n    value: `${daydream}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${daydream}axis/${axisName}`;\n  },\n  pose: `${daydream}pose`,\n  matrix: `${daydream}matrix`\n};\n\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\npaths.device.rightOculusTouch = {\n  button: buttonName => ({\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\n    value: `${rightOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${rightOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${rightOculusTouch}axis/sum`,\n  pose: `${rightOculusTouch}pose`,\n  matrix: `${rightOculusTouch}matrix`\n};\n\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\npaths.device.leftOculusTouch = {\n  button: buttonName => ({\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\n    value: `${leftOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${leftOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${leftOculusTouch}axis/sum`,\n  pose: `${leftOculusTouch}pose`,\n  matrix: `${leftOculusTouch}matrix`\n};\n\npaths.device.vive = {};\npaths.device.vive.left = {\n  button: buttonName => ({\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\n    touched: `/device/vive/left/button/${buttonName}/touched`,\n    value: `/device/vive/left/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/left/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/left/axis/sum\",\n  pose: `/device/vive/left/pose`,\n  matrix: `/device/vive/left/matrix`\n};\npaths.device.vive.right = {\n  button: buttonName => ({\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\n    touched: `/device/vive/right/button/${buttonName}/touched`,\n    value: `/device/vive/right/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/right/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/right/axis/sum\",\n  pose: `/device/vive/right/pose`,\n  matrix: `/device/vive/right/matrix`\n};\n\nfunction button(device, side, name) {\n  return {\n    pressed: `${device}${side}/button/${name}/pressed`,\n    touched: `${device}${side}/button/${name}/touched`,\n    value: `${device}${side}/button/${name}/value`\n  };\n}\n\nfunction axes(device, side, name) {\n  return {\n    axisX: `${device}${side}/axis/${name}X`,\n    axisY: `${device}${side}/axis/${name}Y`\n  };\n}\n\nfunction wmrController(side) {\n  const wmr = \"/device/wmr/\";\n  return {\n    touchpad: {\n      ...button(wmr, side, \"touchpad\"),\n      ...axes(wmr, side, \"touchpad\")\n    },\n    trigger: button(wmr, side, \"trigger\"),\n    grip: button(wmr, side, \"grip\"),\n    menu: button(wmr, side, \"menu\"),\n    joystick: axes(wmr, side, \"joystick\"),\n    pose: `${wmr}${side}/pose`,\n    matrix: `${wmr}${side}/matrix`\n  };\n}\npaths.device.wmr = {};\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\npaths.device.wmr.left = wmrController(\"left\");\npaths.device.wmr.right = wmrController(\"right\");\n\nconst webxr = \"/device/webxr/\";\npaths.device.webxr = {};\npaths.device.webxr.right = {\n  button: {\n    trigger: button(webxr, \"right\", \"trigger\"),\n    grip: button(webxr, \"right\", \"grip\"),\n    touchpad: button(webxr, \"right\", \"touchpad\"),\n    a: button(webxr, \"right\", \"a\"),\n    b: button(webxr, \"right\", \"b\"),\n    thumbStick: button(webxr, \"right\", \"thumbStick\")\n  },\n  axis: {\n    touchpadX: `${webxr}right/axis/touchpadX`,\n    touchpadY: `${webxr}right/axis/touchpadY`,\n    joyX: `${webxr}right/axis/joyX`,\n    joyY: `${webxr}right/axis/joyY`\n  },\n  pose: `${webxr}right/pose`,\n  matrix: `${webxr}right/matrix`\n};\npaths.device.webxr.left = {\n  button: {\n    trigger: button(webxr, \"left\", \"trigger\"),\n    grip: button(webxr, \"left\", \"grip\"),\n    touchpad: button(webxr, \"left\", \"touchpad\"),\n    a: button(webxr, \"left\", \"a\"),\n    b: button(webxr, \"left\", \"b\"),\n    thumbStick: button(webxr, \"left\", \"thumbStick\")\n  },\n  axis: {\n    touchpadX: `${webxr}left/axis/touchpadX`,\n    touchpadY: `${webxr}left/axis/touchpadY`,\n    joyX: `${webxr}left/axis/joyX`,\n    joyY: `${webxr}left/axis/joyY`\n  },\n  pose: `${webxr}left/pose`,\n  matrix: `${webxr}left/matrix`\n};\n","import { addComponent, hasComponent } from \"bitecs\";\nimport {\n  Holdable,\n  OffersRemoteConstraint,\n  HandCollisionTarget,\n  OffersHandConstraint,\n  TogglesHoveredActionSet,\n  SingleActionButton,\n  HoldableButton,\n  Pen,\n  HoverMenuChild,\n  Static,\n  Inspectable,\n  PreventAudioBoost,\n  IgnoreSpaceBubble\n} from \"../bit-components\";\n\nconst tag2ecs = {\n  isHoldable: Holdable,\n  offersRemoteConstraint: OffersRemoteConstraint,\n  isHandCollisionTarget: HandCollisionTarget,\n  offersHandConstraint: OffersHandConstraint,\n  togglesHoveredActionSet: TogglesHoveredActionSet,\n  singleActionButton: SingleActionButton,\n  holdableButton: HoldableButton,\n  isPen: Pen,\n  isHoverMenuChild: HoverMenuChild,\n  isStatic: Static,\n  inspectable: Inspectable,\n  preventAudioBoost: PreventAudioBoost,\n  ignoreSpaceBubble: IgnoreSpaceBubble\n};\n\n// TODO usages of this should be replaced with direct hasComponent calls\n// but this also has additional logic to check for non existant object\nexport function isTagged(elOrObject3D, tag) {\n  return elOrObject3D && hasComponent(APP.world, tag2ecs[tag], elOrObject3D.eid);\n}\n\nAFRAME.registerComponent(\"tags\", {\n  schema: {\n    isHandCollisionTarget: { default: false },\n    isHoldable: { default: false },\n    offersHandConstraint: { default: false },\n    offersRemoteConstraint: { default: false },\n    togglesHoveredActionSet: { default: false },\n    singleActionButton: { default: false },\n    holdableButton: { default: false },\n    isPen: { default: false },\n    isHoverMenuChild: { default: false },\n    isStatic: { default: false },\n    inspectable: { default: false },\n    preventAudioBoost: { default: false },\n    ignoreSpaceBubble: { default: false }\n  },\n  update() {\n    if (this.didUpdateOnce) {\n      console.warn(\"Do not edit tags with .setAttribute\");\n    }\n    this.didUpdateOnce = true;\n    Object.entries(this.data).forEach(([tagName, isSet]) => {\n      if (isSet) addComponent(APP.world, tag2ecs[tagName], this.el.eid);\n    });\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { childMatch, setMatrixWorld, calculateViewingDistance } from \"../utils/three-utils\";\nimport { paths } from \"./userinput/paths\";\nimport { getBox } from \"../utils/auto-box-collider\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { isTagged } from \"../components/tags\";\nimport { qsGet } from \"../utils/qs_truthy\";\nconst customFOV = qsGet(\"fov\");\nconst enableThirdPersonMode = qsTruthy(\"thirdPerson\");\nimport { Layers } from \"../components/layers\";\n\nfunction getInspectableInHierarchy(el) {\n  let inspectable = el;\n  while (inspectable) {\n    if (isTagged(inspectable, \"inspectable\")) {\n      return inspectable.object3D;\n    }\n    inspectable = inspectable.parentNode;\n  }\n  console.warn(\"could not find inspectable in hierarchy\");\n  return el.object3D;\n}\n\nfunction pivotFor(el) {\n  const selector =\n    el.components[\"inspect-pivot-child-selector\"] && el.components[\"inspect-pivot-child-selector\"].data.selector;\n  if (!selector) {\n    return el.object3D;\n  }\n\n  const child = el.querySelector(selector);\n  if (!child) {\n    console.error(`Failed to find pivot for selector: ${selector}`, el);\n    return el.object3D;\n  }\n  return child.object3D;\n}\n\nexport function getInspectableAndPivot(el) {\n  const inspectable = getInspectableInHierarchy(el);\n  const pivot = pivotFor(inspectable.el);\n  return { inspectable, pivot };\n}\n\nconst decompose = (function() {\n  const scale = new THREE.Vector3();\n  return function decompose(m, p, q) {\n    m.decompose(p, q, scale); //ignore scale, like we're dealing with a motor\n  };\n})();\n\nconst IDENTITY = new THREE.Matrix4().identity();\nconst orbit = (function() {\n  const owq = new THREE.Quaternion();\n  const owp = new THREE.Vector3();\n  const cwq = new THREE.Quaternion();\n  const cwp = new THREE.Vector3();\n  const rwq = new THREE.Quaternion();\n  const UP = new THREE.Vector3();\n  const RIGHT = new THREE.Vector3();\n  const dPos = new THREE.Vector3();\n  const targetPos = new THREE.Vector3();\n  const targetQuat = new THREE.Quaternion();\n  const targetScale = new THREE.Vector3(1, 1, 1);\n  const targetMatrix = new THREE.Matrix4();\n  const dhQ = new THREE.Quaternion();\n  const dvQ = new THREE.Quaternion();\n  return function orbit(pivot, rig, camera, dh, dv, dz, dt, panY) {\n    pivot.updateMatrices();\n    decompose(pivot.matrixWorld, owp, owq);\n\n    camera.updateMatrices();\n    decompose(camera.matrixWorld, cwp, cwq);\n\n    rig.getWorldQuaternion(rwq);\n\n    dhQ.setFromAxisAngle(UP.set(0, 1, 0).applyQuaternion(owq), 0.1 * dh * dt);\n    targetQuat.copy(cwq).premultiply(dhQ);\n    dPos.subVectors(cwp, owp);\n    const zoom = 1 - dz * dt;\n    const newLength = dPos.length() * zoom;\n    // TODO: These limits should be calculated based on the calculated view distance.\n    if (newLength > 0.1 && newLength < 100) {\n      dPos.multiplyScalar(zoom);\n    }\n\n    dvQ.setFromAxisAngle(RIGHT.set(1, 0, 0).applyQuaternion(targetQuat), 0.1 * dv * dt);\n    targetQuat.premultiply(dvQ);\n    targetPos.addVectors(owp, dPos.applyQuaternion(dhQ).applyQuaternion(dvQ)).add(\n      UP.set(0, 1, 0)\n        .multiplyScalar(panY * newLength)\n        .applyQuaternion(targetQuat)\n    );\n\n    targetMatrix.compose(\n      targetPos,\n      targetQuat,\n      targetScale\n    );\n\n    childMatch(rig, camera, targetMatrix);\n  };\n})();\n\nconst moveRigSoCameraLooksAtPivot = (function() {\n  const owq = new THREE.Quaternion();\n  const owp = new THREE.Vector3();\n  const cwq = new THREE.Quaternion();\n  const cwp = new THREE.Vector3();\n  const oForw = new THREE.Vector3();\n  const center = new THREE.Vector3();\n  const defaultBoxMax = new THREE.Vector3(0.3, 0.3, 0.3);\n  const target = new THREE.Object3D();\n  return function moveRigSoCameraLooksAtPivot(rig, camera, inspectable, pivot, distanceMod) {\n    if (!target.parent) {\n      // add dummy object to the scene, if this is the first time we call this function\n      AFRAME.scenes[0].object3D.add(target);\n      target.applyMatrix4(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\n    }\n\n    pivot.updateMatrices();\n    decompose(pivot.matrixWorld, owp, owq);\n    decompose(camera.matrixWorld, cwp, cwq);\n    rig.getWorldQuaternion(cwq);\n\n    const box = getBox(inspectable.el, inspectable.el.getObject3D(\"mesh\") || inspectable, true);\n    if (box.min.x === Infinity) {\n      // fix edgecase where inspectable object has no mesh / dimensions\n      box.min.subVectors(owp, defaultBoxMax);\n      box.max.addVectors(owp, defaultBoxMax);\n    }\n    box.getCenter(center);\n    const vrMode = inspectable.el.sceneEl.is(\"vr-mode\");\n    const dist =\n      calculateViewingDistance(\n        inspectable.el.sceneEl.camera.fov,\n        inspectable.el.sceneEl.camera.aspect,\n        box,\n        center,\n        vrMode\n      ) * distanceMod;\n    target.position.addVectors(\n      owp,\n      oForw\n        .set(0, 0, 1) //TODO: Suspicious that this is called oForw but (0,0,1) is backwards\n        .multiplyScalar(dist)\n        .applyQuaternion(owq)\n    );\n    target.quaternion.copy(owq);\n    target.matrixNeedsUpdate = true;\n    target.updateMatrices();\n    childMatch(rig, camera, target.matrixWorld);\n  };\n})();\n\nexport const CAMERA_MODE_FIRST_PERSON = 0;\nexport const CAMERA_MODE_THIRD_PERSON_NEAR = 1;\nexport const CAMERA_MODE_THIRD_PERSON_FAR = 2;\nexport const CAMERA_MODE_INSPECT = 3;\nexport const CAMERA_MODE_SCENE_PREVIEW = 4;\nexport const CAMERA_MODE_THIRD_PERSON_VIEW = 5;\n\nconst NEXT_MODES = {\n  [CAMERA_MODE_FIRST_PERSON]: CAMERA_MODE_THIRD_PERSON_NEAR,\n  [CAMERA_MODE_THIRD_PERSON_NEAR]: CAMERA_MODE_THIRD_PERSON_FAR,\n  [CAMERA_MODE_THIRD_PERSON_FAR]: CAMERA_MODE_FIRST_PERSON\n};\n\nconst ensureLightsAreSeenByCamera = function(o) {\n  if (o.isLight) {\n    o.layers.enable(Layers.CAMERA_LAYER_INSPECT);\n  }\n};\n\nconst firstPersonOnlyLayer = new THREE.Layers();\nfirstPersonOnlyLayer.set(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\nconst enableInspectLayer = function(o) {\n  // Ignore first person only meshes\n  if (o.layers.test(firstPersonOnlyLayer)) return;\n  o.layers.enable(Layers.CAMERA_LAYER_INSPECT);\n};\nconst disableInspectLayer = function(o) {\n  // Ignore first person only meshes\n  if (o.layers.test(firstPersonOnlyLayer)) return;\n  o.layers.disable(Layers.CAMERA_LAYER_INSPECT);\n};\n\nfunction getAudio(o) {\n  let audio;\n  o.traverse(c => {\n    if (!audio && c.type === \"Audio\") {\n      audio = c;\n    }\n  });\n  return audio;\n}\n\nconst FALLOFF = 0.9;\nexport class CameraSystem {\n  constructor(camera, renderer) {\n    this.viewingCamera = camera;\n    this.lightsEnabled = localStorage.getItem(\"show-background-while-inspecting\") === \"true\";\n    this.verticalDelta = 0;\n    this.horizontalDelta = 0;\n    this.inspectZoom = 0;\n    this.mode = CAMERA_MODE_SCENE_PREVIEW;\n    this.snapshot = { audioTransform: new THREE.Matrix4(), matrixWorld: new THREE.Matrix4() };\n    this.audioSourceTargetTransform = new THREE.Matrix4();\n\n    if (customFOV) {\n      this.viewingCamera.fov = customFOV;\n    }\n    this.viewingCamera.layers.enable(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n    this.viewingCamera.layers.enable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n    this.viewingCamera.layers.enable(Layers.CAMERA_LAYER_UI);\n\n    // xr.updateCamera gets called every render to copy the active cameras properties to the XR cameras. We also want to copy layers.\n    // TODO this logic should either be moved into THREE or removed when we ditch aframe camera system\n    const xrManager = renderer.xr;\n    const updateXRCamera = xrManager.updateCamera;\n    xrManager.updateCamera = function(camera) {\n      updateXRCamera(camera);\n      const xrCamera = xrManager.getCamera();\n      xrCamera.layers.mask = camera.layers.mask;\n      if (xrCamera.cameras.length) {\n        xrCamera.cameras[0].layers.set(Layers.CAMERA_LAYER_XR_LEFT_EYE);\n        xrCamera.cameras[0].layers.mask |= camera.layers.mask;\n        xrCamera.cameras[1].layers.set(Layers.CAMERA_LAYER_XR_RIGHT_EYE);\n        xrCamera.cameras[1].layers.mask |= camera.layers.mask;\n      }\n    };\n\n    waitForDOMContentLoaded().then(() => {\n      this.avatarPOV = document.getElementById(\"avatar-pov-node\");\n      this.avatarRig = document.getElementById(\"avatar-rig\");\n      this.viewingRig = document.getElementById(\"viewing-rig\");\n\n      const bg = new THREE.Mesh(\n        new THREE.BoxGeometry(100, 100, 100),\n        new THREE.MeshBasicMaterial({ color: 0x020202, side: THREE.BackSide })\n      );\n      bg.layers.set(Layers.CAMERA_LAYER_INSPECT);\n      this.viewingRig.object3D.add(bg);\n    });\n  }\n\n  nextMode() {\n    if (this.mode === CAMERA_MODE_INSPECT) {\n      this.uninspect();\n      return;\n    }\n\n    if (!enableThirdPersonMode) return;\n    if (this.mode === CAMERA_MODE_SCENE_PREVIEW) return;\n\n    this.mode = NEXT_MODES[this.mode] || 0;\n  }\n\n  inspect(el, distanceMod, fireChangeEvent = true) {\n    const { inspectable, pivot } = getInspectableAndPivot(el);\n\n    this.verticalDelta = 0;\n    this.horizontalDelta = 0;\n    this.inspectZoom = 0;\n    if (this.mode === CAMERA_MODE_INSPECT) {\n      return;\n    }\n    const scene = AFRAME.scenes[0];\n    scene.object3D.traverse(ensureLightsAreSeenByCamera);\n    scene.classList.add(\"hand-cursor\");\n    scene.classList.remove(\"no-cursor\");\n    this.snapshot.mode = this.mode;\n    this.mode = CAMERA_MODE_INSPECT;\n    this.inspectable = inspectable;\n    this.pivot = pivot;\n\n    const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n    this.snapshot.mask = camera.layers.mask;\n    if (!this.lightsEnabled) {\n      this.hideEverythingButThisObject(inspectable);\n    } else {\n      camera.layers.disable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n      camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n    }\n\n    this.viewingCamera.updateMatrices();\n    this.snapshot.matrixWorld.copy(this.viewingRig.object3D.matrixWorld);\n\n    this.snapshot.audio = !(inspectable.el && isTagged(inspectable.el, \"preventAudioBoost\")) && getAudio(inspectable);\n    if (this.snapshot.audio) {\n      this.snapshot.audio.updateMatrices();\n      this.snapshot.audioTransform.copy(this.snapshot.audio.matrixWorld);\n      scene.audioListener.updateMatrices();\n      this.audioSourceTargetTransform.makeTranslation(0, 0, -0.25).premultiply(scene.audioListener.matrixWorld);\n      setMatrixWorld(this.snapshot.audio, this.audioSourceTargetTransform);\n    }\n\n    this.ensureListenerIsParentedCorrectly(scene);\n\n    moveRigSoCameraLooksAtPivot(\n      this.viewingRig.object3D,\n      this.viewingCamera,\n      this.inspectable,\n      this.pivot,\n      distanceMod || 1\n    );\n\n    if (fireChangeEvent) {\n      scene.emit(\"inspect-target-changed\");\n    }\n  }\n\n  uninspect(fireChangeEvent = true) {\n    if (this.mode !== CAMERA_MODE_INSPECT) return;\n    const scene = AFRAME.scenes[0];\n    if (scene.is(\"entered\")) {\n      scene.classList.remove(\"hand-cursor\");\n      scene.classList.add(\"no-cursor\");\n    }\n    this.showEverythingAsNormal();\n    this.inspectable = null;\n    this.pivot = null;\n    if (this.snapshot.audio) {\n      setMatrixWorld(this.snapshot.audio, this.snapshot.audioTransform);\n      this.snapshot.audio = null;\n    }\n\n    this.mode = this.snapshot.mode;\n    if (this.snapshot.mode === CAMERA_MODE_SCENE_PREVIEW) {\n      setMatrixWorld(this.viewingRig.object3D, this.snapshot.matrixWorld);\n    }\n    this.snapshot.mode = null;\n    this.tick(AFRAME.scenes[0]);\n\n    if (fireChangeEvent) {\n      scene.emit(\"inspect-target-changed\");\n    }\n  }\n\n  toggleLights() {\n    this.lightsEnabled = !this.lightsEnabled;\n    localStorage.setItem(\"show-background-while-inspecting\", this.lightsEnabled.toString());\n\n    if (this.mode === CAMERA_MODE_INSPECT && this.inspectable) {\n      if (this.lightsEnabled) {\n        this.showEverythingAsNormal();\n        const scene = AFRAME.scenes[0];\n        const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n        camera.layers.disable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n        camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n      } else {\n        this.hideEverythingButThisObject(this.inspectable);\n      }\n    }\n\n    AFRAME.scenes[0].emit(\"inspect-lights-changed\");\n  }\n\n  ensureListenerIsParentedCorrectly(scene) {\n    if (scene.audioListener && this.avatarPOV) {\n      if (this.mode === CAMERA_MODE_INSPECT && scene.audioListener.parent !== this.avatarPOV.object3D) {\n        this.avatarPOV.object3D.add(scene.audioListener);\n      } else if (\n        (this.mode === CAMERA_MODE_FIRST_PERSON ||\n          this.mode === CAMERA_MODE_THIRD_PERSON_NEAR ||\n          this.mode === CAMERA_MODE_THIRD_PERSON_FAR) &&\n        scene.audioListener.parent !== this.viewingCamera\n      ) {\n        this.viewingCamera.add(scene.audioListener);\n      }\n    }\n  }\n\n  hideEverythingButThisObject(o) {\n    this.notHiddenObject = o;\n    o.traverse(enableInspectLayer);\n\n    const scene = AFRAME.scenes[0];\n    const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n    camera.layers.set(Layers.CAMERA_LAYER_INSPECT);\n  }\n\n  showEverythingAsNormal() {\n    if (this.notHiddenObject) {\n      this.notHiddenObject.traverse(disableInspectLayer);\n      this.notHiddenObject = null;\n    }\n    const scene = AFRAME.scenes[0];\n    const camera = scene.is(\"vr-mode\") ? scene.renderer.xr.getCamera() : scene.camera;\n    camera.layers.mask = this.snapshot.mask;\n  }\n\n  tick = (function() {\n    const translation = new THREE.Matrix4();\n    let uiRoot;\n    return function tick(scene, dt) {\n      this.viewingCamera.matrixNeedsUpdate = true;\n      this.viewingCamera.updateMatrix();\n      this.viewingCamera.updateMatrixWorld();\n\n      const entered = scene.is(\"entered\");\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\n      const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n      if (isGhost && this.mode !== CAMERA_MODE_FIRST_PERSON && this.mode !== CAMERA_MODE_INSPECT) {\n        this.mode = CAMERA_MODE_FIRST_PERSON;\n        const position = new THREE.Vector3();\n        const quat = new THREE.Quaternion();\n        const scale = new THREE.Vector3();\n        this.viewingRig.object3D.updateMatrices();\n        this.viewingRig.object3D.matrixWorld.decompose(position, quat, scale);\n        position.setFromMatrixPosition(this.viewingCamera.matrixWorld);\n        position.y = position.y - 1.6;\n        setMatrixWorld(\n          this.avatarRig.object3D,\n          new THREE.Matrix4().compose(\n            position,\n            quat,\n            scale\n          )\n        );\n        scene.systems[\"hubs-systems\"].characterController.fly = true;\n        this.avatarPOV.object3D.updateMatrices();\n        setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.matrixWorld);\n      }\n      if (!this.enteredScene && entered) {\n        this.enteredScene = true;\n        this.mode = CAMERA_MODE_FIRST_PERSON;\n      }\n      this.avatarPOVRotator = this.avatarPOVRotator || this.avatarPOV.components[\"pitch-yaw-rotator\"];\n      this.viewingCameraRotator = this.viewingCameraRotator || this.viewingCamera.el.components[\"pitch-yaw-rotator\"];\n      this.avatarPOVRotator.on = true;\n      this.viewingCameraRotator.on = true;\n\n      this.userinput = this.userinput || scene.systems.userinput;\n      this.interaction = this.interaction || scene.systems.interaction;\n\n      if (this.userinput.get(paths.actions.startInspecting) && this.mode !== CAMERA_MODE_INSPECT) {\n        const hoverEl = this.interaction.state.rightRemote.hovered || this.interaction.state.leftRemote.hovered;\n\n        if (hoverEl) {\n          this.inspect(hoverEl, 1.5);\n        }\n      } else if (this.mode === CAMERA_MODE_INSPECT && this.userinput.get(paths.actions.stopInspecting)) {\n        scene.emit(\"uninspect\");\n        this.uninspect();\n      }\n\n      if (this.userinput.get(paths.actions.nextCameraMode)) {\n        this.nextMode();\n      }\n\n      this.ensureListenerIsParentedCorrectly(scene);\n\n      if (this.mode === CAMERA_MODE_FIRST_PERSON) {\n        this.viewingCameraRotator.on = false;\n        this.avatarRig.object3D.updateMatrices();\n        setMatrixWorld(this.viewingRig.object3D, this.avatarRig.object3D.matrixWorld);\n        if (scene.is(\"vr-mode\")) {\n          this.viewingCamera.updateMatrices();\n          setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.matrixWorld);\n        } else {\n          this.avatarPOV.object3D.updateMatrices();\n          setMatrixWorld(this.viewingCamera, this.avatarPOV.object3D.matrixWorld);\n        }\n      } else if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR || this.mode === CAMERA_MODE_THIRD_PERSON_FAR) {\n        if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR) {\n          translation.makeTranslation(0, 1, 3);\n        } else {\n          translation.makeTranslation(0, 2, 8);\n        }\n        this.avatarRig.object3D.updateMatrices();\n        this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld).multiply(translation);\n        setMatrixWorld(this.viewingRig.object3D, this.viewingRig.object3D.matrixWorld);\n        this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.quaternion);\n        this.avatarPOV.object3D.matrixNeedsUpdate = true;\n      } else if (this.mode === CAMERA_MODE_INSPECT) {\n        this.avatarPOVRotator.on = false;\n        this.viewingCameraRotator.on = false;\n        const cameraDelta = this.userinput.get(\n          scene.is(\"entered\") ? paths.actions.cameraDelta : paths.actions.lobbyCameraDelta\n        );\n\n        if (cameraDelta) {\n          // TODO: Move device specific tinkering to action sets\n          const horizontalDelta = (AFRAME.utils.device.isMobile() ? -0.6 : 1) * cameraDelta[0] || 0;\n          const verticalDelta = (AFRAME.utils.device.isMobile() ? -1.2 : 1) * cameraDelta[1] || 0;\n          this.horizontalDelta = (this.horizontalDelta + horizontalDelta) / 2;\n          this.verticalDelta = (this.verticalDelta + verticalDelta) / 2;\n        } else if (Math.abs(this.verticalDelta) > 0.0001 || Math.abs(this.horizontalDelta) > 0.0001) {\n          this.verticalDelta = FALLOFF * this.verticalDelta;\n          this.horizontalDelta = FALLOFF * this.horizontalDelta;\n        }\n\n        const inspectZoom = this.userinput.get(paths.actions.inspectZoom) * 0.001;\n        if (inspectZoom) {\n          this.inspectZoom = inspectZoom + (5 * this.inspectZoom) / 6;\n        } else if (Math.abs(this.inspectZoom) > 0.0001) {\n          this.inspectZoom = FALLOFF * this.inspectZoom;\n        }\n        const panY = this.userinput.get(paths.actions.inspectPanY) || 0;\n        if (this.userinput.get(paths.actions.resetInspectView)) {\n          moveRigSoCameraLooksAtPivot(this.viewingRig.object3D, this.viewingCamera, this.inspectable, this.pivot, 1);\n        }\n        if (this.snapshot.audio) {\n          setMatrixWorld(this.snapshot.audio, this.audioSourceTargetTransform);\n        }\n\n        if (\n          Math.abs(this.verticalDelta) > 0.001 ||\n          Math.abs(this.horizontalDelta) > 0.001 ||\n          Math.abs(this.inspectZoom) > 0.001 ||\n          Math.abs(panY) > 0.0001\n        ) {\n          orbit(\n            this.pivot,\n            this.viewingRig.object3D,\n            this.viewingCamera,\n            this.horizontalDelta,\n            this.verticalDelta,\n            this.inspectZoom,\n            dt,\n            panY\n          );\n        }\n      } else if (this.mode === CAMERA_MODE_THIRD_PERSON_VIEW) {\n        this.viewingCameraRotator.on = false;\n        translation.makeTranslation(0, 0, 1);\n        this.avatarRig.object3D.updateMatrices();\n        setMatrixWorld(this.viewingRig.object3D, this.avatarRig.object3D.matrixWorld);\n        if (scene.is(\"vr-mode\")) {\n          this.viewingCamera.updateMatrices();\n          setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.matrixWorld);\n        } else {\n          this.avatarPOV.object3D.updateMatrices();\n          setMatrixWorld(this.viewingCamera, this.avatarPOV.object3D.matrixWorld.multiply(translation));\n        }\n\n        this.avatarRig.object3D.updateMatrices();\n        this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld);\n        setMatrixWorld(this.viewingRig.object3D, this.viewingRig.object3D.matrixWorld);\n        this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.quaternion);\n        this.avatarPOV.object3D.matrixNeedsUpdate = true;\n      }\n    };\n  })();\n}\n","import { setMatrixWorld } from \"../utils/three-utils\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\nimport { CAMERA_MODE_SCENE_PREVIEW } from \"../systems/camera-system\";\n\nfunction getStreamerCamera() {\n  const streamer = getCurrentStreamer();\n  if (streamer) {\n    return streamer.el.querySelector(\".camera\").object3D;\n  }\n  return null;\n}\n\nfunction lerp(start, end, t) {\n  return (1 - t) * start + t * end;\n}\n\nconst newRot = new THREE.Quaternion();\n\n/**\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\n * since it ends up panning in a direction dependent upon the start camera orientation,\n * but it's good enough for now.\n */\nAFRAME.registerComponent(\"scene-preview-camera\", {\n  schema: {\n    duration: { default: 90, type: \"number\" },\n    positionOnly: { default: false, type: \"boolean\" }\n  },\n\n  init: function() {\n    const systems = AFRAME.scenes[0].systems[\"hubs-systems\"] || AFRAME.scenes[0].systems[\"scene-systems\"];\n\n    if (systems) {\n      systems.scenePreviewCameraSystem.register(this.el);\n    }\n\n    this.startPoint = this.el.object3D.position.clone();\n    this.startRotation = this.el.object3D.quaternion.clone();\n\n    this.targetPoint = this.el.object3D.position.clone();\n    this.targetPoint.y = Math.max(this.targetPoint.y - 1.5, 1);\n    this.targetPoint.add(new THREE.Vector3(2, 0, -2));\n\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\n    this.targetRotation = new THREE.Quaternion();\n    this.targetRotation.setFromEuler(targetRotDelta);\n    this.targetRotation.premultiply(this.startRotation);\n\n    this.startTime = performance.now();\n    this.backwards = false;\n    this.ranOnePass = false;\n  },\n\n  tick2: function() {\n    const hubsSystems = this.el.sceneEl.systems[\"hubs-systems\"];\n\n    let streamerCamera;\n    if (hubsSystems) {\n      hubsSystems.cameraSystem.mode = CAMERA_MODE_SCENE_PREVIEW;\n      streamerCamera = getStreamerCamera();\n    }\n\n    if (streamerCamera) {\n      setMatrixWorld(this.el.object3D, streamerCamera.matrixWorld);\n      // Move camera forward just a bit so that we don't see the avatar's eye cylinders.\n      this.el.object3D.translateZ(-0.1);\n      this.el.object3D.matrixNeedsUpdate = true;\n    } else {\n      let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\n      t = Math.min(1.0, Math.max(0.0, t));\n\n      if (!this.ranOnePass) {\n        t = t * (2 - t);\n      } else {\n        t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n      }\n\n      const from = this.backwards ? this.targetPoint : this.startPoint;\n      const to = this.backwards ? this.startPoint : this.targetPoint;\n      const fromRot = this.backwards ? this.targetRotation : this.startRotation;\n      const toRot = this.backwards ? this.startRotation : this.targetRotation;\n\n      newRot.slerpQuaternions(fromRot, toRot, t);\n\n      this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\n\n      if (!this.data.positionOnly) {\n        this.el.object3D.rotation.setFromQuaternion(newRot);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n\n      if (t >= 0.9999) {\n        this.ranOnePass = true;\n        this.backwards = !this.backwards;\n        this.startTime = performance.now();\n      }\n    }\n  },\n\n  remove: function() {\n    const systems = AFRAME.scenes[0]?.systems[\"hubs-systems\"] || AFRAME.scenes[0]?.systems[\"scene-systems\"];\n\n    if (systems) {\n      systems.scenePreviewCameraSystem.unregister(this.el);\n    }\n  }\n});\n","import { LightProbeGenerator } from \"three/examples/jsm/lights/LightProbeGenerator\";\n\nconst {\n  AmbientLight,\n  BackSide,\n  BoxBufferGeometry,\n  CubeCamera,\n  LinearFilter,\n  Mesh,\n  Object3D,\n  PMREMGenerator,\n  RGBAFormat,\n  Scene,\n  ShaderMaterial,\n  sRGBEncoding,\n  UniformsLib,\n  UniformsUtils,\n  Vector3,\n  WebGLCubeRenderTarget\n} = THREE;\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nconst vertexShader = `\n#include <common>\n#include <fog_pars_vertex>\n\nuniform vec3 sunPosition;\nuniform float rayleigh;\nuniform float turbidity;\nuniform float mieCoefficient;\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\nconst float pi = 3.141592653589793238462643383279502884197169;\n\n// wavelength of used primaries, according to preetham\nconst vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\nconst vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n// mie stuff\n// K coefficient for the primaries\nconst float v = 4.0;\nconst vec3 K = vec3( 0.686, 0.678, 0.666 );\n// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\nconst vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n// earth shadow hack\n// cutoffAngle = pi / 1.95;\nconst float cutoffAngle = 1.6110731556870734;\nconst float steepness = 1.5;\nconst float EE = 1000.0;\n\nfloat sunIntensity( float zenithAngleCos ) {\n  zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n  return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n}\n\nvec3 totalMie( float T ) {\n  float c = ( 0.2 * T ) * 10E-18;\n  return 0.434 * c * MieConst;\n}\n\nvoid main() {\n  #include <begin_vertex>\n\n  vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n  vWorldPosition = worldPosition.xyz;\n\n  #include <project_vertex>\n\n  vSunDirection = normalize( sunPosition );\n\n  vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n  vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n  float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n  // extinction (absorbtion + out scattering)\n  // rayleigh coefficients\n  vBetaR = totalRayleigh * rayleighCoefficient;\n\n  // mie coefficients\n  vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n  #include <fog_vertex>\n}\n`;\n\nconst fragmentShader = `\n#include <common>\n#include <fog_pars_fragment>\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nuniform float luminance;\nuniform float mieDirectionalG;\n\nconst vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float pi = 3.141592653589793238462643383279502884197169;\n\nconst float n = 1.0003; // refractive index of air\nconst float N = 2.545E25; // number of molecules per unit volume for air at\n// 288.15K and 1013mb (sea level -45 celsius)\n\n// optical length at zenith for molecules\nconst float rayleighZenithLength = 8.4E3;\nconst float mieZenithLength = 1.25E3;\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n// 66 arc seconds -> degrees, and the cosine of that\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n// 3.0 / ( 16.0 * pi )\nconst float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n// 1.0 / ( 4.0 * pi )\nconst float ONE_OVER_FOURPI = 0.07957747154594767;\n\nfloat rayleighPhase( float cosTheta ) {\n  return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n}\n\nfloat hgPhase( float cosTheta, float g ) {\n  float g2 = pow( g, 2.0 );\n  float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n  return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n}\n\n// Filmic ToneMapping http://filmicgames.com/archives/75\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\nconst float whiteScale = 1.0748724675633854; // 1.0 / Uncharted2Tonemap(1000.0)\n\nvec3 Uncharted2Tonemap( vec3 x ) {\n  return ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\n}\n\nvoid main() {\n  // optical length\n  // cutoff angle at 90 to avoid singularity in next formula.\n  float zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\n  float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n  float sR = rayleighZenithLength * inverse;\n  float sM = mieZenithLength * inverse;\n\n  // combined extinction factor\n  vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n  // in scattering\n  float cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\n\n  float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n  vec3 betaRTheta = vBetaR * rPhase;\n\n  float mPhase = hgPhase( cosTheta, mieDirectionalG );\n  vec3 betaMTheta = vBetaM * mPhase;\n\n  vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n  Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n  // nightsky\n  vec3 direction = normalize( vWorldPosition - cameraPos );\n  float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\n  float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\n  vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n  vec3 L0 = vec3( 0.1 ) * Fex;\n\n  // composition + solar disc\n  float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n  L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n  vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n  vec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\n  vec3 color = curr * whiteScale;\n\n  vec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n  gl_FragColor = vec4( retColor, 1.0 );\n\n  #include <fog_fragment>\n}\n`;\n\nexport default class Sky extends Object3D {\n  static shader = {\n    uniforms: UniformsUtils.merge([\n      UniformsLib.fog,\n      {\n        luminance: { value: 1 },\n        turbidity: { value: 10 },\n        rayleigh: { value: 2 },\n        mieCoefficient: { value: 0.005 },\n        mieDirectionalG: { value: 0.8 },\n        sunPosition: { value: new Vector3() }\n      }\n    ]),\n    vertexShader,\n    fragmentShader\n  };\n\n  static _geometry = new BoxBufferGeometry(1, 1, 1);\n\n  constructor() {\n    super();\n\n    const material = new ShaderMaterial({\n      fragmentShader: Sky.shader.fragmentShader,\n      vertexShader: Sky.shader.vertexShader,\n      uniforms: UniformsUtils.clone(Sky.shader.uniforms),\n      side: BackSide,\n      fog: true\n    });\n\n    this.sky = new Mesh(Sky._geometry, material);\n    this.sky.name = \"Sky\";\n    this.add(this.sky);\n\n    this._inclination = 0;\n    this._azimuth = 0.15;\n    this._distance = 8000;\n    this.updateSunPosition();\n  }\n\n  get turbidity() {\n    return this.sky.material.uniforms.turbidity.value;\n  }\n\n  set turbidity(value) {\n    this.sky.material.uniforms.turbidity.value = value;\n  }\n\n  get rayleigh() {\n    return this.sky.material.uniforms.rayleigh.value;\n  }\n\n  set rayleigh(value) {\n    this.sky.material.uniforms.rayleigh.value = value;\n  }\n\n  get luminance() {\n    return this.sky.material.uniforms.luminance.value;\n  }\n\n  set luminance(value) {\n    this.sky.material.uniforms.luminance.value = value;\n  }\n\n  get mieCoefficient() {\n    return this.sky.material.uniforms.mieCoefficient.value;\n  }\n\n  set mieCoefficient(value) {\n    this.sky.material.uniforms.mieCoefficient.value = value;\n  }\n\n  get mieDirectionalG() {\n    return this.sky.material.uniforms.mieDirectionalG.value;\n  }\n\n  set mieDirectionalG(value) {\n    this.sky.material.uniforms.mieDirectionalG.value = value;\n  }\n\n  get inclination() {\n    return this._inclination;\n  }\n\n  set inclination(value) {\n    this._inclination = value;\n    this.updateSunPosition();\n  }\n\n  get azimuth() {\n    return this._azimuth;\n  }\n\n  set azimuth(value) {\n    this._azimuth = value;\n    this.updateSunPosition();\n  }\n\n  get distance() {\n    return this._distance;\n  }\n\n  set distance(value) {\n    this._distance = value;\n    this.updateSunPosition();\n  }\n\n  updateSunPosition() {\n    const theta = Math.PI * (this._inclination - 0.5);\n    const phi = 2 * Math.PI * (this._azimuth - 0.5);\n\n    const distance = Math.min(1000, this._distance);\n\n    const x = distance * Math.cos(phi);\n    const y = distance * Math.sin(phi) * Math.sin(theta);\n    const z = distance * Math.sin(phi) * Math.cos(theta);\n\n    this.sky.material.uniforms.sunPosition.value.set(x, y, z).normalize();\n    this.sky.scale.set(distance, distance, distance);\n  }\n\n  generateEnvironmentMap(renderer) {\n    const skyScene = new Scene();\n    const cubeCamera = new CubeCamera(1, 100000, new WebGLCubeRenderTarget(512));\n    skyScene.add(cubeCamera);\n    skyScene.add(this.sky);\n    cubeCamera.update(renderer, skyScene);\n    this.add(this.sky);\n    const vrEnabled = renderer.xr.enabled;\n    renderer.xr.enabled = false;\n    const pmremGenerator = new PMREMGenerator(renderer);\n    const envMap = pmremGenerator.fromCubemap(cubeCamera.renderTarget.texture).texture;\n    renderer.xr.enabled = vrEnabled;\n    pmremGenerator.dispose();\n    cubeCamera.renderTarget.dispose();\n    return envMap;\n  }\n\n  generateLightProbe(renderer) {\n    const skyScene = new Scene();\n    skyScene.add(this.sky);\n\n    const cubeCamera = new CubeCamera(\n      1,\n      100000,\n      new WebGLCubeRenderTarget(512, {\n        format: RGBAFormat,\n        magFilter: LinearFilter,\n        minFilter: LinearFilter,\n        encoding: sRGBEncoding\n      })\n    );\n    skyScene.add(cubeCamera);\n    skyScene.add(this.sky);\n    cubeCamera.update(renderer, skyScene);\n    this.add(this.sky);\n    const lightProbe = LightProbeGenerator.fromCubeRenderTarget(renderer, cubeCamera.renderTarget);\n    cubeCamera.renderTarget.dispose();\n    return lightProbe;\n  }\n\n  copy(source, recursive = true) {\n    if (recursive) {\n      this.remove(this.sky);\n    }\n\n    super.copy(source, recursive);\n\n    if (recursive) {\n      const skyIndex = source.children.indexOf(source.sky);\n\n      if (skyIndex !== -1) {\n        this.sky = this.children[skyIndex];\n      }\n    }\n\n    this.turbidity = source.turbidity;\n    this.rayleigh = source.rayleigh;\n    this.luminance = source.luminance;\n    this.mieCoefficient = source.mieCoefficient;\n    this.mieDirectionalG = source.mieDirectionalG;\n    this.inclination = source.inclination;\n    this.azimuth = source.azimuth;\n    this.distance = source.distance;\n\n    return this;\n  }\n}\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0.15 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n  },\n\n  update(oldData) {\n    if (this.data.turbidity !== oldData.turbidity) {\n      this.sky.turbidity = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      this.sky.rayleigh = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      this.sky.luminance = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      this.sky.mieCoefficient = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      this.sky.mieDirectionalG = this.data.mieDirectionalG;\n    }\n\n    if (this.data.inclination !== oldData.inclination) {\n      this.sky.inclination = this.data.inclination;\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    if (this.data.azimuth !== oldData.azimuth) {\n      this.sky.azimuth = this.data.azimuth;\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    if (this.data.distance !== oldData.distance) {\n      const distance = this.data.distance;\n\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\n      // have their sky scales set to 1.\n      this.sky.distance = this.el.object3D.scale.x === 1 ? distance : 1;\n      this.sky.matrixNeedsUpdate = true;\n    }\n\n    // TODO Remove or rework medium quality mode\n    if (window.APP.store.state.preferences.materialQualitySetting === \"medium\") {\n      // This extra ambient light is here to normalize lighting with the MeshStandardMaterial.\n      // Without it, objects are significantly darker in brighter environments.\n      // It's kept to a low value to not wash out objects in very dark environments.\n      // This is a hack, but the results are much better than they are without it.\n      this.el.setObject3D(\"ambient-light\", new AmbientLight(0xffffff, 0.3));\n      this.el.setObject3D(\"light-probe\", this.sky.generateLightProbe(this.el.sceneEl.renderer));\n    }\n\n    // TODO if we care about dynamic skybox changes we should also update the enviornment map here\n    //\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\n/**\n * Used on a avatar-rig to move the avatar to a random spawn point on entry.\n * @namespace avatar\n * @component spawn-controller\n */\nAFRAME.registerComponent(\"spawn-controller\", {\n  schema: {\n    target: { type: \"selector\" },\n    camera: { type: \"selector\", default: \"#avatar-pov-node\" },\n    playerHeight: { default: 1.6 },\n    loadedEvent: { type: \"string\" }\n  },\n  init() {\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\n\n    waitForDOMContentLoaded().then(() => {\n      this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\n    });\n  },\n  moveToSpawnPoint() {\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\n\n    if (spawnPoints.length === 0) {\n      // Keep default position\n      return;\n    }\n\n    const camera = this.data.camera;\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\n    const spawnPoint = spawnPoints[spawnPointIndex];\n\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\n\n    if (this.el.sceneEl.is(\"vr-mode\")) {\n      // Rotate the avatar rig such that the vr-camera faces forward.\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\n    } else {\n      // Reset the camera transform in 2D mode.\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\n      camera.object3D.rotation.set(0, 0, 0);\n      camera.object3D.matrixNeedsUpdate = true;\n    }\n\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\n    this.el.object3D.rotation.y += Math.PI;\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n\n/**\n * Marks an entity as a potential spawn point.\n * @namespace environment\n * @component spawn-point\n */\nAFRAME.registerComponent(\"spawn-point\", {\n  init() {\n    this.el.object3D.visible = false;\n  }\n});\n","const COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nimport {\n  enterQuery,\n  addComponent,\n  removeComponent,\n  defineComponent,\n  defineQuery,\n  exitQuery,\n  hasComponent,\n  Not,\n  entityExists\n} from \"bitecs\";\nimport { FloatyObject, Held, Owned, Rigidbody, MakeKinematicOnRelease } from \"../bit-components\";\n\nexport const MakeStaticWhenAtRest = defineComponent();\n\nconst makeStaticAtRestQuery = defineQuery([FloatyObject, Rigidbody, Not(Held), MakeStaticWhenAtRest]);\nfunction makeStaticAtRest(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  makeStaticAtRestQuery(world).forEach(eid => {\n    const isMine = hasComponent(world, Owned, eid);\n    if (!isMine) {\n      removeComponent(world, MakeStaticWhenAtRest, eid);\n      return;\n    }\n\n    const bodyId = Rigidbody.bodyId[eid];\n    const bodyData = physicsSystem.bodyUuidToData.get(bodyId);\n    const isAtRest =\n      physicsSystem.bodyInitialized(bodyId) &&\n      physicsSystem.getLinearVelocity(bodyId) < bodyData.options.linearSleepingThreshold &&\n      physicsSystem.getAngularVelocity(bodyId) < bodyData.options.angularSleepingThreshold;\n\n    if (isAtRest) {\n      Object.assign(bodyData.options, {\n        type: \"kinematic\"\n      });\n      physicsSystem.updateBody(bodyId, bodyData.options);\n      removeComponent(world, MakeStaticWhenAtRest, eid);\n    }\n  });\n}\n\nconst makeKinematicOnReleaseExitQuery = exitQuery(defineQuery([Rigidbody, Held, MakeKinematicOnRelease]));\nfunction makeKinematicOnRelease(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  makeKinematicOnReleaseExitQuery(world).forEach(eid => {\n    if (!entityExists(world, eid) || !hasComponent(world, Owned, eid)) return;\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], { type: \"kinematic\" });\n  });\n}\n\nexport const FLOATY_OBJECT_FLAGS = {\n  MODIFY_GRAVITY_ON_RELEASE: 1 << 0,\n  REDUCE_ANGULAR_FLOAT: 1 << 1,\n  UNTHROWABLE: 1 << 2\n};\n\nconst enteredFloatyObjectsQuery = enterQuery(defineQuery([FloatyObject, Rigidbody]));\nconst heldFloatyObjectsQuery = defineQuery([FloatyObject, Rigidbody, Held]);\nconst exitedHeldFloatyObjectsQuery = exitQuery(heldFloatyObjectsQuery);\nconst enterHeldFloatyObjectsQuery = enterQuery(heldFloatyObjectsQuery);\nexport const floatyObjectSystem = world => {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  enteredFloatyObjectsQuery(world).forEach(eid => {\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], {\n      type: \"kinematic\",\n      gravity: { x: 0, y: 0, z: 0 }\n    });\n  });\n\n  enterHeldFloatyObjectsQuery(world).forEach(eid => {\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], {\n      gravity: { x: 0, y: 0, z: 0 },\n      type: \"dynamic\",\n      collisionFilterMask: COLLISION_LAYERS.HANDS | COLLISION_LAYERS.MEDIA_FRAMES\n    });\n  });\n\n  exitedHeldFloatyObjectsQuery(world).forEach(eid => {\n    if (!entityExists(world, eid) || !(hasComponent(world, FloatyObject, eid) && hasComponent(world, Rigidbody, eid)))\n      return;\n\n    const bodyId = Rigidbody.bodyId[eid];\n    const bodyData = physicsSystem.bodyUuidToData.get(bodyId);\n    if (FloatyObject.flags[eid] & FLOATY_OBJECT_FLAGS.MODIFY_GRAVITY_ON_RELEASE) {\n      if (bodyData.linearVelocity < 1.85) {\n        physicsSystem.updateBodyOptions(bodyId, {\n          gravity: { x: 0, y: 0, z: 0 },\n          angularDamping: FloatyObject.flags[eid] & FLOATY_OBJECT_FLAGS.REDUCE_ANGULAR_FLOAT ? 0.89 : 0.5,\n          linearDamping: 0.95,\n          linearSleepingThreshold: 0.1,\n          angularSleepingThreshold: 0.1,\n          collisionFilterMask: COLLISION_LAYERS.HANDS | COLLISION_LAYERS.MEDIA_FRAMES\n        });\n        addComponent(world, MakeStaticWhenAtRest, eid);\n      } else {\n        physicsSystem.updateBodyOptions(bodyId, {\n          gravity: { x: 0, y: FloatyObject.releaseGravity[eid], z: 0 },\n          angularDamping: 0.01,\n          linearDamping: 0.01,\n          linearSleepingThreshold: 1.6,\n          angularSleepingThreshold: 2.5,\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n        });\n        removeComponent(world, MakeStaticWhenAtRest, eid);\n      }\n    } else {\n      physicsSystem.updateBodyOptions(bodyId, {\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE,\n        gravity: { x: 0, y: -9.8, z: 0 }\n      });\n    }\n  });\n\n  makeStaticAtRest(world);\n  makeKinematicOnRelease(world);\n};\n","import { addComponent } from \"bitecs\";\nimport { FloatyObject } from \"../bit-components\";\nimport { FLOATY_OBJECT_FLAGS } from \"../systems/floaty-object-system\";\n/* global AFRAME */\n\nAFRAME.registerComponent(\"floaty-object\", {\n  schema: {\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\n    // otherwise apply releaseGravity.\n    modifyGravityOnRelease: { default: false },\n\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\n    releaseGravity: { default: -2 },\n\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\n    reduceAngularFloat: { default: false },\n\n    // If true, the object will behave the same regardless of how fast it was moving when released\n    unthrowable: { default: false }\n  },\n\n  init() {\n    addComponent(APP.world, FloatyObject, this.el.object3D.eid);\n  },\n\n  update() {\n    FloatyObject.flags[this.el.eid] =\n      (this.data.modifyGravityOnRelease && FLOATY_OBJECT_FLAGS.MODIFY_GRAVITY_ON_RELEASE) |\n      (this.data.reduceAngularFloat && FLOATY_OBJECT_FLAGS.REDUCE_ANGULAR_FLOAT) |\n      (this.data.unthrowable && FLOATY_OBJECT_FLAGS.UNTHROWABLE);\n    FloatyObject.releaseGravity[this.el.eid] = this.data.releaseGravity;\n  }\n});\n","/* global require AFRAME THREE setTimeout clearTimeout */\nimport { addMedia } from \"../utils/media-utils\";\nimport { waitForEvent } from \"../utils/async-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport { addComponent } from \"bitecs\";\nimport { Held, HeldRemoteLeft, HeldRemoteRight } from \"../bit-components\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nfunction setNonNullVec3Components(target, values) {\n  target.set(\n    values.x === null ? target.x : values.x,\n    values.y === null ? target.y : values.y,\n    values.z === null ? target.z : values.z\n  );\n}\n\n/**\n * Spawns networked objects when grabbed or when a specified event is fired.\n * @namespace network\n * @component super-spawner\n */\nAFRAME.registerComponent(\"super-spawner\", {\n  schema: {\n    /**\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\n     */\n    src: { default: \"\" },\n\n    /**\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\n     */\n    resolve: { default: false },\n\n    /**\n     * The template to use for this object\n     */\n    template: { default: \"\" },\n\n    /**\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\n     */\n    spawnScale: { type: \"vec3\", default: { x: NaN, y: NaN, z: NaN } },\n\n    /**\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\n     */\n    spawnCooldown: { default: 1 },\n\n    /**\n     * Optional event to listen for to spawn an object on the preferred superHand\n     */\n    spawnEvent: { type: \"string\" },\n\n    /**\n     * If true, will spawn the object at the cursor and animate it into the hand.\n     */\n    animateFromCursor: { type: \"boolean\" },\n\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.cooldownTimeout = null;\n    this.handPosition = new THREE.Vector3();\n\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\n\n    this.sceneEl = this.el.sceneEl;\n\n    this.tempSpawnHandPosition = new THREE.Vector3();\n\n    this.handleMediaLoaded = this.handleMediaLoaded.bind(this);\n\n    this.spawnedMediaScale = null;\n  },\n\n  play() {\n    this.el.addEventListener(\"media-loaded\", this.handleMediaLoaded);\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n  },\n\n  pause() {\n    this.el.removeEventListener(\"media-loaded\", this.handleMediaLoaded);\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n    if (this.cooldownTimeout) {\n      clearTimeout(this.cooldownTimeout);\n      this.cooldownTimeout = null;\n      this.el.setAttribute(\"visible\", true);\n      this.el.classList.add(\"interactable\");\n    }\n  },\n\n  handleMediaLoaded(e) {\n    const spawnedEntity = e.target;\n    this.spawnedMediaScale = spawnedEntity.object3D.scale.clone();\n    setNonNullVec3Components(this.spawnedMediaScale, this.data.spawnScale);\n\n    const boxSize =\n      spawnedEntity.components[\"media-image\"] ||\n      spawnedEntity.components[\"media-video\"] ||\n      spawnedEntity.components[\"media-pdf\"]\n        ? 1\n        : 0.5;\n\n    const scaleCoefficient = getScaleCoefficient(boxSize, getBox(spawnedEntity, spawnedEntity.object3D));\n    this.spawnedMediaScale.divideScalar(scaleCoefficient);\n  },\n\n  async onSpawnEvent(e) {\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\n      return;\n    }\n\n    const spawnedEntity = addMedia(\n      this.data.src,\n      this.data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      this.data.resolve,\n      false,\n      {\n        x: this.data.spawnScale.x === null ? 1 : this.data.spawnScale.x,\n        y: this.data.spawnScale.y === null ? 1 : this.data.spawnScale.y,\n        z: this.data.spawnScale.z === null ? 1 : this.data.spawnScale.z\n      },\n      this.data.mediaOptions\n    ).entity;\n\n    const interaction = this.el.sceneEl.systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    const cursor = (e.detail && e.detail.object3D) || interaction.options.rightRemote.entity.object3D;\n\n    const left = cursor.el.id.indexOf(\"right\") === -1;\n    const hand = left ? interaction.options.leftHand.entity.object3D : interaction.options.rightHand.entity.object3D;\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n    this.el.emit(\"spawned-entity-created\", { target: spawnedEntity });\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const willAnimateFromCursor =\n      this.data.animateFromCursor &&\n      (userinput.get(paths.actions.rightHand.matrix) || userinput.get(paths.actions.leftHand.matrix));\n    this.activateCooldown();\n    await waitForEvent(\"model-loaded\", spawnedEntity);\n\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n    if (willAnimateFromCursor) {\n      hand.getWorldPosition(this.handPosition);\n      spawnedEntity.setAttribute(\"animation__spawn-at-cursor\", {\n        property: \"position\",\n        delay: 500,\n        dur: 1500,\n        from: {\n          x: spawnedEntity.object3D.position.x,\n          y: spawnedEntity.object3D.position.y,\n          z: spawnedEntity.object3D.position.z\n        },\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\n        easing: \"easeInOutBack\"\n      });\n    } else {\n      addComponent(APP.world, Held, spawnedEntity.eid);\n      if (left) {\n        addComponent(APP.world, HeldRemoteLeft, spawnedEntity.eid);\n      } else {\n        addComponent(APP.world, HeldRemoteRight, spawnedEntity.eid);\n      }\n    }\n\n    // We skip this in the scene preview because\n    //   1. hubs-systems is not initialized in the scene preview\n    //   2. physics is not needed in the scene preview\n    if (this.el.sceneEl.systems[\"hubs-systems\"]) {\n      this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem.resetDynamicBody(\n        spawnedEntity.components[\"body-helper\"].uuid\n      );\n    }\n\n    spawnedEntity.addEventListener(\n      \"media-loaded\",\n      () => {\n        this.el.emit(\"spawned-entity-loaded\", { target: spawnedEntity });\n      },\n      { once: true }\n    );\n  },\n\n  activateCooldown() {\n    if (this.data.spawnCooldown > 0) {\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\n\n      this.el.setAttribute(\"visible\", false);\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.el.classList.remove(\"interactable\");\n      this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.NONE });\n      this.cooldownTimeout = setTimeout(() => {\n        this.el.setAttribute(\"visible\", true);\n        this.el.classList.add(\"interactable\");\n        this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\n          property: \"scale\",\n          delay: 50,\n          dur: 350,\n          from: { x: 0.001, y: 0.001, z: 0.001 },\n          to: { x: sx, y: sy, z: sz },\n          easing: \"easeOutElastic\"\n        });\n\n        setTimeout(() => {\n          this.cooldownTimeout = null;\n        }, 400);\n      }, this.data.spawnCooldown * 1000);\n    }\n  }\n});\n","import { Layers } from \"./layers\";\nimport \"../vendor/Water\";\nimport waterNormalMap from \"../assets/waternormals.jpg\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\n\n/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nfunction MobileWater(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: `\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    `,\n\n    fragmentShader: `\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk[\"common\"]}\n      ${THREE.ShaderChunk[\"packing\"]}\n      ${THREE.ShaderChunk[\"bsdfs\"]}\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: false,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n}\n\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\nMobileWater.prototype.constructor = THREE.Water;\n\nasync function loadWaterNormals(url) {\n  const texture = await new Promise((resolve, reject) => new HubsTextureLoader().load(url, resolve, undefined, reject));\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n  texture.needsUpdate = true;\n  return texture;\n}\n\nAFRAME.registerComponent(\"water\", {\n  schema: {\n    waterColor: { type: \"color\", default: \"#001e0f\" },\n    distortionScale: { type: \"number\", default: 3.7 },\n    sunColor: { type: \"color\", default: \"#ffffff\" },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 1 },\n    speed: { type: \"number\", default: 0.1 },\n    forceMobile: { type: \"boolean\", default: false }\n  },\n  init() {\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    const waterGeometry = waterMesh.geometry;\n\n    // Render THREE.Water shader instead of THREE.Mesh\n    waterMesh.visible = false;\n\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\n      const waterConfig = {\n        textureWidth: 512,\n        textureHeight: 512,\n        waterNormals: waterNormals,\n        sunDirection: this.data.sunDirection,\n        sunColor: new THREE.Color(this.data.sunColor),\n        waterColor: new THREE.Color(this.data.waterColor),\n        distortionScale: this.data.distortionScale,\n        fog: false\n      };\n\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\n        this.water = new MobileWater(waterGeometry, waterConfig);\n      } else {\n        this.water = new THREE.Water(waterGeometry, waterConfig);\n        this.water.mirrorCamera.layers.set(Layers.CAMERA_LAYER_REFLECTION);\n      }\n\n      this.el.setObject3D(\"water\", this.water);\n    });\n  },\n\n  update(oldData) {\n    if (this.data.forceMobile !== oldData.forceMobile) {\n      this.el.removeObject3D(\"water\");\n      this.init();\n      return;\n    }\n\n    if (!this.water) {\n      return;\n    }\n\n    const uniforms = this.water.material.uniforms;\n\n    if (this.data.waterColor !== oldData.waterColor) {\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\n    }\n\n    if (this.data.distortionScale !== oldData.distortionScale) {\n      uniforms.distortionScale.value = this.data.distortionScale;\n    }\n\n    if (this.data.sunColor !== oldData.sunColor) {\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunDirection.value.set(x, y, z);\n    }\n  },\n\n  tick(time) {\n    if (this.water) {\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"water\");\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    waterMesh.visible = true;\n  }\n});\n","import { SimplexNoise } from \"three/examples/jsm/math/SimplexNoise\";\nimport waterNormalsUrl from \"../assets/waternormals.jpg\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\n\nconst { Mesh, PlaneBufferGeometry, MeshStandardMaterial, MeshPhongMaterial, Vector2, RepeatWrapping } = THREE;\n\n/**\n * SimpleWater\n * Keep in sync with Spoke's SimpleWater class\n */\n\n/**\n * Adapted dynamic geometry code from: https://github.com/ditzel/UnityOceanWavesAndShip\n */\n\nclass Octave {\n  constructor(speed = new Vector2(1, 1), scale = new Vector2(1, 1), height = 0.0025, alternate = true) {\n    this.speed = speed;\n    this.scale = scale;\n    this.height = height;\n    this.alternate = alternate;\n  }\n}\nexport default class SimpleWater extends Mesh {\n  constructor(normalMap, resolution = 24, lowQuality = false) {\n    const geometry = new PlaneBufferGeometry(10, 10, resolution, resolution);\n    geometry.rotateX(-Math.PI / 2);\n\n    const waterUniforms = {\n      ripplesSpeed: { value: 0.25 },\n      ripplesScale: { value: 1 },\n      time: { value: 0 }\n    };\n\n    const materialClass = lowQuality ? MeshPhongMaterial : MeshStandardMaterial;\n\n    normalMap.wrapS = normalMap.wrapT = RepeatWrapping;\n\n    const material = new materialClass({ color: 0x0054df, normalMap, roughness: 0.5, metalness: 0.5 });\n    material.name = \"SimpleWaterMaterial\";\n\n    material.onBeforeCompile = shader => {\n      Object.assign(shader.uniforms, waterUniforms);\n\n      shader.vertexShader = shader.vertexShader.replace(\n        \"#include <fog_pars_vertex>\",\n        `\n        #include <fog_pars_vertex>\n        varying vec3 vWPosition;\n      `\n      );\n\n      shader.vertexShader = shader.vertexShader.replace(\n        \"#include <fog_vertex>\",\n        `\n        #include <fog_vertex>\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\n      `\n      );\n\n      // getNoise function from https://github.com/mrdoob/three.js/blob/dev/examples/jsm/objects/Water.js\n      shader.fragmentShader = shader.fragmentShader.replace(\n        \"#include <normalmap_pars_fragment>\",\n        `\n        #include <normalmap_pars_fragment>\n\n        uniform float time;\n        uniform float ripplesSpeed;\n        uniform float ripplesScale;\n      \n        varying vec3 vWPosition;\n      \n        vec4 getNoise(vec2 uv){\n          float timeOffset = time * ripplesSpeed;\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\n          vec4 noise = (texture2D(normalMap, uv0)) +\n                       (texture2D(normalMap, uv1)) +\n                       (texture2D(normalMap, uv2)) +\n                       (texture2D(normalMap, uv3));\n          return noise / 4.0;\n        }\n      `\n      );\n\n      // https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl.js#L20\n      shader.fragmentShader = shader.fragmentShader.replace(\n        \"#include <normal_fragment_maps>\",\n        `\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n          vec3 eye_pos = -vViewPosition;\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n          vec2 st0 = dFdx( vUv.st );\n          vec2 st1 = dFdy( vUv.st );\n\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n          vec3 N = normalize( normal );\n          mat3 tsn = mat3( S, T, N );\n\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\n\n          mapN.xy *= normalScale;\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n          normal = normalize( tsn * mapN );\n        `\n      );\n    };\n\n    super(geometry, material);\n\n    this.lowQuality = lowQuality;\n    this.waterUniforms = waterUniforms;\n\n    if (lowQuality) {\n      this.material.specular.set(0xffffff);\n    } else {\n      this.receiveShadow = true;\n    }\n\n    this.geometry.attributes.position.dynamic = true;\n\n    this.resolution = resolution;\n    this.octaves = [\n      new Octave(new Vector2(0.5, 0.5), new Vector2(1, 1), 0.01, true),\n      new Octave(new Vector2(0.05, 6), new Vector2(1, 20), 0.1, false)\n    ];\n\n    this.simplex = new SimplexNoise();\n  }\n\n  get opacity() {\n    return this.material.opacity;\n  }\n\n  set opacity(value) {\n    this.material.opacity = value;\n\n    if (value !== 1) {\n      this.material.transparent = true;\n    }\n  }\n\n  get color() {\n    return this.material.color;\n  }\n\n  get tideHeight() {\n    return this.octaves[0].height;\n  }\n\n  get tideScale() {\n    return this.octaves[0].scale;\n  }\n\n  get tideSpeed() {\n    return this.octaves[0].speed;\n  }\n\n  set tideHeight(value) {\n    this.octaves[0].height = value;\n  }\n\n  get waveHeight() {\n    return this.octaves[1].height;\n  }\n\n  set waveHeight(value) {\n    this.octaves[1].height = value;\n  }\n\n  get waveScale() {\n    return this.octaves[1].scale;\n  }\n\n  get waveSpeed() {\n    return this.octaves[1].speed;\n  }\n\n  set ripplesSpeed(value) {\n    this.waterUniforms.ripplesSpeed.value = value;\n  }\n\n  get ripplesSpeed() {\n    return this.waterUniforms.ripplesSpeed.value;\n  }\n\n  set ripplesScale(value) {\n    this.waterUniforms.ripplesScale.value = value;\n  }\n\n  get ripplesScale() {\n    return this.waterUniforms.ripplesScale.value;\n  }\n\n  update(time) {\n    const positionAttribute = this.geometry.attributes.position;\n\n    for (let x = 0; x <= this.resolution; x++) {\n      for (let z = 0; z <= this.resolution; z++) {\n        let y = 0;\n\n        for (let o = 0; o < this.octaves.length; o++) {\n          const octave = this.octaves[o];\n\n          if (octave.alternate) {\n            const noise = this.simplex.noise(\n              (x * octave.scale.x) / this.resolution,\n              (z * octave.scale.y) / this.resolution\n            );\n            y += Math.cos(noise + octave.speed.length() * time) * octave.height;\n          } else {\n            const noise =\n              this.simplex.noise(\n                (x * octave.scale.x + time * octave.speed.x) / this.resolution,\n                (z * octave.scale.y + time * octave.speed.y) / this.resolution\n              ) - 0.5;\n            y += noise * octave.height;\n          }\n        }\n\n        positionAttribute.setY(x * (this.resolution + 1) + z, y);\n      }\n    }\n\n    this.geometry.computeVertexNormals();\n    positionAttribute.needsUpdate = true;\n    this.waterUniforms.time.value = time;\n  }\n\n  clone(recursive) {\n    return new SimpleWater(this.material.normalMap, this.resolution, this.lowQuality).copy(this, recursive);\n  }\n\n  copy(source, recursive = true) {\n    super.copy(source, recursive);\n\n    this.opacity = source.opacity;\n    this.color.copy(source.color);\n    this.tideHeight = source.tideHeight;\n    this.tideScale.copy(source.tideScale);\n    this.tideSpeed.copy(source.tideSpeed);\n    this.waveHeight = source.waveHeight;\n    this.waveScale.copy(source.waveScale);\n    this.waveSpeed.copy(source.waveSpeed);\n    this.ripplesSpeed = source.ripplesSpeed;\n    this.ripplesScale = source.ripplesScale;\n\n    return this;\n  }\n}\n\nfunction vec2Equals(a, b) {\n  return a && b && a.x === b.x && a.y === b.y;\n}\n\nlet waterNormalMap = null;\n\nAFRAME.registerComponent(\"simple-water\", {\n  schema: {\n    opacity: { type: \"number\", default: 1 },\n    color: { type: \"color\" },\n    tideHeight: { type: \"number\", default: 0.01 },\n    tideScale: { type: \"vec2\", default: { x: 1, y: 1 } },\n    tideSpeed: { type: \"vec2\", default: { x: 0.5, y: 0.5 } },\n    waveHeight: { type: \"number\", default: 0.1 },\n    waveScale: { type: \"vec2\", default: { x: 1, y: 20 } },\n    waveSpeed: { type: \"vec2\", default: { x: 0.05, y: 6 } },\n    ripplesScale: { type: \"number\", default: 1 },\n    ripplesSpeed: { type: \"number\", default: 0.25 }\n  },\n\n  init() {\n    if (!waterNormalMap) {\n      waterNormalMap = new HubsTextureLoader().load(waterNormalsUrl);\n    }\n\n    const usePhongShader = window.APP.store.state.preferences.materialQualitySetting !== \"high\";\n    this.water = new SimpleWater(waterNormalMap, undefined, usePhongShader);\n    this.el.setObject3D(\"mesh\", this.water);\n  },\n\n  update(oldData) {\n    if (this.data.opacity !== oldData.opacity) {\n      this.water.opacity = this.data.opacity;\n    }\n\n    if (this.data.color !== oldData.color) {\n      this.water.color.set(this.data.color);\n    }\n\n    if (this.data.tideHeight !== oldData.tideHeight) {\n      this.water.tideHeight = this.data.tideHeight;\n    }\n\n    if (!vec2Equals(this.data.tideScale, oldData.tideScale)) {\n      this.water.tideScale.copy(this.data.tideScale);\n    }\n\n    if (!vec2Equals(this.data.tideSpeed, oldData.tideSpeed)) {\n      this.water.tideSpeed.copy(this.data.tideSpeed);\n    }\n\n    if (this.data.waveHeight !== oldData.waveHeight) {\n      this.water.waveHeight = this.data.waveHeight;\n    }\n\n    if (!vec2Equals(this.data.waveScale, oldData.waveScale)) {\n      this.water.waveScale.copy(this.data.waveScale);\n    }\n\n    if (!vec2Equals(this.data.waveSpeed, oldData.waveSpeed)) {\n      this.water.waveSpeed.copy(this.data.waveSpeed);\n    }\n\n    if (this.data.ripplesScale !== oldData.ripplesScale) {\n      this.water.ripplesScale = this.data.ripplesScale;\n    }\n\n    if (this.data.ripplesSpeed !== oldData.ripplesSpeed) {\n      this.water.ripplesSpeed = this.data.ripplesSpeed;\n    }\n  },\n\n  tick(time) {\n    this.water.update(time / 1000);\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","import { ParticleEmitter } from \"lib-hubs/packages/three-particle-emitter/lib/esm/index\";\nimport { textureLoader } from \"../utils/media-utils\";\nimport { resolveUrl } from \"../utils/media-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport defaultSrcImage from \"../assets/images/warning_icon.png\";\n\nconst defaultSrcUrl = new URL(defaultSrcImage, window.location.href).href;\n\nAFRAME.registerComponent(\"particle-emitter\", {\n  schema: {\n    resolve: { type: \"boolean\", default: true },\n    src: { type: \"string\", default: defaultSrcUrl },\n    startColor: { type: \"color\" },\n    middleColor: { type: \"color\" },\n    endColor: { type: \"color\" },\n    startOpacity: { type: \"number\", default: 1 },\n    middleOpacity: { type: \"number\", default: 1 },\n    endOpacity: { type: \"number\", default: 1 },\n    colorCurve: { type: \"string\", default: \"linear\" },\n    sizeCurve: { type: \"string\", default: \"linear\" },\n    startSize: { type: \"number\", default: 1 },\n    endSize: { type: \"number\", default: 1 },\n    sizeRandomness: { type: \"number\" },\n    ageRandomness: { type: \"number\" },\n    lifetime: { type: \"number\", default: 1 },\n    lifetimeRandomness: { type: \"number\" },\n    particleCount: { type: \"number\", default: 10 },\n    startVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\n    endVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\n    velocityCurve: { type: \"string\", default: \"linear\" },\n    angularVelocity: { type: \"number\" }\n  },\n\n  init() {\n    this.particleEmitter = new ParticleEmitter(null);\n    this.particleEmitter.visible = false;\n    this.el.setObject3D(\"particle-emitter\", this.particleEmitter);\n    this.updateParticles = false;\n    if (this.data.src === defaultSrcUrl) {\n      this.data.resolve = false;\n    }\n  },\n\n  async setTexture(src, resolve) {\n    let accessibleUrl = src;\n\n    if (resolve) {\n      const result = await resolveUrl(src);\n      let canonicalUrl = result.origin;\n\n      // handle protocol relative urls\n      if (canonicalUrl.startsWith(\"//\")) {\n        canonicalUrl = location.protocol + canonicalUrl;\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\n    }\n\n    const texture = await textureLoader.loadAsync(accessibleUrl);\n\n    // Guard against src changing while request was in flight\n    if (this.data.src !== src) {\n      return;\n    }\n\n    this.particleEmitter.material.uniforms.map.value = texture;\n    this.particleEmitter.visible = true;\n    this.updateParticles = true;\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const particleEmitter = this.particleEmitter;\n\n    if (prevData.src !== data.src) {\n      this.setTexture(data.src, data.resolve).catch(console.error);\n    }\n\n    if (\n      prevData.startColor !== data.startColor ||\n      prevData.startSize !== data.startSize ||\n      prevData.sizeRandomness !== data.sizeRandomness ||\n      prevData.ageRandomness !== data.ageRandomness ||\n      prevData.lifetime !== data.lifetime ||\n      prevData.lifetimeRandomness !== data.lifetimeRandomness ||\n      prevData.particleCount !== data.particleCount\n    ) {\n      this.updateParticles = true;\n    }\n\n    particleEmitter.startColor.set(data.startColor);\n    particleEmitter.middleColor.set(data.middleColor);\n    particleEmitter.endColor.set(data.endColor);\n    particleEmitter.startOpacity = data.startOpacity;\n    particleEmitter.middleOpacity = data.middleOpacity;\n    particleEmitter.endOpacity = data.endOpacity;\n    particleEmitter.colorCurve = data.colorCurve;\n    particleEmitter.sizeCurve = data.sizeCurve;\n    particleEmitter.startSize = data.startSize;\n    particleEmitter.endSize = data.endSize;\n    particleEmitter.sizeRandomness = data.sizeRandomness;\n    particleEmitter.ageRandomness = data.ageRandomness;\n    particleEmitter.lifetime = data.lifetime;\n    particleEmitter.lifetimeRandomness = data.lifetimeRandomness;\n    particleEmitter.particleCount = data.particleCount;\n    particleEmitter.startVelocity.copy(data.startVelocity);\n    particleEmitter.endVelocity.copy(data.endVelocity);\n    particleEmitter.velocityCurve = data.velocityCurve;\n    particleEmitter.angularVelocity = data.angularVelocity;\n  },\n\n  tick(time, dt) {\n    if (this.updateParticles) {\n      this.particleEmitter.updateParticles();\n      this.updateParticles = false;\n    }\n\n    if (this.particleEmitter.visible) {\n      this.particleEmitter.update(dt / 1000);\n    }\n  }\n});\n","import { updateAudioSettings } from \"../update-audio-settings\";\n\nAFRAME.registerComponent(\"audio-zone-source\", {\n  init() {\n    this.originalAudioParamsData = null;\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.registerSource(this);\n  },\n\n  remove() {\n    APP.zoneOverrides.delete(this.el);\n    this.el.sceneEl.systems[\"hubs-systems\"]?.audioZonesSystem.unregisterSource(this);\n  },\n\n  getPosition: (() => {\n    const sourcePos = new THREE.Vector3();\n    return function () {\n      const audio = APP.audios.get(this.el);\n      if (audio) {\n        audio.getWorldPosition(sourcePos);\n      } else {\n        sourcePos.set(0, 0, 0);\n      }\n      return sourcePos;\n    };\n  })(),\n\n  apply(params) {\n    APP.zoneOverrides.set(this.el, params);\n    const audio = APP.audios.get(this.el);\n    if (audio) {\n      updateAudioSettings(this.el, audio);\n    }\n  },\n\n  restore() {\n    APP.zoneOverrides.delete(this.el);\n    const audio = APP.audios.get(this.el);\n    if (audio) {\n      updateAudioSettings(this.el, audio);\n    }\n  }\n});\n","// This is based largely on: @lojjic https://github.com/lojjic/aframe-troika-text/blob/master/src/aframe-troika-text-component.js\n// but has been made functional and restyled for Mozilla Hubs (hubs.mozilla.com)\n// by @jamesckane at Paradowski Creative (paradowski.com)\n\nimport { Text } from \"troika-three-text\";\n\n// Mark this type of object so we can filter in from our shader patching\nText.prototype.isTroikaText = true;\n\nconst THREE_SIDES = {\n  front: THREE.FrontSide,\n  back: THREE.BackSide,\n  double: THREE.DoubleSide\n};\n\nfunction numberOrPercent(defaultValue) {\n  return {\n    default: defaultValue,\n    parse: function(value) {\n      if (typeof value === \"string\" && value.indexOf(\"%\") > 0) {\n        return value;\n      }\n      value = +value;\n      return isNaN(value) ? 0 : value;\n    },\n    stringify: function(value) {\n      return \"\" + value;\n    }\n  };\n}\n\nAFRAME.registerComponent(\"text\", {\n  schema: {\n    textAlign: { type: \"string\", default: \"left\", oneOf: [\"left\", \"right\", \"center\", \"justify\"] },\n    anchorX: { default: \"center\", oneOf: [\"left\", \"right\", \"center\"] },\n    anchorY: { default: \"middle\", oneOf: [\"top\", \"top-baseline\", \"middle\", \"bottom-baseline\", \"bottom\"] },\n    clipRect: {\n      type: \"string\",\n      default: \"\",\n      parse: function(value) {\n        if (value) {\n          value = value.split(/[\\s,]+/).reduce(function(out, val) {\n            val = +val;\n            if (!isNaN(val)) {\n              out.push(val);\n            }\n            return out;\n          }, []);\n        }\n        return value && value.length === 4 ? value : null;\n      },\n      stringify: function(value) {\n        return value ? value.join(\" \") : \"\";\n      }\n    },\n    color: { type: \"color\", default: \"#FFF\" },\n    curveRadius: { type: \"number\", default: 0 },\n    depthOffset: { type: \"number\", default: 0 },\n    direction: { type: \"string\", default: \"auto\", oneOf: [\"auto\", \"ltr\", \"rtl\"] },\n    fillOpacity: { type: \"number\", default: 1 },\n    fontUrl: {type:\"string\"},\n    // This is different from the Troika preoperty name, Using \"fontUrl\" to prevent conflict with previous \"font\" property and to allow us to make named fonts later\n    // fontUrl: { \n    //   type: \"string\",\n    //   default : \"https://cdn.jsdelivr.net/gh/spoqa/spoqa-han-sans@latest/Subset/SpoqaHanSansNeo/SpoqaHanSansNeo-Regular.woff\"\n    // },\n    // This default value differs from the Troika default of 0.1, it most closely matches the size of our previous text component.\n    fontSize: { type: \"number\", default: 0.075 },\n    letterSpacing: { type: \"number\", default: 0 },\n    lineHeight: { type: \"number\" },\n    maxWidth: { type: \"number\", default: Infinity },\n    outlineBlur: numberOrPercent(0),\n    outlineColor: { type: \"color\", default: \"#000\" },\n    outlineOffsetX: numberOrPercent(0),\n    outlineOffsetY: numberOrPercent(0),\n    outlineOpacity: { type: \"number\", default: 1 },\n    outlineWidth: numberOrPercent(0),\n    overflowWrap: { type: \"string\", default: \"normal\", oneOf: [\"normal\", \"break-word\"] },\n    strokeColor: { type: \"color\", default: \"grey\" },\n    strokeOpacity: { type: \"number\", default: 1 },\n    strokeWidth: numberOrPercent(0),\n    // Note this is different than the Troika property name, Using \"value\" instead of \"text\" here to prevent code changes.\n    value: { type: \"string\", default: \"\" },\n    textIndent: { type: \"number\", default: 0 },\n    whiteSpace: { default: \"normal\", oneOf: [\"normal\", \"nowrap\"] },\n    opacity: { type: \"number\", default: 1.0 },\n    side: { default: \"front\", oneOf: [\"front\", \"back\", \"double\"] }\n  },\n\n  /**\n   * Called once when component is attached for initial setup.\n   */\n  init: function() {\n    this.troikaTextMesh = new Text();\n    this.troikaTextMesh.material.toneMapped = false;\n    this.el.setObject3D(\"text\", this.troikaTextMesh);\n  },\n\n  /**\n   * Called when component is attached and when component data changes.\n   * Generally modifies the entity based on the data.\n   */\n  update: function() {\n    const data = this.data;\n    const mesh = this.troikaTextMesh;\n\n    // Update the text mesh\n    mesh.text = data.value || \"\";\n    mesh.textAlign = data.textAlign;\n    mesh.anchorX = data.anchorX;\n    mesh.anchorY = data.anchorY;\n    mesh.color = data.color;\n    mesh.material.side = THREE_SIDES[data.side];\n    mesh.material.opacity = data.opacity;\n    mesh.curveRadius = data.curveRadius;\n    mesh.depthOffset = data.depthOffset || 0;\n    mesh.direction = data.direction;\n    mesh.fillOpacity = data.fillOpacity;\n    mesh.font = data.fontUrl;\n    mesh.fontSize = data.fontSize;\n    mesh.letterSpacing = data.letterSpacing || 0;\n    mesh.clipRect = data.clipRect;\n    mesh.lineHeight = data.lineHeight || \"normal\";\n    mesh.outlineBlur = data.outlineBlur;\n    mesh.outlineColor = data.outlineColor;\n    mesh.outlineOffsetX = data.outlineOffsetX;\n    mesh.outlineOffsetY = data.outlineOffsetY;\n    mesh.outlineOpacity = data.outlineOpacity;\n    mesh.outlineWidth = data.outlineWidth;\n    mesh.overflowWrap = data.overflowWrap;\n    mesh.strokeColor = data.strokeColor;\n    mesh.strokeOpacity = data.strokeOpacity;\n    mesh.strokeWidth = data.strokeWidth;\n    mesh.textIndent = data.textIndent;\n    mesh.whiteSpace = data.whiteSpace;\n    mesh.maxWidth = data.maxWidth;\n    mesh.sync(() => {\n      this.el.emit(\"text-updated\", this);\n    });\n  },\n\n  /**\n   * Called when a component is removed (e.g., via removeAttribute).\n   * Generally undoes all modifications to the entity.\n   */\n  remove: function() {\n    // Free memory\n    this.troikaTextMesh.dispose();\n  },\n\n  getSize: (function() {\n    const size = new THREE.Vector3();\n    return function(outSize) {\n      this.troikaTextMesh.geometry.boundingBox.getSize(size);\n      outSize.set(\n        size.x * this.troikaTextMesh.scale.x,\n        size.y * this.troikaTextMesh.scale.y,\n        size.z * this.troikaTextMesh.scale.z\n      );\n    };\n  })()\n});\n","import { SOUND_TOGGLE_MIC } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles the microphone on the current network connection based on the given events.\n * @namespace network\n * @component mute-mic\n */\nAFRAME.registerComponent(\"mute-mic\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    muteEvents: { type: \"array\" },\n    unmuteEvents: { type: \"array\" }\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    this.onMute = this.onMute.bind(this);\n    this.onUnmute = this.onUnmute.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    bindAllEvents(eventSrc, muteEvents, this.onMute);\n    bindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    unbindAllEvents(eventSrc, muteEvents, this.onMute);\n    unbindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  onToggle: function() {\n    APP.mediaDevicesManager.toggleMic();\n    if (!this.el.sceneEl.is(\"entered\")) return;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n  },\n\n  onMute: function() {\n    APP.mediaDevicesManager.micEnabled = false;\n  },\n\n  onUnmute: function() {\n    APP.mediaDevicesManager.micEnabled = true;\n  }\n});\n","/**\n * Scales an object to near-zero if the object is invisible. Useful for bones representing avatar body parts.\n * @namespace avatar\n * @component bone-visibility\n */\n\nconst HIDDEN_SCALE = 0.00000001;\n\nconst components = [];\nexport class BoneVisibilitySystem {\n  tick() {\n    for (let i = 0; i < components.length; i++) {\n      const cmp = components[i];\n      const obj = cmp.el.object3D;\n      const { visible, scale } = obj;\n      const { updateWhileInvisible } = cmp.data;\n      if (visible !== cmp.lastVisible || updateWhileInvisible) {\n        if (visible && (scale.x !== 1 || scale.y !== 1 || scale.z !== 1)) {\n          scale.setScalar(1);\n          obj.matrixNeedsUpdate = true;\n        } else if (!visible && (scale.x !== HIDDEN_SCALE || scale.y !== HIDDEN_SCALE || scale.z !== HIDDEN_SCALE)) {\n          scale.setScalar(HIDDEN_SCALE);\n          obj.matrixNeedsUpdate = true;\n        }\n\n        // Normally this object being invisible would cause it not to get updated even though the matrixNeedsUpdate flag is set, force it\n        if (updateWhileInvisible && obj.matrixNeedsUpdate) {\n          obj.updateMatrixWorld(true, true);\n        }\n      }\n      cmp.lastVisible = visible;\n    }\n  }\n\n  // Called only from camera-tool.tock() to update the matrices\n  // of objects and their children whose are updated in tick().\n  updateMatrices() {\n    for (let i = 0; i < components.length; i++) {\n      const cmp = components[i];\n      const obj = cmp.el.object3D;\n      if (obj.matrixNeedsUpdate) {\n        obj.updateMatrixWorld();\n      }\n    }\n  }\n}\n\nAFRAME.registerComponent(\"bone-visibility\", {\n  schema: {\n    updateWhileInvisible: { type: \"boolean\", default: false }\n  },\n  play() {\n    components.push(this);\n  },\n  pause() {\n    components.splice(components.indexOf(this), 1);\n  }\n});\n","import { SOUND_SPAWN_PEN } from \"../systems/sound-effects-system\";\n/**\n * HUD panel for muting, freezing, and other controls that don't necessarily have hardware buttons.\n * @namespace ui\n * @component in-world-hud\n */\nAFRAME.registerComponent(\"in-world-hud\", {\n  init() {\n    this.mic = this.el.querySelector(\".mic\");\n    this.spawn = this.el.querySelector(\".spawn\");\n    this.pen = this.el.querySelector(\".penhud\");\n    this.cameraBtn = this.el.querySelector(\".camera-btn\");\n    this.inviteBtn = this.el.querySelector(\".invite-btn\");\n    this.background = this.el.querySelector(\".bg\");\n\n    this.onMicStateChanged = () => {\n      this.mic.setAttribute(\"mic-button\", \"active\", APP.dialog.isMicEnabled);\n    };\n    APP.dialog.on(\"mic-state-changed\", this.onMicStateChanged);\n\n    this.updateButtonStates = () => {\n      this.mic.setAttribute(\"mic-button\", \"active\", APP.dialog.isMicEnabled);\n      this.pen.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"pen\"));\n      this.cameraBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"camera\"));\n      if (window.APP.hubChannel) {\n        this.spawn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_and_move_media\"));\n        this.pen.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_drawing\"));\n        this.cameraBtn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_camera\"));\n      }\n    };\n\n    this.onStateChange = evt => {\n      if (!(evt.detail === \"frozen\" || evt.detail === \"pen\" || evt.detail === \"camera\")) return;\n      this.updateButtonStates();\n    };\n\n    this.onMicClick = () => {\n      APP.mediaDevicesManager.toggleMic();\n    };\n\n    this.onSpawnClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_and_move_media\")) return;\n      this.el.emit(\"action_spawn\");\n    };\n\n    this.onPenClick = e => {\n      if (!window.APP.hubChannel.can(\"spawn_drawing\")) return;\n      this.el.emit(\"spawn_pen\", { object3D: e.object3D });\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPAWN_PEN);\n    };\n\n    this.onCameraClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_camera\")) return;\n      this.el.emit(\"action_toggle_camera\");\n    };\n\n    this.onInviteClick = () => {\n      this.el.emit(\"action_invite\");\n    };\n\n    this.onHubUpdated = e => {\n      this.inviteBtn.object3D.visible = e.detail.hub.entry_mode !== \"invite\";\n    };\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updateButtonStates);\n    this.el.sceneEl.addEventListener(\"hub_updated\", this.onHubUpdated);\n    this.updateButtonStates();\n\n    this.mic.object3D.addEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.addEventListener(\"interact\", this.onSpawnClick);\n    this.pen.object3D.addEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.addEventListener(\"interact\", this.onCameraClick);\n    this.inviteBtn.object3D.addEventListener(\"interact\", this.onInviteClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateButtonStates);\n    this.el.sceneEl.removeEventListener(\"hub_updated\", this.onHubUpdated);\n\n    this.mic.object3D.removeEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.removeEventListener(\"interact\", this.onSpawnClick);\n    this.pen.object3D.removeEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.removeEventListener(\"interact\", this.onCameraClick);\n    this.inviteBtn.object3D.removeEventListener(\"interact\", this.onInviteClick);\n  }\n});\n","/* global performance */\nimport { addMedia } from \"../utils/media-utils\";\nimport { SOUND_SPAWN_EMOJI } from \"../systems/sound-effects-system\";\nimport emoji0Particle from \"../assets/images/emojis/emoji_0.png\";\nimport emoji1Particle from \"../assets/images/emojis/emoji_1.png\";\nimport emoji2Particle from \"../assets/images/emojis/emoji_2.png\";\nimport emoji3Particle from \"../assets/images/emojis/emoji_3.png\";\nimport emoji4Particle from \"../assets/images/emojis/emoji_4.png\";\nimport emoji5Particle from \"../assets/images/emojis/emoji_5.png\";\nimport emoji6Particle from \"../assets/images/emojis/emoji_6.png\";\nimport emoji0Model from \"../assets/models/emojis/emoji_0.glb\";\nimport emoji1Model from \"../assets/models/emojis/emoji_1.glb\";\nimport emoji2Model from \"../assets/models/emojis/emoji_2.glb\";\nimport emoji3Model from \"../assets/models/emojis/emoji_3.glb\";\nimport emoji4Model from \"../assets/models/emojis/emoji_4.glb\";\nimport emoji5Model from \"../assets/models/emojis/emoji_5.glb\";\nimport emoji6Model from \"../assets/models/emojis/emoji_6.glb\";\n\nexport const emojis = [\n  { id: \"smile\", model: emoji0Model, particle: emoji0Particle },\n  { id: \"laugh\", model: emoji1Model, particle: emoji1Particle },\n  { id: \"clap\", model: emoji2Model, particle: emoji2Particle },\n  { id: \"heart\", model: emoji3Model, particle: emoji3Particle },\n  { id: \"wave\", model: emoji4Model, particle: emoji4Particle },\n  { id: \"angry\", model: emoji5Model, particle: emoji5Particle },\n  { id: \"cry\", model: emoji6Model, particle: emoji6Particle }\n].map(({ model, particle, ...rest }) => {\n  return {\n    ...rest,\n    model: new URL(model, window.location).href,\n    particleEmitterConfig: {\n      src: new URL(particle, window.location).href,\n      resolve: false,\n      particleCount: 20,\n      startSize: 0.01,\n      endSize: 0.2,\n      sizeRandomness: 0.05,\n      lifetime: 1,\n      lifetimeRandomness: 0.2,\n      ageRandomness: 1,\n      startVelocity: { x: 0, y: 1, z: 0 },\n      endVelocity: { x: 0, y: 0.25, z: 0 },\n      startOpacity: 1,\n      middleOpacity: 1,\n      endOpacity: 0\n    }\n  };\n});\n\nexport function spawnEmojiInFrontOfUser({ model, particleEmitterConfig }) {\n  const { entity } = addMedia(model, \"#interactable-emoji\");\n  entity.setAttribute(\"offset-relative-to\", {\n    target: \"#avatar-pov-node\",\n    offset: { x: 0, y: 0, z: -1.5 }\n  });\n  entity.addEventListener(\"model-loaded\", () => {\n    entity.querySelector(\".particle-emitter\").setAttribute(\"particle-emitter\", particleEmitterConfig);\n    entity.setAttribute(\"emoji\", { particleEmitterConfig: particleEmitterConfig });\n  });\n}\n\nAFRAME.registerComponent(\"emoji\", {\n  schema: {\n    emitDecayTime: { default: 1.5 },\n    emitFadeTime: { default: 0.5 },\n    emitEndTime: { default: 0 },\n    particleEmitterConfig: {\n      default: null,\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.data.emitEndTime = performance.now() + this.data.emitDecayTime * 1000;\n    this.physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n  },\n\n  play() {\n    const mediaLoader = this.el.components[\"media-loader\"];\n    if (emojis.find(emoji => emoji.model !== mediaLoader.data.src) === -1) {\n      this.el.parentNode.removeChild(this.el);\n      return;\n    }\n\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\n      SOUND_SPAWN_EMOJI,\n      this.el.object3D\n    );\n    this.particleEmitter = this.el.querySelector(\".particle-emitter\");\n  },\n\n  update() {\n    if (!this.particleConfig && this.data.particleEmitterConfig) {\n      this.particleConfig = Object.assign({}, this.data.particleEmitterConfig);\n      this.originalParticleCount = this.particleConfig.particleCount;\n    }\n  },\n\n  tick() {\n    const isMine = this.el.components.networked.initialized && this.el.components.networked.isMine();\n\n    if (this.particleConfig && isMine) {\n      const now = performance.now();\n\n      const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n\n      if (isHeld) {\n        this.data.emitEndTime = now + this.data.emitDecayTime * 1000;\n      }\n\n      const emitFadeTime = this.data.emitFadeTime * 1000;\n\n      if (now < this.data.emitEndTime && this.particleConfig.startOpacity < 1) {\n        this.particleConfig.particleCount = this.originalParticleCount;\n        this.particleConfig.startOpacity = 1;\n        this.particleConfig.middleOpacity = 1;\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\n      } else if (now >= this.data.emitEndTime && this.particleConfig.startOpacity > 0.001) {\n        const timeSinceStop = Math.min(now - this.data.emitEndTime, emitFadeTime);\n        const opacity = 1 - timeSinceStop / emitFadeTime;\n        const particleCount = opacity < 0.001 && this.particleConfig.particleCount > 0 ? 0 : this.originalParticleCount;\n        this.particleConfig.particleCount = particleCount;\n        this.particleConfig.startOpacity = opacity;\n        this.particleConfig.middleOpacity = opacity;\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\n      }\n    }\n  }\n});\n","import { addComponent, removeComponent } from \"bitecs\";\nimport { TYPE } from \"three-ammo/constants\";\nimport { HandCollisionTarget } from \"../bit-components\";\nimport { emojis } from \"./emoji\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nfunction setOffsetVector(i, totalNumEmojis, width, spacing, offsetVector) {\n  const sign = i & 1 ? -1 : 1;\n  offsetVector.y = 0;\n  if (totalNumEmojis % 2 === 0) {\n    offsetVector.x = (spacing / 2 + width / 2 + Math.floor(i / 2) * (width + spacing)) * sign;\n    offsetVector.z = (Math.floor(i / 2) * width) / 2;\n  } else if (i !== 0) {\n    offsetVector.x = (width + spacing) * Math.floor((i + 1) / 2) * -sign;\n    offsetVector.z = (Math.floor((i + 1) / 2) * width) / 2;\n  }\n}\n\nAFRAME.registerComponent(\"emoji-hud\", {\n  schema: {\n    spawnerScale: { default: 0.1 },\n    spawnedScale: { default: 0.5 },\n    camera: { type: \"selector\", default: \"#avatar-pov-node\" },\n    hudAngle: { default: -0.5 },\n    minHudAngle: { default: -0.2 },\n    maxHudAngle: { default: 0.7 },\n    hudDistance: { default: 0.4 },\n    spawnerPlatformWidth: { default: 0.0625 },\n    spawnerPlatformSpacing: { default: 0.021 }\n  },\n\n  init: (() => {\n    const cameraWorldPosition = new THREE.Vector3();\n    const offsetVector = new THREE.Vector3();\n    return function() {\n      this._onFrozen = this._onFrozen.bind(this);\n      this._onThaw = this._onThaw.bind(this);\n\n      const width = this.data.spawnerPlatformWidth;\n      const spacing = this.data.spawnerPlatformSpacing;\n\n      this.spawnerEntities = [];\n\n      for (let i = 0; i < emojis.length; i++) {\n        const spawnerEntity = document.createElement(\"a-entity\");\n        spawnerEntity.setAttribute(\"media-loader\", { src: emojis[i].model });\n        spawnerEntity.setAttribute(\"hoverable-visuals\", \"\");\n        spawnerEntity.setAttribute(\"scale\", {\n          x: this.data.spawnerScale,\n          y: this.data.spawnerScale,\n          z: this.data.spawnerScale\n        });\n        spawnerEntity.setAttribute(\"is-remote-hover-target\", \"\");\n        spawnerEntity.setAttribute(\"tags\", { isHandCollisionTarget: false });\n        spawnerEntity.setAttribute(\"visibility-while-frozen\", {\n          requireHoverOnNonMobile: false,\n          withPermission: \"spawn_emoji\"\n        });\n        spawnerEntity.setAttribute(\"css-class\", \"interactable\");\n        spawnerEntity.setAttribute(\"body-helper\", {\n          mass: 0,\n          type: TYPE.STATIC,\n          collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n        });\n\n        spawnerEntity.addEventListener(\"spawned-entity-created\", e => {\n          if (this.el.sceneEl.is(\"vr-mode\")) {\n            return;\n          }\n          const object3D = e.detail.target.object3D;\n          const cameraObject3D = this.data.camera.object3D;\n          object3D.updateMatrices();\n          cameraObject3D.getWorldPosition(cameraWorldPosition);\n          object3D.lookAt(cameraWorldPosition.x, object3D.position.y, cameraWorldPosition.z);\n          object3D.matrixNeedsUpdate = true;\n        });\n\n        spawnerEntity.addEventListener(\"spawned-entity-loaded\", e => {\n          const particleEmitterConfig = emojis[i].particleEmitterConfig;\n          e.detail.target.querySelector(\".particle-emitter\").setAttribute(\"particle-emitter\", particleEmitterConfig);\n          e.detail.target.setAttribute(\"emoji\", { particleEmitterConfig: particleEmitterConfig });\n        });\n\n        spawnerEntity.setAttribute(\"super-spawner\", {\n          src: emojis[i].model,\n          template: \"#interactable-emoji\",\n          spawnScale: { x: this.data.spawnedScale, y: this.data.spawnedScale, z: this.data.spawnedScale }\n        });\n\n        setOffsetVector(i, emojis.length, width, spacing, offsetVector);\n\n        spawnerEntity.object3D.position.copy(offsetVector);\n        spawnerEntity.object3D.matrixNeedsUpdate = true;\n\n        this.el.appendChild(spawnerEntity);\n\n        this.spawnerEntities.push(spawnerEntity);\n      }\n    };\n  })(),\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this._onFrozen);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._onThaw);\n    this._updateOffset();\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._onFrozen);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._onThaw);\n  },\n\n  _onFrozen(e) {\n    if (e.detail === \"frozen\") {\n      this._updateOffset();\n      for (let i = 0; i < this.spawnerEntities.length; i++) {\n        addComponent(APP.world, HandCollisionTarget, this.spawnerEntities[i].eid);\n      }\n    }\n  },\n\n  _onThaw(e) {\n    if (e.detail === \"frozen\") {\n      for (let i = 0; i < this.spawnerEntities.length; i++) {\n        removeComponent(APP.world, HandCollisionTarget, this.spawnerEntities[i].eid);\n      }\n    }\n  },\n\n  _updateOffset: (function() {\n    const targetWorldPos = new THREE.Vector3();\n    const cameraForward = new THREE.Vector3();\n    const projectedCameraForward = new THREE.Vector3();\n    const angledCameraForward = new THREE.Vector3();\n    const defaultRight = new THREE.Vector3(1, 0, 0);\n    return function() {\n      const obj = this.el.object3D;\n      const cameraObject3D = this.data.camera.object3D;\n      cameraObject3D.updateMatrices();\n      cameraForward.set(0, 0, -1);\n      cameraForward.transformDirection(cameraObject3D.matrixWorld);\n      projectedCameraForward.set(0, 0, -1);\n      projectedCameraForward.transformDirection(cameraObject3D.matrixWorld);\n      projectedCameraForward.projectOnPlane(THREE.Object3D.DefaultUp).normalize();\n      const angle =\n        Math.sign(THREE.Object3D.DefaultUp.dot(cameraForward)) * projectedCameraForward.angleTo(cameraForward);\n      const angleOffset = angle - Math.max(this.data.minHudAngle, Math.min(this.data.maxHudAngle, angle));\n      angledCameraForward.set(0, 0, -1);\n      angledCameraForward.applyAxisAngle(defaultRight, this.data.hudAngle - angleOffset);\n      angledCameraForward.multiplyScalar(this.data.hudDistance);\n      cameraObject3D.localToWorld(angledCameraForward);\n      obj.parent.worldToLocal(angledCameraForward);\n      obj.position.copy(angledCameraForward);\n      obj.updateMatrices(true);\n      cameraObject3D.getWorldPosition(targetWorldPos);\n      obj.lookAt(targetWorldPos);\n      obj.matrixNeedsUpdate = true;\n    };\n  })()\n});\n","// extracted by mini-css-extract-plugin\nexport default {\"touchZone\":\"virtual-gamepad-controls__touchZone__s5d9p\",\"left\":\"virtual-gamepad-controls__left__SOA3B\",\"right\":\"virtual-gamepad-controls__right__CheCZ\",\"mockJoystickContainer\":\"virtual-gamepad-controls__mockJoystickContainer__KBQOm\",\"mockJoystick\":\"virtual-gamepad-controls__mockJoystick__uIAar\",\"hidden\":\"virtual-gamepad-controls__hidden__kFvSs\",\"inner\":\"virtual-gamepad-controls__inner__B2zxf\"};","import nipplejs from \"nipplejs\";\nimport styles from \"./virtual-gamepad-controls.css\";\n\nfunction insertAfter(el, referenceEl) {\n  referenceEl.parentNode.insertBefore(el, referenceEl.nextSibling);\n}\n\nconst ROTATION_SPEED = 0.025;\n\n/**\n * Instantiates 2D virtual gamepads and emits associated events.\n * @namespace user-input\n * @component virtual-gamepad-controls\n */\nAFRAME.registerComponent(\"virtual-gamepad-controls\", {\n  schema: {},\n\n  init() {\n    this.characterController = this.el.sceneEl.systems[\"hubs-systems\"].characterController;\n\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n    this.onFirstInteraction = this.onFirstInteraction.bind(this);\n    this.onMoveJoystickChanged = this.onMoveJoystickChanged.bind(this);\n    this.onMoveJoystickEnd = this.onMoveJoystickEnd.bind(this);\n    this.onLookJoystickChanged = this.onLookJoystickChanged.bind(this);\n    this.onLookJoystickEnd = this.onLookJoystickEnd.bind(this);\n\n    this.mockJoystickContainer = document.createElement(\"div\");\n    this.mockJoystickContainer.classList.add(styles.mockJoystickContainer);\n    this.leftMock = document.createElement(\"div\");\n    this.leftMock.classList.add(styles.mockJoystick);\n    this.leftMockSmall = document.createElement(\"div\");\n    this.leftMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    this.leftMock.appendChild(this.leftMockSmall);\n    this.mockJoystickContainer.appendChild(this.leftMock);\n    this.rightMock = document.createElement(\"div\");\n    this.rightMock.classList.add(styles.mockJoystick);\n    this.rightMockSmall = document.createElement(\"div\");\n    this.rightMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    this.rightMock.appendChild(this.rightMockSmall);\n    this.mockJoystickContainer.appendChild(this.rightMock);\n\n    this.enableLeft = window.APP.store.state.preferences.enableOnScreenJoystickLeft;\n    this.enableRight = window.APP.store.state.preferences.enableOnScreenJoystickRight;\n    if (this.enableLeft || this.enableRight) {\n      // Add the joystick container after the canvas element but before the rest of the UI.\n      insertAfter(this.mockJoystickContainer, this.el.sceneEl.canvas);\n    }\n    if (this.enableLeft) {\n      this.createLeftStick();\n    } else {\n      this.leftMock.classList.add(styles.hidden);\n      this.leftMockSmall.classList.add(styles.hidden);\n    }\n    if (this.enableRight) {\n      this.createRightStick();\n    } else {\n      this.rightMock.classList.add(styles.hidden);\n      this.rightMockSmall.classList.add(styles.hidden);\n    }\n    this.onPreferenceChange = this.onPreferenceChange.bind(this);\n    window.APP.store.addEventListener(\"statechanged\", this.onPreferenceChange);\n\n    this.inVr = false;\n    this.moving = false;\n    this.rotating = false;\n\n    this.displacement = new THREE.Vector3();\n    this.lookDy = 0;\n    this.lookDx = 0;\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVr);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n\n  onPreferenceChange() {\n    const newEnableLeft = window.APP.store.state.preferences.enableOnScreenJoystickLeft;\n    const newEnableRight = window.APP.store.state.preferences.enableOnScreenJoystickRight;\n    const isChanged = this.enableLeft !== newEnableLeft || this.enableRight !== newEnableRight;\n    if (!isChanged) {\n      return;\n    }\n    if ((newEnableLeft || newEnableRight) && !this.mockJoystickContainer.parentNode) {\n      insertAfter(this.mockJoystickContainer, this.el.sceneEl.canvas);\n    }\n    if (!this.enableLeft && newEnableLeft) {\n      this.createLeftStick();\n    } else if (this.enableLeft && !newEnableLeft) {\n      this.leftMock.classList.add(styles.hidden);\n      this.leftMockSmall.classList.add(styles.hidden);\n      this.leftStick.destroy();\n      this.leftTouchZone.parentNode.removeChild(this.leftTouchZone);\n      this.leftStick = null;\n      this.leftTouchZone = null;\n    }\n    if (!this.enableRight && newEnableRight) {\n      this.createRightStick();\n    } else if (this.enableRight && !newEnableRight) {\n      this.rightMock.classList.add(styles.hidden);\n      this.rightMockSmall.classList.add(styles.hidden);\n      this.rightStick.destroy();\n      this.rightTouchZone.parentNode.removeChild(this.rightTouchZone);\n      this.rightStick = null;\n      this.rightTouchZone = null;\n    }\n    this.enableLeft = newEnableLeft;\n    this.enableRight = newEnableRight;\n\n    if (this.enableLeft) {\n      this.leftMock.classList.remove(styles.hidden);\n      this.leftMockSmall.classList.remove(styles.hidden);\n      this.leftStick.on(\"start\", this.onFirstInteraction);\n    }\n    if (this.enableRight) {\n      this.rightMock.classList.remove(styles.hidden);\n      this.rightMockSmall.classList.remove(styles.hidden);\n      this.rightStick.on(\"start\", this.onFirstInteraction);\n    }\n    if (!this.enableLeft && !this.enableRight && this.mockJoystickContainer.parentNode) {\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\n    }\n  },\n\n  createRightStick() {\n    this.rightTouchZone = document.createElement(\"div\");\n    this.rightTouchZone.classList.add(styles.touchZone, styles.right);\n    insertAfter(this.rightTouchZone, this.mockJoystickContainer);\n    this.rightStick = nipplejs.create({\n      mode: \"static\",\n      position: { left: \"50%\", top: \"50%\" },\n      zone: this.rightTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n    // nipplejs sets z-index 999 but it makes the joysticks\n    // visible even if the scene is hidden for example by\n    // preference dialog. So remove z-index.\n    this.rightStick[0].ui.el.style.removeProperty(\"z-index\");\n    this.rightStick.on(\"start\", this.onFirstInteraction);\n    this.rightStick.on(\"move\", this.onLookJoystickChanged);\n    this.rightStick.on(\"end\", this.onLookJoystickEnd);\n  },\n\n  createLeftStick() {\n    this.leftTouchZone = document.createElement(\"div\");\n    this.leftTouchZone.classList.add(styles.touchZone, styles.left);\n    insertAfter(this.leftTouchZone, this.mockJoystickContainer);\n    this.leftStick = nipplejs.create({\n      mode: \"static\",\n      position: { left: \"50%\", top: \"50%\" },\n      zone: this.leftTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n    this.leftStick[0].ui.el.style.removeProperty(\"z-index\");\n    this.leftStick.on(\"start\", this.onFirstInteraction);\n    this.leftStick.on(\"move\", this.onMoveJoystickChanged);\n    this.leftStick.on(\"end\", this.onMoveJoystickEnd);\n  },\n\n  onFirstInteraction() {\n    if (this.leftStick) this.leftStick.off(\"start\", this.onFirstInteraction);\n    if (this.rightStick) this.rightStick.off(\"start\", this.onFirstInteraction);\n    this.mockJoystickContainer.parentNode &&\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\n  },\n\n  onMoveJoystickChanged(event, joystick) {\n    if (window.APP.preferenceScreenIsVisible) return;\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    this.displacement.set(Math.cos(angle), 0, -Math.sin(angle)).multiplyScalar(force * 1.85);\n    this.moving = true;\n  },\n\n  onMoveJoystickEnd() {\n    this.moving = false;\n    this.displacement.set(0, 0, 0);\n  },\n\n  onLookJoystickChanged(event, joystick) {\n    if (window.APP.preferenceScreenIsVisible) return;\n    // Set pitch and yaw angles on right stick move\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    this.rotating = true;\n    this.lookDy = -Math.cos(angle) * force * ROTATION_SPEED;\n    this.lookDx = Math.sin(angle) * force * ROTATION_SPEED;\n  },\n\n  onLookJoystickEnd() {\n    this.rotating = false;\n    this.lookDx = 0;\n    this.lookDy = 0;\n    this.el.sceneEl.emit(\"rotateX\", this.lookDx);\n  },\n\n  tick() {\n    if (this.inVr) {\n      return;\n    }\n    if (this.moving) {\n      this.characterController.enqueueRelativeMotion(this.displacement);\n    }\n    if (this.rotating) {\n      this.characterController.enqueueInPlaceRotationAroundWorldUp(this.lookDy);\n      this.el.sceneEl.emit(\"rotateX\", this.lookDx);\n    }\n  },\n\n  onEnterVr() {\n    // Hide the joystick controls\n    this.inVr = true;\n    if (this.leftTouchZone) this.leftTouchZone.style.display = \"none\";\n    if (this.rightTouchZone) this.rightTouchZone.style.display = \"none\";\n  },\n\n  onExitVr() {\n    // Show the joystick controls\n    this.inVr = false;\n    if (this.leftTouchZone) this.leftTouchZone.style.display = \"block\";\n    if (this.rightTouchZone) this.rightTouchZone.style.display = \"block\";\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"entervr\", this.onEnterVr);\n    this.el.sceneEl.removeEventListener(\"exitvr\", this.onExitVr);\n    this.mockJoystickContainer.parentNode &&\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\n    if (this.leftTouchZone) this.leftTouchZone.parentNode.removeChild(this.leftTouchZone);\n    if (this.rightTouchZone) this.rightTouchZone.parentNode.removeChild(this.rightTouchZone);\n  }\n});\n","import { defineQuery } from \"bitecs\";\nimport { CameraTool } from \"../bit-components\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nconst { Vector3, Quaternion, Matrix4, Euler } = THREE;\n\nfunction quaternionAlmostEquals(epsilon, u, v) {\n  // Note: q and -q represent same rotation\n  return (\n    (Math.abs(u.x - v.x) < epsilon &&\n      Math.abs(u.y - v.y) < epsilon &&\n      Math.abs(u.z - v.z) < epsilon &&\n      Math.abs(u.w - v.w) < epsilon) ||\n    (Math.abs(-u.x - v.x) < epsilon &&\n      Math.abs(-u.y - v.y) < epsilon &&\n      Math.abs(-u.z - v.z) < epsilon &&\n      Math.abs(-u.w - v.w) < epsilon)\n  );\n}\n\nconst cameraToolsQuery = defineQuery([CameraTool]);\n\n/**\n * Provides access to the end effectors for IK.\n * @namespace avatar\n * @component ik-root\n */\nAFRAME.registerComponent(\"ik-root\", {\n  schema: {\n    camera: { type: \"string\", default: \".camera\" },\n    leftController: { type: \"string\", default: \".left-controller\" },\n    rightController: { type: \"string\", default: \".right-controller\" }\n  },\n  update(oldData) {\n    if (this.data.camera !== oldData.camera) {\n      this.camera = this.el.querySelector(this.data.camera);\n    }\n\n    if (this.data.leftController !== oldData.leftController) {\n      this.leftController = this.el.querySelector(this.data.leftController);\n    }\n\n    if (this.data.rightController !== oldData.rightController) {\n      this.rightController = this.el.querySelector(this.data.rightController);\n    }\n  }\n});\n\nfunction findIKRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"ik-root\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"ik-root\"];\n}\n\nconst HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, -Math.PI / 2, 0))\n};\n\nconst angleOnXZPlaneBetweenMatrixRotations = (function() {\n  const XZ_PLANE_NORMAL = new THREE.Vector3(0, -1, 0);\n  const v1 = new THREE.Vector3();\n  const v2 = new THREE.Vector3();\n  return function angleOnXZPlaneBetweenMatrixRotations(matrixA, matrixB) {\n    v1.setFromMatrixColumn(matrixA, 2).projectOnPlane(XZ_PLANE_NORMAL);\n    v2.setFromMatrixColumn(matrixB, 2).projectOnPlane(XZ_PLANE_NORMAL);\n    return v1.angleTo(v2);\n  };\n})();\n\n/**\n * Performs IK on a hip-rooted skeleton to align the hip, head and hands with camera and controller inputs.\n * @namespace avatar\n * @component ik-controller\n */\nAFRAME.registerComponent(\"ik-controller\", {\n  schema: {\n    leftEye: { type: \"string\", default: \"LeftEye\" },\n    rightEye: { type: \"string\", default: \"RightEye\" },\n    head: { type: \"string\", default: \"Head\" },\n    neck: { type: \"string\", default: \"Neck\" },\n    leftHand: { type: \"string\", default: \"LeftHand\" },\n    rightHand: { type: \"string\", default: \"RightHand\" },\n    chest: { type: \"string\", default: \"Spine\" },\n    rotationSpeed: { default: 8 },\n    maxLerpAngle: { default: 90 * THREE.MathUtils.DEG2RAD },\n    alwaysUpdate: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    this.flipY = new Matrix4().makeRotationY(Math.PI);\n\n    this.cameraForward = new Matrix4();\n    this.headTransform = new Matrix4();\n    this.hipsPosition = new Vector3();\n\n    this.invHipsToHeadVector = new Vector3();\n\n    this.middleEyeMatrix = new Matrix4();\n    this.middleEyePosition = new Vector3();\n    this.invMiddleEyeToHead = new Matrix4();\n\n    this.cameraYRotation = new Euler();\n    this.cameraYQuaternion = new Quaternion();\n\n    this.invHipsQuaternion = new Quaternion();\n    this.headQuaternion = new Quaternion();\n\n    this.rootToChest = new Matrix4();\n    this.invRootToChest = new Matrix4();\n\n    this.ikRoot = findIKRoot(this.el);\n\n    this.isInView = true;\n    this.hasConvergedHips = false;\n    this.lastCameraTransform = new THREE.Matrix4();\n    waitForDOMContentLoaded().then(() => {\n      this.playerCamera = document.getElementById(\"viewing-camera\").getObject3D(\"camera\");\n    });\n\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"ik\");\n    this.forceIkUpdate = true;\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"ik\");\n  },\n\n  update(oldData) {\n    this.avatar = this.el.object3D;\n\n    if (this.data.leftEye !== oldData.leftEye) {\n      this.leftEye = this.el.object3D.getObjectByName(this.data.leftEye);\n    }\n\n    if (this.data.rightEye !== oldData.rightEye) {\n      this.rightEye = this.el.object3D.getObjectByName(this.data.rightEye);\n    }\n\n    if (this.data.head !== oldData.head) {\n      this.head = this.el.object3D.getObjectByName(this.data.head);\n    }\n\n    if (this.data.neck !== oldData.neck) {\n      this.neck = this.el.object3D.getObjectByName(this.data.neck);\n    }\n\n    if (this.data.leftHand !== oldData.leftHand) {\n      this.leftHand = this.el.object3D.getObjectByName(this.data.leftHand);\n    }\n\n    if (this.data.rightHand !== oldData.rightHand) {\n      this.rightHand = this.el.object3D.getObjectByName(this.data.rightHand);\n    }\n\n    if (this.data.chest !== oldData.chest) {\n      this.chest = this.el.object3D.getObjectByName(this.data.chest);\n    }\n\n    // Set middleEye's position to be right in the middle of the left and right eyes.\n    this.middleEyePosition.addVectors(this.leftEye.position, this.rightEye.position);\n    this.middleEyePosition.divideScalar(2);\n    this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x, this.middleEyePosition.y, this.middleEyePosition.z);\n    this.invMiddleEyeToHead = this.middleEyeMatrix.copy(this.middleEyeMatrix).invert();\n\n    this.invHipsToHeadVector\n      .addVectors(this.chest.position, this.neck.position)\n      .add(this.head.position)\n      .negate();\n  },\n\n  tick(time, dt) {\n    if (!this.ikRoot) {\n      return;\n    }\n\n    const root = this.ikRoot.el.object3D;\n    root.updateMatrices();\n    const { camera, leftController, rightController } = this.ikRoot;\n\n    camera.object3D.updateMatrix();\n\n    const hasNewCameraTransform = !this.lastCameraTransform.equals(camera.object3D.matrix);\n\n    // Optimization: if the camera hasn't moved and the hips converged to the target orientation on a previous frame,\n    // then the avatar does not need any IK this frame.\n    //\n    // Update in-view avatars every frame, and update out-of-view avatars via frame scheduler.\n    if (\n      this.data.alwaysUpdate ||\n      this.forceIkUpdate ||\n      (this.isInView && (hasNewCameraTransform || !this.hasConvergedHips))\n    ) {\n      if (hasNewCameraTransform) {\n        this.lastCameraTransform.copy(camera.object3D.matrix);\n      }\n\n      const {\n        avatar,\n        head,\n        neck,\n        chest,\n        cameraForward,\n        headTransform,\n        invMiddleEyeToHead,\n        invHipsToHeadVector,\n        flipY,\n        cameraYRotation,\n        cameraYQuaternion,\n        invHipsQuaternion,\n        rootToChest,\n        invRootToChest\n      } = this;\n\n      // Camera faces the -Z direction. Flip it along the Y axis so that it is +Z.\n      cameraForward.multiplyMatrices(camera.object3D.matrix, flipY);\n\n      // Compute the head position such that the hmd position would be in line with the middleEye\n      headTransform.multiplyMatrices(cameraForward, invMiddleEyeToHead);\n\n      // Then position the avatar such that the head is aligned with headTransform\n      // (which positions middleEye in line with the hmd)\n      //\n      // Note that we position the avatar itself, *not* the hips, since positioning the\n      // hips will use vertex skinning to do the root displacement, which results in\n      // frustum culling errors since three.js does not take into account skinning when\n      // computing frustum culling sphere bounds.\n      avatar.position.setFromMatrixPosition(headTransform).add(invHipsToHeadVector);\n      avatar.matrixNeedsUpdate = true;\n\n      // Animate the hip rotation to follow the Y rotation of the camera with some damping.\n      cameraYRotation.setFromRotationMatrix(cameraForward, \"YXZ\");\n      cameraYRotation.x = 0;\n      cameraYRotation.z = 0;\n      cameraYQuaternion.setFromEuler(cameraYRotation);\n\n      if (this._hadFirstTick) {\n        camera.object3D.updateMatrices();\n        avatar.updateMatrices();\n        // Note: Camera faces down -Z, avatar faces down +Z\n        const yDelta = Math.PI - angleOnXZPlaneBetweenMatrixRotations(camera.object3D.matrixWorld, avatar.matrixWorld);\n\n        if (yDelta > this.data.maxLerpAngle) {\n          avatar.quaternion.copy(cameraYQuaternion);\n        } else {\n          avatar.quaternion.slerpQuaternions(\n            avatar.quaternion,\n            cameraYQuaternion,\n            (this.data.rotationSpeed * dt) / 1000\n          );\n        }\n      } else {\n        avatar.quaternion.copy(cameraYQuaternion);\n      }\n\n      this.hasConvergedHips = quaternionAlmostEquals(0.0001, cameraYQuaternion, avatar.quaternion);\n\n      // Take the head orientation computed from the hmd, remove the Y rotation already applied to it by the hips,\n      // and apply it to the head\n      invHipsQuaternion.copy(avatar.quaternion).invert();\n      head.quaternion.setFromRotationMatrix(headTransform).premultiply(invHipsQuaternion);\n\n      avatar.updateMatrix();\n      rootToChest.multiplyMatrices(avatar.matrix, chest.matrix);\n      invRootToChest.copy(rootToChest).invert();\n\n      root.matrixNeedsUpdate = true;\n      neck.matrixNeedsUpdate = true;\n      head.matrixNeedsUpdate = true;\n      chest.matrixNeedsUpdate = true;\n    }\n\n    const { leftHand, rightHand } = this;\n\n    if (leftHand) this.updateHand(HAND_ROTATIONS.left, leftHand, leftController.object3D, true, this.isInView);\n    if (rightHand) this.updateHand(HAND_ROTATIONS.right, rightHand, rightController.object3D, false, this.isInView);\n    this.forceIkUpdate = false;\n\n    if (!this._hadFirstTick) {\n      // Ensure the avatar is not shown until we've done our first IK step, to prevent seeing mis-oriented/t-pose pose or our own avatar at the wrong place.\n      this.ikRoot.el.object3D.visible = true;\n      this._hadFirstTick = true;\n      this.el.emit(\"ik-first-tick\");\n    }\n  },\n\n  updateHand(handRotation, handObject3D, controllerObject3D, isLeft, isInView) {\n    const handMatrix = handObject3D.matrix;\n\n    // TODO: This coupling with personal-space-invader is not ideal.\n    // There should be some intermediate thing managing multiple opinions about object visibility\n    const spaceInvader = handObject3D.el.components[\"personal-space-invader\"];\n\n    if (spaceInvader) {\n      // If this hand has an invader, defer to it to manage visibility overall but tell it to hide based upon controller state\n      spaceInvader.setAlwaysHidden(!controllerObject3D.visible);\n    } else {\n      handObject3D.visible = controllerObject3D.visible;\n    }\n\n    // Optimization: skip IK update if not in view and not forced by frame scheduler\n    if (controllerObject3D.visible && (isInView || this.forceIkUpdate || this.data.alwaysUpdate)) {\n      handMatrix.multiplyMatrices(this.invRootToChest, controllerObject3D.matrix);\n\n      handMatrix.multiply(handRotation);\n\n      handObject3D.position.setFromMatrixPosition(handMatrix);\n      handObject3D.rotation.setFromRotationMatrix(handMatrix);\n      handObject3D.matrixNeedsUpdate = true;\n    }\n  },\n\n  _runScheduledWork() {\n    // Every scheduled run, we force an IK update on the next frame (so at most one avatar with forced IK per frame)\n    // and also update the this.isInView bit on the avatar which is used to determine if an IK update should be run\n    // every frame.\n    this.forceIkUpdate = true;\n\n    this._updateIsInView();\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const tmpPos = new THREE.Vector3();\n    const isInViewOfCamera = (screenCamera, pos) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromProjectionMatrix(frustumMatrix);\n      return frustum.containsPoint(pos);\n    };\n\n    return function() {\n      if (!this.playerCamera || this.data.alwaysUpdate) return;\n\n      const camera = this.ikRoot.camera.object3D;\n      camera.getWorldPosition(tmpPos);\n\n      // Check player camera\n      this.isInView = isInViewOfCamera(this.playerCamera, tmpPos);\n\n      if (!this.isInView) {\n        const world = APP.world;\n        // Check camera tools if they are rendering to viewfinder\n        const cameraTools = cameraToolsQuery(world);\n        for (const eid of cameraTools) {\n          const screenObj = world.eid2obj.get(CameraTool.screenRef[eid]);\n          const cameraObj = world.eid2obj.get(CameraTool.cameraRef[eid]);\n          this.isInView = screenObj.visible && isInViewOfCamera(cameraObj, tmpPos);\n          if (this.isInView) break;\n        }\n      }\n    };\n  })()\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst POSES = {\n  open: \"open\",\n  point: \"point\",\n  fist: \"fist\",\n  hold: \"hold\",\n  thumbUp: \"thumbUp\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  pinch: \"pinch\",\n  mrpDown: \"mrpDown\"\n};\n\n/**\n * Emits events indicating that avatar hands should be posed differently.\n * @namespace user-input\n * @component hand-controls2\n */\nAFRAME.registerComponent(\"hand-controls2\", {\n  schema: { default: \"left\" },\n\n  init() {\n    this.pose = POSES.open;\n  },\n\n  poseForFingers(thumb, index, middleRingPinky) {\n    if (!thumb && !index && !middleRingPinky) {\n      return POSES.open;\n    } else if (thumb && index && middleRingPinky) {\n      return POSES.fist;\n    } else if (!thumb && index && middleRingPinky) {\n      return POSES.thumbUp;\n    } else if (!thumb && !index && middleRingPinky) {\n      return POSES.mrpDown;\n    } else if (!thumb && index && !middleRingPinky) {\n      return POSES.indexDown;\n    } else if (thumb && !index && !middleRingPinky) {\n      return POSES.thumbDown;\n    } else if (thumb && index && !middleRingPinky) {\n      return POSES.pinch;\n    } else if (thumb && !index && middleRingPinky) {\n      return POSES.point;\n    }\n\n    console.warn(`Did not find matching pose for thumb ${thumb}, index ${index}, middleRingPinky ${middleRingPinky}`);\n    return POSES.open;\n  },\n\n  tick() {\n    const hand = this.data;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const subpath = hand === \"left\" ? paths.actions.leftHand : paths.actions.rightHand;\n    const thumb = userinput.get(subpath.thumb);\n    const index = userinput.get(subpath.index);\n    const middleRingPinky = userinput.get(subpath.middleRingPinky);\n    const pose = this.poseForFingers(thumb, index, middleRingPinky);\n    if (pose !== this.pose) {\n      this.el.emit(\"hand-pose\", { previous: this.pose, current: pose });\n      this.pose = pose;\n    }\n  }\n});\n","import { showHoverEffect } from \"../utils/permissions-utils\";\n\n/**\n * Applies effects to a hoverer based on hover state.\n * @namespace interactables\n * @component hover-visuals\n */\nAFRAME.registerComponent(\"hover-visuals\", {\n  schema: {\n    hand: { type: \"string\" }\n  },\n  init() {\n    // uniforms are set from the component responsible for loading the mesh.\n    this.handleLeftVisuals = this.handleLeftVisuals.bind(this);\n    this.handleRightVisuals = this.handleRightVisuals.bind(this);\n    this.hadLeftVisualLastFrame = false;\n    this.hadRightVisualLastFrame = false;\n    this.uniforms = null;\n    this.sweepParams = [0, 1.0];\n  },\n  remove() {\n    this.uniforms = null;\n  },\n  tick() {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    // Push down loops to assist JIT:\n    if (this.data.hand === \"left\") {\n      this.handleLeftVisuals();\n    } else {\n      this.handleRightVisuals();\n    }\n  },\n\n  handleLeftVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const interactingElement = interaction.state.leftHand.held || interaction.state.leftHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadLeftVisualLastFrame) return;\n    this.hadLeftVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorOne.value = !hideVisual;\n      uniform.hubs_InteractorOnePos.value[0] = elements[12];\n      uniform.hubs_InteractorOnePos.value[1] = elements[13];\n      uniform.hubs_InteractorOnePos.value[2] = elements[14];\n    }\n  },\n\n  handleRightVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    const interactingElement = interaction.state.rightHand.held || interaction.state.rightHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadRightVisualLastFrame) return;\n    this.hadRightVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_SweepParams.value = this.sweepParams;\n\n      uniform.hubs_HighlightInteractorTwo.value = !hideVisual;\n      uniform.hubs_InteractorTwoPos.value[0] = elements[12];\n      uniform.hubs_InteractorTwoPos.value[1] = elements[13];\n      uniform.hubs_InteractorTwoPos.value[2] = elements[14];\n    }\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\n/**\n * Positions an entity relative to a given target when the given event is fired.\n * @component offset-relative-to\n */\nAFRAME.registerComponent(\"offset-relative-to\", {\n  schema: {\n    target: {\n      type: \"selector\"\n    },\n    offset: {\n      type: \"vec3\"\n    },\n    on: {\n      type: \"string\"\n    },\n    orientation: {\n      default: 1 // see doc/image_orientations.gif\n    },\n    selfDestruct: {\n      default: false\n    },\n    lookAt: {\n      default: false\n    }\n  },\n  init() {\n    this.updateOffset = this.updateOffset.bind(this);\n\n    waitForDOMContentLoaded().then(() => {\n      if (this.data.on) {\n        this.el.sceneEl.addEventListener(this.data.on, this.updateOffset);\n      } else {\n        this.updateOffset();\n      }\n    });\n  },\n\n  updateOffset: (function() {\n    const y = new THREE.Vector3(0, 1, 0);\n    const z = new THREE.Vector3(0, 0, -1);\n    const QUARTER_CIRCLE = Math.PI / 2;\n    const offsetVector = new THREE.Vector3();\n    const targetWorldPos = new THREE.Vector3();\n    return function() {\n      const obj = this.el.object3D;\n      const target = this.data.target.object3D;\n      offsetVector.copy(this.data.offset);\n      target.localToWorld(offsetVector);\n      if (obj.parent) {\n        obj.parent.worldToLocal(offsetVector);\n      }\n      obj.position.copy(offsetVector);\n      if (this.data.lookAt) {\n        target.getWorldPosition(targetWorldPos);\n        obj.updateMatrices(true);\n        obj.lookAt(targetWorldPos);\n      } else {\n        target.getWorldQuaternion(obj.quaternion);\n      }\n\n      // See doc/image_orientations.gif\n      switch (this.data.orientation) {\n        case 8:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          break;\n        case 7:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 6:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          break;\n        case 5:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 4:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 3:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          break;\n        case 2:\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 1:\n        default:\n          break;\n      }\n\n      obj.matrixNeedsUpdate = true;\n\n      if (this.data.selfDestruct) {\n        if (this.data.on) {\n          this.el.sceneEl.removeEventListener(this.data.on, this.updateOffset);\n        }\n        this.el.removeAttribute(\"offset-relative-to\");\n      }\n    };\n  })()\n});\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport { proxiedUrlFor } from \"./media-url-utils\";\nimport avatarUnavailableImage from \"../assets/images/avatar_unavailable.png\";\n\nconst AVATARS_API = \"/api/v1/avatars\";\n\nexport const AVATAR_TYPES = {\n  SKINNABLE: \"skinnable\",\n  URL: \"url\"\n};\n\nexport function getAvatarType(avatarId) {\n  if (avatarId.startsWith(\"http\")) return AVATAR_TYPES.URL;\n  return AVATAR_TYPES.SKINNABLE;\n}\n\nasync function fetchSkinnableAvatar(avatarId) {\n  const resp = await fetchReticulumAuthenticated(`/api/v1/avatars/${avatarId}`);\n  return resp && resp.avatars && resp.avatars[0];\n}\n\nexport async function fetchAvatar(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchSkinnableAvatar(avatarId);\n    case AVATAR_TYPES.URL:\n      return {\n        avatar_id: avatarId,\n        gltf_url: proxiedUrlFor(avatarId)\n      };\n  }\n}\n\nasync function fetchAvatarGltfUrl(avatarId) {\n  return fetchAvatar(avatarId).then(avatar => avatar && avatar.gltf_url);\n}\n\nexport function getAvatarSrc(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatarGltfUrl(avatarId);\n    case AVATAR_TYPES.URL:\n      return proxiedUrlFor(avatarId);\n    default:\n      return avatarId;\n  }\n}\n\nexport async function getAvatarThumbnailUrl(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatar(avatarId).then(avatar => avatar.files.thumbnail);\n    default:\n      return avatarUnavailableImage;\n  }\n}\n\n// Currently the way we do material overrides is with a special named material.\n// We want to migrate eventually to having a GLTF extension that specifies what\n// materials can be overridden, but in the meantime we want to be able to support\n// arbitrary models with some sort of functionality. This provides a fallback\nexport const MAT_NAME = \"Bot_PBS\";\nexport function ensureAvatarMaterial(gltf) {\n  if (gltf.materials.find(m => m.name === MAT_NAME)) return gltf;\n\n  function materialForMesh(mesh) {\n    if (!mesh.primitives) return;\n    const primitive = mesh.primitives.find(p => p.material !== undefined);\n    return primitive && gltf.materials[primitive.material];\n  }\n\n  let nodes = gltf.scenes[gltf.scene].nodes.slice(0);\n  while (nodes.length) {\n    const node = gltf.nodes[nodes.shift()];\n    const material = node.mesh !== undefined && materialForMesh(gltf.meshes[node.mesh]);\n    if (material) {\n      material.name = MAT_NAME;\n      break;\n    }\n    if (node.children) nodes = nodes.concat(node.children);\n  }\n\n  return gltf;\n}\n\nexport async function remixAvatar(parentId, name) {\n  const avatar = {\n    parent_avatar_listing_id: parentId,\n    name: name,\n    files: {}\n  };\n\n  return fetchReticulumAuthenticated(AVATARS_API, \"POST\", { avatar });\n}\n","import { injectCustomShaderChunks } from \"../utils/media-utils\";\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\nimport { registerComponentInstance, deregisterComponentInstance } from \"../utils/component-utils\";\nimport defaultAvatar from \"../assets/models/DefaultAvatar.glb\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\nimport { createModelForSkinnedMesh } from \"../utils/three-utils\";\nimport { Layers } from \"./layers\";\n\nfunction ensureAvatarNodes(json) {\n  const { nodes } = json;\n  if (!nodes.some(node => node.name === \"Head\")) {\n    // If the avatar model doesn't have a Head node. The user has probably chosen a custom GLB.\n    // So, we need to construct a suitable hierarchy for avatar functionality to work.\n    // We re-parent the original root node to the Head node and set the scene root to a new AvatarRoot.\n\n    // Note: We assume that the first node in the primary scene is the one we care about.\n    const originalRoot = json.scenes[json.scene].nodes[0];\n    nodes.push({ name: \"LeftEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({ name: \"RightEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({\n      name: \"Head\",\n      children: [originalRoot, nodes.length - 1, nodes.length - 2],\n      extensions: { MOZ_hubs_components: { \"scale-audio-feedback\": \"\" } }\n    });\n    nodes.push({ name: \"Neck\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Spine\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Hips\", children: [nodes.length - 1] });\n    nodes.push({ name: \"AvatarRoot\", children: [nodes.length - 1] });\n    json.scenes[json.scene].nodes[0] = nodes.length - 1;\n  }\n  return json;\n}\n\nAFRAME.registerComponent(\"player-info\", {\n  schema: {\n    avatarSrc: { type: \"string\" },\n    avatarType: { type: \"string\", default: AVATAR_TYPES.SKINNABLE },\n    muted: { default: false },\n    isSharingAvatarCamera: { default: false }\n  },\n  init() {\n    this.applyProperties = this.applyProperties.bind(this);\n    this.handleModelError = this.handleModelError.bind(this);\n    this.handleRemoteModelError = this.handleRemoteModelError.bind(this);\n    this.update = this.update.bind(this);\n    this.onPresenceUpdated = this.onPresenceUpdated.bind(this);\n    this.onMicStateChanged = this.onMicStateChanged.bind(this);\n    this.onAvatarModelLoaded = this.onAvatarModelLoaded.bind(this);\n\n    this.isLocalPlayerInfo = this.el.id === \"avatar-rig\";\n    this.playerSessionId = null;\n\n    if (!this.isLocalPlayerInfo) {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n        this.playerSessionId = NAF.utils.getCreator(networkedEntity);\n        const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\n        if (playerPresence) {\n          this.updateFromPresenceMeta(playerPresence.metas[0]);\n        }\n      });\n    }\n\n    registerComponentInstance(this, \"player-info\");\n  },\n\n  remove() {\n    const avatarEl = this.el.querySelector(\"[avatar-audio-source]\");\n    APP.isAudioPaused.delete(avatarEl);\n    deregisterComponentInstance(this, \"player-info\");\n  },\n\n  onAvatarModelLoaded(e) {\n    this.applyProperties(e);\n\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.isLocalPlayerInfo && e.target === modelEl) {\n      let isSkinnedAvatar = false;\n      modelEl.object3D.traverse(function(o) {\n        if (o.isSkinnedMesh) {\n          const mesh = createModelForSkinnedMesh(o);\n          if (mesh) {\n            isSkinnedAvatar = true;\n            o.parent.add(mesh);\n          }\n        }\n      });\n      // This is to support using arbitrary models as avatars.\n      // TODO We can drop support for this when we go full VRM, or at least handle it earlier in the process.\n      if (!isSkinnedAvatar) {\n        modelEl.object3D.traverse(function(o) {\n          if (o.isMesh) o.layers.set(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n        });\n      }\n    }\n  },\n\n  play() {\n    this.el.addEventListener(\"model-loaded\", this.onAvatarModelLoaded);\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.onPresenceUpdated);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").addEventListener(\"model-error\", this.handleModelError);\n    } else {\n      this.el.querySelector(\".model\").addEventListener(\"model-error\", this.handleRemoteModelError);\n    }\n    window.APP.store.addEventListener(\"statechanged\", this.update);\n\n    this.el.sceneEl.addEventListener(\"stateadded\", this.update);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.update);\n\n    if (this.isLocalPlayerInfo) {\n      APP.dialog.on(\"mic-state-changed\", this.onMicStateChanged);\n    }\n  },\n\n  pause() {\n    this.el.removeEventListener(\"model-loaded\", this.onAvatarModelLoaded);\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.onPresenceUpdated);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").removeEventListener(\"model-error\", this.handleModelError);\n    } else {\n      this.el.querySelector(\".model\").removeEventListener(\"model-error\", this.handleRemoteModelError);\n    }\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.update);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.update);\n    window.APP.store.removeEventListener(\"statechanged\", this.update);\n\n    if (this.isLocalPlayerInfo) {\n      APP.dialog.off(\"mic-state-changed\", this.onMicStateChanged);\n    }\n  },\n\n  onPresenceUpdated(e) {\n    this.updateFromPresenceMeta(e.detail);\n  },\n\n  updateFromPresenceMeta(presenceMeta) {\n    if (!this.playerSessionId && this.isLocalPlayerInfo) {\n      this.playerSessionId = NAF.clientId;\n    }\n    if (!this.playerSessionId) return;\n    if (this.playerSessionId !== presenceMeta.sessionId) return;\n\n    this.permissions = presenceMeta.permissions;\n  },\n\n  update(oldData) {\n    if (this.data.muted !== oldData.muted) {\n      this.el.emit(\"remote_mute_updated\", { muted: this.data.muted });\n    }\n    this.applyProperties();\n  },\n\n  can(perm) {\n    return !!this.permissions && this.permissions[perm];\n  },\n\n  applyProperties(e) {\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.data.avatarSrc && modelEl) {\n      modelEl.components[\"gltf-model-plus\"].jsonPreprocessor = ensureAvatarNodes;\n      modelEl.setAttribute(\"gltf-model-plus\", \"src\", this.data.avatarSrc);\n    }\n\n    if (!e || e.target === modelEl) {\n      const uniforms = injectCustomShaderChunks(this.el.object3D);\n      this.el.querySelectorAll(\"[hover-visuals]\").forEach(el => {\n        el.components[\"hover-visuals\"].uniforms = uniforms;\n      });\n    }\n\n    const videoTextureTargets = modelEl.querySelectorAll(\"[video-texture-target]\");\n\n    const sessionId = this.isLocalPlayerInfo ? NAF.clientId : this.playerSessionId;\n\n    for (const el of Array.from(videoTextureTargets)) {\n      el.setAttribute(\"video-texture-target\", {\n        src: this.data.isSharingAvatarCamera ? `hubs://clients/${sessionId}/video` : \"\"\n      });\n\n      if (this.isLocalPlayerInfo) {\n        el.setAttribute(\"emit-scene-event-on-remove\", `event:${MediaDevicesEvents.VIDEO_SHARE_ENDED}`);\n      }\n    }\n\n    const avatarEl = this.el.querySelector(\"[avatar-audio-source]\");\n    if (this.data.muted) {\n      APP.isAudioPaused.add(avatarEl);\n    } else {\n      APP.isAudioPaused.delete(avatarEl);\n    }\n  },\n\n  handleModelError() {\n    window.APP.store.resetToRandomDefaultAvatar();\n  },\n\n  handleRemoteModelError() {\n    this.data.avatarSrc = defaultAvatar;\n    this.applyProperties();\n  },\n\n  onMicStateChanged({ enabled }) {\n    this.el.setAttribute(\"player-info\", { muted: !enabled });\n  }\n});\n","import anime from \"animejs\";\nimport MovingAverage from \"moving-average\";\nimport { getThemeColor } from \"../utils/theme\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport nextTick from \"../utils/next-tick\";\nimport { createPlaneBufferGeometry, setMatrixWorld } from \"../utils/three-utils\";\nimport { textureLoader } from \"../utils/media-utils\";\n\nimport handRaisedIconSrc from \"../assets/hud/hand-raised.png\";\n\nconst DEBUG = qsTruthy(\"debug\");\nconst NAMETAG_BACKGROUND_PADDING = 0.05;\nconst NAMETAG_STATUS_BORDER_PADDING = 0.035;\nconst NAMETAG_MIN_WIDTH = 0.6;\nconst NAMETAG_HEIGHT = 0.25;\nconst NAMETAG_OFFSET = 0.2;\nconst TYPING_ANIM_SPEED = 150;\nconst DISPLAY_NAME_LENGTH = 18;\n\nconst ANIM_CONFIG = {\n  duration: 400,\n  easing: \"easeOutQuart\",\n  elasticity: 400,\n  loop: 0,\n  round: false\n};\n\nconst nametagVolumeGeometry = new THREE.PlaneBufferGeometry(1, 0.025);\nconst nametagVolumeMaterial = new THREE.MeshBasicMaterial({ color: \"#7ED320\" });\n\nconst nametagTypingGeometry = new THREE.CircleBufferGeometry(0.01, 6);\n\nconst handRaisedTexture = textureLoader.load(handRaisedIconSrc);\nconst handRaisedGeometry = createPlaneBufferGeometry(0.2, 0.2, 1, 1, handRaisedTexture.flipY);\nconst handRaisedMaterial = new THREE.MeshBasicMaterial({ transparent: true, map: handRaisedTexture });\n\nAFRAME.registerComponent(\"name-tag\", {\n  schema: {},\n  init() {\n    this.store = window.APP.store;\n    this.displayName = null;\n    this.identityName = null;\n    this.isTalking = false;\n    this.isTyping = false;\n    this.isOwner = false;\n    this.isRecording = false;\n    this.isHandRaised = false;\n    this.volumeAvg = new MovingAverage(128);\n    this.shouldBeVisible = true;\n    this.size = new THREE.Vector3();\n    this.avatarAABB = new THREE.Box3();\n    this.avatarAABBSize = new THREE.Vector3();\n    this.avatarAABBCenter = new THREE.Vector3();\n    this.nametagHeight = 0;\n    this.isAvatarReady = false;\n    this.lastUpdateTime = Date.now();\n\n    this.onPresenceUpdated = this.onPresenceUpdated.bind(this);\n    this.onModelLoading = this.onModelLoading.bind(this);\n    this.onModelLoaded = this.onModelLoaded.bind(this);\n    this.onModelIkFirstTick = this.onModelIkFirstTick.bind(this);\n    this.onStateChanged = this.onStateChanged.bind(this);\n\n    this.nametag = this.el.object3D;\n    this.nametagIdentityName = this.el.querySelector(\".identityName\").object3D;\n    this.nametagBackground = this.el.querySelector(\".nametag-background\").object3D;\n    this.nametagStatusBorder = this.el.querySelector(\".nametag-status-border\").object3D;\n    this.recordingBadge = this.el.querySelector(\".recordingBadge\").object3D;\n    this.modBadge = this.el.querySelector(\".modBadge\").object3D;\n    this.nametagText = this.el.querySelector(\".nametag-text\").object3D;\n\n    this.handRaised = new THREE.Mesh(handRaisedGeometry, handRaisedMaterial);\n    this.handRaised.position.set(0, -0.3, 0.001);\n    this.el.object3D.add(this.handRaised);\n\n    this.nametagVolume = new THREE.Mesh(nametagVolumeGeometry, nametagVolumeMaterial);\n    this.nametagVolume.position.set(0, -0.075, 0.001);\n    this.nametagVolume.visible = false;\n    this.el.object3D.add(this.nametagVolume);\n\n    // TODO this is horribly inneficient draw call and geometry wise. Replace with custom shader code or at least a uv-croll image\n    this.nametagTyping = new THREE.Group();\n    this.nametagTyping.position.set(0, -0.075, 0.001);\n    for (let i = 0; i < 5; i++) {\n      const dot = new THREE.Mesh(\n        nametagTypingGeometry,\n        new THREE.MeshBasicMaterial({ transparent: true, color: 0xffffff, depthWrite: false })\n      );\n      dot.position.x = i * 0.035 - 0.07;\n      this.nametagTyping.add(dot);\n    }\n    this.el.object3D.add(this.nametagTyping);\n\n    this.updateTheme();\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n      this.playerSessionId = NAF.utils.getCreator(networkedEntity);\n      const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\n      if (playerPresence) {\n        this.updateFromPresenceMeta(playerPresence.metas[0]);\n      }\n    });\n\n    if (DEBUG) {\n      this.avatarAABBHelper = new THREE.Box3Helper(this.avatarAABB, 0xffff00);\n      this.el.sceneEl.object3D.add(this.avatarAABBHelper);\n    }\n\n    this.onStateChanged();\n  },\n\n  remove() {\n    if (DEBUG) this.el.sceneEl.object3D.remove(this.avatarAABBHelper);\n  },\n\n  tick: (() => {\n    let typingAnimTime = 0;\n    const worldPos = new THREE.Vector3();\n    const mat = new THREE.Matrix4();\n    return function (t) {\n      if (!this.isAvatarReady) {\n        this.nametag.visible = false;\n        return;\n      }\n      this.wasTalking = this.isTalking;\n      this.isTalking = this.audioAnalyzer.avatarIsTalking;\n\n      if (this.shouldBeVisible) {\n        this.nametag.visible = true;\n        if (this.isTalking !== this.wasTalking) {\n          this.resizeNameTag();\n        }\n        if (this.isTalking) {\n          this.nametagVolume.visible = this.isTalking;\n          this.nametagVolume.scale.setX(this.audioAnalyzer.volume * this.size.x);\n          this.nametagVolume.matrixNeedsUpdate = true;\n          this.nametagTyping.visible = false;\n        } else {\n          if (this.isTyping) {\n            this.nametagTyping.visible = true;\n            typingAnimTime = t;\n            this.nametagTyping.traverse(o => {\n              if (o.material) {\n                o.material.opacity = (Math.sin(typingAnimTime / TYPING_ANIM_SPEED) + 1) / 2;\n                typingAnimTime -= TYPING_ANIM_SPEED;\n              }\n            });\n          } else {\n            this.nametagTyping.visible = false;\n          }\n        }\n        this.nametagStatusBorder.visible = this.isTyping || this.isTalking || this.isHandRaised;\n        this.recordingBadge.visible = this.isRecording;\n        this.modBadge.visible = this.isOwner && !this.isRecording;\n        this.handRaised.visible = this.isHandRaised;\n\n        this.neck.getWorldPosition(worldPos);\n        worldPos.setY(this.nametagElPosY + this.ikRoot.position.y);\n        mat.setPosition(worldPos);\n        setMatrixWorld(this.nametag, mat);\n      } else {\n        this.nametag.visible = false;\n      }\n\n      if (DEBUG) {\n        this.updateAvatarModelAABB();\n        this.avatarAABBHelper.matrixNeedsUpdate = true;\n        this.avatarAABBHelper.updateMatrixWorld(true);\n      }\n    };\n  })(),\n\n  play() {\n    this.el.parentEl.addEventListener(\"model-loading\", this.onModelLoading);\n    this.el.parentEl.addEventListener(\"model-loaded\", this.onModelLoaded);\n    this.el.parentEl.addEventListener(\"ik-first-tick\", this.onModelIkFirstTick);\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.onPresenceUpdated);\n    window.APP.store.addEventListener(\"statechanged\", this.onStateChanged);\n    this.el.sceneEl.systems[\"hubs-systems\"].nameTagSystem.register(this);\n  },\n\n  pause() {\n    this.el.parentEl.removeEventListener(\"model-loading\", this.onModelLoading);\n    this.el.parentEl.removeEventListener(\"model-loaded\", this.onModelLoaded);\n    this.el.parentEl.removeEventListener(\"ik-first-tick\", this.onModelIkFirstTick);\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.onPresenceUpdated);\n    window.APP.store.removeEventListener(\"statechanged\", this.onStateChanged);\n    this.el.sceneEl.systems[\"hubs-systems\"].nameTagSystem.unregister(this);\n  },\n\n  onPresenceUpdated({ detail: presenceMeta }) {\n    if (presenceMeta.sessionId === this.playerSessionId) {\n      this.updateFromPresenceMeta(presenceMeta);\n    }\n  },\n\n  updateFromPresenceMeta(presenceMeta) {\n    this.displayName = presenceMeta.profile.displayName;\n    this.identityName = presenceMeta.profile.identityName;\n    this.isRecording = !!(presenceMeta.streaming || presenceMeta.recording);\n    this.isOwner = !!(presenceMeta.roles && presenceMeta.roles.owner);\n    this.isTyping = !!presenceMeta.typing;\n    this.isHandRaised = !!presenceMeta.hand_raised;\n    if (this.isAvatarReady) {\n      this.updateDisplayName();\n      this.updateHandRaised();\n      this.resizeNameTag();\n    }\n  },\n\n  updateDisplayName() {\n    if (this.displayName && this.displayName !== this.prevDisplayName) {\n      this.nametagText.el.addEventListener(\n        \"text-updated\",\n        () => {\n          if (this.nametagText.el) {\n            this.nametagText.el.components[\"text\"].getSize(this.size);\n            this.size.x = Math.max(this.size.x, NAMETAG_MIN_WIDTH);\n            this.resizeNameTag();\n          }\n        },\n        { once: true }\n      );\n      if (this.displayName.length > DISPLAY_NAME_LENGTH) {\n        this.displayName = this.displayName.slice(0, DISPLAY_NAME_LENGTH).concat(\"...\");\n      }\n      this.nametagText.el.setAttribute(\"text\", {\n        value: this.displayName\n      });\n      this.prevDisplayName = this.displayName;\n    }\n\n    if (this.identityName) {\n      if (this.identityName.length > DISPLAY_NAME_LENGTH) {\n        this.identityName = this.identityName.slice(0, DISPLAY_NAME_LENGTH).concat(\"...\");\n      }\n      this.nametagIdentityName.el.setAttribute(\"text\", { value: this.identityName });\n    }\n  },\n\n  onModelLoading() {\n    this.model = null;\n    this.isAvatarReady = false;\n  },\n\n  onModelLoaded({ detail: { model } }) {\n    this.model = model;\n  },\n\n  async onModelIkFirstTick() {\n    await nextTick();\n    this.ikRoot = findAncestorWithComponent(this.el, \"ik-root\").object3D;\n    this.neck = this.ikRoot.el.querySelector(\".Neck\").object3D;\n    this.audioAnalyzer = this.ikRoot.el.querySelector(\".AvatarRoot\").components[\"networked-audio-analyser\"];\n\n    this.updateAvatarModelAABB();\n    const tmpVector = new THREE.Vector3();\n    this.nametagHeight =\n      Math.abs(tmpVector.subVectors(this.ikRoot.position, this.avatarAABBCenter).y) +\n      this.avatarAABBSize.y / 2 +\n      NAMETAG_OFFSET;\n    this.nametagElPosY = this.nametagHeight + (this.isHandRaised ? NAMETAG_OFFSET : 0);\n    this.nametagText.el.components[\"text\"].getSize(this.size);\n    this.size.x = Math.max(this.size.x, NAMETAG_MIN_WIDTH);\n    this.isAvatarReady = true;\n\n    this.updateDisplayName();\n    this.updateHandRaised();\n    this.resizeNameTag();\n  },\n\n  updateTheme() {\n    this.nametagStatusBorder.el.setAttribute(\n      \"slice9\",\n      \"color\",\n      getThemeColor(this.isHandRaised ? \"nametag-border-color-raised-hand\" : \"nametag-border-color\")\n    );\n    nametagVolumeMaterial.color.set(getThemeColor(\"nametag-volume-color\"));\n    this.nametagBackground.el.setAttribute(\"slice9\", \"color\", getThemeColor(\"nametag-color\"));\n    this.nametagText.el.setAttribute(\"text\", \"color\", getThemeColor(\"nametag-text-color\"));\n  },\n\n  onStateChanged() {\n    this.updateTheme();\n  },\n\n  resizeNameTag() {\n    this.nametagBackground.el.setAttribute(\"slice9\", {\n      width: this.size.x + NAMETAG_BACKGROUND_PADDING * 2,\n      height: NAMETAG_HEIGHT\n    });\n    this.nametagStatusBorder.el.setAttribute(\"slice9\", {\n      width: this.size.x + NAMETAG_BACKGROUND_PADDING * 2 + NAMETAG_STATUS_BORDER_PADDING,\n      height: NAMETAG_HEIGHT + NAMETAG_STATUS_BORDER_PADDING\n    });\n  },\n\n  updateHandRaised() {\n    this.nametagStatusBorder.el.setAttribute(\n      \"slice9\",\n      \"color\",\n      getThemeColor(this.isHandRaised ? \"nametag-border-color-raised-hand\" : \"nametag-border-color\")\n    );\n    const targetScale = this.isHandRaised ? 1 : 0;\n    anime({\n      ...ANIM_CONFIG,\n      targets: {\n        x: this.handRaised.scale.x,\n        y: this.handRaised.scale.y,\n        z: this.handRaised.scale.z\n      },\n      x: targetScale,\n      y: targetScale,\n      z: targetScale,\n      update: anim => {\n        this.handRaised.scale.set(\n          anim.animatables[0].target.x,\n          anim.animatables[0].target.y,\n          anim.animatables[0].target.z\n        );\n        this.handRaised.matrixNeedsUpdate = true;\n      }\n    });\n    anime({\n      ...ANIM_CONFIG,\n      targets: {\n        y: this.nametagElPosY\n      },\n      y: this.nametagHeight + (this.isHandRaised ? NAMETAG_OFFSET : 0),\n      update: anim => {\n        this.nametagElPosY = anim.animatables[0].target.y;\n      }\n    });\n  },\n\n  updateAvatarModelAABB() {\n    if (!this.model) return;\n    this.avatarAABB.setFromObject(this.model);\n    this.avatarAABB.getSize(this.avatarAABBSize);\n    this.avatarAABB.getCenter(this.avatarAABBCenter);\n  }\n});\n","import { LoopOnce } from \"three/src/constants\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nconst POSES = {\n  open: \"allOpen\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  mrpDown: \"mrpDown\",\n  thumbUp: \"thumbsUp\",\n  point: \"point\",\n  fist: \"allGrip\",\n  pinch: \"pinch\"\n};\n\nconst NETWORK_POSES = [\"allOpen\", \"thumbDown\", \"indexDown\", \"mrpDown\", \"thumbsUp\", \"point\", \"allGrip\", \"pinch\"];\n\n/**\n * Animates between poses based on networked pose state using an animation mixer.\n * @namespace avatar\n * @component hand-pose\n */\nAFRAME.registerComponent(\"hand-pose\", {\n  multiple: true,\n\n  init() {\n    this.pose = 0;\n    this.animatePose = this.animatePose.bind(this);\n    const mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.mixer = mixerEl && mixerEl.components[\"animation-mixer\"].mixer;\n    if (!this.mixer || !this.mixer.clipAction(POSES.open + suffix)) {\n      console.warn(\"Avatar does not an 'allOpen' animation, disabling hand animations\");\n      this.el.removeAttribute(\"hand-pose\");\n      return;\n    }\n    this.from = this.to = this.mixer.clipAction(POSES.open + suffix);\n    this.from.play();\n    this.networkField = `${this.id}_hand_pose`;\n\n    const getNetworkedAvatar = el => {\n      if (!el) {\n        window.setTimeout(() => {\n          getNetworkedAvatar(this.el);\n        }, 1000);\n        return;\n      }\n      const networkedAvatar = el.components && el.components[\"networked-avatar\"];\n      if (networkedAvatar) {\n        return networkedAvatar;\n      }\n      return getNetworkedAvatar(el.parentEl);\n    };\n    this.networkedAvatar = getNetworkedAvatar(this.el);\n  },\n\n  tick() {\n    if (\n      !this.networkedAvatar ||\n      !this.networkedAvatar.data ||\n      this.networkedAvatar.data[this.networkField] === this.pose\n    ) {\n      return;\n    }\n\n    this.animatePose(NETWORK_POSES[this.pose], NETWORK_POSES[this.networkedAvatar.data[this.networkField]]);\n    this.pose = this.networkedAvatar.data[this.networkField];\n  },\n\n  animatePose(prev, curr) {\n    if (this.from) {\n      this.from.stop();\n    }\n    if (this.to) {\n      this.to.stop();\n    }\n\n    const duration = 0.065;\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.from = this.mixer.clipAction(prev + suffix);\n    this.to = this.mixer.clipAction(curr + suffix);\n    if (this.from) {\n      this.from.setLoop(LoopOnce, -1);\n      this.from.clampWhenFinished = true;\n      this.from.fadeOut(duration);\n      this.from.play();\n    }\n    if (this.to) {\n      this.to.setLoop(LoopOnce, -1);\n      this.to.clampWhenFinished = true;\n      this.to.fadeIn(duration);\n      this.to.play();\n    }\n\n    this.mixer.update(0.001);\n  }\n});\n\n/**\n * Sets the networked hand pose state based on hand-pose events.\n * @namespace avatar\n * @component hand-pose-controller\n */\nAFRAME.registerComponent(\"hand-pose-controller\", {\n  multiple: true,\n  schema: {\n    eventSrc: { type: \"selector\" },\n    networkedAvatar: { type: \"selector\" }\n  },\n  init: function() {\n    this.setHandPose = this.setHandPose.bind(this);\n  },\n\n  play: function() {\n    this.data.eventSrc.addEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  pause: function() {\n    this.data.eventSrc.removeEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  setHandPose: function(evt) {\n    this.data.networkedAvatar.setAttribute(\n      \"networked-avatar\",\n      `${this.id}_hand_pose`,\n      NETWORK_POSES.indexOf(POSES[evt.detail.current])\n    );\n  }\n});\n","import { CAMERA_MODE_FIRST_PERSON } from \"../systems/camera-system\";\nconst TWOPI = Math.PI * 2;\nfunction deltaAngle(a, b) {\n  const p = Math.abs(b - a) % TWOPI;\n  return p > Math.PI ? TWOPI - p : p;\n}\n\n/**\n * Positions the HUD and toggles app mode based on where the user is looking\n * @namespace ui\n * @component hud-controller\n */\nAFRAME.registerComponent(\"hud-controller\", {\n  schema: {\n    head: { type: \"selector\" },\n    offset: { default: 0.7 }, // distance from hud above head,\n    lookCutoff: { default: 20 }, // angle at which the hud should be \"on\",\n    animRange: { default: 30 }, // degrees over which to animate the hud into view\n    yawCutoff: { default: 50 } // yaw degrees at wich the hud should reoirent even if the user is looking up\n  },\n  init() {\n    this.onChildHovered = this.onChildHovered.bind(this);\n    this.removeHoverEvents = this.removeHoverEvents.bind(this);\n    this.isYLocked = false;\n    this.lockedHeadPositionY = 0;\n    this.lookDir = new THREE.Vector3();\n    this.lookEuler = new THREE.Euler();\n    this.store = window.APP.store;\n    this.hoverableChildren = this.el.querySelectorAll(\"[is-remote-hover-target]\");\n  },\n\n  tick() {\n    const hud = this.el.object3D;\n    const head = this.data.head.object3DMap.camera;\n\n    const { offset, lookCutoff, animRange, yawCutoff } = this.data;\n\n    const pitch = head.rotation.x * THREE.MathUtils.RAD2DEG;\n    const yawDif = deltaAngle(head.rotation.y, hud.rotation.y) * THREE.MathUtils.RAD2DEG;\n\n    // HUD is always visible until first hover, to increase discoverability.\n    const forceHudVisible = !this.store.state.activity.hasHoveredInWorldHud;\n\n    // animate the hud into place over animRange degrees as the user aproaches the lookCutoff angle\n    let t = 1 - THREE.MathUtils.clamp(lookCutoff - pitch, 0, animRange) / animRange;\n\n    // HUD is locked down while showing tooltip or if forced.\n    if (forceHudVisible) {\n      t = 1;\n    }\n\n    // Once the HUD is in place it should stay in place until you look sufficiently far down\n    if (t === 1) {\n      this.lockedHeadPositionY = head.position.y;\n      this.hudLocked = true;\n    } else if (this.hudLocked && pitch < lookCutoff - animRange / 2) {\n      this.hudLocked = false;\n    }\n\n    if (this.hudLocked) {\n      t = 1;\n    }\n\n    // Reorient the hud only if the user is looking away from the hud, for right now this arbitrarily means the hud is 1/2 way animated away\n    // TODO: come up with better huristics for this that maybe account for the user turning away from the hud \"too far\", also animate the position so that it doesnt just snap.\n    const hudOutOfView = yawDif >= yawCutoff || pitch < lookCutoff - animRange / 2;\n\n    if (hudOutOfView) {\n      this.lookDir.set(0, 0, -1);\n      this.lookDir.applyQuaternion(head.quaternion);\n      this.lookDir.add(head.position);\n      hud.position.x = this.lookDir.x;\n      hud.position.z = this.lookDir.z;\n      hud.rotation.copy(head.rotation);\n      hud.rotation.x = 0;\n      hud.rotation.z = 0;\n    }\n\n    hud.visible =\n      (!hudOutOfView || forceHudVisible) &&\n      this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_FIRST_PERSON;\n    hud.position.y = (this.isYLocked ? this.lockedHeadPositionY : head.position.y) + offset + (1 - t) * offset;\n    hud.rotation.x = (1 - t) * THREE.MathUtils.DEG2RAD * 90;\n    hud.matrixNeedsUpdate = true;\n  },\n\n  play() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.addEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  pause() {\n    this.removeHoverEvents();\n  },\n\n  removeHoverEvents() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.removeEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  onChildHovered() {\n    if (!this.store.state.activity.hasHoveredInWorldHud) {\n      this.store.update({ activity: { hasHoveredInWorldHud: true } });\n      this.removeHoverEvents();\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_FREEZE, SOUND_THAW } from \"../systems/sound-effects-system\";\nimport { CAMERA_MODE_INSPECT } from \"../systems/camera-system\";\n\n/**\n * Toggles freezing of network traffic on the given event.\n * @namespace network\n * @component freeze-controller\n */\nAFRAME.registerComponent(\"freeze-controller\", {\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n  },\n\n  tick: function() {\n    const scene = this.el.sceneEl;\n    if (!scene.is(\"entered\")) return;\n    const inspecting = scene.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT;\n    if (inspecting) {\n      if (this.el.is(\"frozen\")) {\n        this.onToggle();\n      }\n      if (!NAF.connection.adapter.frozen) {\n        NAF.connection.adapter.toggleFreeze();\n      }\n      this.wasInspecting = true;\n    } else if (this.wasInspecting) {\n      if (NAF.connection.adapter.frozen) {\n        NAF.connection.adapter.toggleFreeze();\n      }\n      this.wasInspecting = false;\n    } else {\n      const userinput = scene.systems.userinput;\n      const ensureFrozen = userinput.get(paths.actions.ensureFrozen);\n      const thaw = userinput.get(paths.actions.thaw);\n      const toggleFreeze = userinput.get(paths.actions.toggleFreeze);\n\n      const toggleFreezeDueToInput =\n        (this.el.is(\"frozen\") && thaw) || (!this.el.is(\"frozen\") && ensureFrozen) || toggleFreeze;\n\n      if (toggleFreezeDueToInput) {\n        this.onToggle();\n      }\n    }\n  },\n\n  onToggle: function() {\n    window.APP.store.update({ activity: { hasFoundFreeze: true } });\n    if (!NAF.connection.adapter) return;\n    NAF.connection.adapter.toggleFreeze();\n    if (NAF.connection.adapter.frozen) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_FREEZE);\n      this.el.addState(\"frozen\");\n    } else {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_THAW);\n      this.el.removeState(\"frozen\");\n    }\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\n/**\n * Toggles the visibility of this entity when the scene is frozen.\n * @namespace ui\n * @component visibility-while-frozen\n */\nAFRAME.registerComponent(\"visibility-while-frozen\", {\n  schema: {\n    withinDistance: { type: \"number\" },\n    visible: { type: \"boolean\", default: true },\n    requireHoverOnNonMobile: { type: \"boolean\", default: true },\n    withPermission: { type: \"string\" },\n    withoutPermission: { type: \"string\" },\n    visibleIfOwned: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.camWorldPos = new THREE.Vector3();\n    this.objWorldPos = new THREE.Vector3();\n\n    waitForDOMContentLoaded().then(() => {\n      this.cameraEl = document.getElementById(\"viewing-camera\");\n      this.updateVisibility();\n    });\n\n    let hoverableSearch = this.el;\n\n    while (hoverableSearch !== document) {\n      if (hoverableSearch.getAttribute(\"is-remote-hover-target\") !== null) {\n        this.hoverable = hoverableSearch;\n        break;\n      }\n\n      hoverableSearch = hoverableSearch.parentNode;\n    }\n    if (!this.hoverable && this.data.requireHoverOnNonMobile) {\n      console.error(\"Didn't find a remote hover target.\");\n    }\n\n    if (!this.data.visibleIfOwned) {\n      NAF.utils\n        .getNetworkedEntity(this.el)\n        .then(networkedEl => {\n          this.networkedEl = networkedEl;\n        })\n        .then(() => {}); //ignore exception, entity might not be networked\n    }\n\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.updateVisibility();\n    };\n    this.updateVisibility();\n  },\n\n  tick() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const isVisible = this.el.object3D.visible;\n    const shouldNotBeVisible = isFrozen === !this.data.visible;\n    if (!isVisible && shouldNotBeVisible) return;\n\n    this.updateVisibility();\n  },\n\n  updateVisibility() {\n    if (!this.cameraEl) return;\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n\n    let isWithinDistance = true;\n    const isVisible = this.el.object3D.visible;\n\n    if (this.data.withinDistance) {\n      if (!isVisible) {\n        // Edge case, if the object is not visible force a matrix update\n        // since the main matrix update loop will not do it.\n        this.el.object3D.updateMatrices(true, true);\n      }\n\n      getLastWorldPosition(this.cameraEl.object3DMap.camera, this.camWorldPos);\n      this.objWorldPos.copy(this.el.object3D.position);\n      this.el.object3D.localToWorld(this.objWorldPos);\n\n      isWithinDistance =\n        this.camWorldPos.distanceToSquared(this.objWorldPos) < this.data.withinDistance * this.data.withinDistance;\n    }\n\n    const isTransforming = this.el.sceneEl.systems[\"transform-selected-object\"].transforming;\n    const isHoldingAnything = this.el.sceneEl.systems.interaction.isHoldingAnything();\n\n    if (this.data.withPermission && this.data.withoutPermission) {\n      throw new Error(\n        \"only withPermission or withoutPermission can be speciifed on visibility-while-frozen, not both.\"\n      );\n    }\n\n    const allowed = !!(\n      (!this.data.withPermission && !this.data.withoutPermission) ||\n      (this.data.withPermission &&\n        window.APP.hubChannel &&\n        window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission)) ||\n      (this.data.withoutPermission &&\n        window.APP.hubChannel &&\n        !window.APP.hubChannel.canOrWillIfCreator(this.data.withoutPermission))\n    );\n\n    let shouldBeVisible =\n      allowed &&\n      ((isFrozen && this.data.visible) || (!isFrozen && !this.data.visible)) &&\n      isWithinDistance &&\n      !isTransforming &&\n      !isHoldingAnything;\n\n    if (this.data.requireHoverOnNonMobile && !isMobile) {\n      shouldBeVisible =\n        shouldBeVisible &&\n        ((this.hoverable &&\n          (this.el.sceneEl.systems.interaction.state.rightRemote.hovered === this.hoverable ||\n            this.el.sceneEl.systems.interaction.state.leftRemote.hovered === this.hoverable)) ||\n          isVisible);\n    }\n\n    if (!this.data.visibleIfOwned) {\n      shouldBeVisible = shouldBeVisible && this.networkedEl && !NAF.utils.isMine(this.networkedEl);\n    }\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  }\n});\n\n/**\n * Toggles the interactivity of a UI entity while the scene is frozen.\n * @namespace ui\n * @component ui-class-while-frozen\n */\nAFRAME.registerComponent(\"ui-class-while-frozen\", {\n  init() {\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n    };\n    this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n  }\n});\n","import \"./stats-plus.css\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { defineQuery } from \"bitecs\";\nimport { AEntity } from \"../bit-components\";\n\nfunction ThreeStats(renderer) {\n  let _rS = null;\n\n  const _values = {\n    \"renderer.info.memory.geometries\": {\n      caption: \"Geometries\"\n    },\n    \"renderer.info.memory.textures\": {\n      caption: \"Textures\"\n    },\n    \"renderer.info.programs\": {\n      caption: \"Programs\"\n    },\n    \"renderer.info.render.calls\": {\n      caption: \"Calls\"\n    },\n    \"renderer.info.render.triangles\": {\n      caption: \"Triangles\",\n      over: 100000\n    },\n    \"renderer.info.render.points\": {\n      caption: \"Points\"\n    }\n  };\n\n  const _groups = [\n    {\n      caption: \"Three.js - Memory\",\n      values: [\"renderer.info.memory.geometries\", \"renderer.info.programs\", \"renderer.info.memory.textures\"]\n    },\n    {\n      caption: \"Three.js - Render\",\n      values: [\"renderer.info.render.calls\", \"renderer.info.render.triangles\", \"renderer.info.render.points\"]\n    }\n  ];\n\n  const _fractions = [];\n\n  function _update() {\n    _rS(\"renderer.info.memory.geometries\").set(renderer.info.memory.geometries);\n    _rS(\"renderer.info.programs\").set(renderer.info.programs.length);\n    _rS(\"renderer.info.memory.textures\").set(renderer.info.memory.textures);\n    _rS(\"renderer.info.render.calls\").set(renderer.info.render.calls);\n    _rS(\"renderer.info.render.triangles\").set(renderer.info.render.triangles);\n    _rS(\"renderer.info.render.points\").set(renderer.info.render.points);\n  }\n\n  function _start() {}\n\n  function _end() {}\n\n  function _attach(r) {\n    _rS = r;\n  }\n\n  return {\n    update: _update,\n    start: _start,\n    end: _end,\n    attach: _attach,\n    values: _values,\n    groups: _groups,\n    fractions: _fractions\n  };\n}\n\n// Adapted from https://github.com/aframevr/aframe/blob/master/src/components/scene/stats.js\nfunction createStats(scene) {\n  const plugins = scene.isMobile ? [] : [new ThreeStats(scene.renderer)];\n  return new window.rStats({\n    css: [],\n    values: {\n      fps: { caption: \"fps\", below: 30 }\n    },\n    groups: [\n      { caption: \"Framerate\", values: [\"fps\", \"raf\", \"physics\"] },\n      { caption: \"BitECS\", values: [\"entities\", \"a-entities\", \"queries\"] }\n    ],\n    plugins: plugins\n  });\n}\n\nconst HIDDEN_CLASS = \"a-hidden\";\n\nlet $queries;\n\nconst allEntitiesQuery = defineQuery();\nconst aEntityQuery = defineQuery([AEntity]);\n\nAFRAME.registerComponent(\"stats-plus\", {\n  // Whether or not the stats panel is expanded.\n  // Shows FPS counter when collapsed.\n  schema: { default: false },\n  init() {\n    this.onExpand = this.onExpand.bind(this);\n    this.onCollapse = this.onCollapse.bind(this);\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n\n    const scene = this.el.sceneEl;\n    this.stats = createStats(scene);\n    this.statsEl = document.querySelector(\".rs-base\");\n    // HACK for now in rare case where dom isn't ready, just bail\n    if (!this.statsEl) return;\n\n    // Add header to stats panel so we can collapse it\n    const statsHeaderEl = document.createElement(\"div\");\n    statsHeaderEl.classList.add(\"rs-header\");\n\n    const statsTitleEl = document.createElement(\"h1\");\n    statsTitleEl.innerHTML = \"Stats\";\n    statsHeaderEl.appendChild(statsTitleEl);\n\n    const collapseEl = document.createElement(\"div\");\n    collapseEl.classList.add(\"rs-collapse-btn\");\n    collapseEl.innerHTML = \"X\";\n    collapseEl.addEventListener(\"click\", this.onCollapse);\n    statsHeaderEl.appendChild(collapseEl);\n\n    this.statsEl.insertBefore(statsHeaderEl, this.statsEl.firstChild);\n\n    // Add fps counter to the page\n    this.fpsEl = document.createElement(\"div\");\n    this.fpsEl.addEventListener(\"click\", this.onExpand);\n    this.fpsEl.classList.add(\"rs-fps-counter\");\n    document.body.appendChild(this.fpsEl);\n    this.lastFpsUpdate = performance.now();\n    this.lastFps = 0;\n    this.frameCount = 0;\n    this.inVR = scene.is(\"vr-mode\");\n    this.showFPSCounter = window.APP.store.state.preferences.showFPSCounter;\n    this.fpsEl.style.display = this.showFPSCounter ? \"block\" : \"none\";\n\n    if (scene.isMobile) {\n      this.statsEl.classList.add(\"rs-mobile\");\n      this.fpsEl.classList.add(\"rs-mobile\");\n    }\n\n    scene.addEventListener(\"enter-vr\", this.onEnterVr);\n    scene.addEventListener(\"exit-vr\", this.onExitVr);\n\n    this.vrStatsEnabled = qsTruthy(\"vrstats\");\n    if (this.vrStatsEnabled) {\n      this.initVRStats();\n    }\n    this.lastUpdate = 0;\n\n    $queries = Object.getOwnPropertySymbols(APP.world).find(s => s.description == \"queries\");\n  },\n  initVRStats() {\n    this.vrPanel = document.createElement(\"a-entity\");\n    this.vrPanel.setAttribute(\"text\", { maxWidth: 0.5, value: \"_\", anchorY: \"bottom\" });\n    this.vrPanel.addEventListener(\n      \"loaded\",\n      () =>\n        this.vrPanel.object3D.traverse(x => {\n          if (x.material) x.material.depthTest = false;\n        }),\n      { once: true }\n    );\n    this.el.append(this.vrPanel);\n    const background = new THREE.Mesh(\n      new THREE.PlaneBufferGeometry(0.1, 0.12),\n      new THREE.MeshBasicMaterial({ color: 0x333333, depthTest: false })\n    );\n    background.position.set(-0.2, 0.055, 0);\n    this.el.object3D.add(background);\n  },\n  toggleVRStats() {\n    if (this.vrStatsEnabled) {\n      this.el.object3D.visible = false;\n      this.vrStatsEnabled = false;\n    } else {\n      if (!this.vrPanel) {\n        this.initVRStats();\n      }\n      this.el.object3D.visible = true;\n      this.vrStatsEnabled = true;\n    }\n  },\n  update(oldData) {\n    if (oldData !== this.data) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n        this.fpsEl.classList.add(HIDDEN_CLASS);\n      } else {\n        this.statsEl.classList.add(HIDDEN_CLASS);\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  tick(time) {\n    const stats = this.stats;\n    if (!this.statsEl) return;\n    if (this.showFPSCounter !== window.APP.store.state.preferences.showFPSCounter) {\n      this.showFPSCounter = window.APP.store.state.preferences.showFPSCounter;\n      this.fpsEl.style.display = this.showFPSCounter ? \"block\" : \"none\";\n    }\n    if (!this.showFPSCounter) {\n      return;\n    }\n    if (this.data || this.vrStatsEnabled) {\n      // Update rStats\n      stats(\"rAF\").tick();\n      stats(\"FPS\").frame();\n      stats(\"physics\").set(this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem.stepDuration);\n\n      stats(\"queries\").set(APP.world[$queries].size);\n      stats(\"entities\").set(allEntitiesQuery(APP.world).length);\n      stats(\"a-entities\").set(aEntityQuery(APP.world).length);\n\n      stats().update();\n    } else if (!this.inVR) {\n      // Update the fps counter\n      const now = performance.now();\n      this.frameCount++;\n\n      // Update the fps counter text once a second\n      if (now >= this.lastFpsUpdate + 1000) {\n        const fps = Math.round(this.frameCount / ((now - this.lastFpsUpdate) / 1000));\n        if (fps !== this.lastFps) {\n          this.fpsEl.innerHTML = Math.round(fps) + \" FPS\";\n          this.lastFps = fps;\n        }\n        this.lastFpsUpdate = now;\n        this.frameCount = 0;\n      }\n    }\n    if (this.vrStatsEnabled && time - this.lastUpdate > 100) {\n      this.vrPanel.setAttribute(\n        \"text\",\n        \"value\",\n        [\n          `f ${stats(\"fps\")\n            .value()\n            .toFixed(0)}`,\n          `r ${stats(\"raf\")\n            .value()\n            .toFixed(0)}`,\n          `p ${stats(\"physics\")\n            .value()\n            .toFixed(0)}`,\n          `c ${this.el.sceneEl.renderer.info.render.calls}`,\n          `t ${(this.el.sceneEl.renderer.info.render.triangles / 1000).toFixed(0)}k`\n        ].join(\"\\n\")\n      );\n      this.lastUpdate = time;\n    }\n  },\n  onEnterVr() {\n    this.inVR = true;\n    // Hide all stats elements when entering VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      this.statsEl.classList.add(HIDDEN_CLASS);\n      this.fpsEl.classList.add(HIDDEN_CLASS);\n    }\n  },\n  onExitVr() {\n    this.inVR = false;\n    // Revert to previous state whe exiting VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n      } else {\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  onExpand() {\n    this.el.setAttribute(this.name, true);\n  },\n  onCollapse() {\n    this.el.setAttribute(this.name, false);\n  },\n  remove() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.hide);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.show);\n\n    if (this.statsEl) {\n      this.statsEl.parentNode.removeChild(this.statsEl);\n      this.fpsEl.parentNode.removeChild(this.fpsEl);\n    }\n  }\n});\n","import { cloneMedia, closeExistingMediaMirror } from \"./media-utils\";\nlet mirrorTarget;\nexport function getCurrentMirroredMedia() {\n  mirrorTarget = mirrorTarget || document.querySelector(\"#media-mirror-target\");\n  const mirrorEl = mirrorTarget.firstChild;\n  const linkedEl = mirrorEl && mirrorEl.components[\"media-loader\"] && mirrorEl.components[\"media-loader\"].data.linkedEl;\n  return linkedEl;\n}\nexport async function refreshMediaMirror() {\n  const linkedEl = getCurrentMirroredMedia();\n  if (!linkedEl) {\n    return;\n  }\n  await closeExistingMediaMirror();\n  const { entity } = cloneMedia(\n    linkedEl,\n    \"#linked-media\",\n    linkedEl.components[\"media-loader\"].data.src,\n    false,\n    true,\n    mirrorTarget\n  );\n\n  entity.object3D.scale.set(0.75, 0.75, 0.75);\n  entity.object3D.matrixNeedsUpdate = true;\n\n  const refreshButton = entity.querySelector(\"[refresh-media-button]\");\n  if (refreshButton) {\n    refreshButton.parentNode.removeChild(refreshButton);\n  }\n\n  const localRefreshButton = entity.querySelector(\"[local-refresh-media-button]\");\n  if (localRefreshButton) {\n    localRefreshButton.parentNode.removeChild(localRefreshButton);\n  }\n\n  mirrorTarget.parentEl.components[\"follow-in-fov\"].reset();\n  mirrorTarget.parentEl.object3D.visible = true;\n}\n","import errorImageSrc from \"!!url-loader!../assets/images/media-error.png\";\n\nconst errorImage = new Image();\nerrorImage.src = errorImageSrc;\nexport const errorTexture = new THREE.Texture(errorImage);\nerrorImage.onload = () => {\n  errorTexture.needsUpdate = true;\n};\n","export function scaleToAspectRatio(el, ratio) {\n  const width = Math.min(1.0, 1.0 / ratio);\n  const height = Math.min(1.0, ratio);\n  el.object3DMap.mesh.scale.set(width, height, 1);\n  el.object3DMap.mesh.matrixNeedsUpdate = true;\n}\n","import { detect } from \"detect-browser\";\n\nconst browser = detect();\nconst browserIsSafari = [\"iOS\", \"Mac OS\"].includes(browser.os) && [\"safari\", \"ios\"].includes(browser.name);\n\nexport function isSafari() {\n  return browserIsSafari;\n}\n","/* global performance THREE AFRAME NAF MediaStream setTimeout */\nimport configs from \"../utils/configs\";\nimport audioIcon from \"../assets/images/audio.png\";\nimport { paths } from \"../systems/userinput/paths\";\nimport HLS from \"hls.js\";\nimport { MediaPlayer } from \"dashjs\";\nimport { addAndArrangeMedia, createVideoOrAudioEl, hasAudioTracks } from \"../utils/media-utils\";\nimport { disposeTexture } from \"../utils/material-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport { buildAbsoluteURL } from \"url-toolkit\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { applyPersistentSync } from \"../utils/permissions-utils\";\nimport { refreshMediaMirror, getCurrentMirroredMedia } from \"../utils/mirror-utils\";\nimport { detect } from \"detect-browser\";\nimport semver from \"semver\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { getCurrentAudioSettings, updateAudioSettings } from \"../update-audio-settings\";\nimport { SourceType, AudioType } from \"./audio-params\";\nimport { errorTexture } from \"../utils/error-texture\";\nimport { scaleToAspectRatio } from \"../utils/scale-to-aspect-ratio\";\nimport { isSafari } from \"../utils/detect-safari\";\nimport { isIOS as detectIOS } from \"../utils/is-mobile\";\n\nimport qsTruthy from \"../utils/qs_truthy\";\n\nconst ONCE_TRUE = { once: true };\nconst TYPE_IMG_PNG = { type: \"image/png\" };\n\nconst isIOS = detectIOS();\nconst audioIconTexture = new HubsTextureLoader().load(audioIcon);\n\nexport const VOLUME_LABELS = [];\nfor (let i = 0; i <= 20; i++) {\n  let s = \"[\";\n  for (let j = 1; j <= 20; j++) {\n    s += i >= j ? \"|\" : \" \";\n  }\n  s += \"]\";\n  VOLUME_LABELS[i] = s;\n}\n\nfunction timeFmt(t) {\n  let s = Math.floor(t),\n    h = Math.floor(s / 3600);\n  s -= h * 3600;\n  let m = Math.floor(s / 60);\n  s -= m * 60;\n  if (h < 10) h = `0${h}`;\n  if (m < 10) m = `0${m}`;\n  if (s < 10) s = `0${s}`;\n  return h === \"00\" ? `${m}:${s}` : `${h}:${m}:${s}`;\n}\n\nconst MAX_GAIN_MULTIPLIER = 2;\n\nAFRAME.registerComponent(\"media-video\", {\n  schema: {\n    src: { type: \"string\" },\n    audioSrc: { type: \"string\" }, // set only if audio track is separated from video track (eg. 360 video)\n    contentType: { type: \"string\" },\n    loop: { type: \"boolean\", default: true },\n    hidePlaybackControls: { type: \"boolean\", default: false },\n    videoPaused: { type: \"boolean\" },\n    projection: { type: \"string\", default: \"flat\" },\n    time: { type: \"number\" },\n    tickRate: { default: 1000 }, // ms interval to send time interval updates\n    syncTolerance: { default: 2 },\n    linkedVideoTexture: { default: null },\n    linkedAudioSource: { default: null },\n    linkedMediaElementAudioSource: { default: null }\n  },\n\n  init() {\n    APP.gainMultipliers.set(this.el, 1);\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.updateHoverMenu = this.updateHoverMenu.bind(this);\n    this.tryUpdateVideoPlaybackState = this.tryUpdateVideoPlaybackState.bind(this);\n    this.ensureOwned = this.ensureOwned.bind(this);\n    this.isMineOrLocal = this.isMineOrLocal.bind(this);\n    this.updateSrc = this.updateSrc.bind(this);\n\n    this.seekForward = this.seekForward.bind(this);\n    this.seekBack = this.seekBack.bind(this);\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.snap = this.snap.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.togglePlaying = this.togglePlaying.bind(this);\n    this.setupAudio = this.setupAudio.bind(this);\n\n    this.audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n\n    this.lastUpdate = 0;\n    this.videoMutedAt = 0;\n    this.localSnapCount = 0;\n    this.isSnapping = false;\n    this.videoIsLive = null; // value null until we've determined if the video is live or not.\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\n    this.hasAudioTracks = false;\n\n    this.el.setAttribute(\"hover-menu__video\", { template: \"#video-hover-menu\", isFlat: true });\n    this.el.components[\"hover-menu__video\"].getHoverMenu().then(menu => {\n      // If we got removed while waiting, do nothing.\n      if (!this.el.parentNode) return;\n\n      this.hoverMenu = menu;\n\n      this.playbackControls = this.el.querySelector(\".video-playback\");\n      this.playPauseButton = this.el.querySelector(\".video-playpause-button\");\n      this.volumeUpButton = this.el.querySelector(\".video-volume-up-button\");\n      this.volumeDownButton = this.el.querySelector(\".video-volume-down-button\");\n      this.seekForwardButton = this.el.querySelector(\".video-seek-forward-button\");\n      this.seekBackButton = this.el.querySelector(\".video-seek-back-button\");\n      this.snapButton = this.el.querySelector(\".video-snap-button\");\n      this.timeLabel = this.el.querySelector(\".video-time-label\");\n      this.volumeLabel = this.el.querySelector(\".video-volume-label\");\n      this.linkButton = this.el.querySelector(\".video-link-button\");\n\n      this.playPauseButton.object3D.addEventListener(\"interact\", this.togglePlaying);\n      this.seekForwardButton.object3D.addEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.addEventListener(\"interact\", this.seekBack);\n      this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n      this.snapButton.object3D.addEventListener(\"interact\", this.snap);\n\n      this.updateVolumeLabel();\n      this.updateHoverMenu();\n      this.updatePlaybackState();\n    });\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => {\n        this.networkedEl = networkedEl;\n        applyPersistentSync(this.networkedEl.components.networked.data.networkId);\n        this.updatePlaybackState();\n\n        this.networkedEl.addEventListener(\"pinned\", this.updateHoverMenu);\n        this.networkedEl.addEventListener(\"unpinned\", this.updateHoverMenu);\n        window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateHoverMenu);\n\n        // For scene-owned videos, take ownership after a random delay if nobody\n        // else has so there is a timekeeper. Do not due this on iOS because iOS has an\n        // annoying \"auto-pause\" feature that forces one non-autoplaying video to play\n        // at once, which will pause the videos for everyone in the room if owned.\n        if (!isIOS && NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n          setTimeout(() => {\n            if (NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n              NAF.utils.takeOwnership(this.networkedEl);\n            }\n          }, 2000 + Math.floor(Math.random() * 2000));\n        }\n      })\n      .catch(() => {\n        // Non-networked\n        this.updatePlaybackState();\n      });\n\n    let { disableLeftRightPanning, audioPanningQuality } = APP.store.state.preferences;\n    this.onPreferenceChanged = () => {\n      const newDisableLeftRightPanning = APP.store.state.preferences.disableLeftRightPanning;\n      const newAudioPanningQuality = APP.store.state.preferences.audioPanningQuality;\n\n      const shouldRecreateAudio =\n        disableLeftRightPanning !== newDisableLeftRightPanning && this.audio && this.mediaElementAudioSource;\n      const shouldUpdateAudioSettings = audioPanningQuality !== newAudioPanningQuality;\n\n      disableLeftRightPanning = newDisableLeftRightPanning;\n      audioPanningQuality = newAudioPanningQuality;\n\n      if (shouldRecreateAudio) {\n        this.setupAudio();\n      } else if (shouldUpdateAudioSettings) {\n        // updateAudioSettings() is called in this.setupAudio()\n        // so no need to call it if shouldRecreateAudio is true.\n        updateAudioSettings(this.el, this.audio);\n      }\n    };\n\n    APP.store.addEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.addEventListener(\"audio_type_changed\", this.setupAudio);\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  isMineOrLocal() {\n    return !this.el.components.networked || (this.networkedEl && NAF.utils.isMine(this.networkedEl));\n  },\n\n  ensureOwned() {\n    return (\n      !this.el.components.networked ||\n      ((this.networkedEl && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl))\n    );\n  },\n\n  seekForward() {\n    if (!this.videoIsLive && this.ensureOwned()) {\n      this.video.currentTime += 30;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  seekBack() {\n    if (!this.videoIsLive && this.ensureOwned()) {\n      this.video.currentTime -= 10;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  changeVolumeBy(v) {\n    let gainMultiplier = APP.gainMultipliers.get(this.el);\n    gainMultiplier = THREE.MathUtils.clamp(gainMultiplier + v, 0, MAX_GAIN_MULTIPLIER);\n    APP.gainMultipliers.set(this.el, gainMultiplier);\n    this.updateVolumeLabel();\n    const audio = APP.audios.get(this.el);\n    if (audio) {\n      updateAudioSettings(this.el, audio);\n    }\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.2);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.2);\n  },\n\n  async snap() {\n    if (this.isSnapping) return;\n    this.isSnapping = true;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.video.videoWidth;\n    canvas.height = this.video.videoHeight;\n    canvas.getContext(\"2d\").drawImage(this.video, 0, 0, canvas.width, canvas.height);\n    const blob = await new Promise(resolve => canvas.toBlob(resolve));\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\n\n    this.localSnapCount++;\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount);\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\n  },\n\n  togglePlaying() {\n    // See onPauseStateChanged for note about iOS\n    if (isIOS && this.video.paused && this.isMineOrLocal()) {\n      this.video.play();\n      return;\n    }\n\n    if (this.ensureOwned()) {\n      this.tryUpdateVideoPlaybackState(!this.data.videoPaused);\n    }\n  },\n\n  onPauseStateChange() {\n    // iOS Safari will auto-pause other videos if one is manually started (not autoplayed.) So, to keep things\n    // easy to reason about, we *never* broadcast pauses from iOS.\n    //\n    // if an iOS safari user pauses and plays a video they'll pause all the other videos,\n    // which isn't great, but this check will at least ensure they don't pause those videos\n    // for all other users in the room! Of course, if they go and hit play on those videos auto-paused,\n    // they will become the timekeeper, and will seek everyone to where the video was auto-paused.\n    //\n    // This specific case will diverge the network schema and the video player state, so that\n    // this.data.videoPaused is false (so others will keep playing it) but our local player will\n    // have stopped. So we deal with this special case as well when we press the play button.\n    if (isIOS && this.video.paused && this.isMineOrLocal()) {\n      return;\n    }\n\n    // Used in the HACK in hub.js for dealing with auto-pause in Oculus Browser\n    if (this._ignorePauseStateChanges) return;\n\n    this.el.setAttribute(\"media-video\", \"videoPaused\", this.video.paused);\n    if (this.video.paused) {\n      APP.isAudioPaused.add(this.el);\n    } else {\n      APP.isAudioPaused.delete(this.el);\n    }\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      this.el.emit(\"owned-video-state-changed\");\n    }\n  },\n\n  updatePlaybackState(force) {\n    this.updateHoverMenu();\n\n    // Only update playback position for videos you don't own\n    if (this.video && (force || (this.networkedEl && !NAF.utils.isMine(this.networkedEl)))) {\n      if (Math.abs(this.data.time - this.video.currentTime) > this.data.syncTolerance) {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused, this.data.time);\n      } else {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused);\n      }\n    }\n  },\n\n  tryUpdateVideoPlaybackState(pause, currentTime) {\n    if (this._playbackStateChangeTimeout) {\n      clearTimeout(this._playbackStateChangeTimeout);\n      delete this._playbackStateChangeTimeout;\n    }\n\n    // Update current time if we've determined this video is not a live stream, since otherwise we may\n    // update the video to currentTime = 0\n    if (this.videoIsLive === false && currentTime !== undefined) {\n      this.video.currentTime = currentTime;\n    }\n\n    if (this.hoverMenu) {\n      this.playPauseButton.setAttribute(\"icon-button\", \"active\", pause);\n    }\n\n    if (pause) {\n      this.video.pause();\n    } else {\n      // Need to deal with the fact play() may fail if user has not interacted with browser yet.\n      this.video.play().catch(() => {\n        if (pause !== this.data.videoPaused) return;\n        this._playbackStateChangeTimeout = setTimeout(() => this.tryUpdateVideoPlaybackState(pause, currentTime), 1000);\n      });\n    }\n  },\n\n  update(oldData) {\n    this.updatePlaybackState();\n\n    const shouldUpdateSrc = this.data.src && this.data.src !== oldData.src;\n    if (shouldUpdateSrc) {\n      this.updateSrc(oldData);\n      return;\n    }\n  },\n\n  setupAudio() {\n    this.removeAudio();\n\n    APP.sourceType.set(this.el, SourceType.MEDIA_VIDEO);\n\n    if (this.data.videoPaused) {\n      APP.isAudioPaused.add(this.el);\n    } else {\n      APP.isAudioPaused.delete(this.el);\n    }\n\n    const { audioType } = getCurrentAudioSettings(this.el);\n    const audioListener = this.el.sceneEl.audioListener;\n    if (audioType === AudioType.PannerNode) {\n      this.audio = new THREE.PositionalAudio(audioListener);\n    } else {\n      this.audio = new THREE.Audio(audioListener);\n    }\n    // Default to being quiet so it fades in when volume is set by audio systems\n    this.audio.gain.gain.value = 0;\n    this.audioSystem.addAudio({ sourceType: SourceType.MEDIA_VIDEO, node: this.audio });\n\n    this.audio.setNodeSource(this.mediaElementAudioSource);\n    this.el.setObject3D(\"sound\", this.audio);\n\n    // Make sure that the audio is initialized to the right place.\n    // Its matrix may not update if this element is not visible.\n    // See https://github.com/mozilla/hubs/issues/2855\n    this.audio.updateMatrixWorld();\n\n    APP.audios.set(this.el, this.audio);\n    updateAudioSettings(this.el, this.audio);\n    // Original audio source volume can now be restored as audio systems will take over\n    this.mediaElementAudioSource.mediaElement.volume = 1;\n  },\n\n  async updateSrc(oldData) {\n    const { src, linkedVideoTexture, linkedAudioSource, linkedMediaElementAudioSource } = this.data;\n\n    this.cleanUp();\n    if (this.mesh && this.mesh.material) {\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    let texture, audioSourceEl;\n    try {\n      if (linkedVideoTexture) {\n        texture = linkedVideoTexture;\n        audioSourceEl = linkedAudioSource;\n      } else {\n        this.el.emit(\"video-loading\");\n        ({ texture, audioSourceEl } = await this.createVideoTextureAudioSourceEl());\n        if (getCurrentMirroredMedia() === this.el) {\n          await refreshMediaMirror();\n        }\n      }\n\n      this.hasAudioTracks = hasAudioTracks(audioSourceEl);\n\n      // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n      if (this.data.src !== src) {\n        disposeTexture(texture);\n        return;\n      }\n\n      this.mediaElementAudioSource = null;\n      if (!src.startsWith(\"hubs://\")) {\n        // iOS video audio is broken on ios safari < 13.1.2, see: https://github.com/mozilla/hubs/issues/1797\n        if (!isIOS || semver.satisfies(detect().version, \">=13.1.2\")) {\n          // TODO FF error here if binding mediastream: The captured HTMLMediaElement is playing a MediaStream. Applying volume or mute status is not currently supported -- not an issue since we have no audio atm in shared video.\n          this.mediaElementAudioSource =\n            linkedMediaElementAudioSource ||\n            this.el.sceneEl.audioListener.context.createMediaElementSource(audioSourceEl);\n\n          this.hasAudioTracks && this.setupAudio();\n        }\n      }\n\n      this.video = texture.image;\n      this.video.loop = this.data.loop;\n      this.video.addEventListener(\"pause\", this.onPauseStateChange);\n      this.video.addEventListener(\"play\", this.onPauseStateChange);\n\n      if (texture.hls) {\n        const updateHLSLiveState = () => {\n          if (texture.hls.currentLevel >= 0) {\n            this.videoIsLive = texture.hls.levels[texture.hls.currentLevel].details.live;\n            this.updateHoverMenu();\n          }\n        };\n        texture.hls.on(HLS.Events.LEVEL_LOADED, updateHLSLiveState);\n        texture.hls.on(HLS.Events.LEVEL_SWITCHED, updateHLSLiveState);\n        if (texture.hls.currentLevel >= 0) {\n          updateHLSLiveState();\n        }\n      } else {\n        this.videoIsLive = this.video.duration === Infinity;\n        this.updateHoverMenu();\n      }\n\n      if (isIOS) {\n        const template = document.getElementById(\"video-unmute\");\n        this.el.appendChild(document.importNode(template.content, true));\n        this.el.setAttribute(\"position-at-border__unmute-ui\", {\n          target: \".unmute-ui\",\n          isFlat: true\n        });\n      }\n\n      this.videoTexture = texture;\n      this.audioSource = audioSourceEl;\n    } catch (e) {\n      console.error(\"Error loading video\", this.data.src, e);\n      texture = errorTexture;\n      this.videoTexture = this.audioSource = null;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n      material.toneMapped = false;\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        const flipY = texture.isVideoTexture ? texture.flipY : audioIconTexture.flipY;\n        geometry = createPlaneBufferGeometry(undefined, undefined, undefined, undefined, flipY);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    if (!texture.isVideoTexture) {\n      this.mesh.material.map = audioIconTexture;\n    } else {\n      this.mesh.material.map = texture;\n      if (projection === \"flat\") {\n        scaleToAspectRatio(\n          this.el,\n          (texture.image.videoHeight || texture.image.height) / (texture.image.videoWidth || texture.image.width)\n        );\n      }\n    }\n    this.mesh.material.needsUpdate = true;\n\n    this.updatePlaybackState(true);\n\n    if (this.video && this.video.muted) {\n      this.videoMutedAt = performance.now();\n    }\n\n    this.el.emit(\"video-loaded\", { projection: projection });\n  },\n\n  async createVideoTextureAudioSourceEl() {\n    const url = this.data.src;\n    const contentType = this.data.contentType;\n    let pollTimeout;\n\n    return new Promise(async (resolve, reject) => {\n      if (this._audioSyncInterval) {\n        clearInterval(this._audioSyncInterval);\n        this._audioSyncInterval = null;\n      }\n\n      let resolved = false;\n      const failLoad = function(e) {\n        if (resolved) return;\n        resolved = true;\n        clearTimeout(pollTimeout);\n        reject(e);\n      };\n\n      const videoEl = createVideoOrAudioEl(\"video\");\n\n      let texture, audioEl, isReady;\n      if (contentType.startsWith(\"audio/\")) {\n        // We want to treat audio almost exactly like video, so we mock a video texture with an image property.\n        texture = new THREE.Texture();\n        texture.image = videoEl;\n        isReady = () => videoEl.readyState > 0;\n      } else {\n        texture = new THREE.VideoTexture(videoEl);\n        texture.minFilter = THREE.LinearFilter;\n        texture.encoding = THREE.sRGBEncoding;\n\n        // Firefox seems to have video play (or decode) performance issue.\n        // Somehow setting RGBA format improves the performance very well.\n        // Some tickets have been opened for the performance issue but\n        // I don't think it will be fixed soon. So we set RGBA format for Firefox\n        // as workaround so far.\n        // See https://github.com/mozilla/hubs/issues/3470\n        if (/firefox/i.test(navigator.userAgent)) {\n          texture.format = THREE.RGBAFormat;\n        }\n\n        isReady = () => {\n          if (texture.hls && texture.hls.streamController.audioOnly) {\n            audioEl = videoEl;\n            const hls = texture.hls;\n            texture = new THREE.Texture();\n            texture.image = videoEl;\n            texture.hls = hls;\n            return true;\n          } else {\n            const ready =\n              (texture.image.videoHeight || texture.image.height) && (texture.image.videoWidth || texture.image.width);\n            return ready;\n          }\n        };\n      }\n\n      // Set src on video to begin loading.\n      if (url.startsWith(\"hubs://\")) {\n        const streamClientId = url.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\n        const stream = await APP.dialog.getMediaStream(streamClientId, \"video\");\n        // We subscribe to video stream notifications for this peer to update the video element\n        // This could happen in case there is an ICE failure that requires a transport recreation.\n        if (this._onStreamUpdated) {\n          APP.dialog.off(\"stream_updated\", this._onStreamUpdated);\n        }\n        this._onStreamUpdated = async (peerId, kind) => {\n          if (peerId === streamClientId && kind === \"video\") {\n            // The video stream for this peer has been updated\n            const stream = await APP.dialog.getMediaStream(peerId, \"video\").catch(e => {\n              console.error(`Error getting video stream for ${peerId}`, e);\n            });\n            if (stream) {\n              videoEl.srcObject = new MediaStream(stream);\n            }\n          }\n        };\n        APP.dialog.on(\"stream_updated\", this._onStreamUpdated, this);\n        videoEl.srcObject = new MediaStream(stream.getVideoTracks());\n        // If hls.js is supported we always use it as it gives us better events\n      } else if (contentType.startsWith(\"application/dash\")) {\n        const dashPlayer = MediaPlayer().create();\n        dashPlayer.extend(\"RequestModifier\", function() {\n          return { modifyRequestHeader: xhr => xhr, modifyRequestURL: proxiedUrlFor };\n        });\n        dashPlayer.on(MediaPlayer.events.ERROR, failLoad);\n        dashPlayer.initialize(videoEl, url);\n        dashPlayer.setTextDefaultEnabled(false);\n\n        // TODO this countinously pings to get updated time, unclear if this is actually needed, but this preserves the default behavior\n        dashPlayer.clearDefaultUTCTimingSources();\n        dashPlayer.addUTCTimingSource(\n          \"urn:mpeg:dash:utc:http-xsdate:2014\",\n          proxiedUrlFor(\"https://time.akamai.com/?iso\")\n        );\n        // We can also use our own HEAD request method like we use to sync NAF\n        // dashPlayer.addUTCTimingSource(\"urn:mpeg:dash:utc:http-head:2014\", location.href);\n\n        texture.dash = dashPlayer;\n      } else if (AFRAME.utils.material.isHLS(url, contentType)) {\n        if (HLS.isSupported()) {\n          const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\n          const baseUrl = url.startsWith(corsProxyPrefix) ? url.substring(corsProxyPrefix.length) : url;\n          const setupHls = () => {\n            if (texture.hls) {\n              texture.hls.stopLoad();\n              texture.hls.detachMedia();\n              texture.hls.destroy();\n              texture.hls = null;\n            }\n\n            const hls = new HLS({\n              debug: qsTruthy(\"hlsDebug\"),\n              xhrSetup: (xhr, u) => {\n                if (u.startsWith(corsProxyPrefix)) {\n                  u = u.substring(corsProxyPrefix.length);\n                }\n\n                // HACK HLS.js resolves relative urls internally, but our CORS proxying screws it up. Resolve relative to the original unproxied url.\n                // TODO extend HLS.js to allow overriding of its internal resolving instead\n                if (!u.startsWith(\"http\")) {\n                  u = buildAbsoluteURL(baseUrl, u.startsWith(\"/\") ? u : `/${u}`);\n                }\n\n                xhr.open(\"GET\", proxiedUrlFor(u), true);\n              }\n            });\n\n            texture.hls = hls;\n            hls.loadSource(url);\n            hls.attachMedia(videoEl);\n\n            hls.on(HLS.Events.ERROR, function(event, data) {\n              if (data.fatal) {\n                switch (data.type) {\n                  case HLS.ErrorTypes.NETWORK_ERROR:\n                    // try to recover network error\n                    hls.startLoad();\n                    break;\n                  case HLS.ErrorTypes.MEDIA_ERROR:\n                    hls.recoverMediaError();\n                    break;\n                  default:\n                    failLoad(event);\n                    return;\n                }\n              }\n            });\n          };\n\n          setupHls();\n        } else if (videoEl.canPlayType(contentType)) {\n          videoEl.src = url;\n          videoEl.onerror = failLoad;\n        } else {\n          failLoad(\"HLS unsupported\");\n        }\n      } else {\n        videoEl.src = url;\n\n        // Workaround for Safari.\n        // Safari seems to have a bug that it doesn't transfer range property in HTTP request header\n        // for redirects if crossOrigin is set (while other major browsers do).\n        // So Safari can fail to load video if the server responds redirect because\n        // it expects 206 HTTP status code but gets 200.\n        // If we fail to load video on Safari we retry with fetch() and videoEl.srcObject\n        // which may avoid the problem.\n        // Refer to #4516 for the details.\n        if (isSafari()) {\n          // There seems no way to detect whether the error is caused by the problem mentioned above.\n          // So always retrying.\n          videoEl.onerror = async () => {\n            videoEl.onerror = failLoad;\n            try {\n              const res = await fetch(url);\n              videoEl.srcObject = await res.blob();\n            } catch (e) {\n              failLoad(e);\n            }\n          };\n        } else {\n          videoEl.onerror = failLoad;\n        }\n\n        // audioSrc is non-empty only if audio track is separated from video track (eg. 360 video)\n        if (this.data.audioSrc) {\n          // Mute video track just in case\n          videoEl.muted = true;\n\n          // If there's an audio src, create an audio element to play it that we keep in sync\n          // with the video while this component is active.\n          audioEl = createVideoOrAudioEl(\"audio\");\n          audioEl.src = this.data.audioSrc;\n          audioEl.onerror = failLoad;\n\n          this._audioSyncInterval = setInterval(() => {\n            if (Math.abs(audioEl.currentTime - videoEl.currentTime) >= 0.33) {\n              // In Chrome, drift of a few frames seems persistent\n              audioEl.currentTime = videoEl.currentTime;\n            }\n\n            // During pause state change, correct any drift that remains.\n            if (videoEl.paused !== audioEl.paused) {\n              videoEl.paused ? audioEl.pause() : audioEl.play();\n              audioEl.currentTime = videoEl.currentTime;\n            }\n          }, 1000);\n        }\n      }\n\n      // NOTE: We used to use the canplay event here to yield the texture, but that fails to fire on iOS Safari\n      // and also sometimes in Chrome it seems.\n      const poll = () => {\n        if (isReady()) {\n          resolved = true;\n          resolve({ texture, audioSourceEl: audioEl || texture.image });\n        } else {\n          pollTimeout = setTimeout(poll, 500);\n        }\n      };\n\n      poll();\n    });\n  },\n\n  updateHoverMenu() {\n    if (!this.hoverMenu) return;\n\n    const mediaLoader = this.el.components[\"media-loader\"].data;\n    const pinnableElement = mediaLoader.linkedEl || this.el;\n    const isPinned = pinnableElement.components.pinnable && pinnableElement.components.pinnable.data.pinned;\n    this.playbackControls.object3D.visible = !this.data.hidePlaybackControls && !!this.video;\n    this.timeLabel.object3D.visible = !this.data.hidePlaybackControls;\n    this.volumeLabel.object3D.visible = this.volumeUpButton.object3D.visible = this.volumeDownButton.object3D.visible =\n      this.hasAudioTracks && !this.data.hidePlaybackControls && !!this.video;\n\n    this.snapButton.object3D.visible =\n      !!this.video && !this.data.contentType.startsWith(\"audio/\") && window.APP.hubChannel.can(\"spawn_and_move_media\");\n    this.seekForwardButton.object3D.visible = !!this.video && !this.videoIsLive;\n\n    const mayModifyPlayHead =\n      !!this.video && !this.videoIsLive && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n\n    this.playPauseButton.object3D.visible = this.seekForwardButton.object3D.visible = this.seekBackButton.object3D.visible = mayModifyPlayHead;\n\n    this.linkButton.object3D.visible = !!mediaLoader.mediaOptions.href;\n\n    if (this.videoIsLive) {\n      this.timeLabel.setAttribute(\"text\", \"value\", \"LIVE\");\n    }\n  },\n\n  updateVolumeLabel() {\n    const gainMultiplier = APP.gainMultipliers.get(this.el);\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      gainMultiplier === 0 ? \"MUTE\" : VOLUME_LABELS[Math.floor(gainMultiplier / (MAX_GAIN_MULTIPLIER / 20))]\n    );\n  },\n\n  tick: (() => {\n    return function() {\n      if (!this.video) return;\n\n      const userinput = this.el.sceneEl.systems.userinput;\n      const interaction = this.el.sceneEl.systems.interaction;\n      const volumeModRight = userinput.get(paths.actions.cursor.right.mediaVolumeMod);\n      if (interaction.state.rightRemote.hovered === this.el && volumeModRight) {\n        this.changeVolumeBy(volumeModRight);\n      }\n      const volumeModLeft = userinput.get(paths.actions.cursor.left.mediaVolumeMod);\n      if (interaction.state.leftRemote.hovered === this.el && volumeModLeft) {\n        this.changeVolumeBy(volumeModLeft);\n      }\n\n      const isHeld = interaction.isHeld(this.el);\n\n      if (this.wasHeld && !isHeld) {\n        this.localSnapCount = 0;\n      }\n\n      this.wasHeld = isHeld;\n\n      if (this.hoverMenu && this.hoverMenu.object3D.visible && !this.videoIsLive) {\n        this.timeLabel.setAttribute(\n          \"text\",\n          \"value\",\n          `${timeFmt(this.video.currentTime)} / ${timeFmt(this.video.duration)}`\n        );\n      }\n\n      // If a known non-live video is currently playing and we own it, send out time updates\n      if (\n        !this.data.videoPaused &&\n        this.videoIsLive === false &&\n        this.networkedEl &&\n        NAF.utils.isMine(this.networkedEl)\n      ) {\n        const now = performance.now();\n        if (now - this.lastUpdate > this.data.tickRate) {\n          this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n          this.lastUpdate = now;\n        }\n      }\n    };\n  })(),\n\n  cleanUp() {\n    if (this.videoTexture && !this.data.linkedVideoTexture) {\n      disposeTexture(this.videoTexture);\n    }\n  },\n\n  remove() {\n    this.cleanUp();\n\n    APP.isAudioPaused.delete(this.el);\n\n    if (this.mesh) {\n      this.el.removeObject3D(\"mesh\");\n    }\n\n    if (this._audioSyncInterval) {\n      clearInterval(this._audioSyncInterval);\n      this._audioSyncInterval = null;\n    }\n\n    APP.gainMultipliers.delete(this.el);\n    APP.audios.delete(this.el);\n    APP.sourceType.delete(this.el);\n    APP.supplementaryAttenuation.delete(this.el);\n\n    this.removeAudio();\n\n    if (this.networkedEl) {\n      this.networkedEl.removeEventListener(\"pinned\", this.updateHoverMenu);\n      this.networkedEl.removeEventListener(\"unpinned\", this.updateHoverMenu);\n    }\n\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateHoverMenu);\n\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n      this.video.removeEventListener(\"play\", this.onPauseStateChange);\n      APP.dialog.off(\"stream_updated\", this._onStreamUpdated);\n    }\n\n    if (this.hoverMenu) {\n      this.playPauseButton.object3D.removeEventListener(\"interact\", this.togglePlaying);\n      this.volumeUpButton.object3D.removeEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.removeEventListener(\"interact\", this.volumeDown);\n      this.seekForwardButton.object3D.removeEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.removeEventListener(\"interact\", this.seekBack);\n      this.snapButton.object3D.removeEventListener(\"interact\", this.snap);\n    }\n\n    window.APP.store.removeEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.addEventListener(\"audio_type_changed\", this.setupAudio);\n  },\n\n  removeAudio() {\n    if (this.audio) {\n      this.el.removeObject3D(\"sound\");\n      this.audioSystem.removeAudio({ node: this.audio });\n      delete this.audio;\n    }\n  }\n});\n","import * as pdfjs from \"pdfjs-dist\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { scaleToAspectRatio } from \"../utils/scale-to-aspect-ratio\";\nimport { errorTexture } from \"../utils/error-texture\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport { addAndArrangeMedia } from \"../utils/media-utils\";\nconst ONCE_TRUE = { once: true };\nconst TYPE_IMG_PNG = { type: \"image/png\" };\n\n/**\n * Warning! This require statement is fragile!\n *\n * How it works:\n * require -> require the file after all import statements have been called, particularly the configs.js import which modifies __webpack_public_path__\n * !! -> don't run any other loaders\n * file-loader -> make webpack move the file into the dist directory and return the file path\n * outputPath -> where to put the file\n * name -> how to name the file\n * Then the path to the worker script\n */\npdfjs.GlobalWorkerOptions.workerSrc =\n  require(\"!!file-loader?outputPath=assets/js&name=[name]-[hash].js!pdfjs-dist/build/pdf.worker.min.js\").default;\n\nAFRAME.registerComponent(\"media-pdf\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" },\n    index: { default: 0 }\n  },\n\n  init() {\n    this.snap = this.snap.bind(this);\n    this.canvas = document.createElement(\"canvas\");\n    this.canvasContext = this.canvas.getContext(\"2d\");\n    this.localSnapCount = 0;\n    this.isSnapping = false;\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\n    this.texture = new THREE.CanvasTexture(this.canvas);\n\n    this.texture.encoding = THREE.sRGBEncoding;\n    this.texture.minFilter = THREE.LinearFilter;\n\n    this.el.addEventListener(\"pager-snap-clicked\", () => this.snap());\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  async snap() {\n    if (this.isSnapping) return;\n    this.isSnapping = true;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n\n    const blob = await new Promise(resolve => this.canvas.toBlob(resolve));\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\n\n    this.localSnapCount++;\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount, false, 1);\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n\n    try {\n      const { src, index } = this.data;\n      if (!src) return;\n\n      if (this.renderTask) {\n        await this.renderTask.promise;\n        if (src !== this.data.src || index !== this.data.index) return;\n      }\n\n      this.el.emit(\"pdf-loading\");\n\n      if (src !== oldData.src) {\n        const loadingSrc = this.data.src;\n        const pdf = await pdfjs.getDocument(src).promise;\n        if (loadingSrc !== this.data.src) return;\n\n        this.pdf = pdf;\n        this.el.setAttribute(\"media-pager\", { maxIndex: this.pdf.numPages - 1 });\n      }\n\n      const page = await this.pdf.getPage(index + 1);\n      if (src !== this.data.src || index !== this.data.index) return;\n\n      const viewport = page.getViewport({ scale: 3 });\n      const pw = viewport.width;\n      const ph = viewport.height;\n      texture = this.texture;\n      ratio = ph / pw;\n\n      this.canvas.width = pw;\n      this.canvas.height = ph;\n\n      this.renderTask = page.render({ canvasContext: this.canvasContext, viewport });\n\n      await this.renderTask.promise;\n\n      this.renderTask = null;\n\n      if (src !== this.data.src || index !== this.data.index) return;\n    } catch (e) {\n      console.error(\"Error loading PDF\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    if (!this.mesh) {\n      const material = new THREE.MeshBasicMaterial();\n      const geometry = createPlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n      material.side = THREE.DoubleSide;\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    this.mesh.material.transparent = texture == errorTexture;\n    this.mesh.material.map = texture;\n    this.mesh.material.map.needsUpdate = true;\n    this.mesh.material.needsUpdate = true;\n\n    scaleToAspectRatio(this.el, ratio);\n\n    if (this.el.components[\"media-pager\"] && this.el.components[\"media-pager\"].data.index !== this.data.index) {\n      this.el.setAttribute(\"media-pager\", { index: this.data.index });\n    }\n\n    this.el.emit(\"pdf-loaded\", { src: this.data.src });\n  }\n});\n","import { KTX2Loader } from \"three/examples/jsm/loaders/KTX2Loader\";\nimport { BasisTextureLoader } from \"three/examples/jsm/loaders/BasisTextureLoader\";\nimport { rewriteBasisTranscoderUrls } from \"./media-url-utils\";\nconst loadingManager = new THREE.LoadingManager();\nloadingManager.setURLModifier(rewriteBasisTranscoderUrls);\nlet ktxLoader;\nlet basisLoader;\nexport function createBasisTexture(url) {\n  if (!basisLoader) {\n    basisLoader = new BasisTextureLoader(loadingManager).detectSupport(AFRAME.scenes[0].renderer);\n  }\n  return new Promise((resolve, reject) => {\n    basisLoader.load(\n      url,\n      function(texture) {\n        texture.encoding = THREE.sRGBEncoding;\n        texture.onUpdate = function() {\n          // Delete texture data once it has been uploaded to the GPU\n          texture.mipmaps.length = 0;\n        };\n        // texture.anisotropy = 4;\n        resolve(texture);\n      },\n      undefined,\n      function(error) {\n        console.error(error);\n        reject(new Error(`'${url}' could not be fetched (Error: ${error}`));\n      }\n    );\n  });\n}\n\nexport function createKTX2Texture(url) {\n  if (!ktxLoader) {\n    ktxLoader = new KTX2Loader(loadingManager).detectSupport(AFRAME.scenes[0].renderer);\n  }\n  return new Promise((resolve, reject) => {\n    ktxLoader.load(\n      url,\n      function(texture) {\n        texture.encoding = THREE.sRGBEncoding;\n        texture.onUpdate = function() {\n          // Delete texture data once it has been uploaded to the GPU\n          texture.mipmaps.length = 0;\n        };\n        texture.anisotropy = 4;\n        resolve(texture);\n      },\n      undefined,\n      function(error) {\n        console.error(error);\n        reject(new Error(`'${url}' could not be fetched (Error: ${error}`));\n      }\n    );\n  });\n}\n","import { promisifyWorker } from \"../utils/promisify-worker.js\";\n\nimport GIFWorker from \"../workers/gifparsing.worker.js\";\n\nclass GIFTexture extends THREE.Texture {\n  constructor(frames, delays, disposals) {\n    super(document.createElement(\"canvas\"));\n    this.image.width = frames[0].width;\n    this.image.height = frames[0].height;\n\n    this._ctx = this.image.getContext(\"2d\");\n\n    this.generateMipmaps = false;\n    this.isVideoTexture = true;\n    this.minFilter = THREE.NearestFilter;\n\n    this.frames = frames;\n    this.delays = delays;\n    this.disposals = disposals;\n\n    this.frame = 0;\n    this.frameStartTime = Date.now();\n  }\n\n  update() {\n    if (!this.frames || !this.delays || !this.disposals) return;\n    const now = Date.now();\n    if (now - this.frameStartTime > this.delays[this.frame]) {\n      if (this.disposals[this.frame] === 2) {\n        this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n      }\n      this.frame = (this.frame + 1) % this.frames.length;\n      this.frameStartTime = now;\n      this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n      this.needsUpdate = true;\n    }\n  }\n}\n\nconst parseGIF = promisifyWorker(new GIFWorker());\n\nexport async function createGIFTexture(url) {\n  return new Promise((resolve, reject) => {\n    fetch(url, { mode: \"cors\" })\n      .then(r => r.arrayBuffer())\n      .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n      .then(result => {\n        const { frames, delayTimes, disposals } = result;\n        let loadCnt = 0;\n        for (let i = 0; i < frames.length; i++) {\n          const img = new Image();\n          img.onload = e => {\n            loadCnt++;\n            frames[i] = e.target;\n            if (loadCnt === frames.length) {\n              const texture = new GIFTexture(frames, delayTimes, disposals);\n              texture.image.src = url;\n              texture.encoding = THREE.sRGBEncoding;\n              texture.minFilter = THREE.LinearFilter;\n              resolve(texture);\n            }\n          };\n          img.src = frames[i];\n        }\n      })\n      .catch(reject);\n  });\n}\n","\nimport worker from \"!!../../node_modules/worker-loader/dist/runtime/inline.js\";\n\nexport default function Worker_fn() {\n  return worker(\"self.onmessage=s=>{try{const e=function(s){let e=0;const r=[];let a=null;const o=[],t=[];let n=0;if(71!==s[0]||73!==s[1]||70!==s[2]||56!==s[3]||57!==s[4]||97!==s[5])throw new Error(\\\"parseGIF: no GIF89a\\\");{e+=13+ +!!(128&s[10])*Math.pow(2,1+(7&s[10]))*3;const l=s.subarray(0,e);for(;s[e]&&59!==s[e];){const c=e,f=s[e];if(33===f){const o=s[++e];if(-1===[1,254,249,255].indexOf(o))throw new Error(\\\"parseGIF: unknown label\\\");for(249===o&&r.push(10*(s[e+3]+(s[e+4]<<8))),255===o&&(n=s[e+15]+(s[e+16]<<8));s[++e];)e+=s[e];249===o&&(a=s.subarray(c,e+1),t.push(a[3]>>2&7))}else{if(44!==f)throw new Error(\\\"parseGIF: unknown blockId\\\");{for(e+=9,e+=1+ +!!(128&s[e])*(3*Math.pow(2,1+(7&s[e])));s[++e];)e+=s[e];const r=s.subarray(c,e+1);o.push(URL.createObjectURL(new Blob([l,a,r])))}}e++}}return{delayTimes:r,loopCnt:n,frames:o,disposals:t}}(new Uint8Array(s.data.payload));self.postMessage({id:s.data.id,result:e})}catch(e){self.postMessage({id:s.data.id,err:e.message})}};\\n\", \"Worker\", undefined, undefined);\n}\n","import { createImageTexture } from \"../utils/media-utils\";\nimport { createBasisTexture, createKTX2Texture } from \"../utils/create-basis-texture\";\nimport { TextureCache } from \"../utils/texture-cache\";\nimport { errorTexture } from \"../utils/error-texture\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport { scaleToAspectRatio } from \"../utils/scale-to-aspect-ratio\";\nimport { createGIFTexture } from \"../utils/gif-texture\";\n\nconst textureCache = new TextureCache();\nconst inflightTextures = new Map();\n\nconst errorCacheItem = { texture: errorTexture, ratio: 1400 / 1200 };\n\nAFRAME.registerComponent(\"media-image\", {\n  schema: {\n    src: { type: \"string\" },\n    version: { type: \"number\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" },\n    alphaMode: { type: \"string\", default: undefined },\n    alphaCutoff: { type: \"number\" }\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  remove() {\n    if (this.currentSrcIsRetained) {\n      textureCache.release(this.data.src, this.data.version);\n      this.currentSrcIsRetained = false;\n    }\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n\n    try {\n      const { src, version, contentType } = this.data;\n      if (!src) return;\n\n      this.el.emit(\"image-loading\");\n\n      if (this.mesh && this.mesh.material.map && (src !== oldData.src || version !== oldData.version)) {\n        this.mesh.material.map = null;\n        this.mesh.material.needsUpdate = true;\n        if (this.mesh.material.map !== errorTexture) {\n          textureCache.release(oldData.src, oldData.version);\n          this.currentSrcIsRetained = false;\n        }\n      }\n\n      let cacheItem;\n      if (textureCache.has(src, version)) {\n        if (this.currentSrcIsRetained) {\n          cacheItem = textureCache.get(src, version);\n        } else {\n          cacheItem = textureCache.retain(src, version);\n        }\n      } else {\n        const inflightKey = textureCache.key(src, version);\n\n        if (src === \"error\") {\n          cacheItem = errorCacheItem;\n        } else if (inflightTextures.has(inflightKey)) {\n          await inflightTextures.get(inflightKey);\n          cacheItem = textureCache.retain(src, version);\n        } else {\n          let promise;\n          if (contentType.includes(\"image/gif\")) {\n            promise = createGIFTexture(src);\n          } else if (contentType.includes(\"image/basis\")) {\n            promise = createBasisTexture(src);\n          } else if (contentType.includes(\"image/ktx2\")) {\n            promise = createKTX2Texture(src);\n          } else if (contentType.startsWith(\"image/\")) {\n            promise = createImageTexture(src);\n          } else {\n            throw new Error(`Unknown image content type: ${contentType}`);\n          }\n          inflightTextures.set(inflightKey, promise);\n          texture = await promise;\n          inflightTextures.delete(inflightKey);\n          cacheItem = textureCache.set(src, version, texture);\n        }\n\n        // No way to cancel promises, so if src has changed or this entity was removed while we were creating the texture just throw it away.\n        if (this.data.src !== src || this.data.version !== version || !this.el.parentNode) {\n          textureCache.release(src, version);\n          return;\n        }\n      }\n\n      texture = cacheItem.texture;\n      ratio = cacheItem.ratio;\n\n      this.currentSrcIsRetained = true;\n    } catch (e) {\n      console.error(\"Error loading image\", this.data.src, e);\n      texture = errorTexture;\n      this.currentSrcIsRetained = false;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n      material.toneMapped = false;\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n\n        // Flip uvs on the geometry\n        if (!texture.flipY) {\n          const uvs = geometry.attributes.uv.array;\n\n          for (let i = 1; i < uvs.length; i += 2) {\n            uvs[i] = 1 - uvs[i];\n          }\n        }\n      } else {\n        geometry = createPlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    if (texture == errorTexture) {\n      this.mesh.material.transparent = true;\n    } else {\n      // if transparency setting isnt explicitly defined, default to on for all gifs, and basis textures with alpha\n      switch (this.data.alphaMode) {\n        case \"opaque\":\n          this.mesh.material.transparent = false;\n          break;\n        case \"mask\":\n          this.mesh.material.transparent = false;\n          this.mesh.material.alphaTest = this.data.alphaCutoff;\n          break;\n        case \"blend\":\n        default:\n          this.mesh.material.transparent = true;\n          this.mesh.material.alphaTest = 0;\n      }\n    }\n\n    this.mesh.material.map = texture;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, ratio);\n    }\n\n    this.el.emit(\"image-loaded\", { src: this.data.src, projection: projection });\n  }\n});\n","import { disposeTexture } from \"./material-utils\";\n\nexport class TextureCache {\n  cache = new Map();\n\n  key(src, version) {\n    return `${src}_${version}`;\n  }\n\n  set(src, version, texture) {\n    const image = texture.image;\n    this.cache.set(this.key(src, version), {\n      texture,\n      ratio: (image.videoHeight || image.height) / (image.videoWidth || image.width),\n      count: 0\n    });\n    return this.retain(src, version);\n  }\n\n  has(src, version) {\n    return this.cache.has(this.key(src, version));\n  }\n\n  get(src, version) {\n    return this.cache.get(this.key(src, version));\n  }\n\n  retain(src, version) {\n    const cacheItem = this.cache.get(this.key(src, version));\n    cacheItem.count++;\n    // console.log(\"retain\", src, cacheItem.count);\n    return cacheItem;\n  }\n\n  release(src, version) {\n    const cacheItem = this.cache.get(this.key(src, version));\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached texture src ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    // console.log(\"release\", src, cacheItem.count);\n    if (cacheItem.count <= 0) {\n      // Unload the video element to prevent it from continuing to play in the background\n      disposeTexture(cacheItem.texture);\n      this.cache.delete(this.key(src, version));\n    }\n  }\n}\n","export const MAX_VOLUME_LABELS = 21;\nexport const MAX_GAIN_MULTIPLIER = 8;\nexport const SMALL_GAIN_STEP = 1 / (MAX_VOLUME_LABELS / 2);\nexport const SMALL_LEVEL_STEP = 1 / (MAX_GAIN_MULTIPLIER / 2);\nexport const BIG_GAIN_STEP = (MAX_GAIN_MULTIPLIER - 1) / (MAX_VOLUME_LABELS / 2);\nexport const BIG_LEVEL_STEP = 1;\nexport const DEFAULT_VOLUME_BAR_MULTIPLIER = 1.0;\n\nexport function calcGainStepUp(gainMultiplier) {\n  return gainMultiplier > 1 - SMALL_GAIN_STEP ? BIG_GAIN_STEP : SMALL_GAIN_STEP;\n}\n\nexport function calcGainStepDown(gainMultiplier) {\n  return gainMultiplier > 1 + SMALL_GAIN_STEP ? BIG_GAIN_STEP : SMALL_GAIN_STEP;\n}\n\nexport function calcLevel(gainMultiplier) {\n  return Math.min(\n    MAX_VOLUME_LABELS - 1,\n    gainMultiplier <= 1.001\n      ? Math.floor(gainMultiplier / SMALL_GAIN_STEP)\n      : Math.floor(MAX_VOLUME_LABELS / 2 + (gainMultiplier - 1) / BIG_GAIN_STEP)\n  );\n}\n\nexport function calcGainMultiplier(level) {\n  return Math.min(\n    MAX_GAIN_MULTIPLIER,\n    level <= MAX_VOLUME_LABELS / 2 ? level * SMALL_GAIN_STEP : 1 + (level - MAX_VOLUME_LABELS / 2) * BIG_GAIN_STEP\n  );\n}\n\nexport function updateAvatarVolumesPref(displayName, gainMultiplier, muted) {\n  const avatarVoiceLevels = APP.store.state.preferences.avatarVoiceLevels || {};\n  avatarVoiceLevels[displayName] = {\n    gainMultiplier,\n    muted\n  };\n  APP.store.update({\n    preferences: {\n      avatarVoiceLevels: avatarVoiceLevels\n    }\n  });\n}\n\nexport function getAvatarVolumePref(displayName) {\n  return APP.store.state.preferences.avatarVoiceLevels?.[displayName];\n}\n","import { updateAudioSettings } from \"../update-audio-settings\";\nimport { VOLUME_LABELS } from \"./media-video\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport {\n  calcLevel,\n  calcGainStepDown,\n  calcGainStepUp,\n  DEFAULT_VOLUME_BAR_MULTIPLIER,\n  MAX_GAIN_MULTIPLIER,\n  updateAvatarVolumesPref,\n  getAvatarVolumePref\n} from \"../utils/avatar-volume-utils\";\n\nAFRAME.registerComponent(\"avatar-volume-controls\", {\n  init() {\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.volumeUpButton = this.el.querySelector(\".avatar-volume-up-button\");\n    this.volumeDownButton = this.el.querySelector(\".avatar-volume-down-button\");\n    this.muteButton = this.el.querySelector(\".avatar-mute-button\");\n    this.volumeLabel = this.el.querySelector(\".avatar-volume-label\");\n    this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n    this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n    this.update = this.update.bind(this);\n    this.normalizer = null;\n    window.APP.store.addEventListener(\"statechanged\", this.update);\n    this.audioEl = this.el.parentEl.parentEl.querySelector(\"[avatar-audio-source]\");\n    this.playerInfo = findAncestorWithComponent(this.el, \"player-info\").components[\"player-info\"];\n    this.onRemoteMuteUpdated = this.onRemoteMuteUpdated.bind(this);\n    this.playerInfo.el.addEventListener(\"remote_mute_updated\", this.onRemoteMuteUpdated);\n    this.muteButton.object3D.visible = this.playerInfo.data.muted;\n    const volumePref = getAvatarVolumePref(this.playerInfo.displayName);\n    this.updateGainMultiplier(volumePref === undefined ? DEFAULT_VOLUME_BAR_MULTIPLIER : volumePref.gainMultiplier);\n    this.updateLocalMuted(volumePref === undefined ? false : volumePref.muted);\n  },\n  remove() {\n    APP.gainMultipliers.delete(this.audioEl);\n    window.APP.store.removeEventListener(\"statechanged\", this.update);\n    this.playerInfo.el.removeEventListener(\"remote_mute_updated\", this.onRemoteMuteUpdated);\n  },\n\n  updateGainMultiplier(gainMultiplier, updatePref = false) {\n    APP.gainMultipliers.set(this.audioEl, gainMultiplier);\n    const audio = APP.audios.get(this.audioEl);\n    if (audio) {\n      updateAudioSettings(this.audioEl, audio);\n    }\n    this.updateVolumeLabel();\n    this.el.emit(\"gain_multiplier_updated\", { gainMultiplier });\n    const isLocalMuted = APP.mutedState.has(this.audioEl);\n    updatePref && updateAvatarVolumesPref(this.playerInfo.displayName, gainMultiplier, isLocalMuted);\n  },\n\n  updateLocalMuted(muted, updatePref = false) {\n    if (muted === true) {\n      APP.mutedState.add(this.audioEl);\n    } else {\n      APP.mutedState.delete(this.audioEl);\n    }\n    const audio = APP.audios.get(this.audioEl);\n    if (audio) {\n      updateAudioSettings(this.audioEl, audio);\n    }\n    this.updateVolumeLabel();\n    this.el.emit(\"local_muted_updated\", { muted });\n    const gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const isLocalMuted = APP.mutedState.has(this.audioEl);\n    updatePref && updateAvatarVolumesPref(this.playerInfo.displayName, gainMultiplier, isLocalMuted);\n  },\n\n  volumeUp() {\n    let gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const step = calcGainStepUp(gainMultiplier);\n    gainMultiplier = THREE.MathUtils.clamp(gainMultiplier + step, 0, MAX_GAIN_MULTIPLIER);\n    this.updateGainMultiplier(gainMultiplier, true);\n  },\n\n  volumeDown() {\n    let gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const step = -calcGainStepDown(gainMultiplier);\n    gainMultiplier = THREE.MathUtils.clamp(gainMultiplier + step, 0, MAX_GAIN_MULTIPLIER);\n    this.updateGainMultiplier(gainMultiplier, true);\n  },\n\n  updateVolumeLabel() {\n    const gainMultiplier = APP.gainMultipliers.get(this.audioEl);\n    const isLocalMuted = APP.mutedState.has(this.audioEl);\n    const numBars = calcLevel(gainMultiplier);\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      gainMultiplier === 0 || isLocalMuted ? \"Muted\" : VOLUME_LABELS[numBars]\n    );\n  },\n\n  onRemoteMuteUpdated({ detail: { muted } }) {\n    if (!this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"mute_users\")) return;\n    this.muteButton.object3D.traverse(obj => {\n      obj.visible = !muted;\n    });\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"pinch-to-move\", {\n  schema: {\n    speed: { default: 0.25 }\n  },\n  init() {\n    this.axis = [0, 0];\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const pinch = userinput.get(paths.device.touchscreen.pinchDelta);\n    if (pinch) {\n      this.axis[1] = pinch * this.data.speed;\n      this.el.emit(\"move\", { axis: this.axis });\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst rotatePitchAndYaw = (function() {\n  const opq = new THREE.Quaternion();\n  const owq = new THREE.Quaternion();\n  const oq = new THREE.Quaternion();\n  const pq = new THREE.Quaternion();\n  const yq = new THREE.Quaternion();\n  const q = new THREE.Quaternion();\n  const right = new THREE.Vector3();\n  const v = new THREE.Vector3();\n  const UP = new THREE.Vector3(0, 1, 0);\n\n  return function rotatePitchAndYaw(o, p, y) {\n    o.parent.updateMatrices();\n    o.updateMatrices();\n    o.parent.getWorldQuaternion(opq);\n    o.getWorldQuaternion(owq);\n    oq.copy(o.quaternion);\n    v.set(0, 1, 0).applyQuaternion(oq);\n    const initialUpDot = v.dot(UP);\n    v.set(0, 0, 1).applyQuaternion(oq);\n    const initialForwardDotUp = Math.abs(v.dot(UP));\n    right.set(1, 0, 0).applyQuaternion(owq);\n    pq.setFromAxisAngle(right, p);\n    yq.setFromAxisAngle(UP, y);\n\n    q.copy(owq)\n      .premultiply(pq)\n      .premultiply(yq)\n      .premultiply(opq.invert());\n    v.set(0, 1, 0).applyQuaternion(q);\n    const newUpDot = v.dot(UP);\n    v.set(0, 0, 1).applyQuaternion(q);\n    const newForwardDotUp = Math.abs(v.dot(UP));\n    // Ensure our pitch is in an accepted range and our head would not be flipped upside down\n    if ((newForwardDotUp > 0.9 && newForwardDotUp > initialForwardDotUp) || (newUpDot < 0 && newUpDot < initialUpDot)) {\n      // TODO: Apply a partial rotation that does not exceed the bounds for nicer UX\n      return;\n    } else {\n      o.quaternion.copy(q);\n      o.matrixNeedsUpdate = true;\n      o.updateMatrices();\n    }\n  };\n})();\n\nlet uiRoot;\nlet scenePreviewNode;\nAFRAME.registerComponent(\"pitch-yaw-rotator\", {\n  init() {\n    this.pendingXRotation = 0;\n    this.el.sceneEl.addEventListener(\"rotateX\", e => {\n      this.pendingXRotation += e.detail;\n    });\n    this.on = true;\n  },\n\n  tick() {\n    if (this.on) {\n      const scene = AFRAME.scenes[0];\n      const userinput = scene.systems.userinput;\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\n      scenePreviewNode = scenePreviewNode || document.getElementById(\"scene-preview-node\");\n      const lobby = !scene.is(\"entered\");\n      const isGhost = lobby && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n      const cameraDelta = userinput.get(lobby ? paths.actions.lobbyCameraDelta : paths.actions.cameraDelta);\n      if (cameraDelta) {\n        rotatePitchAndYaw(\n          lobby && !isGhost ? scenePreviewNode.object3D : this.el.object3D,\n          this.pendingXRotation + cameraDelta[1],\n          cameraDelta[0]\n        );\n      } else if (this.pendingXRotation) {\n        rotatePitchAndYaw(lobby && !isGhost ? scenePreviewNode.object3D : this.el.object3D, this.pendingXRotation, 0);\n      }\n    }\n    this.pendingXRotation = 0;\n  }\n});\n","import { computeLocalBoundingBox } from \"../utils/auto-box-collider.js\";\nimport { setMatrixWorld } from \"../utils/three-utils\";\n\nconst MIN_SCALE = 0.05;\nconst MAX_SCALE = 4;\nconst ROTATE_Y = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0, 1, 0), Math.PI);\n\nconst updateFromLocalBB = (function() {\n  const currentPosition = new THREE.Vector3();\n  const currentScale = new THREE.Vector3();\n  return function updateFromLocalBB(object3D, localBox, center, halfExtents, offsetToCenter) {\n    object3D.updateMatrices();\n    const min = localBox.min;\n    const max = localBox.max;\n    center\n      .addVectors(min, max)\n      .multiplyScalar(0.5)\n      .applyMatrix4(object3D.matrixWorld);\n    currentScale.setFromMatrixScale(object3D.matrixWorld);\n    halfExtents\n      .subVectors(max, min)\n      .multiplyScalar(0.5)\n      .multiply(currentScale);\n    currentPosition.setFromMatrixPosition(object3D.matrixWorld);\n    offsetToCenter.subVectors(center, currentPosition);\n  };\n})();\n\nconst updateTargetRotationFromCamera = (function() {\n  const right = new THREE.Vector3();\n  const up = new THREE.Vector3();\n  const back = new THREE.Vector3();\n  const forward = new THREE.Vector3();\n  const rotation = new THREE.Matrix4();\n  return function updateTargetRotationFromCamera(\n    cameraPosition,\n    cameraRotation,\n    isVR,\n    vrFocalPoint,\n    desiredTargetQuaternion\n  ) {\n    if (!isVR) {\n      back\n        .set(0, 0, 1)\n        .applyMatrix4(cameraRotation)\n        .normalize();\n    } else {\n      back.subVectors(cameraPosition, vrFocalPoint).normalize();\n    }\n    up.set(0, 1, 0);\n    forward.copy(back).multiplyScalar(-1);\n    right.crossVectors(forward, up).normalize();\n    up.crossVectors(right, forward);\n    rotation.makeBasis(right, up, back);\n    desiredTargetQuaternion.setFromRotationMatrix(rotation);\n  };\n})();\n\nconst positionAtBorderComponents = [];\nAFRAME.registerComponent(\"position-at-border\", {\n  multiple: true,\n  schema: {\n    target: { type: \"string\" },\n    isFlat: { default: false },\n    animate: { default: true },\n    scale: { default: true }\n  },\n\n  init() {\n    this.ready = false;\n    this.didInit = false;\n    this.tick2 = this.tick2.bind(this);\n    this.doInit = this.doInit.bind(this);\n    positionAtBorderComponents.push(this);\n  },\n\n  doInit() {\n    this.didInit = true;\n    this.cam = document.getElementById(\"viewing-camera\").object3DMap.camera;\n    if (!this.data.target) {\n      console.error(\"No target for position-at-border on element:\", this.el);\n      return;\n    }\n    const targetEl = this.el.querySelector(this.data.target);\n    if (!targetEl) {\n      console.error(`Could not find ${this.data.target} underneath element:`, this.el);\n      return;\n    }\n    if (this.data.animate) {\n      this.didRegisterWithAnimationSystem = true;\n      this.el.sceneEl.systems[\"hubs-systems\"].menuAnimationSystem.register(this, targetEl, this.data.scale);\n    }\n    this.target = targetEl.object3D;\n    this.wasVisible = false;\n    this.previousMesh = null;\n    this.meshLocalBoundingBox = new THREE.Box3();\n    this.meshCenter = new THREE.Vector3();\n    this.meshHalfExtents = new THREE.Vector3();\n    this.meshOffsetToCenter = new THREE.Vector3();\n    this.isTargetBoundingBoxDirty = true;\n    this.targetLocalBoundingBox = new THREE.Box3();\n    this.targetCenter = new THREE.Vector3();\n    this.targetHalfExtents = new THREE.Vector3();\n    this.targetOffsetToCenter = new THREE.Vector3();\n    this.ready = true;\n  },\n\n  remove() {\n    if (this.didRegisterWithAnimationSystem) {\n      this.el.sceneEl.systems[\"hubs-systems\"].menuAnimationSystem.unregister(this);\n    }\n    positionAtBorderComponents.splice(positionAtBorderComponents.indexOf(this), 1);\n  },\n\n  markDirty() {\n    this.isTargetBoundingBoxDirty = true;\n  },\n\n  tick2: (function() {\n    const cameraPosition = new THREE.Vector3();\n    const cameraRotation = new THREE.Matrix4();\n    const centerToCamera = new THREE.Vector3();\n    const intersectionToCam = new THREE.Vector3();\n    const desiredCenterPoint = new THREE.Vector3();\n    const desiredTargetPosition = new THREE.Vector3();\n    const desiredTargetQuaternion = new THREE.Quaternion();\n    const currentTargetScale = new THREE.Vector3();\n    const desiredTargetScale = new THREE.Vector3();\n    const desiredTargetTransform = new THREE.Matrix4();\n    const centerToBorder = new THREE.Vector3();\n    const currentMeshRotation = new THREE.Matrix4();\n    const currentMeshScale = new THREE.Vector3();\n    const meshForward = new THREE.Vector3();\n    const boxCorners = new THREE.Vector3();\n    return function tick2() {\n      if (!this.didInit) {\n        this.doInit();\n      }\n      if (!this.ready) {\n        return;\n      }\n      const currentMesh = this.el.getObject3D(\"mesh\");\n      if (!currentMesh) {\n        return;\n      }\n      const isVisible = this.target.visible;\n      const isOpening = isVisible && !this.wasVisible;\n      this.wasVisible = isVisible;\n      if (!isOpening) {\n        return;\n      }\n      if (this.isTargetBoundingBoxDirty) {\n        computeLocalBoundingBox(this.target, this.targetLocalBoundingBox, true);\n        if (this.targetLocalBoundingBox.min.x === Infinity) {\n          // May be no visible elements in the target. Nothing to do in this case\n          return;\n        }\n        this.isTargetBoundingBoxDirty = false;\n      }\n      updateFromLocalBB(\n        this.target,\n        this.targetLocalBoundingBox,\n        this.targetCenter,\n        this.targetHalfExtents,\n        this.targetOffsetToCenter\n      );\n      const isMeshChanged = currentMesh !== this.previousMesh;\n      if (isMeshChanged) {\n        computeLocalBoundingBox(currentMesh, this.meshLocalBoundingBox, true);\n        this.previousMesh = currentMesh;\n      }\n      updateFromLocalBB(\n        currentMesh,\n        this.meshLocalBoundingBox,\n        this.meshCenter,\n        this.meshHalfExtents,\n        this.meshOffsetToCenter\n      );\n      currentMeshRotation.extractRotation(currentMesh.matrixWorld);\n      meshForward.set(0, 0, -1).applyMatrix4(currentMeshRotation);\n      this.cam.updateMatrices();\n      cameraPosition.setFromMatrixPosition(this.cam.matrixWorld);\n      cameraRotation.extractRotation(this.cam.matrixWorld);\n      centerToCamera.subVectors(cameraPosition, this.meshCenter);\n      const needsYRotate = this.data.isFlat && meshForward.dot(centerToCamera) > 0;\n      const intersection = this.el.sceneEl.systems.interaction.getActiveIntersection();\n      const meshSphereRadius =\n        boxCorners\n          .subVectors(this.meshLocalBoundingBox.max, this.meshLocalBoundingBox.min)\n          .multiply(currentMeshScale.setFromMatrixScale(currentMesh.matrixWorld))\n          .length() * 0.5;\n      if (this.data.isFlat) {\n        // Put in front of the flat media, on the side where the user is\n        desiredCenterPoint.copy(this.meshCenter).add(\n          centerToBorder\n            .set(0, 0, this.meshHalfExtents.z + this.targetHalfExtents.z + 0.02)\n            .multiplyScalar(needsYRotate ? -1 : 1)\n            .applyMatrix4(currentMeshRotation)\n        );\n      } else if (meshSphereRadius + 2 > centerToCamera.length()) {\n        // Inside the bounding sphere, put it close to the intersection, or close to the camera if there is no intersection\n        desiredCenterPoint.lerpVectors(\n          cameraPosition,\n          intersection ? intersection.point : this.meshCenter,\n          intersection ? 0.8 : 0.25\n        );\n      } else if (intersection) {\n        // Put it in the line towards the intersection, outside the bounding sphere\n        const distanceToSphere = centerToCamera.length() - meshSphereRadius;\n        intersectionToCam.subVectors(intersection.point, cameraPosition);\n        desiredCenterPoint.copy(cameraPosition).add(intersectionToCam.normalize().multiplyScalar(distanceToSphere));\n      } else {\n        // Put it on the bounding sphere\n        centerToCamera.normalize().multiplyScalar(meshSphereRadius);\n        desiredCenterPoint.copy(this.meshCenter).add(centerToCamera);\n      }\n      if (this.data.scale) {\n        const distanceToCenter = centerToCamera.subVectors(cameraPosition, desiredCenterPoint).length();\n        desiredTargetScale.setScalar(THREE.MathUtils.clamp(0.45 * distanceToCenter, MIN_SCALE, MAX_SCALE));\n      } else {\n        desiredTargetScale.setFromMatrixScale(this.target.matrixWorld);\n      }\n      if (this.data.scale) {\n        desiredTargetPosition\n          .copy(desiredCenterPoint)\n          .sub(\n            this.targetOffsetToCenter\n              .divide(currentTargetScale.setFromMatrixScale(this.target.matrixWorld))\n              .multiply(desiredTargetScale)\n          );\n      } else {\n        desiredTargetPosition.copy(this.meshCenter).add(\n          centerToBorder\n            .set(0, 0, this.meshHalfExtents.z + this.targetHalfExtents.z + 0.02)\n            .multiplyScalar(needsYRotate ? -1 : 1)\n            .applyMatrix4(currentMeshRotation)\n        );\n      }\n      if (this.data.isFlat) {\n        desiredTargetQuaternion.setFromRotationMatrix(currentMeshRotation);\n        if (needsYRotate) {\n          desiredTargetQuaternion.multiply(ROTATE_Y);\n        }\n      } else {\n        updateTargetRotationFromCamera(\n          cameraPosition,\n          cameraRotation,\n          this.el.sceneEl.is(\"vr-mode\"),\n          desiredTargetPosition,\n          desiredTargetQuaternion\n        );\n      }\n      desiredTargetTransform.compose(\n        desiredTargetPosition,\n        desiredTargetQuaternion,\n        desiredTargetScale\n      );\n      setMatrixWorld(this.target, desiredTargetTransform);\n    };\n  })()\n});\n\nexport class PositionAtBorderSystem {\n  constructor() {}\n  tick() {\n    for (let i = 0; i < positionAtBorderComponents.length; i++) {\n      positionAtBorderComponents[i].tick2();\n    }\n  }\n}\n","import { addComponent, removeComponent } from \"bitecs\";\nimport { Pinnable, Pinned } from \"../bit-components\";\n\nAFRAME.registerComponent(\"pinnable\", {\n  schema: {\n    pinned: { default: false }\n  },\n\n  init() {\n    this._persist = this._persist.bind(this);\n    this._persistAndAnimate = this._persistAndAnimate.bind(this);\n\n    // Persist when media is refreshed since the version will be bumped.\n    this.el.addEventListener(\"media_refreshed\", this._persistAndAnimate);\n\n    this.el.addEventListener(\"owned-pager-page-changed\", this._persist);\n\n    this.el.addEventListener(\"owned-video-state-changed\", this._persistAndAnimate);\n\n    addComponent(APP.world, Pinnable, this.el.object3D.eid);\n  },\n\n  update() {\n    this._animate();\n\n    if (this.data.pinned) {\n      addComponent(APP.world, Pinned, this.el.object3D.eid);\n    } else {\n      removeComponent(APP.world, Pinned, this.el.object3D.eid);\n    }\n  },\n\n  _persistAndAnimate() {\n    this._persist();\n    this._animate();\n  },\n\n  _persist() {\n    // Re-pin or unpin entity to reflect state changes.\n    window.APP.pinningHelper.setPinned(this.el, this.data.pinned);\n  },\n\n  _isMine() {\n    return this.el.components.networked?.data && NAF.utils.isMine(this.el);\n  },\n\n  _animate() {\n    const isAnimationRunning =\n      this.el.components[\"animation__pin-start\"]?.animationIsPlaying ||\n      this.el.components[\"animation__pin-end\"]?.animationIsPlaying;\n\n    if (this._isMine() && this.data.pinned && !isAnimationRunning) {\n      this.el.removeAttribute(\"animation__pin-start\");\n      this.el.removeAttribute(\"animation__pin-end\");\n      const currentScale = this.el.object3D.scale;\n\n      this.el.setAttribute(\"animation__pin-start\", {\n        property: \"scale\",\n        dur: 200,\n        from: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        to: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        easing: \"easeOutElastic\"\n      });\n\n      this.el.setAttribute(\"animation__pin-end\", {\n        property: \"scale\",\n        delay: 200,\n        dur: 200,\n        from: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        to: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        easing: \"easeOutElastic\"\n      });\n\n      if (this.el.components[\"body-helper\"] && !this.el.sceneEl.systems.interaction.isHeld(this.el)) {\n        this.el.setAttribute(\"body-helper\", { type: \"kinematic\" });\n      }\n    }\n  },\n\n  tick() {\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n    const isMine = this._isMine();\n\n    let didFireThisFrame = false;\n    if (!isHeld && this.wasHeld && isMine) {\n      didFireThisFrame = true;\n      this._persistAndAnimate();\n    }\n\n    this.wasHeld = isHeld;\n\n    this.transformObjectSystem = this.transformObjectSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n    const transforming = this.transformObjectSystem.transforming && this.transformObjectSystem.target.el === this.el;\n    if (!didFireThisFrame && !transforming && this.wasTransforming && isMine) {\n      this._persistAndAnimate();\n    }\n    this.wasTransforming = transforming;\n  }\n});\n","import { getPromotionTokenForFile } from \"../utils/media-utils\";\nimport { SOUND_PIN } from \"../systems/sound-effects-system\";\nimport { applyThemeToTextButton } from \"../utils/theme\";\n\nAFRAME.registerComponent(\"pin-networked-object-button\", {\n  schema: {\n    // Selector for label informing users about Discord bridging of pins.\n    tipSelector: { type: \"string\" },\n\n    // Selector for label to change when pinned/unpinned, must be sibling of this components element\n    labelSelector: { type: \"string\" }\n  },\n\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    this.tipEl = this.el.parentNode.querySelector(this.data.tipSelector);\n    this.labelEl = this.el.parentNode.querySelector(this.data.labelSelector);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n\n    this.onHovered = () => {\n      this.hovering = true;\n      this._updateUI();\n    };\n\n    this.onUnhovered = () => {\n      this.hovering = false;\n      this._updateUI();\n    };\n\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      const wasPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n      window.APP.pinningHelper.setPinned(this.targetEl, !wasPinned);\n      if (!wasPinned) {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PIN);\n      }\n    };\n\n    APP.store.addEventListener(\"themechanged\", this._updateUI);\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n    this.el.object3D.addEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.addEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n    this.el.object3D.removeEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _discordBridges() {\n    return window.APP.hubChannel.discordBridges();\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    const { fileIsOwned, fileId } = this.targetEl.components[\"media-loader\"].data;\n    const canPin =\n      window.APP.hubChannel.can(\"pin_objects\") && !!(fileIsOwned || (fileId && getPromotionTokenForFile(fileId)));\n    this.el.object3D.visible = canPin;\n    this.labelEl.object3D.visible = canPin;\n\n    const isPinned = this.targetEl.getAttribute(\"pinnable\") && this.targetEl.getAttribute(\"pinnable\").pinned;\n    const discordBridges = this._discordBridges();\n    this.tipEl.object3D.visible = !!(canPin && !isPinned && this.hovering && discordBridges.length > 0);\n\n    if (!canPin) return;\n    this.labelEl.setAttribute(\"text\", \"value\", isPinned ? \"un-pin\" : \"pin\");\n    applyThemeToTextButton(this.el, isPinned);\n  }\n});\n","import { cloneMedia } from \"../utils/media-utils\";\nimport { closeExistingMediaMirror } from \"../utils/media-utils\";\n\nAFRAME.registerComponent(\"mirror-media-button\", {\n  init() {\n    this.updateSrc = () => {\n      if (!this.targetEl.parentNode) return; // If removed\n      this.src = this.targetEl.components[\"media-loader\"].data.src;\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n\n    this.onClick = async () => {\n      const mirrorTarget = document.querySelector(\"#media-mirror-target\");\n\n      await closeExistingMediaMirror();\n\n      const { entity } = cloneMedia(this.targetEl, \"#linked-media\", this.src, false, true, mirrorTarget);\n\n      entity.object3D.scale.set(0.75, 0.75, 0.75);\n      entity.object3D.matrixNeedsUpdate = true;\n\n      mirrorTarget.parentEl.components[\"follow-in-fov\"].reset();\n      mirrorTarget.parentEl.object3D.visible = true;\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { closeExistingMediaMirror } from \"../utils/media-utils\";\n\nAFRAME.registerComponent(\"close-mirrored-media-button\", {\n  init() {\n    this.onClick = async () => {\n      this.el.object3D.visible = false; // Hide button immediately on click\n      await closeExistingMediaMirror();\n      this.el.object3D.visible = true;\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { defineQuery, hasComponent } from \"bitecs\";\nimport { $isStringType, NetworkedMediaFrame } from \"../bit-components\";\n\nconst queries = new Map();\nexport function anyEntityWith(world, component) {\n  if (!queries.has(component)) {\n    queries.set(component, defineQuery([component]));\n  }\n\n  const eids = queries.get(component)(world);\n  return eids.length && eids[0];\n}\n\nexport function hasAnyComponent(world, components, eid) {\n  for (let i = 0; i < components.length; i++) {\n    if (hasComponent(world, components[i], eid)) return true;\n  }\n  return false;\n}\n\n// TODO HACK gettting internal bitecs symbol, should expose createShadow\nconst $parentArray = Object.getOwnPropertySymbols(NetworkedMediaFrame.scale).find(s => s.description == \"parentArray\");\nconst $storeFlattened = Object.getOwnPropertySymbols(NetworkedMediaFrame).find(s => s.description == \"storeFlattened\");\n\nconst createShadow = (store, key) => {\n  if (!ArrayBuffer.isView(store)) {\n    const shadowStore = store[$parentArray].slice(0);\n    store[key] = store.map((_, eid) => {\n      const { length } = store[eid];\n      const start = length * eid;\n      const end = start + length;\n      return shadowStore.subarray(start, end);\n    });\n  } else {\n    store[key] = store.slice(0);\n  }\n  return key;\n};\n\n// TODO this array encoding is silly, use a buffer once we are not sending JSON\nexport function defineNetworkSchema(Component) {\n  const componentProps = Component[$storeFlattened];\n  const shadowSymbols = componentProps.map((prop, i) => {\n    return createShadow(prop, Symbol(`netshadow-${i}`));\n  });\n\n  return {\n    serialize(_world, eid, data, isFullSync = false) {\n      const changedPids = [];\n      data.push(changedPids);\n      for (let pid = 0; pid < componentProps.length; pid++) {\n        const prop = componentProps[pid];\n        const shadow = prop[shadowSymbols[pid]];\n        // if property is an array\n        if (ArrayBuffer.isView(prop[eid])) {\n          for (let i = 0; i < prop[eid].length; i++) {\n            if (isFullSync || shadow[eid][i] !== prop[eid][i]) {\n              changedPids.push(pid);\n              // TODO handle EID type and arrays of strings\n              data.push(Array.from(prop[eid]));\n              break;\n            }\n          }\n          if (!isFullSync) shadow[eid].set(prop[eid]);\n        } else {\n          if (isFullSync || shadow[eid] !== prop[eid]) {\n            changedPids.push(pid);\n            // TODO handle EID type\n            data.push(prop[$isStringType] ? APP.getString(prop[eid]) : prop[eid]);\n          }\n          if (!isFullSync) shadow[eid] = prop[eid];\n        }\n      }\n      if (!changedPids.length) {\n        data.pop();\n        return false;\n      }\n      return true;\n    },\n    deserialize(_world, eid, data) {\n      const updatedPids = data[data.cursor++];\n      for (let i = 0; i < updatedPids.length; i++) {\n        const pid = updatedPids[i];\n        const prop = componentProps[pid];\n        const shadow = prop[shadowSymbols[pid]];\n        // TODO updating the shadow here is slightly odd. Should taking ownership do it?\n        if (ArrayBuffer.isView(prop[eid])) {\n          prop[eid].set(data[data.cursor++]);\n          shadow[eid].set(prop[eid]);\n        } else {\n          const val = data[data.cursor++];\n          prop[eid] = prop[$isStringType] ? APP.getSid(val) : val;\n          shadow[eid] = prop[eid];\n        }\n      }\n    }\n  };\n}\n","import { CameraTool, MyCameraTool } from \"../bit-components\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\nimport { findComponentsInNearestAncestor } from \"../utils/scene-graph\";\n\nconst tmpPos = new THREE.Vector3();\nAFRAME.registerComponent(\"camera-focus-button\", {\n  schema: {\n    track: { default: false },\n    selector: { default: null }\n  },\n\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      if (this.data.selector) {\n        this.targetEl = networkedEl.querySelector(this.data.selector);\n      } else {\n        this.targetEl = networkedEl;\n      }\n    });\n\n    this.onClick = () => {\n      const myCam = anyEntityWith(APP.world, MyCameraTool);\n      if (!myCam) return;\n\n      if (this.data.track) {\n        const tracking = CameraTool.trackTarget[myCam];\n        CameraTool.trackTarget[myCam] = tracking === this.targetEl.eid ? 0 : this.targetEl.eid;\n      } else {\n        this.targetEl.object3D.getWorldPosition(tmpPos);\n        APP.world.eid2obj.get(myCam).lookAt(tmpPos);\n      }\n    };\n\n    this.menuPlacementRoots = findComponentsInNearestAncestor(this.el, \"position-at-border\");\n  },\n\n  tick() {\n    const isVisible = this.el.object3D.visible;\n    const shouldBeVisible = !!anyEntityWith(APP.world, MyCameraTool);\n    if (isVisible !== shouldBeVisible) {\n      this.el.object3D.visible = shouldBeVisible;\n      for (let i = 0; i < this.menuPlacementRoots.length; i++) {\n        this.menuPlacementRoots[i].markDirty();\n      }\n    }\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nAFRAME.registerComponent(\"unmute-video-button\", {\n  init() {\n    this.onClick = () => {\n      const videoEl = findAncestorWithComponent(this.el, \"media-video\");\n      const mediaVideo = videoEl.components[\"media-video\"];\n      if (!mediaVideo || !mediaVideo.video || !mediaVideo.videoMutedAt) return;\n\n      // iOS initially plays the sound and *then* mutes it, and sometimes a second video playing\n      // can break all sound in the app. (Likely a Safari bug.) Adding a delay before the unmute\n      // occurs seems to help with reducing this.\n      if (performance.now() - mediaVideo.videoMutedAt < 3000) {\n        return;\n      }\n\n      if (mediaVideo.video.muted) {\n        mediaVideo.video.muted = false;\n        this.el.setAttribute(\"visible\", false);\n      }\n    };\n  },\n\n  play() {\n    // Safari won't accept grab-start or even mousedown as user-initiated gestures,\n    // so we have to use a global touchstart event here.\n    document.addEventListener(\"touchstart\", this.onClick);\n  },\n\n  pause() {\n    document.removeEventListener(\"touchstart\", this.onClick);\n  }\n});\n","import { cloneMedia } from \"../utils/media-utils\";\nimport { guessContentType } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"clone-media-button\", {\n  init() {\n    this.updateSrc = () => {\n      if (!this.targetEl.parentNode) return; // If removed\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      this.el.object3D.visible = !!visible;\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n\n    this.onClick = () => {\n      const { entity } = cloneMedia(this.targetEl, \"#interactable-media\", this.src);\n\n      entity.object3D.scale.copy(this.targetEl.object3D.scale);\n      entity.object3D.matrixNeedsUpdate = true;\n\n      entity.setAttribute(\"offset-relative-to\", {\n        target: \"#avatar-pov-node\",\n        offset: { x: 0, y: 0, z: -1.5 * this.targetEl.object3D.scale.z }\n      });\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import screenfull from \"screenfull\";\nimport { isIOS } from \"./is-mobile\";\n\nlet hasEnteredFullScreenThisSession = false;\n\nfunction shouldShowFullScreen() {\n  // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n  return (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) && !isIOS() && screenfull.enabled;\n}\n\nexport function willRequireUserGesture() {\n  return !screenfull.isFullscreen && shouldShowFullScreen();\n}\n\nexport async function showFullScreenIfAvailable() {\n  if (shouldShowFullScreen() && !screenfull.isFullscreen) {\n    hasEnteredFullScreenThisSession = true;\n    await screenfull.request();\n  }\n}\n\nexport async function showFullScreenIfWasFullScreen() {\n  if (hasEnteredFullScreenThisSession && !screenfull.isFullscreen) {\n    await screenfull.request();\n  }\n}\n","import { willRequireUserGesture, showFullScreenIfAvailable } from \"./fullscreen\";\nimport screenfull from \"screenfull\";\n\nlet _isIn2DInterstitial = false;\nlet _exitAction = null;\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst getUserGesture = () => {\n  return new Promise(resolve => {\n    const scene = document.querySelector(\"a-scene\");\n    scene.addEventListener(\"2d-interstitial-gesture-complete\", resolve, { once: true });\n    scene.emit(\"2d-interstitial-gesture-required\");\n  });\n};\n\nexport async function handleExitTo2DInterstitial(isLower, exitAction, nonFullscreen) {\n  const scene = document.querySelector(\"a-scene\");\n  if (!scene.is(\"vr-mode\")) {\n    if (isMobileVR && willRequireUserGesture()) {\n      await getUserGesture();\n      await showFullScreenIfAvailable();\n    }\n\n    return;\n  }\n\n  _isIn2DInterstitial = true;\n  _exitAction = exitAction;\n\n  if (isMobileVR) {\n    await scene.exitVR();\n\n    if (!nonFullscreen) {\n      await getUserGesture();\n      await showFullScreenIfAvailable();\n    }\n  } else {\n    // Non-immersive browser, show notice\n    const vrNotice = document.querySelector(\".vr-notice\");\n    vrNotice.object3D.visible = true;\n    vrNotice.setAttribute(\"follow-in-fov\", {\n      angle: isLower ? 39 : -15\n    });\n  }\n}\n\nexport async function exit2DInterstitialAndEnterVR(force) {\n  if (!force && !_isIn2DInterstitial) {\n    return;\n  }\n\n  _isIn2DInterstitial = false;\n\n  document.querySelector(\".vr-notice\").object3D.visible = false;\n\n  const scene = document.querySelector(\"a-scene\");\n\n  if (isMobileVR) {\n    if (screenfull.isFullscreen) {\n      await screenfull.exit();\n      await getUserGesture();\n      await scene.enterVR();\n    } else {\n      await scene.enterVR();\n    }\n  } else {\n    if (!scene.is(\"vr-mode\")) {\n      await scene.enterVR();\n    }\n  }\n}\n\nexport function isIn2DInterstitial() {\n  return _isIn2DInterstitial;\n}\n\nexport async function forceExitFrom2DInterstitial() {\n  if (!_isIn2DInterstitial) return;\n\n  if (_exitAction) {\n    _exitAction();\n    _exitAction = null;\n  }\n\n  await exit2DInterstitialAndEnterVR();\n}\n","import { isLocalHubsUrl, isLocalHubsSceneUrl, isHubsRoomUrl, isLocalHubsAvatarUrl } from \"../utils/media-url-utils\";\nimport { guessContentType } from \"../utils/media-url-utils\";\nimport { handleExitTo2DInterstitial } from \"../utils/vr-interstitial\";\nimport { changeHub } from \"../change-hub\";\n\nAFRAME.registerComponent(\"open-media-button\", {\n  schema: {\n    onlyOpenLink: { type: \"boolean\" }\n  },\n  init() {\n    this.label = this.el.querySelector(\"[text]\");\n\n    this.updateSrc = async () => {\n      if (!this.targetEl.parentNode) return; // If removed\n      const mediaLoader = this.targetEl.components[\"media-loader\"].data;\n      const src = (this.src = (mediaLoader.mediaOptions && mediaLoader.mediaOptions.href) || mediaLoader.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      this.el.object3D.visible = !!visible;\n\n      if (visible) {\n        let label = \"open link\";\n        if (!this.data.onlyOpenLink) {\n          let hubId;\n          if (await isLocalHubsAvatarUrl(src)) {\n            label = \"use avatar\";\n          } else if ((await isLocalHubsSceneUrl(src)) && mayChangeScene) {\n            label = \"use scene\";\n          } else if ((hubId = await isHubsRoomUrl(src))) {\n            const url = new URL(src);\n            if (url.hash && window.APP.hub.hub_id === hubId) {\n              label = \"go to\";\n            } else {\n              label = \"visit room\";\n            }\n          }\n        }\n        this.label.setAttribute(\"text\", \"value\", label);\n      }\n    };\n\n    this.onClick = async () => {\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      const exitImmersive = async () => await handleExitTo2DInterstitial(false, () => {}, true);\n\n      let hubId;\n      if (this.data.onlyOpenLink) {\n        await exitImmersive();\n        window.open(this.src);\n      } else if (await isLocalHubsAvatarUrl(this.src)) {\n        const avatarId = new URL(this.src).pathname.split(\"/\").pop();\n        window.APP.store.update({ profile: { avatarId } });\n        this.el.sceneEl.emit(\"avatar_updated\");\n      } else if ((await isLocalHubsSceneUrl(this.src)) && mayChangeScene) {\n        this.el.sceneEl.emit(\"scene_media_selected\", this.src);\n      } else if ((hubId = await isHubsRoomUrl(this.src))) {\n        const url = new URL(this.src);\n        if (url.hash && window.APP.hub.hub_id === hubId) {\n          // move to waypoint w/o writing to history\n          window.history.replaceState(null, null, window.location.href.split(\"#\")[0] + url.hash);\n        } else if (APP.store.state.preferences.fastRoomSwitching && isLocalHubsUrl(this.src)) {\n          // move to new room without page load or entry flow\n          changeHub(hubId);\n        } else {\n          await exitImmersive();\n          location.href = this.src;\n        }\n      } else {\n        await exitImmersive();\n        window.open(this.src);\n      } \n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n  },\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { SOUND_MEDIA_LOADING } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"local-refresh-media-button\", {\n  init() {\n    this.onClick = async () => {\n      if (this.targetEl) {\n        const c = this.targetEl.components;\n        // If an HLS stream is loaded, refresh directly with HLS.js\n        if (c[\"media-video\"] && c[\"media-video\"].videoTexture && c[\"media-video\"].videoTexture.hls) {\n          c[\"media-video\"].videoTexture.hls.recoverMediaError();\n        } else if (c[\"media-loader\"]) {\n          // Otherwise fall back to hard resolve-level refresh which should work for any media\n          c[\"media-loader\"].update(c[\"media-loader\"].data, true);\n        }\n      }\n    };\n\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => (this.targetEl = networkedEl))\n      .catch(() => this.el.parentNode.removeChild(this.el));\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n\nAFRAME.registerComponent(\"refresh-media-button\", {\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n\n    this.onClick = async () => {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n\n      if (this.targetEl) {\n        this.targetEl.components[\"media-loader\"].refresh();\n\n        // Hide button + do the sound effect here, so only the person who clicked hears it, not everyone.\n        this.el.object3D.visible = false;\n        const loadingSoundEffect = sfx.playPositionalSoundFollowing(SOUND_MEDIA_LOADING, this.targetEl.object3D, true);\n\n        this.targetEl.addEventListener(\n          \"media_refreshed\",\n          () => {\n            sfx.stopPositionalAudio(loadingSoundEffect);\n            this.el.object3D.visible = true;\n            this.updateVisibility();\n          },\n          { once: true }\n        );\n      }\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\n\n      if (this.targetEl) {\n        this.targetEl.addEventListener(\"pinned\", this.updateVisibility);\n        this.targetEl.addEventListener(\"unpinned\", this.updateVisibility);\n      }\n\n      this.updateVisibility();\n    });\n  },\n\n  updateVisibility() {\n    if (!this.targetEl) return;\n\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n    this.el.object3D.visible =\n      (!isPinned && window.APP.hubChannel.can(\"spawn_and_move_media\")) || window.APP.hubChannel.can(\"pin_objects\");\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  remove() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this.updateVisibility);\n      this.targetEl.removeEventListener(\"unpinned\", this.updateVisibility);\n    }\n  }\n});\n","import configs from \"../utils/configs\";\n\nAFRAME.registerComponent(\"tweet-media-button\", {\n  init() {\n    NAF.utils\n      .getNetworkedEntity(this.el)\n      .then(networkedEl => {\n        this.targetEl = networkedEl;\n      })\n      .catch(() => {\n        // Non-networked, do not handle for now, and hide button.\n        this.el.object3D.visible = false;\n      });\n\n    this.onClick = () => {\n      const initialTweet = `Taken in ${location.hostname} `;\n\n      const { src, contentSubtype } = this.targetEl.components[\"media-loader\"].data;\n      this.el.sceneEl.emit(\"action_media_tweet\", { mediaUrl: src, contentSubtype, initialTweet });\n    };\n  },\n\n  play() {\n    if (!configs.integration(\"twitter\")) {\n      this.el.object3D.visible = false;\n      return;\n    }\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { idForAvatarUrl } from \"../utils/media-url-utils\";\nimport { fetchAvatar, remixAvatar } from \"../utils/avatar-utils\";\n\nconst REMIX_LABEL = \"save avatar\";\nAFRAME.registerComponent(\"remix-avatar-button\", {\n  init() {\n    this.label = this.el.querySelector(\"[text]\");\n    this.label.setAttribute(\"text\", \"value\", REMIX_LABEL);\n    this.updateSrc = async () => {\n      this.src = this.targetEl.components[\"media-loader\"].data.src;\n      try {\n        this.avatar = await fetchAvatar(idForAvatarUrl(this.src));\n        this.el.object3D.visible = this.avatar && this.avatar.allow_remixing && this.avatar.type === \"avatar_listing\";\n      } catch (e) {\n        console.error(e);\n        this.el.object3D.visible = false;\n      }\n    };\n\n    this.onClick = async () => {\n      if (this.copying || !this.avatar) return;\n\n      try {\n        this.copying = true;\n        this.label.setAttribute(\"text\", \"value\", \"Saving...\");\n\n        await remixAvatar(this.avatar.avatar_id, this.avatar.name);\n\n        this.label.setAttribute(\"text\", \"value\", \"Saved!\");\n      } catch (e) {\n        this.label.setAttribute(\"text\", \"value\", \"Error\");\n      }\n\n      setTimeout(() => {\n        this.label.setAttribute(\"text\", \"value\", REMIX_LABEL);\n        this.copying = false;\n      }, 2000);\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst AMMO_BODY_ATTRIBUTES = { type: \"kinematic\", collisionFilterMask: COLLISION_LAYERS.HANDS };\n\nexport const TRANSFORM_MODE = {\n  AXIS: \"axis\",\n  PUPPET: \"puppet\",\n  CURSOR: \"cursor\",\n  ALIGN: \"align\",\n  SCALE: \"scale\"\n};\n\nconst STEP_LENGTH = Math.PI / 10;\nconst CAMERA_WORLD_QUATERNION = new THREE.Quaternion();\nconst CAMERA_WORLD_POSITION = new THREE.Vector3();\nconst TARGET_WORLD_QUATERNION = new THREE.Quaternion();\nconst v = new THREE.Vector3();\nconst v2 = new THREE.Vector3();\nconst q = new THREE.Quaternion();\nconst q2 = new THREE.Quaternion();\n\nconst eps = 0.001;\nfunction qAlmostEquals(a, b) {\n  return (\n    Math.abs(a.x - b.x) < eps && Math.abs(a.y - b.y) < eps && Math.abs(a.z - b.z) < eps && Math.abs(a.w - b.w) < eps\n  );\n}\n\nAFRAME.registerComponent(\"transform-button\", {\n  schema: {\n    mode: {\n      type: \"string\",\n      oneof: Object.values(TRANSFORM_MODE),\n      default: TRANSFORM_MODE.CURSOR\n    },\n    axis: { type: \"vec3\", default: null }\n  },\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n    let leftHand, rightHand;\n\n    waitForDOMContentLoaded().then(() => {\n      leftHand = document.getElementById(\"player-left-controller\");\n      rightHand = document.getElementById(\"player-right-controller\");\n    });\n    this.onGrabStart = e => {\n      if (!leftHand || !rightHand) return;\n\n      if (!this.targetEl) {\n        return;\n      }\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) {\n        return;\n      }\n      if (this.targetEl.body) {\n        this.targetEl.setAttribute(\"body-helper\", AMMO_BODY_ATTRIBUTES);\n      }\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.startTransform(\n        this.targetEl.object3D,\n        e.object3D.el.id === \"right-cursor\"\n          ? rightHand.object3D\n          : e.object3D.el.id === \"left-cursor\"\n            ? leftHand.object3D\n            : e.object3D,\n        this.data\n      );\n    };\n    this.onGrabEnd = () => {\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.stopTransform();\n    };\n  },\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.onGrabEnd);\n  },\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-up\", this.onGrabEnd);\n  }\n});\n\nAFRAME.registerSystem(\"transform-selected-object\", {\n  init() {\n    this.target = null;\n    this.mode = null;\n    this.transforming = false;\n    this.axis = new THREE.Vector3();\n    this.store = window.APP.store;\n    this.startQ = new THREE.Quaternion();\n\n    this.dxStore = 0;\n    this.dxApplied = 0;\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n    this.raycasters = {};\n\n    this.puppet = {\n      initialControllerOrientation: new THREE.Quaternion(),\n      initialControllerOrientation_inverse: new THREE.Quaternion(),\n      initialObjectOrientation: new THREE.Quaternion(),\n      currentControllerOrientation: new THREE.Quaternion(),\n      controllerOrientationDelta: new THREE.Quaternion()\n    };\n\n    this.planarInfo = {\n      plane: new THREE.Mesh(\n        new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n        new THREE.MeshBasicMaterial({\n          visible: false,\n          wireframe: true,\n          side: THREE.DoubleSide,\n          transparent: true,\n          opacity: 0.3\n        })\n      ),\n      normal: new THREE.Vector3(),\n      intersections: [],\n      previousPointOnPlane: new THREE.Vector3(),\n      currentPointOnPlane: new THREE.Vector3(),\n      deltaOnPlane: new THREE.Vector3(),\n      finalProjectedVec: new THREE.Vector3()\n    };\n    this.el.object3D.add(this.planarInfo.plane);\n  },\n\n  stopTransform: (function() {\n    const q = new THREE.Quaternion();\n    const PI_AROUND_Y = new THREE.Quaternion(0, 1, 0, 0);\n    const pInv = new THREE.Quaternion();\n    return function stopTransform() {\n      this.transforming = false;\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\n        this.target.getWorldQuaternion(q);\n        if (qAlmostEquals(q, this.startQ)) {\n          q.multiply(PI_AROUND_Y);\n          this.target.parent.getWorldQuaternion(pInv);\n          pInv.invert();\n          this.target.quaternion.copy(pInv).multiply(q);\n          this.target.matrixNeedsUpdate = true;\n        }\n      }\n    };\n  })(),\n\n  startPlaneCasting() {\n    const { plane, intersections, previousPointOnPlane } = this.planarInfo;\n\n    this.el.camera.getWorldQuaternion(CAMERA_WORLD_QUATERNION);\n    plane.quaternion.copy(CAMERA_WORLD_QUATERNION);\n    this.target.getWorldPosition(plane.position);\n    plane.matrixNeedsUpdate = true;\n    plane.updateMatrixWorld(true);\n\n    intersections.length = 0;\n    this.raycasters.right =\n      this.raycasters.right ||\n      document.getElementById(\"right-cursor-controller\").components[\"cursor-controller\"].raycaster;\n    this.raycasters.left =\n      this.raycasters.left ||\n      document.getElementById(\"left-cursor-controller\").components[\"cursor-controller\"].raycaster;\n    const raycaster = this.hand.el.id === \"player-left-controller\" ? this.raycasters.left : this.raycasters.right;\n    const far = raycaster.far;\n    raycaster.far = 1000;\n    plane.raycast(raycaster, intersections);\n    raycaster.far = far;\n    this.transforming = !!intersections[0];\n    if (!this.transforming) {\n      return;\n    }\n\n    previousPointOnPlane.copy(intersections[0].point);\n\n    this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n\n    v.set(0, 0, -1).applyQuaternion(CAMERA_WORLD_QUATERNION);\n    v2.set(0, 0, -1).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign = v.dot(v2) > 0 ? 1 : -1;\n\n    v.set(0, 1, 0); //.applyQuaternion(this.CAMERA_WORLD_QUATERNION);\n    v2.set(0, 1, 0).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign2 = v.dot(v2) > 0 ? 1 : -1;\n\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n    this.dxAll = 0;\n    this.dxStore = 0;\n    this.dxApplied = 0;\n  },\n\n  startTransform(target, hand, data) {\n    this.target = target;\n    this.hand = hand;\n    this.mode = data.mode;\n    this.transforming = true;\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.store.update({ activity: { hasRecentered: true } });\n      return;\n    } else {\n      this.store.update({ activity: { hasRotated: true } });\n    }\n\n    if (this.mode === TRANSFORM_MODE.CURSOR) {\n      this.target.getWorldQuaternion(this.startQ);\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.target.getWorldQuaternion(this.puppet.initialObjectOrientation);\n      this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation);\n      this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).invert();\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.axis.copy(data.axis);\n    }\n\n    this.startPlaneCasting();\n  },\n\n  puppetingTick() {\n    const {\n      currentControllerOrientation,\n      controllerOrientationDelta,\n      initialControllerOrientation_inverse,\n      initialObjectOrientation\n    } = this.puppet;\n    this.hand.getWorldQuaternion(currentControllerOrientation);\n    controllerOrientationDelta.copy(initialControllerOrientation_inverse).premultiply(currentControllerOrientation);\n    this.target.quaternion\n      .copy(initialObjectOrientation)\n      .premultiply(controllerOrientationDelta)\n      .premultiply(controllerOrientationDelta);\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  cursorAxisOrScaleTick() {\n    const {\n      plane,\n      normal,\n      intersections,\n      previousPointOnPlane,\n      currentPointOnPlane,\n      deltaOnPlane,\n      finalProjectedVec\n    } = this.planarInfo;\n    this.target.getWorldPosition(plane.position);\n    //    this.el.camera.getWorldQuaternion(plane.quaternion);\n    this.el.camera.getWorldPosition(v);\n    plane.matrixNeedsUpdate = true;\n    const cameraToPlaneDistance = v.sub(plane.position).length();\n\n    intersections.length = 0;\n    const raycaster = this.hand.el.id === \"player-left-controller\" ? this.raycasters.left : this.raycasters.right;\n    const far = raycaster.far;\n    raycaster.far = 1000;\n    plane.raycast(raycaster, intersections);\n    raycaster.far = far;\n    const intersection = intersections[0];\n    if (!intersection) return;\n\n    normal.set(0, 0, -1).applyQuaternion(plane.quaternion);\n\n    currentPointOnPlane.copy(intersection.point);\n    deltaOnPlane.copy(currentPointOnPlane).sub(previousPointOnPlane);\n    const SENSITIVITY = 10;\n    finalProjectedVec\n      .copy(deltaOnPlane)\n      .projectOnPlane(normal)\n      .applyQuaternion(q.copy(plane.quaternion).invert())\n      .multiplyScalar(SENSITIVITY / cameraToPlaneDistance);\n    if (this.mode === TRANSFORM_MODE.CURSOR) {\n      const modify = !AFRAME.scenes[0].systems.userinput.get(paths.actions.transformModifier);\n\n      this.dyAll = this.dyStore + finalProjectedVec.y;\n      this.dyApplied = modify ? this.dyAll : Math.round(this.dyAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dyStore = this.dyAll - this.dyApplied;\n\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = modify ? this.dxAll : Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\n        this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n        v.set(1, 0, 0).applyQuaternion(modify ? CAMERA_WORLD_QUATERNION : TARGET_WORLD_QUATERNION);\n        q.setFromAxisAngle(v, modify ? -this.dyApplied : this.sign2 * this.sign * -this.dyApplied);\n\n        if (modify) {\n          v.set(0, 1, 0).applyQuaternion(CAMERA_WORLD_QUATERNION);\n        } else {\n          v.set(0, 1, 0);\n        }\n        q2.setFromAxisAngle(v, this.dxApplied);\n\n        this.target.quaternion.premultiply(q).premultiply(q2);\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    } else if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      this.target.quaternion.multiply(q.setFromAxisAngle(this.axis, -this.sign * this.dxApplied));\n      this.target.matrixNeedsUpdate = true;\n    }\n\n    previousPointOnPlane.copy(currentPointOnPlane);\n  },\n\n  tick() {\n    if (!this.transforming) {\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.SCALE) {\n      return; // Taken care of by scale-button\n    }\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.el.camera.getWorldPosition(CAMERA_WORLD_POSITION);\n      this.target.lookAt(CAMERA_WORLD_POSITION);\n      this.transforming = false;\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.puppetingTick();\n      return;\n    }\n    this.cursorAxisOrScaleTick();\n  }\n});\n\nAFRAME.registerComponent(\"transform-button-selector\", {\n  tick() {\n    this.userinput = this.userinput || this.el.sceneEl.systems.userinput;\n    const hasHand = this.userinput.get(paths.actions.rightHand.pose) || this.userinput.get(paths.actions.leftHand.pose);\n    if (!hasHand) {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.CURSOR) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.CURSOR);\n      }\n    } else {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.PUPPET) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.PUPPET);\n      }\n    }\n  }\n});\n\nconst FORWARD = new THREE.Vector3(0, 0, 1);\nconst TWO_PI = 2 * Math.PI;\nAFRAME.registerComponent(\"visible-if-transforming\", {\n  schema: {\n    hand: { type: \"string\" }\n  },\n  init() {},\n  tick(t) {\n    const shouldBeVisible =\n      AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming &&\n      AFRAME.scenes[0].systems[\"transform-selected-object\"].hand.el.id.indexOf(this.data.hand) !== -1;\n    const visibleNeedsUpdate = this.el.getAttribute(\"visible\") !== shouldBeVisible;\n    if (visibleNeedsUpdate) {\n      this.el.setAttribute(\"visible\", AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming);\n    }\n\n    if (shouldBeVisible) {\n      this.el.object3D.quaternion.setFromAxisAngle(FORWARD, TWO_PI * Math.sin(t / 1000.0));\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n  }\n});\n","import { setMatrixWorld } from \"../utils/three-utils\";\nimport { TRANSFORM_MODE } from \"./transform-object-button\";\n\nconst calculatePlaneMatrix = (function() {\n  const planeMatrix = new THREE.Matrix4();\n  const planeUp = new THREE.Vector3();\n  const planeForward = new THREE.Vector3();\n  const planeRight = new THREE.Vector3();\n  const planePosition = new THREE.Vector3();\n  const camPosition = new THREE.Vector3();\n\n  return function calculatePlaneMatrix(camera, button) {\n    camera.updateMatrices();\n    camPosition.setFromMatrixPosition(camera.matrixWorld);\n    button.updateMatrices();\n    planePosition.setFromMatrixPosition(button.matrixWorld);\n    planeForward.subVectors(planePosition, camPosition);\n    planeForward.y = 0;\n    planeForward.normalize();\n    planeUp.set(0, 1, 0);\n    planeRight.crossVectors(planeForward, planeUp);\n    planeMatrix.makeBasis(planeRight, planeUp, planeForward.multiplyScalar(-1));\n    planeMatrix.elements[12] = planePosition.x;\n    planeMatrix.elements[13] = planePosition.y;\n    planeMatrix.elements[14] = planePosition.z;\n    return planeMatrix;\n  };\n})();\n\nconst planeForLeftCursor = new THREE.Mesh(\n  new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n  new THREE.MeshBasicMaterial({\n    visible: true,\n    wireframe: false,\n    side: THREE.DoubleSide,\n    transparent: true,\n    opacity: 0.3\n  })\n);\nconst planeForRightCursor = new THREE.Mesh(\n  new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n  new THREE.MeshBasicMaterial({\n    visible: true,\n    wireframe: false,\n    side: THREE.DoubleSide,\n    transparent: true,\n    opacity: 0.3\n  })\n);\n\nAFRAME.registerComponent(\"scale-button\", {\n  init() {\n    this.isScaling = false;\n    this.planeRotation = new THREE.Matrix4();\n    this.planeUp = new THREE.Vector3();\n    this.planeRight = new THREE.Vector3();\n    this.intersections = [];\n    this.initialIntersectionPoint = new THREE.Vector3();\n    this.intersectionPoint = new THREE.Vector3();\n    this.initialObjectScale = new THREE.Vector3();\n    this.desiredObjectScale = new THREE.Vector3();\n    this.deltaScale = new THREE.Vector3();\n    this.objectMatrix = new THREE.Matrix4();\n    this.dragVector = new THREE.Vector3();\n    this.currentObjectScale = new THREE.Vector3();\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n      this.objectToScale = networkedEl.object3D;\n    });\n    const camPosition = new THREE.Vector3();\n    const objectPosition = new THREE.Vector3();\n    const objectToCam = new THREE.Vector3();\n    this.startScaling = e => {\n      if (this.isScaling || !this.objectToScale) {\n        return;\n      }\n\n      if (!(NAF.utils.isMine(this.networkedEl) || NAF.utils.takeOwnership(this.networkedEl))) {\n        return;\n      }\n\n      if (!this.didGetObjectReferences) {\n        this.didGetObjectReferences = true;\n        this.leftEventer = document.getElementById(\"left-cursor\").object3D;\n        this.leftCursorController = document.getElementById(\"left-cursor-controller\");\n        this.leftRaycaster = this.leftCursorController.components[\"cursor-controller\"].raycaster;\n        this.rightCursorController = document.getElementById(\"right-cursor-controller\");\n        this.rightRaycaster = this.rightCursorController.components[\"cursor-controller\"].raycaster;\n        this.viewingCamera = document.getElementById(\"viewing-camera\").object3DMap.camera;\n      }\n      this.plane = e.object3D === this.leftEventer ? planeForLeftCursor : planeForRightCursor;\n      setMatrixWorld(this.plane, calculatePlaneMatrix(this.viewingCamera, this.el.object3D));\n      this.planeRotation.extractRotation(this.plane.matrixWorld);\n      this.planeUp.set(0, 1, 0).applyMatrix4(this.planeRotation);\n      this.planeRight.set(1, 0, 0).applyMatrix4(this.planeRotation);\n      this.raycaster = e.object3D === this.leftEventer ? this.leftRaycaster : this.rightRaycaster;\n      const intersection = this.raycastOnPlane();\n      if (!intersection) return;\n      this.isScaling = true;\n      this.initialIntersectionPoint.copy(intersection.point);\n      this.objectToScale.updateMatrices();\n      this.initialObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld);\n      this.initialDistanceToObject = objectToCam\n        .subVectors(\n          camPosition.setFromMatrixPosition(this.viewingCamera.matrixWorld),\n          objectPosition.setFromMatrixPosition(this.el.object3D.matrixWorld)\n        )\n        .length();\n      window.APP.store.update({ activity: { hasScaled: true } });\n\n      // TODO: Refactor transform-selected-object system so this isn't so awkward\n      this.transformSelectedObjectSystem =\n        this.transformSelectedObjectSystem || this.el.sceneEl.systems[\"transform-selected-object\"];\n      this.transformSelectedObjectSystem.transforming = true;\n      this.transformSelectedObjectSystem.mode = TRANSFORM_MODE.SCALE;\n      this.transformSelectedObjectSystem.target = this.objectToScale;\n      this.transformSelectedObjectSystem.hand =\n        e.object3D === this.leftEventer ? this.leftCursorController.object3D : this.rightCursorController.object3D;\n    };\n    this.endScaling = e => {\n      if (!this.isScaling) {\n        return;\n      }\n      if (\n        (e.object3D === this.leftEventer && this.raycaster === this.leftRaycaster) ||\n        (e.object3D !== this.leftEventer && this.raycaster === this.rightRaycaster)\n      ) {\n        this.isScaling = false;\n        this.transformSelectedObjectSystem =\n          this.transformSelectedObjectSystem || this.el.sceneEl.systems[\"transform-selected-object\"];\n        this.transformSelectedObjectSystem.transforming = false;\n      }\n    };\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.startScaling);\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.endScaling);\n  },\n  raycastOnPlane() {\n    this.intersections.length = 0;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    this.plane.raycast(this.raycaster, this.intersections);\n    this.raycaster.far = far;\n    return this.intersections[0];\n  },\n  tick() {\n    if (!this.isScaling) return;\n    const intersection = this.raycastOnPlane();\n    if (!intersection) return;\n    this.intersectionPoint.copy(intersection.point);\n    this.dragVector.subVectors(this.intersectionPoint, this.initialIntersectionPoint);\n    const dotFactor =\n      (this.dragVector.dot(this.planeUp) + this.dragVector.dot(this.planeRight)) / this.initialDistanceToObject;\n\n    let scaleFactor = 1;\n    if (dotFactor > 0) {\n      scaleFactor = 1 + dotFactor;\n    } else if (dotFactor < 0) {\n      scaleFactor = 1 / (1 + Math.abs(dotFactor));\n    }\n    this.desiredObjectScale.copy(this.initialObjectScale).multiplyScalar(scaleFactor);\n    this.objectToScale.updateMatrices();\n    this.currentObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld);\n    this.deltaScale.set(\n      this.desiredObjectScale.x / this.currentObjectScale.x,\n      this.desiredObjectScale.y / this.currentObjectScale.y,\n      this.desiredObjectScale.z / this.currentObjectScale.z\n    );\n    this.objectMatrix.copy(this.objectToScale.matrixWorld);\n    this.objectMatrix.scale(this.deltaScale);\n    setMatrixWorld(this.objectToScale, this.objectMatrix);\n  }\n});\n","export function getMeshes(collisionEntities) {\n  return collisionEntities\n    .map(function(entity) {\n      return entity.getObject3D(\"mesh\");\n    })\n    .filter(function(n) {\n      return n;\n    });\n}\n","import { cylinderTextureSrc } from \"./cylinder-texture\";\nimport { SOUND_TELEPORT_START, SOUND_TELEPORT_END } from \"../systems/sound-effects-system\";\nimport { getMeshes } from \"../utils/aframe-utils\";\n\nimport { textureLoader } from \"../utils/media-utils\";\n\nconst CYLINDER_TEXTURE = textureLoader.load(cylinderTextureSrc);\n\nfunction easeIn(t) {\n  return t * t;\n}\n\nfunction easeOutIn(t) {\n  if (t < 0.5) return 0.5 * ((t = t * 2 - 1) * t * t + 1);\n  return 0.5 * (t = t * 2 - 1) * t * t + 0.5;\n}\n\nconst UP = new THREE.Vector3(0, 1, 0);\n\nclass RayCurve extends THREE.Mesh {\n  constructor(numPoints, width) {\n    super(\n      new THREE.BufferGeometry(),\n      new THREE.MeshBasicMaterial({\n        side: THREE.DoubleSide,\n        toneMapped: false,\n        transparent: true\n      })\n    );\n\n    this.vertices = new Float32Array(numPoints * 3 * 6);\n    this.width = width;\n\n    this.geometry.setAttribute(\n      \"position\",\n      new THREE.BufferAttribute(this.vertices, 3).setUsage(THREE.DynamicDrawUsage)\n    );\n\n    this.frustumCulled = false;\n\n    this.direction = new THREE.Vector3();\n    this.numPoints = numPoints;\n  }\n\n  setDirection(direction) {\n    this.direction\n      .copy(direction)\n      .cross(UP)\n      .normalize()\n      .multiplyScalar(this.width / 2);\n  }\n\n  setWidth(width) {\n    this.width = width;\n  }\n\n  setPoint = (function() {\n    const A = new THREE.Vector3();\n    const B = new THREE.Vector3();\n    const C = new THREE.Vector3();\n    const D = new THREE.Vector3();\n\n    return function(i, P) {\n      let idx = 3 * 6 * i;\n\n      A.copy(P).add(this.direction);\n      B.copy(P).sub(this.direction);\n      C.set(\n        // Previous A\n        i === 0 ? A.x : this.vertices[idx - 3],\n        i === 0 ? A.y : this.vertices[idx - 2],\n        i === 0 ? A.z : this.vertices[idx - 1]\n      );\n      D.set(\n        // Previous B\n        i === 0 ? B.x : this.vertices[idx - 6],\n        i === 0 ? B.y : this.vertices[idx - 5],\n        i === 0 ? B.z : this.vertices[idx - 4]\n      );\n\n      //   A---P---B\n      //   | \\     |\n      //   |  \\    |\n      //   |   \\   |\n      //   |    \\  |\n      //   |     \\ |\n      //   |      \\|\n      //   C-------D\n      //   A'--P'--B' Previous P\n      //   | \\     |\n\n      this.vertices[idx++] = A.x;\n      this.vertices[idx++] = A.y;\n      this.vertices[idx++] = A.z;\n\n      this.vertices[idx++] = C.x;\n      this.vertices[idx++] = C.y;\n      this.vertices[idx++] = C.z;\n\n      this.vertices[idx++] = D.x;\n      this.vertices[idx++] = D.y;\n      this.vertices[idx++] = D.z;\n\n      this.vertices[idx++] = D.x;\n      this.vertices[idx++] = D.y;\n      this.vertices[idx++] = D.z;\n\n      this.vertices[idx++] = B.x;\n      this.vertices[idx++] = B.y;\n      this.vertices[idx++] = B.z;\n\n      this.vertices[idx++] = A.x;\n      this.vertices[idx++] = A.y;\n      this.vertices[idx++] = A.z;\n\n      this.geometry.attributes.position.needsUpdate = true;\n    };\n  })();\n}\n\nfunction parabolicCurve(p0, v0, t, out) {\n  out.x = p0.x + v0.x * t;\n  out.y = p0.y + v0.y * t - 4.9 * t * t;\n  out.z = p0.z + v0.z * t;\n  return out;\n}\n\nfunction isValidNormalsAngle(collisionNormal, referenceNormal, landingMaxAngle) {\n  const angleNormals = referenceNormal.angleTo(collisionNormal);\n  return THREE.MathUtils.RAD2DEG * angleNormals <= landingMaxAngle;\n}\n\nconst checkLineIntersection = (function() {\n  const direction = new THREE.Vector3();\n  return function checkLineIntersection(start, end, meshes, raycaster, referenceNormal, landingMaxAngle, hitPoint) {\n    direction.copy(end).sub(start);\n    const distance = direction.length();\n    raycaster.far = distance;\n    raycaster.set(start, direction.normalize());\n    const intersects = raycaster.intersectObjects(meshes, true);\n    if (intersects.length > 0 && isValidNormalsAngle(intersects[0].face.normal, referenceNormal, landingMaxAngle)) {\n      hitPoint.copy(intersects[0].point);\n      return true;\n    }\n    return false;\n  };\n})();\n\nconst MISS_OPACITY = 0.1;\nconst HIT_OPACITY = 0.3;\nconst MISS_COLOR = 0xff0000;\nconst HIT_COLOR = 0x99ff99;\nconst FORWARD = new THREE.Vector3(0, 0, -1);\nconst LANDING_NORMAL = new THREE.Vector3(0, 1, 0);\nconst MAX_LANDING_ANGLE = 45;\nconst DRAW_TIME_MS = 400;\nconst q = new THREE.Quaternion();\nconst vecHelper = new THREE.Vector3();\nconst v = new THREE.Vector3();\n\nlet uiRoot;\nAFRAME.registerComponent(\"teleporter\", {\n  schema: {\n    start: { type: \"string\" },\n    confirm: { type: \"string\" },\n    speed: { default: 12 },\n    collisionEntities: { default: \"\" },\n    hitCylinderColor: { type: \"color\", default: \"#99ff99\" },\n    hitCylinderRadius: { default: 0.25, min: 0 },\n    outerRadius: { default: 0.6, min: 0 },\n    hitCylinderHeight: { default: 0.3, min: 0 }\n  },\n\n  init() {\n    this.characterController = this.el.sceneEl.systems[\"hubs-systems\"].characterController;\n    this.isTeleporting = false;\n    this.rayCurve = new RayCurve(20, 0.025);\n    this.rayCurve.visible = false;\n    this.el.sceneEl.object3D.add(this.rayCurve);\n\n    this.p0 = new THREE.Vector3();\n    this.v0 = new THREE.Vector3();\n    this.parabola = Array.from(new Array(this.rayCurve.numPoints), () => new THREE.Vector3());\n    this.hit = false;\n    this.hitPoint = new THREE.Vector3();\n    this.meshes = [];\n    this.raycaster = new THREE.Raycaster();\n    this.rigWorldPosition = new THREE.Vector3();\n    this.newRigWorldPosition = new THREE.Vector3();\n    this.teleportOriginWorldPosition = new THREE.Vector3();\n\n    this.teleportEventDetail = {\n      oldPosition: this.rigWorldPosition,\n      newPosition: this.newRigWorldPosition,\n      hitPoint: this.hitPoint\n    };\n    this.prevHitHeight = 0;\n    this.direction = new THREE.Vector3();\n    this.hitEntity = this.createHitEntity();\n    this.hitEntity.visible = false;\n    this.el.sceneEl.object3D.add(this.hitEntity);\n    this.queryCollisionEntities();\n  },\n\n  queryCollisionEntities: function() {\n    this.collisionEntities = [].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities));\n    this.meshes = getMeshes(this.collisionEntities);\n  },\n\n  remove() {\n    this.stopPlayingTeleportSound();\n  },\n\n  stopPlayingTeleportSound() {\n    if (this.teleportingSound) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      sfx.stopSoundNode(this.teleportingSound.source);\n      this.teleportingSound = null;\n    }\n  },\n\n  tick(t, dt) {\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    const entered = this.el.sceneEl.is(\"entered\");\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n    if (!entered && !isGhost) return;\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const { start, confirm, speed } = this.data;\n    const object3D = this.el.object3D;\n\n    if (\n      !this.isTeleporting &&\n      userinput.get(start) &&\n      !this.characterController.isTeleportingDisabled &&\n      !window.APP.store.state.preferences.disableTeleporter\n    ) {\n      this.isTeleporting = true;\n      this.timeTeleporting = 0;\n      this.hit = false;\n      this.rayCurve.visible = true;\n      this.rayCurve.updateMatrixWorld();\n      this.rayCurve.material.opacity = MISS_OPACITY;\n      this.rayCurve.material.color.set(MISS_COLOR);\n      this.rayCurve.material.needsUpdate = true;\n      this.teleportingSound = sfx.playSoundLoopedWithGain(SOUND_TELEPORT_START);\n      if (this.teleportingSound) {\n        this.teleportingSound.gain.gain.value = 0.005;\n      }\n    }\n\n    if (!this.isTeleporting) {\n      return;\n    }\n    if (this.teleportingSound) {\n      this.teleportingSound.gain.gain.value = Math.min(0.025, this.teleportingSound.gain.gain.value + 0.00002 * dt);\n    }\n\n    if (userinput.get(confirm)) {\n      this.hitEntity.visible = false;\n      this.isTeleporting = false;\n      this.rayCurve.visible = false;\n\n      if (this.teleportingSound) {\n        this.stopPlayingTeleportSound();\n      }\n\n      if (!this.hit || this.timeTeleporting < DRAW_TIME_MS) {\n        return;\n      }\n\n      this.characterController.teleportTo(this.hitPoint);\n\n      sfx.playSoundOneShot(SOUND_TELEPORT_END);\n      return;\n    }\n\n    this.timeTeleporting += dt;\n    object3D.updateMatrixWorld();\n    object3D.matrixWorld.decompose(this.p0, q, vecHelper);\n    this.direction\n      .copy(FORWARD)\n      .applyQuaternion(q)\n      .normalize();\n    this.rayCurve.setDirection(this.direction);\n    this.el.object3D.updateMatrices();\n    const playerScale = v.setFromMatrixColumn(this.characterController.avatarPOV.object3D.matrixWorld, 1).length();\n    this.v0.copy(this.direction).multiplyScalar(speed * Math.sqrt(playerScale));\n\n    let collidedIndex = this.rayCurve.numPoints - 1;\n\n    this.hit = false;\n    this.parabola[0].copy(this.p0);\n    const timeSegment = 1 / (this.rayCurve.numPoints - 1);\n    for (let i = 1; i < this.rayCurve.numPoints; i++) {\n      const t = i * timeSegment;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.parabola[i].copy(vecHelper);\n\n      if (\n        checkLineIntersection(\n          this.parabola[i - 1],\n          this.parabola[i],\n          this.meshes,\n          this.raycaster,\n          LANDING_NORMAL,\n          MAX_LANDING_ANGLE,\n          this.hitPoint\n        )\n      ) {\n        this.hit = true;\n        collidedIndex = i;\n        break;\n      }\n    }\n    if (this.characterController.isTeleportingDisabled) {\n      this.hit = false;\n    }\n\n    const percentToDraw = this.timeTeleporting > DRAW_TIME_MS ? 1 : this.timeTeleporting / DRAW_TIME_MS;\n    const percentRaycasted = collidedIndex / (this.rayCurve.numPoints - 1);\n    const segmentT = (percentToDraw * percentRaycasted) / (this.rayCurve.numPoints - 1);\n\n    for (let i = 0; i < this.rayCurve.numPoints; i++) {\n      const t = i * segmentT;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.rayCurve.setPoint(i, vecHelper);\n    }\n\n    const color = this.hit ? HIT_COLOR : MISS_COLOR;\n    const opacity = this.hit && this.timeTeleporting >= DRAW_TIME_MS ? HIT_OPACITY : MISS_OPACITY;\n    this.rayCurve.material.color.set(color);\n    this.rayCurve.material.opacity = opacity;\n\n    this.hitEntity.visible = this.hit;\n    if (this.hit) {\n      this.hitEntity.position.copy(this.hitPoint);\n      this.hitEntity.matrixNeedsUpdate = true;\n\n      const dRadii = this.data.outerRadius - this.data.hitCylinderRadius;\n      const outerScale = (this.data.outerRadius - easeIn(percentToDraw) * dRadii) / this.data.outerRadius;\n      this.outerTorus.scale.set(outerScale, outerScale, 1);\n      this.outerTorus.matrixNeedsUpdate = true;\n\n      const hitEntityOpacity = HIT_OPACITY * easeOutIn(percentToDraw);\n      this.torus.material.opacity = hitEntityOpacity;\n      this.cylinder.material.opacity = hitEntityOpacity;\n    }\n  },\n\n  // TODO the use of toruses here is a bit wasteful.\n  createHitEntity() {\n    const data = this.data;\n\n    // Parent.\n    const hitEntity = new THREE.Group();\n\n    // Torus.\n    this.torus = new THREE.Mesh(\n      new THREE.TorusBufferGeometry(data.hitCylinderRadius, 0.01, 16, 18, 360 * THREE.MathUtils.DEG2RAD),\n      new THREE.MeshBasicMaterial({\n        color: data.hitCylinderColor,\n        side: THREE.DoubleSide,\n        transparent: true,\n        toneMapped: false,\n        depthTest: false\n      })\n    );\n    this.torus.rotation.x = 90 * THREE.MathUtils.DEG2RAD;\n    hitEntity.add(this.torus);\n\n    // Cylinder.\n    this.cylinder = new THREE.Mesh(\n      new THREE.CylinderBufferGeometry(\n        data.hitCylinderRadius,\n        data.hitCylinderRadius,\n        data.hitCylinderHeight,\n        16,\n        1,\n        true\n      ),\n      new THREE.MeshBasicMaterial({\n        color: data.hitCylinderColor,\n        side: THREE.DoubleSide,\n        map: CYLINDER_TEXTURE,\n        toneMapped: false,\n        transparent: true,\n        depthTest: false\n      })\n    );\n    this.cylinder.position.y = data.hitCylinderHeight / 2;\n    // UV's for THREE Geometries assume flipY\n    if (!CYLINDER_TEXTURE.flipY) {\n      this.cylinder.rotation.z = 180 * THREE.MathUtils.DEG2RAD;\n    }\n    hitEntity.add(this.cylinder);\n\n    // create another torus for animating when the hit destination is ready to go\n    this.outerTorus = new THREE.Mesh(\n      new THREE.TorusBufferGeometry(data.outerRadius, 0.01, 16, 18, 360 * THREE.MathUtils.DEG2RAD),\n      new THREE.MeshBasicMaterial({\n        color: data.hitCylinderColor,\n        side: THREE.DoubleSide,\n        opacity: HIT_OPACITY,\n        transparent: true,\n        depthTest: false\n      })\n    );\n    this.outerTorus.rotation.x = 90 * THREE.MathUtils.DEG2RAD;\n    hitEntity.add(this.outerTorus);\n\n    return hitEntity;\n  }\n});\n","export const cylinderTextureSrc =\n  \"data:image/png;base64,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\";\n","import { setMatrixWorld, affixToWorldUp } from \"../utils/three-utils\";\nconst rotate = new THREE.Matrix4().makeRotationY(Math.PI);\nconst translate = new THREE.Matrix4().makeTranslation(0, -0.25, 0);\nconst m = new THREE.Matrix4();\n\nAFRAME.registerComponent(\"inspect-pivot-offset-from-camera\", {\n  tick() {\n    const parent = this.el.object3D.parent;\n    parent.updateMatrices();\n    setMatrixWorld(\n      this.el.object3D,\n      affixToWorldUp(parent.matrixWorld, m)\n        .multiply(translate)\n        .multiply(rotate)\n    );\n  }\n});\n","import { SourceType, AudioType } from \"./audio-params\";\nimport { getCurrentAudioSettings, updateAudioSettings } from \"../update-audio-settings\";\nconst INFO_INIT_FAILED = \"Failed to initialize avatar-audio-source.\";\nconst INFO_NO_NETWORKED_EL = \"Could not find networked el.\";\nconst INFO_NO_OWNER = \"Networked component has no owner.\";\n\n// Chrome seems to require a MediaStream be attached to an AudioElement before AudioNodes work correctly\n// We don't want to do this in other browsers, particularly in Safari, which actually plays the audio despite\n// setting the volume to 0.\nconst SHOULD_CREATE_SILENT_AUDIO_ELS = /chrome/i.test(navigator.userAgent);\nfunction createSilentAudioEl(stream) {\n  const audioEl = new Audio();\n  audioEl.setAttribute(\"autoplay\", \"autoplay\");\n  audioEl.setAttribute(\"playsinline\", \"playsinline\");\n  audioEl.srcObject = stream;\n  audioEl.volume = 0; // we don't actually want to hear audio from this element\n  return audioEl;\n}\n\nasync function getOwnerId(el) {\n  const networkedEl = await NAF.utils.getNetworkedEntity(el).catch(e => {\n    console.error(INFO_INIT_FAILED, INFO_NO_NETWORKED_EL, e);\n  });\n  if (!networkedEl) {\n    return null;\n  }\n  return networkedEl.components.networked.data.owner;\n}\n\nasync function getMediaStream(el) {\n  const peerId = await getOwnerId(el);\n  if (!peerId) {\n    console.error(INFO_INIT_FAILED, INFO_NO_OWNER);\n    return null;\n  }\n  const stream = await APP.dialog.getMediaStream(peerId).catch(e => {\n    console.error(INFO_INIT_FAILED, `Error getting media stream for ${peerId}`, e);\n  });\n  if (!stream) {\n    return null;\n  }\n  return stream;\n}\n\nAFRAME.registerComponent(\"avatar-audio-source\", {\n  createAudio: async function() {\n    this.removeAudio();\n\n    this.isCreatingAudio = true;\n    const stream = await getMediaStream(this.el);\n    this.isCreatingAudio = false;\n    const isRemoved = !this.el.parentNode;\n    if (!stream || isRemoved) return;\n\n    APP.sourceType.set(this.el, SourceType.AVATAR_AUDIO_SOURCE);\n    const { audioType } = getCurrentAudioSettings(this.el);\n    const audioListener = this.el.sceneEl.audioListener;\n    let audio = this.el.getObject3D(this.attrName);\n    if (audioType === AudioType.PannerNode) {\n      audio = new THREE.PositionalAudio(audioListener);\n    } else {\n      audio = new THREE.Audio(audioListener);\n    }\n    // Default to being quiet so it fades in when volume is set by audio systems\n    audio.gain.gain.value = 0;\n\n    this.audioSystem.addAudio({ sourceType: SourceType.AVATAR_AUDIO_SOURCE, node: audio });\n\n    if (SHOULD_CREATE_SILENT_AUDIO_ELS) {\n      createSilentAudioEl(stream); // TODO: Do the audio els need to get cleaned up?\n    }\n\n    this.destination = audio.context.createMediaStreamDestination();\n    this.mediaStreamSource = audio.context.createMediaStreamSource(stream);\n    const destinationSource = audio.context.createMediaStreamSource(this.destination.stream);\n    this.mediaStreamSource.connect(this.destination);\n    audio.setNodeSource(destinationSource);\n    this.el.setObject3D(this.attrName, audio);\n    this.el.emit(\"sound-source-set\", { soundSource: destinationSource });\n\n    APP.audios.set(this.el, audio);\n    updateAudioSettings(this.el, audio);\n  },\n\n  removeAudio() {\n    const audio = this.el.getObject3D(this.attrName);\n    if (audio) {\n      this.audioSystem.removeAudio({ node: audio });\n      this.el.removeObject3D(this.attrName);\n    }\n  },\n\n  init() {\n    this.createAudio = this.createAudio.bind(this);\n\n    this.audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n    // We subscribe to audio stream notifications for this peer to update the audio source\n    // This could happen in case there is an ICE failure that requires a transport recreation.\n    APP.dialog.on(\"stream_updated\", this._onStreamUpdated, this);\n    this.createAudio();\n\n    let { disableLeftRightPanning, audioPanningQuality } = APP.store.state.preferences;\n    this.onPreferenceChanged = () => {\n      const newDisableLeftRightPanning = APP.store.state.preferences.disableLeftRightPanning;\n      const newAudioPanningQuality = APP.store.state.preferences.audioPanningQuality;\n\n      const shouldRecreateAudio = disableLeftRightPanning !== newDisableLeftRightPanning && !this.isCreatingAudio;\n      const shouldUpdateAudioSettings = audioPanningQuality !== newAudioPanningQuality;\n\n      disableLeftRightPanning = newDisableLeftRightPanning;\n      audioPanningQuality = newAudioPanningQuality;\n\n      if (shouldRecreateAudio) {\n        this.createAudio();\n      } else if (shouldUpdateAudioSettings) {\n        // updateAudioSettings() is called in this.createAudio()\n        // so no need to call it if shouldRecreateAudio is true.\n        const audio = this.el.getObject3D(this.attrName);\n        updateAudioSettings(this.el, audio);\n      }\n    };\n    APP.store.addEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.addEventListener(\"audio_type_changed\", this.createAudio);\n  },\n\n  async _onStreamUpdated(peerId, kind) {\n    const audio = this.el.getObject3D(this.attrName);\n    if (!audio) return;\n    const stream = audio.source.mediaStream;\n    if (!stream) return;\n\n    getOwnerId(this.el).then(async ownerId => {\n      if (ownerId === peerId && kind === \"audio\") {\n        // The audio stream for this peer has been updated\n        const newStream = await APP.dialog.getMediaStream(peerId, \"audio\").catch(e => {\n          console.error(INFO_INIT_FAILED, `Error getting media stream for ${peerId}`, e);\n        });\n\n        if (newStream) {\n          this.mediaStreamSource.disconnect();\n          this.mediaStreamSource = audio.context.createMediaStreamSource(newStream);\n          this.mediaStreamSource.connect(this.destination);\n        }\n      }\n    });\n  },\n\n  remove: function() {\n    APP.dialog.off(\"stream_updated\", this._onStreamUpdated);\n\n    window.APP.store.removeEventListener(\"statechanged\", this.onPreferenceChanged);\n    this.el.removeEventListener(\"audio_type_changed\", this.createAudio);\n\n    APP.audios.delete(this.el);\n    APP.sourceType.delete(this.el);\n    APP.supplementaryAttenuation.delete(this.el);\n\n    this.removeAudio();\n  }\n});\n\nfunction createWhiteNoise(audioContext, gain) {\n  const bufferSize = 2 * audioContext.sampleRate,\n    noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate),\n    gainFilter = noiseBuffer.getChannelData(0);\n  for (let i = 0; i < bufferSize; i++) {\n    gainFilter[i] = (Math.random() * 2 - 1) * gain;\n  }\n\n  const whiteNoise = audioContext.createBufferSource();\n  whiteNoise.buffer = noiseBuffer;\n  whiteNoise.loop = true;\n  whiteNoise.start(0);\n  return whiteNoise;\n}\n\nconst tmpWorldPos = new THREE.Vector3();\n\n/**\n * @component zone-audio-source\n * This component looks for audio sources that get near it, keeping track\n * of them and making them available to other components. It currently only\n * supports avatars via the avatar-audio-source component, and only a single\n * source at a time, but this can easily be expanded in the future.\n */\nAFRAME.registerComponent(\"zone-audio-source\", {\n  schema: {\n    onlyMods: { default: true },\n    muteSelf: { default: true },\n\n    debug: { default: false }\n  },\n\n  init() {\n    const audioListener = this.el.sceneEl.audioListener;\n    const ctx = audioListener.context;\n    this.gainFilter = ctx.createGain();\n    if (this.data.debug) {\n      this.whiteNoise = createWhiteNoise(ctx, 0.01);\n      this.setInput(this.whiteNoise);\n    }\n\n    // TODO this should probably be using bounds similar to media-frames and trigger-volume.\n    // Doing the simple thing for now since we only support avatar audio sources currently\n    this.el.object3D.updateMatrixWorld();\n    const radius = this.el.object3D.matrixWorld.getMaxScaleOnAxis();\n    this.boundingRadiusSquared = radius * radius;\n\n    if (this.data.debug) {\n      this.el.setObject3D(\n        \"debug\",\n        new THREE.LineSegments(new THREE.WireframeGeometry(new THREE.SphereBufferGeometry(1, 10, 10)))\n      );\n    }\n  },\n\n  setInput(newInput) {\n    if (this.input) {\n      this.input.disconnect(this.gainFilter);\n      this.input = null;\n    }\n\n    if (newInput) {\n      newInput.connect(this.gainFilter);\n      this.input = newInput;\n    }\n  },\n\n  getGainFilter() {\n    return this.gainFilter;\n  },\n\n  tick() {\n    this.el.object3D.getWorldPosition(tmpWorldPos);\n    if (this.trackingEl) {\n      const distanceSquared = this.trackingEl.object3D.position.distanceToSquared(tmpWorldPos);\n      if (distanceSquared > this.boundingRadiusSquared) {\n        this.trackingEl = null;\n        this.setInput(this.whiteNoise);\n      }\n    } else {\n      const playerInfos = window.APP.componentRegistry[\"player-info\"];\n      for (let i = 0; i < playerInfos.length; i++) {\n        const playerInfo = playerInfos[i];\n        const avatar = playerInfo.el;\n\n        if (this.data.onlyMods && !playerInfo.can(\"amplify_audio\")) continue;\n\n        const distanceSquared = avatar.object3D.position.distanceToSquared(tmpWorldPos);\n        if (distanceSquared < this.boundingRadiusSquared) {\n          this.trackingEl = avatar;\n          if (this.data.muteSelf && this.trackingEl.id === \"avatar-rig\") {\n            // Don't emit your own audio\n            this.setInput(null);\n          } else {\n            getMediaStream(this.trackingEl).then(stream => {\n              const audioListener = this.el.sceneEl.audioListener;\n              const ctx = audioListener.context;\n              const node = ctx.createMediaStreamSource(stream);\n              this.setInput(node);\n            });\n          }\n        }\n      }\n    }\n  }\n});\n\n/**\n * @component audio-target\n * This component pulls audio from a \"source\" component and re-emits it.\n * Currently the audio can come from a zone-audio-source. A gain as well\n * as a random delay can be applied in addition to the standard positional\n * audio properties, to better simulate a real world speaker setup.\n */\nAFRAME.registerComponent(\"audio-target\", {\n  schema: {\n    minDelay: { default: 0.01 },\n    maxDelay: { default: 0.13 },\n    srcEl: { type: \"selector\" },\n    debug: { default: false }\n  },\n\n  init() {\n    this.audioSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSystem;\n    this.createAudio();\n    // TODO this is to ensure targets and sources loaded at the same time don't have\n    // an order depndancy but this should be done in a more robust way\n    setTimeout(() => {\n      this.connectAudio();\n    }, 0);\n    this.el.setAttribute(\"audio-zone-source\");\n\n    this.createAudio = this.createAudio.bind(this);\n    this.el.addEventListener(\"audio_type_changed\", this.createAudio);\n  },\n\n  remove: function() {\n    APP.supplementaryAttenuation.delete(this.el);\n    APP.audios.delete(this.el);\n    APP.sourceType.delete(this.el);\n\n    this.removeAudio();\n\n    this.el.removeAttribute(\"audio-zone-source\");\n    this.el.removeEventListener(\"audio_type_changed\", this.createAudio);\n  },\n\n  createAudio: function() {\n    this.removeAudio();\n\n    APP.sourceType.set(this.el, SourceType.AUDIO_TARGET);\n    const audioListener = this.el.sceneEl.audioListener;\n    const { audioType } = getCurrentAudioSettings(this.el);\n    let audio = this.el.getObject3D(this.attrName);\n    if (audioType === AudioType.PannerNode) {\n      audio = new THREE.PositionalAudio(audioListener);\n    } else {\n      audio = new THREE.Audio(audioListener);\n    }\n    this.audioSystem.addAudio({ sourceType: SourceType.AVATAR_AUDIO_SOURCE, node: audio });\n\n    if (this.data.maxDelay > 0) {\n      const delayNode = audio.context.createDelay(this.data.maxDelay);\n      delayNode.delayTime.value = THREE.MathUtils.randFloat(this.data.minDelay, this.data.maxDelay);\n      audio.setFilters([delayNode]);\n    }\n\n    this.el.setObject3D(this.attrName, audio);\n    audio.matrixNeedsUpdate = true;\n    audio.updateMatrixWorld();\n\n    audio.updateMatrixWorld();\n    APP.audios.set(this.el, audio);\n    updateAudioSettings(this.el, audio);\n  },\n\n  connectAudio() {\n    const srcEl = this.data.srcEl;\n    const srcZone = srcEl && srcEl.components[\"zone-audio-source\"];\n    const node = srcZone && srcZone.getGainFilter();\n    if (node) {\n      const audio = this.el.getObject3D(this.attrName);\n      if (audio) {\n        audio.setNodeSource(node);\n      }\n    } else {\n      console.warn(`Failed to get audio from source for ${this.el.className}`, srcEl);\n    }\n  },\n\n  removeAudio() {\n    const audio = this.el.getObject3D(this.attrName);\n    if (audio) {\n      this.audioSystem.removeAudio({ node: this.audio });\n      this.el.removeObject3D(this.attrName);\n    }\n  }\n});\n","import { disposeTexture } from \"../utils/material-utils\";\nimport { createVideoOrAudioEl } from \"../utils/media-utils\";\nimport { findNode } from \"../utils/three-utils\";\nimport { Layers } from \"./layers\";\n\n/**\n * @component video-texture-source\n * This component is intended to be used on entities with a Camera Object3D as a child.\n * That camera is used to render the scene to a WebGLRenderTarget of the specified resolution\n * at a maximum of the specified frame rate. It will only render a frame if something sets\n * its textureNeedsUpdate property to true. Currently video-texture-target does this\n * whenever its material is used during the primary camera render (as in, it's in view).\n */\nAFRAME.registerComponent(\"video-texture-source\", {\n  schema: {\n    resolution: { type: \"vec2\", default: [1280, 720] },\n    fps: { default: 15 }\n  },\n\n  init() {\n    this.camera = findNode(this.el.object3D, n => n.isCamera);\n\n    this.camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n\n    if (!this.camera) {\n      console.warn(\"video-texture-source added to an entity without a camera\");\n      return;\n    }\n\n    this.camera.aspect = this.data.resolution[0] / this.data.resolution[1];\n\n    // TODO currently if a video-texture-source tries to render itself it will fail with a warning.\n    // If we want to support this we will need 2 render targets to swap back and forth.\n    this.renderTarget = new THREE.WebGLRenderTarget(this.data.resolution[0], this.data.resolution[1], {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n\n    const texture = this.renderTarget.texture;\n\n    // Since we are rendering directly to a texture we need to flip it vertically\n    // See https://github.com/mozilla/hubs/pull/4126#discussion_r610120237\n    texture.matrixAutoUpdate = false;\n    texture.matrix.scale(1, -1);\n    texture.matrix.translate(0, 1);\n\n    this.textureNeedsUpdate = false;\n  },\n\n  remove() {\n    disposeTexture(this.renderTarget.texture);\n    this.renderTarget.dispose();\n  },\n\n  tock(time) {\n    if (!this.renderTarget || !this.textureNeedsUpdate) return;\n\n    if (time < this.lastRenderTime + 1000 / this.data.fps) return;\n\n    // TODO handle hiding UI and showing first person head\n    // Once thats done also rework camrea-tool to use this to do its actual rendering\n\n    const sceneEl = this.el.sceneEl;\n    const renderer = this.renderer || sceneEl.renderer;\n\n    const tmpXRFlag = renderer.xr.enabled;\n    const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\n    delete sceneEl.object3D.onAfterRender;\n    renderer.xr.enabled = false;\n\n    // The entire scene graph matrices should already be updated\n    // in tick(). They don't need to be recomputed again in tock().\n    const tmpAutoUpdate = sceneEl.object3D.autoUpdate;\n    sceneEl.object3D.autoUpdate = false;\n\n    renderer.setRenderTarget(this.renderTarget);\n    renderer.render(sceneEl.object3D, this.camera);\n    renderer.setRenderTarget(null);\n\n    sceneEl.object3D.autoUpdate = tmpAutoUpdate;\n\n    renderer.xr.enabled = tmpXRFlag;\n    sceneEl.object3D.onAfterRender = tmpOnAfterRender;\n\n    this.lastRenderTime = time;\n    this.textureNeedsUpdate = false;\n  }\n});\n\n/**\n * @component video-texture-target\n * This component is intended to be used on entities with a mesh/skinned mesh Object3D\n * The component swaps the base color map on the mesh's material with a video texture\n * Currently the video texture can come from a webcam stream or a camera entity with\n * a video-texture-src component on it.\n */\nAFRAME.registerComponent(\"video-texture-target\", {\n  schema: {\n    src: { type: \"string\" },\n    // only used when `src` === \"el\"\n    srcEl: { type: \"selector\" },\n    targetBaseColorMap: { type: \"boolean\", default: true },\n    targetEmissiveMap: { type: \"boolean\", default: false }\n  },\n\n  getMaterial() {\n    return (\n      (this.el.object3DMap.skinnedmesh && this.el.object3DMap.skinnedmesh.material) ||\n      (this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) ||\n      this.el.object3D.material\n    );\n  },\n\n  init() {\n    // Make video-texture-target objects inivisible before rendering to the frame buffer\n    // Chromium checks for loops when drawing to a framebuffer so if we don't exclude the objects\n    // that are using that rendertarget's texture we get an error. Firefox does not check.\n    // https://chromium.googlesource.com/chromium/src/+/460cac969e2e9ac38a2611be1a32db0361d88bfb/gpu/command_buffer/service/gles2_cmd_decoder.cc#9516\n    this.el.object3D.traverse(o => {\n      o.layers.mask1 = o.layers.mask;\n      o.layers.set(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n    });\n\n    const material = this.getMaterial();\n\n    if (!material) {\n      console.warn(\"video-texture-target added to an entity without a material\");\n    }\n\n    this.originalMap = material && material.map;\n    this.originalEmissiveMap = material && material.emissiveMap;\n  },\n\n  update(prevData) {\n    const material = this.getMaterial();\n\n    if (!material) {\n      return;\n    }\n\n    const src = this.data.src;\n\n    // TODO it's pretty ugly to have these 2 unrelated code paths, it should probably be reworked such that both paths look more like the first branch\n    if (src === \"el\") {\n      if (prevData.srcEl === this.data.srcEl) return;\n\n      if (this.data.srcEl) {\n        const videoTextureSource = this.data.srcEl.components[\"video-texture-source\"];\n        const texture = videoTextureSource.renderTarget.texture;\n        this.applyTexture(texture);\n\n        // Bit of a hack here to only update the renderTarget when the screens are in view\n        material.map.isVideoTexture = true;\n        material.map.update = () => {\n          videoTextureSource.textureNeedsUpdate = true;\n        };\n      } else {\n        material.map = this.originalMap;\n        material.emissiveMap = this.originalEmissiveMap;\n        material.needsUpdate = true;\n      }\n    } else {\n      if (src && src.startsWith(\"hubs://\")) {\n        if (prevData.src === src) {\n          return;\n        }\n\n        const streamClientId = src.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\n\n        APP.dialog.getMediaStream(streamClientId, \"video\").then(stream => {\n          if (src !== this.data.src) {\n            // Prevent creating and loading video texture if the src changed while we were fetching the video stream.\n            return;\n          }\n\n          const video = createVideoOrAudioEl(\"video\");\n          video.srcObject = stream;\n\n          const texture = new THREE.VideoTexture(video);\n          texture.flipY = false;\n          texture.minFilter = THREE.LinearFilter;\n          texture.encoding = THREE.sRGBEncoding;\n\n          this.applyTexture(texture);\n        });\n      } else {\n        if (material.map && material.map !== this.originalMap) {\n          disposeTexture(material.map);\n        }\n\n        if (material.emissiveMap && material.emissiveMap !== this.originalEmissiveMap) {\n          disposeTexture(material.emissiveMap);\n        }\n\n        material.map = this.originalMap;\n        material.emissiveMap = this.originalEmissiveMap;\n\n        material.needsUpdate = true;\n      }\n    }\n  },\n\n  applyTexture(texture) {\n    const material = this.getMaterial();\n\n    // Copy texture settings from the original texture so that things like texture wrap settings are applied\n    const originalTexture = this.originalMap || this.originalEmissiveMap;\n\n    if (originalTexture) {\n      texture.wrapS = originalTexture.wrapS;\n      texture.wrapT = originalTexture.wrapT;\n    }\n\n    if (this.data.targetBaseColorMap) {\n      material.map = texture;\n    }\n\n    if (this.data.targetEmissiveMap) {\n      material.emissiveMap = texture;\n    }\n\n    material.needsUpdate = true;\n  },\n\n  remove() {\n    this.el.object3D.traverse(o => {\n      if (o.layers.mask1) {\n        o.layers.mask = o.layers.mask1;\n        delete o.layers.mask1;\n      }\n    });\n\n    // element sources can be shared and are expected to manage their own resources\n    if (this.data.src === \"el\") return;\n\n    const material = this.getMaterial();\n\n    if (material && material.map && material.map !== this.originalMap) {\n      disposeTexture(material.map);\n    }\n\n    if (material.emissiveMap && material.emissiveMap !== this.originalEmissiveMap) {\n      disposeTexture(material.emissiveMap);\n    }\n  }\n});\n","import { Reflector } from \"three/examples/jsm/objects/Reflector\";\n\nconst DEFAULT_MIRROR_GEOMETRY = new THREE.PlaneBufferGeometry();\nconst DEFAULT_TEXTURE_WIDTH = window.innerWidth * window.devicePixelRatio;\nconst DEFAULT_TEXTURE_HEIGHT = window.innerHeight * window.devicePixelRatio;\n\nimport { Layers } from \"./layers\";\n\n/**\n * Should need to entity that has geometry primitive\n *\n * @example\n * ```html\n * <a-plane mirror scale=\"5 5 5\" position=\"0 3 0\"></a-plane>\n * <a-circle mirror=\"color: #7f7f7f\" scale=\"5 5 5\" position=\"0 3 0\"></a-circle>\n * ```\n */\nAFRAME.registerComponent(\"mirror\", {\n  schema: {\n    color: { type: \"color\", default: \"#7f7f7f\" }\n  },\n\n  init() {\n    const geometry = this.el.object3DMap?.mesh?.geometry || DEFAULT_MIRROR_GEOMETRY;\n    const reflector = new Reflector(geometry, {\n      color: this.data.color,\n      textureWidth: DEFAULT_TEXTURE_WIDTH,\n      textureHeight: DEFAULT_TEXTURE_HEIGHT\n    });\n    this.el.setObject3D(\"mesh\", reflector);\n\n    // HACK the first time we render this, add the appropriate camera layers to the virtual camera\n    const originalOnBeforeRender = reflector.onBeforeRender;\n    reflector.onBeforeRender = function (renderer, scene, camera) {\n      const originalRender = renderer.render;\n      renderer.render = function (scene, camera) {\n        camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n        camera.layers.enable(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n        reflector.onBeforeRender = originalOnBeforeRender;\n        originalRender.call(renderer, scene, camera);\n      };\n      originalOnBeforeRender(renderer, scene, camera);\n      renderer.render = originalRender;\n    };\n  }\n});\n","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // Hash can't be overriden like the other elements, but needs to be preserved for things like deep linking waypoints\n  const hash = history.location.hash;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state, hash });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","import { isIOS } from \"./is-mobile\";\n\nconst { detect } = require(\"detect-browser\");\n\nconst browser = detect();\n\n// Precision on device detection is fuzzy -- we can sometimes know if a device is definitely\n// available, or definitely *not* available, and assume it may be available otherwise.\nexport const VR_DEVICE_AVAILABILITY = {\n  yes: \"yes\", // Implies VR can be launched into on this device immediately, in this browser\n  no: \"no\", // Implies this VR device is definitely not supported regardless of browser\n  maybe: \"maybe\" // Implies this device may support this VR platform, but may not be installed or in a compatible browser\n};\n\nfunction isMaybeGearVRCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\nfunction isMaybeDaydreamCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\n// Disallowed list of VR device name regex matchers that we do not want to consider as valid VR devices\n// that can be entered into as a \"generic\" entry flow.\nconst GENERIC_ENTRY_TYPE_DISALLOWED_DEVICES = [/cardboard/i];\n\n// Tries to determine VR entry compatibility regardless of the current browser.\n//\n// For each VR \"entry type\", returns VR_DEVICE_AVAILABILITY.yes if that type can be launched into directly from this browser\n// on this device, returns VR_DEVICE_AVAILABILITY.no if that type is known to not be possible to ever use on this device no matter what,\n// and VR_DEVICE_AVAILABILITY.maybe if the device potentially could support that type if a different browser was running, or if\n// the software was setup, an HMD was purchased, etc.\n//\n// When \"yes\" or \"maybe\", we should present the option. If \"maybe\", when chosen try to get them into a compatible browser.\n// Once in a compatible browser, we should assume it will work (if it doesn't, it's because they don't have the headset,\n// haven't installed the software, our guess about their phone was wrong, etc.)\n//\n// At the time of this writing there are the following VR \"entry types\" that will be validated by this method:\n//\n// - screen: Enter \"on-screen\" in 2D\n// - generic: Generic WebVR (platform/OS agnostic indicator if a general 'Enter VR' option should be presented.)\n// - daydream: Google Daydream\n// - gearvr: Oculus GearVR\n// - cardboard: Google Cardboard\n//\nexport async function getAvailableVREntryTypes() {\n  const ua = navigator.userAgent;\n  const isSamsungBrowser = browser.name === \"chrome\" && /SamsungBrowser/.test(ua);\n  const isMobile = AFRAME.utils.device.isMobile();\n  const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n  // This needs to be kept up-to-date with the latest browsers that can support VR and Hubs.\n  // Checking for navigator.getVRDisplays always passes b/c of polyfill.\n  const isWebVRCapableBrowser = window.hasNativeWebVRImplementation;\n  const isWebXRCapableBrowser = window.hasNativeWebXRImplementation;\n\n  const isDaydreamCapableBrowser = !!(isWebVRCapableBrowser && browser.name === \"chrome\" && !isSamsungBrowser);\n  const isIDevice = isIOS();\n  const isFirefoxBrowser = browser.name === \"firefox\";\n  const isUIWebView = typeof navigator.mediaDevices === \"undefined\";\n\n  const safari = isIDevice\n    ? !isUIWebView\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.maybe\n    : VR_DEVICE_AVAILABILITY.no;\n\n  const isCardboardCapableBrowser = !!(isMobile && !isIDevice && browser.name === \"chrome\" && !isSamsungBrowser);\n\n  let displays = [];\n  try {\n    // Skip getVRDisplays on desktop Chrome since the API is in a broken state there.\n    // See https://github.com/mozilla/hubs/issues/892\n    if (browser.name !== \"chrome\" || isMobile) {\n      // We pull the displays on non-WebVR capable mobile browsers so we can pick up cardboard.\n      displays = isWebVRCapableBrowser || isCardboardCapableBrowser ? await navigator.getVRDisplays() : [];\n    }\n  } catch (e) {\n    console.warn(\"navigator.getVRDisplays() failed\", e);\n  }\n\n  const isOculusBrowser = /Oculus/.test(ua);\n\n  const screen = isMobileVR\n    ? VR_DEVICE_AVAILABILITY.no\n    : isIDevice && isUIWebView\n      ? VR_DEVICE_AVAILABILITY.maybe\n      : VR_DEVICE_AVAILABILITY.yes;\n\n  // HACK -- we prompt the user to install firefox if they click the VR button on a non-WebVR compatible\n  // browser. Without this check if you have FF on Mac/Linux you'll get the confusing flow of having a\n  // VR button but then being asked to download FF.\n  const isNonWebVRFirefox = !isWebVRCapableBrowser && isFirefoxBrowser;\n  let generic = isMobile || isNonWebVRFirefox ? VR_DEVICE_AVAILABILITY.no : VR_DEVICE_AVAILABILITY.maybe;\n  let cardboard = VR_DEVICE_AVAILABILITY.no;\n\n  // We only consider GearVR support as \"maybe\" and never \"yes\". The only browser\n  // that will detect GearVR outside of VR is Samsung Internet, and we'd prefer to launch into Oculus\n  // Browser for now since Samsung Internet requires an additional WebVR installation + flag, so return \"maybe\".\n  //\n  // If we are in Oculus Browser (ie, we are literally wearing a GearVR) then return 'yes'.\n  let gearvr = VR_DEVICE_AVAILABILITY.no;\n  if (isMaybeGearVRCompatibleDevice(ua)) {\n    gearvr = isOculusBrowser ? VR_DEVICE_AVAILABILITY.yes : VR_DEVICE_AVAILABILITY.maybe;\n  }\n\n  // For daydream detection, we first check if they are on an Android compatible device, and assume they\n  // may support daydream *unless* this browser has WebVR capabilities, in which case we can do better.\n  let daydream =\n    isMaybeDaydreamCompatibleDevice(ua) && !isMobileVR ? VR_DEVICE_AVAILABILITY.maybe : VR_DEVICE_AVAILABILITY.no;\n\n  cardboard =\n    isCardboardCapableBrowser && displays.find(d => d.capabilities.canPresent && /cardboard/i.test(d.displayName))\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n  if (isWebVRCapableBrowser) {\n    // Generic is supported for allowed devices and presentable HMDs.\n    generic = displays.find(\n      d => d.capabilities.canPresent && !GENERIC_ENTRY_TYPE_DISALLOWED_DEVICES.find(r => r.test(d.displayName))\n    )\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n    // For daydream detection, in a WebVR browser we can increase confidence in daydream compatibility.\n    const hasDaydreamWebVRDevice = displays.find(d => /daydream/i.test(d.displayName));\n\n    if (hasDaydreamWebVRDevice) {\n      // If we detected daydream via WebVR\n      daydream = VR_DEVICE_AVAILABILITY.yes;\n      generic = VR_DEVICE_AVAILABILITY.no;\n    } else if (isDaydreamCapableBrowser) {\n      // If we didn't detect daydream in a daydream capable browser, we definitely can't run daydream at all.\n      daydream = VR_DEVICE_AVAILABILITY.no;\n    }\n  }\n\n  if (isWebXRCapableBrowser) {\n    generic = true;\n  }\n\n  return { screen, generic, gearvr, daydream, cardboard, safari };\n}\n\nexport const ONLY_SCREEN_AVAILABLE = {\n  screen: VR_DEVICE_AVAILABILITY.yes,\n  generic: VR_DEVICE_AVAILABILITY.no,\n  gearvr: VR_DEVICE_AVAILABILITY.no,\n  daydream: VR_DEVICE_AVAILABILITY.no,\n  cardboard: VR_DEVICE_AVAILABILITY.no,\n  safari: VR_DEVICE_AVAILABILITY.no\n};\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\nexport function canShare() {\n  // TODO, fix up when OB/FxR support sharing\n  return navigator.share && !isMobileVR;\n}\n\n/**\n * Wraps navigator.share with a fallback to twitter for unsupported browsers\n */\nexport function share(opts) {\n  if (canShare()) {\n    return navigator.share(opts);\n  } else {\n    const { title, url } = opts;\n    const width = 550;\n    const height = 420;\n    const left = (screen.width - width) / 2;\n    const top = (screen.height - height) / 2;\n    const params = `scrollbars=no,menubar=no,toolbar=no,status=no,width=${width},height=${height},top=${top},left=${left}`;\n    const tweetLink = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(\n      title\n    )}`;\n    window.open(tweetLink, \"_blank\", params);\n    return Promise.resolve();\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"interstitial\":\"ui-root__interstitial__Ic8QU\",\"ui\":\"ui-root__ui__DMhNQ\",\"no-default-button-style\":\"ui-root__no-default-button-style__OVVW8\",\"noDefaultButtonStyle\":\"ui-root__no-default-button-style__OVVW8\",\"avatar-editor\":\"ui-root__avatar-editor__VDEEJ\",\"avatarEditor\":\"ui-root__avatar-editor__VDEEJ\"};","// extracted by mini-css-extract-plugin\nexport default {\"hide-lg\":\"style-utils__hide-lg__rXFJz\",\"hideLg\":\"style-utils__hide-lg__rXFJz\",\"show-lg\":\"style-utils__show-lg__UpSEb\",\"showLg\":\"style-utils__show-lg__UpSEb\",\"margin-0\":\"style-utils__margin-0__KkfJM\",\"margin0\":\"style-utils__margin-0__KkfJM\",\"textError\":\"style-utils__textError__ySIF5\",\"2xs-margin-y\":\"style-utils__2xs-margin-y__dz6I9\",\"2XsMarginY\":\"style-utils__2xs-margin-y__dz6I9\",\"2xs-margin-r\":\"style-utils__2xs-margin-r__s05Qm\",\"2XsMarginR\":\"style-utils__2xs-margin-r__s05Qm\",\"2xs-margin-l\":\"style-utils__2xs-margin-l__a4wdt\",\"2XsMarginL\":\"style-utils__2xs-margin-l__a4wdt\",\"2xs-margin-bottom\":\"style-utils__2xs-margin-bottom__InDYJ\",\"2XsMarginBottom\":\"style-utils__2xs-margin-bottom__InDYJ\",\"2xs-margin-top\":\"style-utils__2xs-margin-top__ncUYG\",\"2XsMarginTop\":\"style-utils__2xs-margin-top__ncUYG\",\"2xs-padding\":\"style-utils__2xs-padding__Fy_1J\",\"2XsPadding\":\"style-utils__2xs-padding__Fy_1J\",\"2xs-wrap-margin\":\"style-utils__2xs-wrap-margin__s10xt\",\"2XsWrapMargin\":\"style-utils__2xs-wrap-margin__s10xt\",\"xs-margin-y\":\"style-utils__xs-margin-y__Ko8vB\",\"xsMarginY\":\"style-utils__xs-margin-y__Ko8vB\",\"xs-margin-r\":\"style-utils__xs-margin-r__YUwDE\",\"xsMarginR\":\"style-utils__xs-margin-r__YUwDE\",\"xs-margin-l\":\"style-utils__xs-margin-l__JFZpu\",\"xsMarginL\":\"style-utils__xs-margin-l__JFZpu\",\"xs-margin-bottom\":\"style-utils__xs-margin-bottom__THXKr\",\"xsMarginBottom\":\"style-utils__xs-margin-bottom__THXKr\",\"xs-margin-top\":\"style-utils__xs-margin-top__PHtKS\",\"xsMarginTop\":\"style-utils__xs-margin-top__PHtKS\",\"xs-padding\":\"style-utils__xs-padding__zn2Bm\",\"xsPadding\":\"style-utils__xs-padding__zn2Bm\",\"xs-wrap-margin\":\"style-utils__xs-wrap-margin__ud4Ol\",\"xsWrapMargin\":\"style-utils__xs-wrap-margin__ud4Ol\",\"sm-margin-y\":\"style-utils__sm-margin-y__qkaiv\",\"smMarginY\":\"style-utils__sm-margin-y__qkaiv\",\"sm-margin-r\":\"style-utils__sm-margin-r__wO0mi\",\"smMarginR\":\"style-utils__sm-margin-r__wO0mi\",\"sm-margin-l\":\"style-utils__sm-margin-l__ikRsW\",\"smMarginL\":\"style-utils__sm-margin-l__ikRsW\",\"sm-margin-bottom\":\"style-utils__sm-margin-bottom__sL7g3\",\"smMarginBottom\":\"style-utils__sm-margin-bottom__sL7g3\",\"sm-margin-top\":\"style-utils__sm-margin-top__sx7cP\",\"smMarginTop\":\"style-utils__sm-margin-top__sx7cP\",\"sm-padding\":\"style-utils__sm-padding__NGuEN\",\"smPadding\":\"style-utils__sm-padding__NGuEN\",\"sm-wrap-margin\":\"style-utils__sm-wrap-margin__KdMMC\",\"smWrapMargin\":\"style-utils__sm-wrap-margin__KdMMC\",\"md-margin-y\":\"style-utils__md-margin-y__HzmWb\",\"mdMarginY\":\"style-utils__md-margin-y__HzmWb\",\"md-margin-r\":\"style-utils__md-margin-r__DpiDI\",\"mdMarginR\":\"style-utils__md-margin-r__DpiDI\",\"md-margin-l\":\"style-utils__md-margin-l__DcpHY\",\"mdMarginL\":\"style-utils__md-margin-l__DcpHY\",\"md-margin-bottom\":\"style-utils__md-margin-bottom__u4Yw9\",\"mdMarginBottom\":\"style-utils__md-margin-bottom__u4Yw9\",\"md-margin-top\":\"style-utils__md-margin-top__wJzyR\",\"mdMarginTop\":\"style-utils__md-margin-top__wJzyR\",\"md-padding\":\"style-utils__md-padding__yDslX\",\"mdPadding\":\"style-utils__md-padding__yDslX\",\"md-wrap-margin\":\"style-utils__md-wrap-margin__Zq10k\",\"mdWrapMargin\":\"style-utils__md-wrap-margin__Zq10k\",\"lg-margin-y\":\"style-utils__lg-margin-y__f5CMV\",\"lgMarginY\":\"style-utils__lg-margin-y__f5CMV\",\"lg-margin-r\":\"style-utils__lg-margin-r__osZ3t\",\"lgMarginR\":\"style-utils__lg-margin-r__osZ3t\",\"lg-margin-l\":\"style-utils__lg-margin-l__UZ8fF\",\"lgMarginL\":\"style-utils__lg-margin-l__UZ8fF\",\"lg-margin-bottom\":\"style-utils__lg-margin-bottom__SuMJj\",\"lgMarginBottom\":\"style-utils__lg-margin-bottom__SuMJj\",\"lg-margin-top\":\"style-utils__lg-margin-top__TYCaC\",\"lgMarginTop\":\"style-utils__lg-margin-top__TYCaC\",\"lg-padding\":\"style-utils__lg-padding__mUNzR\",\"lgPadding\":\"style-utils__lg-padding__mUNzR\",\"lg-wrap-margin\":\"style-utils__lg-wrap-margin__cvqUC\",\"lgWrapMargin\":\"style-utils__lg-wrap-margin__cvqUC\",\"xl-margin-y\":\"style-utils__xl-margin-y__huAwr\",\"xlMarginY\":\"style-utils__xl-margin-y__huAwr\",\"xl-margin-r\":\"style-utils__xl-margin-r__TU7TF\",\"xlMarginR\":\"style-utils__xl-margin-r__TU7TF\",\"xl-margin-l\":\"style-utils__xl-margin-l__GOXHe\",\"xlMarginL\":\"style-utils__xl-margin-l__GOXHe\",\"xl-margin-bottom\":\"style-utils__xl-margin-bottom__kKLk8\",\"xlMarginBottom\":\"style-utils__xl-margin-bottom__kKLk8\",\"xl-margin-top\":\"style-utils__xl-margin-top__l08YH\",\"xlMarginTop\":\"style-utils__xl-margin-top__l08YH\",\"xl-padding\":\"style-utils__xl-padding__gDLaP\",\"xlPadding\":\"style-utils__xl-padding__gDLaP\",\"xl-wrap-margin\":\"style-utils__xl-wrap-margin__kSktP\",\"xlWrapMargin\":\"style-utils__xl-wrap-margin__kSktP\",\"flex-basis-10\":\"style-utils__flex-basis-10__JK7ed\",\"flexBasis10\":\"style-utils__flex-basis-10__JK7ed\",\"flex-basis-20\":\"style-utils__flex-basis-20__WYUCu\",\"flexBasis20\":\"style-utils__flex-basis-20__WYUCu\",\"flex-basis-30\":\"style-utils__flex-basis-30___o3Vd\",\"flexBasis30\":\"style-utils__flex-basis-30___o3Vd\",\"flex-basis-40\":\"style-utils__flex-basis-40__wf3lt\",\"flexBasis40\":\"style-utils__flex-basis-40__wf3lt\",\"flex-basis-50\":\"style-utils__flex-basis-50__Or9Ki\",\"flexBasis50\":\"style-utils__flex-basis-50__Or9Ki\",\"flex-basis-60\":\"style-utils__flex-basis-60__Vfos3\",\"flexBasis60\":\"style-utils__flex-basis-60__Vfos3\",\"flex-basis-70\":\"style-utils__flex-basis-70__R1zxM\",\"flexBasis70\":\"style-utils__flex-basis-70__R1zxM\",\"flex-basis-80\":\"style-utils__flex-basis-80__nZyZw\",\"flexBasis80\":\"style-utils__flex-basis-80__nZyZw\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Route } from \"react-router\";\n\n/**\n * A react-router Route that looks for a key/value pair in the state to render something.\n */\nclass StateRoute extends React.Component {\n  static propTypes = {\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    history: PropTypes.object\n  };\n\n  render() {\n    const { history, stateKey, stateValue, ...routeProps } = this.props;\n\n    if (\n      (!history.location.state && !stateValue) ||\n      (history.location.state &&\n        (history.location.state[stateKey] === stateValue || (!history.location.state[stateKey] && !stateValue)))\n    ) {\n      return <Route path=\"/\" {...routeProps} />;\n    }\n\n    return null;\n  }\n}\n\nexport default StateRoute;\n","const MIC_PRESENCE_VOLUME_THRESHOLD = 0.00001;\n\nexport const getMicrophonePresences = (() => {\n  const microphonePresences = new Map();\n  const sessionIds = [];\n  const currentSessionIds = [];\n  return function() {\n    if (!window.APP || !window.APP.componentRegistry) {\n      return null;\n    }\n\n    const sceneEl = AFRAME.scenes[0];\n\n    currentSessionIds.length = 0;\n\n    const playerInfos = window.APP.componentRegistry[\"player-info\"];\n    if (playerInfos) {\n      for (let i = 0; i < playerInfos.length; i++) {\n        const playerInfo = playerInfos[i];\n        const playerSessionId = playerInfo.playerSessionId;\n        let talking = false;\n        if (playerInfo.isLocalPlayerInfo) {\n          talking = sceneEl.systems[\"local-audio-analyser\"].volume > MIC_PRESENCE_VOLUME_THRESHOLD;\n        }\n        if (sessionIds.indexOf(playerSessionId) === -1) {\n          sessionIds.push(playerSessionId);\n        }\n        currentSessionIds.push(playerSessionId);\n        if (microphonePresences.has(playerSessionId)) {\n          const presence = microphonePresences.get(playerSessionId);\n          presence.muted = playerInfo.data.muted;\n          presence.talking = talking;\n        } else {\n          microphonePresences.set(playerSessionId, { muted: playerInfo.data.muted, talking });\n        }\n      }\n    }\n\n    const networkedAudioAnalysers = window.APP.componentRegistry[\"networked-audio-analyser\"];\n    if (networkedAudioAnalysers) {\n      for (let i = 0; i < networkedAudioAnalysers.length; i++) {\n        const networkedAudioAnalyser = networkedAudioAnalysers[i];\n        if (\n          microphonePresences.has(networkedAudioAnalyser.playerSessionId) &&\n          networkedAudioAnalyser.volume > MIC_PRESENCE_VOLUME_THRESHOLD\n        ) {\n          microphonePresences.get(networkedAudioAnalyser.playerSessionId).talking = true;\n        }\n      }\n    }\n\n    for (let i = sessionIds.length - 1; i >= 0; i--) {\n      const sessionId = sessionIds[i];\n      if (currentSessionIds.indexOf(sessionId) === -1) {\n        microphonePresences.delete(sessionId);\n        sessionIds.splice(i, 1);\n      }\n    }\n\n    return microphonePresences;\n  };\n})();\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Sidebar.scss\";\n\nexport function Sidebar({\n  title,\n  beforeTitle,\n  afterTitle,\n  children,\n  contentClassName,\n  className,\n  disableOverflowScroll\n}) {\n  return (\n    <div className={classNames(styles.sidebar, className)}>\n      {(title || beforeTitle || afterTitle) && (\n        <div className={styles.header}>\n          <div className={styles.beforeTitle}>{beforeTitle}</div>\n          <h5>{title}</h5>\n          <div className={styles.afterTitle}>{afterTitle}</div>\n        </div>\n      )}\n      <div className={classNames(styles.content, disableOverflowScroll ? \"\" : styles.overflowY, contentClassName)}>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nSidebar.propTypes = {\n  title: PropTypes.node,\n  beforeTitle: PropTypes.node,\n  afterTitle: PropTypes.node,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  contentClassName: PropTypes.string,\n  disableOverflowScroll: PropTypes.bool\n};\n\nSidebar.defaultProps = {\n  disableOverflowScroll: false\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"sidebar\":\"Sidebar__sidebar__KYENJ\",\"header\":\"Sidebar__header__zbsTL\",\"before-title\":\"Sidebar__before-title__SDmnu\",\"beforeTitle\":\"Sidebar__before-title__SDmnu\",\"after-title\":\"Sidebar__after-title__tQwef\",\"afterTitle\":\"Sidebar__after-title__tQwef\",\"content\":\"Sidebar__content__PP6Vz\",\"overflow-y\":\"Sidebar__overflow-y__iAkyO\",\"overflowY\":\"Sidebar__overflow-y__iAkyO\"};","// extracted by mini-css-extract-plugin\nexport default {\"icon-button\":\"IconButton__icon-button__yRJAL\",\"iconButton\":\"IconButton__icon-button__yRJAL\",\"compact-sm\":\"IconButton__compact-sm__T7cFR\",\"compactSm\":\"IconButton__compact-sm__T7cFR\",\"lg\":\"IconButton__lg__CaPV3\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./IconButton.scss\";\nimport textInputStyles from \"./TextInput.scss\";\n\nexport const IconButton = memo(\n  forwardRef(({ className, as: ButtonComponent, compactSm, lg, children, ...rest }, ref) => {\n    const buttonProps = ButtonComponent === \"button\" ? { type: \"button\" } : {};\n\n    return (\n      <ButtonComponent\n        className={classNames(\n          styles.iconButton,\n          textInputStyles.iconButton,\n          { [styles.compactSm]: compactSm, [styles.lg]: lg },\n          className\n        )}\n        {...buttonProps}\n        {...rest}\n        ref={ref}\n      >\n        {children}\n      </ButtonComponent>\n    );\n  })\n);\n\nIconButton.propTypes = {\n  // compactSm makes the icon button shift to a vertical layout in the \"sm\" (mobile) breakpoint\n  compactSm: PropTypes.bool,\n  lg: PropTypes.bool,\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nIconButton.defaultProps = {\n  as: \"button\"\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"outer-wrapper\":\"TextInput__outer-wrapper__uRuYD\",\"outerWrapper\":\"TextInput__outer-wrapper__uRuYD\",\"input-wrapper\":\"TextInput__input-wrapper__uv7jY\",\"inputWrapper\":\"TextInput__input-wrapper__uv7jY\",\"before-input\":\"TextInput__before-input__PyF6b\",\"beforeInput\":\"TextInput__before-input__PyF6b\",\"after-input\":\"TextInput__after-input__gJzy3\",\"afterInput\":\"TextInput__after-input__gJzy3\",\"button\":\"TextInput__button__QrvX4\",\"icon-button\":\"TextInput__icon-button__GFPbS\",\"iconButton\":\"TextInput__icon-button__GFPbS\",\"disabled\":\"TextInput__disabled__tE3wE\",\"invalid\":\"TextInput__invalid__fgYQd\",\"text-input\":\"TextInput__text-input__HqvuV\",\"textInput\":\"TextInput__text-input__HqvuV\",\"invalid-icon\":\"TextInput__invalid-icon__CszSQ\",\"invalidIcon\":\"TextInput__invalid-icon__CszSQ\"};","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgClose = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17 17 3 3\",\n    stroke: \"currentColor\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17 3 3 17\",\n    stroke: \"currentColor\",\n    strokeWidth: 2,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgClose as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as CloseIcon } from \"../icons/Close.svg\";\nimport styles from \"./CloseButton.scss\";\n\nexport function CloseButton({ lg, className, ...rest }) {\n  return (\n    <IconButton className={classNames({ [styles.lg]: lg }, className)} {...rest}>\n      <CloseIcon width={16} height={16} />\n    </IconButton>\n  );\n}\n\nCloseButton.propTypes = {\n  className: PropTypes.string,\n  lg: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"back-button\":\"BackButton__back-button__tGiDz\",\"backButton\":\"BackButton__back-button__tGiDz\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgChevronBack = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14 3-7 7 7 7\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgChevronBack as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./BackButton.scss\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as ChevronBackIcon } from \"../icons/ChevronBack.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function BackButton({ className, ...rest }) {\n  return (\n    <IconButton className={classNames(styles.backButton, className)} {...rest}>\n      <ChevronBackIcon />\n      <span>\n        <FormattedMessage id=\"back-button\" defaultMessage=\"Back\" />\n      </span>\n    </IconButton>\n  );\n}\n\nBackButton.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"button\":\"Button__button__SO7tb\",\"basic\":\"Button__basic__dX1eF\",\"transparent\":\"Button__transparent__Xwl1d\",\"primary\":\"Button__primary__V_Unf\",\"accept\":\"Button__accept__Vxz39\",\"cancel\":\"Button__cancel__fMd88\",\"accent1\":\"Button__accent1__YxQTQ\",\"accent2\":\"Button__accent2__csjI4\",\"accent3\":\"Button__accent3__lDoUQ\",\"accent4\":\"Button__accent4__rpZEP\",\"accent5\":\"Button__accent5__CtJzN\",\"accent6\":\"Button__accent6__f31oh\",\"sm\":\"Button__sm__SbzRJ\",\"lg\":\"Button__lg__W7ykj\",\"xl\":\"Button__xl__ppsaD\",\"thin\":\"Button__thin__QLHYO\",\"thick\":\"Button__thick__RwZJD\",\"signin\":\"Button__signin__dunbY\",\"landing\":\"Button__landing__zi2zl\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Button.scss\";\nimport textInputStyles from \"./TextInput.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport const presets = [\n  \"transparent\",\n  \"basic\",\n  \"primary\",\n  \"accept\",\n  \"cancel\",\n  \"accent1\",\n  \"accent2\",\n  \"accent3\",\n  \"accent4\",\n  \"accent5\",\n  \"accent6\",\n  \"landing\",\n  \"signin\"\n];\n\nexport const Button = memo(\n  forwardRef(({ as, sm, lg, xl, thin, thick, preset, className, children, ...rest }, ref) => {\n    const ButtonComponent = as;\n    const buttonProps = ButtonComponent === \"button\" ? { type: \"button\" } : {};\n\n    return (\n      <ButtonComponent\n        className={classNames(\n          styles.button,\n          textInputStyles.button,\n          styles[preset],\n          {\n            [styles.sm]: sm,\n            [styles.lg]: lg,\n            [styles.xl]: xl,\n            [styles.thin]: thin,\n            [styles.thick]: thick\n          },\n          className\n        )}\n        {...buttonProps}\n        {...rest}\n        ref={ref}\n      >\n        {children}\n      </ButtonComponent>\n    );\n  })\n);\n\nButton.propTypes = {\n  as: PropTypes.elementType,\n  preset: PropTypes.oneOf(presets),\n  className: PropTypes.string,\n  children: PropTypes.node,\n  sm: PropTypes.bool\n};\n\nButton.defaultProps = {\n  as: \"button\",\n  preset: \"basic\"\n};\n\nexport function NextButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.next\" defaultMessage=\"Next\" />\n    </Button>\n  );\n}\n\nexport function CancelButton(props) {\n  return (\n    <Button preset=\"cancel\" {...props}>\n      <FormattedMessage id=\"button.cancel\" defaultMessage=\"Cancel\" />\n    </Button>\n  );\n}\n\nexport function ContinueButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.continue\" defaultMessage=\"Continue\" />\n    </Button>\n  );\n}\n\nexport function AcceptButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.accept\" defaultMessage=\"Accept\" />\n    </Button>\n  );\n}\n\nexport function ApplyButton(props) {\n  return (\n    <Button preset=\"accept\" {...props}>\n      <FormattedMessage id=\"button.apply\" defaultMessage=\"Apply\" />\n    </Button>\n  );\n}\n","import React, { memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./InputField.scss\";\n\nexport const InputField = memo(\n  ({ id, htmlFor, label, error, description, className, fullWidth, children, ...rest }) => {\n    return (\n      <div className={classNames(styles.inputField, { [styles.fullWidth]: fullWidth }, className)} {...rest}>\n        {label && (\n          <label id={id} className={styles.label} htmlFor={htmlFor}>\n            {label}\n          </label>\n        )}\n        {children}\n        {error ? (\n          <small className={styles.error}>{error}</small>\n        ) : description ? (\n          <small className={styles.info}>{description}</small>\n        ) : (\n          undefined\n        )}\n      </div>\n    );\n  }\n);\n\nInputField.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  fullWidth: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"label\":\"InputField__label__gaP9K\",\"input-field\":\"InputField__input-field__L7dXt\",\"inputField\":\"InputField__input-field__L7dXt\",\"fullWidth\":\"InputField__fullWidth__BMV9Y\",\"error\":\"InputField__error__xVt9D\",\"info\":\"InputField__info__KHxQ_\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgWarning = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.343 17.43h13.314a1.25 1.25 0 0 0 1.1-1.842L11.102 3.223a1.25 1.25 0 0 0-2.202 0L2.242 15.588a1.25 1.25 0 0 0 1.1 1.842v0Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.776 7.632 10 12.398l.224-4.764a.225.225 0 0 0-.227-.234v0a.224.224 0 0 0-.221.232v0Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 15.517a.782.782 0 1 1 0-1.563.782.782 0 0 1 0 1.563Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgWarning as ReactComponent };","import screenfull from \"screenfull\";\nimport { showFullScreenIfWasFullScreen } from \"./fullscreen\";\nconst { detect } = require(\"detect-browser\");\n\nconst browser = detect();\nlet isExitingFullscreenDueToFocus = false;\n\n// Utility function that handles a bunch of incidental stuff related to text fields:\n//\n// - On non-mobile platforms, selects the value on focus\n// - If full screen, exits/enters full screen because of firefox full screen issues\nexport function handleTextFieldFocus(target) {\n  if (!window.AFRAME) return;\n  const isMobile = AFRAME.utils.device.isMobile();\n\n  if (screenfull.isFullscreen && !AFRAME.utils.device.isMobileVR() && browser.name === \"firefox\") {\n    // This will prevent focus, but its the only way to avoid getting into a\n    // weird \"firefox reports full screen but actually not\". You end up having to tap\n    // twice to ultimately get the focus.\n    //\n    // We need to keep track of a bit here so that we don't re-full screen when\n    // the text box is blurred by the browser.\n\n    isExitingFullscreenDueToFocus = true;\n    screenfull.exit().then(() => {\n      target.focus();\n    });\n  }\n\n  if (!isMobile) target.select();\n}\n\nexport function handleTextFieldBlur() {\n  // This is the incidental blur event when exiting fullscreen mode on mobile\n  if (isExitingFullscreenDueToFocus) {\n    isExitingFullscreenDueToFocus = false;\n    return;\n  }\n\n  showFullScreenIfWasFullScreen();\n}\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./TextInput.scss\";\nimport { ReactComponent as WarningIcon } from \"../icons/Warning.svg\";\nimport buttonStyles from \"./Button.scss\";\nimport iconButtonStyles from \"./IconButton.scss\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../../utils/focus-utils\";\n\nexport const TextInput = memo(\n  forwardRef(\n    (\n      {\n        id,\n        disabled,\n        invalid,\n        className,\n        beforeInput,\n        afterInput,\n        onFocus,\n        onBlur,\n        textInputStyles,\n        as: InputElement,\n        ...rest\n      },\n      ref\n    ) => {\n      // TODO: This is REALLY bad. We're overriding default behavior of text inputs to get a fullscreen behavior to work on Firefox.\n      // It also selects the contents of the text input which is not always something you want to do. If we can remove this, we absolutely should.\n      const handleFocus = e => {\n        handleTextFieldFocus(e.target);\n\n        if (onFocus) {\n          onFocus(e);\n        }\n      };\n\n      const handleBlur = e => {\n        handleTextFieldBlur();\n\n        if (onBlur) {\n          onBlur(e);\n        }\n      };\n\n      return (\n        <div\n          className={classNames(\n            styles.outerWrapper,\n            buttonStyles.inputGroup,\n            iconButtonStyles.inputGroup,\n            { [styles.invalid]: invalid, [styles.disabled]: disabled },\n            className\n          )}\n        >\n          <div className={styles.beforeInput}>{beforeInput}</div>\n          <div className={styles.inputWrapper}>\n            <InputElement\n              id={id}\n              className={classNames(styles.textInput, textInputStyles)}\n              disabled={disabled}\n              onFocus={handleFocus}\n              onBlur={handleBlur}\n              {...rest}\n              ref={ref}\n            />\n          </div>\n          <div className={styles.afterInput}>\n            {invalid && <WarningIcon className={styles.invalidIcon} />}\n            {afterInput}\n          </div>\n        </div>\n      );\n    }\n  )\n);\n\nTextInput.propTypes = {\n  id: PropTypes.string.isRequired,\n  disabled: PropTypes.bool,\n  invalid: PropTypes.bool,\n  className: PropTypes.string,\n  onChange: PropTypes.func,\n  beforeInput: PropTypes.node,\n  afterInput: PropTypes.node,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  textInputStyles: PropTypes.string,\n  as: PropTypes.elementType\n};\n\nTextInput.defaultProps = {\n  onChange: () => {},\n  as: \"input\"\n};\n","import { useState } from \"react\";\n\nconst idPrefix = \"id_\";\n\nlet nextId = 0;\n\n// Note: React 17 introduced the experimental unstable_useOpaqueIdentifier hook. We'll want to switch to this in the future.\nexport function useId() {\n  const [id] = useState(() => idPrefix + nextId++);\n  return id;\n}\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { TextInput } from \"./TextInput\";\nimport { useId } from \"./useId\";\n\nexport const TextInputField = memo(\n  forwardRef(({ className, error, description, inputClassName, label, fullWidth, ...rest }, ref) => {\n    const id = useId();\n    const labelId = useId();\n\n    return (\n      <InputField\n        id={labelId}\n        htmlFor={id}\n        className={className}\n        label={label}\n        error={error}\n        description={description}\n        fullWidth={fullWidth}\n      >\n        <TextInput id={id} ref={ref} className={inputClassName} {...rest} />\n      </InputField>\n    );\n  })\n);\n\nTextInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  fullWidth: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"column\":\"Column__column__ZuRI0\",\"xs-gap\":\"Column__xs-gap__PAIcR\",\"xsGap\":\"Column__xs-gap__PAIcR\",\"sm-gap\":\"Column__sm-gap__j3Pc1\",\"smGap\":\"Column__sm-gap__j3Pc1\",\"md-gap\":\"Column__md-gap__YLriB\",\"mdGap\":\"Column__md-gap__YLriB\",\"lg-gap\":\"Column__lg-gap__ferMl\",\"lgGap\":\"Column__lg-gap__ferMl\",\"xl-gap\":\"Column__xl-gap__mso6a\",\"xlGap\":\"Column__xl-gap__mso6a\",\"xs-padding\":\"Column__xs-padding__vnqZ1\",\"xsPadding\":\"Column__xs-padding__vnqZ1\",\"sm-padding\":\"Column__sm-padding__DvAmG\",\"smPadding\":\"Column__sm-padding__DvAmG\",\"md-padding\":\"Column__md-padding__k6ZWh\",\"mdPadding\":\"Column__md-padding__k6ZWh\",\"lg-padding\":\"Column__lg-padding__SlnQw\",\"lgPadding\":\"Column__lg-padding__SlnQw\",\"xl-padding\":\"Column__xl-padding__TOmJS\",\"xlPadding\":\"Column__xl-padding__TOmJS\",\"center\":\"Column__center__kI2HA\",\"center-vertical\":\"Column__center-vertical__Uzq_X\",\"centerVertical\":\"Column__center-vertical__Uzq_X\",\"center-md\":\"Column__center-md__fjQvr\",\"centerMd\":\"Column__center-md__fjQvr\",\"center-vertical-md\":\"Column__center-vertical-md__cpCgX\",\"centerVerticalMd\":\"Column__center-vertical-md__cpCgX\",\"grow\":\"Column__grow__DxOwX\",\"overflow\":\"Column__overflow__NUMaz\",\"margin-0-last-child\":\"Column__margin-0-last-child__aJIlP\",\"margin0LastChild\":\"Column__margin-0-last-child__aJIlP\"};","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Column.scss\";\n\nexport const Column = forwardRef(\n  (\n    { as: Component, lastChildMargin, className, gap, padding, center, centerMd, grow, overflow, children, ...rest },\n    ref\n  ) => {\n    const gapClass = gap === true ? styles.mdGap : styles[`${gap}Gap`];\n    const paddingClass = padding === true ? styles.lgPadding : styles[`${padding}Padding`];\n\n    return (\n      <Component\n        {...rest}\n        ref={ref}\n        className={classNames(\n          styles.column,\n          gapClass,\n          paddingClass,\n          {\n            [styles.center]: center === true || center === \"horizontal\" || center === \"both\",\n            [styles.centerVertical]: center === \"vertical\" || center === \"both\",\n            [styles.centerMd]: centerMd === true || centerMd === \"horizontal\" || centerMd === \"both\",\n            [styles.centerVerticalMd]: centerMd === \"vertical\" || centerMd === \"both\",\n            [styles.grow]: grow,\n            [styles.overflow]: overflow,\n            [styles.margin0LastChild]: lastChildMargin\n          },\n          className\n        )}\n      >\n        {children}\n      </Component>\n    );\n  }\n);\n\nColumn.propTypes = {\n  as: PropTypes.elementType,\n  className: PropTypes.string,\n  children: PropTypes.node,\n  gap: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  padding: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  centerMd: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  center: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  grow: PropTypes.bool,\n  lastChildMargin: PropTypes.bool,\n  overflow: PropTypes.bool\n};\n\nColumn.defaultProps = {\n  as: \"div\",\n  gap: \"md\",\n  center: false,\n  centerMd: false,\n  padding: false,\n  grow: false,\n  overflow: false,\n  lastChildMargin: true\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Button, AcceptButton } from \"../input/Button\";\nimport styles from \"./AvatarSettingsContent.scss\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function AvatarSettingsContent({\n  displayName,\n  displayNameInputRef,\n  disableDisplayNameInput,\n  onChangeDisplayName,\n  avatarPreview,\n  displayNamePattern,\n  onChangeAvatar,\n  ...rest\n}) {\n  return (\n    <Column as=\"form\" className={styles.content} {...rest}>\n      <TextInputField\n        disabled={disableDisplayNameInput}\n        label={<FormattedMessage id=\"avatar-settings-content.display-name-label\" defaultMessage=\"Display Name\" />}\n        value={displayName}\n        pattern={displayNamePattern}\n        spellCheck=\"false\"\n        required\n        onChange={onChangeDisplayName}\n        description={\n          <FormattedMessage\n            id=\"avatar-settings-content.display-name-description\"\n            defaultMessage=\"Alphanumerics, hyphens, underscores, and tildes. At least 3 characters, no more than 32\"\n          />\n        }\n        ref={displayNameInputRef}\n      />\n      <div className={styles.avatarPreviewContainer}>\n        {avatarPreview || <div />}\n        <Button type=\"button\" preset=\"basic\" onClick={onChangeAvatar}>\n          <FormattedMessage id=\"avatar-settings-content.change-avatar-button\" defaultMessage=\"Change Avatar\" />\n        </Button>\n      </div>\n      <AcceptButton preset=\"accept\" type=\"submit\" />\n    </Column>\n  );\n}\n\nAvatarSettingsContent.propTypes = {\n  className: PropTypes.string,\n  displayName: PropTypes.string,\n  displayNameInputRef: PropTypes.func,\n  disableDisplayNameInput: PropTypes.bool,\n  displayNamePattern: PropTypes.string,\n  onChangeDisplayName: PropTypes.func,\n  avatarPreview: PropTypes.node,\n  onChangeAvatar: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"AvatarSettingsContent__content__Os6X7\",\"avatar-preview-container\":\"AvatarSettingsContent__avatar-preview-container__PmJlf\",\"avatarPreviewContainer\":\"AvatarSettingsContent__avatar-preview-container__PmJlf\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { BackButton } from \"../input/BackButton\";\nimport { AvatarSettingsContent } from \"./AvatarSettingsContent\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function AvatarSettingsSidebar({ className, showBackButton, onBack, onClose, ...rest }) {\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"avatar-settings-sidebar.title\" defaultMessage=\"Avatar Settings\" />}\n      beforeTitle={showBackButton ? <BackButton onClick={onBack} /> : <CloseButton onClick={onClose} />}\n      className={className}\n    >\n      <AvatarSettingsContent {...rest} />\n    </Sidebar>\n  );\n}\n\nAvatarSettingsSidebar.propTypes = {\n  showBackButton: PropTypes.bool,\n  className: PropTypes.string,\n  onBack: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Modal.scss\";\n\nexport function Modal({\n  title,\n  titleNode,\n  beforeTitle,\n  afterTitle,\n  children,\n  contentClassName,\n  className,\n  disableFullscreen\n}) {\n  return (\n    <div className={classNames(styles.modal, { [styles.smFullscreen]: !disableFullscreen }, className)}>\n      {(title || beforeTitle || afterTitle) && (\n        <div className={styles.header}>\n          <div className={styles.beforeTitle}>{beforeTitle}</div>\n          {titleNode ? titleNode : <h5>{title}</h5>}\n          <div className={styles.afterTitle}>{afterTitle}</div>\n        </div>\n      )}\n      <div className={classNames(styles.content, contentClassName)}>{children}</div>\n    </div>\n  );\n}\n\nModal.propTypes = {\n  title: PropTypes.node,\n  titleNode: PropTypes.node,\n  beforeTitle: PropTypes.node,\n  afterTitle: PropTypes.node,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  contentClassName: PropTypes.string,\n  disableFullscreen: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"modal\":\"Modal__modal__kXfrn\",\"header\":\"Modal__header__Y8MjO\",\"before-title\":\"Modal__before-title___noRj\",\"beforeTitle\":\"Modal__before-title___noRj\",\"after-title\":\"Modal__after-title__i3h06\",\"afterTitle\":\"Modal__after-title__i3h06\",\"content\":\"Modal__content__qgHt_\",\"sm-fullscreen\":\"Modal__sm-fullscreen__XA0fq\",\"smFullscreen\":\"Modal__sm-fullscreen__XA0fq\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { BackButton } from \"../input/BackButton\";\nimport { AvatarSettingsContent } from \"./AvatarSettingsContent\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function AvatarSetupModal({ className, onBack, ...rest }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"avatar-setup-sidebar.title\" defaultMessage=\"Avatar Setup\" />}\n      beforeTitle={<BackButton onClick={onBack} />}\n      className={className}\n    >\n      <AvatarSettingsContent {...rest} />\n    </Modal>\n  );\n}\n\nAvatarSetupModal.propTypes = {\n  className: PropTypes.string,\n  onBack: PropTypes.func\n};\n","import cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBAFormat;\n  return texture;\n}\n","export const createImageBitmap =\n  window.createImageBitmap ||\n  async function(data) {\n    return new Promise(resolve => {\n      // https://dev.to/nektro/createimagebitmap-polyfill-for-safari-and-edge-228\n      // https://gist.github.com/MonsieurV/fb640c29084c171b4444184858a91bc7\n\n      let srcUrl;\n      if (data instanceof Blob) {\n        srcUrl = URL.createObjectURL(data);\n      } else {\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        canvas.width = data.width;\n        canvas.height = data.height;\n        ctx.putImageData(data, 0, 0);\n        srcUrl = canvas.toDataURL();\n      }\n      const img = document.createElement(\"img\");\n\n      img.addEventListener(\"load\", () => resolve(img));\n\n      img.src = srcUrl;\n    });\n  };\n\nexport function disposeImageBitmap(imageBitmap) {\n  if (imageBitmap instanceof HTMLImageElement && imageBitmap.src.startsWith(\"blob:\")) {\n    URL.revokeObjectURL(imageBitmap.src);\n  } else {\n    imageBitmap.close && imageBitmap.close();\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"preview\":\"avatar-preview__preview__Exp7B\"};","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport { getColorSchemePref } from \"../utils/get-color-scheme-pref\";\nimport classNames from \"classnames\";\n\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\n\nimport { createDefaultEnvironmentMap } from \"../components/environment-map\";\nimport { loadGLTF } from \"../components/gltf-model-plus\";\nimport { disposeNode, findNode } from \"../utils/three-utils\";\nimport { ensureAvatarMaterial, MAT_NAME } from \"../utils/avatar-utils\";\nimport { createImageBitmap, disposeImageBitmap } from \"../utils/image-bitmap-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport styles from \"../assets/stylesheets/avatar-preview.scss\";\n\nconst TEXTURE_PROPS = {\n  base_map: [\"map\"],\n  emissive_map: [\"emissiveMap\"],\n  normal_map: [\"normalMap\"],\n  orm_map: [\"aoMap\", \"roughnessMap\", \"metalnessMap\"]\n};\n\nconst ALL_MAPS = Object.keys(TEXTURE_PROPS);\n\n// This should match our aframe renderer=\"antialias: true; colorManagement: true; sortObjects: true;\n// physicallyCorrectLights: true; webgl2: true; multiview: false;\"\nfunction createRenderer(canvas, alpha = false, useDevicePixelRatio = true) {\n  const context = canvas.getContext(\"webgl2\", {\n    alpha,\n    depth: true,\n    antialias: true,\n    premultipliedAlpha: true,\n    preserveDrawingBuffer: false,\n    powerPreference: \"default\"\n  });\n\n  const renderer = new THREE.WebGLRenderer({ alpha, canvas, context, forceWebVR: true });\n  renderer.outputEncoding = THREE.sRGBEncoding;\n  renderer.physicallyCorrectLights = true;\n  if (useDevicePixelRatio) {\n    renderer.setPixelRatio(window.devicePixelRatio);\n  }\n  return renderer;\n}\n\nconst createImageBitmapFromURL = url =>\n  fetch(url)\n    .then(r => r.blob())\n    .then(createImageBitmap);\n\nconst ORBIT_ANGLE = new THREE.Euler(-30 * THREE.MathUtils.DEG2RAD, 30 * THREE.MathUtils.DEG2RAD, 0);\nconst DEFAULT_MARGIN = 1;\n\nfunction fitBoxInFrustum(camera, box, center, margin = DEFAULT_MARGIN) {\n  const halfYExtents = Math.max(box.max.y - center.y, center.y - box.min.y);\n  const halfVertFOV = THREE.MathUtils.degToRad(camera.fov / 2);\n  camera.position.set(0, 0, (halfYExtents / Math.tan(halfVertFOV) + box.max.z) * margin);\n  camera.position.applyEuler(ORBIT_ANGLE);\n  camera.position.add(center);\n  camera.lookAt(center);\n}\n\nfunction getThemeBackground() {\n  const currentTheme = APP?.store?.state?.preferences?.theme;\n  const themes = window.APP_CONFIG?.theme?.themes;\n  const currentThemeObject = themes?.find(t => t.id === currentTheme) || getColorSchemePref();\n  const previewBackgroundColor = new THREE.Color(currentThemeObject?.variables[\"background3-color\"] || 0xeaeaea);\n  return previewBackgroundColor;\n}\n\nclass AvatarPreview extends Component {\n  static propTypes = {\n    avatarGltfUrl: PropTypes.string,\n    className: PropTypes.string,\n    onGltfLoaded: PropTypes.func\n  };\n  constructor(props) {\n    super(props);\n    this.state = { loading: true, error: null };\n    this.avatar = null;\n    this.imageBitmaps = {};\n    this.mounted = false;\n  }\n\n  componentDidMount = () => {\n    this.scene = new THREE.Scene();\n\n    this.camera = new THREE.PerspectiveCamera(55, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 1000);\n    this.controls = new OrbitControls(this.camera, this.canvas);\n    this.controls.screenSpacePanning = true;\n    this.controls.enableKeys = true;\n\n    const light = new THREE.DirectionalLight(0xf7f6ef, 1);\n    light.position.set(0, 10, 10);\n    this.scene.add(light);\n    this.scene.add(new THREE.HemisphereLight(0xb1e3ff, 0xb1e3ff, 2.5));\n\n    this.loadId = 0;\n\n    this.camera.position.set(-0.2, 0.5, 0.5);\n    this.camera.matrixAutoUpdate = true;\n\n    this.controls.target.set(0, 0.45, 0);\n    this.controls.update();\n\n    if (this.props.avatarGltfUrl) {\n      this.loadCurrentAvatarGltfUrl();\n    }\n\n    const clock = new THREE.Clock();\n\n    this.snapshotCanvas = document.createElement(\"canvas\");\n    this.snapshotCanvas.width = 720;\n    this.snapshotCanvas.height = 1280;\n    this.snapshotCamera = new THREE.PerspectiveCamera(55, 720 / 1280, 0.1, 1000);\n    this.snapshotCamera.matrixAutoUpdate = true;\n    this.snapshotRenderer = createRenderer(this.snapshotCanvas, true, false);\n    this.snapshotRenderer.setClearAlpha(0);\n\n    this.previewRenderer = createRenderer(this.canvas);\n    this.previewRenderer.setClearColor(getThemeBackground());\n    this.previewRenderer.setAnimationLoop(() => {\n      const dt = clock.getDelta();\n      this.mixer && this.mixer.update(dt);\n      this.previewRenderer.render(this.scene, this.camera);\n    });\n    window.addEventListener(\"resize\", this.resize);\n    this.resize();\n\n    this.mounted = true;\n  };\n\n  resize = () => {\n    const width = this.canvas.parentElement.offsetWidth;\n    const height = this.canvas.parentElement.offsetHeight;\n    this.previewRenderer.setSize(width, height);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  };\n\n  setAvatar = avatar => {\n    if (!avatar) return;\n    this.avatar = avatar;\n    this.scene.add(avatar);\n    this.resetCamera();\n    this.setState({ error: null, loading: false });\n  };\n\n  resetCamera = (() => {\n    const box = new THREE.Box3();\n    const center = new THREE.Vector3();\n    return () => {\n      box.setFromObject(this.avatar);\n      box.getCenter(center);\n\n      // Shift the center vertically in order to frame the avatar nicely.\n      center.y = (box.max.y - box.min.y) * 0.6 + box.min.y;\n\n      fitBoxInFrustum(this.camera, box, center);\n      fitBoxInFrustum(this.snapshotCamera, box, center, 0.7);\n\n      this.controls.target.copy(center);\n      this.controls.update();\n    };\n  })();\n\n  componentWillUnmount = () => {\n    this.mounted = false;\n\n    // Gotta be particularly careful about disposing things here since we will likely create many avatar\n    // previews during a session and Chrome will eventually discard the oldest webgl context if we leak\n    // contexts by holding on to them directly or indirectly.\n\n    this.scene && this.scene.traverse(disposeNode);\n    if (this.previewRenderer) {\n      this.previewRenderer.dispose();\n    }\n    if (this.snapshotRenderer) {\n      this.snapshotRenderer.dispose();\n    }\n    if (this.controls) {\n      this.controls.dispose();\n      this.controls.domElement = null;\n    }\n\n    Object.values(this.imageBitmaps).forEach(img => disposeImageBitmap(img));\n    window.removeEventListener(\"resize\", this.resize);\n  };\n\n  componentDidUpdate = async oldProps => {\n    if (oldProps.avatarGltfUrl !== this.props.avatarGltfUrl) {\n      if (this.avatar) {\n        this.scene.remove(this.avatar);\n        this.avatar = null;\n      }\n      if (this.props.avatarGltfUrl) {\n        this.setState({ error: null, loading: true });\n        await this.loadCurrentAvatarGltfUrl();\n      }\n    }\n    this.applyMaps(oldProps, this.props);\n  };\n\n  async loadCurrentAvatarGltfUrl() {\n    const newLoadId = ++this.loadId;\n    const url = proxiedUrlFor(this.props.avatarGltfUrl);\n    const gltf = await this.loadPreviewAvatar(url);\n    // If we had started loading another avatar while we were loading this one, throw this one away\n    if (!this.mounted || newLoadId !== this.loadId) return;\n    if (gltf && this.props.onGltfLoaded) this.props.onGltfLoaded(gltf);\n    this.setAvatar(gltf.scene);\n  }\n\n  applyMaps(oldProps, newProps) {\n    return Promise.all(\n      ALL_MAPS.map(mapName => {\n        const applyMap = this.applyMapToPreview.bind(this, mapName);\n        if (oldProps[mapName] != newProps[mapName]) {\n          if (newProps[mapName] instanceof File) {\n            return createImageBitmap(newProps[mapName]).then(applyMap);\n          } else if (newProps[mapName]) {\n            return createImageBitmapFromURL(newProps[mapName]).then(applyMap);\n          } else {\n            return this.revertMap(mapName);\n          }\n        }\n      })\n    );\n  }\n\n  loadPreviewAvatar = async avatarGltfUrl => {\n    let gltf;\n    try {\n      gltf = await loadGLTF(avatarGltfUrl, \"model/gltf\", null, ensureAvatarMaterial);\n    } catch (e) {\n      console.error(\"Failed to load avatar preview\", e);\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    if (!this.mounted) return;\n\n    // TODO Check for \"Bot_Skinned\" here is a hack for legacy avatars which only has a name one of the MOZ_alt_material nodes\n    this.previewMesh = findNode(\n      gltf.scene,\n      n => (n.isMesh && n.material && n.material.name === MAT_NAME) || n.name === \"Bot_Skinned\"\n    );\n\n    if (!this.previewMesh) {\n      console.error(\"Failed to find avatar preview mesh\");\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    const idleAnimation = gltf.animations && gltf.animations.find(({ name }) => name === \"idle_eyes\");\n    if (idleAnimation) {\n      this.mixer = new THREE.AnimationMixer(gltf.scene);\n      const action = this.mixer.clipAction(idleAnimation);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.idleAnimationAction = action;\n    }\n\n    gltf.scene.traverse(node => {\n      // Camera in preview is pretty tight, and skinned meshes tend to have poor bounding boxes\n      if (node.isSkinnedMesh) {\n        node.frustumCulled = false;\n      }\n\n      // We delete onUpdate here to opt out of the auto texture cleanup after GPU upload.\n      if (node.material) {\n        const removeOnUpdate = p => node.material[p] && delete node.material[p].onUpdate;\n        TEXTURE_PROPS[\"base_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"emissive_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"normal_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"orm_map\"].forEach(removeOnUpdate);\n      }\n    });\n\n    const { material } = this.previewMesh;\n    if (material) {\n      const getImage = p => material[p] && material[p].image;\n      this.originalMaps = {\n        base_map: TEXTURE_PROPS[\"base_map\"].map(getImage),\n        emissive_map: TEXTURE_PROPS[\"emissive_map\"].map(getImage),\n        normal_map: TEXTURE_PROPS[\"normal_map\"].map(getImage),\n        orm_map: TEXTURE_PROPS[\"orm_map\"].map(getImage)\n      };\n\n      const dependencies = [\n        this.applyMaps({}, this.props) // Apply initial maps\n      ];\n\n      // Low and medium quality materials don't use environment maps\n      if (window.APP.store.state.preferences.materialQualitySetting === \"high\") {\n        dependencies.push(\n          // TODO apply environment map to secondary materials as well\n          createDefaultEnvironmentMap().then(t => {\n            this.previewMesh.material.envMap = t;\n            this.previewMesh.material.needsUpdate = true;\n          })\n        );\n      }\n\n      await Promise.all(dependencies);\n    } else {\n      this.originalMaps = {};\n    }\n\n    return gltf;\n  };\n\n  applyMapToPreview = (name, image) => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    this.imageBitmaps[name] = image;\n    TEXTURE_PROPS[name].forEach(prop => {\n      const texture = this.previewMesh.material[prop];\n\n      // Low quality materials are missing normal maps\n      if (prop === \"normalMap\" && window.APP.store.state.preferences.materialQualitySetting === \"low\") {\n        return;\n      }\n\n      // Medium Quality materials are missing metalness and roughness maps\n      if (\n        (prop === \"roughnessMap\" || prop === \"metalnessMap\") &&\n        window.APP.store.state.preferences.materialQualitySetting !== \"high\"\n      ) {\n        return;\n      }\n\n      texture.image = image;\n      texture.needsUpdate = true;\n    });\n  };\n\n  revertMap = name => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    delete this.imageBitmaps[name];\n    this.originalMaps[name].forEach((bm, i) => {\n      const texture = this.previewMesh.material[TEXTURE_PROPS[name][i]];\n\n      if (texture) {\n        texture.image = bm;\n        texture.needsUpdate = true;\n      }\n    });\n  };\n\n  snapshot = () => {\n    return new Promise(resolve => {\n      if (this.idleAnimationAction) this.idleAnimationAction.stop();\n      this.snapshotCamera.position.copy(this.camera.position);\n      this.snapshotCamera.rotation.copy(this.camera.rotation);\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\n      this.snapshotCanvas.toBlob(blob => {\n        if (this.idleAnimationAction) this.idleAnimationAction.play();\n        resolve(blob);\n      });\n    });\n  };\n\n  render() {\n    return (\n      <div className={classNames(styles.preview, this.props.className)}>\n        {!this.props.avatarGltfUrl ||\n          (this.state.loading && !this.state.error && (\n            <div className=\"loader\">\n              <div className=\"loader-center\" />\n            </div>\n          ))}\n        {this.props.avatarGltfUrl && this.state.error && !this.state.loading && (\n          <div className=\"error\">\n            <img\n              src=\"../assets/images/warning_icon.png\"\n              srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n              className=\"error-icon\"\n            />\n            <FormattedMessage\n              id=\"avatar-preview.loading-failed\"\n              defaultMessage=\"Loading failed{linebreak}Please choose another avatar\"\n              values={{ linebreak: <br /> }}\n            />\n          </div>\n        )}\n        <canvas ref={c => (this.canvas = c)} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarPreview, { forwardRef: true });\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { fetchAvatar } from \"../utils/avatar-utils\";\nimport { replaceHistoryState } from \"../utils/history\";\nimport { AvatarSettingsSidebar } from \"./room/AvatarSettingsSidebar\";\nimport { AvatarSetupModal } from \"./room/AvatarSetupModal\";\nimport AvatarPreview from \"./avatar-preview\";\n\nexport default class ProfileEntryPanel extends Component {\n  static propTypes = {\n    containerType: PropTypes.oneOf([\"sidebar\", \"modal\"]),\n    displayNameOverride: PropTypes.string,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    messages: PropTypes.object,\n    finished: PropTypes.func,\n    history: PropTypes.object,\n    avatarId: PropTypes.string,\n    onClose: PropTypes.func,\n    onBack: PropTypes.func,\n    showBackButton: PropTypes.bool\n  };\n\n  static defaultProps = {\n    containerType: \"modal\"\n  };\n\n  state = {\n    avatarId: null,\n    displayName: null,\n    avatar: null\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStateFromProfile();\n    if (props.avatarId) {\n      this.state.avatarId = props.avatarId;\n    }\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.scene = document.querySelector(\"a-scene\");\n  }\n\n  getStateFromProfile = () => {\n    const { displayName, avatarId } = this.props.store.state.profile;\n    return { displayName, avatarId };\n  };\n\n  storeUpdated = () => this.setState(this.getStateFromProfile());\n\n  saveStateAndFinish = e => {\n    e && e.preventDefault();\n\n    const { displayName } = this.props.store.state.profile;\n    const { hasChangedName } = this.props.store.state.activity;\n\n    const hasChangedNowOrPreviously = hasChangedName || this.state.displayName !== displayName;\n    this.props.store.update({\n      activity: {\n        hasChangedName: hasChangedNowOrPreviously,\n        hasAcceptedProfile: true\n      },\n      profile: {\n        displayName: this.state.displayName,\n        avatarId: this.state.avatarId\n      }\n    });\n    this.props.finished();\n    this.scene.emit(\"avatar_updated\");\n  };\n\n  stopPropagation = e => {\n    e.stopPropagation();\n  };\n\n  setAvatarFromMediaResult = ({ detail: { entry, selectAction } }) => {\n    if ((entry.type !== \"avatar\" && entry.type !== \"avatar_listing\") || selectAction !== \"use\") return;\n\n    this.setState({ avatarId: entry.id });\n    // Replace history state with the current avatar id since this component gets destroyed when we open the\n    // avatar editor and we want the back button to work. We read the history state back via the avatarId prop.\n    // We read the current state key from history since it could be \"overlay\" or \"entry_step\".\n    replaceHistoryState(this.props.history, this.props.history.location.state.key, \"profile\", { avatarId: entry.id });\n  };\n\n  componentDidMount() {\n    if (this.nameInput) {\n      // stop propagation so that avatar doesn't move when wasd'ing during text input.\n      this.nameInput.addEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.addEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    // This handles editing avatars in the entry_step, since this component remains mounted with the same avatarId\n    this.scene.addEventListener(\"action_avatar_saved\", this.refetchAvatar);\n\n    this.refetchAvatar();\n  }\n\n  componentDidUpdate(_prevProps, prevState) {\n    if (prevState.avatarId !== this.state.avatarId) {\n      this.refetchAvatar();\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    if (this.nameInput) {\n      this.nameInput.removeEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.removeEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    this.scene.removeEventListener(\"action_avatar_saved\", this.refetchAvatar);\n  }\n\n  refetchAvatar = async () => {\n    const avatar = await fetchAvatar(this.state.avatarId);\n    if (this.state.avatarId !== avatar.avatar_id) return; // This is an old result, ignore it\n    this.setState({ avatar });\n  };\n\n  render() {\n    const avatarSettingsProps = {\n      displayNameInputRef: inp => (this.nameInput = inp),\n      disableDisplayNameInput: !!this.props.displayNameOverride,\n      displayName: this.props.displayNameOverride ? this.props.displayNameOverride : this.state.displayName,\n      displayNamePattern: this.props.store.schema.definitions.profile.properties.displayName.pattern,\n      onChangeDisplayName: e => this.setState({ displayName: e.target.value }),\n      avatarPreview: <AvatarPreview avatarGltfUrl={this.state.avatar && this.state.avatar.gltf_url} />,\n      onChangeAvatar: e => {\n        e.preventDefault();\n        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\", \"use\");\n      },\n      onSubmit: this.saveStateAndFinish,\n      onClose: this.props.onClose,\n      onBack: this.props.onBack\n    };\n\n    if (this.props.containerType === \"sidebar\") {\n      return <AvatarSettingsSidebar {...avatarSettingsProps} showBackButton={this.props.showBackButton} />;\n    }\n\n    return <AvatarSetupModal {...avatarSettingsProps} />;\n  }\n}\n","import { EventTarget } from \"event-target-shim\";\nimport configs from \"../utils/configs\";\nimport { getReticulumFetchUrl, fetchReticulumAuthenticated, hasReticulumServer } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\n\nconst EMPTY_RESULT = { entries: [], meta: {} };\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  twitch: \"twitch\",\n  favorites: \"favorites\"\n};\n\nconst desiredSources = [\"sketchfab\", \"videos\", \"scenes\", \"avatars\", \"gifs\", \"images\"];\nconst availableSources = desiredSources.filter(source => {\n  const apiSource = URL_SOURCE_TO_TO_API_SOURCE[source];\n  return configs.integration(apiSource);\n});\nexport const SOURCES = availableSources;\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\",\n  favorites: \"my-favorites\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\", \"similar_to\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n    const locationSearchParams = new URLSearchParams(location.search);\n    const isMy = locationSearchParams.get(\"filter\") && locationSearchParams.get(\"filter\").startsWith(\"my-\");\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      source = isMy ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    let fetch = true;\n\n    if (source === \"avatars\" || source === \"scenes\" || source === \"favorites\") {\n      if (isMy) {\n        if (window.APP.store.credentialsAccountId) {\n          searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n        } else {\n          fetch = false; // Don't fetch my-* if not signed in\n        }\n      }\n    }\n\n    const path = `/api/v1/media/search?${searchParams.toString()}`;\n    const url = getReticulumFetchUrl(path);\n    if (this.lastSavedUrl === url) return;\n\n    this.isFetching = true;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    const result = fetch ? await fetchReticulumAuthenticated(path) : EMPTY_RESULT;\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result && this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.isFetching = false;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    searchParams.delete(\"similar_to\");\n    searchParams.delete(\"similar_name\");\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav, keepSelectAction) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n    searchParams.delete(\"similar_to\");\n    searchParams.delete(\"similar_name\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    if (!keepSelectAction) {\n      searchParams.delete(\"selectAction\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n\n    this._stashedParams = {};\n    this._stashedSource = null;\n\n    const source = this.getUrlMediaSource(location);\n\n    // HACK for now do not stash favorite search, since that ends up being a source\n    // we do not reveal in the media browser UX. Revisit the rules here when we have a\n    // proper favorites browser. Then, we should have two separate stashes.\n    if (source === \"favorites\") return;\n    this._stashedSource = source;\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = (source, selectAction) => {\n    this._sourceNavigate(source, true, false, selectAction);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams, selectAction) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (selectAction) {\n      searchParams.set(\"selectAction\", selectAction);\n    }\n\n    if (hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const result = await fetchReticulumAuthenticated(`/api/v1/media/search?${searchParams.toString()}`);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { useForm } from \"react-hook-form\";\nimport { ApplyButton } from \"../input/Button\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Column } from \"../layout/Column\";\n\nexport function AvatarUrlModal({ onSubmit, onClose }) {\n  const { handleSubmit, register } = useForm();\n  return (\n    <Modal title=\"Custom Avatar URL\" beforeTitle={<CloseButton onClick={onClose} />}>\n      <Column as=\"form\" padding center onSubmit={handleSubmit(onSubmit)}>\n        <TextInputField\n          name=\"url\"\n          label={<FormattedMessage id=\"avatar-url-modal.avatar-url-label\" defaultMessage=\"Avatar GLB URL\" />}\n          placeholder=\"https://example.com/avatar.glb\"\n          type=\"url\"\n          required\n          ref={register}\n          description={\n            <a href=\"https://hubs.mozilla.com/docs/intro-avatars.html\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <FormattedMessage\n                id=\"avatar-url-modal.custom-avatar-docs-link\"\n                defaultMessage=\"Learn more about custom avatars\"\n              />\n            </a>\n          }\n        />\n        <ApplyButton type=\"submit\" />\n      </Column>\n    </Modal>\n  );\n}\n\nAvatarUrlModal.propTypes = {\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AvatarUrlModal } from \"./AvatarUrlModal\";\n\nexport function AvatarUrlModalContainer({ store, scene, onClose }) {\n  const onSubmit = useCallback(\n    ({ url }) => {\n      store.update({ profile: { ...store.state.profile, ...{ avatarId: url } } });\n      scene.emit(\"avatar_updated\");\n      onClose();\n    },\n    [store, scene, onClose]\n  );\n\n  return <AvatarUrlModal onSubmit={onSubmit} onClose={onClose} />;\n}\n\nAvatarUrlModalContainer.propTypes = {\n  store: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { useForm } from \"react-hook-form\";\nimport { Button } from \"../input/Button\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Column } from \"../layout/Column\";\n\nexport function SceneUrlModal({ enableSpoke, editorName, onValidateUrl, onSubmit, onClose }) {\n  const { isSubmitting, handleSubmit, register, errors } = useForm();\n  return (\n    <Modal\n      title={<FormattedMessage id=\"scene-url-modal.title\" defaultMessage=\"Custom Scene URL\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column as=\"form\" padding center onSubmit={handleSubmit(onSubmit)}>\n        <p>\n          {enableSpoke ? (\n            <FormattedMessage\n              id=\"scene-url-modal.message-with-spoke\"\n              defaultMessage=\"Paste a URL to a {editorName} scene or a URL to a <glblink>GLB</glblink>.\"\n              values={{\n                editorName: (\n                  <a href=\"/spoke\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {editorName}\n                  </a>\n                ),\n                // eslint-disable-next-line react/display-name\n                glblink: chunks => (\n                  <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          ) : (\n            <FormattedMessage\n              id=\"scene-url-modal.message\"\n              defaultMessage=\"Paste a URL to a scene or a URL to a <glblink>GLB</glblink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                glblink: chunks => (\n                  <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          )}\n        </p>\n        <TextInputField\n          name=\"url\"\n          label={<FormattedMessage id=\"scene-url-modal.url-input\" defaultMessage=\"Scene URL\" />}\n          placeholder=\"https://example.com/scene.glb\"\n          type=\"url\"\n          required\n          ref={register({ validate: onValidateUrl })}\n          error={errors.url && errors.url.message}\n        />\n        <Button type=\"submit\" preset=\"accept\" disabled={isSubmitting}>\n          <FormattedMessage id=\"scene-url-modal.change-scene-button\" defaultMessage=\"Change Scene\" />\n        </Button>\n        {enableSpoke && (\n          <>\n            <p>\n              <FormattedMessage\n                id=\"scene-url-modal.create-in-spoke\"\n                defaultMessage=\"Or, create a new scene using {editorName}.\"\n                values={{ editorName }}\n              />\n            </p>\n            <Button as=\"a\" preset=\"primary\" href=\"/spoke/new\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <FormattedMessage\n                id=\"scene-url-modal.new-spoke-project-button\"\n                defaultMessage=\"Launch {editorName}\"\n                values={{ editorName }}\n              />\n            </Button>\n          </>\n        )}\n      </Column>\n    </Modal>\n  );\n}\n\nSceneUrlModal.propTypes = {\n  enableSpoke: PropTypes.bool,\n  editorName: PropTypes.string,\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func,\n  onValidateUrl: PropTypes.isRequired\n};\n","import { isLocalHubsSceneUrl, proxiedUrlFor } from \"../utils/media-url-utils\";\n\nexport async function isValidGLB(url) {\n  return fetch(url).then(async r => {\n    const reader = r.body.getReader();\n    let header = \"\";\n    function readChunk({ done, value }) {\n      header += String.fromCharCode.apply(null, value.slice(0, 4));\n      if (!done && header.length < 4) {\n        return reader.read().then(readChunk);\n      } else {\n        reader.cancel();\n      }\n    }\n    await reader.read().then(readChunk);\n    return header.startsWith(\"glTF\");\n  });\n}\n\nexport async function isValidSceneUrl(url) {\n  if (url.trim() === \"\") return false;\n  if (!url.startsWith(\"http\")) return false;\n  if (await isLocalHubsSceneUrl(url)) {\n    return true;\n  } else {\n    return isValidGLB(proxiedUrlFor(url));\n  }\n}\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAttach = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.44 7.5v5.62a1.565 1.565 0 0 0 3.131 0l.005-7.366A2.656 2.656 0 0 0 7.9 3.274a2.654 2.654 0 0 0-1.631 2.48v7.415a3.73 3.73 0 1 0 7.46 0V6.24\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgAttach as ReactComponent };","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { SceneUrlModal } from \"./SceneUrlModal\";\nimport configs from \"../../utils/configs\";\nimport { isValidSceneUrl } from \"../../utils/scene-url-utils\";\nimport { useIntl } from \"react-intl\";\n\nexport function SceneUrlModalContainer({ hubChannel, onClose }) {\n  const intl = useIntl();\n\n  const onValidateUrl = useCallback(\n    async url => {\n      const valid = await isValidSceneUrl(url.trim());\n      return valid || intl.formatMessage(\"scene-url-modal.invalid-scene-url\");\n    },\n    [intl]\n  );\n\n  const onSubmit = useCallback(\n    ({ url }) => {\n      hubChannel.updateScene(url);\n      onClose();\n    },\n    [hubChannel, onClose]\n  );\n\n  return (\n    <SceneUrlModal\n      enableSpoke={configs.feature(\"enable_spoke\")}\n      editorName={configs.translation(\"editor-name\")}\n      onValidateUrl={onValidateUrl}\n      onSubmit={onSubmit}\n      onClose={onClose}\n    />\n  );\n}\n\nSceneUrlModalContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"hidden\":\"ObjectUrlModal__hidden__Y3SS9\",\"url-input\":\"ObjectUrlModal__url-input__uq6pp\",\"urlInput\":\"ObjectUrlModal__url-input__uq6pp\"};","import React, { useCallback, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { useForm } from \"react-hook-form\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as AttachIcon } from \"../icons/Attach.svg\";\nimport styles from \"./ObjectUrlModal.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function ObjectUrlModal({ showModelCollectionLink, modelCollectionUrl, onSubmit, onClose }) {\n  const { handleSubmit, register, watch, setValue } = useForm();\n\n  useEffect(\n    () => {\n      register(\"url\");\n    },\n    [register]\n  );\n\n  const file = watch(\"file\");\n  const hasFile = file && file.length > 0;\n  const fileName = hasFile ? file[0].name : undefined;\n\n  const onClear = useCallback(\n    () => {\n      if (hasFile) {\n        setValue(\"file\", undefined);\n      } else {\n        setValue(\"url\", \"\");\n      }\n    },\n    [hasFile, setValue]\n  );\n\n  const onChange = useCallback(\n    e => {\n      if (hasFile) {\n        return;\n      }\n\n      setValue(\"url\", e.target.value);\n    },\n    [hasFile, setValue]\n  );\n\n  const url = watch(\"url\", \"\");\n\n  const showCloseButton = hasFile || url.length > 0;\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"object-url-modal.title\" defaultMessage=\"Custom Object\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column as=\"form\" padding center onSubmit={handleSubmit(onSubmit)}>\n        <p>\n          {showModelCollectionLink ? (\n            <FormattedMessage\n              id=\"object-url-modal.message-with-collection\"\n              defaultMessage=\"Upload or paste a URL to an image, video, model, or scene. Models can be found on <sketchfablink>Sketchfab</sketchfablink> or our <collectionlink>collection</collectionlink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                sketchfablink: chunks => (\n                  <a\n                    href=\"https://sketchfab.com/search?features=downloadable&type=models\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {chunks}\n                  </a>\n                ),\n                // eslint-disable-next-line react/display-name\n                collectionlink: chunks => (\n                  <a href={modelCollectionUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          ) : (\n            <FormattedMessage\n              id=\"object-url-modal.message\"\n              defaultMessage=\"Upload or paste a URL to an image, video, model, or scene. Models can be found on <sketchfablink>Sketchfab</sketchfablink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                sketchfablink: chunks => (\n                  <a\n                    href=\"https://sketchfab.com/search?features=downloadable&type=models\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          )}\n        </p>\n        <TextInputField\n          name=\"url\"\n          label={<FormattedMessage id=\"object-url-modal.url-field-label\" defaultMessage=\"Object URL or File\" />}\n          placeholder=\"https://example.com/avatar.glb\"\n          type={hasFile ? \"text\" : \"url\"}\n          value={fileName || url || \"\"}\n          onChange={onChange}\n          afterInput={\n            <>\n              {showCloseButton && <CloseButton onClick={onClear} />}\n              <IconButton\n                as=\"label\"\n                className={classNames({ [styles.hidden]: showCloseButton }, styles.urlInput)}\n                htmlFor=\"file\"\n              >\n                <AttachIcon />\n                <input id=\"file\" className={styles.hidden} name=\"file\" type=\"file\" ref={register} />\n              </IconButton>\n            </>\n          }\n          description={\n            <FormattedMessage\n              id=\"object-url-modal.url-field-description\"\n              defaultMessage=\"Accepts glb, png, jpg, gif, mp4, and mp3 files\"\n            />\n          }\n        />\n        <Button type=\"submit\" preset=\"accept\">\n          <FormattedMessage id=\"object-url-modal.create-object-button\" defaultMessage=\"Create Object\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nObjectUrlModal.propTypes = {\n  isMobile: PropTypes.bool,\n  showModelCollectionLink: PropTypes.bool,\n  modelCollectionUrl: PropTypes.string,\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ObjectUrlModal } from \"./ObjectUrlModal\";\nimport configs from \"../../utils/configs\";\nimport ducky from \"../../assets/models/DuckyMesh.glb\";\n\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\nexport function ObjectUrlModalContainer({ scene, onClose }) {\n  const onSubmit = useCallback(\n    ({ file, url }) => {\n      scene.emit(\"add_media\", (file && file.length > 0 && file[0]) || url || ducky);\n      onClose();\n    },\n    [scene, onClose]\n  );\n\n  return (\n    <ObjectUrlModal\n      isMobile={isMobile}\n      showModelCollectionLink={configs.feature(\"show_model_collection_link\")}\n      modelCollectionUrl={configs.link(\"model_collection\", \"https://sketchfab.com/mozillareality\")}\n      onSubmit={onSubmit}\n      onClose={onClose}\n    />\n  );\n}\n\nObjectUrlModalContainer.propTypes = {\n  scene: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"search-icon\":\"MediaBrowser__search-icon__Gdgj7\",\"searchIcon\":\"MediaBrowser__search-icon__Gdgj7\",\"favorite-icon\":\"MediaBrowser__favorite-icon__eqtGN\",\"favoriteIcon\":\"MediaBrowser__favorite-icon__eqtGN\",\"button-nav\":\"MediaBrowser__button-nav__CWlpf\",\"buttonNav\":\"MediaBrowser__button-nav__CWlpf\",\"facets-nav\":\"MediaBrowser__facets-nav__RUwKx\",\"facetsNav\":\"MediaBrowser__facets-nav__RUwKx\",\"content\":\"MediaBrowser__content__TrMq2\",\"pager\":\"MediaBrowser__pager__Dknao\",\"pager-button\":\"MediaBrowser__pager-button__LZzwc\",\"pagerButton\":\"MediaBrowser__pager-button__LZzwc\",\"no-results\":\"MediaBrowser__no-results__wzxlX\",\"noResults\":\"MediaBrowser__no-results__wzxlX\"};","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSearch = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.636 2.5a6.136 6.136 0 1 0 0 12.273 6.136 6.136 0 0 0 0-12.272Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.214 13.214 17.5 17.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgSearch as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgStar = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.39 18.75a.625.625 0 0 1-.366-.118L10 14.99l-5.024 3.642a.625.625 0 0 1-.959-.706l1.96-5.803L.899 8.64A.625.625 0 0 1 1.25 7.5h6.265l1.89-5.819a.625.625 0 0 1 1.19 0l1.89 5.82h6.265a.624.624 0 0 1 .354 1.141l-5.08 3.48 1.958 5.802a.624.624 0 0 1-.591.826Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgStar as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgArrowForward = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.469 4.375 16.094 10l-5.625 5.625\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.313 10H3.905\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgArrowForward as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgArrowBack = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.531 15.625 3.906 10l5.625-5.625\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.688 10h11.406\",\n    stroke: \"currentColor\",\n    strokeWidth: 2.25,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgArrowBack as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./FullscreenLayout.scss\";\n\nexport function FullscreenLayout({ className, headerLeft, headerCenter, headerRight, contentClassName, children }) {\n  return (\n    <div className={classNames(styles.fullscreenLayout, className)}>\n      <div className={styles.header}>\n        <div className={styles.headerLeft}>{headerLeft}</div>\n        <div className={styles.headerCenter}>{headerCenter}</div>\n        <div className={styles.headerRight}>{headerRight}</div>\n      </div>\n      <div className={classNames(styles.content, contentClassName)}>{children}</div>\n    </div>\n  );\n}\n\nFullscreenLayout.propTypes = {\n  className: PropTypes.string,\n  headerLeft: PropTypes.node,\n  headerCenter: PropTypes.node,\n  headerRight: PropTypes.node,\n  contentClassName: PropTypes.string,\n  children: PropTypes.node\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"fullscreen-layout\":\"FullscreenLayout__fullscreen-layout___gfL2\",\"fullscreenLayout\":\"FullscreenLayout__fullscreen-layout___gfL2\",\"header\":\"FullscreenLayout__header__Xwco1\",\"header-left\":\"FullscreenLayout__header-left__plGaP\",\"headerLeft\":\"FullscreenLayout__header-left__plGaP\",\"header-center\":\"FullscreenLayout__header-center__LLG8s\",\"headerCenter\":\"FullscreenLayout__header-center__LLG8s\",\"header-right\":\"FullscreenLayout__header-right__xewse\",\"headerRight\":\"FullscreenLayout__header-right__xewse\",\"content\":\"FullscreenLayout__content__sEnvy\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./MediaGrid.scss\";\n\nexport function MediaGrid({ children, className, center, isVariableWidth, sm, ...rest }) {\n  return (\n    <div\n      className={classNames(\n        styles.mediaGrid,\n        { [styles.center]: center, [styles.variableWidth]: isVariableWidth, [styles.sm]: sm },\n        className\n      )}\n      {...rest}\n    >\n      {children}\n    </div>\n  );\n}\n\nMediaGrid.propTypes = {\n  center: PropTypes.bool,\n  isVariableWidth: PropTypes.bool,\n  sm: PropTypes.bool,\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"media-grid\":\"MediaGrid__media-grid__CTSyf\",\"mediaGrid\":\"MediaGrid__media-grid__CTSyf\",\"sm\":\"MediaGrid__sm__UglLx\",\"center\":\"MediaGrid__center__sJRuA\",\"variable-width\":\"MediaGrid__variable-width__IrH79\",\"variableWidth\":\"MediaGrid__variable-width__IrH79\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./MediaBrowser.scss\";\nimport { ReactComponent as SearchIcon } from \"../icons/Search.svg\";\nimport { ReactComponent as StarIcon } from \"../icons/Star.svg\";\nimport { ReactComponent as CloseIcon } from \"../icons/Close.svg\";\nimport { ReactComponent as ArrowForwardIcon } from \"../icons/ArrowForward.svg\";\nimport { ReactComponent as ArrowBackIcon } from \"../icons/ArrowBack.svg\";\nimport { FormattedMessage, defineMessages, useIntl } from \"react-intl\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { IconButton } from \"../input/IconButton\";\nimport { FullscreenLayout } from \"../layout/FullscreenLayout\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { MediaGrid } from \"./MediaGrid\";\n\nconst navTitleMessages = defineMessages({\n  youtube: { id: \"media-browser.nav_title.youtube\", defaultMessage: \"YouTube\" },\n  videos: { id: \"media-browser.nav_title.videos\", defaultMessage: \"Videos\" },\n  images: { id: \"media-browser.nav_title.images\", defaultMessage: \"Images\" },\n  gifs: { id: \"media-browser.nav_title.gifs\", defaultMessage: \"GIFs\" },\n  scenes: { id: \"media-browser.nav_title.scenes\", defaultMessage: \"Scenes\" },\n  avatars: { id: \"media-browser.nav_title.avatars\", defaultMessage: \"Avatars\" },\n  sketchfab: { id: \"media-browser.nav_title.sketchfab\", defaultMessage: \"Sketchfab\" },\n  twitch: { id: \"media-browser.nav_title.twitch\", defaultMessage: \"Twitch\" }\n});\n\nexport function MediaBrowser({\n  onClose,\n  browserRef,\n  searchInputRef,\n  autoFocusSearch,\n  searchPlaceholder,\n  searchDescription,\n  onSearchKeyDown,\n  onClearSearch,\n  mediaSources,\n  selectedSource,\n  onSelectSource,\n  activeFilter,\n  facets,\n  onSelectFacet,\n  query,\n  onChangeQuery,\n  headerRight,\n  hasNext,\n  hasPrevious,\n  onNextPage,\n  onPreviousPage,\n  noResultsMessage,\n  children\n}) {\n  const intl = useIntl();\n\n  return (\n    <FullscreenLayout\n      headerLeft={\n        <IconButton onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      }\n      headerCenter={\n        <>\n          {selectedSource === \"favorites\" ? (\n            <>\n              <StarIcon className={styles.favoriteIcon} />\n              <h3>\n                <FormattedMessage id=\"media-browser.favorites-header\" defaultMessage=\"Favorite Rooms\" />\n              </h3>\n            </>\n          ) : (\n            <TextInputField\n              value={query}\n              onChange={onChangeQuery}\n              autoFocus={autoFocusSearch}\n              ref={searchInputRef}\n              placeholder={searchPlaceholder}\n              onKeyDown={onSearchKeyDown}\n              beforeInput={<SearchIcon className={styles.searchIcon} />}\n              afterInput={\n                <IconButton onClick={onClearSearch}>\n                  <CloseIcon height={16} width={16} />\n                </IconButton>\n              }\n              description={searchDescription}\n            />\n          )}\n        </>\n      }\n      headerRight={headerRight}\n    >\n      {mediaSources && (\n        <div className={styles.buttonNav}>\n          {mediaSources.map(source => (\n            <Button\n              sm\n              key={source}\n              preset={selectedSource === source ? \"primary\" : \"transparent\"}\n              onClick={() => onSelectSource(source)}\n            >\n              {intl.formatMessage(navTitleMessages[source])}\n            </Button>\n          ))}\n        </div>\n      )}\n      {facets && (\n        <div className={classNames(styles.buttonNav, styles.facetsNav)}>\n          {facets.map((facet, i) => (\n            <Button\n              sm\n              key={i}\n              preset={activeFilter === facet.params.filter ? \"primary\" : \"transparent\"}\n              onClick={() => onSelectFacet(facet)}\n            >\n              {facet.text}\n            </Button>\n          ))}\n        </div>\n      )}\n      <div className={styles.content}>\n        <Column grow ref={browserRef}>\n          {children ? (\n            <MediaGrid\n              isVariableWidth={selectedSource === \"gifs\" || selectedSource === \"images\"}\n              sm={selectedSource === \"avatars\"}\n            >\n              {children}\n            </MediaGrid>\n          ) : (\n            <div className={styles.noResults}>{noResultsMessage}</div>\n          )}\n          {(hasNext || hasPrevious) && (\n            <div className={styles.pager}>\n              <button type=\"button\" className={styles.pagerButton} disabled={!hasPrevious} onClick={onPreviousPage}>\n                <ArrowBackIcon />\n              </button>\n              <button type=\"button\" className={styles.pagerButton} disabled={!hasNext} onClick={onNextPage}>\n                <ArrowForwardIcon />\n              </button>\n            </div>\n          )}\n        </Column>\n      </div>\n    </FullscreenLayout>\n  );\n}\n\nMediaBrowser.propTypes = {\n  onClose: PropTypes.func,\n  browserRef: PropTypes.any,\n  searchInputRef: PropTypes.any,\n  autoFocusSearch: PropTypes.bool,\n  searchPlaceholder: PropTypes.string,\n  searchDescription: PropTypes.node,\n  onSearchKeyDown: PropTypes.func,\n  onClearSearch: PropTypes.func,\n  mediaSources: PropTypes.array,\n  selectedSource: PropTypes.string,\n  onSelectSource: PropTypes.func,\n  activeFilter: PropTypes.string,\n  facets: PropTypes.array,\n  onSelectFacet: PropTypes.func,\n  query: PropTypes.string,\n  onChangeQuery: PropTypes.func,\n  headerRight: PropTypes.node,\n  hasNext: PropTypes.bool,\n  hasPrevious: PropTypes.bool,\n  onNextPage: PropTypes.func,\n  onPreviousPage: PropTypes.func,\n  noResultsMessage: PropTypes.node,\n  children: PropTypes.node\n};\n\nMediaBrowser.defaultProps = {\n  noResultsMessage: \"No Results\"\n};\n","var _g, _defs;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgUpload = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#a)\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.5 14.367h2.969c2.148 0 3.906-1.14 3.906-3.265s-2.07-3.183-3.75-3.266C15.278 4.514 12.852 2.492 10 2.492c-2.695 0-4.431 1.79-5 3.563C2.656 6.278.625 7.769.625 10.21c0 2.442 2.11 4.156 4.688 4.156H7.5\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.5 9.992-2.5-2.5-2.5 2.5\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 17.509V8.117\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"a\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 20,\n    height: 20,\n    fill: \"#fff\"\n  })))));\n};\n\nexport { SvgUpload as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLink = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M4.851 11.038a2.906 2.906 0 1 0 4.11 4.11l1.768-1.768a.844.844 0 0 1 1.194 1.193l-1.768 1.768a4.594 4.594 0 1 1-6.497-6.496l1.768-1.768A.844.844 0 0 1 6.619 9.27l-1.768 1.768Zm3.227-4.42a.844.844 0 0 1 0-1.193l1.767-1.767a4.594 4.594 0 0 1 6.497 6.496l-1.768 1.768a.844.844 0 1 1-1.193-1.193l1.768-1.768a2.906 2.906 0 0 0-4.11-4.11L9.27 6.619a.844.844 0 0 1-1.193 0Zm-1.236 5.345a.844.844 0 0 0 1.194 1.193l5.176-5.176a.844.844 0 0 0-1.193-1.194l-5.177 5.177Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgLink as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPeople = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.703 6.563c-.114 1.588-1.293 2.812-2.578 2.812s-2.466-1.223-2.578-2.812c-.117-1.653 1.03-2.813 2.578-2.813 1.548 0 2.695 1.19 2.578 2.813Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125 11.875c-2.546 0-4.994 1.264-5.607 3.727-.081.326.123.648.458.648h10.299c.335 0 .538-.322.458-.648-.614-2.502-3.062-3.727-5.608-3.727Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.812 7.264C7.721 8.532 6.77 9.53 5.742 9.53c-1.026 0-1.98-.998-2.07-2.267C3.578 5.944 4.505 5 5.742 5c1.237 0 2.164.968 2.07 2.264Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.047 11.954c-.705-.324-1.482-.448-2.305-.448-2.031 0-3.988 1.01-4.478 2.977-.065.26.098.517.366.517h4.386\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgPeople as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAdd = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 4.375v11.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.625 10H4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgAdd as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPen = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.024 18.125H1.875v-2.148L13.99 3.832 16.17 6.01 4.024 18.125Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.63 5.547 14.453 3.37l1.237-1.197c.19-.193.484-.298.755-.298a1.011 1.011 0 0 1 .72.298l.664.664a1.01 1.01 0 0 1 .296.718c0 .273-.106.564-.298.756L16.63 5.547Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgPen as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDuplicate = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.898 5H7.227C5.997 5 5 5.996 5 7.226v8.672c0 1.23.997 2.227 2.227 2.227h8.671c1.23 0 2.227-.997 2.227-2.227V7.226c0-1.23-.997-2.226-2.227-2.226Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14.98 5 .02-.938a2.194 2.194 0 0 0-2.188-2.188H4.376a2.507 2.507 0 0 0-2.5 2.5v8.438a2.194 2.194 0 0 0 2.188 2.187H5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.563 8.437v6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.688 11.562h-6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgDuplicate as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHelp = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2a8 8 0 1 0 0 16 8 8 0 0 0 0-16Z\",\n    stroke: \"currentColor\",\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.454 7.56s.039-.796.89-1.48c.505-.407 1.11-.525 1.656-.533.497-.007.94.076 1.206.202.454.216 1.34.745 1.34 1.868 0 1.182-.773 1.718-1.654 2.309-.88.59-1.12 1.231-1.12 1.893\",\n    stroke: \"currentColor\",\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.855 14.844a.786.786 0 1 0 0-1.57.786.786 0 0 0 0 1.57Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgHelp as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgExternalLink = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15 8.749v7.188a1.563 1.563 0 0 1-1.563 1.562H4.063A1.563 1.563 0 0 1 2.5 15.937V6.562a1.562 1.562 0 0 1 1.563-1.563h6.542\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125 2.5H17.5v4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.75 11.248 8.438-8.437\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgExternalLink as ReactComponent };","import React, { useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FormattedMessage, FormattedRelativeTime, useIntl } from \"react-intl\";\nimport styles from \"./MediaTiles.scss\";\nimport { ReactComponent as PeopleIcon } from \"../icons/People.svg\";\nimport { ReactComponent as StarIcon } from \"../icons/Star.svg\";\nimport { ReactComponent as AddIcon } from \"../icons/Add.svg\";\nimport { ReactComponent as PenIcon } from \"../icons/Pen.svg\";\nimport { ReactComponent as DuplicateIcon } from \"../icons/Duplicate.svg\";\nimport { ReactComponent as SearchIcon } from \"../icons/Search.svg\";\nimport { ReactComponent as HelpIcon } from \"../icons/Help.svg\";\nimport { ReactComponent as ExternalLinkIcon } from \"../icons/ExternalLink.svg\";\n\nconst PUBLISHER_FOR_ENTRY_TYPE = {\n  sketchfab_model: \"Sketchfab\",\n  twitch_stream: \"Twitch\"\n};\n\nfunction useThumbnailSize(isImage, isAvatar, imageAspect) {\n  return useMemo(\n    () => {\n      let imageHeight = 220;\n      if (isAvatar) imageHeight = Math.floor(imageHeight * 1.5);\n\n      // Aspect ratio can vary per image if its an image result. Avatars are a taller portrait aspect, o/w assume 720p\n      let imageWidth;\n      if (isImage) {\n        imageWidth = Math.floor(Math.max(imageAspect * imageHeight, imageHeight * 0.85));\n      } else if (isAvatar) {\n        imageWidth = Math.floor((9 / 16) * imageHeight);\n      } else {\n        imageWidth = Math.floor(Math.max((16 / 9) * imageHeight, imageHeight * 0.85));\n      }\n\n      return [imageWidth, imageHeight];\n    },\n    [isImage, isAvatar, imageAspect]\n  );\n}\n\nfunction useThumbnail(entry, processThumbnailUrl) {\n  const isImage = entry.type.endsWith(\"_image\");\n  const isAvatar = entry.type === \"avatar\" || entry.type === \"avatar_listing\";\n  const imageAspect = entry.images.preview.width / entry.images.preview.height;\n\n  const [thumbnailWidth, thumbnailHeight] = useThumbnailSize(isImage, isAvatar, imageAspect);\n\n  const thumbnailUrl = useMemo(\n    () => {\n      return processThumbnailUrl\n        ? processThumbnailUrl(entry, thumbnailWidth, thumbnailHeight)\n        : entry.images.preview.url;\n    },\n    [entry, thumbnailWidth, thumbnailHeight, processThumbnailUrl]\n  );\n\n  return [thumbnailUrl, thumbnailWidth, thumbnailHeight];\n}\n\nfunction BaseTile({ as: TileComponent, className, name, description, tall, wide, children, ...rest }) {\n  let additionalProps;\n\n  if (TileComponent === \"div\") {\n    additionalProps = {\n      tabIndex: \"0\",\n      role: \"button\"\n    };\n  }\n\n  return (\n    <TileComponent\n      className={classNames(styles.mediaTile, { [styles.tall]: tall, [styles.wide]: wide }, className)}\n      {...additionalProps}\n      {...rest}\n    >\n      <div className={styles.thumbnailContainer}>{children}</div>\n      {(name || description) && (\n        <div className={styles.info}>\n          <b>{name}</b>\n          {description && <small className={styles.description}>{description}</small>}\n        </div>\n      )}\n    </TileComponent>\n  );\n}\n\nBaseTile.propTypes = {\n  as: PropTypes.elementType,\n  className: PropTypes.string,\n  name: PropTypes.string,\n  description: PropTypes.node,\n  children: PropTypes.node,\n  tall: PropTypes.bool,\n  wide: PropTypes.bool\n};\n\nBaseTile.defaultProps = {\n  as: \"div\"\n};\n\nfunction TileAction({ className, children, ...rest }) {\n  return (\n    <button type=\"button\" className={classNames(styles.tileAction, className)} {...rest}>\n      {children}\n    </button>\n  );\n}\n\nTileAction.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function CreateTile({ label, type, ...rest }) {\n  return (\n    <BaseTile className={styles.createTile} wide={type === \"scene\"} tall={type === \"avatar\"} {...rest}>\n      <div className={styles.createTileContent}>\n        <AddIcon width={48} height={48} />\n        <p>{label}</p>\n      </div>\n    </BaseTile>\n  );\n}\n\nCreateTile.propTypes = {\n  label: PropTypes.node,\n  type: PropTypes.string\n};\n\nexport function MediaTile({ entry, processThumbnailUrl, onClick, onEdit, onShowSimilar, onCopy, onInfo, ...rest }) {\n  const intl = useIntl();\n  const creator = entry.attributions && entry.attributions.creator;\n  const publisherName =\n    (entry.attributions && entry.attributions.publisher && entry.attributions.publisher.name) ||\n    PUBLISHER_FOR_ENTRY_TYPE[entry.type];\n\n  const [thumbnailUrl, thumbnailWidth, thumbnailHeight] = useThumbnail(entry, processThumbnailUrl);\n\n  return (\n    <BaseTile\n      wide={entry.type === \"scene\" || entry.type === \"scene_listing\" || entry.type === \"room\"}\n      tall={entry.type === \"avatar\" || entry.type === \"avatar_listing\"}\n      name={entry.name}\n      description={\n        <>\n          {creator && creator.name === undefined && <span>{creator}</span>}\n          {creator && creator.name && !creator.url && <span>{creator.name}</span>}\n          {creator &&\n            creator.name &&\n            creator.url && (\n              <a href={creator.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                {creator.name}\n              </a>\n            )}\n          {publisherName && (\n            <>\n              <a href={entry.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                <ExternalLinkIcon /> {publisherName}\n              </a>\n            </>\n          )}\n          {entry.last_activated_at && (\n            <small>\n              <FormattedMessage\n                id=\"media-tile.joined-room\"\n                defaultMessage=\"Joined {relativeTime}\"\n                values={{\n                  relativeTime: (\n                    <FormattedRelativeTime\n                      updateIntervalInSeconds={10}\n                      value={(new Date(entry.last_activated_at).getTime() - Date.now()) / 1000}\n                    />\n                  )\n                }}\n              />\n            </small>\n          )}\n        </>\n      }\n      {...rest}\n    >\n      <a className={styles.thumbnailLink} href={entry.url} rel=\"noreferrer noopener\" onClick={onClick}>\n        {entry.images.preview.type === \"mp4\" ? (\n          <video\n            muted\n            autoPlay\n            playsInline\n            loop\n            src={thumbnailUrl}\n            alt={entry.name}\n            width={thumbnailWidth}\n            height={thumbnailHeight}\n          />\n        ) : (\n          <img src={thumbnailUrl} alt={entry.name} width={thumbnailWidth} height={thumbnailHeight} />\n        )}\n      </a>\n      {entry.favorited && <StarIcon className={styles.favoriteIcon} />}\n      {entry.member_count !== undefined && (\n        <div className={styles.memberCount}>\n          <PeopleIcon /> <span>{entry.member_count}</span>\n        </div>\n      )}\n      <div className={styles.tileActions}>\n        {entry.type === \"avatar\" && (\n          <TileAction\n            title={intl.formatMessage({ id: \"media-tile.action.edit-avatar\", defaultMessage: \"Edit avatar\" })}\n            onClick={onEdit}\n          >\n            <PenIcon />\n          </TileAction>\n        )}\n        {entry.type === \"scene\" &&\n          entry.project_id && (\n            <TileAction\n              onClick={onEdit}\n              title={intl.formatMessage({ id: \"media-tile.action.edit-scene\", defaultMessage: \"Edit scene\" })}\n            >\n              <PenIcon />\n            </TileAction>\n          )}\n        {entry.type === \"avatar_listing\" && (\n          <TileAction\n            title={intl.formatMessage({\n              id: \"media-tile.action.show-similar-avatars\",\n              defaultMessage: \"Show similar avatars\"\n            })}\n            onClick={onShowSimilar}\n          >\n            <SearchIcon />\n          </TileAction>\n        )}\n        {entry.type === \"avatar_listing\" &&\n          entry.allow_remixing && (\n            <TileAction\n              title={intl.formatMessage({\n                id: \"media-tile.action.copy-avatar\",\n                defaultMessage: \"Copy to my avatars\"\n              })}\n              onClick={onCopy}\n            >\n              <DuplicateIcon />\n            </TileAction>\n          )}\n        {entry.type === \"scene_listing\" &&\n          entry.allow_remixing && (\n            <TileAction\n              title={intl.formatMessage({\n                id: \"media-tile.action.copy-scene\",\n                defaultMessage: \"Copy to my scenes\"\n              })}\n              onClick={onCopy}\n            >\n              <DuplicateIcon />\n            </TileAction>\n          )}\n        {entry.type === \"room\" &&\n          onInfo &&\n          entry.description && (\n            <TileAction\n              title={intl.formatMessage({\n                id: \"media-tile.action.room-info\",\n                defaultMessage: \"Room info\"\n              })}\n              onClick={onInfo}\n            >\n              <HelpIcon />\n            </TileAction>\n          )}\n      </div>\n    </BaseTile>\n  );\n}\n\nMediaTile.propTypes = {\n  entry: PropTypes.object.isRequired,\n  processThumbnailUrl: PropTypes.func,\n  onClick: PropTypes.func,\n  onEdit: PropTypes.func,\n  onShowSimilar: PropTypes.func,\n  onCopy: PropTypes.func,\n  onInfo: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"media-tile\":\"MediaTiles__media-tile__E0HUl\",\"mediaTile\":\"MediaTiles__media-tile__E0HUl\",\"thumbnail-container\":\"MediaTiles__thumbnail-container__MKVU6\",\"thumbnailContainer\":\"MediaTiles__thumbnail-container__MKVU6\",\"create-tile-content\":\"MediaTiles__create-tile-content__M88Bh\",\"createTileContent\":\"MediaTiles__create-tile-content__M88Bh\",\"tall\":\"MediaTiles__tall__yGWZ7\",\"wide\":\"MediaTiles__wide__dHsYw\",\"thumbnail-link\":\"MediaTiles__thumbnail-link__gdkAW\",\"thumbnailLink\":\"MediaTiles__thumbnail-link__gdkAW\",\"tile-actions\":\"MediaTiles__tile-actions__7omsl\",\"tileActions\":\"MediaTiles__tile-actions__7omsl\",\"tile-action\":\"MediaTiles__tile-action__Ja6k2\",\"tileAction\":\"MediaTiles__tile-action__Ja6k2\",\"member-count\":\"MediaTiles__member-count__vcGmo\",\"memberCount\":\"MediaTiles__member-count__vcGmo\",\"favorite-icon\":\"MediaTiles__favorite-icon__D2eKH\",\"favoriteIcon\":\"MediaTiles__favorite-icon__D2eKH\",\"info\":\"MediaTiles__info__A_JN6\",\"description\":\"MediaTiles__description____teU\",\"create-tile\":\"MediaTiles__create-tile__wPgMb\",\"createTile\":\"MediaTiles__create-tile__wPgMb\"};","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function LegalMessage({ termsUrl, privacyUrl }) {\n  const toslink = useCallback(\n    chunks => (\n      <a rel=\"noopener noreferrer\" target=\"_blank\" href={termsUrl}>\n        {chunks}\n      </a>\n    ),\n    [termsUrl]\n  );\n\n  const privacylink = useCallback(\n    chunks => (\n      <a rel=\"noopener noreferrer\" target=\"_blank\" href={privacyUrl}>\n        {chunks}\n      </a>\n    ),\n    [privacyUrl]\n  );\n\n  if (termsUrl && privacyUrl) {\n    return (\n      <FormattedMessage\n        id=\"legal-message.tos-and-privacy\"\n        defaultMessage=\"By proceeding, you agree to the <toslink>terms of use</toslink> and <privacylink>privacy notice</privacylink>.\"\n        values={{\n          toslink,\n          privacylink\n        }}\n      />\n    );\n  }\n\n  if (termsUrl && !privacyUrl) {\n    return (\n      <FormattedMessage\n        id=\"legal-message.tos\"\n        defaultMessage=\"By proceeding, you agree to the <toslink>terms of use</toslink>.\"\n        values={{\n          toslink\n        }}\n      />\n    );\n  }\n\n  if (!termsUrl && privacyUrl) {\n    return (\n      <FormattedMessage\n        id=\"legal-message.privacy\"\n        defaultMessage=\"By proceeding, you agree to the <privacylink>privacy notice</privacylink>.\"\n        values={{\n          privacylink\n        }}\n      />\n    );\n  }\n\n  return null;\n}\n\nLegalMessage.propTypes = {\n  termsUrl: PropTypes.string,\n  privacyUrl: PropTypes.string\n};\n","import React, { useCallback, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Modal } from \"../modal/Modal\";\nimport { FormattedMessage, useIntl, defineMessages } from \"react-intl\";\nimport { CancelButton, NextButton, ContinueButton } from \"../input/Button\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { Column } from \"../layout/Column\";\nimport { LegalMessage } from \"./LegalMessage\";\n\nexport const SignInStep = {\n  submit: \"submit\",\n  waitForVerification: \"waitForVerification\",\n  complete: \"complete\"\n};\n\nexport const SignInMessages = defineMessages({\n  pin: {\n    id: \"sign-in-modal.signin-message.pin\",\n    defaultMessage: \"You'll need to sign in to pin objects.\"\n  },\n  unpin: {\n    id: \"sign-in-modal.signin-message.unpin\",\n    defaultMessage: \"You'll need to sign in to un-pin objects.\"\n  },\n  changeScene: {\n    id: \"sign-in-modal.signin-message.change-scene\",\n    defaultMessage: \"You'll need to sign in to change the scene.\"\n  },\n  roomSettings: {\n    id: \"sign-in-modal.signin-message.room-settings\",\n    defaultMessage: \"You'll need to sign in to change the room's settings.\"\n  },\n  closeRoom: {\n    id: \"sign-in-modal.signin-message.close-room\",\n    defaultMessage: \"You'll need to sign in to close the room.\"\n  },\n  muteUser: {\n    id: \"sign-in-modal.signin-message.mute-user\",\n    defaultMessage: \"You'll need to sign in to mute other users.\"\n  },\n  kickUser: {\n    id: \"sign-in-modal.signin-message.kick-user\",\n    defaultMessage: \"You'll need to sign in to kick other users.\"\n  },\n  addOwner: {\n    id: \"sign-in-modal.signin-message.add-owner\",\n    defaultMessage: \"You'll need to sign in to assign moderators.\"\n  },\n  removeOwner: {\n    id: \"sign-in-modal.signin-message.remove-owner\",\n    defaultMessage: \"You'll need to sign in to assign moderators.\"\n  },\n  createAvatar: {\n    id: \"sign-in-modal.signin-message.create-avatar\",\n    defaultMessage: \"You'll need to sign in to create avatars.\"\n  },\n  remixAvatar: {\n    id: \"sign-in-modal.signin-message.remix-avatar\",\n    defaultMessage: \"You'll need to sign in to remix avatars.\"\n  },\n  remixScene: {\n    id: \"sign-in-modal.signin-message.remix-scene\",\n    defaultMessage: \"You'll need to sign in to remix scenes.\"\n  },\n  favoriteRoom: {\n    id: \"sign-in-modal.signin-message.favorite-room\",\n    defaultMessage: \"You'll need to sign in to add this room to your favorites.\"\n  },\n  favoriteRooms: {\n    id: \"sign-in-modal.signin-message.favorite-rooms\",\n    defaultMessage: \"You'll need to sign in to add favorite rooms.\"\n  },\n  tweet: {\n    id: \"sign-in-modal.signin-message.tweet\",\n    defaultMessage: \"You'll need to sign in to send tweets.\"\n  }\n});\n\nexport function SubmitEmail({ onSubmitEmail, initialEmail, privacyUrl, termsUrl, message }) {\n  const intl = useIntl();\n\n  const [email, setEmail] = useState(initialEmail);\n\n  const onSubmitForm = useCallback(\n    e => {\n      e.preventDefault();\n      onSubmitEmail(email);\n    },\n    [onSubmitEmail, email]\n  );\n\n  const onChangeEmail = useCallback(\n    e => {\n      setEmail(e.target.value);\n    },\n    [setEmail]\n  );\n\n  return (\n    <Column center padding as=\"form\" onSubmit={onSubmitForm}>\n      <p>\n        {message ? (\n          intl.formatMessage(message)\n        ) : (\n          <FormattedMessage id=\"sign-in-modal.prompt\" defaultMessage=\"Please Sign In\" />\n        )}\n      </p>\n      <TextInputField\n        name=\"email\"\n        type=\"email\"\n        required\n        value={email}\n        onChange={onChangeEmail}\n        placeholder=\"example@example.com\"\n      />\n      <p>\n        <small>\n          <LegalMessage termsUrl={termsUrl} privacyUrl={privacyUrl} />\n        </small>\n      </p>\n      <NextButton type=\"submit\" />\n    </Column>\n  );\n}\n\nSubmitEmail.defaultProps = {\n  initialEmail: \"\"\n};\n\nSubmitEmail.propTypes = {\n  message: PropTypes.object,\n  termsUrl: PropTypes.string,\n  privacyUrl: PropTypes.string,\n  initialEmail: PropTypes.string,\n  onSubmitEmail: PropTypes.func.isRequired\n};\n\nexport function WaitForVerification({ email, onCancel, showNewsletterSignup }) {\n  return (\n    <Column center padding>\n      <FormattedMessage\n        id=\"sign-in-modal.wait-for-verification\"\n        defaultMessage=\"<p>Email sent to {email}!</p><p>To continue, click on the link in the email using your phone, tablet, or PC.</p><p>No email? You may not be able to create an account.</p>\"\n        // eslint-disable-next-line react/display-name\n        values={{ email, p: chunks => <p>{chunks}</p> }}\n      />\n      {showNewsletterSignup && (\n        <p>\n          <small>\n            <FormattedMessage\n              id=\"sign-in-modal.newsletter-signup-question\"\n              defaultMessage=\"Want Hubs news sent to your inbox?\"\n            />\n            <br />\n            <a href=\"https://eepurl.com/gX_fH9\" target=\"_blank\" rel=\"noopener noreferrer\">\n              <FormattedMessage id=\"sign-in-modal.newsletter-signup-link\" defaultMessage=\"Subscribe for updates\" />\n            </a>\n          </small>\n        </p>\n      )}\n      <CancelButton onClick={onCancel} />\n    </Column>\n  );\n}\n\nWaitForVerification.propTypes = {\n  showNewsletterSignup: PropTypes.bool,\n  email: PropTypes.string.isRequired,\n  onCancel: PropTypes.func.isRequired\n};\n\nexport function SignInComplete({ message, onContinue }) {\n  const intl = useIntl();\n\n  return (\n    <Column center padding>\n      <p>\n        <b>\n          {message ? (\n            intl.formatMessage(message)\n          ) : (\n            <FormattedMessage id=\"sign-in-modal.complete\" defaultMessage=\"You are now signed in.\" />\n          )}\n        </b>\n      </p>\n      <ContinueButton onClick={onContinue} />\n    </Column>\n  );\n}\n\nSignInComplete.propTypes = {\n  message: PropTypes.string,\n  onContinue: PropTypes.func.isRequired\n};\n\nexport function SignInModal({ closeable, onClose, children, ...rest }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"sign-in-modal.title\" defaultMessage=\"Sign In\" />}\n      beforeTitle={closeable && <CloseButton onClick={onClose} />}\n      {...rest}\n    >\n      {children}\n    </Modal>\n  );\n}\n\nSignInModal.propTypes = {\n  closeable: PropTypes.bool,\n  onClose: PropTypes.func,\n  children: PropTypes.node\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage, defineMessages } from \"react-intl\";\nimport configs from \"../utils/configs\";\nimport { pushHistoryPath, pushHistoryState, sluglessPath } from \"../utils/history\";\nimport { SOURCES } from \"../storage/media-search-store\";\nimport { showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport { AvatarUrlModalContainer } from \"./room/AvatarUrlModalContainer\";\nimport { SceneUrlModalContainer } from \"./room/SceneUrlModalContainer\";\nimport { ObjectUrlModalContainer } from \"./room/ObjectUrlModalContainer\";\nimport { MediaBrowser } from \"./room/MediaBrowser\";\nimport { IconButton } from \"./input/IconButton\";\nimport { ReactComponent as UploadIcon } from \"./icons/Upload.svg\";\nimport { ReactComponent as LinkIcon } from \"./icons/Link.svg\";\nimport { remixAvatar } from \"../utils/avatar-utils\";\nimport { fetchReticulumAuthenticated, getReticulumFetchUrl } from \"../utils/phoenix-utils\";\nimport { proxiedUrlFor, scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\nimport { CreateTile, MediaTile } from \"./room/MediaTiles\";\nimport { SignInMessages } from \"./auth/SignInModal\";\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst PRIVACY_POLICY_LINKS = {\n  videos: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  images: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  gifs: \"https://tenor.com/legal-privacy\",\n  sketchfab: \"https://sketchfab.com/privacy\",\n  youtube: \"https://policies.google.com/privacy\",\n  twitch: \"https://www.twitch.tv/p/legal/privacy-policy/\"\n};\n\nconst DEFAULT_FACETS = {\n  sketchfab: [\n    { text: \"Featured\", params: { filter: \"featured\" } },\n    { text: \"Animals\", params: { filter: \"animals-pets\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art-abstract\" } },\n    { text: \"Vehicles\", params: { filter: \"cars-vehicles\" } },\n    { text: \"Characters\", params: { filter: \"characters-creatures\" } },\n    { text: \"Culture\", params: { filter: \"cultural-heritage-history\" } },\n    { text: \"Gadgets\", params: { filter: \"electronics-gadgets\" } },\n    { text: \"Fashion\", params: { filter: \"fashion-style\" } },\n    { text: \"Food\", params: { filter: \"food-drink\" } },\n    { text: \"Furniture\", params: { filter: \"furniture-home\" } },\n    { text: \"Music\", params: { filter: \"music\" } },\n    { text: \"Nature\", params: { filter: \"nature-plants\" } },\n    { text: \"News\", params: { filter: \"news-politics\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Places\", params: { filter: \"places-travel\" } },\n    { text: \"Science\", params: { filter: \"science-technology\" } },\n    { text: \"Sports\", params: { filter: \"sports-fitness\" } },\n    { text: \"Weapons\", params: { filter: \"weapons-military\" } }\n  ],\n  avatars: [\n    { text: \"Featured\", params: { filter: \"featured\" } },\n    { text: \"My Avatars\", params: { filter: \"my-avatars\" } },\n    { text: \"Newest\", params: { filter: \"\" } }\n  ],\n  favorites: [],\n  scenes: [{ text: \"Featured\", params: { filter: \"featured\" } }, { text: \"My Scenes\", params: { filter: \"my-scenes\" } }]\n};\n\nconst poweredByMessages = defineMessages({\n  images: {\n    id: \"media-browser.powered_by.images\",\n    defaultMessage: \"Search by Bing\"\n  },\n  videos: {\n    id: \"media-browser.powered_by.videos\",\n    defaultMessage: \"Search by Bing\"\n  },\n  youtube: {\n    id: \"media-browser.powered_by.youtube\",\n    defaultMessage: \"Search by Google\"\n  },\n  gifs: {\n    id: \"media-browser.powered_by.gifs\",\n    defaultMessage: \"Search by Tenor\"\n  },\n  sketchfab: {\n    id: \"media-browser.powered_by.sketchfab\",\n    defaultMessage: \"Search by Sketchfab\"\n  },\n  twitch: {\n    id: \"media-browser.powered_by.twitch\",\n    defaultMessage: \"Search by Twitch\"\n  },\n  scenes: {\n    id: \"media-browser.powered_by.scenes\",\n    defaultMessage: \"Made with {editorName}\"\n  }\n});\n\nconst customObjectMessages = defineMessages({\n  object: {\n    id: \"media-browser.add_custom_object\",\n    defaultMessage: \"Custom URL or File\"\n  },\n  scene: {\n    id: \"media-browser.add_custom_scene\",\n    defaultMessage: \"Custom Scene\"\n  },\n  avatar: {\n    id: \"media-browser.add_custom_avatar\",\n    defaultMessage: \"Avatar GLB URL\"\n  }\n});\n\nconst searchPlaceholderMessages = defineMessages({\n  scenes: { id: \"media-browser.search-placeholder.scenes\", defaultMessage: \"Search Scenes...\" },\n  avatars: { id: \"media-browser.search-placeholder.avatars\", defaultMessage: \"Search Avatars...\" },\n  videos: { id: \"media-browser.search-placeholder.videos\", defaultMessage: \"Search for Videos...\" },\n  images: { id: \"media-browser.search-placeholder.images\", defaultMessage: \"Search for Images...\" },\n  youtube: { id: \"media-browser.search-placeholder.youtube\", defaultMessage: \"Search for Youtube videos...\" },\n  gifs: { id: \"media-browser.search-placeholder.gifs\", defaultMessage: \"Search for GIFs...\" },\n  twitch: { id: \"media-browser.search-placeholder.twitch\", defaultMessage: \"Search for Twitch streams...\" },\n  sketchfab: { id: \"media-browser.search-placeholder.sketchfab\", defaultMessage: \"Search Sketchfab Models...\" },\n  default: { id: \"media-browser.search-placeholder.default\", defaultMessage: \"Search...\" }\n});\n\nconst emptyMessages = defineMessages({\n  favorites: {\n    id: \"media-browser.empty.favorites\",\n    defaultMessage: \"You don't have any favorites. Click a ⭐ to add to your favorites.\"\n  },\n  default: {\n    id: \"media-browser.empty.default\",\n    defaultMessage: \"No results. Try entering a new search above.\"\n  }\n});\n\n// TODO: Migrate to use MediaGrid and media specific components like RoomTile\nclass MediaBrowserContainer extends Component {\n  static propTypes = {\n    mediaSearchStore: PropTypes.object,\n    history: PropTypes.object,\n    intl: PropTypes.object,\n    hubChannel: PropTypes.object,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    performConditionalSignIn: PropTypes.func,\n    showNonHistoriedDialog: PropTypes.func.isRequired,\n    scene: PropTypes.object.isRequired,\n    store: PropTypes.object.isRequired\n  };\n\n  state = { query: \"\", facets: [], showNav: true, selectNextResult: false, clearStashedQueryOnClose: false };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStoreAndHistoryState(props);\n    this.props.mediaSearchStore.addEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.addEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  componentDidMount() {}\n\n  componentWillUnmount() {\n    this.props.mediaSearchStore.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.removeEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  storeUpdated = () => {\n    const newState = this.getStoreAndHistoryState(this.props);\n    this.setState(newState);\n\n    if (this.state.selectNextResult) {\n      if (newState.result && newState.result.entries.length > 0) {\n        this.selectEntry(newState.result.entries[0]);\n      } else {\n        this.close();\n      }\n    }\n  };\n\n  sourceChanged = () => {\n    if (this.inputRef && !isMobile && !isMobileVR) {\n      this.inputRef.focus();\n    }\n  };\n\n  getUrlSource = searchParams =>\n    searchParams.get(\"media_source\") || sluglessPath(this.props.history.location).substring(7);\n\n  getStoreAndHistoryState = props => {\n    const searchParams = new URLSearchParams(props.history.location.search);\n    const result = props.mediaSearchStore.result;\n\n    const newState = { result, query: this.state.query || searchParams.get(\"q\") || \"\" };\n    const urlSource = this.getUrlSource(searchParams);\n    newState.showNav = !!(searchParams.get(\"media_nav\") !== \"false\");\n    newState.selectAction = searchParams.get(\"selectAction\") || \"spawn\";\n\n    if (result && result.suggestions && result.suggestions.length > 0) {\n      newState.facets = result.suggestions.map(s => {\n        return { text: s, params: { q: s } };\n      });\n    } else {\n      newState.facets = DEFAULT_FACETS[urlSource] || [];\n    }\n\n    return newState;\n  };\n\n  handleQueryUpdated = (query, forceNow) => {\n    this.setState({ result: null });\n\n    if (this._sendQueryTimeout) {\n      clearTimeout(this._sendQueryTimeout);\n      this._sendQueryTimeout = null;\n    }\n\n    if (forceNow) {\n      this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n    } else {\n      // Don't update search on every keystroke, but buffer for some ms.\n      this._sendQueryTimeout = setTimeout(() => {\n        // Drop filter for now, so entering text drops into \"search all\" mode\n        this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n        this._sendQueryTimeout = null;\n      }, 500);\n    }\n\n    this.setState({ query });\n  };\n\n  handleEntryClicked = (evt, entry) => {\n    evt.preventDefault();\n\n    if (!entry.lucky_query) {\n      this.selectEntry(entry);\n    } else {\n      // Entry has a pointer to another \"i'm feeling lucky\" query -- used for trending videos\n      //\n      // Also, mark the browser to clear the stashed query on close, since this is a temporary\n      // query we are running to get the result we want.\n      this.setState({ clearStashedQueryOnClose: true });\n      this.handleQueryUpdated(entry.lucky_query, true);\n    }\n  };\n\n  onShowSimilar = (id, name) => {\n    this.handleFacetClicked({ params: { similar_to: id, similar_name: name } });\n  };\n\n  selectEntry = entry => {\n    if (!this.props.onMediaSearchResultEntrySelected) return;\n    this.props.onMediaSearchResultEntrySelected(entry, this.state.selectAction);\n    this.close();\n  };\n\n  handleSourceClicked = source => {\n    this.props.mediaSearchStore.sourceNavigate(source);\n  };\n\n  handleFacetClicked = facet => {\n    this.setState({ query: \"\" }, () => {\n      const searchParams = this.getSearchClearedSearchParams(true, true, true);\n\n      for (const [k, v] of Object.entries(facet.params)) {\n        searchParams.set(k, v);\n      }\n\n      pushHistoryPath(this.props.history, this.props.history.location.pathname, searchParams.toString());\n    });\n  };\n\n  getSearchClearedSearchParams = (keepSource, keepNav, keepSelectAction) => {\n    return this.props.mediaSearchStore.getSearchClearedSearchParams(\n      this.props.history.location,\n      keepSource,\n      keepNav,\n      keepSelectAction\n    );\n  };\n\n  pushExitMediaBrowserHistory = (stashLastSearchParams = true) => {\n    this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history, stashLastSearchParams);\n  };\n\n  showCustomMediaDialog = source => {\n    const { scene, store, hubChannel } = this.props;\n    const isAvatarApiType = source === \"avatars\";\n    this.pushExitMediaBrowserHistory(!isAvatarApiType);\n\n    if (source === \"scenes\") {\n      this.props.showNonHistoriedDialog(SceneUrlModalContainer, { hubChannel });\n    } else if (isAvatarApiType) {\n      this.props.showNonHistoriedDialog(AvatarUrlModalContainer, { scene, store });\n    } else {\n      this.props.showNonHistoriedDialog(ObjectUrlModalContainer, { scene });\n    }\n  };\n\n  close = () => {\n    showFullScreenIfWasFullScreen();\n    const urlSource = this.getUrlSource(new URLSearchParams(this.props.history.location.search));\n    this.pushExitMediaBrowserHistory(urlSource !== \"avatars\" && urlSource !== \"favorites\");\n    if (this.state.clearStashedQueryOnClose) {\n      this.props.mediaSearchStore.clearStashedQuery();\n    }\n  };\n\n  handlePager = delta => {\n    this.setState({ result: null });\n    this.props.mediaSearchStore.pageNavigate(delta);\n    this.browserDiv.scrollTop = 0;\n  };\n\n  handleCopyAvatar = (e, entry) => {\n    e.preventDefault();\n\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      async () => {\n        await remixAvatar(entry.id, entry.name);\n        this.handleFacetClicked({ params: { filter: \"my-avatars\" } });\n      },\n      SignInMessages.remixAvatar\n    );\n  };\n\n  handleCopyScene = async (e, entry) => {\n    e.preventDefault();\n\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      async () => {\n        await fetchReticulumAuthenticated(\"/api/v1/scenes\", \"POST\", {\n          parent_scene_id: entry.id\n        });\n        this.handleFacetClicked({ params: { filter: \"my-scenes\" } });\n      },\n      SignInMessages.remixScene\n    );\n  };\n\n  onCreateAvatar = () => {\n    window.dispatchEvent(new CustomEvent(\"action_create_avatar\"));\n  };\n\n  processThumbnailUrl = (entry, thumbnailWidth, thumbnailHeight) => {\n    if (entry.images.preview.type === \"mp4\") {\n      return proxiedUrlFor(entry.images.preview.url);\n    } else {\n      return scaledThumbnailUrlFor(entry.images.preview.url, thumbnailWidth, thumbnailHeight);\n    }\n  };\n\n  render() {\n    const intl = this.props.intl;\n    const searchParams = new URLSearchParams(this.props.history.location.search);\n    const urlSource = this.getUrlSource(searchParams);\n    const isSceneApiType = urlSource === \"scenes\";\n    const isFavorites = urlSource === \"favorites\";\n    const showCustomOption =\n      !isFavorites && (!isSceneApiType || this.props.hubChannel.canOrWillIfCreator(\"update_hub\"));\n    const entries = (this.state.result && this.state.result.entries) || [];\n    const hideSearch = urlSource === \"favorites\";\n    const showEmptyStringOnNoResult = urlSource !== \"avatars\" && urlSource !== \"scenes\";\n\n    const facets = this.state.facets && this.state.facets.length > 0 ? this.state.facets : undefined;\n\n    // Don't render anything if we just did a feeling lucky query and are waiting on result.\n    if (this.state.selectNextResult) return <div />;\n    const handleCustomClicked = urlSource => {\n      const isAvatarApiType = urlSource === \"avatars\";\n      if (isAvatarApiType) {\n        this.showCustomMediaDialog(urlSource);\n      } else {\n        this.props.performConditionalSignIn(\n          () => !isSceneApiType || this.props.hubChannel.can(\"update_hub\"),\n          () => this.showCustomMediaDialog(urlSource),\n          SignInMessages.changeScene\n        );\n      }\n    };\n\n    const activeFilter =\n      searchParams.get(\"filter\") || (searchParams.get(\"similar_to\") && \"similar\") || (!searchParams.get(\"q\") && \"\");\n\n    const meta = this.state.result && this.state.result.meta;\n    const hasNext = !!(meta && meta.next_cursor);\n    const hasPrevious = !!searchParams.get(\"cursor\");\n\n    const customObjectType =\n      this.state.result && isSceneApiType ? \"scene\" : urlSource === \"avatars\" ? \"avatar\" : \"object\";\n\n    let searchDescription;\n\n    if (!hideSearch && urlSource !== \"scenes\" && urlSource !== \"avatars\" && urlSource !== \"favorites\") {\n      searchDescription = (\n        <>\n          {poweredByMessages[urlSource] ? intl.formatMessage(poweredByMessages[urlSource]) : \"\"}\n          {poweredByMessages[urlSource] && PRIVACY_POLICY_LINKS[urlSource] ? \" | \" : \"\"}\n          {PRIVACY_POLICY_LINKS[urlSource] && (\n            <a href={PRIVACY_POLICY_LINKS[urlSource]} target=\"_blank\" rel=\"noreferrer noopener\">\n              <FormattedMessage id=\"media-browser.privacy_policy\" defaultMessage=\"Privacy Policy\" />\n            </a>\n          )}\n        </>\n      );\n    } else if (urlSource === \"scenes\") {\n      searchDescription = (\n        <>\n          {configs.feature(\"enable_spoke\") && (\n            <>\n              {intl.formatMessage(poweredByMessages.scenes, {\n                editorName: (\n                  <a href=\"/spoke\" target=\"_blank\" rel=\"noreferrer noopener\">\n                    {configs.translation(\"editor-name\")}\n                  </a>\n                )\n              })}\n            </>\n          )}\n          {configs.feature(\"enable_spoke\") && configs.feature(\"show_issue_report_link\") && \" | \"}\n          {configs.feature(\"show_issue_report_link\") && (\n            <a\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              href={configs.link(\"issue_report\", \"https://hubs.mozilla.com/docs/help.html\")}\n            >\n              <FormattedMessage id=\"media-browser.report-issue\" defaultMessage=\"Report Issue\" />\n            </a>\n          )}\n        </>\n      );\n    }\n\n    return (\n      <MediaBrowser\n        browserRef={r => (this.browserDiv = r)}\n        onClose={this.close}\n        searchInputRef={r => (this.inputRef = r)}\n        autoFocusSearch={!isMobile && !isMobileVR}\n        query={this.state.query}\n        onChangeQuery={e => this.handleQueryUpdated(e.target.value)}\n        onSearchKeyDown={e => {\n          if (e.key === \"Enter\" && e.ctrlKey) {\n            if (entries.length > 0 && !this._sendQueryTimeout) {\n              this.handleEntryClicked(e, entries[0]);\n            } else if (this.state.query.trim() !== \"\") {\n              this.handleQueryUpdated(this.state.query, true);\n              this.setState({ selectNextResult: true });\n            } else {\n              this.close();\n            }\n          } else if (e.key === \"Escape\" || (e.key === \"Enter\" && isMobile)) {\n            e.target.blur();\n          }\n        }}\n        onClearSearch={() => this.handleQueryUpdated(\"\", true)}\n        mediaSources={urlSource === \"favorites\" ? undefined : SOURCES}\n        selectedSource={urlSource}\n        onSelectSource={this.handleSourceClicked}\n        activeFilter={activeFilter}\n        facets={facets}\n        onSelectFacet={this.handleFacetClicked}\n        searchPlaceholder={\n          searchPlaceholderMessages[urlSource]\n            ? intl.formatMessage(searchPlaceholderMessages[urlSource])\n            : intl.formatMessage(searchPlaceholderMessages.default)\n        }\n        searchDescription={searchDescription}\n        headerRight={\n          showCustomOption && (\n            <IconButton lg onClick={() => handleCustomClicked(urlSource)}>\n              {[\"scenes\", \"avatars\"].includes(urlSource) ? <LinkIcon /> : <UploadIcon />}\n              <p>{intl.formatMessage(customObjectMessages[customObjectType])}</p>\n            </IconButton>\n          )\n        }\n        hasNext={hasNext}\n        hasPrevious={hasPrevious}\n        onNextPage={() => this.handlePager(1)}\n        onPreviousPage={() => this.handlePager(-1)}\n        noResultsMessage={\n          emptyMessages[urlSource]\n            ? intl.formatMessage(emptyMessages[urlSource])\n            : intl.formatMessage(emptyMessages.default)\n        }\n      >\n        {this.props.mediaSearchStore.isFetching ||\n        this._sendQueryTimeout ||\n        entries.length > 0 ||\n        !showEmptyStringOnNoResult ? (\n          <>\n            {urlSource === \"avatars\" && (\n              <CreateTile\n                type=\"avatar\"\n                onClick={this.onCreateAvatar}\n                label={<FormattedMessage id=\"media-browser.create-avatar\" defaultMessage=\"Create Avatar\" />}\n              />\n            )}\n            {urlSource === \"scenes\" &&\n              configs.feature(\"enable_spoke\") && (\n                <CreateTile\n                  as=\"a\"\n                  href=\"/spoke/new\"\n                  rel=\"noopener noreferrer\"\n                  target=\"_blank\"\n                  type=\"scene\"\n                  label={\n                    <FormattedMessage\n                      id=\"media-browser.create-scene\"\n                      defaultMessage=\"Create Scene with {editorName}\"\n                      values={{ editorName: configs.translation(\"editor-name\") }}\n                    />\n                  }\n                />\n              )}\n            {entries.map((entry, idx) => {\n              const isAvatar = entry.type === \"avatar\" || entry.type === \"avatar_listing\";\n              const isScene = entry.type === \"scene\" || entry.type === \"scene_listing\";\n              const onShowSimilar =\n                entry.type === \"avatar_listing\"\n                  ? e => {\n                      e.preventDefault();\n                      this.onShowSimilar(entry.id, entry.name);\n                    }\n                  : undefined;\n\n              let onEdit;\n\n              if (entry.type === \"avatar\") {\n                onEdit = e => {\n                  e.preventDefault();\n                  pushHistoryState(this.props.history, \"overlay\", \"avatar-editor\", { avatarId: entry.id });\n                };\n              } else if (entry.type === \"scene\") {\n                onEdit = e => {\n                  e.preventDefault();\n                  const spokeProjectUrl = getReticulumFetchUrl(`/spoke/projects/${entry.project_id}`);\n                  window.open(spokeProjectUrl);\n                };\n              }\n\n              let onCopy;\n\n              if (isAvatar) {\n                onCopy = e => this.handleCopyAvatar(e, entry);\n              } else if (isScene) {\n                onCopy = e => this.handleCopyScene(e, entry);\n              }\n\n              return (\n                <MediaTile\n                  key={`${entry.id}_${idx}`}\n                  entry={entry}\n                  processThumbnailUrl={this.processThumbnailUrl}\n                  onClick={e => this.handleEntryClicked(e, entry)}\n                  onEdit={onEdit}\n                  onShowSimilar={onShowSimilar}\n                  onCopy={onCopy}\n                />\n              );\n            })}\n          </>\n        ) : null}\n      </MediaBrowser>\n    );\n  }\n}\n\nexport default injectIntl(MediaBrowserContainer);\n","import { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\n// this component is currently just being used for its componentDidMount\n// TODO migrate render from ui-root.js renderEntryStartPanel()\nexport default class EntryStartPanel extends Component {\n  static propTypes = {\n    entering: PropTypes.bool,\n    onEnteringCanceled: PropTypes.func\n  };\n\n  componentDidMount() {\n    if (this.props.entering) {\n      this.props.onEnteringCanceled();\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n","import configs from \"../utils/configs\";\n\nexport default function IfFeature(props) {\n  return (configs.feature(props.name) && props.children) || null;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { defineMessage, FormattedMessage, injectIntl } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faCloudUploadAlt } from \"@fortawesome/free-solid-svg-icons/faCloudUploadAlt\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport configs from \"../utils/configs\";\nimport IfFeature from \"./if-feature\";\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport { upload } from \"../utils/media-utils\";\nimport { ensureAvatarMaterial } from \"../utils/avatar-utils\";\n\nimport AvatarPreview from \"./avatar-preview\";\nimport styles from \"../assets/stylesheets/avatar-editor.scss\";\n\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader\";\n\nconst delistAvatarInfoMessage = defineMessage({\n  id: \"avatar-editor.delist-avatar-info\",\n  defaultMessage:\n    \"Other users already using this avatar will still be able to use it, but it will be removed from 'My Avatars' and search results.\"\n});\n\nconst AVATARS_API = \"/api/v1/avatars\";\n\nconst defaultEditors = [\n  {\n    name: \"Quilt\",\n    url: \"https://tryquilt.io/?gltf=$AVATAR_GLTF\"\n  }\n];\nconst useAllowedEditors = true;\nconst allowedEditors = [\n  ...defaultEditors,\n  {\n    name: \"Skindex Editor\",\n    url: \"https://www.minecraftskins.com/skin-editor\"\n  },\n  {\n    name: \"MinecraftSkins.net Editor\",\n    url: \"https://www.minecraftskins.net/skineditor\"\n  }\n];\n\nconst fetchAvatar = async avatarId => {\n  const { avatars } = await fetchReticulumAuthenticated(`${AVATARS_API}/${avatarId}`);\n  return avatars[0];\n};\n\n// GLTFLoader plugin for splitting glTF and bin from glb.\nclass GLTFBinarySplitterPlugin {\n  constructor(parser) {\n    this.parser = parser;\n    this.gltf = null;\n    this.bin = null;\n  }\n\n  beforeRoot() {\n    const parser = this.parser;\n    const { body } = parser.extensions.KHR_binary_glTF;\n    const content = JSON.stringify(ensureAvatarMaterial(parser.json));\n\n    this.gltf = new File([content], \"file.gltf\", {\n      type: \"model/gltf\"\n    });\n    this.bin = new File([body], \"file.bin\", {\n      type: \"application/octet-stream\"\n    });\n\n    // This plugin just wants to split gltf and bin from glb and\n    // doesn't want to start the parse. But glTF loader plugin API\n    // doesn't have an ability to cancel the parse. So overriding\n    // parser.json with very light glTF data as workaround.\n    parser.json = { asset: { version: \"2.0\" } };\n  }\n\n  afterRoot(result) {\n    result.files = result.files || {};\n    result.files.gltf = this.gltf;\n    result.files.bin = this.bin;\n  }\n}\n\nclass AvatarEditor extends Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    onSave: PropTypes.func,\n    onClose: PropTypes.func,\n    hideDelete: PropTypes.bool,\n    debug: PropTypes.bool,\n    className: PropTypes.string,\n    intl: PropTypes.object.isRequired\n  };\n\n  state = {\n    baseAvatarResults: [],\n    editorLinks: defaultEditors,\n    previewGltfUrl: null\n  };\n\n  constructor(props) {\n    super(props);\n    this.inputFiles = {};\n  }\n\n  componentDidMount = async () => {\n    if (this.props.avatarId) {\n      const avatar = await fetchAvatar(this.props.avatarId);\n      avatar.creatorAttribution = (avatar.attributions && avatar.attributions.creator) || \"\";\n      Object.assign(this.inputFiles, avatar.files);\n      this.setState({ avatar, previewGltfUrl: avatar.base_gltf_url });\n    } else {\n      const { entries } = await fetchReticulumAuthenticated(`/api/v1/media/search?filter=base&source=avatar_listings`);\n      const baseAvatarResults = entries.map(e => ({ id: e.id, name: e.name, gltfs: e.gltfs, images: e.images }));\n      if (baseAvatarResults.length) {\n        const randomAvatarResult = baseAvatarResults[Math.floor(Math.random() * baseAvatarResults.length)];\n        this.setState({\n          baseAvatarResults,\n          avatar: {\n            name: \"My Avatar\",\n            files: {},\n            base_gltf_url: randomAvatarResult.gltfs.base,\n            parent_avatar_listing_id: randomAvatarResult.id\n          },\n          previewGltfUrl: randomAvatarResult.gltfs.avatar\n        });\n      } else {\n        this.setState({\n          avatar: {\n            name: \"My Avatar\",\n            files: {}\n          }\n        });\n      }\n    }\n  };\n\n  createOrUpdateAvatar = avatar => {\n    return fetchReticulumAuthenticated(\n      avatar.avatar_id ? `${AVATARS_API}/${avatar.avatar_id}` : AVATARS_API,\n      avatar.avatar_id ? \"PUT\" : \"POST\",\n      { avatar }\n    ).then(({ avatars }) => avatars[0]);\n  };\n\n  uploadAvatar = async e => {\n    e.preventDefault();\n\n    if (this.inputFiles.glb && this.inputFiles.glb instanceof File) {\n      const gltfLoader = new GLTFLoader().register(parser => new GLTFBinarySplitterPlugin(parser));\n      const gltfUrl = URL.createObjectURL(this.inputFiles.glb);\n      const onProgress = console.log;\n\n      await new Promise((resolve, reject) => {\n        // GLTFBinarySplitterPlugin saves gltf and bin in gltf.files\n        gltfLoader.load(\n          gltfUrl,\n          result => {\n            this.inputFiles.gltf = result.files.gltf;\n            this.inputFiles.bin = result.files.bin;\n            resolve(result);\n          },\n          onProgress,\n          reject\n        );\n      });\n\n      URL.revokeObjectURL(gltfUrl);\n    }\n\n    this.inputFiles.thumbnail = new File([await this.preview.snapshot()], \"thumbnail.png\", {\n      type: \"image/png\"\n    });\n\n    const filesToUpload = [\"gltf\", \"bin\", \"base_map\", \"emissive_map\", \"normal_map\", \"orm_map\", \"thumbnail\"].filter(\n      k => this.inputFiles[k] === null || this.inputFiles[k] instanceof File\n    );\n\n    this.setState({ uploading: true });\n\n    const fileUploads = await Promise.all(filesToUpload.map(f => this.inputFiles[f] && upload(this.inputFiles[f])));\n    const avatar = {\n      ...this.state.avatar,\n      attributions: {\n        creator: this.state.avatar.creatorAttribution\n      },\n      files: fileUploads\n        .map((resp, i) => [filesToUpload[i], resp && [resp.file_id, resp.meta.access_token, resp.meta.promotion_token]])\n        .reduce((o, [k, v]) => ({ ...o, [k]: v }), {})\n    };\n\n    await this.createOrUpdateAvatar(avatar);\n\n    this.setState({ uploading: false });\n\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  deleteAvatar = async e => {\n    e.preventDefault();\n    await fetchReticulumAuthenticated(`${AVATARS_API}/${this.state.avatar.avatar_id}`, \"DELETE\");\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  fileField = (name, label, accept, disabled = false, title) => (\n    <div className={classNames(\"file-input-row\", { disabled })} key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\" />\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[name] = file;\n          URL.revokeObjectURL(this.state.previewGltfUrl);\n          const previewGltfUrl = URL.createObjectURL(this.inputFiles.glb);\n          this.setState({\n            previewGltfUrl,\n            avatar: {\n              ...this.state.avatar,\n              files: {\n                ...this.state.avatar.files,\n                [name]: URL.createObjectURL(file)\n              }\n            }\n          });\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n            URL.revokeObjectURL(this.state.avatar.files[name]);\n            this.setState(\n              {\n                avatar: {\n                  ...this.state.avatar,\n                  files: {\n                    ...this.state.avatar.files,\n                    [name]: null\n                  }\n                }\n              },\n              () => this.setState({ previewGltfUrl: this.getPreviewUrl() })\n            );\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  mapField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\">\n          {this.state.avatar.files[name] ? (\n            <img src={this.state.avatar.files[name]} />\n          ) : (\n            <FontAwesomeIcon icon={faCloudUploadAlt} />\n          )}\n        </div>\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[name] = file;\n          URL.revokeObjectURL(this.state.avatar.files[name]);\n          this.setState({\n            avatar: {\n              ...this.state.avatar,\n              files: {\n                ...this.state.avatar.files,\n                [name]: URL.createObjectURL(file)\n              }\n            }\n          });\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n            URL.revokeObjectURL(this.state.avatar.files[name]);\n            this.setState({\n              avatar: {\n                ...this.state.avatar,\n                files: {\n                  ...this.state.avatar.files,\n                  [name]: null\n                }\n              }\n            });\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  textField = (name, placeholder, disabled, required) => (\n    <div className=\"text-field-container\">\n      <label htmlFor={`#avatar-${name}`}>{placeholder}</label>\n      <input\n        id={`avatar-${name}`}\n        type=\"text\"\n        disabled={disabled}\n        required={required}\n        placeholder={placeholder}\n        className=\"text-field\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  // Return the gltf for the selected base avatar, the locally modified glb, or the avatar's base_gltf_url\n  getPreviewUrl = baseSid => {\n    if (baseSid) {\n      const avatarResult = this.state.baseAvatarResults.find(a => a.id === baseSid);\n      if (avatarResult) return avatarResult.gltfs.avatar;\n    }\n\n    return this.inputFiles.glb ? URL.createObjectURL(this.inputFiles.glb) : this.state.avatar.base_gltf_url;\n  };\n\n  selectListingField = (propName, placeholder) => (\n    <div className=\"select-container\">\n      <label htmlFor={`#avatar-${propName}`}>{placeholder}</label>\n      <select\n        id={`avatar-${propName}`}\n        value={this.state.avatar[propName] || \"\"}\n        onChange={async e => {\n          const sid = e.target.value;\n          this.setState({ avatar: { ...this.state.avatar, [propName]: sid }, previewGltfUrl: this.getPreviewUrl(sid) });\n        }}\n        placeholder={placeholder}\n        className=\"select\"\n      >\n        {this.state.baseAvatarResults.map(a => (\n          <option key={a.id} value={a.id}>\n            {a.name}\n          </option>\n        ))}\n        <option value=\"\">\n          <FormattedMessage id=\"avatar-editor.custom-avatar-option\" defaultMessage=\"Custom GLB...\" />\n        </option>\n      </select>\n      <img\n        className=\"arrow\"\n        src=\"../assets/images/dropdown_arrow.png\"\n        srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n      />\n    </div>\n  );\n\n  selectListingGrid = (propName, placeholder) => (\n    <div className=\"select-grid-container\">\n      <label htmlFor={`#avatar-${propName}`}>{placeholder}</label>\n      <div className=\"select-grid\">\n        {this.state.baseAvatarResults.map(a => (\n          <div\n            onClick={() =>\n              this.setState({\n                avatar: { ...this.state.avatar, [propName]: a.id },\n                previewGltfUrl: this.getPreviewUrl(a.id)\n              })\n            }\n            key={a.id}\n            className={classNames(\"item\", { selected: a.id === this.state.avatar[propName] })}\n            style={{ paddingBottom: `${(a.images.preview.width / a.images.preview.height) * 100}%` }}\n          >\n            <img src={a.images.preview.url} />\n          </div>\n        ))}\n      </div>\n      <input\n        id=\"avatar-file_glb\"\n        type=\"file\"\n        accept=\"model/gltf+binary,.glb\"\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[\"glb\"] = file;\n          URL.revokeObjectURL(this.state.avatar.files[\"glb\"]);\n          this.setState({\n            avatar: {\n              ...this.state.avatar,\n              [propName]: \"\",\n              files: {\n                ...this.state.avatar.files,\n                glb: URL.createObjectURL(file)\n              }\n            },\n            previewGltfUrl: this.getPreviewUrl(\"\")\n          });\n        }}\n      />\n      <label\n        htmlFor=\"avatar-file_glb\"\n        className={classNames(\"item\", \"custom\", { selected: \"\" === this.state.avatar[propName] })}\n      >\n        <FormattedMessage\n          id=\"avatar-editor.upload-custom-avatar-button\"\n          defaultMessage=\"{icon} Custom GLB\"\n          values={{ icon: <FontAwesomeIcon icon={faCloudUploadAlt} /> }}\n        />\n      </label>\n    </div>\n  );\n\n  textarea = (name, placeholder, disabled) => (\n    <div>\n      <textarea\n        id={`avatar-${name}`}\n        disabled={disabled}\n        placeholder={placeholder}\n        className=\"textarea\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  checkbox = (name, title, children, disabled) => (\n    <div className=\"checkbox-container\" title={title}>\n      <input\n        id={`avatar-${name}`}\n        type=\"checkbox\"\n        className=\"checkbox\"\n        disabled={disabled}\n        checked={!!this.state.avatar[name]}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.checked } })}\n      />\n      <label htmlFor={`#avatar-${name}`}>{children}</label>\n    </div>\n  );\n\n  handleGltfLoaded = gltf => {\n    const ext = gltf.parser.json.extensions && gltf.parser.json.extensions[\"MOZ_hubs_avatar\"];\n    let editorLinks = (ext && ext.editors) || defaultEditors;\n    if (useAllowedEditors) {\n      editorLinks = editorLinks.filter(e => allowedEditors.some(w => w.name === e.name && w.url === e.url));\n    }\n    this.setState({ editorLinks });\n  };\n\n  render() {\n    const { debug, intl } = this.props;\n    const { avatar } = this.state;\n\n    return (\n      <div className={classNames(styles.avatarEditor, this.props.className)}>\n        {this.props.onClose && (\n          <a className=\"close-button\" onClick={this.props.onClose}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </a>\n        )}\n        {!this.state.avatar ? (\n          <div className=\"loader\">\n            <div className=\"loader-center\" />\n          </div>\n        ) : (\n          <form onSubmit={this.uploadAvatar} className=\"center\">\n            {this.textField(\"name\", \"Name\", false, true)}\n            <div className=\"split\">\n              <div className=\"form-body\">\n                {debug &&\n                  this.textField(\n                    \"avatar_id\",\n                    intl.formatMessage({ id: \"avatar-editor.field.avatar-id\", defaultMessage: \"Avatar ID\" }),\n                    true\n                  )}\n                {debug &&\n                  this.textField(\n                    \"parent_avatar_id\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.parent-avatar-id\",\n                      defaultMessage: \"Parent Avatar ID\"\n                    })\n                  )}\n                {debug &&\n                  this.textField(\n                    \"parent_avatar_listing_id\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.parent-avatar-listing-id\",\n                      defaultMessage: \"Parent Avatar Listing ID\"\n                    })\n                  )}\n                {debug &&\n                  this.textarea(\n                    \"description\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.description\",\n                      defaultMessage: \"Description\"\n                    })\n                  )}\n                {!this.props.avatarId &&\n                  this.selectListingGrid(\n                    \"parent_avatar_listing_id\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.model\",\n                      defaultMessage: \"Model\"\n                    })\n                  )}\n\n                <label>\n                  <FormattedMessage id=\"avatar-editor.skin-section\" defaultMessage=\"Skin\" />\n                </label>\n                {this.mapField(\n                  \"base_map\",\n                  intl.formatMessage({\n                    id: \"avatar-editor.field.base-map\",\n                    defaultMessage: \"Base Map\"\n                  }),\n                  \"image/*\"\n                )}\n                <details>\n                  <summary>\n                    <FormattedMessage id=\"avatar-editor.advanced-section\" defaultMessage=\"Advanced\" />\n                  </summary>\n                  {this.mapField(\n                    \"emissive_map\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.emissive-map\",\n                      defaultMessage: \"Emissive Map\"\n                    }),\n                    \"image/*\"\n                  )}\n                  {this.mapField(\n                    \"normal_map\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.normal-map\",\n                      defaultMessage: \"Normal Map\"\n                    }),\n                    \"image/*\"\n                  )}\n                  {this.mapField(\n                    \"orm_map\",\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.orm-map\",\n                      defaultMessage: \"ORM Map\"\n                    }),\n                    \"image/*\",\n                    false,\n                    intl.formatMessage({\n                      id: \"avatar-editor.field.orm-map-info\",\n                      defaultMessage: \"Occlussion (r), Roughness (g), Metallic (b)\"\n                    })\n                  )}\n                </details>\n\n                <label>\n                  <FormattedMessage id=\"avatar-editor.share-settings\" defaultMessage=\"Share Settings\" />\n                </label>\n                {this.checkbox(\n                  \"allow_promotion\",\n                  intl.formatMessage(\n                    {\n                      id: \"avatar-editor.field.allow-promotion\",\n                      defaultMessage: \"Allow {companyName} to promote your avatar, and show it in search results.\"\n                    },\n                    { companyName: configs.translation(\"company-name\") }\n                  ),\n                  <span>\n                    <FormattedMessage\n                      id=\"avatar-editor.field.allow-promotion-checkbox\"\n                      defaultMessage=\"Allow <a>Promotion</a>\"\n                      values={{\n                        a: chunks => (\n                          <a\n                            href={configs.link(\"promotion\", \"https://github.com/mozilla/hubs/blob/master/PROMOTION.md\")}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            {chunks}\n                          </a>\n                        )\n                      }}\n                    />\n                  </span>\n                )}\n                {this.checkbox(\n                  \"allow_remixing\",\n                  intl.formatMessage({\n                    id: \"avatar-editor.field.allow-remixing\",\n                    defaultMessage: \"Allow others to edit and re-publish your avatar as long as they give you credit.\"\n                  }),\n                  <span>\n                    <FormattedMessage\n                      id=\"avatar-editor.field.allow-remixing-checkbox\"\n                      defaultMessage=\"Allow <a>Remixing</a> <license>(under <licenselink>CC-BY 3.0</licenselink>)</license>\"\n                      values={{\n                        a: chunks => (\n                          <a\n                            href={configs.link(\"remixing\", \"https://github.com/mozilla/hubs/blob/master/REMIXING.md\")}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            {chunks}\n                          </a>\n                        ),\n                        license: chunks => <span className=\"license\">{chunks}</span>,\n                        licenselink: chunks => (\n                          <a\n                            href=\"https://creativecommons.org/licenses/by/3.0/\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            {chunks}\n                          </a>\n                        )\n                      }}\n                    />\n                  </span>\n                )}\n                {this.textField(\n                  \"creatorAttribution\",\n                  intl.formatMessage({\n                    id: \"avatar-editor.field.creator-attribution\",\n                    defaultMessage: \"Attribution (optional)\"\n                  }),\n                  false,\n                  false\n                )}\n                {/* {this.mapField(\"ao_map\", \"AO Map\", \"images/\\*\", true)} */}\n                {/* {this.mapField(\"metallic_map\", \"Metallic Map\", \"image/\\*\", true)} */}\n                {/* {this.mapField(\"roughness_map\", \"Roughness Map\", \"image/\\*\", true)} */}\n              </div>\n              <AvatarPreview\n                className=\"preview\"\n                avatarGltfUrl={this.state.previewGltfUrl}\n                onGltfLoaded={this.handleGltfLoaded}\n                {...this.inputFiles}\n                ref={p => (this.preview = p)}\n              />\n            </div>\n            <div className=\"info\">\n              <IfFeature name=\"show_avatar_editor_link\">\n                <p>\n                  <FormattedMessage\n                    id=\"avatar-editor.external-editor-info\"\n                    defaultMessage=\"Create a custom skin for this avatar:\"\n                  />{\" \"}\n                  {this.state.editorLinks.map(({ name, url }) => (\n                    <a\n                      key={name}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      href={url.replace(\"$AVATAR_GLTF\", encodeURIComponent(this.state.previewGltfUrl))}\n                    >\n                      {name}\n                    </a>\n                  ))}\n                </p>\n              </IfFeature>\n              <IfFeature name=\"show_avatar_pipelines_link\">\n                <p>\n                  <FormattedMessage\n                    id=\"avatar-editor.info\"\n                    defaultMessage=\"Find more custom avatar resources <a>here</a>\"\n                    values={{\n                      a: chunks => (\n                        <a\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          href=\"https://github.com/MozillaReality/hubs-avatar-pipelines\"\n                        >\n                          {chunks}\n                        </a>\n                      )\n                    }}\n                  />\n                </p>\n              </IfFeature>\n            </div>\n            <div>\n              <button disabled={this.state.uploading} className=\"form-submit\" type=\"submit\">\n                {this.state.uploading ? (\n                  <FormattedMessage id=\"avatar-editor.submit-button.uploading\" defaultMessage=\"Uploading...\" />\n                ) : (\n                  <FormattedMessage id=\"avatar-editor.submit-button.save\" defaultMessage=\"Save\" />\n                )}\n              </button>\n            </div>\n            {!this.props.hideDelete && (\n              <div className=\"delete-avatar\">\n                {this.state.confirmDelete ? (\n                  <span>\n                    <FormattedMessage\n                      id=\"avatar-editor.delete-avatar.confirmation-prompt\"\n                      defaultMessage=\"Are you sure?\"\n                    />{\" \"}\n                    <a onClick={this.deleteAvatar}>\n                      <FormattedMessage id=\"avatar-editor.delete-avatar.confirm\" defaultMessage=\"yes\" />\n                    </a>{\" \"}\n                    /{\" \"}\n                    <a onClick={() => this.setState({ confirmDelete: false })}>\n                      <FormattedMessage id=\"avatar-editor.delete-avatar.cancel\" defaultMessage=\"no\" />\n                    </a>\n                  </span>\n                ) : (\n                  <a\n                    onClick={() => this.setState({ confirmDelete: true })}\n                    title={avatar.has_listings ? intl.formatMessage(delistAvatarInfoMessage) : \"\"}\n                  >\n                    {avatar.has_listings ? (\n                      <FormattedMessage id=\"avatar-editor.delist-avatar-button\" defaultMessage=\"Delist Avatar\" />\n                    ) : (\n                      <FormattedMessage id=\"avatar-editor.delete-avatar-button\" defaultMessage=\"Delete Avatar\" />\n                    )}\n                  </a>\n                )}\n              </div>\n            )}\n          </form>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarEditor);\n","// extracted by mini-css-extract-plugin\nexport default {\"avatar-editor\":\"avatar-editor__avatar-editor___imLb\",\"avatarEditor\":\"avatar-editor__avatar-editor___imLb\",\"no-default-button-style\":\"avatar-editor__no-default-button-style__lSVD9\",\"noDefaultButtonStyle\":\"avatar-editor__no-default-button-style__lSVD9\"};","// extracted by mini-css-extract-plugin\nexport default {\"nav-item\":\"preferences-screen__nav-item__VrLF0\",\"navItem\":\"preferences-screen__nav-item__VrLF0\",\"dropdown\":\"preferences-screen__dropdown__LrsA3\",\"section-title\":\"preferences-screen__section-title__J4cDt\",\"sectionTitle\":\"preferences-screen__section-title__J4cDt\",\"refresh-prompt\":\"preferences-screen__refresh-prompt__pwOTs\",\"refreshPrompt\":\"preferences-screen__refresh-prompt__pwOTs\",\"preference-label\":\"preferences-screen__preference-label__aHcLt\",\"preferenceLabel\":\"preferences-screen__preference-label__aHcLt\",\"max-resolution-preference-item\":\"preferences-screen__max-resolution-preference-item__OIo2v\",\"maxResolutionPreferenceItem\":\"preferences-screen__max-resolution-preference-item__OIo2v\",\"preferences-panel\":\"preferences-screen__preferences-panel__POWVM\",\"preferencesPanel\":\"preferences-screen__preferences-panel__POWVM\",\"refresh-now-button\":\"preferences-screen__refresh-now-button__ZxJGS\",\"refreshNowButton\":\"preferences-screen__refresh-now-button__ZxJGS\",\"reset-to-default-button\":\"preferences-screen__reset-to-default-button__MuW_X\",\"resetToDefaultButton\":\"preferences-screen__reset-to-default-button__MuW_X\",\"close-button\":\"preferences-screen__close-button__WOdhQ\",\"closeButton\":\"preferences-screen__close-button__WOdhQ\",\"no-default-button-style\":\"preferences-screen__no-default-button-style__LQMg7\",\"noDefaultButtonStyle\":\"preferences-screen__no-default-button-style__LQMg7\",\"nav-container\":\"preferences-screen__nav-container__JV3iZ\",\"navContainer\":\"preferences-screen__nav-container__JV3iZ\",\"nav\":\"preferences-screen__nav__KROCu\",\"selected\":\"preferences-screen__selected__cPwAz\",\"vertical\":\"preferences-screen__vertical__dX9ns\",\"horizontal\":\"preferences-screen__horizontal__r4r_J\",\"list-item\":\"preferences-screen__list-item__TotHO\",\"listItem\":\"preferences-screen__list-item__TotHO\",\"column\":\"preferences-screen__column__FGH5c\",\"row\":\"preferences-screen__row__kOhFR\",\"row-right\":\"preferences-screen__row-right__PIhoB\",\"rowRight\":\"preferences-screen__row-right__PIhoB\",\"row-center\":\"preferences-screen__row-center__uGrVH\",\"rowCenter\":\"preferences-screen__row-center__uGrVH\",\"warn-icon\":\"preferences-screen__warn-icon__Xbh58\",\"warnIcon\":\"preferences-screen__warn-icon__Xbh58\",\"warn-icon-placeholder\":\"preferences-screen__warn-icon-placeholder__rMpBA\",\"warnIconPlaceholder\":\"preferences-screen__warn-icon-placeholder__rMpBA\",\"control-with-default\":\"preferences-screen__control-with-default__k5ChU\",\"controlWithDefault\":\"preferences-screen__control-with-default__k5ChU\",\"toast\":\"preferences-screen__toast__l7Z5F\",\"reset-to-default-button-placeholder\":\"preferences-screen__reset-to-default-button-placeholder__zZzKp\",\"resetToDefaultButtonPlaceholder\":\"preferences-screen__reset-to-default-button-placeholder__zZzKp\",\"flex\":\"preferences-screen__flex__YLsBQ\",\"icon\":\"preferences-screen__icon__IUXoU\",\"content-container\":\"preferences-screen__content-container__ab7sK\",\"contentContainer\":\"preferences-screen__content-container__ab7sK\",\"scrolling-content\":\"preferences-screen__scrolling-content__QX5E3\",\"scrollingContent\":\"preferences-screen__scrolling-content__QX5E3\",\"checkbox-placeholder\":\"preferences-screen__checkbox-placeholder__txAun\",\"checkboxPlaceholder\":\"preferences-screen__checkbox-placeholder__txAun\",\"section\":\"preferences-screen__section__EydJA\",\"dropdown-arrow\":\"preferences-screen__dropdown-arrow__ot2ZP\",\"dropdownArrow\":\"preferences-screen__dropdown-arrow__ot2ZP\",\"number-with-range\":\"preferences-screen__number-with-range__zjW7r\",\"numberWithRange\":\"preferences-screen__number-with-range__zjW7r\",\"number-in-number-with-range\":\"preferences-screen__number-in-number-with-range__j8wRT\",\"numberInNumberWithRange\":\"preferences-screen__number-in-number-with-range__j8wRT\"};","import { EventEmitter } from \"eventemitter3\";\nimport { MediaDevicesEvents, PermissionStatus, MediaDevices, NO_DEVICE_ID } from \"./media-devices-utils\";\nimport { detectOS, detect } from \"detect-browser\";\nimport { isIOS as detectIOS } from \"./is-mobile\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isIOS = detectIOS();\n\n// This is a list of regexes that match the microphone labels of HMDs.\n//\n// If entering VR mode, and if any of these regexes match an audio device,\n// the user will be prevented from entering VR until one of those devices is\n// selected as the microphone.\n//\n// Note that this doesn't have to be exhaustive: if no devices match any regex\n// then we rely upon the user to select the proper mic.\nconst HMD_MIC_REGEXES = [/\\Wvive\\W/i, /\\Wrift\\W/i];\n\nconst audioOutputSelectEnabled = \"sinkId\" in HTMLMediaElement.prototype;\n\n// Subsequest calls to getUserMedia throw an exception and return a muted track so we disable mic selection for the moment.\n// Safari 15+\nconst detectedOS = detectOS(navigator.userAgent);\nconst browser = detect();\nconst audioInputSelectEnabled = !([\"iOS\", \"Mac OS\"].includes(detectedOS) && [\"safari\", \"ios\"].includes(browser.name));\n\nexport default class MediaDevicesManager extends EventEmitter {\n  constructor(scene, store, audioSystem) {\n    super();\n\n    this._scene = scene;\n    this._store = store;\n    this._micDevices = [];\n    this._videoDevices = [];\n    this._outputDevices = [];\n    this._deviceId = null;\n    this._audioTrack = null;\n    this.audioSystem = audioSystem;\n    this._mediaStream = audioSystem.outboundStream;\n    this._permissionsStatus = {\n      [MediaDevices.MICROPHONE]: PermissionStatus.PROMPT,\n      [MediaDevices.SPEAKERS]: PermissionStatus.PROMPT,\n      [MediaDevices.CAMERA]: PermissionStatus.PROMPT,\n      [MediaDevices.SCREEN]: PermissionStatus.PROMPT\n    };\n\n    this.onDeviceChange = this.onDeviceChange.bind(this);\n    navigator.mediaDevices.addEventListener(\"devicechange\", this.onDeviceChange);\n  }\n\n  static get isAudioOutputSelectEnabled() {\n    return audioOutputSelectEnabled;\n  }\n\n  static get isAudioInputSelectEnabled() {\n    return audioInputSelectEnabled;\n  }\n\n  get deviceId() {\n    return this._deviceId;\n  }\n\n  set deviceId(deviceId) {\n    this._deviceId = deviceId;\n  }\n\n  get audioTrack() {\n    return this._audioTrack;\n  }\n\n  set audioTrack(audioTrack) {\n    this._audioTrack = audioTrack;\n  }\n\n  get defaultInputDeviceId() {\n    return this._micDevices.length > 0 ? this._micDevices[0].value : NO_DEVICE_ID;\n  }\n\n  get defaultOutputDeviceId() {\n    return this._outputDevices.length > 0 ? this._outputDevices[0].value : NO_DEVICE_ID;\n  }\n\n  get defaultVideoDeviceId() {\n    return this._videoDevices.length > 0 ? this._videoDevices[0].value : NO_DEVICE_ID;\n  }\n\n  get micDevicesOptions() {\n    return this._micDevices.length > 0 ? this._micDevices : [{ value: NO_DEVICE_ID, label: \"None\" }];\n  }\n\n  get videoDevicesOptions() {\n    return this._videoDevices.length > 0 ? this._videoDevices : [{ value: NO_DEVICE_ID, label: \"None\" }];\n  }\n\n  get outputDevicesOptions() {\n    return this._outputDevices.length > 0 ? this._outputDevices : [{ value: NO_DEVICE_ID, label: \"None\" }];\n  }\n\n  get mediaStream() {\n    return this._mediaStream;\n  }\n\n  set mediaStream(mediaStream) {\n    this._mediaStream = mediaStream;\n  }\n\n  get selectedMicLabel() {\n    return this.micLabelForAudioTrack(this.audioTrack);\n  }\n\n  get selectedMicDeviceId() {\n    return MediaDevicesManager.isAudioInputSelectEnabled &&\n      this._permissionsStatus[MediaDevices.MICROPHONE] !== PermissionStatus.GRANTED\n      ? NO_DEVICE_ID\n      : this.deviceIdForMicDeviceLabel(this.selectedMicLabel);\n  }\n\n  get selectedSpeakersDeviceId() {\n    const { preferredSpeakers } = this._store.state.preferences;\n    const exists = this._outputDevices.some(device => {\n      return device.value === preferredSpeakers;\n    });\n    return exists ? preferredSpeakers : this.defaultOutputDeviceId;\n  }\n\n  get isMicShared() {\n    return this.audioTrack !== null && this.getPermissionsStatus(MediaDevices.MICROPHONE) === PermissionStatus.GRANTED;\n  }\n\n  get isVideoShared() {\n    return this._mediaStream?.getVideoTracks().length > 0;\n  }\n\n  get isWebcamShared() {\n    return this._mediaStream.getVideoTracks().some(track => {\n      track[\"_hubs_contentHint\"] === MediaDevices.CAMERA;\n    });\n  }\n\n  get isScreenShared() {\n    return this._mediaStream.getVideoTracks().some(track => {\n      track[\"_hubs_contentHint\"] === MediaDevices.SCREEN;\n    });\n  }\n\n  set micEnabled(enabled) {\n    APP.dialog.enableMicrophone(enabled);\n  }\n\n  get isMicEnabled() {\n    return APP.dialog.isMicEnabled;\n  }\n\n  toggleMic() {\n    APP.dialog.toggleMicrophone();\n  }\n\n  getPermissionsStatus(type) {\n    return this._permissionsStatus[type];\n  }\n\n  onDeviceChange = () => {\n    this.fetchMediaDevices().then(() => {\n      this.changeAudioOutput(this.selectedSpeakersDeviceId);\n      this.emit(MediaDevicesEvents.DEVICE_CHANGE, null);\n    });\n  };\n\n  updatePermissions() {\n    const micStatus = this._micDevices.length === 0 ? PermissionStatus.PROMPT : PermissionStatus.GRANTED;\n    this._permissionsStatus[MediaDevices.MICROPHONE] = micStatus;\n    this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n      mediaDevice: MediaDevices.MICROPHONE,\n      status: micStatus\n    });\n    const videoStatus = this._videoDevices.length === 0 ? PermissionStatus.PROMPT : PermissionStatus.GRANTED;\n    this._permissionsStatus[MediaDevices.CAMERA] = videoStatus;\n    this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n      mediaDevice: MediaDevices.CAMERA,\n      status: videoStatus\n    });\n    const speakersStatus = this._micDevices.length === 0 ? PermissionStatus.PROMPT : PermissionStatus.GRANTED;\n    this._permissionsStatus[MediaDevices.SPEAKERS] = speakersStatus;\n    this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n      mediaDevice: MediaDevices.SPEAKERS,\n      status: speakersStatus\n    });\n  }\n\n  async fetchMediaDevices() {\n    console.log(\"Fetching media devices\");\n    return new Promise(resolve => {\n      navigator.mediaDevices.enumerateDevices().then(mediaDevices => {\n        mediaDevices = mediaDevices.filter(d => d.label !== \"\");\n        this._micDevices = mediaDevices\n          .filter(d => d.deviceId !== \"default\" && d.kind === \"audioinput\")\n          .map(d => ({ value: d.deviceId, label: d.label || `Mic Device (${d.deviceId.substring(0, 9)})` }));\n        this._videoDevices = mediaDevices\n          .filter(d => d.deviceId !== \"default\" && d.kind === \"videoinput\")\n          .map(d => ({ value: d.deviceId, label: d.label || `Camera Device (${d.deviceId.substring(0, 9)})` }));\n        if (MediaDevicesManager.isAudioOutputSelectEnabled) {\n          this._outputDevices = mediaDevices\n            .filter(d => d.deviceId !== \"default\" && d.kind === \"audiooutput\")\n            .map(d => ({ value: d.deviceId, label: d.label || `Audio Output (${d.deviceId.substring(0, 9)})` }));\n        }\n        this.updatePermissions();\n        resolve();\n      });\n    });\n  }\n\n  changeAudioOutput(deviceId) {\n    this._store.update({ preferences: { preferredSpeakers: deviceId } });\n  }\n\n  async startMicShare({ deviceId, unmute, updatePrefs = true }) {\n    if (this.isMicShared && this.selectedMicDeviceId === deviceId) return;\n    console.log(\"Starting microphone sharing\");\n\n    if (!deviceId) {\n      const { preferredMic } = this._store.state.preferences;\n      deviceId = preferredMic !== NO_DEVICE_ID ? preferredMic : undefined;\n    }\n    let constraints = { audio: {} };\n    if (deviceId) {\n      constraints = { audio: { deviceId: { ideal: [deviceId] } } };\n    }\n\n    const result = await this._startMicShare(constraints);\n\n    await this.fetchMediaDevices();\n\n    // we should definitely have an audioTrack at this point unless they denied mic access\n    if (this.audioTrack) {\n      const micDeviceId = this.deviceIdForMicDeviceLabel(this.micLabelForAudioTrack(this.audioTrack));\n      if (micDeviceId) {\n        if (updatePrefs) {\n          this._store.update({\n            preferences: {\n              preferredMic: micDeviceId,\n              preferredSpeakers: this.selectedSpeakersDeviceId\n            }\n          });\n        }\n        console.log(`Selected input device: ${this.micLabelForDeviceId(micDeviceId)}`);\n      }\n    } else {\n      console.log(\"No available audio tracks\");\n    }\n\n    await APP.dialog.setLocalMediaStream(this._mediaStream);\n\n    if (unmute) {\n      APP.dialog.enableMicrophone(true);\n    }\n\n    if (result) {\n      this._permissionsStatus[MediaDevices.MICROPHONE] = PermissionStatus.GRANTED;\n      this._scene.emit(MediaDevicesEvents.MIC_SHARE_STARTED);\n      this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n        mediaDevice: MediaDevices.MICROPHONE,\n        status: PermissionStatus.GRANTED\n      });\n    } else {\n      this._permissionsStatus[MediaDevices.MICROPHONE] = PermissionStatus.DENIED;\n      this._scene.emit(MediaDevicesEvents.MIC_SHARE_ENDED);\n      this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, {\n        mediaDevice: MediaDevices.MICROPHONE,\n        status: PermissionStatus.DENIED\n      });\n    }\n\n    return result;\n  }\n\n  async _startMicShare(constraints = { audio: {} }) {\n    if (this.audioTrack) {\n      this.audioTrack.stop();\n    }\n\n    constraints.audio.echoCancellation = !this._store.state.preferences.disableEchoCancellation;\n    constraints.audio.noiseSuppression = !this._store.state.preferences.disableNoiseSuppression;\n    constraints.audio.autoGainControl = !this._store.state.preferences.disableAutoGainControl;\n\n    try {\n      console.log(\"Adding microphone media stream\");\n      const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n      this.audioSystem.addStreamToOutboundAudio(\"microphone\", newStream);\n      this.audioTrack = newStream.getAudioTracks()[0];\n      this.audioTrack.addEventListener(\"ended\", async () => {\n        this._scene.emit(MediaDevicesEvents.MIC_SHARE_ENDED);\n        this.startMicShare({ unmute: this.isMicEnabled });\n      });\n\n      if (/Oculus/.test(navigator.userAgent)) {\n        // HACK Oculus Browser 6 seems to randomly end the microphone audio stream. This re-creates it.\n        // Note the ended event will only fire if some external event ends the stream, not if we call stop().\n        const recreateAudioStream = async () => {\n          console.warn(\n            \"Oculus Browser 6 bug hit: Audio stream track ended without calling stop. Recreating audio stream.\"\n          );\n\n          const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n          this.audioTrack = newStream.getAudioTracks()[0];\n\n          this.audioSystem.addStreamToOutboundAudio(\"microphone\", newStream);\n\n          this._scene.emit(MediaDevicesEvents.MIC_SHARE_STARTED);\n\n          this.audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n        };\n\n        this.audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n      }\n\n      return true;\n    } catch (e) {\n      // Error fetching audio track, most likely a permission denial.\n      console.error(\"Error during getUserMedia: \", e);\n      this.audioTrack = null;\n      return false;\n    }\n  }\n\n  async stopMicShare() {\n    this.audioSystem.removeStreamFromOutboundAudio(\"microphone\");\n\n    this.audioTrack?.stop();\n    this.audioTrack = null;\n\n    await APP.dialog.setLocalMediaStream(this._mediaStream);\n    APP.dialog.enableMicrophone(false);\n  }\n\n  async startVideoShare({ isDisplayMedia, target, success, error }) {\n    let newStream;\n    let videoTrackAdded = false;\n\n    try {\n      if (isDisplayMedia) {\n        newStream = await navigator.mediaDevices.getDisplayMedia({\n          video: {\n            // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n            // other than your current monitor that has a different aspect ratio.\n            width: 720 * (screen.width / screen.height),\n            height: 720,\n            frameRate: 30\n          },\n          audio: {\n            echoCancellation: window.APP.store.state.preferences.disableEchoCancellation === true ? false : true,\n            noiseSuppression: window.APP.store.state.preferences.disableNoiseSuppression === true ? false : true,\n            autoGainControl: window.APP.store.state.preferences.disableAutoGainControl === true ? false : true\n          }\n        });\n      } else {\n        newStream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: isIOS ? { max: 1280 } : { max: 1280, ideal: 720 },\n            frameRate: 30\n          }\n          //TODO: Capture audio from camera?\n        });\n      }\n\n      const videoTracks = newStream ? newStream.getVideoTracks() : [];\n      if (videoTracks.length > 0) {\n        videoTrackAdded = true;\n\n        newStream.getVideoTracks().forEach(track => {\n          // Ideally we would use track.contentHint but it seems to be read-only in Chrome so we just add a custom property\n          track[\"_hubs_contentHint\"] = isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA;\n          track.addEventListener(\"ended\", async () => {\n            this._scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n          });\n          this._mediaStream.addTrack(track);\n        });\n\n        if (newStream && newStream.getAudioTracks().length > 0) {\n          this.audioSystem.addStreamToOutboundAudio(\"screenshare\", newStream);\n        }\n\n        await APP.dialog.setLocalMediaStream(this._mediaStream);\n\n        const mediaDevice = isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA;\n        this._permissionsStatus[mediaDevice] = PermissionStatus.GRANTED;\n        this._scene.emit(MediaDevicesEvents.VIDEO_SHARE_STARTED);\n        this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, { mediaDevice, status: PermissionStatus.GRANTED });\n      }\n    } catch (e) {\n      error(e);\n      const mediaDevice = isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA;\n      this._permissionsStatus[mediaDevice] = PermissionStatus.DENIED;\n      this._scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      this.emit(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, { mediaDevice, status: PermissionStatus.DENIED });\n      return;\n    }\n\n    success(isDisplayMedia, videoTrackAdded, target);\n  }\n\n  async stopVideoShare() {\n    if (!this._mediaStream) return;\n\n    for (const track of this._mediaStream.getVideoTracks()) {\n      track.stop(); // Stop video track to remove the \"Stop screen sharing\" bar right away.\n      this._mediaStream.removeTrack(track);\n    }\n\n    this.audioSystem.removeStreamFromOutboundAudio(\"screenshare\");\n\n    await APP.dialog.setLocalMediaStream(this._mediaStream);\n  }\n\n  async shouldShowHmdMicWarning() {\n    if (isMobile || AFRAME.utils.device.isMobileVR()) return false;\n    if (!this.state.enterInVR) return false;\n    if (!this.hasHmdMicrophone()) return false;\n\n    return !HMD_MIC_REGEXES.find(r => this.selectedMicLabel.match(r));\n  }\n\n  micLabelForAudioTrack(audioTrack) {\n    const label = (audioTrack && audioTrack.label) || \"\";\n    if (label.indexOf(\"Default - \") < 0) {\n      return label;\n    } else {\n      return label.substring(10);\n    }\n  }\n\n  deviceIdForMicDeviceLabel(label) {\n    return this._micDevices.filter(d => d.label === label).map(d => d.value)[0] || this.defaultInputDeviceId;\n  }\n\n  deviceIdForSpeakersDeviceLabel(label) {\n    return this._outputDevices.filter(d => d.label === label).map(d => d.value)[0] || this.defaultOutputDeviceId;\n  }\n\n  micLabelForDeviceId(deviceId) {\n    return this._micDevices.filter(d => d.value === deviceId).map(d => d.label)[0];\n  }\n\n  speakersLabelForDeviceId(deviceId) {\n    return this._outputDevices.filter(d => d.value === deviceId).map(d => d.label)[0];\n  }\n\n  hasHmdMicrophone() {\n    return !!this.state._micDevices.find(d => HMD_MIC_REGEXES.find(r => d.label.match(r)));\n  }\n\n  videoDeviceIdForMicLabel(label) {\n    return this._videoDevices.filter(d => d.label === label).map(d => d.value)[0];\n  }\n\n  videoLabelForDeviceId(deviceId) {\n    return this._videoDevices.filter(d => d.value === deviceId).map(d => d.label)[0];\n  }\n}\n","import React, { memo, useRef, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Slider.scss\";\n\nfunction getLinearGradientCSS(ratio, leftColor, rightColor) {\n  return [\n    \"-webkit-gradient(\",\n    \"linear, \",\n    \"left top, \",\n    \"right top, \",\n    \"color-stop(\" + ratio + \", \" + leftColor + \"), \",\n    \"color-stop(\" + ratio + \", \" + rightColor + \")\",\n    \")\"\n  ].join(\"\");\n}\n\nfunction updateGradient(el, min, max) {\n  if (el) {\n    const ratio = ((parseFloat(el.value) - min) / (max - min)).toFixed(2);\n    el.style.backgroundImage = getLinearGradientCSS(ratio, styles.trackColor, \"transparent\");\n  }\n}\n\nexport const Slider = memo(({ min, max, step, value, onChange, disabled, className, ...rest }) => {\n  const inputRef = useRef();\n\n  useEffect(() => {\n    updateGradient(inputRef.current, min, max);\n  });\n\n  return (\n    <div className={classNames(styles.numberWithRange, className)}>\n      <div className={classNames(styles.rangeSlider)} disabled={disabled}>\n        <input\n          ref={inputRef}\n          type=\"range\"\n          step={step}\n          min={min}\n          max={max}\n          value={value}\n          disabled={disabled}\n          onChange={e => {\n            value === undefined && updateGradient(inputRef.current, min, max);\n            if (onChange) {\n              onChange(parseFloat(e.target.value));\n            }\n          }}\n          {...rest}\n        />\n      </div>\n    </div>\n  );\n});\n\nSlider.propTypes = {\n  min: PropTypes.number,\n  max: PropTypes.number,\n  step: PropTypes.number,\n  value: PropTypes.number,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  className: PropTypes.string\n};\n\nSlider.defaultProps = {\n  min: 0,\n  max: 100,\n  step: 1,\n  disabled: false\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"trackColor\":\"var(--primary-color)\",\"number-with-range\":\"Slider__number-with-range__juQDz\",\"numberWithRange\":\"Slider__number-with-range__juQDz\",\"range-slider\":\"Slider__range-slider__LYMXh\",\"rangeSlider\":\"Slider__range-slider__LYMXh\"};","// What this screen-orientation-utils does are\n// 1. Hide the screen orientation API difference across browsers\n//    ScreenOrientation API should be used but Safari doesn't support it yet.\n//    Instead deprecated window.orientation and orientationchange event\n//    need to be used on Safari for now.\n// 2. Manage maxResolution preferences values based on the screen orientation\n\nimport { isIOS as detectIOS } from \"./is-mobile\";\n\nconst isIOS = detectIOS();\n\nexport const addOrientationChangeListener = (callback, useCapture = false) => {\n  if (typeof ScreenOrientation !== \"undefined\") {\n    screen.orientation.addEventListener(\"change\", callback, useCapture);\n  } else {\n    window.addEventListener(\"orientationchange\", callback, useCapture);\n  }\n};\n\nexport const removeOrientationChangeListener = (callback, useCapture = false) => {\n  if (typeof ScreenOrientation !== \"undefined\") {\n    screen.orientation.removeEventListener(\"change\", callback, useCapture);\n  } else {\n    window.removeEventListener(\"orientationchange\", callback, useCapture);\n  }\n};\n\nconst getAngle = () => {\n  return typeof ScreenOrientation !== \"undefined\" ? screen.orientation.angle : window.orientation;\n};\n\nconst isNaturalOrientation = () => {\n  return getAngle() % 180 === 0;\n};\n\n// Return the screen width in CSS pixels based on the current screen orientation\nconst getScreenWidth = () => {\n  // Is seems screen.width value is based on the natural screen orientation on iOS\n  // while it is based on the current screen orientation on Android (and other devices?).\n  if (isIOS) {\n    return isNaturalOrientation() ? screen.width : screen.height;\n  }\n  return screen.width;\n};\n\n// Return the screen height in CSS pixels based on the current screen orientation\nconst getScreenHeight = () => {\n  // Is seems screen.height value is based on the natural screen orientation on iOS\n  // while it is based on the current screen orientation on Android (and other devices?).\n  if (isIOS) {\n    return isNaturalOrientation() ? screen.height : screen.width;\n  }\n  return screen.height;\n};\n\n// Physical pixels screen resolution width\n// (screen.width * window.devicePixelRatio) seems to be too huge and\n// can cause bad performance impact. So use CSS pixels screen width\n// (screen.width) by default for now.\nconst getDefaultMaxResolutionWidth = () => {\n  return getScreenWidth();\n};\n\n// See the comment above\nconst getDefaultMaxResolutionHeight = () => {\n  return getScreenHeight();\n};\n\n// Return the screen resolution width in physical pixels based on the current screen orientation\nexport const getScreenResolutionWidth = () => {\n  return getScreenWidth() * window.devicePixelRatio;\n};\n\n// Return the screen resolution height in physical pixels based on the current screen orientation\nexport const getScreenResolutionHeight = () => {\n  return getScreenHeight() * window.devicePixelRatio;\n};\n\n// Take width and height based on the current screen orientation and\n// store them based on natural orientation.\n// Width and height paremeters must be in physical pixels.\nexport const setMaxResolution = (store, width, height) => {\n  store.update({\n    preferences: {\n      maxResolutionWidth: isNaturalOrientation() ? width : height,\n      maxResolutionHeight: isNaturalOrientation() ? height : width\n    }\n  });\n};\n\n// Return max resolution width in physical pixels\n// based on the current screen orientation\nexport const getMaxResolutionWidth = store => {\n  const preferences = store.state.preferences;\n  const width = isNaturalOrientation() ? preferences.maxResolutionWidth : preferences.maxResolutionHeight;\n  return width !== undefined ? width : getDefaultMaxResolutionWidth();\n};\n\n// Return max resolution height in physical pixels\n// based on the current screen orientation\nexport const getMaxResolutionHeight = store => {\n  const preferences = store.state.preferences;\n  const height = isNaturalOrientation() ? preferences.maxResolutionHeight : preferences.maxResolutionWidth;\n  return height !== undefined ? height : getDefaultMaxResolutionHeight();\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faUndo } from \"@fortawesome/free-solid-svg-icons/faUndo\";\nimport { faExclamationTriangle } from \"@fortawesome/free-solid-svg-icons/faExclamationTriangle\";\nimport { FormattedMessage, injectIntl, useIntl, defineMessages } from \"react-intl\";\nimport styles from \"../assets/stylesheets/preferences-screen.scss\";\nimport { AVAILABLE_LOCALES } from \"../assets/locales/locale_config\";\nimport { themes } from \"./styles/theme\";\nimport MediaDevicesManager from \"../utils/media-devices-manager\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\nimport { Slider } from \"./input/Slider\";\nimport {\n  addOrientationChangeListener,\n  removeOrientationChangeListener,\n  getMaxResolutionWidth,\n  getMaxResolutionHeight,\n  getScreenResolutionWidth,\n  getScreenResolutionHeight,\n  setMaxResolution\n} from \"../utils/screen-orientation-utils\";\n\nexport const CLIPPING_THRESHOLD_MIN = 0.0;\nexport const CLIPPING_THRESHOLD_MAX = 0.1;\nexport const CLIPPING_THRESHOLD_STEP = 0.001;\nexport const GLOBAL_VOLUME_MIN = 0;\nexport const GLOBAL_VOLUME_MAX = 200;\nexport const GLOBAL_VOLUME_STEP = 5;\n\nfunction WarnIcon() {\n  return (\n    <i className={styles.flex}>\n      <FontAwesomeIcon className={styles.warnIcon} icon={faExclamationTriangle} />\n    </i>\n  );\n}\n\nfunction ResetToDefaultButton({ onClick }) {\n  const intl = useIntl();\n  const title = intl.formatMessage({\n    id: \"preferences-screen.reset-to-default\",\n    defaultMessage: \"Reset preference to default\"\n  });\n\n  return (\n    <button className={styles.noDefaultButtonStyle} title={title} aria-label={title} onClick={onClick}>\n      <i className={styles.flex}>\n        <FontAwesomeIcon className={classNames(styles.resetToDefaultButton)} icon={faUndo} />\n      </i>\n    </button>\n  );\n}\nResetToDefaultButton.propTypes = {\n  onClick: PropTypes.func\n};\nfunction ResetToDefaultButtonPlaceholder() {\n  return <div className={styles.resetToDefaultButtonPlaceholder} />;\n}\n\nfunction sanitize(s) {\n  s = s.replace(/[^0-9.]/g, \"\");\n  const split = s.split(\".\");\n  if (split.length > 1) {\n    return `${split.shift()}.${split.join(\"\")}`;\n  } else {\n    return s;\n  }\n}\nfunction countDigits(s) {\n  const split = s.split(\".\"); // Assume input is sanitized.\n  return (split.length > 1 && split[1].length) || 0;\n}\n\nexport class NumberRangeSelector extends Component {\n  // TODO: Simplify this component.\n  //       This component got a bit complicated when I tried to make sure that the number of digits\n  //       shown to the user was correct in all cases. The cases I have in mind are:\n  //         - User drags slider. Should use step and digits props.\n  //         - User clicks \"reset to default\" button. Should use step and digits props again.\n  //         - User enters text in the text box. Should display however many digits they type. (Maybe it shouldn't?)\n  //       We also take into account the difference between stored value and displayed value. The display string\n  //       may not match the stored value due to rounding-when-presenting or when nothing is stored (and the default value is displayed).\n  static propTypes = {\n    min: PropTypes.number,\n    max: PropTypes.number,\n    step: PropTypes.number,\n    digits: PropTypes.number,\n    store: PropTypes.object,\n    storeKey: PropTypes.string,\n    setValue: PropTypes.func\n  };\n  state = {\n    isFocused: false,\n    displayValue: \"\",\n    digitsFromUser: 0\n  };\n  constructor(props) {\n    super(props);\n    this.storeUpdated = this.storeUpdated.bind(this);\n  }\n\n  storeUpdated() {\n    if (!this.state.isFocused) {\n      const digits = Math.max(this.state.digitsFromUser, this.props.digits);\n      this.setState({ displayValue: this.props.store.state.preferences[this.props.storeKey].toFixed(digits) });\n    }\n    this.forceUpdate();\n  }\n\n  componentDidMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.setState({ displayValue: this.props.store.state.preferences[this.props.storeKey].toFixed(this.props.digits) });\n  }\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n  }\n\n  render() {\n    return (\n      <div className={classNames(styles.numberWithRange)}>\n        <div className={classNames(styles.numberInNumberWithRange)}>\n          <input\n            type=\"text\"\n            value={this.state.displayValue}\n            onClick={e => {\n              e.target.focus();\n              e.target.select();\n            }}\n            onBlur={e => {\n              const sanitizedInput = sanitize(e.target.value);\n              const numberOrReset = isNaN(parseFloat(sanitizedInput)) ? undefined : parseFloat(sanitizedInput);\n              this.setState({\n                displayValue:\n                  numberOrReset === undefined\n                    ? this.props.store.state.preferences[this.props.storeKey].toFixed(this.props.digits)\n                    : Math.min(Math.max(this.props.min, numberOrReset), this.props.max).toFixed(this.props.digits),\n                isFocused: false\n              });\n            }}\n            onFocus={() => {\n              this.setState({ isFocused: true });\n            }}\n            onChange={e => {\n              const sanitizedInput = sanitize(e.target.value);\n              const numberOrReset = isNaN(parseFloat(sanitizedInput)) ? undefined : parseFloat(sanitizedInput);\n              const finalValue = Math.min(Math.max(this.props.min, numberOrReset), this.props.max);\n              this.setState({\n                displayValue: numberOrReset === undefined ? \"\" : finalValue,\n                digitsFromUser: countDigits(sanitizedInput)\n              });\n              this.props.setValue(\n                numberOrReset === undefined\n                  ? parseFloat(this.props.store.state.preferences[this.props.storeKey])\n                  : finalValue\n              );\n            }}\n          />\n        </div>\n        <Slider\n          step={this.props.step}\n          min={this.props.min}\n          max={this.props.max}\n          value={this.props.store.state.preferences[this.props.storeKey]}\n          onChange={value => {\n            const num = value.toFixed(this.props.digits);\n            this.setState({ displayValue: num, digitsFromUser: 0 });\n            this.props.setValue(parseFloat(num));\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nfunction CheckboxPlaceholder() {\n  return <div className={styles.checkboxPlaceholder} />;\n}\nfunction BooleanPreference({ store, storeKey, setValue }) {\n  const value = store.state.preferences[storeKey];\n  return (\n    <input\n      tabIndex=\"0\"\n      type=\"checkbox\"\n      checked={value}\n      onChange={() => {\n        setValue(!value);\n      }}\n    />\n  );\n}\nBooleanPreference.propTypes = {\n  store: PropTypes.object,\n  storeKey: PropTypes.string,\n  setValue: PropTypes.func\n};\n\nfunction MapCountPreference({ store, storeKey, defaultValue, text }) {\n  const storedPref = store.state.preferences[storeKey];\n  const value = storedPref ? Object.keys(storedPref).length : defaultValue;\n  return (\n    <span className={styles.preferenceLabel}>\n      {value} {text}\n    </span>\n  );\n}\nMapCountPreference.propTypes = {\n  store: PropTypes.object,\n  storeKey: PropTypes.string,\n  defaultValue: PropTypes.number,\n  text: PropTypes.string\n};\n\nclass Select extends React.Component {\n  static propTypes = {\n    children: PropTypes.node.isRequired,\n    value: PropTypes.string,\n    onChange: PropTypes.func\n  };\n\n  render() {\n    return (\n      <div className={styles.dropdown}>\n        <select value={this.props.value} tabIndex=\"0\" onChange={this.props.onChange}>\n          {this.props.children}\n        </select>\n        <img\n          className={styles.dropdownArrow}\n          src=\"../assets/images/dropdown_arrow.png\"\n          srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n        />\n      </div>\n    );\n  }\n}\n\nclass PreferenceSelect extends React.Component {\n  static propTypes = {\n    options: PropTypes.array,\n    store: PropTypes.object,\n    storeKey: PropTypes.string,\n    setValue: PropTypes.func,\n    onChanged: PropTypes.func\n  };\n  constructor() {\n    super();\n  }\n  render() {\n    const options = this.props.options.map(({ text, value }, i) => {\n      return (\n        <option key={`option_${this.props.storeKey}_${i}`} value={value}>\n          {text}\n        </option>\n      );\n    });\n    return (\n      <Select\n        value={this.props.store.state.preferences[this.props.storeKey]}\n        onChange={e => {\n          this.props.setValue(e.target.value);\n          this.props.onChanged && this.props.onChanged(e.target.value);\n        }}\n      >\n        {options}\n      </Select>\n    );\n  }\n}\n\nexport const PREFERENCE_LIST_ITEM_TYPE = {\n  CHECK_BOX: 1,\n  SELECT: 2,\n  NUMBER_WITH_RANGE: 3,\n  MAX_RESOLUTION: 4,\n  MAP_COUNT: 5\n};\n\nexport class MaxResolutionPreferenceItem extends Component {\n  static propTypes = {\n    store: PropTypes.object\n  };\n\n  onOrientationChange = () => {\n    // Width and height should be swapped on screen orientation change\n    // then need to update.\n    this.forceUpdate();\n  };\n\n  componentDidMount() {\n    addOrientationChangeListener(this.onOrientationChange);\n  }\n\n  componentWillUnmount() {\n    removeOrientationChangeListener(this.onOrientationChange);\n  }\n\n  render() {\n    const onChange = multiplier => {\n      setMaxResolution(\n        this.props.store,\n        Math.floor(getScreenResolutionWidth() * multiplier),\n        Math.floor(getScreenResolutionHeight() * multiplier)\n      );\n    };\n    return (\n      <div className={classNames(styles.maxResolutionPreferenceItem)}>\n        <input\n          tabIndex=\"0\"\n          type=\"number\"\n          step=\"1\"\n          min=\"0\"\n          value={getMaxResolutionWidth(this.props.store)}\n          readOnly={true}\n        />\n        &nbsp;{\"x\"}&nbsp;\n        <input\n          tabIndex=\"0\"\n          type=\"number\"\n          step=\"1\"\n          min=\"0\"\n          value={getMaxResolutionHeight(this.props.store)}\n          readOnly={true}\n        />\n        &nbsp;\n        <Slider\n          step={0.1}\n          min={0.1}\n          max={1.0}\n          value={getMaxResolutionWidth(this.props.store) / getScreenResolutionWidth()}\n          onChange={onChange}\n        />\n      </div>\n    );\n  }\n}\nfunction ListItem({ children, disabled, indent }) {\n  return <div className={classNames(styles.listItem, { disabled, indent })}>{children}</div>;\n}\nListItem.propTypes = {\n  children: PropTypes.node.isRequired,\n  disabled: PropTypes.bool,\n  indent: PropTypes.bool\n};\n\nconst preferenceLabels = defineMessages({\n  preferredCamera: {\n    id: \"preferences-screen.preference.preferred-camera\",\n    defaultMessage: \"Preferred camera\"\n  },\n  preferredMic: {\n    id: \"preferences-screen.preference.preferred-mic\",\n    defaultMessage: \"Preferred mic\"\n  },\n  preferredSpeakers: {\n    id: \"preferences-screen.preference.preferred-speakers\",\n    defaultMessage: \"Preferred speakers\"\n  },\n  globalVoiceVolume: {\n    id: \"preferences-screen.preference.global-voice-volume\",\n    defaultMessage: \"Incoming Voice Volume\"\n  },\n  globalMediaVolume: {\n    id: \"preferences-screen.preference.global-media-volume\",\n    defaultMessage: \"Media Volume\"\n  },\n  globalSFXVolume: {\n    id: \"preferences-screen.preference.global-sfx-volume\",\n    defaultMessage: \"SFX Volume\"\n  },\n  avatarVoiceLevels: {\n    id: \"preferences-screen.preference.avatar-volumes\",\n    defaultMessage: \"Stored avatar volumes\"\n  },\n  disableSoundEffects: {\n    id: \"preferences-screen.preference.disable-sound-effects\",\n    defaultMessage: \"Disable Sound Effects\"\n  },\n  disableEchoCancellation: {\n    id: \"preferences-screen.preference.disable-echo-cancellation\",\n    defaultMessage: \"Disable microphone echo cancellation\"\n  },\n  disableNoiseSuppression: {\n    id: \"preferences-screen.preference.disable-noise-suppression\",\n    defaultMessage: \"Disable microphone noise supression\"\n  },\n  disableAutoGainControl: {\n    id: \"preferences-screen.preference.disable-auto-gain-control\",\n    defaultMessage: \"Disable microphone automatic gain control\"\n  },\n  snapRotationDegrees: {\n    id: \"preferences-screen.preference.snap-rotation-degrees\",\n    defaultMessage: \"Rotation per snap (in degrees)\"\n  },\n  disableMovement: {\n    id: \"preferences-screen.preference.disable-movement\",\n    defaultMessage: \"Disable movement\"\n  },\n  disableBackwardsMovement: {\n    id: \"preferences-screen.preference.disable-backwards-movement\",\n    defaultMessage: \"Disable backwards movement\"\n  },\n  disableStrafing: {\n    id: \"preferences-screen.preference.disable-strafing\",\n    defaultMessage: \"Disable strafing\"\n  },\n  disableTeleporter: {\n    id: \"preferences-screen.preference.disable-teleporter\",\n    defaultMessage: \"Disable teleporter\"\n  },\n  movementSpeedModifier: {\n    id: \"preferences-screen.preference.movement-speed-modifier\",\n    defaultMessage: \"Movement speed modifier\"\n  },\n  enableOnScreenJoystickLeft: {\n    id: \"preferences-screen.preference.enable-on-screen-joystick-left\",\n    defaultMessage: \"Enable left on-screen joystick for moving around\"\n  },\n  enableOnScreenJoystickRight: {\n    id: \"preferences-screen.preference.enable-on-screen-joystick-right\",\n    defaultMessage: \"Enable right on-screen joystick for looking around\"\n  },\n  enableGyro: {\n    id: \"preferences-screen.preference.enable-gyro\",\n    defaultMessage: \"Enable gyroscope (when supported by browser/device)\"\n  },\n  invertTouchscreenCameraMove: {\n    id: \"preferences-screen.preference.invert-touchscreen-camera-move\",\n    defaultMessage: \"Invert direction of camera movement for touchscreens\"\n  },\n  locale: {\n    id: \"preferences-screen.preference.locale\",\n    defaultMessage: \"Language\"\n  },\n  animateWaypointTransitions: {\n    id: \"preferences-screen.preference.animate-waypoint-transitions\",\n    defaultMessage: \"Animate waypoint transitions\"\n  },\n  showFPSCounter: {\n    id: \"preferences-screen.preference.show-fps-counter\",\n    defaultMessage: \"Show FPS Counter\"\n  },\n  maxResolution: {\n    id: \"preferences-screen.preference.max-resolution\",\n    defaultMessage: \"Max Resolution\"\n  },\n  materialQualitySetting: {\n    id: \"preferences-screen.preference.material-quality-setting\",\n    defaultMessage: \"Material quality\"\n  },\n  enableDynamicShadows: {\n    id: \"preferences-screen.preference.enable-dynamic-shadows\",\n    defaultMessage: \"Enable Real-time Shadows\"\n  },\n  disableAutoPixelRatio: {\n    id: \"preferences-screen.preference.disable-auto-pixel-ratio\",\n    defaultMessage: \"Disable automatic pixel ratio adjustments\"\n  },\n  allowMultipleHubsInstances: {\n    id: \"preferences-screen.preference.allow-multiple-hubs-instances\",\n    defaultMessage: \"Disable auto-exit when multiple hubs instances are open\"\n  },\n  disableIdleDetection: {\n    id: \"preferences-screen.preference.disable-idle-detection\",\n    defaultMessage: \"Disable auto-exit when idle or backgrounded\"\n  },\n  preferMobileObjectInfoPanel: {\n    id: \"preferences-screen.preference.prefer-mobile-object-info-panel\",\n    defaultMessage: \"Prefer Mobile Object Info Panel\"\n  },\n  showRtcDebugPanel: {\n    id: \"preferences-screen.preference.show-rtc-debug-panel\",\n    defaultMessage: \"Show RTC Panel\"\n  },\n  showAudioDebugPanel: {\n    id: \"preferences-screen.preference.show-audio-debug-panel\",\n    defaultMessage: \"Show Audio Debug Panel\"\n  },\n  audioPanningQuality: {\n    id: \"preferences-screen.preference.audio-panning-quality\",\n    defaultMessage: \"Panning quality\"\n  },\n  enableAudioClipping: {\n    id: \"preferences-screen.preference.enable-audio-clipping\",\n    defaultMessage: \"Enable Audio Clipping\"\n  },\n  audioClippingThreshold: {\n    id: \"preferences-screen.preference.audio-clipping-threshold\",\n    defaultMessage: \"Audio Clipping Threshold\"\n  },\n  theme: {\n    id: \"preferences-screen.preference.theme\",\n    defaultMessage: \"Theme\"\n  },\n  fastRoomSwitching: {\n    id: \"preferences-screen.preference.fast-room-switching\",\n    defaultMessage: \"Enable Fast Room Switching\"\n  },\n  lazyLoadSceneMedia: {\n    id: \"preferences-screen.preference.lazy-load-scene-media\",\n    defaultMessage: \"Enable Scene Media Lazy Loading\"\n  },\n  disableLeftRightPanning: {\n    id: \"preferences-screen.preference.disable-panning\",\n    defaultMessage: \"Disable audio left/right panning\"\n  },\n  cursorSize: {\n    id: \"preferences-screen.preference.cursor-size\",\n    defaultMessage: \"Cursor Size\"\n  },\n  nametagVisibility: {\n    id: \"preferences-screen.preference.nametag-visibility\",\n    defaultMessage: \"Show Nametag\"\n  },\n  nametagVisibilityDistance: {\n    id: \"preferences-screen.preference.nametag-visibility-distance\",\n    defaultMessage: \"Nametag visibility distance\"\n  }\n});\n\nclass PreferenceListItem extends Component {\n  static propTypes = {\n    intl: PropTypes.object,\n    store: PropTypes.object,\n    storeKey: PropTypes.string,\n    setValue: PropTypes.func,\n    itemProps: PropTypes.object\n  };\n  componentDidMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    window.addEventListener(\"locale-updated\", this.storeUpdated);\n  }\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    window.removeEventListener(\"locale-updated\", this.storeUpdated);\n  }\n\n  storeUpdated = () => {\n    this.forceUpdate();\n  };\n\n  render() {\n    const intl = this.props.intl;\n    const isCheckbox = this.props.itemProps.prefType === PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX;\n    const isSmallScreen = window.innerWidth < 600;\n    const label = (\n      <span className={styles.preferenceLabel}>{intl.formatMessage(preferenceLabels[this.props.storeKey])}</span>\n    );\n    const prefSchema = this.props.store.schema.definitions.preferences.properties;\n    const hasPref =\n      this.props.itemProps.prefType === PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION\n        ? this.props.store.state.preferences.maxResolutionWidth !== undefined ||\n          this.props.store.state.preferences.maxResolutionHeight !== undefined\n        : this.props.store.state.preferences[this.props.storeKey] !== prefSchema[this.props.storeKey].default;\n    const resetToDefault = hasPref ? (\n      <ResetToDefaultButton\n        onClick={() => {\n          switch (this.props.itemProps.prefType) {\n            case PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION:\n              this.props.store.update({\n                preferences: {\n                  maxResolutionWidth: undefined,\n                  maxResolutionHeight: undefined\n                }\n              });\n              break;\n            default:\n              this.props.setValue(prefSchema[this.props.storeKey].default);\n              break;\n          }\n          this.forceUpdate();\n        }}\n      />\n    ) : (\n      <ResetToDefaultButtonPlaceholder />\n    );\n\n    const disabled =\n      (this.props.itemProps.disableIfTrue && this.props.store.state.preferences[this.props.itemProps.disableIfTrue]) ||\n      (this.props.itemProps.disableIfFalse && !this.props.store.state.preferences[this.props.itemProps.disableIfFalse]);\n    const indent = this.props.itemProps.disableIfTrue || this.props.itemProps.disableIfFalse;\n\n    if (isCheckbox) {\n      return (\n        <ListItem disabled={disabled} indent={indent}>\n          <div className={styles.row}>\n            <Control itemProps={this.props.itemProps} store={this.props.store} setValue={this.props.setValue} />\n            {label}\n            <div className={styles.rowRight}>{resetToDefault}</div>\n          </div>\n        </ListItem>\n      );\n    } else if (isSmallScreen) {\n      return (\n        <ListItem disabled={disabled} indent={indent}>\n          <div className={styles.column}>\n            <div className={styles.row}>\n              {<CheckboxPlaceholder />}\n              {label}\n            </div>\n            <div className={styles.row}>\n              <div className={styles.rowCenter}>\n                <Control itemProps={this.props.itemProps} store={this.props.store} setValue={this.props.setValue} />\n              </div>\n              <div className={styles.rowRight}>{resetToDefault}</div>\n            </div>\n          </div>\n        </ListItem>\n      );\n    }\n    return (\n      <ListItem disabled={disabled} indent={indent}>\n        <div className={styles.row}>\n          {<CheckboxPlaceholder />}\n          {label}\n          <div className={styles.rowRight}>\n            <Control itemProps={this.props.itemProps} store={this.props.store} setValue={this.props.setValue} />\n          </div>\n          <div className={styles.rowRight}>{resetToDefault}</div>\n        </div>\n      </ListItem>\n    );\n  }\n}\n\nconst IntlPreferenceListItem = injectIntl(PreferenceListItem);\n\nconst CATEGORY_AUDIO = 0;\nconst CATEGORY_CONTROLS = 1;\nconst CATEGORY_MISC = 2;\nconst CATEGORY_MOVEMENT = 3;\nconst CATEGORY_TOUCHSCREEN = 4;\nconst CATEGORY_ACCESSIBILITY = 5;\nconst TOP_LEVEL_CATEGORIES = [CATEGORY_AUDIO, CATEGORY_CONTROLS, CATEGORY_MISC];\nconst categoryNames = defineMessages({\n  [CATEGORY_AUDIO]: { id: \"preferences-screen.category.audio\", defaultMessage: \"Audio\" },\n  [CATEGORY_CONTROLS]: { id: \"preferences-screen.category.controls\", defaultMessage: \"Controls\" },\n  [CATEGORY_MISC]: { id: \"preferences-screen.category.misc\", defaultMessage: \"Misc\" },\n  [CATEGORY_MOVEMENT]: { id: \"preferences-screen.category.movement\", defaultMessage: \"Movement\" },\n  [CATEGORY_TOUCHSCREEN]: { id: \"preferences-screen.category.touchscreen\", defaultMessage: \"Touchscreen\" },\n  [CATEGORY_ACCESSIBILITY]: { id: \"preferences-screen.category.accessibility\", defaultMessage: \"Accessibility\" }\n});\n\nfunction NavItem({ ariaLabel, title, onClick, selected }) {\n  return (\n    <button\n      aria-label={ariaLabel}\n      className={classNames(styles.navItem, { [styles.selected]: selected })}\n      onClick={onClick}\n    >\n      {title}\n    </button>\n  );\n}\nNavItem.propTypes = {\n  ariaLabel: PropTypes.string,\n  title: PropTypes.string,\n  onClick: PropTypes.func,\n  selected: PropTypes.bool\n};\nfunction CloseButton({ onClick }) {\n  const intl = useIntl();\n  return (\n    <button\n      autoFocus\n      aria-label={intl.formatMessage({\n        id: \"preferences-screen.close-button\",\n        defaultMessage: \"Close Preferences Menu\"\n      })}\n      className={classNames(styles.closeButton)}\n      onClick={onClick}\n    >\n      <i className={styles.flex}>\n        <FontAwesomeIcon className={styles.icon} icon={faTimes} />\n      </i>\n    </button>\n  );\n}\nCloseButton.propTypes = {\n  onClick: PropTypes.func\n};\n\nconst controlType = new Map([\n  [PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, BooleanPreference],\n  [PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION, MaxResolutionPreferenceItem],\n  [PREFERENCE_LIST_ITEM_TYPE.SELECT, PreferenceSelect],\n  [PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE, NumberRangeSelector],\n  [PREFERENCE_LIST_ITEM_TYPE.MAP_COUNT, MapCountPreference]\n]);\n\nfunction Control({ itemProps, store, setValue }) {\n  const ControlType = controlType.get(itemProps.prefType);\n  return <ControlType {...{ store, storeKey: itemProps.key, setValue, ...itemProps }} />;\n}\nControl.propTypes = {\n  itemProps: PropTypes.object,\n  store: PropTypes.object,\n  setValue: PropTypes.func\n};\n\nfunction createItem(itemProps, store) {\n  const setValue = v => {\n    if (itemProps.promptForRefresh) {\n      store.update({ preferences: { [itemProps.key]: v, shouldPromptForRefresh: true } });\n    } else {\n      store.update({ preferences: { [itemProps.key]: v } });\n    }\n  };\n  return (\n    <IntlPreferenceListItem\n      key={itemProps.key}\n      itemProps={itemProps}\n      store={store}\n      storeKey={itemProps.key}\n      setValue={setValue}\n      onChanged={itemProps.onChanged}\n    />\n  );\n}\n\nfunction Section({ name, items }, i) {\n  return (\n    <div key={`section-${i}`} className={styles.section}>\n      {name && <div className={styles.sectionTitle}>{name}</div>}\n      {items}\n    </div>\n  );\n}\nSection.propTypes = {\n  name: PropTypes.string,\n  items: PropTypes.node.isRequired\n};\n\nclass Nav extends Component {\n  render() {\n    const { children } = this.props;\n    return (\n      <div className={styles.navContainer}>\n        <div className={classNames(styles.nav)}>{children}</div>\n      </div>\n    );\n  }\n}\nNav.propTypes = {\n  children: PropTypes.node.isRequired,\n  selected: PropTypes.number\n};\n\nclass RefreshPrompt extends React.Component {\n  static propTypes = {\n    reportHeight: PropTypes.func\n  };\n  constructor() {\n    super();\n    this.ref = React.createRef();\n  }\n  componentDidMount() {\n    this.props.reportHeight(window.getComputedStyle(this.ref.current).height);\n  }\n\n  render() {\n    return (\n      <div ref={this.ref} className={styles.toast}>\n        <div className={styles.row}>\n          <WarnIcon />\n          <div className={styles.refreshPrompt}>\n            <FormattedMessage\n              id=\"preferences-screen.prompt-for-refresh\"\n              defaultMessage=\"Your preferences are saved, but some of your changes will not take effect until you refresh the page.\"\n            />\n          </div>\n          <div className={styles.warnIconPlaceholder} />\n        </div>\n        <button\n          className={styles.refreshNowButton}\n          onClick={() => {\n            const href = location.href;\n            location.href = href;\n          }}\n        >\n          <FormattedMessage id=\"preferences-screen.refresh-now\" defaultMessage=\"Refresh Now\" />\n        </button>\n      </div>\n    );\n  }\n}\n\nclass PreferencesScreen extends Component {\n  static propTypes = {\n    intl: PropTypes.object,\n    onClose: PropTypes.func,\n    store: PropTypes.object,\n    scene: PropTypes.object\n  };\n\n  constructor() {\n    // TODO: When this component is recreated it clears its state.\n    // This happens several times as the page is loading.\n    // We should either avoid remounting or persist the category somewhere besides state.\n    super();\n\n    this.storeUpdated = this.storeUpdated.bind(this);\n\n    this.mediaDevicesManager = APP.mediaDevicesManager;\n\n    this.state = {\n      category: CATEGORY_AUDIO,\n      toastHeight: \"150px\",\n      preferredMic: {\n        key: \"preferredMic\",\n        prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n        options: [{ value: \"none\", text: \"None\" }]\n      },\n      preferredCamera: {\n        key: \"preferredCamera\",\n        prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n        options: [{ value: \"none\", text: \"None\" }]\n      },\n      ...(MediaDevicesManager.isAudioOutputSelectEnabled && {\n        preferredSpeakers: {\n          key: \"preferredSpeakers\",\n          prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n          options: [{ value: \"none\", text: \"None\" }]\n        }\n      })\n    };\n  }\n\n  onMediaDevicesUpdated = () => {\n    const currentSpeakers = this.mediaDevicesManager.selectedSpeakersDeviceId;\n    if (this.props.store.state.preferences.preferredSpeakers !== currentSpeakers) {\n      this.props.store.update({\n        preferences: { preferredSpeakers: currentSpeakers }\n      });\n    }\n    this.updateMediaDevices();\n  };\n\n  updateMediaDevices = () => {\n    // Audio devices update\n    const micOptions = this.mediaDevicesManager.micDevicesOptions.map(device => ({\n      value: device.value,\n      text: device.label\n    }));\n    const preferredMic = { ...this.state.preferredMic };\n    preferredMic.options = micOptions;\n\n    const speakersOptions = this.mediaDevicesManager.outputDevicesOptions.map(device => ({\n      value: device.value,\n      text: device.label\n    }));\n    const preferredSpeakers = { ...this.state.preferredSpeakers };\n    preferredSpeakers.options = speakersOptions?.length > 0 ? speakersOptions : [{ value: \"none\", text: \"None\" }];\n\n    // Video devices update\n    const videoOptions = this.mediaDevicesManager.videoDevicesOptions.map(device => ({\n      value: device.value,\n      text: device.label\n    }));\n    const preferredCamera = { ...this.state.preferredCamera };\n    preferredCamera.options = [\n      {\n        value: \"user\",\n        text: this.props.intl.formatMessage({\n          id: \"preferences-screen.preferred-camera.user-facing\",\n          defaultMessage: \"User-Facing\"\n        })\n      },\n      {\n        value: \"environment\",\n        text: this.props.intl.formatMessage({\n          id: \"preferences-screen.preferred-camera.environment\",\n          defaultMessage: \"Environment\"\n        })\n      },\n      {\n        value: \"default\",\n        text: this.props.intl.formatMessage({\n          id: \"preferences-screen.preferred-camera.default\",\n          defaultMessage: \"Default\"\n        })\n      }\n    ];\n    preferredCamera.options.push(...videoOptions);\n\n    // Update media devices state\n    this.setState({\n      preferredMic,\n      preferredSpeakers,\n      preferredCamera\n    });\n  };\n\n  componentDidMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.mediaDevicesManager.on(MediaDevicesEvents.DEVICE_CHANGE, this.onMediaDevicesUpdated);\n\n    this.mediaDevicesManager.fetchMediaDevices().then(this.updateMediaDevices);\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.mediaDevicesManager.off(MediaDevicesEvents.DEVICE_CHANGE, this.onMediaDevicesUpdated);\n  }\n\n  storeUpdated() {\n    const { preferredMic } = this.props.store.state.preferences;\n    if (preferredMic !== this.mediaDevicesManager.selectedMicDeviceId) {\n      this.mediaDevicesManager.startMicShare({ updatePrefs: false }).then(this.updateMediaDevices);\n    }\n  }\n\n  createSections() {\n    const intl = this.props.intl;\n\n    const browserDefault = intl.formatMessage({\n      id: \"preferences-screen.browser-default\",\n      defaultMessage: \"Browser Default\"\n    });\n\n    const availableLocales = [\n      {\n        value: \"browser\",\n        text: browserDefault\n      }\n    ];\n\n    for (const locale in AVAILABLE_LOCALES) {\n      availableLocales.push({ value: locale, text: AVAILABLE_LOCALES[locale] });\n    }\n\n    const availableThemes = [\n      {\n        value: null,\n        text: browserDefault\n      }\n    ];\n\n    for (const { id, name } of themes) {\n      availableThemes.push({\n        value: id,\n        text: name\n      });\n    }\n\n    const DEFINITIONS = new Map([\n      [\n        CATEGORY_TOUCHSCREEN,\n        [\n          {\n            key: \"enableOnScreenJoystickLeft\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"enableOnScreenJoystickRight\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"enableGyro\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"invertTouchscreenCameraMove\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          }\n        ]\n      ],\n      [\n        CATEGORY_MOVEMENT,\n        [\n          {\n            key: \"snapRotationDegrees\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 0,\n            max: 90,\n            step: 5,\n            digits: 0\n          },\n          {\n            key: \"disableMovement\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableBackwardsMovement\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableStrafing\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableTeleporter\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"movementSpeedModifier\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 0,\n            max: 2,\n            step: 0.1,\n            digits: 1\n          }\n        ]\n      ],\n      [\n        CATEGORY_AUDIO,\n        [\n          ...(MediaDevicesManager.isAudioInputSelectEnabled ? [this.state.preferredMic] : []),\n          ...(MediaDevicesManager.isAudioOutputSelectEnabled ? [this.state.preferredSpeakers] : []),\n          {\n            key: \"globalVoiceVolume\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: GLOBAL_VOLUME_MIN,\n            max: GLOBAL_VOLUME_MAX,\n            step: GLOBAL_VOLUME_STEP,\n            digits: 0\n          },\n          {\n            key: \"globalMediaVolume\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: GLOBAL_VOLUME_MIN,\n            max: GLOBAL_VOLUME_MAX,\n            step: GLOBAL_VOLUME_STEP,\n            digits: 0\n          },\n          {\n            key: \"globalSFXVolume\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 0,\n            max: 200,\n            step: 5,\n            digits: 0\n          },\n          {\n            key: \"avatarVoiceLevels\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.MAP_COUNT,\n            defaultValue: 0,\n            text: intl.formatMessage({\n              id: \"preferences-screen.preference.avatar-volumes.entries\",\n              defaultMessage: \"Entries\"\n            })\n          },\n          {\n            key: \"disableSoundEffects\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableEchoCancellation\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            promptForRefresh: true\n          },\n          {\n            key: \"disableNoiseSuppression\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            promptForRefresh: true\n          },\n          {\n            key: \"disableAutoGainControl\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            promptForRefresh: true\n          },\n          {\n            key: \"enableAudioClipping\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"audioClippingThreshold\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: CLIPPING_THRESHOLD_MIN,\n            max: CLIPPING_THRESHOLD_MAX,\n            step: CLIPPING_THRESHOLD_STEP,\n            digits: 3\n          },\n          {\n            key: \"showAudioDebugPanel\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"audioPanningQuality\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: [\n              {\n                value: \"High\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.audio-panning-quality.high\",\n                  defaultMessage: \"High\"\n                })\n              },\n              {\n                value: \"Low\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.audio-panning-quality.low\",\n                  defaultMessage: \"Low\"\n                })\n              }\n            ]\n          }\n        ]\n      ],\n      [\n        CATEGORY_MISC,\n        [\n          {\n            key: \"locale\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: availableLocales\n          },\n          {\n            key: \"theme\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: availableThemes\n          },\n          { key: \"maxResolution\", prefType: PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION },\n          {\n            key: \"nametagVisibility\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: [\n              {\n                value: \"showAll\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-all\",\n                  defaultMessage: \"Always\"\n                })\n              },\n              {\n                value: \"showNone\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-none\",\n                  defaultMessage: \"Never\"\n                })\n              },\n              {\n                value: \"showFrozen\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-frozen\",\n                  defaultMessage: \"Only in Frozen state\"\n                })\n              },\n              {\n                value: \"showSpeaking\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-speaking\",\n                  defaultMessage: \"Only speaking\"\n                })\n              },\n              {\n                value: \"showClose\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.nametag-visibility.show-close\",\n                  defaultMessage: \"Close to me\"\n                })\n              }\n            ]\n          },\n          {\n            key: \"nametagVisibilityDistance\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 1,\n            max: 20,\n            step: 1,\n            digits: 2\n          },\n          this.state.preferredCamera,\n          {\n            key: \"materialQualitySetting\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\n            options: [\n              {\n                value: \"low\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.material-quality-setting.low\",\n                  defaultMessage: \"Low\"\n                })\n              },\n              {\n                value: \"medium\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.material-quality-setting.medium\",\n                  defaultMessage: \"Medium\"\n                })\n              },\n              {\n                value: \"high\",\n                text: intl.formatMessage({\n                  id: \"preferences-screen.material-quality-setting.high\",\n                  defaultMessage: \"High\"\n                })\n              }\n            ],\n            promptForRefresh: true\n          },\n          {\n            key: \"enableDynamicShadows\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX,\n            defaultBool: false\n          },\n          {\n            key: \"disableAutoPixelRatio\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"allowMultipleHubsInstances\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"disableIdleDetection\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"fastRoomSwitching\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"lazyLoadSceneMedia\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"preferMobileObjectInfoPanel\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"animateWaypointTransitions\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"showFPSCounter\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"showRtcDebugPanel\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          },\n          {\n            key: \"cursorSize\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\n            min: 1,\n            max: 5,\n            step: 0.5,\n            digits: 1\n          }\n        ]\n      ],\n      [\n        CATEGORY_ACCESSIBILITY,\n        [\n          {\n            key: \"disableLeftRightPanning\",\n            prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX\n          }\n        ]\n      ]\n    ]);\n\n    const toItem = itemProps => createItem(itemProps, this.props.store);\n\n    const items = new Map();\n\n    for (const [category, definitions] of DEFINITIONS) {\n      items.set(category, definitions.map(toItem));\n    }\n\n    return new Map([\n      [\n        CATEGORY_AUDIO,\n        [\n          { items: items.get(CATEGORY_AUDIO) },\n          {\n            name: intl.formatMessage(categoryNames[CATEGORY_ACCESSIBILITY]),\n            items: items.get(CATEGORY_ACCESSIBILITY)\n          }\n        ]\n      ],\n      [\n        CATEGORY_CONTROLS,\n        [\n          {\n            name: intl.formatMessage(categoryNames[CATEGORY_MOVEMENT]),\n            items: items.get(CATEGORY_MOVEMENT)\n          },\n          {\n            name: intl.formatMessage(categoryNames[CATEGORY_TOUCHSCREEN]),\n            items: items.get(CATEGORY_TOUCHSCREEN)\n          }\n        ]\n      ],\n      [CATEGORY_MISC, [{ items: items.get(CATEGORY_MISC) }]]\n    ]);\n  }\n\n  render() {\n    const intl = this.props.intl;\n    const shouldPromptForRefresh = this.props.store.state.preferences.shouldPromptForRefresh;\n\n    return (\n      <div className={classNames(styles.preferencesPanel)}>\n        {shouldPromptForRefresh && (\n          <RefreshPrompt\n            reportHeight={toastHeight => {\n              this.setState({ toastHeight });\n            }}\n          />\n        )}\n        <CloseButton onClick={this.props.onClose} />\n        <Nav selected={this.state.category}>\n          {TOP_LEVEL_CATEGORIES.map(category => (\n            <NavItem\n              key={`category-${category}-header`}\n              title={intl.formatMessage(categoryNames[category])}\n              onClick={() => {\n                this.setState({ category });\n              }}\n              ariaLabel={intl.formatMessage(\n                { id: \"preferences-screen.select-category \", defaultMessage: \"Select category {categoryName}\" },\n                {\n                  categoryName: intl.formatMessage(categoryNames[category])\n                }\n              )}\n              selected={category === this.state.category}\n            />\n          ))}\n        </Nav>\n        <div className={styles.contentContainer}>\n          <div className={styles.scrollingContent}>\n            {this.createSections()\n              .get(this.state.category)\n              .map(Section)}\n            {shouldPromptForRefresh && (\n              <div\n                style={{\n                  width: \"100%\",\n                  minHeight: `${this.state.toastHeight}`\n                }}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(PreferencesScreen);\n","var _path, _path2, _path3, _path4, _path5, _path6, _path7;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgWand = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.838 5.213 5.213 7.838l3.052 3.052 2.625-2.625-3.053-3.052Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.774 9.149-2.625 2.625 6.945 6.976 2.656-2.656-6.976-6.945Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.375 6.875H1.25v1.25h3.125v-1.25Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m3.525 2.642-.883.884 2.21 2.21.883-.884-2.21-2.21Z\",\n    fill: \"currentColor\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.125 1.25h-1.25v3.125h1.25V1.25Z\",\n    fill: \"currentColor\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.48 2.643-2.21 2.21.884.883 2.21-2.21-.884-.883Z\",\n    fill: \"currentColor\"\n  })), _path7 || (_path7 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m4.851 9.27-2.21 2.21.884.884 2.21-2.21-.884-.883Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgWand as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"presence-log\":\"presence-log__presence-log__N2qcN\",\"presenceLog\":\"presence-log__presence-log__N2qcN\",\"presence-log-entry\":\"presence-log__presence-log-entry__B1Gmn\",\"presenceLogEntry\":\"presence-log__presence-log-entry__B1Gmn\",\"no-default-button-style\":\"presence-log__no-default-button-style__SFuhd\",\"noDefaultButtonStyle\":\"presence-log__no-default-button-style__SFuhd\",\"message-body\":\"presence-log__message-body__EuHp_\",\"messageBody\":\"presence-log__message-body__EuHp_\",\"message-body-multi\":\"presence-log__message-body-multi__uaZ1g\",\"messageBodyMulti\":\"presence-log__message-body-multi__uaZ1g\",\"message-body-mono\":\"presence-log__message-body-mono__woLab\",\"messageBodyMono\":\"presence-log__message-body-mono__woLab\",\"message-wrap\":\"presence-log__message-wrap__u8cOw\",\"messageWrap\":\"presence-log__message-wrap__u8cOw\",\"message-wrap-multi\":\"presence-log__message-wrap-multi__RPiQs\",\"messageWrapMulti\":\"presence-log__message-wrap-multi__RPiQs\",\"message-source\":\"presence-log__message-source__wGuLz\",\"messageSource\":\"presence-log__message-source__wGuLz\",\"message-source-link\":\"presence-log__message-source-link__Zfm2J\",\"messageSourceLink\":\"presence-log__message-source-link__Zfm2J\",\"icon-button\":\"presence-log__icon-button___bvVv\",\"iconButton\":\"presence-log__icon-button___bvVv\",\"spawn-message\":\"presence-log__spawn-message__UaMSn\",\"spawnMessage\":\"presence-log__spawn-message__UaMSn\",\"share\":\"presence-log__share__gExy1\",\"media\":\"presence-log__media__aJYo6\",\"mediaBody\":\"presence-log__mediaBody__qwTs6\",\"expired\":\"presence-log__expired__bAkfz\",\"presence-log-entry-with-button\":\"presence-log__presence-log-entry-with-button__fVJLP\",\"presenceLogEntryWithButton\":\"presence-log__presence-log-entry-with-button__fVJLP\",\"presence-log-in-room\":\"presence-log__presence-log-in-room__PDH5T\",\"presenceLogInRoom\":\"presence-log__presence-log-in-room__PDH5T\",\"presence-log-spawn\":\"presence-log__presence-log-spawn__DNGWz\",\"presenceLogSpawn\":\"presence-log__presence-log-spawn__DNGWz\",\"presence-log-entry-one-line\":\"presence-log__presence-log-entry-one-line__wy36n\",\"presenceLogEntryOneLine\":\"presence-log__presence-log-entry-one-line__wy36n\",\"presence-log-emoji\":\"presence-log__presence-log-emoji__KfOnt\",\"presenceLogEmoji\":\"presence-log__presence-log-emoji__KfOnt\",\"emoji\":\"presence-log__emoji__i7U3Q\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgChat = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.418 14.844c.046-.171-.057-.409-.155-.58-.03-.052-.063-.101-.099-.149a7.805 7.805 0 0 1-1.289-4.297c-.014-4.385 3.622-7.943 8.118-7.943 3.921 0 7.194 2.717 7.96 6.323.114.534.172 1.08.172 1.626 0 4.391-3.496 8.005-7.992 8.005-.715 0-1.68-.18-2.206-.327a14.835 14.835 0 0 1-1.187-.395 1.215 1.215 0 0 0-.906.014l-2.65.957a.623.623 0 0 1-.182.047.373.373 0 0 1-.374-.38.618.618 0 0 1 .023-.129l.767-2.772Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgChat as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSend = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m18.617 8.871-.007-.003-16.682-6.92a.92.92 0 0 0-.868.085.963.963 0 0 0-.435.804v4.426a.937.937 0 0 0 .762.92l9.1 1.683a.157.157 0 0 1 0 .307l-9.1 1.682a.937.937 0 0 0-.762.92v4.426a.921.921 0 0 0 .414.77.936.936 0 0 0 .888.08l16.682-6.88.008-.003a1.25 1.25 0 0 0 0-2.297Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgSend as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgReaction = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.188 10a.937.937 0 1 0 0-1.875.937.937 0 0 0 0 1.875Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.002 15.001c-1.774 0-3.266-1.153-3.739-2.728a.312.312 0 0 1 .306-.397h6.863a.314.314 0 0 1 .311.254.311.311 0 0 1-.006.143c-.468 1.575-1.96 2.728-3.735 2.728Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.813 10a.937.937 0 1 0 0-1.875.937.937 0 0 0 0 1.875Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.125a8.125 8.125 0 1 0 0-16.25 8.125 8.125 0 0 0 0 16.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgReaction as ReactComponent };","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport TextareaAutosize from \"react-textarea-autosize\";\nimport { TextInput } from \"./TextInput\";\nimport styles from \"./TextAreaInput.scss\";\n\nexport const TextAreaInput = forwardRef(({ className, ...rest }, ref) => (\n  <TextInput className={classNames(styles.textarea, className)} {...rest} as={TextareaAutosize} ref={ref} />\n));\n\nTextAreaInput.propTypes = {\n  className: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"textarea\":\"TextAreaInput__textarea__y2MAr\"};","// extracted by mini-css-extract-plugin\nexport default {\"toolbar-button\":\"ToolbarButton__toolbar-button__KIJB6\",\"toolbarButton\":\"ToolbarButton__toolbar-button__KIJB6\",\"icon-container\":\"ToolbarButton__icon-container__ZEf9E\",\"iconContainer\":\"ToolbarButton__icon-container__ZEf9E\",\"large\":\"ToolbarButton__large__YDjpA\",\"basic\":\"ToolbarButton__basic__PsM2Y\",\"transparent\":\"ToolbarButton__transparent___w9hR\",\"selected\":\"ToolbarButton__selected__SxJqz\",\"primary\":\"ToolbarButton__primary__J7WCr\",\"accept\":\"ToolbarButton__accept__Hfn1R\",\"cancel\":\"ToolbarButton__cancel__qYLZw\",\"accent1\":\"ToolbarButton__accent1__dcxpI\",\"accent2\":\"ToolbarButton__accent2__OuGAI\",\"accent3\":\"ToolbarButton__accent3__JwDT5\",\"accent4\":\"ToolbarButton__accent4__BXXtS\",\"accent5\":\"ToolbarButton__accent5__bvBvH\",\"status-indicator\":\"ToolbarButton__status-indicator__Zgtiz\",\"statusIndicator\":\"ToolbarButton__status-indicator__Zgtiz\",\"status-enabled\":\"ToolbarButton__status-enabled__cSFwX\",\"statusEnabled\":\"ToolbarButton__status-enabled__cSFwX\",\"status-disabled\":\"ToolbarButton__status-disabled__djo6Z\",\"statusDisabled\":\"ToolbarButton__status-disabled__djo6Z\",\"status-unread\":\"ToolbarButton__status-unread__HdEKL\",\"statusUnread\":\"ToolbarButton__status-unread__HdEKL\",\"status-recording\":\"ToolbarButton__status-recording__JMGuh\",\"statusRecording\":\"ToolbarButton__status-recording__JMGuh\",\"left\":\"ToolbarButton__left__xOpwY\",\"middle\":\"ToolbarButton__middle__h7pkJ\",\"right\":\"ToolbarButton__right__e8lxT\"};","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ToolbarButton.scss\";\n\nexport const presets = [\n  \"basic\",\n  \"transparent\",\n  \"accept\",\n  \"cancel\",\n  \"accent1\",\n  \"accent2\",\n  \"accent3\",\n  \"accent4\",\n  \"accent5\"\n];\n\nexport const types = [\"none\", \"left\", \"middle\", \"right\"];\n\nexport const statusColors = [\"recording\", \"unread\", \"enabled\", \"disabled\"];\n\nexport const ToolbarButton = forwardRef(\n  (\n    { preset, className, iconContainerClassName, children, icon, label, selected, large, statusColor, type, ...rest },\n    ref\n  ) => {\n    return (\n      <button\n        ref={ref}\n        className={classNames(\n          styles.toolbarButton,\n          styles[preset],\n          styles[type],\n          { [styles.selected]: selected, [styles.large]: large },\n          className\n        )}\n        {...rest}\n      >\n        <div className={classNames(styles.iconContainer, iconContainerClassName)} aria-hidden=\"true\">\n          {icon}\n          {statusColor && <div className={classNames(styles.statusIndicator, styles[\"status-\" + statusColor])} />}\n          {children}\n        </div>\n        {label && <label>{label}</label>}\n      </button>\n    );\n  }\n);\n\nToolbarButton.propTypes = {\n  icon: PropTypes.node,\n  label: PropTypes.node,\n  selected: PropTypes.bool,\n  preset: PropTypes.oneOf(presets),\n  statusColor: PropTypes.oneOf(statusColors),\n  large: PropTypes.bool,\n  className: PropTypes.string,\n  iconContainerClassName: PropTypes.string,\n  children: PropTypes.node,\n  type: PropTypes.oneOf(types)\n};\n\nToolbarButton.defaultProps = {\n  preset: \"basic\"\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"popover\":\"Popover__popover__TDiHP\",\"content\":\"Popover__content__yKFMS\",\"arrow\":\"Popover__arrow__adu2d\",\"header\":\"Popover__header__GLZCv\",\"arrow-bg\":\"Popover__arrow-bg__J95GS\",\"arrowBg\":\"Popover__arrow-bg__J95GS\",\"arrow-border\":\"Popover__arrow-border__CRbKU\",\"arrowBorder\":\"Popover__arrow-border__CRbKU\",\"fullscreen\":\"Popover__fullscreen__pXsPm\",\"fullscreen-body\":\"Popover__fullscreen-body__Lu_fI\",\"fullscreenBody\":\"Popover__fullscreen-body__Lu_fI\"};","import React, { useState, useCallback, useEffect } from \"react\";\n// Note react-popper-2 is just an alias to react-popper@2.2.3 because storybook is depending on an old version.\n// https://github.com/storybookjs/storybook/issues/10982\nimport { usePopper } from \"react-popper-2\";\nimport styles from \"./Popover.scss\";\nimport { createPortal } from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport { useCssBreakpoints } from \"react-use-css-breakpoints\";\nimport classNames from \"classnames\";\nimport { CloseButton } from \"../input/CloseButton\";\n\nfunction PopoverArrow({ arrowClass }) {\n  return (\n    <svg width=\"25\" height=\"11\" viewBox=\"0 0 25 11\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        d=\"M1 1L11.1176 9.51209C11.8908 10.1626 13.1092 10.1626 13.8824 9.51209L24 1\"\n        strokeWidth=\"2\"\n        className={classNames(styles.arrowBg, arrowClass)}\n      />\n      <path\n        d=\"M11.1176 9.51209L1 1H24L13.8824 9.51209C13.1092 10.1626 11.8908 10.1626 11.1176 9.51209Z\"\n        className={classNames(styles.arrowBorder, arrowClass)}\n      />\n      <path d=\"M0 1H25\" strokeWidth=\"2\" className={classNames(styles.arrowBg, arrowClass)} />\n    </svg>\n  );\n}\n\nPopoverArrow.propTypes = {\n  arrowClass: PropTypes.string\n};\n\nexport function Popover({\n  content: Content,\n  children,\n  title,\n  showHeader,\n  placement,\n  offsetSkidding,\n  offsetDistance,\n  initiallyVisible,\n  disableFullscreen,\n  isVisible,\n  onChangeVisible,\n  popoverApiRef,\n  popoverClass,\n  arrowClass\n}) {\n  const [_visible, _setVisible] = useState(initiallyVisible);\n  const visible = isVisible === undefined ? _visible : isVisible;\n  const setVisible = onChangeVisible || _setVisible;\n  const [referenceElement, setReferenceElement] = useState(null);\n  const [popperElement, setPopperElement] = useState(null);\n  const [arrowElement, setArrowElement] = useState(null);\n  const {\n    styles: { popper: popperStyles, arrow: arrowStyles },\n    attributes\n  } = usePopper(referenceElement, popperElement, {\n    placement,\n    modifiers: [\n      { name: \"arrow\", options: { element: arrowElement } }, // https://popper.js.org/docs/v2/modifiers/arrow/\n      { name: \"offset\", options: { offset: [offsetSkidding, offsetDistance] } } // https://popper.js.org/docs/v2/modifiers/offset/\n    ]\n  });\n  const breakpoint = useCssBreakpoints();\n  const fullscreen = !disableFullscreen && (breakpoint === \"sm\" || breakpoint === \"md\");\n  const openPopover = useCallback(() => setVisible(true), [setVisible]);\n  const closePopover = useCallback(() => setVisible(false), [setVisible]);\n  const togglePopover = useCallback(() => setVisible(visible => !visible), [setVisible]);\n\n  useEffect(\n    () => {\n      if (!popoverApiRef) {\n        return;\n      }\n\n      popoverApiRef.current = {\n        openPopover,\n        closePopover,\n        togglePopover\n      };\n    },\n    [popoverApiRef, openPopover, closePopover, togglePopover]\n  );\n\n  useEffect(\n    () => {\n      const onClick = e => {\n        if (\n          (referenceElement && referenceElement.contains(e.target)) ||\n          (popperElement && popperElement.contains(e.target))\n        ) {\n          return;\n        }\n\n        setVisible(false);\n      };\n\n      const onKeyDown = e => {\n        if (e.key === \"Escape\") {\n          setVisible(false);\n        }\n      };\n\n      if (visible) {\n        window.addEventListener(\"mousedown\", onClick);\n        window.addEventListener(\"keydown\", onKeyDown);\n      }\n\n      return () => {\n        window.removeEventListener(\"mousedown\", onClick);\n        window.removeEventListener(\"keydown\", onKeyDown);\n      };\n    },\n    [visible, popperElement, referenceElement, setVisible]\n  );\n\n  useEffect(\n    () => {\n      if (visible && fullscreen) {\n        document.body.classList.add(styles.fullscreenBody);\n      } else {\n        document.body.classList.remove(styles.fullscreenBody);\n      }\n\n      return () => {\n        document.body.classList.remove(styles.fullscreenBody);\n      };\n    },\n    [fullscreen, visible]\n  );\n\n  return (\n    <>\n      {children({\n        togglePopover,\n        openPopover,\n        closePopover,\n        popoverVisible: visible,\n        triggerRef: setReferenceElement\n      })}\n      {visible &&\n        createPortal(\n          <div\n            ref={setPopperElement}\n            className={classNames(styles.popover, { [styles.fullscreen]: fullscreen }, popoverClass)}\n            style={fullscreen ? undefined : popperStyles}\n            {...attributes.popper}\n          >\n            {showHeader && (\n              <div className={styles.header}>\n                <CloseButton onClick={closePopover} />\n                <h5>{title}</h5>\n              </div>\n            )}\n            <div className={styles.content}>\n              {typeof Content === \"function\" ? (\n                <Content fullscreen={fullscreen} closePopover={closePopover} />\n              ) : (\n                Content\n              )}\n            </div>\n            {!fullscreen && (\n              <div ref={setArrowElement} className={styles.arrow} style={arrowStyles}>\n                <PopoverArrow arrowClass={arrowClass} />\n              </div>\n            )}\n          </div>,\n          document.body\n        )}\n    </>\n  );\n}\n\nPopover.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  placement: PropTypes.string,\n  title: PropTypes.node.isRequired,\n  children: PropTypes.func.isRequired,\n  content: PropTypes.oneOfType([PropTypes.func, PropTypes.node]),\n  disableFullscreen: PropTypes.bool,\n  popoverApiRef: PropTypes.object,\n  popoverClass: PropTypes.string\n};\n\nPopover.defaultProps = {\n  initiallyVisible: false,\n  placement: \"auto\",\n  offsetSkidding: 0,\n  offsetDistance: 8,\n  showHeader: true\n};\n","import React from \"react\";\nimport { Picker } from \"emoji-mart\";\n// Twitter emoji sheets downloaded from unpkg.com provided by https://github.com/missive/emoji-mart\nimport emojiIcons16 from \"../../assets/images/emoji-picker-16.png\";\nimport emojiIcons20 from \"../../assets/images/emoji-picker-20.png\";\nimport emojiIcons32 from \"../../assets/images/emoji-picker-32.png\";\nimport emojiIcons64 from \"../../assets/images/emoji-picker-64.png\";\n\nimport \"./EmojiPicker.scss\";\n\nconst iconSheet = {\n  16: emojiIcons16,\n  20: emojiIcons20,\n  32: emojiIcons32,\n  64: emojiIcons64\n};\n\nexport function EmojiPicker(props) {\n  return (\n    <Picker\n      title=\"Pick an emoji!\"\n      color=\"var(--tab-highlight-color)\"\n      // eslint-disable-next-line no-unused-vars\n      backgroundImageFn={(set, sheetSize) => iconSheet[sheetSize]}\n      {...props}\n    />\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"chat-input-container\":\"ChatSidebar__chat-input-container__qF2Zv\",\"chatInputContainer\":\"ChatSidebar__chat-input-container__qF2Zv\",\"message-list\":\"ChatSidebar__message-list__Q_K_C\",\"messageList\":\"ChatSidebar__message-list__Q_K_C\",\"message-group\":\"ChatSidebar__message-group__wD2L8\",\"messageGroup\":\"ChatSidebar__message-group__wD2L8\",\"message-group-label\":\"ChatSidebar__message-group-label__gTBLt\",\"messageGroupLabel\":\"ChatSidebar__message-group-label__gTBLt\",\"message-group-messages\":\"ChatSidebar__message-group-messages__MOpe3\",\"messageGroupMessages\":\"ChatSidebar__message-group-messages__MOpe3\",\"message-bubble\":\"ChatSidebar__message-bubble__sAPXL\",\"messageBubble\":\"ChatSidebar__message-bubble__sAPXL\",\"sent\":\"ChatSidebar__sent__jodlK\",\"emoji\":\"ChatSidebar__emoji__kotP2\",\"media\":\"ChatSidebar__media__wLlyB\",\"monospace\":\"ChatSidebar__monospace__yFz0r\",\"system-message\":\"ChatSidebar__system-message__ujKWH\",\"systemMessage\":\"ChatSidebar__system-message__ujKWH\",\"chat-input-icon\":\"ChatSidebar__chat-input-icon__sTSAw\",\"chatInputIcon\":\"ChatSidebar__chat-input-icon__sTSAw\",\"chat-input-warning\":\"ChatSidebar__chat-input-warning__OzrS4\",\"chatInputWarning\":\"ChatSidebar__chat-input-warning__OzrS4\",\"warning-border\":\"ChatSidebar__warning-border__KeF28\",\"warningBorder\":\"ChatSidebar__warning-border__KeF28\",\"warning-text-color\":\"ChatSidebar__warning-text-color__wNwfr\",\"warningTextColor\":\"ChatSidebar__warning-text-color__wNwfr\",\"chat-input-text-area-styles\":\"ChatSidebar__chat-input-text-area-styles__oPn7w\",\"chatInputTextAreaStyles\":\"ChatSidebar__chat-input-text-area-styles__oPn7w\"};","import React from \"react\";\nimport Linkify from \"react-linkify\";\nimport { toArray as toEmojis } from \"react-emoji-render\";\n\nconst emojiRegex = /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|[\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|[\\ud83c[\\ude32-\\ude3a]|[\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/;\n\nexport const MAX_MESSAGE_LENGTH = 750;\n\nexport function formatMessageBody(body, { emojiClassName } = {}) {\n  // Support wrapping text in ` to get monospace, and multiline.\n  const bodyLength = body.length >= MAX_MESSAGE_LENGTH ? MAX_MESSAGE_LENGTH : body.length;\n  const monospace = body.startsWith(\"`\") && body.endsWith(\"`\");\n  const cleanedBody = (monospace ? body.substring(1, bodyLength - 1) : body.substring(0, bodyLength)).trim();\n\n  const messages = cleanedBody.split(\"\\n\").map((message, i) => (\n    <p key={i}>\n      <Linkify properties={{ target: \"_blank\", rel: \"noopener referrer\" }}>\n        {toEmojis(message, { className: emojiClassName })}\n      </Linkify>\n    </p>\n  ));\n\n  const multiline = messages.length > 1;\n\n  let emoji = false;\n\n  if (messages.length === 1) {\n    const emojiComponents = toEmojis(cleanedBody);\n\n    emoji =\n      emojiComponents.length === 1 &&\n      emojiComponents[0].props &&\n      emojiComponents[0].props.children.match &&\n      emojiComponents[0].props.children.match(emojiRegex);\n  }\n\n  return {\n    formattedBody: <>{messages}</>,\n    multiline,\n    monospace,\n    emoji\n  };\n}\n","import React, { useEffect, useRef, forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { ReactComponent as WandIcon } from \"../icons/Wand.svg\";\nimport { ReactComponent as AttachIcon } from \"../icons/Attach.svg\";\nimport { ReactComponent as ChatIcon } from \"../icons/Chat.svg\";\nimport { ReactComponent as SendIcon } from \"../icons/Send.svg\";\nimport { ReactComponent as ReactionIcon } from \"../icons/Reaction.svg\";\nimport { IconButton } from \"../input/IconButton\";\nimport { TextAreaInput } from \"../input/TextAreaInput\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { Popover } from \"../popover/Popover\";\nimport { EmojiPicker } from \"./EmojiPicker\";\nimport styles from \"./ChatSidebar.scss\";\nimport { formatMessageBody } from \"../../utils/chat-message\";\nimport { FormattedMessage, useIntl, defineMessages, FormattedRelativeTime } from \"react-intl\";\n\nexport function SpawnMessageButton(props) {\n  return (\n    <IconButton className={styles.chatInputIcon} {...props}>\n      <WandIcon />\n    </IconButton>\n  );\n}\n\nexport function SendMessageButton(props) {\n  return (\n    <IconButton className={styles.chatInputIcon} {...props}>\n      <SendIcon />\n    </IconButton>\n  );\n}\n\n// Memoize EmojiPickerPopoverButton since we don't want it re-rendering\n// the EmojiPicker unnecessarily.\nexport const EmojiPickerPopoverButton = React.memo(({ onSelectEmoji }) => {\n  // We're using a ref here, since we don't want to re-render anything, but we\n  // do want to know if the Shift key is down when an emoji is selected.\n  const shiftKeyDown = useRef(false);\n\n  useEffect(() => {\n    const onKeyDown = e => {\n      if (e.key === \"Shift\") shiftKeyDown.current = true;\n    };\n    const onKeyUp = e => {\n      if (e.key === \"Shift\") shiftKeyDown.current = false;\n    };\n\n    window.addEventListener(\"keydown\", onKeyDown);\n    window.addEventListener(\"keyup\", onKeyUp);\n\n    return () => {\n      window.removeEventListener(\"keydown\", onKeyDown);\n      window.removeEventListener(\"keyup\", onKeyUp);\n    };\n  }, []);\n\n  return (\n    <Popover\n      title=\"\"\n      content={({ closePopover }) => (\n        <EmojiPicker\n          onSelect={emoji => {\n            const keepPickerOpen = shiftKeyDown.current;\n            onSelectEmoji({ emoji, pickerRemainedOpen: keepPickerOpen });\n            // Keep the picker open if the Shift key was held down to allow\n            // for multiple emoji selections.\n            if (!keepPickerOpen) closePopover();\n          }}\n        />\n      )}\n      placement=\"top\"\n      offsetDistance={28}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <IconButton ref={triggerRef} className={styles.chatInputIcon} selected={popoverVisible} onClick={togglePopover}>\n          <ReactionIcon />\n        </IconButton>\n      )}\n    </Popover>\n  );\n});\n\nEmojiPickerPopoverButton.propTypes = {\n  onSelectEmoji: PropTypes.func.isRequired\n};\n\nexport function MessageAttachmentButton(props) {\n  return (\n    <>\n      <IconButton as=\"label\" className={styles.chatInputIcon}>\n        <AttachIcon />\n        <input type=\"file\" {...props} />\n      </IconButton>\n    </>\n  );\n}\n\nexport function ChatLengthWarning({ messageLength, maxLength }) {\n  return (\n    <p\n      className={classNames(styles.chatInputWarning, {\n        [styles.warningTextColor]: messageLength > maxLength\n      })}\n    >\n      <FormattedMessage id=\"chat-message-input.warning-max-characters\" defaultMessage=\"Max characters\" />\n      {` (${messageLength}/${maxLength})`}\n    </p>\n  );\n}\n\nChatLengthWarning.propTypes = {\n  messageLength: PropTypes.number,\n  maxLength: PropTypes.number\n};\n\nexport const ChatInput = forwardRef(({ warning, isOverMaxLength, ...props }, ref) => {\n  const intl = useIntl();\n\n  return (\n    <div className={styles.chatInputContainer}>\n      <TextAreaInput\n        ref={ref}\n        textInputStyles={styles.chatInputTextAreaStyles}\n        className={classNames({ [styles.warningBorder]: isOverMaxLength })}\n        placeholder={intl.formatMessage({ id: \"chat-sidebar.input.placeholder\", defaultMessage: \"Message...\" })}\n        {...props}\n      />\n      {warning}\n    </div>\n  );\n});\n\nChatInput.propTypes = {\n  onSpawn: PropTypes.func,\n  warning: PropTypes.node,\n  isOverMaxLength: PropTypes.bool\n};\n\nconst enteredMessages = defineMessages({\n  room: { id: \"chat-sidebar.system-message.entered-room\", defaultMessage: \"{name} entered the room.\" },\n  lobby: { id: \"chat-sidebar.system-message.entered-lobby\", defaultMessage: \"{name} entered the lobby.\" }\n});\n\nconst joinedMessages = defineMessages({\n  lobby: { id: \"chat-sidebar.system-message.joined-lobby\", defaultMessage: \"{name} joined the lobby.\" },\n  room: { id: \"chat-sidebar.system-message.joined-room\", defaultMessage: \"{name} joined the room.\" }\n});\n\nexport const LogMessageType = {\n  roomEntryRequired: \"roomEntryRequired\",\n  flyModeDisabled: \"flyModeDisabled\",\n  flyModeEnabled: \"flyModeEnabled\",\n  unauthorizedSceneChange: \"unauthorizedSceneChange\",\n  invalidSceneUrl: \"invalidSceneUrl\",\n  unauthorizedRoomRename: \"unauthorizedRoomRename\",\n  captureUnavailable: \"captureUnavailable\",\n  captureStopped: \"captureStopped\",\n  captureStarted: \"captureStarted\",\n  captureAlreadyStopped: \"captureAlreadyStopped\",\n  captureAlreadyRunning: \"captureAlreadyRunning\",\n  positionalAudioEnabled: \"positionalAudioEnabled\",\n  positionalAudioDisabled: \"positionalAudioDisabled\",\n  setAudioNormalizationFactor: \"setAudioNormalizationFactor\",\n  audioNormalizationDisabled: \"audioNormalizationDisabled\",\n  audioNormalizationNaN: \"audioNormalizationNaN\",\n  invalidAudioNormalizationRange: \"invalidAudioNormalizationRange\",\n  audioSuspended: \"audioSuspended\",\n  audioResumed: \"audioResumed\",\n  joinFailed: \"joinFailed\",\n  avatarChanged: \"avatarChanged\"\n};\n\nconst logMessages = defineMessages({\n  [LogMessageType.roomEntryRequired]: {\n    id: \"chat-sidebar.log-message.room-entry-required\",\n    defaultMessage: \"You must enter the room to use this command.\"\n  },\n  [LogMessageType.flyModeDisabled]: {\n    id: \"chat-sidebar.log-message.fly-mode-disabled\",\n    defaultMessage: \"Fly mode disabled.\"\n  },\n  [LogMessageType.flyModeEnabled]: {\n    id: \"chat-sidebar.log-message.fly-mode-enabled\",\n    defaultMessage: \"Fly mode enabled.\"\n  },\n  [LogMessageType.unauthorizedSceneChange]: {\n    id: \"chat-sidebar.log-message.unauthorized-scene-change\",\n    defaultMessage: \"You do not have permission to change the scene.\"\n  },\n  [LogMessageType.invalidSceneUrl]: {\n    id: \"chat-sidebar.log-message.invalid-scene-url\",\n    defaultMessage: \"This URL does not point to a scene or valid GLB.\"\n  },\n  [LogMessageType.unauthorizedRoomRename]: {\n    id: \"chat-sidebar.log-message.unauthorized-room-rename\",\n    defaultMessage: \"You do not have permission to rename this room.\"\n  },\n  [LogMessageType.captureUnavailable]: {\n    id: \"chat-sidebar.log-message.capture-unavailable\",\n    defaultMessage: \"Capture unavailable.\"\n  },\n  [LogMessageType.captureStopped]: {\n    id: \"chat-sidebar.log-message.capture-stopped\",\n    defaultMessage: \"Capture stopped.\"\n  },\n  [LogMessageType.captureStarted]: {\n    id: \"chat-sidebar.log-message.capture-started\",\n    defaultMessage: \"Capture started.\"\n  },\n  [LogMessageType.captureAlreadyStopped]: {\n    id: \"chat-sidebar.log-message.capture-already-stopped\",\n    defaultMessage: \"Capture already stopped.\"\n  },\n  [LogMessageType.captureAlreadyRunning]: {\n    id: \"chat-sidebar.log-message.capture-already-running\",\n    defaultMessage: \"Capture already running.\"\n  },\n  [LogMessageType.positionalAudioEnabled]: {\n    id: \"chat-sidebar.log-message.positional-audio-enabled\",\n    defaultMessage: \"Positional audio enabled.\"\n  },\n  [LogMessageType.positionalAudioDisabled]: {\n    id: \"chat-sidebar.log-message.positional-audio-disabled\",\n    defaultMessage: \"Positional audio disabled.\"\n  },\n  [LogMessageType.setAudioNormalizationFactor]: {\n    id: \"chat-sidebar.log-message.set-audio-normalization-factor\",\n    defaultMessage: \"audioNormalization factor is set to {factor}.\"\n  },\n  [LogMessageType.audioNormalizationDisabled]: {\n    id: \"chat-sidebar.log-message.audio-normalization-disabled\",\n    defaultMessage: \"audioNormalization is disabled.\"\n  },\n  [LogMessageType.audioNormalizationNaN]: {\n    id: \"chat-sidebar.log-message.audio-normalization-nan\",\n    defaultMessage: \"audioNormalization command needs a valid number parameter.\"\n  },\n  [LogMessageType.invalidAudioNormalizationRange]: {\n    id: \"chat-sidebar.log-message.invalid-audio-normalization-range\",\n    defaultMessage:\n      \"audioNormalization command needs a base volume number between 0 [no normalization] and 255. Default is 0. The recommended value is 4, if you would like to enable normalization.\"\n  },\n  [LogMessageType.audioSuspended]: {\n    id: \"chat-sidebar.log-message.audio-suspended\",\n    defaultMessage: \"Audio has been suspended, click somewhere in the room to resume the audio.\"\n  },\n  [LogMessageType.audioResumed]: {\n    id: \"chat-sidebar.log-message.audio-resumed\",\n    defaultMessage: \"Audio has been resumed.\"\n  },\n  [LogMessageType.joinFailed]: {\n    id: \"chat-sidebar.log-message.join-failed\",\n    defaultMessage: \"Failed to join room: {message}\"\n  },\n  [LogMessageType.avatarChanged]: {\n    id: \"chat-sidebar.log-message.avatar-changed\",\n    defaultMessage: \"Your avatar has been changed.\"\n  }\n});\n\n// TODO: use react-intl's defineMessages to get proper extraction\nexport function formatSystemMessage(entry, intl) {\n  switch (entry.type) {\n    case \"join\":\n      return intl.formatMessage(joinedMessages[entry.presence], { name: <b>{entry.name}</b> });\n    case \"entered\":\n      return intl.formatMessage(enteredMessages[entry.presence], { name: <b>{entry.name}</b> });\n    case \"leave\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.leave\"\n          defaultMessage=\"{name} left.\"\n          values={{ name: <b>{entry.name}</b> }}\n        />\n      );\n    case \"display_name_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.name-change\"\n          defaultMessage=\"{oldName} is now known as {newName}\"\n          values={{ oldName: <b>{entry.oldName}</b>, newName: <b>{entry.newName}</b> }}\n        />\n      );\n    case \"scene_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.scene-change\"\n          defaultMessage=\"{name} changed the scene to {sceneName}\"\n          values={{ name: <b>{entry.name}</b>, sceneName: <b>{entry.sceneName}</b> }}\n        />\n      );\n    case \"hub_name_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.hub-name-change\"\n          defaultMessage=\"{name} changed the name of the room to {hubName}\"\n          values={{ name: <b>{entry.name}</b>, hubName: <b>{entry.hubName}</b> }}\n        />\n      );\n    case \"hub_changed\":\n      return (\n        <FormattedMessage\n          id=\"chat-sidebar.system-message.hub-change\"\n          defaultMessage=\"You are now in {hubName}\"\n          values={{ hubName: <b>{entry.hubName}</b> }}\n        />\n      );\n    case \"log\":\n      return intl.formatMessage(logMessages[entry.messageType], entry.props);\n    default:\n      return null;\n  }\n}\n\nexport function SystemMessage(props) {\n  const intl = useIntl();\n\n  return (\n    <li className={classNames(styles.messageGroup, styles.systemMessage)}>\n      {props.showLineBreak && <hr />}\n      <p className={styles.messageGroupLabel}>\n        <i>{formatSystemMessage(props, intl)}</i>\n        <span>\n          <FormattedRelativeTime updateIntervalInSeconds={10} value={(props.timestamp - Date.now()) / 1000} />\n        </span>\n      </p>\n    </li>\n  );\n}\n\nSystemMessage.propTypes = {\n  timestamp: PropTypes.any,\n  showLineBreak: PropTypes.bool\n};\n\nfunction MessageBubble({ media, monospace, emoji, children }) {\n  return (\n    <div\n      className={classNames(styles.messageBubble, {\n        [styles.media]: media,\n        [styles.emoji]: emoji,\n        [styles.monospace]: monospace\n      })}\n    >\n      {children}\n    </div>\n  );\n}\n\nMessageBubble.propTypes = {\n  media: PropTypes.bool,\n  monospace: PropTypes.bool,\n  emoji: PropTypes.oneOfType([PropTypes.bool, PropTypes.array]),\n  children: PropTypes.node\n};\n\nfunction getMessageComponent(message) {\n  switch (message.type) {\n    case \"chat\": {\n      const { formattedBody, monospace, emoji } = formatMessageBody(message.body);\n      return (\n        <MessageBubble key={message.id} monospace={monospace} emoji={emoji}>\n          {formattedBody}\n        </MessageBubble>\n      );\n    }\n    case \"video\":\n      return (\n        <MessageBubble key={message.id} media>\n          <video controls src={message.body.src} />\n        </MessageBubble>\n      );\n    case \"image\":\n    case \"photo\":\n      return (\n        <MessageBubble key={message.id} media>\n          <img src={message.body.src} />\n        </MessageBubble>\n      );\n    default:\n      return null;\n  }\n}\n\nexport function ChatMessageGroup({ sent, sender, timestamp, messages }) {\n  return (\n    <li className={classNames(styles.messageGroup, { [styles.sent]: sent })}>\n      <p className={styles.messageGroupLabel}>\n        {sender} | <FormattedRelativeTime updateIntervalInSeconds={10} value={(timestamp - Date.now()) / 1000} />\n      </p>\n      <ul className={styles.messageGroupMessages}>{messages.map(message => getMessageComponent(message))}</ul>\n    </li>\n  );\n}\n\nChatMessageGroup.propTypes = {\n  sent: PropTypes.bool,\n  sender: PropTypes.string,\n  timestamp: PropTypes.any,\n  messages: PropTypes.array\n};\n\nexport const ChatMessageList = forwardRef(({ children, ...rest }, ref) => (\n  <ul {...rest} className={styles.messageList} ref={ref}>\n    {children}\n  </ul>\n));\n\nChatMessageList.propTypes = {\n  children: PropTypes.node\n};\n\nexport function ChatSidebar({ onClose, children, ...rest }) {\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"chat-sidebar.title\" defaultMessage=\"Chat\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n      contentClassName={styles.content}\n      disableOverflowScroll\n      {...rest}\n    >\n      {children}\n    </Sidebar>\n  );\n}\n\nChatSidebar.propTypes = {\n  onClose: PropTypes.func,\n  onScrollList: PropTypes.func,\n  children: PropTypes.node,\n  listRef: PropTypes.func\n};\n\nexport function ChatToolbarButton(props) {\n  return (\n    <ToolbarButton\n      {...props}\n      icon={<ChatIcon />}\n      preset=\"accent4\"\n      label={<FormattedMessage id=\"chat-toolbar-button\" defaultMessage=\"Chat\" />}\n    />\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport html2canvas from \"html2canvas\";\nimport { coerceToUrl } from \"../utils/media-utils\";\nimport { formatMessageBody } from \"../utils/chat-message\";\nimport { createPlaneBufferGeometry } from \"../utils/three-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\n\nconst textureLoader = new HubsTextureLoader();\n\nconst CHAT_MESSAGE_TEXTURE_SIZE = 1024;\n\nconst messageBodyDom = (body, from, fromSessionId, onViewProfile, emojiClassName) => {\n  const { formattedBody, multiline, monospace, emoji } = formatMessageBody(body, { emojiClassName });\n  const wrapStyle = multiline ? styles.messageWrapMulti : styles.messageWrap;\n  const messageBodyClasses = {\n    [styles.messageBody]: true,\n    [styles.messageBodyMulti]: multiline,\n    [styles.messageBodyMono]: monospace\n  };\n  const includeClientLink = onViewProfile && fromSessionId && history && NAF.clientId !== fromSessionId;\n  const onFromClick = includeClientLink ? () => onViewProfile(fromSessionId) : () => {};\n\n  const content = (\n    <div className={wrapStyle}>\n      {from && (\n        <div\n          onClick={onFromClick}\n          className={classNames({ [styles.messageSource]: true, [styles.messageSourceLink]: includeClientLink })}\n        >\n          {from}:\n        </div>\n      )}\n      <div className={classNames(messageBodyClasses)}>{formattedBody}</div>\n    </div>\n  );\n\n  return { content, multiline, emoji };\n};\n\nfunction renderChatMessage(body, from, allowEmojiRender) {\n  const { content, emoji, multiline } = messageBodyDom(body, from, null, null, styles.emoji);\n  const isEmoji = allowEmojiRender && emoji;\n  const el = document.createElement(\"div\");\n  el.setAttribute(\"class\", `${styles.presenceLog} ${styles.presenceLogSpawn}`);\n  document.body.appendChild(el);\n\n  const entryDom = (\n    <div\n      className={classNames({\n        [styles.presenceLogEntry]: !isEmoji,\n        [styles.presenceLogEntryOneLine]: !isEmoji && !multiline,\n        [styles.presenceLogEmoji]: isEmoji\n      })}\n    >\n      {content}\n    </div>\n  );\n\n  return new Promise((resolve, reject) => {\n    ReactDOM.render(entryDom, el, () => {\n      const width = el.offsetWidth;\n      const height = el.offsetHeight;\n      const ratio = height / width;\n      const scale = (CHAT_MESSAGE_TEXTURE_SIZE * Math.min(1.0, 1.0 / ratio)) / el.offsetWidth;\n      html2canvas(el, { backgroundColor: null, scale, logging: false })\n        .then(canvas => {\n          canvas.toBlob(blob => resolve([blob, width, height]), \"image/png\");\n          el.remove();\n        })\n        .catch(reject);\n    });\n  });\n}\n\nexport async function createInWorldLogMessage({ name, type, body }) {\n  if (type !== \"chat\") return;\n\n  const [blob, width, height] = await renderChatMessage(body, name, false);\n  const entity = document.createElement(\"a-entity\");\n  const meshEntity = document.createElement(\"a-entity\");\n\n  document.querySelector(\"a-scene\").appendChild(entity);\n\n  entity.appendChild(meshEntity);\n  entity.setAttribute(\"class\", \"ui\");\n  entity.setAttribute(\"is-remote-hover-target\", {});\n  entity.setAttribute(\"follow-in-fov\", {\n    target: \"#avatar-pov-node\",\n    offset: { x: 0, y: 0.0, z: -0.8 }\n  });\n\n  const blobUrl = URL.createObjectURL(blob);\n\n  meshEntity.setAttribute(\"animation__float\", {\n    property: \"position\",\n    dur: 10000,\n    from: { x: 0, y: 0, z: 0 },\n    to: { x: 0, y: 0.05, z: -0.05 },\n    easing: \"easeOutQuad\"\n  });\n\n  entity.setAttribute(\"animation__spawn\", {\n    property: \"scale\",\n    dur: 200,\n    from: { x: 0.1, y: 0.1, z: 0.1 },\n    to: { x: 1, y: 1, z: 1 },\n    easing: \"easeOutElastic\"\n  });\n\n  meshEntity.setAttribute(\"animation__opacity\", {\n    property: \"meshMaterial.opacity\",\n    isRawProperty: true,\n    delay: 3000,\n    dur: 8000,\n    from: 1.0,\n    to: 0.0,\n    easing: \"easeInQuad\"\n  });\n\n  meshEntity.addEventListener(\"animationcomplete__opacity\", () => {\n    entity.parentNode.removeChild(entity);\n  });\n\n  textureLoader.load(blobUrl, texture => {\n    const material = new THREE.MeshBasicMaterial();\n    material.transparent = true;\n    material.map = texture;\n    material.generateMipmaps = false;\n    material.needsUpdate = true;\n\n    const geometry = createPlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n    const mesh = new THREE.Mesh(geometry, material);\n    meshEntity.setObject3D(\"mesh\", mesh);\n    meshEntity.meshMaterial = material;\n    const scaleFactor = 400;\n    meshEntity.object3DMap.mesh.scale.set(width / scaleFactor, height / scaleFactor, 1);\n  });\n}\n\nexport async function spawnChatMessage(body, from) {\n  if (body.length === 0) return;\n\n  try {\n    const url = new URL(coerceToUrl(body));\n    if (url.host) {\n      document.querySelector(\"a-scene\").emit(\"add_media\", body);\n      return;\n    }\n  } catch (e) {\n    // Ignore parse error\n  }\n\n  // If not a URL, spawn as a text bubble\n\n  const [blob] = await renderChatMessage(body, from, true);\n  document.querySelector(\"a-scene\").emit(\"add_media\", new File([blob], \"message.png\", { type: \"image/png\" }));\n}\n\nexport default function ChatMessage(props) {\n  const { content } = messageBodyDom(props.body, props.name, props.sessionId, props.onViewProfile);\n\n  return (\n    <div className={props.className}>\n      {props.maySpawn && (\n        <button\n          className={classNames(styles.iconButton, styles.spawnMessage)}\n          onClick={() => spawnChatMessage(props.body)}\n        />\n      )}\n      {content}\n    </div>\n  );\n}\n\nChatMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.string,\n  sessionId: PropTypes.string,\n  className: PropTypes.string,\n  onViewProfile: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport configs from \"../utils/configs\";\nimport classNames from \"classnames\";\n\nimport { share } from \"../utils/share\";\nimport { getLandingPageForPhoto } from \"../utils/phoenix-utils\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nexport default function PhotoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const intl = useIntl();\n\n  const landingPageUrl = getLandingPageForPhoto(url);\n\n  const onShareClicked = share.bind(null, {\n    url: landingPageUrl,\n    title: intl.formatMessage(\n      {\n        id: \"photo-message.default-tweet\",\n        defaultMessage: \"Taken in {shareHashtag}\"\n      },\n      {\n        shareHashtag: configs.translation(\"share-hashtag\"),\n        url: `https://${configs.SHORTLINK_DOMAIN}/${hubId}`\n      }\n    )\n  });\n\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <FormattedMessage\n          id=\"photo-message.body\"\n          defaultMessage=\"{name} took a <a>photo</a>.\"\n          values={{\n            name: <b>{name}</b>,\n            // eslint-disable-next-line react/display-name\n            a: chunks => (\n              <b>\n                <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {chunks}\n                </a>\n              </b>\n            )\n          }}\n        />\n      </div>\n      <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={url} />\n      </a>\n    </div>\n  );\n}\nPhotoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../utils/configs\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nimport { share } from \"../utils/share\";\n\nexport default function VideoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const intl = useIntl();\n\n  const onShareClicked = share.bind(null, {\n    url: url,\n    title: intl.formatMessage(\n      {\n        id: \"video-message.default-tweet\",\n        defaultMessage: \"Taken in {shareHashtag}\"\n      },\n      {\n        shareHashtag: configs.translation(\"share-hashtag\"),\n        url: `https://${configs.SHORTLINK_DOMAIN}/${hubId}`\n      }\n    )\n  });\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <FormattedMessage\n          id=\"video-message.body\"\n          defaultMessage=\"{name} took a <a>video</a>.\"\n          values={{\n            name: <b>{name}</b>,\n            // eslint-disable-next-line react/display-name\n            a: chunks => (\n              <b>\n                <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {chunks}\n                </a>\n              </b>\n            )\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\nVideoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\n\nfunction spawnImage(url) {\n  document.querySelector(\"a-scene\").emit(\"add_media\", url);\n}\n\nexport default function ImageMessage({ name, body: { src: url }, className, maySpawn }) {\n  return (\n    <div className={className}>\n      {maySpawn && (\n        <button className={classNames(styles.iconButton, styles.spawnMessage)} onClick={() => spawnImage(url)} />\n      )}\n      <div className={styles.mediaBody}>{name && <div className={styles.messageSource}>{name}:</div>}</div>\n      <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={proxiedUrlFor(url)} />\n      </a>\n    </div>\n  );\n}\n\nImageMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { injectIntl } from \"react-intl\";\nimport { formatSystemMessage } from \"./room/ChatSidebar\";\n\nimport ChatMessage from \"./chat-message\";\nimport PhotoMessage from \"./photo-message\";\nimport VideoMessage from \"./video-message\";\nimport ImageMessage from \"./image-message\";\nimport { getPresenceContextForSession } from \"../utils/phoenix-utils\";\n\nclass PresenceLog extends Component {\n  static propTypes = {\n    entries: PropTypes.array,\n    inRoom: PropTypes.bool,\n    hubId: PropTypes.string,\n    history: PropTypes.object,\n    presences: PropTypes.object,\n    onViewProfile: PropTypes.func,\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  domForEntry = e => {\n    const entryClasses = {\n      [styles.presenceLogEntry]: true,\n      [styles.presenceLogEntryWithButton]: (e.type === \"chat\" || e.type === \"image\") && e.maySpawn,\n      [styles.presenceLogChat]: e.type === \"chat\",\n      [styles.expired]: !!e.expired\n    };\n\n    const presenceContext = e.sessionId ? getPresenceContextForSession(this.props.presences, e.sessionId) : {};\n    const isBot = !!presenceContext.discord;\n\n    switch (e.type) {\n      case \"chat\":\n        return (\n          <ChatMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            sessionId={e.sessionId}\n            includeFromLink={this.props.inRoom && !isBot}\n            history={this.props.history}\n            onViewProfile={this.props.onViewProfile}\n          />\n        );\n      case \"image\":\n        return (\n          <ImageMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n          />\n        );\n      case \"photo\":\n        return (\n          <PhotoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      case \"video\":\n        return (\n          <VideoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      default: {\n        const systemMessage = formatSystemMessage(e, this.props.intl);\n\n        return (\n          systemMessage && (\n            <div key={e.key} className={classNames(entryClasses)}>\n              <div>{systemMessage}</div>\n            </div>\n          )\n        );\n      }\n    }\n  };\n\n  render() {\n    const presenceClasses = {\n      [styles.presenceLog]: true,\n      [styles.presenceLogInRoom]: this.props.inRoom\n    };\n\n    return <div className={classNames(presenceClasses)}>{this.props.entries.map(this.domForEntry)}</div>;\n  }\n}\n\nexport default injectIntl(PresenceLog);\n","// extracted by mini-css-extract-plugin\nexport default {\"no-default-button-style\":\"preload-overlay__no-default-button-style__qzAb1\",\"noDefaultButtonStyle\":\"preload-overlay__no-default-button-style__qzAb1\",\"treatment\":\"preload-overlay__treatment__RIl_g\",\"screenshot\":\"preload-overlay__screenshot__Xr31g\",\"hub-name\":\"preload-overlay__hub-name__Te1Hl\",\"hubName\":\"preload-overlay__hub-name__Te1Hl\",\"main-panel\":\"preload-overlay__main-panel__OtC9B\",\"mainPanel\":\"preload-overlay__main-panel__OtC9B\",\"logo\":\"preload-overlay__logo__PTRso\"};","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport configs from \"../utils/configs\";\nimport styles from \"../assets/stylesheets/preload-overlay.scss\";\nimport { Button } from \"./input/Button\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nexport default class PreloadOverlay extends Component {\n  static propTypes = {\n    hubName: PropTypes.string,\n    hubScene: PropTypes.object,\n    baseUrl: PropTypes.string,\n    onLoadClicked: PropTypes.func\n  };\n\n  render() {\n    const loadButtonText = <FormattedMessage id=\"preload-overlay.load-button\" defaultMessage=\"Load Room\" />;\n\n    return (\n      <div className={styles.treatment}>\n        <div className={styles.screenshot}>\n          {this.props.hubScene && <img className={styles.screenshot} src={this.props.hubScene.screenshot_url} />}\n        </div>\n        <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className={styles.logo}>\n          <img\n            src={configs.image(\"logo\")}\n            alt={<FormattedMessage id=\"preload-overlay.logo-alt\" defaultMessage=\"Logo\" />}\n          />\n        </a>\n        <div className={styles.mainPanel}>\n          <div className={styles.hubName}>{this.props.hubName}</div>\n          {this.props.onLoadClicked &&\n            (!isMobile ? (\n              <Button preset=\"primary\" onClick={this.props.onLoadClicked}>\n                {loadButtonText}\n              </Button>\n            ) : (\n              <Button preset=\"primary\" as=\"a\" href={this.props.baseUrl} target=\"_blank\" rel=\"noreferrer noopener\">\n                {loadButtonText}\n              </Button>\n            ))}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\n\nconst useCanvas = (draw, color, xData, yData, options = {}) => {\n  const canvasRef = React.useRef(null);\n\n  useEffect(\n    () => {\n      const canvas = canvasRef.current;\n      const context = canvas.getContext(options.context || \"2d\");\n      let animationFrameId;\n      const render = () => {\n        draw(context, xData, yData, color);\n        animationFrameId = window.requestAnimationFrame(render);\n      };\n      render();\n      return () => {\n        window.cancelAnimationFrame(animationFrameId);\n      };\n    },\n    [options.context, xData, yData, color, draw]\n  );\n  return canvasRef;\n};\n\nfunction drawFunc(ctx, xData, yData, color) {\n  const xSum = xData.reduce((a, b) => a + b, 0);\n  const xRatio = ctx.canvas.width / xSum;\n\n  const yMax = Math.max.apply(Math, yData);\n  const yRatio = ctx.canvas.height / yMax;\n\n  xData = xData.map(x => x * xRatio);\n  yData = yData.map(y => y * yRatio);\n\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n  ctx.fillStyle = color;\n  ctx.strokeStyle = color;\n  ctx.lineWidth = 1;\n  let x0 = 0;\n  for (let i = 0; i < xData.length; i++) {\n    const x1 = x0 + xData[i];\n    const y0 = ctx.canvas.height - yData[i];\n    const y1 = ctx.canvas.height - (i === 0 ? yData[i] : i === yData.length - 1 ? yData[i] : yData[i + 1]);\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.lineTo(x1, y1);\n    ctx.lineTo(x1, ctx.canvas.height);\n    ctx.lineTo(x0, ctx.canvas.height);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n    x0 = x1;\n  }\n}\n\nexport const DataGraph = props => {\n  const { options, data, color, xAxis, yAxis, ...rest } = props;\n  const { context } = options;\n\n  const xData = data.map(d => d[xAxis]);\n  const yData = data.map(d => d[yAxis]);\n  const canvasRef = useCanvas(drawFunc, color, xData, yData, { context });\n\n  return <canvas ref={canvasRef} {...rest} />;\n};\n\nDataGraph.propTypes = {\n  options: PropTypes.object,\n  data: PropTypes.array,\n  xAxis: PropTypes.string,\n  yAxis: PropTypes.string,\n  color: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Prop.scss\";\n\nexport function CreatePropsFromData(data) {\n  const props = [];\n  for (const property in data) {\n    let value = data[property];\n    if (typeof value === \"number\" && !!(value % 1)) {\n      value = value.toFixed(2);\n      props.push(<Prop key={property} propKey={property} propValue={value} />);\n    } else if (typeof value === \"object\") {\n      props.push(<Prop key={property} propKey={property} propValue={\"-\"} />);\n      props.push(CreatePropsFromData(value));\n    } else {\n      props.push(<Prop key={property} propKey={property} propValue={value} />);\n    }\n  }\n\n  return props;\n}\n\nexport function Prop({ propKey, propValue }) {\n  return (\n    (propKey !== undefined &&\n      propValue !== undefined && (\n        <p className={classNames(styles.rtcTileText)}>\n          {`${propKey}: `}\n          <span className={classNames(styles.rtcValueText)}>{`${propValue}`}</span>\n        </p>\n      )) ||\n    null\n  );\n}\n\nProp.propTypes = {\n  propKey: PropTypes.string,\n  propValue: PropTypes.any\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"rtc-tile-text\":\"Prop__rtc-tile-text__mbi_m\",\"rtcTileText\":\"Prop__rtc-tile-text__mbi_m\",\"rtc-value-text\":\"Prop__rtc-value-text__ZiJ0n\",\"rtcValueText\":\"Prop__rtc-value-text__ZiJ0n\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { DataGraph } from \"./DataGraph.js\";\nimport { Prop, CreatePropsFromData } from \"./Prop.js\";\nimport styles from \"./DataPanel.scss\";\n\nexport function DataPanel({\n  graphData,\n  speed,\n  width,\n  height,\n  data,\n  xAxis,\n  yAxis,\n  title,\n  children,\n  color,\n  backgroundColor\n}) {\n  return (\n    <div className={classNames(styles.dataTile)} style={{ backgroundColor: backgroundColor }}>\n      <p className={classNames(styles.dataTileTitle)}>{title}</p>\n      {graphData && (\n        <div\n          style={{\n            position: \"relative\",\n            width: width || \"auto\",\n            height: height || \"auto\",\n            alignSelf: \"center\",\n            flex: \"0 0 auto\"\n          }}\n        >\n          <DataGraph\n            width={width || \"auto\"}\n            height={height || \"auto\"}\n            options={{ context: \"2d\" }}\n            data={graphData}\n            color={color || \"rgb(0, 0, 255)\"}\n            xAxis={xAxis}\n            yAxis={yAxis}\n          />\n        </div>\n      )}\n      {speed && <Prop propKey={`speed`} propValue={`${speed} Kb/sec`} />}\n      {CreatePropsFromData(data)}\n      {children}\n    </div>\n  );\n}\n\nDataPanel.propTypes = {\n  graphData: PropTypes.array,\n  speed: PropTypes.string,\n  data: PropTypes.object,\n  xAxis: PropTypes.string,\n  yAxis: PropTypes.string,\n  title: PropTypes.node,\n  children: PropTypes.node,\n  width: PropTypes.string,\n  height: PropTypes.string,\n  color: PropTypes.string,\n  backgroundColor: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"data-tile\":\"DataPanel__data-tile__aO6Kk\",\"dataTile\":\"DataPanel__data-tile__aO6Kk\",\"data-tile-title\":\"DataPanel__data-tile-title__wcIIC\",\"dataTileTitle\":\"DataPanel__data-tile-title__wcIIC\"};","// extracted by mini-css-extract-plugin\nexport default {\"border-tile\":\"CollapsiblePanel__border-tile__a8dvp\",\"borderTile\":\"CollapsiblePanel__border-tile__a8dvp\",\"borderless-tile\":\"CollapsiblePanel__borderless-tile__bGn8c\",\"borderlessTile\":\"CollapsiblePanel__borderless-tile__bGn8c\",\"rtc-debug-panel-root\":\"CollapsiblePanel__rtc-debug-panel-root__sv8yl\",\"rtcDebugPanelRoot\":\"CollapsiblePanel__rtc-debug-panel-root__sv8yl\",\"rtc-status-container\":\"CollapsiblePanel__rtc-status-container__PEFgl\",\"rtcStatusContainer\":\"CollapsiblePanel__rtc-status-container__PEFgl\",\"status-container-middle\":\"CollapsiblePanel__status-container-middle__sP73q\",\"statusContainerMiddle\":\"CollapsiblePanel__status-container-middle__sP73q\",\"rtc-status-container-right\":\"CollapsiblePanel__rtc-status-container-right__bjrWb\",\"rtcStatusContainerRight\":\"CollapsiblePanel__rtc-status-container-right__bjrWb\",\"rtc-status-container-left\":\"CollapsiblePanel__rtc-status-container-left__r_pIO\",\"rtcStatusContainerLeft\":\"CollapsiblePanel__rtc-status-container-left__r_pIO\",\"rtc-log-container\":\"CollapsiblePanel__rtc-log-container__l_VBn\",\"rtcLogContainer\":\"CollapsiblePanel__rtc-log-container__l_VBn\",\"rtc-log-time\":\"CollapsiblePanel__rtc-log-time__znjRS\",\"rtcLogTime\":\"CollapsiblePanel__rtc-log-time__znjRS\",\"rtc-log-text\":\"CollapsiblePanel__rtc-log-text__YHbuu\",\"rtcLogText\":\"CollapsiblePanel__rtc-log-text__YHbuu\",\"rtc-log-msg\":\"CollapsiblePanel__rtc-log-msg__cMtQV\",\"rtcLogMsg\":\"CollapsiblePanel__rtc-log-msg__cMtQV\",\"rtc-log-tag\":\"CollapsiblePanel__rtc-log-tag__54VIM\",\"rtcLogTag\":\"CollapsiblePanel__rtc-log-tag__54VIM\",\"rtc-log-msg-container\":\"CollapsiblePanel__rtc-log-msg-container__DH5QR\",\"rtcLogMsgContainer\":\"CollapsiblePanel__rtc-log-msg-container__DH5QR\",\"collapse-button\":\"CollapsiblePanel__collapse-button__V1F4E\",\"collapseButton\":\"CollapsiblePanel__collapse-button__V1F4E\",\"log-button\":\"CollapsiblePanel__log-button__lrG2X\",\"logButton\":\"CollapsiblePanel__log-button__lrG2X\",\"collapsible-content\":\"CollapsiblePanel__collapsible-content__fpjed\",\"collapsibleContent\":\"CollapsiblePanel__collapsible-content__fpjed\",\"collapsible-content-root\":\"CollapsiblePanel__collapsible-content-root__RX7yn\",\"collapsibleContentRoot\":\"CollapsiblePanel__collapsible-content-root__RX7yn\",\"collapsible-header\":\"CollapsiblePanel__collapsible-header__ushjh\",\"collapsibleHeader\":\"CollapsiblePanel__collapsible-header__ushjh\",\"collapsible-right-buttons\":\"CollapsiblePanel__collapsible-right-buttons__HwlGL\",\"collapsibleRightButtons\":\"CollapsiblePanel__collapsible-right-buttons__HwlGL\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { CreatePropsFromData } from \"./Prop.js\";\nimport styles from \"./CollapsiblePanel.scss\";\n\nfunction collapse(evt) {\n  evt.target.classList.toggle(\"collapsed\");\n  evt.target.parentElement?.nextSibling?.classList.toggle(\"collapsed\");\n  return evt.target.parentElement?.nextSibling?.classList.contains(\"collapsed\");\n}\n\nfunction openLink(url) {\n  const win = window.open(url, \"_blank\");\n  win.focus();\n}\n\nexport function CollapsiblePanel({\n  title,\n  border,\n  row,\n  wrap,\n  grow,\n  url,\n  isRoot,\n  children,\n  data,\n  collapsed,\n  onCollapse,\n  backgroundColor,\n  clear,\n  download\n}) {\n  const rootClassName = classNames(border ? styles.borderTile : styles.borderlessTile);\n  const rootStyle = {\n    flexGrow: grow ? 1 : 0,\n    backgroundColor\n  };\n  const contentClassName = classNames(\n    isRoot\n      ? `${styles.collapsibleContentRoot} ${(!!collapsed && \"collapsed\") || \"\"}`\n      : `${styles.collapsibleContent} ${(!!collapsed && \"collapsed\") || \"\"}`\n  );\n  const buttonClassName = classNames(`${styles.collapseButton} ${(!!collapsed && \"collapsed\") || \"\"}`);\n  const contentStyle = {\n    flexFlow: (row ? \"row \" : \"column \") + (wrap ? \"wrap\" : \"nowrap\")\n  };\n  return (\n    <div className={rootClassName} style={rootStyle}>\n      <div className={styles.collapsibleHeader}>\n        {title && (\n          <button\n            className={classNames(buttonClassName)}\n            onClick={evt => {\n              const isCollapsed = collapse(evt);\n              onCollapse && onCollapse(title, isCollapsed);\n            }}\n          >\n            {title}\n          </button>\n        )}\n        {url && (\n          <button className={classNames(styles.logButton)} onClick={() => openLink(url)}>\n            ?\n          </button>\n        )}\n        {(clear || download) && (\n          <div className={styles.collapsibleRightButtons}>\n            {download && (\n              <button className={classNames(styles.logButton)} onClick={download}>\n                &#x2193;\n              </button>\n            )}\n            {clear && (\n              <button className={classNames(styles.logButton)} onClick={clear}>\n                &#xd7;\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n      <div className={contentClassName} style={contentStyle}>\n        {CreatePropsFromData(data)}\n        {children}\n      </div>\n    </div>\n  );\n}\n\nCollapsiblePanel.propTypes = {\n  children: PropTypes.node,\n  title: PropTypes.node,\n  border: PropTypes.bool,\n  row: PropTypes.bool,\n  grow: PropTypes.bool,\n  wrap: PropTypes.bool,\n  url: PropTypes.string,\n  isRoot: PropTypes.bool,\n  data: PropTypes.object,\n  collapsed: PropTypes.bool,\n  onCollapse: PropTypes.func,\n  backgroundColor: PropTypes.string,\n  clear: PropTypes.func,\n  download: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"border-tile\":\"RtcDebugPanel__border-tile__AYdEt\",\"borderTile\":\"RtcDebugPanel__border-tile__AYdEt\",\"borderless-tile\":\"RtcDebugPanel__borderless-tile__DhsGP\",\"borderlessTile\":\"RtcDebugPanel__borderless-tile__DhsGP\",\"rtc-debug-panel-root\":\"RtcDebugPanel__rtc-debug-panel-root__ZBgNt\",\"rtcDebugPanelRoot\":\"RtcDebugPanel__rtc-debug-panel-root__ZBgNt\",\"rtc-status-container\":\"RtcDebugPanel__rtc-status-container__yb_6A\",\"rtcStatusContainer\":\"RtcDebugPanel__rtc-status-container__yb_6A\",\"status-container-middle\":\"RtcDebugPanel__status-container-middle__GkH1i\",\"statusContainerMiddle\":\"RtcDebugPanel__status-container-middle__GkH1i\",\"rtc-status-container-right\":\"RtcDebugPanel__rtc-status-container-right__v2TQx\",\"rtcStatusContainerRight\":\"RtcDebugPanel__rtc-status-container-right__v2TQx\",\"rtc-status-container-left\":\"RtcDebugPanel__rtc-status-container-left__i_75b\",\"rtcStatusContainerLeft\":\"RtcDebugPanel__rtc-status-container-left__i_75b\",\"rtc-log-container\":\"RtcDebugPanel__rtc-log-container__adAUM\",\"rtcLogContainer\":\"RtcDebugPanel__rtc-log-container__adAUM\",\"rtc-log-time\":\"RtcDebugPanel__rtc-log-time__JSSve\",\"rtcLogTime\":\"RtcDebugPanel__rtc-log-time__JSSve\",\"rtc-log-text\":\"RtcDebugPanel__rtc-log-text__WPd7j\",\"rtcLogText\":\"RtcDebugPanel__rtc-log-text__WPd7j\",\"rtc-log-msg\":\"RtcDebugPanel__rtc-log-msg__XJZu8\",\"rtcLogMsg\":\"RtcDebugPanel__rtc-log-msg__XJZu8\",\"rtc-log-tag\":\"RtcDebugPanel__rtc-log-tag__Yt0hz\",\"rtcLogTag\":\"RtcDebugPanel__rtc-log-tag__Yt0hz\",\"rtc-log-msg-container\":\"RtcDebugPanel__rtc-log-msg-container___MEx7\",\"rtcLogMsgContainer\":\"RtcDebugPanel__rtc-log-msg-container___MEx7\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgCaretDown = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m3.828 7.424 5.46 6.372a.938.938 0 0 0 1.424 0l5.46-6.372a.938.938 0 0 0-.712-1.548H4.538c-.8 0-1.233.94-.71 1.548Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgCaretDown as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"audio-debug-container\":\"AudioDebugPanel__audio-debug-container__mQfQs\",\"audioDebugContainer\":\"AudioDebugPanel__audio-debug-container__mQfQs\",\"audio-debug-row\":\"AudioDebugPanel__audio-debug-row__GxFlz\",\"audioDebugRow\":\"AudioDebugPanel__audio-debug-row__GxFlz\",\"prop-text\":\"AudioDebugPanel__prop-text__xSaPY\",\"propText\":\"AudioDebugPanel__prop-text__xSaPY\",\"value-text\":\"AudioDebugPanel__value-text__KkK4W\",\"valueText\":\"AudioDebugPanel__value-text__KkK4W\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport classNames from \"classnames\";\nimport styles from \"./SelectInputField.scss\";\nimport { ReactComponent as CaretDownIcon } from \"../icons/CaretDown.svg\";\nimport { useSelect } from \"downshift\";\nimport { FormattedMessage } from \"react-intl\";\n\nfunction getItemValue(item) {\n  return typeof item === \"object\" ? item.value : item;\n}\n\nfunction getSelectedItem(value, options) {\n  const selectedItemValue = getItemValue(value);\n\n  if (options.length > 0 && typeof options[0] === \"object\") {\n    return options.find(item => item.value === selectedItemValue);\n  }\n\n  return selectedItemValue;\n}\n\nfunction getItemLabel(item) {\n  return typeof item === \"object\" ? item.label || item.value : item;\n}\n\nexport function SelectInputField({\n  className,\n  error,\n  description,\n  inputClassName,\n  buttonClassName,\n  label,\n  onChange,\n  value,\n  options,\n  fullWidth,\n  ...rest\n}) {\n  const {\n    isOpen,\n    selectedItem,\n    getToggleButtonProps,\n    getMenuProps,\n    getLabelProps,\n    highlightedIndex,\n    getItemProps\n  } = useSelect({\n    items: options,\n    selectedItem: getSelectedItem(value, options),\n    ...rest,\n    onSelectedItemChange: ({ selectedItem }) => {\n      if (onChange) {\n        onChange(getItemValue(selectedItem));\n      }\n    }\n  });\n\n  const selectedItemLabel = getItemLabel(selectedItem);\n\n  return (\n    <InputField\n      {...getLabelProps()}\n      className={className}\n      label={label}\n      error={error}\n      description={description}\n      fullWidth={fullWidth}\n    >\n      <div className={classNames(styles.selectInput, { [styles.open]: isOpen }, inputClassName)}>\n        <button\n          className={classNames(styles.dropdownButton, buttonClassName)}\n          type=\"button\"\n          {...getToggleButtonProps()}\n        >\n          <span>\n            {selectedItemLabel !== undefined ? (\n              selectedItemLabel\n            ) : (\n              <FormattedMessage id=\"select-input-field.placeholder\" defaultMessage=\"Select...\" />\n            )}\n          </span>\n          <CaretDownIcon />\n        </button>\n        {options.length > 0 && (\n          <ul {...getMenuProps()} className={styles.dropdown}>\n            {isOpen &&\n              options.map((item, index) => (\n                <li\n                  className={classNames(styles.dropdownItem, { [styles.highlightedItem]: highlightedIndex === index })}\n                  key={getItemValue(item)}\n                  {...getItemProps({ item, index })}\n                >\n                  {getItemLabel(item)}\n                </li>\n              ))}\n          </ul>\n        )}\n      </div>\n    </InputField>\n  );\n}\n\nSelectInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  buttonClassName: PropTypes.string,\n  value: PropTypes.any,\n  options: PropTypes.arrayOf(\n    PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.number,\n      PropTypes.shape({\n        // id: PropTypes.string.isRequired,\n        label: PropTypes.string,\n        value: PropTypes.any.isRequired\n      })\n    ])\n  ).isRequired,\n  onChange: PropTypes.func,\n  fullWidth: PropTypes.bool\n};\n\nSelectInputField.defaultProps = {\n  options: []\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"select-input\":\"SelectInputField__select-input__Q9wMN\",\"selectInput\":\"SelectInputField__select-input__Q9wMN\",\"dropdown-button\":\"SelectInputField__dropdown-button__E2fNK\",\"dropdownButton\":\"SelectInputField__dropdown-button__E2fNK\",\"dropdown\":\"SelectInputField__dropdown__wN7x4\",\"open\":\"SelectInputField__open__B7Ur0\",\"dropdown-item\":\"SelectInputField__dropdown-item__lLzp4\",\"dropdownItem\":\"SelectInputField__dropdown-item__lLzp4\",\"highlighted-item\":\"SelectInputField__highlighted-item__BhcUo\",\"highlightedItem\":\"SelectInputField__highlighted-item__BhcUo\"};","import React, { useCallback, useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport styles from \"./AudioDebugPanel.scss\";\nimport { CollapsiblePanel } from \".//CollapsiblePanel\";\nimport classNames from \"classnames\";\nimport {\n  CLIPPING_THRESHOLD_MIN,\n  CLIPPING_THRESHOLD_MAX,\n  CLIPPING_THRESHOLD_STEP,\n  GLOBAL_VOLUME_MIN,\n  GLOBAL_VOLUME_MAX,\n  GLOBAL_VOLUME_STEP\n} from \"../../react-components/preferences-screen\";\nimport { SelectInputField } from \"../input/SelectInputField\";\nimport { DISTANCE_MODEL_OPTIONS, DistanceModelType, SourceType } from \"../../components/audio-params\";\nimport { getCurrentAudioSettingsForSourceType, updateAudioSettings } from \"../../update-audio-settings\";\n\nconst ROLLOFF_MIN = 0.0;\nconst ROLLOFF_MAX = 20.0;\nconst ROLLOFF_STEP = 0.5;\nconst ROLLOFF_LIN_MIN = 0.0;\nconst ROLLOFF_LIN_MAX = 1.0;\nconst ROLLOFF_LIN_STEP = 0.01;\nconst DISTANCE_MIN = 1.0;\nconst DISTANCE_MAX = 100.0;\nconst DISTANCE_STEP = 1.0;\nconst ANGLE_MIN = 0.0;\nconst ANGLE_MAX = 360.0;\nconst ANGLE_STEP = 1.0;\nconst GAIN_MIN = 0.0;\nconst GAIN_MAX = 1.0;\nconst GAIN_STEP = 0.1;\n\nfunction SelectProperty({ defaultValue, options, onChange, children }) {\n  const [value, setValue] = useState(defaultValue);\n  return (\n    <div className={classNames(styles.audioDebugRow)}>\n      <span style={{ flex: \"none\", padEnd: \"10px\" }}>{children}</span>\n      <SelectInputField\n        value={value}\n        options={options}\n        onChange={newValue => {\n          setValue(newValue);\n          onChange(newValue);\n        }}\n      />\n    </div>\n  );\n}\n\nSelectProperty.propTypes = {\n  defaultValue: PropTypes.string,\n  options: PropTypes.array,\n  onChange: PropTypes.func,\n  children: PropTypes.node\n};\n\nfunction SliderProperty({ defaultValue, step, min, max, onChange, children }) {\n  return (\n    <div className={classNames(styles.audioDebugRow)}>\n      <span style={{ flex: \"none\", padEnd: \"10px\" }}>{children}</span>\n      <input\n        type=\"range\"\n        step={step}\n        min={min}\n        max={max}\n        value={defaultValue}\n        onChange={e => {\n          const parsedValue = parseFloat(e.target.value);\n          onChange(parsedValue);\n        }}\n      />\n      <span className={classNames(styles.valueText)}>{defaultValue}</span>\n    </div>\n  );\n}\n\nSliderProperty.propTypes = {\n  defaultValue: PropTypes.number,\n  step: PropTypes.number,\n  min: PropTypes.number,\n  max: PropTypes.number,\n  onChange: PropTypes.func,\n  children: PropTypes.node\n};\n\nfunction getPrefs() {\n  return {\n    enableAudioClipping: APP.store.state.preferences.enableAudioClipping,\n    audioClippingThreshold: APP.store.state.preferences.audioClippingThreshold,\n    globalVoiceVolume: APP.store.state.preferences.globalVoiceVolume,\n    globalMediaVolume: APP.store.state.preferences.globalMediaVolume,\n    globalSFXVolume: APP.store.state.preferences.globalSFXVolume\n  };\n}\n\nexport function AudioDebugPanel({ isNarrow, collapsed, onCollapsed }) {\n  const [mediaSettings, setMediaSettings] = useState(getCurrentAudioSettingsForSourceType(SourceType.MEDIA_VIDEO));\n  const [avatarSettings, setAvatarSettings] = useState(\n    getCurrentAudioSettingsForSourceType(SourceType.AVATAR_AUDIO_SOURCE)\n  );\n\n  const onSettingChange = (sourceType, newSetting) => {\n    const settings = Object.assign({}, APP.audioDebugPanelOverrides.get(sourceType), newSetting);\n    APP.audioDebugPanelOverrides.set(sourceType, settings);\n    if (sourceType === SourceType.MEDIA_VIDEO) {\n      setMediaSettings(getCurrentAudioSettingsForSourceType(SourceType.MEDIA_VIDEO));\n    } else {\n      setAvatarSettings(getCurrentAudioSettingsForSourceType(SourceType.AVATAR_AUDIO_SOURCE));\n    }\n    for (const [el, audio] of APP.audios.entries()) {\n      updateAudioSettings(el, audio);\n    }\n  };\n\n  const [preferences, setPreferences] = useState(getPrefs());\n  const onPreferencesUpdated = useCallback(\n    () => {\n      setPreferences(getPrefs());\n    },\n    [setPreferences]\n  );\n  useEffect(\n    () => {\n      onPreferencesUpdated();\n      APP.store.addEventListener(\"statechanged\", onPreferencesUpdated);\n      return () => {\n        APP.store.removeEventListener(\"statechanged\", onPreferencesUpdated);\n        APP.audioDebugPanelOverrides.delete(SourceType.MEDIA_VIDEO);\n        APP.audioDebugPanelOverrides.delete(SourceType.AVATAR_AUDIO_SOURCE);\n        for (const [el, audio] of APP.audios.entries()) {\n          updateAudioSettings(el, audio);\n        }\n      };\n    },\n    [onPreferencesUpdated]\n  );\n\n  return (\n    <div\n      className={classNames(styles.audioDebugContainer)}\n      style={{\n        height: isNarrow && !collapsed && \"80%\",\n        maxHeight: isNarrow && !collapsed && \"80%\"\n      }}\n    >\n      <CollapsiblePanel\n        title={<FormattedMessage id=\"audio-debug-panel.audio-debug-title\" defaultMessage=\"Audio Debug\" />}\n        isRoot\n        border\n        collapsed={collapsed}\n        onCollapse={onCollapsed}\n      >\n        <CollapsiblePanel\n          title={<FormattedMessage id=\"audio-debug-panel.audio-debug-global-title\" defaultMessage=\"Globals\" />}\n          border\n          grow\n        >\n          <div style={{ display: \"flex\", alignItems: \"center\" }}>\n            <input\n              tabIndex=\"0\"\n              type=\"checkbox\"\n              checked={preferences.enableAudioClipping}\n              onChange={() => {\n                APP.store.update({\n                  preferences: {\n                    enableAudioClipping: !preferences.enableAudioClipping\n                  }\n                });\n              }}\n              style={{ marginLeft: \"10px\" }}\n            />\n            <SliderProperty\n              defaultValue={preferences.audioClippingThreshold}\n              step={CLIPPING_THRESHOLD_STEP}\n              min={CLIPPING_THRESHOLD_MIN}\n              max={CLIPPING_THRESHOLD_MAX}\n              onChange={value => {\n                APP.store.update({\n                  preferences: {\n                    audioClippingThreshold: value\n                  }\n                });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.global.clippingThreshold\" defaultMessage=\"Clipping\" />\n              </p>\n            </SliderProperty>\n          </div>\n          <SliderProperty\n            defaultValue={preferences.globalVoiceVolume}\n            step={GLOBAL_VOLUME_STEP}\n            min={GLOBAL_VOLUME_MIN}\n            max={GLOBAL_VOLUME_MAX}\n            onChange={value => {\n              APP.store.update({\n                preferences: {\n                  globalVoiceVolume: value\n                }\n              });\n            }}\n          >\n            <p className={classNames(styles.propText)}>\n              <FormattedMessage id=\"audio-debug-view.global.voiceVolume\" defaultMessage=\"Voice Volume\" />\n            </p>\n          </SliderProperty>\n          <SliderProperty\n            defaultValue={preferences.globalMediaVolume}\n            step={GLOBAL_VOLUME_STEP}\n            min={GLOBAL_VOLUME_MIN}\n            max={GLOBAL_VOLUME_MAX}\n            onChange={value => {\n              APP.store.update({\n                preferences: {\n                  globalMediaVolume: value\n                }\n              });\n            }}\n          >\n            <p className={classNames(styles.propText)}>\n              <FormattedMessage id=\"audio-debug-view.global.mediaVolume\" defaultMessage=\"Media Volume\" />\n            </p>\n          </SliderProperty>\n          <SliderProperty\n            defaultValue={preferences.globalSFXVolume}\n            step={GLOBAL_VOLUME_STEP}\n            min={GLOBAL_VOLUME_MIN}\n            max={GLOBAL_VOLUME_MAX}\n            onChange={value => {\n              APP.store.update({\n                preferences: {\n                  globalSFXVolume: value\n                }\n              });\n            }}\n          >\n            <p className={classNames(styles.propText)}>\n              <FormattedMessage id=\"audio-debug-view.global.sfxVolume\" defaultMessage=\"SFX Volume\" />\n            </p>\n          </SliderProperty>\n        </CollapsiblePanel>\n        <div style={{ display: \"flex\" }}>\n          <CollapsiblePanel\n            title={<FormattedMessage id=\"audio-debug-panel.audio-debug-avatar-title\" defaultMessage=\"Avatar\" />}\n            border\n            grow\n          >\n            <SelectProperty\n              defaultValue={avatarSettings.distanceModel}\n              options={DISTANCE_MODEL_OPTIONS}\n              onChange={value => {\n                const newSetting = { distanceModel: value };\n                if (value === DistanceModelType.Linear && avatarSettings.rolloffFactor > 1.0) {\n                  newSetting.rolloffFactor = 1.0;\n                }\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, newSetting);\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.distanceModel\" defaultMessage=\"Distance Model\" />\n              </p>\n            </SelectProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.rolloffFactor}\n              step={avatarSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_STEP : ROLLOFF_STEP}\n              min={avatarSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MIN : ROLLOFF_MIN}\n              max={avatarSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MAX : ROLLOFF_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { rolloffFactor: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.rolloffFactor\" defaultMessage=\"Rolloff\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.refDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { refDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.refDistance\" defaultMessage=\"Ref Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.maxDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { maxDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.maxDistance\" defaultMessage=\"Max Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.coneInnerAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { coneInnerAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.innerAngle\" defaultMessage=\"Inner Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.coneOuterAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { coneOuterAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.outerAngle\" defaultMessage=\"Outer Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={avatarSettings.coneOuterGain}\n              step={GAIN_STEP}\n              min={GAIN_MIN}\n              max={GAIN_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.AVATAR_AUDIO_SOURCE, { coneOuterGain: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.avatar.outerGain\" defaultMessage=\"Outer Gain\" />\n              </p>\n            </SliderProperty>\n          </CollapsiblePanel>\n          <CollapsiblePanel\n            title={<FormattedMessage id=\"audio-debug-panel.audio-debug-media-title\" defaultMessage=\"Media\" />}\n            border\n            grow\n          >\n            <SelectProperty\n              defaultValue={mediaSettings.distanceModel}\n              options={DISTANCE_MODEL_OPTIONS}\n              onChange={value => {\n                const newSetting = { distanceModel: value };\n                if (value === DistanceModelType.Linear && mediaSettings.rolloffFactor > 1.0) {\n                  newSetting.rolloffFactor = 1.0;\n                }\n                onSettingChange(SourceType.MEDIA_VIDEO, newSetting);\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.distanceModel\" defaultMessage=\"Distance Model\" />\n              </p>\n            </SelectProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.rolloffFactor}\n              step={mediaSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_STEP : ROLLOFF_STEP}\n              min={mediaSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MIN : ROLLOFF_MIN}\n              max={mediaSettings.distanceModel === DistanceModelType.Linear ? ROLLOFF_LIN_MAX : ROLLOFF_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { rolloffFactor: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.rolloffFactor\" defaultMessage=\"Rolloff\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.refDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { refDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.refDistance\" defaultMessage=\"Ref Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.maxDistance}\n              step={DISTANCE_STEP}\n              min={DISTANCE_MIN}\n              max={DISTANCE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { maxDistance: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.maxDistance\" defaultMessage=\"Max Distance\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.coneInnerAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { coneInnerAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.innerAngle\" defaultMessage=\"Inner Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.coneOuterAngle}\n              step={ANGLE_STEP}\n              min={ANGLE_MIN}\n              max={ANGLE_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { coneOuterAngle: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.outerAngle\" defaultMessage=\"Outer Angle\" />\n              </p>\n            </SliderProperty>\n            <SliderProperty\n              defaultValue={mediaSettings.coneOuterGain}\n              step={GAIN_STEP}\n              min={GAIN_MIN}\n              max={GAIN_MAX}\n              onChange={value => {\n                onSettingChange(SourceType.MEDIA_VIDEO, { coneOuterGain: value });\n              }}\n            >\n              <p className={classNames(styles.propText)}>\n                <FormattedMessage id=\"audio-debug-view.media.outerGain\" defaultMessage=\"Outer Gain\" />\n              </p>\n            </SliderProperty>\n          </CollapsiblePanel>\n        </div>\n      </CollapsiblePanel>\n    </div>\n  );\n}\n\nAudioDebugPanel.propTypes = {\n  isNarrow: PropTypes.bool,\n  collapsed: PropTypes.bool,\n  onCollapsed: PropTypes.func,\n  children: PropTypes.node\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { DataPanel } from \"./DataPanel.js\";\nimport { CollapsiblePanel } from \"./CollapsiblePanel.js\";\nimport { Button } from \"../input/Button.js\";\nimport styles from \"./RtcDebugPanel.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport { AudioDebugPanel } from \"./AudioDebugPanel\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nconst TransportType = {\n  SEND: \"send_transport\",\n  RECEIVE: \"receive_transport\"\n};\n\nconst StatsType = {\n  INBOUND_RTP: \"inbound-rtp\",\n  OUTBOUND_RTP: \"outbound-rtp\",\n  LOCAL_CANDIDATE: \"local-candidate\",\n  REMOTE_CANDIDATE: \"remote-candidate\",\n  CANDIDATE_PAIR: \"candidate-pair\",\n  TRANSPORT: \"transport\"\n};\n\nconst ERROR_COLOR = \"#8b1c00\";\nconst STATS_REFRESH_TIME = 2000;\nconst PRODUCERS_KEY = \"producers\";\nconst CONSUMERS_KEY = \"consumers\";\nconst MEDIASOUP_DOC_BASE_URL = \"https://mediasoup.org/documentation/v3/libmediasoupclient/api/\";\nconst MDN_DOC_BASE_URL = \"https://developer.mozilla.org/en-US/docs/Web/API/\";\n\nconst MessageButtonStyle = {\n  width: \"auto\",\n  alignSelf: \"center\",\n  margin: \"5px\",\n  padding: \"4px 18px\",\n  fontSize: \"12px\",\n  minWidth: \"120px\"\n};\n\nconst isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\n\nfunction capitalize(str) {\n  return str ? str.replace(/\\b\\w/g, c => c.toUpperCase()) : \"\";\n}\n\nfunction download(filename, text) {\n  const element = document.createElement(\"a\");\n  element.setAttribute(\"href\", \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text));\n  element.setAttribute(\"download\", filename);\n\n  element.style.display = \"none\";\n  document.body.appendChild(element);\n\n  element.click();\n\n  document.body.removeChild(element);\n}\n\nexport function PanelMessageButton({ children, ...rest }) {\n  return (\n    <Button {...rest} style={MessageButtonStyle}>\n      {children}\n    </Button>\n  );\n}\n\nPanelMessageButton.propTypes = {\n  children: PropTypes.node\n};\n\nfunction TrackStatsPanel({ title, data, xAxis, yAxis, stats }) {\n  const props = {\n    id: data.id,\n    opened: data.opened,\n    paused: data.paused,\n    kind: data.kind,\n    codec: data.codec\n  };\n  if (data.kind === \"video\") {\n    (data.spatialLayer !== undefined || data.temporalLayer !== undefined) &&\n      (props[\"currentLayers\"] = `S[${data.spatialLayer}] T[${data.temporalLayer}]`);\n    data.score != undefined &&\n      (props[\"score\"] = `S[${data.score?.score}] P[${data.score?.producerScore}][${data.score?.producerScores}]`);\n    data.frameRate != undefined && (props[\"frameRate\"] = `${data.frameRate}`);\n    data.width != undefined && (props[\"width\"] = `${data.width}`);\n    data.height != undefined && (props[\"height\"] = `${data.height}`);\n  }\n\n  const backgroundColor = !data.opened || !stats?.speed ? ERROR_COLOR : null;\n  return (\n    <DataPanel title={title} data={props} backgroundColor={backgroundColor}>\n      {data?.track && (\n        <DataPanel\n          key={data.id}\n          data={data.track}\n          title={<FormattedMessage id=\"rtc-debug-panel.track-panel-title\" defaultMessage=\"Track\" />}\n        />\n      )}\n      {stats && (\n        <DataPanel\n          key={stats.rtpStats?.id}\n          graphData={stats.graph.slice()}\n          width={\"120px\"}\n          height={\"50px\"}\n          color={\"green\"}\n          speed={stats.speed}\n          data={stats.rtpStats}\n          xAxis={xAxis}\n          yAxis={yAxis}\n          title={<FormattedMessage id=\"rtc-debug-panel.stats-panel-title\" defaultMessage=\"Stats\" />}\n        />\n      )}\n    </DataPanel>\n  );\n}\n\nTrackStatsPanel.propTypes = {\n  title: PropTypes.node,\n  data: PropTypes.object,\n  xAxis: PropTypes.string,\n  yAxis: PropTypes.string,\n  stats: PropTypes.object,\n  backgroundColor: PropTypes.string\n};\n\nfunction TransportPanel({ title, data, candidates, producers, consumers, isButtonEnabled, onRestart }) {\n  const error = producers?.some(producer => {\n    return !producer.props?.data?.opened || !producer.props?.stats?.speed;\n  });\n  const backgroundColor = error ? ERROR_COLOR : null;\n  return (\n    <CollapsiblePanel key={title} title={title} border url={`${MEDIASOUP_DOC_BASE_URL}#Transport`} data={data}>\n      <PanelMessageButton onClick={onRestart} disabled={!isButtonEnabled} preset=\"accept\">\n        <FormattedMessage id=\"rtc-debug-panel.restart-ice-button\" defaultMessage=\"Restart ICE\" />\n      </PanelMessageButton>\n      <CollapsiblePanel\n        key={`Candidates`}\n        title={<FormattedMessage id=\"rtc-debug-panel.local-candidates-panel-title\" defaultMessage=\"Candidates\" />}\n        row\n        url={`${MDN_DOC_BASE_URL}RTCIceCandidate`}\n        border\n        backgroundColor={candidates?.length === 0 && data?.state === \"connected\" && data?.opened ? ERROR_COLOR : null}\n      >\n        {(candidates?.length && candidates) || (\n          <p className={classNames(styles.rtcLogMsg)}>\n            <FormattedMessage id=\"rtc-debug-panel.local-no-candidates-message\" defaultMessage=\"No Candidates\" />\n          </p>\n        )}\n      </CollapsiblePanel>\n      {(producers?.length && (\n        <CollapsiblePanel\n          key={`Local producers`}\n          title={<FormattedMessage id=\"rtc-debug-panel.local-producers-panel-title\" defaultMessage=\"Local Producers\" />}\n          row\n          url={`${MEDIASOUP_DOC_BASE_URL}#Producer`}\n          border\n          collapsed\n          backgroundColor={backgroundColor}\n        >\n          {producers}\n        </CollapsiblePanel>\n      )) ||\n        null}\n      {consumers || null}\n    </CollapsiblePanel>\n  );\n}\n\nTransportPanel.propTypes = {\n  candidates: PropTypes.array,\n  producers: PropTypes.array,\n  consumers: PropTypes.array,\n  data: PropTypes.object,\n  onRestart: PropTypes.func,\n  title: PropTypes.node,\n  isButtonEnabled: PropTypes.bool\n};\n\nfunction SignalingPanel({ data, onConnect, onDisconnect }) {\n  return (\n    <CollapsiblePanel\n      title={<FormattedMessage id=\"rtc-debug-panel.signaling-panel-title\" defaultMessage=\"Signaling\" />}\n      border\n      data={data}\n    >\n      <PanelMessageButton\n        onClick={() => {\n          if (data.connected) {\n            onDisconnect();\n          } else {\n            onConnect();\n          }\n        }}\n        disabled={false}\n        preset=\"accept\"\n      >\n        {data.connected ? (\n          <FormattedMessage id=\"rtc-debug-panel.disconnect-signaling-button\" defaultMessage=\"Disconnect\" />\n        ) : (\n          <FormattedMessage id=\"rtc-debug-panel.connect-signaling-button\" defaultMessage=\"Connect\" />\n        )}\n      </PanelMessageButton>\n    </CollapsiblePanel>\n  );\n}\n\nSignalingPanel.propTypes = {\n  data: PropTypes.object,\n  onConnect: PropTypes.func,\n  onDisconnect: PropTypes.func\n};\n\nexport default class RtcDebugPanel extends Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    store: PropTypes.object,\n    scene: PropTypes.object,\n    intl: PropTypes.object,\n    presences: PropTypes.object,\n    history: PropTypes.object,\n    sessionId: PropTypes.string,\n    showRtcDebug: PropTypes.bool,\n    showAudioDebug: PropTypes.bool\n  };\n\n  constructor() {\n    super();\n\n    this.state = {\n      log: [],\n      collapsed: { Local: false, Log: isMobile, Remote: true, Audio: true }\n    };\n  }\n\n  componentDidMount() {\n    this.props.scene.addEventListener(\"rtc_event\", this.logEvent);\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.runStats(true);\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"rtc_event\", this.logEvent);\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.runStats(false);\n  }\n\n  logEvent = e => {\n    const currentLog = this.state.log.slice(-200) || [];\n    currentLog.push(e.detail);\n    this.setState({\n      log: currentLog\n    });\n  };\n\n  storeUpdated = () => {\n    const showPanel = this.props.store.state.preferences.showRtcDebugPanel;\n    this.setState({ showPanel: showPanel });\n  };\n\n  getDeviceData() {\n    let result = {};\n    const device = APP.dialog._mediasoupDevice;\n    if (device) {\n      result[\"loaded\"] = !device._closed ? true : false;\n      result[\"codecs\"] = device._recvRtpCapabilities?.codecs.map(\n        codec => \"[\" + codec.mimeType + \"/\" + codec.clockRate + \"]\"\n      );\n      result = {\n        ...result,\n        ...APP.dialog.downlinkBwe\n      };\n    }\n    return result;\n  }\n\n  async getCandidatesData(peer) {\n    const result = {};\n    const stats = await peer.getStats();\n    let selectedCandidatePairId = null;\n    if (!isFirefox) {\n      for (const data of stats.values()) {\n        if (data[\"type\"] === StatsType.TRANSPORT) {\n          selectedCandidatePairId = data[\"selectedCandidatePairId\"];\n        }\n      }\n    }\n    for (const data of stats.values()) {\n      if (data[\"type\"] === StatsType.CANDIDATE_PAIR) {\n        const candidatePair = data;\n        let isCandidate = false;\n        if (isFirefox) {\n          isCandidate = candidatePair && candidatePair[\"selected\"] && candidatePair[\"state\"] === \"succeeded\";\n        } else {\n          isCandidate = candidatePair[\"id\"] === selectedCandidatePairId;\n        }\n        if (isCandidate) {\n          for (const values of stats.values()) {\n            if (candidatePair[\"localCandidateId\"] === values[\"id\"]) {\n              result[StatsType.LOCAL_CANDIDATE] = values;\n            } else if (candidatePair[\"remoteCandidateId\"] === values[\"id\"]) {\n              result[StatsType.REMOTE_CANDIDATE] = values;\n            }\n          }\n        }\n      }\n    }\n    return result;\n  }\n\n  async getTransportData(type) {\n    const result = {};\n    let transport;\n    if (type === TransportType.SEND) {\n      transport = APP.dialog._sendTransport;\n    } else if (type === TransportType.RECEIVE) {\n      transport = APP.dialog._recvTransport;\n    }\n    const opened = (transport && !transport._closed && true) || false;\n    result[\"opened\"] = opened;\n    if (transport) {\n      result[\"state\"] = opened ? transport._connectionState : \"closed\";\n      result[\"id\"] = transport._id;\n      result[PRODUCERS_KEY] = [];\n      result[CONSUMERS_KEY] = [];\n      transport._producers.forEach(producer => {\n        result[PRODUCERS_KEY].push(this.getProducerConsumerData(producer));\n      });\n      transport._consumers.forEach(consumer => {\n        result[CONSUMERS_KEY].push(this.getProducerConsumerData(consumer));\n      });\n      opened && (result[\"candidates\"] = await this.getCandidatesData(transport));\n    }\n    return result;\n  }\n\n  profileFromPresence([, data]) {\n    const meta = data.metas[data.metas.length - 1];\n    return meta.profile;\n  }\n\n  profileFromConsumer(consumer) {\n    return Object.entries(this.props.presences || {})\n      .filter(([k]) => k === consumer._appData.peerId)\n      .map(this.profileFromPresence)\n      .shift();\n  }\n\n  getProducerConsumerData(peer) {\n    const result = {};\n    result[\"opened\"] = !peer._closed;\n    if (peer) {\n      const profile = Object.entries(this.props.presences || {})\n        .filter(([k]) => k === peer._appData.peerId)\n        .map(this.profileFromPresence)\n        .shift();\n      result[\"id\"] = peer._id;\n      result[\"paused\"] = peer._paused;\n      result[\"track\"] = this.getTrackData(peer);\n      result[\"kind\"] = peer._kind || result[\"track\"].kind;\n      result[\"codec\"] = peer.rtpParameters.codecs[0].mimeType.split(\"/\")[1];\n      result[\"name\"] = profile ? profile.displayName : \"N/A\";\n      result[\"peerId\"] = peer._appData.peerId;\n\n      const stats = APP.dialog.consumerStats[peer._id];\n      if (result[\"kind\"] === \"video\" && stats) {\n        result[\"spatialLayer\"] = stats[\"spatialLayer\"];\n        result[\"temporalLayer\"] = stats[\"temporalLayer\"];\n        result[\"score\"] = stats[\"score\"];\n      }\n    }\n    return result;\n  }\n\n  getTrackData(owner) {\n    const result = {};\n    result[\"id\"] = owner._track.id;\n    result[\"enabled\"] = (owner._track !== null && owner._track.enabled && true) || false;\n    result[\"kind\"] = owner._track.kind;\n    result[\"muted\"] = owner._track.muted;\n    result[\"state\"] = owner._track.readyState;\n    return result;\n  }\n\n  getSignalingData() {\n    return { connected: APP.dialog._protoo && APP.dialog._protoo.connected };\n  }\n\n  async getServerData() {\n    return await APP.dialog.getServerStats();\n  }\n\n  async getRtpStatsData(peer, type) {\n    const result = {};\n    const stats = await peer.getStats();\n    for (const data of stats.values()) {\n      if (data[\"type\"] === type) {\n        return data;\n      }\n    }\n    return result;\n  }\n\n  getGraphData(id, stats) {\n    let lastStats = this.state.statsData?.[id]?.last;\n    const bytesSent = stats?.bytesSent || 0;\n    const bytesReceived = stats?.bytesReceived || 0;\n    const packetsSent = stats?.packetsSent || 0;\n    const packetsReceived = stats?.packetsReceived || 0;\n    const timestamp = stats?.timestamp || 0;\n    const bytesSentDelta = bytesSent - lastStats?.bytesSent || 0;\n    const bytesReceivedDelta = bytesReceived - lastStats?.bytesReceived || 0;\n    const packetsSentDelta = packetsSent - lastStats?.packetsSent || 0;\n    const packetsReceivedDelta = packetsReceived - lastStats?.packetsReceived || 0;\n    const timeDelta = timestamp - lastStats?.timestamp || 0;\n    let graphData = this.state.statsData?.[id]?.graph;\n    if (!graphData) {\n      const data = new Array(20);\n      data.fill({\n        bytesSent: 0,\n        bytesReceived: 0,\n        packetsSent: 0,\n        packetsReceived: 0,\n        timeDelta: 0\n      });\n      graphData = data;\n    }\n    graphData.shift();\n    graphData.push({\n      bytesSent: bytesSentDelta,\n      bytesReceived: bytesReceivedDelta,\n      packetsSent: packetsSentDelta,\n      packetsReceived: packetsReceivedDelta,\n      timeDelta: timeDelta\n    });\n    lastStats = {\n      bytesSent,\n      bytesReceived,\n      packetsSent,\n      packetsReceived,\n      timestamp\n    };\n    return {\n      lastStats: lastStats,\n      graphData: graphData\n    };\n  }\n\n  /**\n   * @param {string} id Peer id.\n   * @param {string} key Stats key to use for generating the speed value.\n   */\n  getPeerSpeed(id, key) {\n    let speed = \"0.00\";\n    const graphData = this.state.statsData?.[id]?.graph;\n    if (graphData) {\n      const lastData = graphData[graphData.length - 1];\n      if (lastData) {\n        speed = ((lastData[key] / 1024) * (1 / (lastData.timeDelta / 1000)) || 0).toFixed(2);\n      }\n    }\n\n    return speed;\n  }\n\n  /**\n   * Starts/stops the execution of a perioding data updating task. Every time this is executed all the debugging panel data is\n   * gathered and the component state is updated to reflect the new data.\n   * @param {bool} running Sets the running state for this task, true starts the tas, false stops it.\n   */\n  async runStats(running) {\n    if (running && this.state) {\n      const taskId = setInterval(() => {\n        (async () => {\n          try {\n            const deviceData = this.getDeviceData();\n            const serverData = this.state.collapsed.Remote ? {} : await this.getServerData();\n            const signalingData = this.getSignalingData();\n\n            // Tranports data\n            const transportsData = {};\n            transportsData[TransportType.SEND] = await this.getTransportData(TransportType.SEND);\n            transportsData[TransportType.RECEIVE] = await this.getTransportData(TransportType.RECEIVE);\n\n            // Populate graph, speed and stats data\n            const statsData = {};\n            if (APP.dialog._micProducer) {\n              const id = APP.dialog._micProducer.id;\n              const peer = APP.dialog._micProducer;\n              const speedData = this.getPeerSpeed(id, \"bytesSent\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.OUTBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n            if (APP.dialog._cameraProducer) {\n              const id = APP.dialog._cameraProducer.id;\n              const peer = APP.dialog._cameraProducer;\n              const speedData = this.getPeerSpeed(id, \"bytesSent\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.OUTBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n            if (APP.dialog._shareProducer) {\n              const id = APP.dialog._shareProducer.id;\n              const peer = APP.dialog._shareProducer;\n              const speedData = this.getPeerSpeed(id, \"bytesSent\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.OUTBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n            for (const consumer of APP.dialog._consumers) {\n              const id = consumer[0];\n              const peer = consumer[1];\n              const speedData = this.getPeerSpeed(id, \"bytesReceived\");\n              const rtpStatsData = await this.getRtpStatsData(peer, StatsType.INBOUND_RTP);\n              const { lastStats, graphData } = this.getGraphData(id, rtpStatsData);\n              statsData[id] = {};\n              statsData[id][\"speed\"] = speedData;\n              statsData[id][\"graph\"] = graphData;\n              statsData[id][\"last\"] = lastStats;\n              statsData[id][\"rtpStats\"] = rtpStatsData;\n            }\n\n            // Update state\n            this.setState({\n              signalingData,\n              serverData,\n              deviceData,\n              statsData,\n              transportsData\n            });\n          } catch (e) {\n            console.log(`Run Stats error: ${e}`);\n          }\n        })();\n      }, STATS_REFRESH_TIME);\n      this.setState({ taskId: taskId });\n    } else {\n      clearInterval(this.state.taskId);\n    }\n  }\n\n  restartSendICE = () => {\n    APP.dialog.restartSendICE();\n  };\n\n  restartRecvICE = () => {\n    APP.dialog.restartRecvICE();\n  };\n\n  connectSignaling = () => {\n    APP.dialog.connect({\n      serverUrl: APP.dialog._serverUrl,\n      roomId: APP.dialog._roomId,\n      joinToken: APP.hubChannel.token,\n      serverParams: APP.dialog._serverParams,\n      scene: APP.dialog.scene,\n      clientId: APP.dialog._clientId,\n      forceTcp: APP.dialog._forceTcp,\n      forceTurn: APP.dialog._forceTurn,\n      iceTransportPolicy: APP.dialog._iceTransportPolicy\n    });\n  };\n\n  disconnectSignaling = () => {\n    APP.dialog.disconnect();\n  };\n\n  colorForLevel = level => {\n    switch (level) {\n      case \"error\":\n        return \"red\";\n      case \"warn\":\n        return \"orange\";\n      default:\n        return \"white\";\n    }\n  };\n\n  createLogMsgs = () => {\n    const logLines = [];\n    this.state.log\n      ?.slice()\n      .reverse()\n      .forEach((log, index) => {\n        logLines.push(<span key={index << 2} className={classNames(styles.rtcLogTime)}>{`[${log.time}] `}</span>);\n        logLines.push(\n          <span key={(index << 2) | 0x01} className={classNames(styles.rtcLogTag)}>{`[${log.tag}] `}</span>\n        );\n        logLines.push(\n          <span\n            key={(index << 2) | 0x02}\n            className={classNames(styles.rtcLogMsg)}\n            style={{ color: this.colorForLevel(log.level) }}\n          >\n            {log.msg}\n          </span>\n        );\n        logLines.push(<br key={(index << 2) | 0x03} />);\n      });\n    return logLines;\n  };\n\n  createLog = () => {\n    const logLines = [];\n    this.state.log\n      ?.slice()\n      .reverse()\n      .forEach(log => {\n        logLines.push(`[${log.time}] [${log.tag}] ${log.msg}`);\n      });\n    return logLines.join(\"\\r\");\n  };\n\n  createCandidates(candidates) {\n    const components = [];\n    if (candidates) {\n      candidates[StatsType.LOCAL_CANDIDATE] &&\n        components.push(\n          <DataPanel\n            key={StatsType.LOCAL_CANDIDATE}\n            data={candidates[StatsType.LOCAL_CANDIDATE]}\n            title={\n              <FormattedMessage id=\"rtc-debug-panel.local-candidate-panel-title\" defaultMessage=\"Local Candidate\" />\n            }\n          />\n        );\n      candidates[StatsType.REMOTE_CANDIDATE] &&\n        components.push(\n          <DataPanel\n            key={StatsType.REMOTE_CANDIDATE}\n            data={candidates[StatsType.REMOTE_CANDIDATE]}\n            title={\n              <FormattedMessage id=\"rtc-debug-panel.remote-candidate-panel-title\" defaultMessage=\"Remote Candidate\" />\n            }\n          />\n        );\n    }\n    return components;\n  }\n\n  createProducers(producers = [], stats) {\n    return producers.map(producer => {\n      return (\n        <TrackStatsPanel\n          key={producer.id}\n          title={\n            <FormattedMessage\n              id=\"rtc-debug-panel.producer-panel-title\"\n              defaultMessage=\"{kind} Producer\"\n              values={{ kind: capitalize(producer?.kind) }}\n            />\n          }\n          data={producer}\n          xAxis={\"timeDelta\"}\n          yAxis={\"bytesSent\"}\n          stats={stats[producer.id]}\n        />\n      );\n    });\n  }\n\n  createConsumers(consumers, stats) {\n    const reducedConsumers =\n      consumers?.reduce((map, consumer) => {\n        map[consumer.peerId] = map[consumer.peerId] || {};\n        map[consumer.peerId][\"name\"] = consumer.name;\n        map[consumer.peerId][\"peerId\"] = consumer.peerId;\n        map[consumer.peerId][\"consumers\"] = map[consumer.peerId][\"consumers\"] || [];\n        map[consumer.peerId][\"consumers\"].push(consumer);\n        return map;\n      }, []) || [];\n    const components = [];\n    for (const [, reducedConsumer] of Object.entries(reducedConsumers)) {\n      const consumerPanels = reducedConsumer.consumers.map(consumer => {\n        return (\n          <TrackStatsPanel\n            key={consumer.id}\n            title={\n              <FormattedMessage\n                id=\"rtc-debug-panel.consumer-panel-title\"\n                defaultMessage=\"{kind} Consumer\"\n                values={{ kind: capitalize(consumer?.kind) }}\n              />\n            }\n            data={consumer}\n            xAxis={\"timeDelta\"}\n            yAxis={\"bytesReceived\"}\n            stats={stats[consumer.id]}\n          />\n        );\n      });\n      const error = reducedConsumer?.consumers?.some(consumer => {\n        return !consumer.opened || !stats[consumer.id]?.speed;\n      });\n      const backgroundColor = error ? ERROR_COLOR : null;\n      components.push(\n        <CollapsiblePanel\n          key={reducedConsumer.name}\n          title={reducedConsumer.name}\n          url={`${MEDIASOUP_DOC_BASE_URL}#Consumer`}\n          data={{ peerId: reducedConsumer.peerId }}\n          border\n          collapsed\n          backgroundColor={backgroundColor}\n        >\n          <CollapsiblePanel row>{consumerPanels}</CollapsiblePanel>\n        </CollapsiblePanel>\n      );\n    }\n    return components;\n  }\n\n  createRemoteTransports(data) {\n    const transports = [];\n    if (data) {\n      for (const transportId in data) {\n        const transport = data[transportId];\n        const producers = [];\n        if (transport?.producers) {\n          for (const producerId in transport.producers) {\n            const stats = transport.producers[producerId];\n            stats.forEach((stat, index) => {\n              producers.push(\n                <DataPanel\n                  key={`${producerId}${index}`}\n                  data={stat}\n                  title={\n                    <FormattedMessage\n                      id=\"rtc-debug-panel.producer-transport-stats-title\"\n                      defaultMessage=\"{kind} Stats\"\n                      values={{ kind: capitalize(stat.kind) }}\n                    />\n                  }\n                />\n              );\n            });\n          }\n        }\n        const consumers = [];\n        if (transport?.consumers) {\n          for (const consumerId in transport.consumers) {\n            const stats = transport.consumers[consumerId];\n            stats.forEach((stat, index) => {\n              consumers.push(\n                <DataPanel\n                  key={`${consumerId}${index}`}\n                  data={stat}\n                  title={\n                    <FormattedMessage\n                      id=\"rtc-debug-panel.consumer-transport-stats-title\"\n                      defaultMessage=\"{kind} Stats\"\n                      values={{ kind: capitalize(stat.kind) }}\n                    />\n                  }\n                />\n              );\n            });\n          }\n        }\n        transports.push(\n          <CollapsiblePanel\n            key={transportId}\n            title={`${transport.name} Transport`}\n            url={`${MDN_DOC_BASE_URL}RTCStatsReport`}\n            data={{ id: transportId }}\n            border\n          >\n            {(producers?.length && (\n              <CollapsiblePanel\n                key={`producers`}\n                title={\n                  <FormattedMessage\n                    id=\"rtc-debug-panel.producer-transport-stats-panel-title\"\n                    defaultMessage=\"Producer Stats\"\n                  />\n                }\n                row\n                wrap\n                url={`${MDN_DOC_BASE_URL}RTCStatsReport`}\n                border\n              >\n                {producers}\n              </CollapsiblePanel>\n            )) ||\n              null}\n            {(consumers?.length && (\n              <CollapsiblePanel\n                key={`consumers`}\n                title={\n                  <FormattedMessage\n                    id=\"rtc-debug-panel.consumer-transport-stats-panel-title\"\n                    defaultMessage=\"Consumer Stats\"\n                  />\n                }\n                row\n                wrap\n                url={`${MDN_DOC_BASE_URL}RTCStatsReport`}\n                border\n              >\n                {consumers}\n              </CollapsiblePanel>\n            )) ||\n              null}\n          </CollapsiblePanel>\n        );\n      }\n    }\n    return transports;\n  }\n\n  onCollapse = (id, isCollapsed) => {\n    const title = id?.props[\"defaultMessage\"];\n    const collapsed = { ...this.state.collapsed };\n    if (isMobile || window.innerWidth < 500) {\n      for (const key of Object.keys(collapsed)) {\n        if (title === key) {\n          collapsed[key] = isCollapsed;\n        } else {\n          if (!isCollapsed) {\n            collapsed[key] = true;\n          }\n        }\n      }\n    } else {\n      collapsed[title] = isCollapsed;\n    }\n    this.setState({\n      collapsed\n    });\n  };\n\n  render() {\n    const { signalingData, serverData, statsData, deviceData, transportsData, collapsed } = this.state;\n    const isNarrow = isMobile || window.innerWidth < 500;\n    return (\n      <div>\n        <div className={classNames(styles.rtcDebugPanelRoot)}>\n          <div\n            className={classNames(styles.rtcStatusContainerLeft)}\n            style={{\n              height: isNarrow && !collapsed.Local && \"80%\",\n              maxHeight: isNarrow && !collapsed.Local && \"80%\"\n            }}\n          >\n            {this.props.showRtcDebug && (\n              <CollapsiblePanel\n                title={<FormattedMessage id=\"rtc-debug-panel.local-panel-title\" defaultMessage=\"Local\" />}\n                isRoot\n                border\n                grow\n                collapsed={collapsed.Local}\n                onCollapse={this.onCollapse}\n              >\n                {deviceData && (\n                  <CollapsiblePanel\n                    title={<FormattedMessage id=\"rtc-debug-panel.device-panel-title\" defaultMessage=\"Device\" />}\n                    border\n                    url={`${MEDIASOUP_DOC_BASE_URL}#Device`}\n                    data={deviceData}\n                  />\n                )}\n                {signalingData && (\n                  <SignalingPanel\n                    data={signalingData}\n                    onConnect={this.connectSignaling}\n                    onDisconnect={this.disconnectSignaling}\n                  />\n                )}\n                <div style={{ display: \"flex\", flexFlow: \"column\" }}>\n                  <TransportPanel\n                    title={\n                      <FormattedMessage\n                        id=\"rtc-debug-panel.send-transport-panel-title\"\n                        defaultMessage=\"Send Transport\"\n                      />\n                    }\n                    data={{\n                      id: transportsData?.[TransportType.SEND]?.id,\n                      opened: transportsData?.[TransportType.SEND]?.opened,\n                      state: transportsData?.[TransportType.SEND]?.state\n                    }}\n                    candidates={this.createCandidates(transportsData?.[TransportType.SEND]?.candidates)}\n                    producers={this.createProducers(transportsData?.[TransportType.SEND]?.producers, statsData)}\n                    onRestart={this.restartSendICE}\n                    isButtonEnabled={transportsData?.[TransportType.SEND]?.opened}\n                  />\n                </div>\n                <div style={{ display: \"flex\", flexFlow: \"column\" }}>\n                  <TransportPanel\n                    title={\n                      <FormattedMessage\n                        id=\"rtc-debug-panel.receive-transport-panel-title\"\n                        defaultMessage=\"Receive Transport\"\n                      />\n                    }\n                    data={{\n                      id: transportsData?.[TransportType.RECEIVE]?.id,\n                      opened: transportsData?.[TransportType.RECEIVE]?.opened,\n                      state: transportsData?.[TransportType.RECEIVE]?.state\n                    }}\n                    candidates={this.createCandidates(transportsData?.[TransportType.RECEIVE]?.candidates)}\n                    consumers={this.createConsumers(transportsData?.[TransportType.RECEIVE]?.consumers, statsData)}\n                    onRestart={this.restartRecvICE}\n                    isButtonEnabled={transportsData?.[TransportType.RECEIVE]?.opened}\n                  />\n                </div>\n              </CollapsiblePanel>\n            )}\n          </div>\n          <div className={classNames(styles.statusContainerMiddle)}>\n            {this.props.showAudioDebug && (\n              <AudioDebugPanel isNarrow collapsed={collapsed.Audio} onCollapsed={this.onCollapse} />\n            )}\n            {this.props.showRtcDebug && (\n              <div\n                className={classNames(styles.rtcLogContainer)}\n                style={{\n                  height: isNarrow && !collapsed.Log && \"80%\",\n                  maxHeight: isNarrow && !collapsed.Log && \"80%\"\n                }}\n              >\n                <CollapsiblePanel\n                  title={<FormattedMessage id=\"rtc-debug-panel.log-panel-title\" defaultMessage=\"Log\" />}\n                  isRoot\n                  border\n                  grow\n                  collapsed={collapsed.Log}\n                  onCollapse={this.onCollapse}\n                  clear={() => {\n                    this.setState({\n                      log: []\n                    });\n                  }}\n                  download={() => {\n                    download(\"rtc_log.txt\", this.createLog());\n                  }}\n                >\n                  <p className={classNames(styles.rtcLogMsgContainer)}>{this.createLogMsgs()}</p>\n                </CollapsiblePanel>\n              </div>\n            )}\n          </div>\n          <div\n            className={classNames(styles.rtcStatusContainerRight)}\n            style={{\n              height: isNarrow && !collapsed.Remote && \"80%\",\n              maxHeight: isNarrow && !collapsed.Remote && \"80%\"\n            }}\n          >\n            {this.props.showRtcDebug && (\n              <CollapsiblePanel\n                title={<FormattedMessage id=\"rtc-debug-panel.remote-panel-title\" defaultMessage=\"Remote\" />}\n                isRoot\n                border\n                grow\n                collapsed={collapsed.Remote}\n                onCollapse={this.onCollapse}\n              >\n                {this.createRemoteTransports(serverData)}\n              </CollapsiblePanel>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","export default function maskEmail(email) {\n  if (!email) return \"\";\n  const emailParts = email.split(\"@\");\n  const emailIdentity = emailParts[0];\n  const emailDomain = emailParts[1];\n  const truncatedIdentity = emailIdentity.substring(0, Math.min(emailIdentity.length, 3));\n  return `${truncatedIdentity}...@${emailDomain}`;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"loading-screen-layout\":\"LoadingScreenLayout__loading-screen-layout__Tybb0\",\"loadingScreenLayout\":\"LoadingScreenLayout__loading-screen-layout__Tybb0\",\"center\":\"LoadingScreenLayout__center__HTsFi\",\"logo\":\"LoadingScreenLayout__logo__r1f8O\",\"bottom\":\"LoadingScreenLayout__bottom__Ivx3e\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHmcLogo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: 666.667,\n    height: 266.667,\n    viewBox: \"0 0 500 200\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M283.6 96.7c-4.3 17.5-8 32.6-8.2 33.5-.5 1.6.3 1.8 7.5 1.8 4.5 0 8.1-.2 8.1-.5 0-1.3 6.1-29 6.5-29.4.7-.6.2-1.3 9.6 14.7 7.4 12.6 8.5 14.1 9.7 12.5.7-.9 4.4-7.5 8.3-14.5 3.9-7 7.4-12.8 7.8-12.8.4 0 2.3 6.6 4.2 14.7l3.5 14.8 8.1.3 8 .3-8.1-33c-4.4-18.2-8.4-33.1-8.7-33.1-.3 0-5.7 8.4-11.9 18.6-6.3 10.2-11.7 18.7-12 18.9-.3.2-5.9-8.4-12.5-19.1-6.5-10.7-11.9-19.4-12-19.4-.1 0-3.7 14.3-7.9 31.7z\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M364 71v6h17c9.4 0 17 .2 17 .5 0 .2-8.1 12.4-18 26.9-9.9 14.5-18 26.7-18 27 0 .3 14.2.6 31.5.6H425v-12h-18c-12.1 0-18-.4-18-1.1 0-.6 1.1-2.5 2.3-4.2 1.3-1.8 9.4-13.7 18-26.5L425 65h-61v6z\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M261 75.5c0 .8-.4 1.5-1 1.5-.5 0-1.2 1.1-1.6 2.5-.3 1.4-1 2.5-1.4 2.5-1.8 0-1.7 4.6.2 8.3 2.9 5.7 2.2 14.9-1.4 20.5-3.3 4.9-11.4 9.2-17.3 9.2-6 0-14-4.3-17.3-9.3-2.3-3.5-2.7-5.1-2.7-11.4 0-4-.1-7.3-.2-7.3s-1.4 3.9-2.9 8.7c-1.5 4.9-3.7 10.9-4.9 13.5l-2.3 4.7 4.5 4.5c4.9 5 12.7 9.2 18.9 10.2 4.1.6 4.2.5 4.9-2.5.9-4 2.5-4 2.5 0 0 3.1 0 3.2 4.4 2.7 9.9-1.1 21.9-9.5 26.4-18.5 5-9.8 5.2-20.5.6-30.4-3.6-7.6-9.4-13.5-9.4-9.4z\"\n  })));\n};\n\nexport { SvgHmcLogo as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport configs from \"../../utils/configs\";\nimport { ReactComponent as HmcLogo } from \"../icons/HmcLogo.svg\";\nimport { isHmc } from \"../../utils/isHmc\";\nimport { useLogo } from \"../styles/theme\";\n\nexport function AppLogo({ className, forceConfigurableLogo }) {\n  const logo = useLogo();\n  if (isHmc() && !forceConfigurableLogo) {\n    return <HmcLogo className=\"hmc-logo\" />;\n  } else {\n    return <img className={className} alt={configs.translation(\"app-name\")} src={logo} />;\n  }\n}\n\nAppLogo.propTypes = {\n  className: PropTypes.string,\n  forceConfigurableLogo: PropTypes.bool\n};\n","import configs from \"./configs\";\n\nexport function isHmc() {\n  // We use show_cloud as a proxy for whether we are running on HMC versus Hubs Cloud,\n  // since show_cloud is an internal config that is typically only enabled on HMC.\n  return configs.feature(\"show_cloud\");\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./LoadingScreenLayout.scss\";\nimport { Column } from \"../layout/Column\";\nimport { AppLogo } from \"../misc/AppLogo\";\n\nexport function LoadingScreenLayout({ center, bottom }) {\n  return (\n    <div className={styles.loadingScreenLayout}>\n      <Column center padding gap=\"lg\" className={styles.center}>\n        <AppLogo className={styles.logo} />\n        {center}\n      </Column>\n      {bottom && (\n        <Column center className={styles.bottom}>\n          {bottom}\n        </Column>\n      )}\n    </div>\n  );\n}\n\nLoadingScreenLayout.propTypes = {\n  center: PropTypes.node,\n  bottom: PropTypes.node\n};\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSpinner = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 70,\n    height: 70,\n    viewBox: \"0 0 70 70\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.284 57.665A32.14 32.14 0 0 1 3.39 40.032a32.311 32.311 0 0 1 3.065-19.547A31.861 31.861 0 0 1 20.307 6.49a31.414 31.414 0 0 1 19.349-3.096m18.06 8.94a32.14 32.14 0 0 1 8.894 17.634 32.311 32.311 0 0 1-3.065 19.548A31.86 31.86 0 0 1 49.693 63.51a31.413 31.413 0 0 1-19.348 3.096\",\n    stroke: \"currentColor\",\n    strokeWidth: 6\n  })));\n};\n\nexport { SvgSpinner as ReactComponent };","import React from \"react\";\nimport { ReactComponent as SpinnerSvg } from \"./Spinner.svg\";\nimport styles from \"./Spinner.scss\";\n\nexport function Spinner() {\n  return <SpinnerSvg className={styles.spinner} />;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"spinner\":\"Spinner__spinner__jvUtq\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { LoadingScreenLayout } from \"../layout/LoadingScreenLayout\";\nimport { Spinner } from \"../misc/Spinner\";\nimport { useRandomMessageTransition } from \"./useRandomMessageTransition\";\nexport function LoadingScreen({ message, infoMessages }) {\n  const infoMessage = useRandomMessageTransition(infoMessages);\n  return (\n    <LoadingScreenLayout\n      center={\n        <>\n          <Spinner />\n          <p>{message}</p>\n        </>\n      }\n      bottom={\n        <>\n          <h3>{infoMessage.heading}</h3>\n          <p>{infoMessage.message}</p>\n        </>\n      }\n    />\n  );\n}\n\nLoadingScreen.propTypes = {\n  message: PropTypes.node,\n  infoMessages: PropTypes.arrayOf(\n    PropTypes.shape({\n      heading: PropTypes.node.isRequired,\n      message: PropTypes.node.isRequired\n    })\n  )\n};\n\nLoadingScreen.defaultProps = {\n  infoMessages: []\n};\n","import { useEffect, useState, useRef, useCallback } from \"react\";\n\nexport function useRandomMessageTransition(messages, transitionDelay = 5000) {\n  const messageTimeoutRef = useRef();\n  const [index, setIndex] = useState(Math.round(Math.random() * (messages.length - 1)));\n\n  const queueNextMessage = useCallback(\n    () => {\n      messageTimeoutRef.current = setTimeout(() => {\n        setIndex(currentIndex => (currentIndex + 1) % messages.length);\n        queueNextMessage();\n      }, transitionDelay);\n    },\n    [setIndex, messages, transitionDelay]\n  );\n\n  useEffect(\n    () => {\n      queueNextMessage();\n\n      return () => {\n        clearTimeout(messageTimeoutRef.current);\n      };\n    },\n    [queueNextMessage]\n  );\n\n  return messages[index];\n}\n","import { useEffect, useReducer, useRef, useCallback } from \"react\";\nimport { useIntl, defineMessages } from \"react-intl\";\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"object-loading\":\n      return { ...state, objectCount: state.objectCount + 1, messageKey: \"loadingObjects\" };\n    case \"object-loaded\":\n      return { ...state, loadedCount: state.loadedCount + 1 };\n    case \"all-objects-loaded\":\n      return {\n        ...state,\n        allObjectsLoaded: true,\n        loading: !(state.environmentLoaded && state.networkConnected),\n        messageKey: state.environmentLoaded ? \"enteringRoom\" : \"loadingObjects\"\n      };\n    case \"environment-loaded\": {\n      const loaded = state.lazyLoadMedia\n        ? state.networkConnected && state.dialogConnected\n        : state.allObjectsLoaded && state.networkConnected && state.dialogConnected;\n      return {\n        ...state,\n        environmentLoaded: true,\n        loading: !loaded,\n        messageKey: state.lazyLoadMedia\n          ? loaded\n            ? \"enteringRoom\"\n            : \"connectingScene\"\n          : loaded\n            ? \"enteringRoom\"\n            : \"loadingObjects\"\n      };\n    }\n    case \"network-connected\":\n      return {\n        ...state,\n        networkConnected: true,\n        loading: state.lazyLoadMedia\n          ? !(state.environmentLoaded && state.dialogConnected)\n          : !(state.environmentLoaded && state.allObjectsLoaded && state.dialogConnected)\n      };\n    case \"dialog-connected\":\n      return {\n        ...state,\n        dialogConnected: true,\n        loading: state.lazyLoadMedia\n          ? !(state.environmentLoaded && state.networkConnected)\n          : !(state.environmentLoaded && state.allObjectsLoaded && state.networkConnected)\n      };\n  }\n}\n\n// defineMessages informs babel-plugin-react-intl what i18n data can be stripped/embedded when bundling.\nconst messages = defineMessages({\n  default: {\n    id: \"loading-screen.default\",\n    description: \"The scene has started loading.\",\n    defaultMessage: \"Loading scene...\"\n  },\n  loadingObjects: {\n    id: \"loading-screen.loading-objects\",\n    description: \"The loading progress. How many objects have finished loading?\",\n    defaultMessage: \"Loading objects {loadedCount}/{objectCount}\"\n  },\n  connectingScene: {\n    id: \"loading-screen.connecting\",\n    description: \"The scene is loaded, we are waiting for the networked scene to be connected to enter.\",\n    defaultMessage: \"Connecting to the scene...\"\n  },\n  enteringRoom: {\n    id: \"loading-screen.entering-room\",\n    description:\n      \"Once the scene has finished loading, this message tells uses that they will be entering the room shortly.\",\n    defaultMessage: \"Entering room...\"\n  }\n});\n\nexport function useRoomLoadingState(sceneEl) {\n  // Holds the id of the current\n  const loadingTimeoutRef = useRef();\n  const lazyLoadMedia = APP.store.state.preferences.lazyLoadSceneMedia;\n\n  const [{ loading, messageKey, objectCount, loadedCount }, dispatch] = useReducer(reducer, {\n    loading: !sceneEl.is(\"loaded\"),\n    messageKey: \"default\",\n    objectCount: 0,\n    loadedCount: 0,\n    allObjectsLoaded: false,\n    environmentLoaded: false,\n    networkConnected: false,\n    dialogConnected: false,\n    lazyLoadMedia\n  });\n\n  const onObjectLoading = useCallback(\n    () => {\n      clearTimeout(loadingTimeoutRef.current);\n      dispatch({ type: \"object-loading\" });\n    },\n    [dispatch]\n  );\n\n  const onObjectLoaded = useCallback(\n    () => {\n      clearTimeout(loadingTimeoutRef.current);\n\n      dispatch({ type: \"object-loaded\" });\n\n      // Objects can start loading as a result of loading another object. Wait 1.5 seconds before calling\n      // all-objects-loaded to try to catch loading all objects.\n      // TODO: Determine a better way to ensure the object dependency chain has resolved, or switch to a\n      // progressive loading model where all objects don't have to be loaded to enter the room.\n      loadingTimeoutRef.current = setTimeout(() => {\n        dispatch({ type: \"all-objects-loaded\" });\n      }, 1500);\n    },\n    [dispatch]\n  );\n\n  const onEnvironmentLoaded = useCallback(\n    () => {\n      dispatch({ type: \"environment-loaded\" });\n    },\n    [dispatch]\n  );\n\n  const onNetworkConnected = useCallback(\n    () => {\n      dispatch({ type: \"network-connected\" });\n    },\n    [dispatch]\n  );\n\n  const onDialogConnected = useCallback(\n    () => {\n      dispatch({ type: \"dialog-connected\" });\n    },\n    [dispatch]\n  );\n\n  useEffect(\n    () => {\n      // Once the scene has loaded the dependencies to this hook will change,\n      // the event listeners will be removed, and we can prevent adding them again.\n      if (loading) {\n        if (!lazyLoadMedia) {\n          sceneEl.addEventListener(\"model-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"image-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"pdf-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"video-loading\", onObjectLoading);\n          sceneEl.addEventListener(\"model-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"image-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"pdf-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"video-loaded\", onObjectLoaded);\n          sceneEl.addEventListener(\"model-error\", onObjectLoaded);\n        }\n        sceneEl.addEventListener(\"environment-scene-loaded\", onEnvironmentLoaded);\n        sceneEl.addEventListener(\"didConnectToNetworkedScene\", onNetworkConnected);\n        sceneEl.addEventListener(\"didConnectToDialog\", onDialogConnected);\n      }\n\n      return () => {\n        if (!lazyLoadMedia) {\n          sceneEl.removeEventListener(\"model-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"image-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"pdf-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"video-loading\", onObjectLoading);\n          sceneEl.removeEventListener(\"model-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"image-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"pdf-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"video-loaded\", onObjectLoaded);\n          sceneEl.removeEventListener(\"model-error\", onObjectLoaded);\n        }\n        sceneEl.removeEventListener(\"environment-scene-loaded\", onEnvironmentLoaded);\n        sceneEl.removeEventListener(\"didConnectToNetworkedScene\", onNetworkConnected);\n        sceneEl.removeEventListener(\"didConnectToDialog\", onDialogConnected);\n      };\n    },\n    [\n      sceneEl,\n      loading,\n      onObjectLoaded,\n      onObjectLoading,\n      onEnvironmentLoaded,\n      onNetworkConnected,\n      onDialogConnected,\n      lazyLoadMedia\n    ]\n  );\n\n  const intl = useIntl();\n\n  const message = intl.formatMessage(messages[messageKey], {\n    // Never show a loaded count that's greater than the object count\n    loadedCount: Math.min(loadedCount, objectCount),\n    objectCount\n  });\n\n  useEffect(\n    () => {\n      if (!loading) {\n        // The loaded state on the scene signifies that the loading screen is no longer visible,\n        // the initial scene was loaded, and the network connection is established.\n        sceneEl.addState(\"loaded\");\n      }\n    },\n    [sceneEl, loading]\n  );\n\n  // Ensure timeout is cleared on unmount.\n  useEffect(() => {\n    () => {\n      clearTimeout(loadingTimeoutRef.current);\n    };\n  }, []);\n\n  return { loading, message };\n}\n","import React, { useEffect, useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useIntl } from \"react-intl\";\nimport { LoadingScreen } from \"./LoadingScreen\";\nimport { useRoomLoadingState } from \"./useRoomLoadingState\";\n\nexport function LoadingScreenContainer({ onLoaded, scene }) {\n  const intl = useIntl();\n\n  const { loading, message } = useRoomLoadingState(scene);\n\n  useEffect(\n    () => {\n      if (!loading) {\n        onLoaded();\n      }\n    },\n    [loading, onLoaded]\n  );\n\n  //TODO: Make these configurable\n  const infoMessages = useMemo(\n    () => [\n      {\n        heading: intl.formatMessage({ id: \"loading-screen.heading.tip\", defaultMessage: \"Tip:\" }),\n        message: intl.formatMessage({\n          id: \"loading-screen.message.keyboard-controls\",\n          defaultMessage: \"Press the Q & E keys to turn left and right.\"\n        })\n      },\n      {\n        heading: intl.formatMessage({ id: \"loading-screen.heading.whats-new\", defaultMessage: \"What's New?\" }),\n        message: intl.formatMessage(\n          {\n            id: \"loading-screen.message.whats-new\",\n            defaultMessage: \"You can now set the default locale in your preferences. <a>Read More</a>\"\n          },\n          {\n            // eslint-disable-next-line react/display-name\n            a: chunks => (\n              <a href=\"/whats-new\" target=\"_blank\">\n                {chunks}\n              </a>\n            )\n          }\n        )\n      }\n    ],\n    [intl]\n  );\n\n  return <LoadingScreen message={message} infoMessages={infoMessages} />;\n}\n\nLoadingScreenContainer.propTypes = {\n  scene: PropTypes.object.isRequired,\n  onLoaded: PropTypes.func.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"room-layout\":\"RoomLayout__room-layout__kTC2f\",\"roomLayout\":\"RoomLayout__room-layout__kTC2f\",\"main\":\"RoomLayout__main__YsUq9\",\"sidebar\":\"RoomLayout__sidebar__c3nxk\",\"viewport\":\"RoomLayout__viewport__UVY6l\",\"toolbar\":\"RoomLayout__toolbar__HAuuI\",\"modal-container\":\"RoomLayout__modal-container__Zn2lB\",\"modalContainer\":\"RoomLayout__modal-container__Zn2lB\",\"scene\":\"RoomLayout__scene__higS0\",\"object-focused\":\"RoomLayout__object-focused__w_gE0\",\"objectFocused\":\"RoomLayout__object-focused__w_gE0\",\"streaming\":\"RoomLayout__streaming__e4Nkj\"};","// extracted by mini-css-extract-plugin\nexport default {\"toolbar\":\"Toolbar__toolbar__YcMAi\",\"content\":\"Toolbar__content__fDPmA\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Toolbar.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\n\nexport function Toolbar({ className, left, center, right, ...rest }) {\n  return (\n    <div className={classNames(styles.toolbar, className)} {...rest}>\n      <div className={classNames(styles.content, styles.leftContent, styleUtils.showLg)}>{left}</div>\n      <div className={classNames(styles.content, styles.centerContent)}>{center}</div>\n      <div className={classNames(styles.content, styles.rightContent, styleUtils.showLg)}>{right}</div>\n    </div>\n  );\n}\n\nToolbar.propTypes = {\n  className: PropTypes.string,\n  left: PropTypes.node,\n  center: PropTypes.node,\n  right: PropTypes.node,\n  hideLeft: PropTypes.string,\n  hideRight: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./RoomLayout.scss\";\nimport { Toolbar } from \"./Toolbar\";\n\nexport function RoomLayout({\n  className,\n  viewportClassName,\n  sidebar,\n  sidebarClassName,\n  toolbarLeft,\n  toolbarCenter,\n  toolbarRight,\n  toolbarClassName,\n  modal,\n  viewport,\n  objectFocused,\n  streaming,\n  viewportRef,\n  ...rest\n}) {\n  return (\n    <div className={classNames(styles.roomLayout, { [styles.objectFocused]: objectFocused }, className)} {...rest}>\n      {sidebar && <div className={classNames(styles.sidebar, sidebarClassName)}>{sidebar}</div>}\n      <div className={classNames(styles.modalContainer, styles.viewport)}>{modal}</div>\n      {(toolbarLeft || toolbarCenter || toolbarRight) && (\n        <Toolbar\n          className={classNames(styles.main, styles.toolbar, toolbarClassName)}\n          left={toolbarLeft}\n          center={toolbarCenter}\n          right={toolbarRight}\n        />\n      )}\n      <div\n        className={classNames(styles.main, styles.viewport, { [styles.streaming]: streaming }, viewportClassName)}\n        ref={viewportRef}\n      >\n        {viewport}\n      </div>\n    </div>\n  );\n}\n\nRoomLayout.propTypes = {\n  className: PropTypes.string,\n  viewportClassName: PropTypes.string,\n  sidebar: PropTypes.node,\n  sidebarClassName: PropTypes.string,\n  toolbarLeft: PropTypes.node,\n  toolbarCenter: PropTypes.node,\n  toolbarRight: PropTypes.node,\n  toolbarClassName: PropTypes.string,\n  modal: PropTypes.node,\n  viewport: PropTypes.node,\n  objectFocused: PropTypes.bool,\n  streaming: PropTypes.bool,\n  viewportRef: PropTypes.any\n};\n","import React, { useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { RoomLayout } from \"../layout/RoomLayout\";\nimport { useResizeViewport } from \"./useResizeViewport\";\n\nexport function RoomLayoutContainer({ store, scene, ...rest }) {\n  const viewportRef = useRef();\n\n  useResizeViewport(viewportRef, store, scene);\n\n  return <RoomLayout viewportRef={viewportRef} {...rest} />;\n}\n\nRoomLayoutContainer.propTypes = {\n  store: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired\n};\n","import { useState, useEffect } from \"react\";\n// ResizeObserver not currently supported in Firefox Android\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport {\n  addOrientationChangeListener,\n  removeOrientationChangeListener,\n  getMaxResolutionWidth,\n  getMaxResolutionHeight\n} from \"../../utils/screen-orientation-utils\";\n\nfunction calculateRendererSize(canvasRect, maxResolution, isVR) {\n  if (isVR) {\n    return canvasRect;\n  }\n\n  // canvasRect values are CSS pixels based while\n  // maxResolution values are physical pixels based (CSS pixels * pixel ratio).\n  // Convert maxResolution values to CSS pixels based.\n  const pixelRatio = window.devicePixelRatio;\n  const maxWidth = maxResolution.width / pixelRatio;\n  const maxHeight = maxResolution.height / pixelRatio;\n\n  if (canvasRect.width <= maxWidth && canvasRect.height <= maxHeight) {\n    return canvasRect;\n  }\n\n  const conversionRatio = Math.min(maxWidth / canvasRect.width, maxHeight / canvasRect.height);\n\n  return {\n    width: Math.round(canvasRect.width * conversionRatio),\n    height: Math.round(canvasRect.height * conversionRatio)\n  };\n}\n\nexport function useResizeViewport(viewportRef, store, scene) {\n  const [maxResolution, setMaxResolution] = useState({\n    width: getMaxResolutionWidth(store),\n    height: getMaxResolutionHeight(store)\n  });\n\n  useEffect(\n    () => {\n      function onStoreChanged() {\n        setMaxResolution({\n          width: getMaxResolutionWidth(store),\n          height: getMaxResolutionHeight(store)\n        });\n      }\n\n      onStoreChanged();\n\n      store.addEventListener(\"statechanged\", onStoreChanged);\n\n      return () => {\n        store.removeEventListener(\"statechanged\", onStoreChanged);\n      };\n    },\n    [store]\n  );\n\n  useEffect(\n    () => {\n      const observer = new ResizeObserver(entries => {\n        const isPresenting = scene.renderer.xr.isPresenting;\n        const isVRPresenting = scene.renderer.xr.enabled && isPresenting;\n\n        // Do not update renderer, if a camera or a canvas have not been injected.\n        // In VR mode, three handles canvas resize based on the dimensions returned by\n        // the getEyeParameters function of the WebVR API. These dimensions are independent of\n        // the window size, therefore should not be overwritten with the window's width and\n        // height, // except when in fullscreen mode.\n        if (!scene.camera || !scene.canvas || (scene.is(\"vr-mode\") && (scene.isMobile || isVRPresenting))) {\n          return;\n        }\n\n        const canvasRect = entries[0].contentRect;\n\n        const rendererSize = calculateRendererSize(canvasRect, maxResolution, isVRPresenting);\n\n        const canvas = scene.canvas;\n        canvas.style.width = canvasRect.width + \"px\";\n        canvas.style.height = canvasRect.height + \"px\";\n\n        scene.renderer.setSize(rendererSize.width, rendererSize.height, false);\n\n        scene.camera.aspect = rendererSize.width / rendererSize.height;\n        scene.camera.updateProjectionMatrix();\n\n        // Resizing the canvas clears it, so render immediately after resize to prevent flicker.\n        scene.renderer.render(scene.object3D, scene.camera);\n\n        scene.emit(\"rendererresize\", null, false);\n      });\n\n      observer.observe(viewportRef.current);\n\n      return () => {\n        observer.disconnect();\n      };\n    },\n    [viewportRef, scene, maxResolution]\n  );\n\n  useEffect(\n    () => {\n      function onOrientationChange() {\n        setMaxResolution({\n          width: getMaxResolutionWidth(store),\n          height: getMaxResolutionHeight(store)\n        });\n      }\n\n      addOrientationChangeListener(onOrientationChange);\n\n      return () => {\n        removeOrientationChangeListener(onOrientationChange);\n      };\n    },\n    [store]\n  );\n}\n","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgEnter = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875 6.875V5.312A1.563 1.563 0 0 1 8.438 3.75h8.124a1.563 1.563 0 0 1 1.563 1.562v9.375a1.562 1.562 0 0 1-1.563 1.563H8.438a1.562 1.562 0 0 1-1.562-1.563v-1.562\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.625 13.125 13.75 10l-3.125-3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.875 10h11.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgEnter as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVr = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.714 4H2.033C1.466 4 1 4.466 1 5.033v9.506c0 .567.466 1.032 1.033 1.032h4.464c.557 0 1.043-.354 1.215-.88l1.063-3.18c.395-1.173 2.045-1.173 2.44 0l1.063 3.18c.172.526.668.88 1.225.88h4.464c.567 0 1.033-.465 1.033-1.032V5.286C19 4.577 18.423 4 17.714 4ZM6.477 11.471c-1.782.891-3.553-.87-2.663-2.662.152-.314.405-.567.72-.719 1.781-.89 3.553.87 2.662 2.662a1.643 1.643 0 0 1-.72.72Zm9 0c-1.782.891-3.553-.87-2.663-2.662.152-.314.405-.567.72-.719 1.781-.89 3.553.87 2.662 2.662a1.643 1.643 0 0 1-.72.72Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgVr as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgShow = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.987 4.375c-3.045 0-6.168 1.762-8.626 5.286a.625.625 0 0 0-.011.695c1.89 2.957 4.97 5.27 8.637 5.27 3.626 0 6.77-2.32 8.663-5.284a.63.63 0 0 0 0-.683c-1.896-2.93-5.064-5.284-8.663-5.284Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 13.125a3.125 3.125 0 1 0 0-6.25 3.125 3.125 0 0 0 0 6.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgShow as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSettings = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.84 9.464 16.823 9.3a.313.313 0 0 1-.258-.267c-.02-.125-.039-.25-.066-.371a.315.315 0 0 1 .152-.337l.902-.5a.314.314 0 0 0 .152-.388l-.156-.43a.31.31 0 0 0-.367-.195l-1.012.195a.313.313 0 0 1-.335-.16 7.177 7.177 0 0 0-.188-.329.319.319 0 0 1 .028-.372l.675-.779a.313.313 0 0 0 .012-.415l-.293-.351a.308.308 0 0 0-.41-.06l-.886.533a.312.312 0 0 1-.367-.035 8.649 8.649 0 0 0-.289-.243.312.312 0 0 1-.098-.356l.367-.966a.312.312 0 0 0-.126-.397l-.399-.23a.312.312 0 0 0-.406.086l-.65.814a.28.28 0 0 1-.332.097s-.218-.09-.383-.145a.312.312 0 0 1-.213-.3l.015-1.034a.315.315 0 0 0-.257-.329l-.453-.078a.315.315 0 0 0-.356.22l-.336.978a.312.312 0 0 1-.304.211h-.383a.315.315 0 0 1-.304-.211l-.336-.978a.315.315 0 0 0-.355-.22l-.453.078a.315.315 0 0 0-.258.33l.016 1.033a.312.312 0 0 1-.215.3c-.09.036-.285.11-.379.146-.109.039-.238.007-.343-.114l-.645-.795a.313.313 0 0 0-.406-.084l-.399.23a.31.31 0 0 0-.129.395l.368.967a.315.315 0 0 1-.098.355c-.098.079-.195.16-.29.243a.312.312 0 0 1-.366.035l-.873-.54a.312.312 0 0 0-.41.059l-.293.351a.313.313 0 0 0 .012.415l.675.78a.312.312 0 0 1 .027.371 3.948 3.948 0 0 0-.187.329.317.317 0 0 1-.336.16l-1.011-.195a.312.312 0 0 0-.367.195l-.156.43a.314.314 0 0 0 .152.387l.9.501a.31.31 0 0 1 .153.337c-.023.125-.047.247-.066.372a.316.316 0 0 1-.258.266l-1.019.164a.316.316 0 0 0-.277.31v.457a.307.307 0 0 0 .277.31l1.019.164a.312.312 0 0 1 .258.266c.02.125.039.25.066.372a.315.315 0 0 1-.152.336l-.902.502a.314.314 0 0 0-.153.387l.157.43a.31.31 0 0 0 .367.195l1.011-.195a.313.313 0 0 1 .336.16c.058.11.12.22.187.33a.319.319 0 0 1-.027.371l-.676.78a.313.313 0 0 0-.011.415l.292.351a.308.308 0 0 0 .41.06l.887-.533a.313.313 0 0 1 .367.035c.093.082.191.164.289.243a.313.313 0 0 1 .097.356l-.367.966a.312.312 0 0 0 .13.396l.398.23a.313.313 0 0 0 .405-.086l.656-.806c.082-.101.215-.144.32-.101.133.054.223.085.387.14a.313.313 0 0 1 .215.302l-.016 1.033a.315.315 0 0 0 .258.329l.453.078a.316.316 0 0 0 .355-.22l.336-.976a.313.313 0 0 1 .304-.211h.383a.315.315 0 0 1 .304.211l.336.977a.316.316 0 0 0 .356.219l.453-.078a.315.315 0 0 0 .257-.33l-.015-1.032a.312.312 0 0 1 .214-.302c.164-.055.274-.098.375-.137.102-.039.227-.039.325.082l.663.818a.312.312 0 0 0 .408.086l.398-.231a.31.31 0 0 0 .13-.396l-.368-.966a.315.315 0 0 1 .098-.357c.097-.078.195-.16.289-.242a.312.312 0 0 1 .367-.035l.883.534a.312.312 0 0 0 .41-.06l.293-.35a.312.312 0 0 0-.012-.416l-.676-.779a.312.312 0 0 1-.027-.372c.066-.105.129-.214.188-.328a.318.318 0 0 1 .335-.16l1.012.195a.312.312 0 0 0 .367-.196l.156-.43a.315.315 0 0 0-.152-.387l-.902-.5a.31.31 0 0 1-.153-.337c.024-.125.047-.247.067-.372a.315.315 0 0 1 .257-.266l1.02-.164a.316.316 0 0 0 .277-.31v-.458a.323.323 0 0 0-.284-.302ZM10 4.375A5.618 5.618 0 0 1 15.446 8.6a.626.626 0 0 1-.606.776h-4.111a.625.625 0 0 1-.544-.316L8.15 5.477a.625.625 0 0 1 .385-.914 5.74 5.74 0 0 1 1.467-.188ZM4.377 10A5.625 5.625 0 0 1 6.08 5.96a.625.625 0 0 1 .983.136l2.04 3.592a.625.625 0 0 1 0 .62L7.048 13.89a.625.625 0 0 1-.983.13A5.624 5.624 0 0 1 4.376 10ZM10 15.625a5.744 5.744 0 0 1-1.492-.193.626.626 0 0 1-.381-.916l2.054-3.576a.625.625 0 0 1 .542-.313h4.117a.625.625 0 0 1 .606.777A5.62 5.62 0 0 1 10 15.625Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgSettings as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"RoomEntryModal__content__w5f0z\",\"logo-container\":\"RoomEntryModal__logo-container__fYEi5\",\"logoContainer\":\"RoomEntryModal__logo-container__fYEi5\",\"room-name\":\"RoomEntryModal__room-name__z4FVW\",\"roomName\":\"RoomEntryModal__room-name__z4FVW\",\"buttons\":\"RoomEntryModal__buttons__NvzXp\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { ReactComponent as EnterIcon } from \"../icons/Enter.svg\";\nimport { ReactComponent as VRIcon } from \"../icons/VR.svg\";\nimport { ReactComponent as ShowIcon } from \"../icons/Show.svg\";\nimport { ReactComponent as SettingsIcon } from \"../icons/Settings.svg\";\nimport styles from \"./RoomEntryModal.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\nimport { useCssBreakpoints } from \"react-use-css-breakpoints\";\nimport { Column } from \"../layout/Column\";\nimport { AppLogo } from \"../misc/AppLogo\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function RoomEntryModal({\n  className,\n  roomName,\n  showJoinRoom,\n  onJoinRoom,\n  showEnterOnDevice,\n  onEnterOnDevice,\n  showSpectate,\n  onSpectate,\n  showOptions,\n  onOptions,\n  ...rest\n}) {\n  const breakpoint = useCssBreakpoints();\n  return (\n    <Modal className={classNames(styles.roomEntryModal, className)} disableFullscreen {...rest}>\n      <Column center className={styles.content}>\n        {breakpoint !== \"sm\" &&\n          breakpoint !== \"md\" && (\n            <div className={styles.logoContainer}>\n              <AppLogo />\n            </div>\n          )}\n        <div className={styles.roomName}>\n          <h5>\n            <FormattedMessage id=\"room-entry-modal.room-name-label\" defaultMessage=\"Room Name\" />\n          </h5>\n          <p>{roomName}</p>\n        </div>\n        <Column center className={styles.buttons}>\n          {showJoinRoom && (\n            <Button preset=\"accent4\" onClick={onJoinRoom}>\n              <EnterIcon />\n              <span>\n                <FormattedMessage id=\"room-entry-modal.join-room-button\" defaultMessage=\"Join Room\" />\n              </span>\n            </Button>\n          )}\n          {showEnterOnDevice && (\n            <Button preset=\"accent5\" onClick={onEnterOnDevice}>\n              <VRIcon />\n              <span>\n                <FormattedMessage id=\"room-entry-modal.enter-on-device-button\" defaultMessage=\"Enter On Device\" />\n              </span>\n            </Button>\n          )}\n          {showSpectate && (\n            <Button preset=\"accent2\" onClick={onSpectate}>\n              <ShowIcon />\n              <span>\n                <FormattedMessage id=\"room-entry-modal.spectate-button\" defaultMessage=\"Spectate\" />\n              </span>\n            </Button>\n          )}\n          {showOptions &&\n            breakpoint !== \"sm\" && (\n              <>\n                <hr className={styleUtils.showLg} />\n                <Button preset=\"transparent\" className={styleUtils.showLg} onClick={onOptions}>\n                  <SettingsIcon />\n                  <span>\n                    <FormattedMessage id=\"room-entry-modal.options-button\" defaultMessage=\"Options\" />\n                  </span>\n                </Button>\n              </>\n            )}\n        </Column>\n      </Column>\n    </Modal>\n  );\n}\n\nRoomEntryModal.propTypes = {\n  className: PropTypes.string,\n  roomName: PropTypes.string.isRequired,\n  showJoinRoom: PropTypes.bool,\n  onJoinRoom: PropTypes.func,\n  showEnterOnDevice: PropTypes.bool,\n  onEnterOnDevice: PropTypes.func,\n  showSpectate: PropTypes.bool,\n  onSpectate: PropTypes.func,\n  showOptions: PropTypes.bool,\n  onOptions: PropTypes.func\n};\n\nRoomEntryModal.defaultProps = {\n  showJoinRoom: true,\n  showEnterOnDevice: true,\n  showSpectate: true,\n  showOptions: true\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { ReactComponent as VRIcon } from \"../icons/VR.svg\";\nimport styles from \"./EnterOnDeviceModal.scss\";\nimport { BackButton } from \"../input/BackButton\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nexport function EnterOnDeviceModal({\n  className,\n  shortUrl,\n  loadingCode,\n  code,\n  headsetConnected,\n  unsupportedBrowser,\n  onEnterOnConnectedHeadset,\n  onBack,\n  ...rest\n}) {\n  const intl = useIntl();\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"enter-on-device-modal.title\" defaultMessage=\"Enter on Device\" />}\n      beforeTitle={<BackButton onClick={onBack} />}\n      className={className}\n      {...rest}\n    >\n      <Column center={loadingCode ? \"both\" : true} padding grow>\n        {loadingCode ? (\n          <b>\n            <FormattedMessage id=\"enter-on-device-modal.generating-code\" defaultMessage=\"Generating join code...\" />\n          </b>\n        ) : (\n          <>\n            <b>\n              <FormattedMessage id=\"enter-on-device-modal.heading\" defaultMessage=\"Enter on Wireless Headset / Phone\" />\n            </b>\n            <small>\n              <FormattedMessage\n                id=\"enter-on-device-modal.short-url-directions\"\n                defaultMessage=\"In your device's web browser, go to:\"\n              />\n            </small>\n            <div className={styles.shortUrlContainer}>{shortUrl}</div>\n            <small>\n              <FormattedMessage\n                id=\"enter-on-device-modal.code-directions\"\n                defaultMessage=\"Then, enter this one-time code:\"\n              />\n            </small>\n            <div className={styles.codeContainer}>\n              {code.split(\"\").map((char, i) => (\n                <div key={i} className={styles.codeLetter}>\n                  {char}\n                </div>\n              ))}\n            </div>\n            <strong>\n              <FormattedMessage\n                id=\"enter-on-device-modal.data-transfer\"\n                defaultMessage=\"Your account and avatar will be transferred to the device.\"\n              />\n            </strong>\n            <strong>\n              <FormattedMessage\n                id=\"enter-on-device-modal.keep-page-open\"\n                defaultMessage=\"Keep this page open to use this code.\"\n              />\n            </strong>\n            {headsetConnected && (\n              <>\n                <hr\n                  data-or-text={intl.formatMessage({ id: \"enter-on-device-modal.divider-label\", defaultMessage: \"or\" })}\n                />\n                <b>\n                  <FormattedMessage\n                    id=\"enter-on-device-modal.headset-connected-heading\"\n                    defaultMessage=\"Enter on Connected Headset\"\n                  />\n                </b>\n                {unsupportedBrowser ? (\n                  <>\n                    <small>\n                      <FormattedMessage\n                        id=\"enter-on-device-modal.unsupported-browser\"\n                        defaultMessage=\"WebVR isn't supported in this browser, to enter with Oculus or SteamVR, use Firefox.\"\n                      />\n                    </small>\n                    <Button\n                      as=\"a\"\n                      preset=\"accent2\"\n                      href=\"https://www.mozilla.org/firefox/\"\n                      target=\"_blank\"\n                      rel=\"noreferrer noopener\"\n                    >\n                      <span>\n                        <FormattedMessage\n                          id=\"enter-on-device-modal.download-firefox-button\"\n                          defaultMessage=\"Download Firefox\"\n                        />\n                      </span>\n                    </Button>\n                  </>\n                ) : (\n                  <>\n                    <small>\n                      <FormattedMessage\n                        id=\"enter-on-device-modal.headset-connected-message\"\n                        defaultMessage=\"You have a VR headset connected to this device.\"\n                      />\n                    </small>\n                    <Button preset=\"accent5\" onClick={onEnterOnConnectedHeadset}>\n                      <VRIcon />\n                      <span>\n                        <FormattedMessage id=\"enter-on-device-modal.enter-in-vr-button\" defaultMessage=\"Enter in VR\" />\n                      </span>\n                    </Button>\n                  </>\n                )}\n              </>\n            )}\n          </>\n        )}\n      </Column>\n    </Modal>\n  );\n}\n\nEnterOnDeviceModal.propTypes = {\n  className: PropTypes.string,\n  shortUrl: PropTypes.string.isRequired,\n  loadingCode: PropTypes.bool,\n  code: PropTypes.string,\n  headsetConnected: PropTypes.bool,\n  unsupportedBrowser: PropTypes.bool,\n  onEnterOnConnectedHeadset: PropTypes.func,\n  onBack: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"code-container\":\"EnterOnDeviceModal__code-container__RRgUe\",\"codeContainer\":\"EnterOnDeviceModal__code-container__RRgUe\",\"short-url-container\":\"EnterOnDeviceModal__short-url-container__tK_03\",\"shortUrlContainer\":\"EnterOnDeviceModal__short-url-container__tK_03\",\"code-letter\":\"EnterOnDeviceModal__code-letter__nSeNJ\",\"codeLetter\":\"EnterOnDeviceModal__code-letter__nSeNJ\"};","var _path, _rect, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgMicrophone = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 17.5h5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 8,\n    y: 8.7,\n    width: 4,\n    height: 0,\n    fill: \"#7ED320\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15 8.126v1.25c0 2.75-2.25 5-5 5s-5-2.25-5-5v-1.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 14.376v3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2.5A2.487 2.487 0 0 0 7.5 5v4.336c0 1.375 1.133 2.54 2.5 2.54s2.5-1.133 2.5-2.54V5c0-1.406-1.094-2.5-2.5-2.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgMicrophone as ReactComponent };","var _path, _rect, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgMicrophoneMuted = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 17.5h5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _rect || (_rect = /*#__PURE__*/React.createElement(\"rect\", {\n    x: 8,\n    y: 8.7,\n    width: 4,\n    height: 0,\n    fill: \"#7ED320\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15 8.126v1.25c0 2.75-2.25 5-5 5s-5-2.25-5-5v-1.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 14.376v3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2.5A2.487 2.487 0 0 0 7.5 5v4.336c0 1.375 1.133 2.54 2.5 2.54s2.5-1.133 2.5-2.54V5c0-1.406-1.094-2.5-2.5-2.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.875 15.625 3.75 2.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })));\n};\n\nexport { SvgMicrophoneMuted as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVolumeOff = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.283 7.498h-2.72a.313.313 0 0 0-.313.313v4.375a.312.312 0 0 0 .312.312h2.721c.144 0 .284.05.396.142l3.573 2.93a.312.312 0 0 0 .498-.253V4.68a.313.313 0 0 0-.498-.252L9.68 7.357a.625.625 0 0 1-.396.141Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgVolumeOff as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgInfo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.688 2.502a7.188 7.188 0 1 0 0 14.376 7.188 7.188 0 0 0 0-14.376Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.594 8.594h1.25v4.532\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.125 13.281h3.437\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.687 5.08a1.016 1.016 0 1 0 0 2.03 1.016 1.016 0 0 0 0-2.03Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgInfo as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"MicSetupModal__content__HyAJG\",\"audio-check-container\":\"MicSetupModal__audio-check-container__DqNni\",\"audioCheckContainer\":\"MicSetupModal__audio-check-container__DqNni\",\"audio-io-container\":\"MicSetupModal__audio-io-container__p_zLQ\",\"audioIoContainer\":\"MicSetupModal__audio-io-container__p_zLQ\",\"icon-enabled\":\"MicSetupModal__icon-enabled__6YNrZ\",\"iconEnabled\":\"MicSetupModal__icon-enabled__6YNrZ\",\"icon-disabled\":\"MicSetupModal__icon-disabled__Ye6un\",\"iconDisabled\":\"MicSetupModal__icon-disabled__Ye6un\",\"icon-container\":\"MicSetupModal__icon-container__Cgq7i\",\"iconContainer\":\"MicSetupModal__icon-container__Cgq7i\",\"action-container\":\"MicSetupModal__action-container__h3C_p\",\"actionContainer\":\"MicSetupModal__action-container__h3C_p\",\"selection-container\":\"MicSetupModal__selection-container__inBu_\",\"selectionContainer\":\"MicSetupModal__selection-container__inBu_\",\"selection-input\":\"MicSetupModal__selection-input__mrlP_\",\"selectionInput\":\"MicSetupModal__selection-input__mrlP_\",\"popover\":\"MicSetupModal__popover__bua5Q\",\"popover-arrow\":\"MicSetupModal__popover-arrow__eaSQH\",\"popoverArrow\":\"MicSetupModal__popover-arrow__eaSQH\",\"popover-content\":\"MicSetupModal__popover-content__PsqFV\",\"popoverContent\":\"MicSetupModal__popover-content__PsqFV\",\"error-title\":\"MicSetupModal__error-title__ee_La\",\"errorTitle\":\"MicSetupModal__error-title__ee_La\",\"spinner-container\":\"MicSetupModal__spinner-container__Adr6x\",\"spinnerContainer\":\"MicSetupModal__spinner-container__Adr6x\",\"info-icon\":\"MicSetupModal__info-icon__Uu81j\",\"infoIcon\":\"MicSetupModal__info-icon__Uu81j\",\"level-bar\":\"MicSetupModal__level-bar__Qf5Gj\",\"levelBar\":\"MicSetupModal__level-bar__Qf5Gj\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ToggleInput.scss\";\n\nexport const ToggleInput = memo(\n  forwardRef(({ className, label, description, disabled, ...rest }, ref) => {\n    return (\n      <label className={classNames(styles.toggleInput, { [styles.disabled]: disabled }, className)}>\n        <input type=\"checkbox\" disabled={disabled} ref={ref} {...rest} />\n        <div className={classNames(styles.track)}>\n          <div className={styles.button} />\n        </div>\n        {label && (\n          <div className={styles.labelContainer}>\n            <p className={styles.label}>{label}</p>\n            {description && <p className={styles.description}>{description}</p>}\n          </div>\n        )}\n      </label>\n    );\n  })\n);\n\nToggleInput.propTypes = {\n  label: PropTypes.node,\n  description: PropTypes.node,\n  checked: PropTypes.bool,\n  disabled: PropTypes.bool,\n  className: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"toggle-input\":\"ToggleInput__toggle-input__ObbBV\",\"toggleInput\":\"ToggleInput__toggle-input__ObbBV\",\"track\":\"ToggleInput__track__EfEPA\",\"disabled\":\"ToggleInput__disabled__sDnmL\",\"label-container\":\"ToggleInput__label-container__uv2am\",\"labelContainer\":\"ToggleInput__label-container__uv2am\",\"label\":\"ToggleInput__label__kDiUc\",\"description\":\"ToggleInput__description__BoziI\",\"button\":\"ToggleInput__button__CHW2n\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { ReactComponent as MicrophoneIcon } from \"../icons/Microphone.svg\";\nimport { ReactComponent as MicrophoneMutedIcon } from \"../icons/MicrophoneMuted.svg\";\nimport { ReactComponent as VolumeOffIcon } from \"../icons/VolumeOff.svg\";\nimport { ReactComponent as InfoIcon } from \"../icons/Info.svg\";\nimport styles from \"./MicSetupModal.scss\";\nimport { BackButton } from \"../input/BackButton\";\nimport { SelectInputField } from \"../input/SelectInputField\";\nimport { ToggleInput } from \"../input/ToggleInput\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Popover } from \"../popover/Popover\";\nimport { PermissionStatus } from \"../../utils/media-devices-utils\";\nimport { Spinner } from \"../misc/Spinner\";\n\nexport function MicSetupModal({\n  className,\n  microphoneOptions,\n  onChangeMicrophone,\n  speakerOptions,\n  onChangeSpeaker,\n  isMicrophoneEnabled,\n  onPlaySound,\n  isMicrophoneMuted,\n  onChangeMicrophoneMuted,\n  onEnterRoom,\n  onBack,\n  permissionStatus,\n  isAudioInputSelectAvailable,\n  isAudioOutputSelectAvailable,\n  micLevelBar,\n  speakerLevelBar,\n  ...rest\n}) {\n  const iconStyle = isMicrophoneEnabled ? styles.iconEnabled : styles.iconDisabled;\n  return (\n    <Modal\n      title={<FormattedMessage id=\"mic-setup-modal.title\" defaultMessage=\"Microphone Setup\" />}\n      beforeTitle={<BackButton onClick={onBack} />}\n      className={className}\n      {...rest}\n    >\n      <Column center padding grow className={styles.content}>\n        <p>\n          <FormattedMessage\n            id=\"mic-setup-modal.check-mic\"\n            defaultMessage=\"Check your microphone and audio before entering.\"\n          />\n        </p>\n        <div className={styles.audioCheckContainer}>\n          <div className={styles.audioIoContainer}>\n            <div className={styles.iconContainer}>\n              <div>\n                {permissionStatus === PermissionStatus.PROMPT && (\n                  <div className={styles.spinnerContainer}>\n                    <Spinner />\n                  </div>\n                )}\n                {permissionStatus === PermissionStatus.GRANTED && isMicrophoneEnabled && !isMicrophoneMuted ? (\n                  <MicrophoneIcon className={iconStyle} />\n                ) : (\n                  <MicrophoneMutedIcon className={iconStyle} />\n                )}\n              </div>\n              {permissionStatus === PermissionStatus.GRANTED && <> {micLevelBar}</>}\n            </div>\n            <div className={styles.actionContainer}>\n              {permissionStatus === PermissionStatus.GRANTED ? (\n                <>\n                  <ToggleInput\n                    label={<FormattedMessage id=\"mic-setup-modal.mute-mic-toggle-v2\" defaultMessage=\"Mute\" />}\n                    checked={isMicrophoneMuted}\n                    onChange={onChangeMicrophoneMuted}\n                  />\n                  <Popover\n                    title=\"Info\"\n                    content={\n                      <Column className={styles.popoverContent}>\n                        <FormattedMessage\n                          id=\"mic-setup-modal.mute-mic-info\"\n                          defaultMessage=\"You can mute anytime after you enter the room\"\n                        />\n                      </Column>\n                    }\n                    placement=\"top\"\n                    showHeader={false}\n                    disableFullscreen\n                    popoverClass={styles.popover}\n                    arrowClass={styles.popoverArrow}\n                  >\n                    {({ openPopover, closePopover, triggerRef }) => (\n                      <div ref={triggerRef}>\n                        <InfoIcon className={styles.infoIcon} onMouseEnter={openPopover} onMouseLeave={closePopover} />\n                      </div>\n                    )}\n                  </Popover>\n                </>\n              ) : (\n                (permissionStatus === PermissionStatus.PROMPT && (\n                  <p>\n                    <FormattedMessage\n                      id=\"mic-setup-modal.mic-permission-prompt\"\n                      defaultMessage=\"Requesting access to your microphone...\"\n                    />\n                  </p>\n                )) ||\n                (permissionStatus === PermissionStatus.DENIED && (\n                  <p>\n                    <span className={styles.errorTitle}>\n                      <FormattedMessage\n                        id=\"mic-setup-modal.error-title\"\n                        defaultMessage=\"Microphone access was blocked.\"\n                        className={styles.errorTitle}\n                      />\n                    </span>{\" \"}\n                    <FormattedMessage\n                      id=\"mic-setup-modal.error-description\"\n                      defaultMessage=\"To talk in Hubs you will need to allow microphone access.\"\n                    />\n                  </p>\n                ))\n              )}\n            </div>\n            {permissionStatus === PermissionStatus.GRANTED &&\n              isAudioInputSelectAvailable && (\n                <div className={styles.selectionContainer}>\n                  <p style={{ alignSelf: \"start\" }}>\n                    <FormattedMessage id=\"mic-setup-modal.microphone-text\" defaultMessage=\"Microphone\" />\n                  </p>\n                  <SelectInputField\n                    className={styles.selectionInput}\n                    buttonClassName={styles.selectionInput}\n                    onChange={onChangeMicrophone}\n                    {...microphoneOptions}\n                  />\n                </div>\n              )}\n          </div>\n          <div className={styles.audioIoContainer}>\n            <div className={styles.iconContainer}>\n              <VolumeOffIcon className={styles.iconEnabled} style={{ marginRight: \"5px\" }} />\n              <> {speakerLevelBar} </>\n            </div>\n            <div className={styles.actionContainer}>\n              <Button preset=\"basic\" onClick={onPlaySound} sm>\n                <FormattedMessage id=\"mic-setup-modal.test-audio-button\" defaultMessage=\"Test Audio\" />\n              </Button>\n            </div>\n            {permissionStatus === PermissionStatus.GRANTED &&\n              isAudioOutputSelectAvailable && (\n                <div className={styles.selectionContainer}>\n                  <p style={{ alignSelf: \"start\" }}>\n                    <FormattedMessage id=\"mic-setup-modal.speakers-text\" defaultMessage=\"Speakers\" />\n                  </p>\n                  <SelectInputField\n                    onChange={onChangeSpeaker}\n                    className={styles.selectionInput}\n                    buttonClassName={styles.selectionInput}\n                    {...speakerOptions}\n                  />\n                </div>\n              )}\n          </div>\n        </div>\n        <Button preset=\"primary\" onClick={onEnterRoom}>\n          <FormattedMessage id=\"mic-setup-modal.enter-room-button\" defaultMessage=\"Enter Room\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nMicSetupModal.propTypes = {\n  className: PropTypes.string,\n  onPlaySound: PropTypes.func,\n  micLevelBar: PropTypes.node,\n  speakerLevelBar: PropTypes.node,\n  isMicrophoneEnabled: PropTypes.bool,\n  isMicrophoneMuted: PropTypes.bool,\n  onChangeMicrophoneMuted: PropTypes.func,\n  microphoneOptions: PropTypes.object,\n  onChangeMicrophone: PropTypes.func,\n  speakerOptions: PropTypes.object,\n  onChangeSpeaker: PropTypes.func,\n  onEnterRoom: PropTypes.func,\n  onBack: PropTypes.func,\n  permissionStatus: PropTypes.string,\n  isAudioInputSelectAvailable: PropTypes.bool,\n  isAudioOutputSelectAvailable: PropTypes.bool\n};\n\nMicSetupModal.defaultProps = {\n  permissionStatus: PermissionStatus.PROMPT\n};\n","import { useState, useEffect, useCallback } from \"react\";\nimport { MediaDevices, MediaDevicesEvents } from \"../../utils/media-devices-utils\";\n\nexport function useMicrophoneStatus(scene) {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [isMicMuted, setIsMicMuted] = useState(!mediaDevicesManager.isMicEnabled);\n  const [isMicEnabled, setIsMicEnabled] = useState(APP.mediaDevicesManager.isMicShared);\n  const [permissionStatus, setPermissionsStatus] = useState(\n    mediaDevicesManager.getPermissionsStatus(MediaDevices.MICROPHONE)\n  );\n\n  useEffect(\n    () => {\n      const onMicMutedStateChanged = ({ enabled }) => {\n        setIsMicMuted(!enabled);\n      };\n      APP.dialog.on(\"mic-state-changed\", onMicMutedStateChanged);\n\n      const onMicEnabled = () => {\n        setIsMicEnabled(true);\n      };\n      const onMicDisabled = () => {\n        setIsMicEnabled(false);\n      };\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n\n      const onPermissionsChanged = ({ mediaDevice, status }) => {\n        if (mediaDevice === MediaDevices.MICROPHONE) {\n          setPermissionsStatus(status);\n        }\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n\n      return () => {\n        APP.dialog.off(\"mic-state-changed\", onMicMutedStateChanged);\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n        mediaDevicesManager.off(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n      };\n    },\n    [setIsMicMuted, setIsMicEnabled, setPermissionsStatus, scene, mediaDevicesManager]\n  );\n\n  const toggleMute = useCallback(\n    () => {\n      if (mediaDevicesManager.isMicShared) {\n        mediaDevicesManager.toggleMic();\n      } else {\n        mediaDevicesManager.startMicShare({ unmute: true });\n      }\n    },\n    [mediaDevicesManager]\n  );\n\n  return {\n    isMicMuted,\n    toggleMute,\n    isMicEnabled,\n    permissionStatus\n  };\n}\n","import { useState, useEffect, useCallback } from \"react\";\nimport { MediaDevices, MediaDevicesEvents } from \"../../utils/media-devices-utils\";\n\nexport function useMicrophone(scene) {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [micDevices, setMicDevices] = useState({\n    value: mediaDevicesManager.selectedMicDeviceId,\n    options: mediaDevicesManager.micDevicesOptions\n  });\n\n  useEffect(\n    () => {\n      const onMicEnabled = () => {\n        setMicDevices({\n          value: mediaDevicesManager.selectedMicDeviceId,\n          options: mediaDevicesManager.micDevicesOptions\n        });\n      };\n      const onMicDisabled = () => {\n        setMicDevices({\n          value: mediaDevicesManager.selectedMicDeviceId,\n          options: mediaDevicesManager.micDevicesOptions\n        });\n      };\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n      scene.addEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n\n      const onPermissionsChanged = ({ mediaDevice }) => {\n        if (mediaDevice === MediaDevices.MICROPHONE) {\n          setMicDevices({\n            value: mediaDevicesManager.selectedMicDeviceId,\n            options: mediaDevicesManager.micDevicesOptions\n          });\n        }\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n\n      const onDeviceChange = () => {\n        setMicDevices({\n          value: mediaDevicesManager.selectedMicDeviceId,\n          options: mediaDevicesManager.micDevicesOptions\n        });\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n\n      setMicDevices({\n        value: mediaDevicesManager.selectedMicDeviceId,\n        options: mediaDevicesManager.micDevicesOptions\n      });\n\n      return () => {\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, onMicDisabled);\n        scene.removeEventListener(MediaDevicesEvents.MIC_SHARE_STARTED, onMicEnabled);\n        mediaDevicesManager.off(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n        mediaDevicesManager.off(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n      };\n    },\n    [setMicDevices, scene, mediaDevicesManager]\n  );\n\n  const micDeviceChanged = useCallback(\n    deviceId => {\n      setMicDevices({\n        value: mediaDevicesManager.selectedMicDeviceId,\n        options: mediaDevicesManager.micDevicesOptions\n      });\n      mediaDevicesManager.startMicShare({ deviceId });\n    },\n    [mediaDevicesManager]\n  );\n\n  return {\n    micDeviceChanged,\n    micDevices\n  };\n}\n","import { useRef, useCallback } from \"react\";\n\nexport function useSound({ scene, sound }) {\n  const sfxSystem = scene.systems[\"hubs-systems\"].soundEffectsSystem;\n  const analyserRef = useRef(scene.systems[\"hubs-systems\"].audioSystem.mixerAnalyser);\n\n  const playSound = useCallback(\n    () => {\n      sfxSystem.playSoundOneShot(sound).connect(analyserRef.current);\n    },\n    [sound, sfxSystem]\n  );\n\n  return { playSound };\n}\n","import { useState, useEffect, useCallback } from \"react\";\nimport { MediaDevices, MediaDevicesEvents } from \"../../utils/media-devices-utils\";\n\nexport function useSpeakers() {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [speakerDevices, setSpeakerDevices] = useState({\n    value: mediaDevicesManager.selectedSpeakersDeviceId,\n    options: mediaDevicesManager.outputDevicesOptions\n  });\n\n  useEffect(\n    () => {\n      const onPermissionsChanged = ({ mediaDevice }) => {\n        if (mediaDevice === MediaDevices.MICROPHONE) {\n          setSpeakerDevices({\n            value: mediaDevicesManager.selectedSpeakersDeviceId,\n            options: mediaDevicesManager.outputDevicesOptions\n          });\n        }\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n\n      const onDeviceChange = () => {\n        setSpeakerDevices({\n          value: mediaDevicesManager.selectedSpeakersDeviceId,\n          options: mediaDevicesManager.outputDevicesOptions\n        });\n      };\n      mediaDevicesManager.on(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n\n      setSpeakerDevices({\n        value: mediaDevicesManager.selectedSpeakersDeviceId,\n        options: mediaDevicesManager.outputDevicesOptions\n      });\n\n      return () => {\n        mediaDevicesManager.off(MediaDevicesEvents.PERMISSIONS_STATUS_CHANGED, onPermissionsChanged);\n        mediaDevicesManager.off(MediaDevicesEvents.DEVICE_CHANGE, onDeviceChange);\n      };\n    },\n    [setSpeakerDevices, mediaDevicesManager]\n  );\n\n  const speakerDeviceChanged = useCallback(\n    deviceId => {\n      mediaDevicesManager.changeAudioOutput(deviceId);\n      setSpeakerDevices({\n        value: mediaDevicesManager.selectedSpeakersDeviceId,\n        options: mediaDevicesManager.outputDevicesOptions\n      });\n    },\n    [mediaDevicesManager]\n  );\n\n  return {\n    speakerDeviceChanged,\n    speakerDevices\n  };\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"level-bar-container\":\"LevelBar__level-bar-container__mZX3P\",\"levelBarContainer\":\"LevelBar__level-bar-container__mZX3P\",\"level-bar-border\":\"LevelBar__level-bar-border__iciQ1\",\"levelBarBorder\":\"LevelBar__level-bar-border__iciQ1\",\"level-bar\":\"LevelBar__level-bar__AhD98\",\"levelBar\":\"LevelBar__level-bar__AhD98\"};","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./LevelBar.scss\";\n\nexport const LevelBar = forwardRef(({ className }, ref) => {\n  return (\n    <div className={classNames(styles.levelBarContainer, className)}>\n      <div className={styles.levelBarBorder} />\n      <div ref={ref} className={styles.levelBar} />\n    </div>\n  );\n});\n\nLevelBar.propTypes = {\n  className: PropTypes.string\n};\n","import { useEffect, useRef } from \"react\";\nimport MovingAverage from \"moving-average\";\n\nconst MIN_VOLUME_THRESHOLD = 0.08;\n\nconst calculateVolume = (analyser, levels) => {\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n  analyser.getByteTimeDomainData(levels);\n  let sum = 0;\n  for (let i = 0; i < levels.length; i++) {\n    const amplitude = (levels[i] - 128) / 128;\n    sum += amplitude * amplitude;\n  }\n  const currVolume = Math.sqrt(sum / levels.length);\n  return currVolume;\n};\n\nfunction updateVolume(analyser, meter) {\n  const newRawVolume = calculateVolume(analyser, meter.levels);\n\n  const newPerceivedVolume = Math.log(THREE.MathUtils.mapLinear(newRawVolume, 0, 1, 1, Math.E));\n\n  meter.volume = newPerceivedVolume < MIN_VOLUME_THRESHOLD ? 0 : newPerceivedVolume;\n\n  const s = meter.volume > meter.prevVolume ? 0.35 : 0.3;\n  meter.volume = s * meter.volume + (1 - s) * meter.prevVolume;\n  meter.prevVolume = meter.volume;\n}\n\nexport function useVolumeMeter({ analyser, update, updateRate = 50 }) {\n  const movingAvgRef = useRef();\n  const meterRef = useRef({ levels: [], volume: 0, prevVolume: 0, max: 0 });\n\n  useEffect(\n    () => {\n      if (!movingAvgRef.current) {\n        movingAvgRef.current = MovingAverage(updateRate * 2);\n      }\n\n      analyser.fftSize = 32;\n      meterRef.current.levels = new Uint8Array(analyser.fftSize);\n\n      let prevVolume = 0;\n      const timout = setInterval(() => {\n        updateVolume(analyser, meterRef.current);\n\n        meterRef.current.max = Math.max(meterRef.current.volume, meterRef.current.max);\n\n        // We use a moving average to smooth out the visual animation or else it would twitch too fast for\n        // the css renderer to keep up.\n        movingAvgRef.current.push(Date.now(), meterRef.current.volume);\n        const average = movingAvgRef.current.movingAverage();\n        const nextVolume = meterRef.current.max === 0 ? 0 : average / meterRef.current.max;\n        const volume = Math.max(Math.abs(prevVolume - nextVolume) > 0.05 ? nextVolume : prevVolume, 0.1);\n        prevVolume = volume;\n        update(volume);\n      }, updateRate);\n\n      return () => {\n        clearInterval(timout);\n      };\n    },\n    [analyser, update, updateRate]\n  );\n}\n","import React, { useRef, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./LevelBar.scss\";\nimport { LevelBar } from \"./LevelBar\";\nimport { useVolumeMeter } from \"../misc/useVolumeMeter\";\n\nexport const types = [\"mic\", \"mixer\"];\n\nexport function VolumeLevelBar({ scene, type, className }) {\n  const ref = useRef();\n  const update = useCallback(level => {\n    const node = ref.current;\n    if (node) {\n      const pct = level * 100;\n      if (node.clientWidth > node.clientHeight) {\n        node.style.clipPath = `polygon(0% 100%, ${pct}% 100%, ${pct}% 0%, 0% 0%)`;\n      } else {\n        node.style.clipPath = `polygon(0% 100%, 100% 100%, 100% ${100 - pct}%, 0% ${100 - pct}%)`;\n      }\n    }\n  }, []);\n  useVolumeMeter({\n    analyser:\n      type == \"mic\"\n        ? scene.systems[\"hubs-systems\"].audioSystem.outboundAnalyser\n        : scene.systems[\"hubs-systems\"].audioSystem.mixerAnalyser,\n    update\n  });\n  return <LevelBar ref={ref} className={classNames(styles.levelBarContainer, className)} />;\n}\n\nVolumeLevelBar.propTypes = {\n  scene: PropTypes.object.isRequired,\n  type: PropTypes.oneOf(types),\n  className: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { MicSetupModal } from \"./MicSetupModal\";\nimport { useMicrophoneStatus } from \"./useMicrophoneStatus\";\nimport { useMicrophone } from \"./useMicrophone\";\nimport { useSound } from \"./useSound\";\nimport { SOUND_SPEAKER_TONE } from \"../../systems/sound-effects-system\";\nimport { useSpeakers } from \"./useSpeakers\";\nimport { useCallback } from \"react\";\nimport { useState } from \"react\";\nimport MediaDevicesManager from \"../../utils/media-devices-manager\";\nimport { VolumeLevelBar } from \"../misc/VolumeLevelBar\";\nimport styles from \"./MicSetupModal.scss\";\n\nexport function MicSetupModalContainer({ scene, ...rest }) {\n  const { isMicEnabled, permissionStatus } = useMicrophoneStatus(scene);\n  const { micDeviceChanged, micDevices } = useMicrophone(scene);\n  const { speakerDeviceChanged, speakerDevices } = useSpeakers();\n  const { playSound } = useSound({\n    scene,\n    sound: SOUND_SPEAKER_TONE\n  });\n  const [isMicMutedOnEntry, setIsMicMutedOnEntry] = useState(APP.store.state.preferences[\"muteMicOnEntry\"]);\n  const onChangeMicrophoneMuted = useCallback(({ target: { checked: muted } }) => {\n    setIsMicMutedOnEntry(muted);\n    APP.store.update({\n      preferences: { muteMicOnEntry: muted }\n    });\n  }, []);\n\n  return (\n    <MicSetupModal\n      micLevelBar={<VolumeLevelBar scene={scene} type=\"mic\" className={styles.levelBar} />}\n      speakerLevelBar={<VolumeLevelBar scene={scene} type=\"mixer\" className={styles.levelBar} />}\n      onPlaySound={playSound}\n      isMicrophoneEnabled={isMicEnabled}\n      isMicrophoneMuted={isMicMutedOnEntry}\n      permissionStatus={permissionStatus}\n      microphoneOptions={micDevices}\n      speakerOptions={speakerDevices}\n      onChangeMicrophone={micDeviceChanged}\n      onChangeSpeaker={speakerDeviceChanged}\n      onChangeMicrophoneMuted={onChangeMicrophoneMuted}\n      isAudioInputSelectAvailable={MediaDevicesManager.isAudioInputSelectEnabled}\n      isAudioOutputSelectAvailable={MediaDevicesManager.isAudioOutputSelectEnabled}\n      {...rest}\n    />\n  );\n}\n\nMicSetupModalContainer.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"invite-popover\":\"InvitePopover__invite-popover__hQEWt\",\"invitePopover\":\"InvitePopover__invite-popover__hQEWt\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useClipboard } from \"use-clipboard-copy\";\nimport { TextInputField } from \"./TextInputField\";\nimport { Button } from \"./Button\";\nimport styles from \"./CopyableTextInputField.scss\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst copyLabelMessage = defineMessage({\n  id: \"copyable-text-input-field.copy-label\",\n  defaultMessage: \"Copy\"\n});\n\nconst copiedLabelMessage = defineMessage({\n  id: \"copyable-text-input-field.copied-label\",\n  defaultMessage: \"Copied\"\n});\n\nexport function CopyableTextInputField({ buttonPreset, ...rest }) {\n  const clipboard = useClipboard({\n    copiedTimeout: 600\n  });\n\n  const intl = useIntl();\n\n  const copyLabel = intl.formatMessage(copyLabelMessage);\n  const copiedLabel = intl.formatMessage(copiedLabelMessage);\n\n  // Use a dynamic width based on the content to account for i18n\n  const maxLabelLength = Math.max(copyLabel.length, copiedLabel.length);\n\n  return (\n    <TextInputField\n      ref={clipboard.target}\n      afterInput={\n        clipboard.isSupported() ? (\n          <Button\n            preset={buttonPreset}\n            onClick={clipboard.copy}\n            className={styles.copyButton}\n            style={{ width: `${maxLabelLength}ch` }} // ch is a unit representing the width of the 0 character\n          >\n            {clipboard.copied ? copiedLabel : copyLabel}\n          </Button>\n        ) : (\n          undefined\n        )\n      }\n      {...rest}\n    />\n  );\n}\n\nCopyableTextInputField.propTypes = {\n  buttonPreset: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"copy-button\":\"CopyableTextInputField__copy-button__KHz3G\",\"copyButton\":\"CopyableTextInputField__copy-button__KHz3G\"};","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgInvite = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.563 3.751H3.438c-.863 0-1.563.7-1.563 1.562v9.375c0 .863.7 1.563 1.563 1.563h13.124c.863 0 1.563-.7 1.563-1.563V5.313c0-.862-.7-1.562-1.563-1.562Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.375 6.251 10 10.626l5.625-4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgInvite as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"room-permissions\":\"RoomSettingsSidebar__room-permissions__AoDPm\",\"roomPermissions\":\"RoomSettingsSidebar__room-permissions__AoDPm\",\"permissions-group\":\"RoomSettingsSidebar__permissions-group__u2KNv\",\"permissionsGroup\":\"RoomSettingsSidebar__permissions-group__u2KNv\",\"confirm-revoke-button\":\"RoomSettingsSidebar__confirm-revoke-button__i2XAf\",\"confirmRevokeButton\":\"RoomSettingsSidebar__confirm-revoke-button__i2XAf\"};","import React, { useState, useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./RoomSettingsSidebar.scss\";\nimport { IconButton } from \"../input/IconButton\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { CopyableTextInputField } from \"../input/CopyableTextInputField\";\n\nexport function InviteLinkInputField({ fetchingInvite, inviteUrl, onRevokeInvite }) {\n  const intl = useIntl();\n\n  const [showRevokeConfirmation, setShowRevokeConfirmation] = useState(false);\n\n  const revokeInvite = useCallback(() => {\n    setShowRevokeConfirmation(true);\n  }, []);\n\n  const cancelConfirmRevokeInvite = useCallback(() => {\n    setShowRevokeConfirmation(false);\n  }, []);\n\n  const confirmRevokeInvite = useCallback(\n    () => {\n      onRevokeInvite();\n      setShowRevokeConfirmation(false);\n    },\n    [onRevokeInvite]\n  );\n\n  return (\n    <CopyableTextInputField\n      label={<FormattedMessage id=\"invite-link-input-field.label\" defaultMessage=\"Invite link\" />}\n      disabled={fetchingInvite}\n      value={\n        fetchingInvite\n          ? intl.formatMessage({\n              id: \"invite-link-input-field.generating-invite\",\n              defaultMessage: \"Generating invite...\"\n            })\n          : inviteUrl\n      }\n      buttonPreset=\"primary\"\n      description={\n        !fetchingInvite &&\n        (showRevokeConfirmation ? (\n          <>\n            <FormattedMessage id=\"invite-link-input-field.revoke-confirm\" defaultMessage=\"are you sure?\" />{\" \"}\n            <IconButton className={styles.confirmRevokeButton} onClick={confirmRevokeInvite}>\n              <FormattedMessage id=\"invite-link-input-field.revoke-confirm-yes\" defaultMessage=\"yes\" />\n            </IconButton>{\" \"}\n            /{\" \"}\n            <IconButton className={styles.confirmRevokeButton} onClick={cancelConfirmRevokeInvite}>\n              <FormattedMessage id=\"invite-link-input-field.revoke-confirm-no\" defaultMessage=\"no\" />\n            </IconButton>\n          </>\n        ) : (\n          <IconButton className={styles.confirmRevokeButton} onClick={revokeInvite}>\n            <FormattedMessage id=\"invite-link-input-field.revoke\" defaultMessage=\"revoke\" />\n          </IconButton>\n        ))\n      }\n      fullWidth\n    />\n  );\n}\n\nInviteLinkInputField.propTypes = {\n  fetchingInvite: PropTypes.bool,\n  inviteUrl: PropTypes.string,\n  onRevokeInvite: PropTypes.func.isRequired\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./InvitePopover.scss\";\nimport { CopyableTextInputField } from \"../input/CopyableTextInputField\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as InviteIcon } from \"../icons/Invite.svg\";\nimport { Column } from \"../layout/Column\";\nimport { InviteLinkInputField } from \"./InviteLinkInputField\";\nimport { FormattedMessage, defineMessage, useIntl } from \"react-intl\";\n\nfunction InvitePopoverContent({ url, embed, inviteRequired, fetchingInvite, inviteUrl, revokeInvite }) {\n  return (\n    <Column center padding grow gap=\"lg\" className={styles.invitePopover}>\n      {inviteRequired ? (\n        <>\n          <InviteLinkInputField fetchingInvite={fetchingInvite} inviteUrl={inviteUrl} onRevokeInvite={revokeInvite} />\n        </>\n      ) : (\n        <>\n          <CopyableTextInputField\n            label={<FormattedMessage id=\"invite-popover.room-link\" defaultMessage=\"Room Link\" />}\n            value={url}\n            buttonPreset=\"accent3\"\n          />\n          <CopyableTextInputField\n            label={<FormattedMessage id=\"invite-popover.embed-code\" defaultMessage=\"Embed Code\" />}\n            value={embed}\n            buttonPreset=\"accent5\"\n          />\n        </>\n      )}\n    </Column>\n  );\n}\n\nInvitePopoverContent.propTypes = {\n  url: PropTypes.string.isRequired,\n  embed: PropTypes.string.isRequired,\n  inviteRequired: PropTypes.bool,\n  fetchingInvite: PropTypes.bool,\n  inviteUrl: PropTypes.string,\n  revokeInvite: PropTypes.func\n};\n\nconst invitePopoverTitle = defineMessage({\n  id: \"invite-popover.title\",\n  defaultMessage: \"Invite\"\n});\n\nexport function InvitePopoverButton({\n  url,\n  embed,\n  initiallyVisible,\n  popoverApiRef,\n  inviteRequired,\n  fetchingInvite,\n  inviteUrl,\n  revokeInvite,\n  ...rest\n}) {\n  const intl = useIntl();\n  const title = intl.formatMessage(invitePopoverTitle);\n\n  return (\n    <Popover\n      title={title}\n      content={() => (\n        <InvitePopoverContent\n          url={url}\n          embed={embed}\n          inviteRequired={inviteRequired}\n          fetchingInvite={fetchingInvite}\n          inviteUrl={inviteUrl}\n          revokeInvite={revokeInvite}\n        />\n      )}\n      placement=\"top-start\"\n      offsetDistance={28}\n      initiallyVisible={initiallyVisible}\n      popoverApiRef={popoverApiRef}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<InviteIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n          {...rest}\n        />\n      )}\n    </Popover>\n  );\n}\n\nInvitePopoverButton.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  popoverApiRef: PropTypes.object,\n  ...InvitePopoverContent.propTypes\n};\n","import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { hubUrl } from \"../../utils/phoenix-utils\";\n\nexport function useInviteUrl(hubChannel, disabled = false) {\n  const [inviteId, setInviteId] = useState();\n\n  useEffect(\n    () => {\n      setInviteId(undefined);\n\n      if (disabled) {\n        return;\n      }\n\n      hubChannel\n        .fetchInvite()\n        .then(({ hub_invite_id }) => {\n          if (disabled) {\n            return;\n          }\n\n          setInviteId(hub_invite_id);\n        })\n        .catch(error => {\n          console.error(\"Error fetching invite\", error);\n        });\n    },\n    [hubChannel, disabled]\n  );\n\n  const revokeInvite = useCallback(\n    () => {\n      setInviteId(undefined);\n\n      if (disabled) {\n        return;\n      }\n\n      hubChannel\n        .revokeInvite(inviteId)\n        .then(({ hub_invite_id }) => {\n          if (disabled) {\n            return;\n          }\n\n          setInviteId(hub_invite_id);\n        })\n        .catch(error => {\n          console.error(\"Error revoking invite\", error);\n        });\n    },\n    [inviteId, hubChannel, disabled]\n  );\n\n  const inviteUrl = useMemo(\n    () => {\n      if (inviteId && !disabled) {\n        const url = hubUrl();\n        url.searchParams.set(\"hub_invite_id\", inviteId);\n        return url.toString();\n      }\n\n      return undefined;\n    },\n    [inviteId, disabled]\n  );\n\n  const fetchingInvite = !inviteId && !disabled;\n\n  return { fetchingInvite, inviteUrl, revokeInvite };\n}\n","import React, { useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { hubUrl } from \"../../utils/phoenix-utils\";\nimport { InvitePopoverButton } from \"./InvitePopover\";\nimport { handleExitTo2DInterstitial } from \"../../utils/vr-interstitial\";\nimport { useInviteUrl } from \"./useInviteUrl\";\n\nexport function InvitePopoverContainer({ hub, hubChannel, scene, ...rest }) {\n  // TODO: Move to Hub class\n  const shortUrl = `https://${configs.SHORTLINK_DOMAIN}`;\n  const url = `${shortUrl}/${hub.hub_id}`;\n  const embedUrl = hubUrl(hub.hub_id, { embed_token: hub.embed_token });\n  const embedText = `<iframe src=\"${embedUrl}\" style=\"width: 1024px; height: 768px;\" allow=\"microphone; camera; vr; speaker;\"></iframe>`;\n  const popoverApiRef = useRef();\n\n  // Handle clicking on the invite button while in VR.\n  useEffect(\n    () => {\n      function onInviteButtonClicked() {\n        handleExitTo2DInterstitial(true, () => {}).then(() => {\n          popoverApiRef.current.openPopover();\n        });\n      }\n\n      scene.addEventListener(\"action_invite\", onInviteButtonClicked);\n\n      return () => {\n        scene.removeEventListener(\"action_invite\", onInviteButtonClicked);\n      };\n    },\n    [scene, popoverApiRef]\n  );\n\n  const inviteRequired = hub.entry_mode === \"invite\";\n  const canGenerateInviteUrl = hubChannel.can(\"update_hub\");\n\n  const { fetchingInvite, inviteUrl, revokeInvite } = useInviteUrl(\n    hubChannel,\n    !inviteRequired || !canGenerateInviteUrl\n  );\n\n  if (inviteRequired && !canGenerateInviteUrl) {\n    return null;\n  }\n\n  return (\n    <InvitePopoverButton\n      inviteRequired={inviteRequired}\n      fetchingInvite={fetchingInvite}\n      inviteUrl={inviteUrl}\n      revokeInvite={revokeInvite}\n      url={url}\n      embed={embedText}\n      popoverApiRef={popoverApiRef}\n      {...rest}\n    />\n  );\n}\n\nInvitePopoverContainer.propTypes = {\n  hub: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"more-menu-popover\":\"MoreMenuPopover__more-menu-popover__isNqe\",\"moreMenuPopover\":\"MoreMenuPopover__more-menu-popover__isNqe\",\"more-menu-group-label\":\"MoreMenuPopover__more-menu-group-label__jynY8\",\"moreMenuGroupLabel\":\"MoreMenuPopover__more-menu-group-label__jynY8\",\"more-menu-item-list\":\"MoreMenuPopover__more-menu-item-list__Py2Fs\",\"moreMenuItemList\":\"MoreMenuPopover__more-menu-item-list__Py2Fs\",\"more-menu-item-target\":\"MoreMenuPopover__more-menu-item-target__AobaZ\",\"moreMenuItemTarget\":\"MoreMenuPopover__more-menu-item-target__AobaZ\",\"compact-button\":\"MoreMenuPopover__compact-button__n0DoJ\",\"compactButton\":\"MoreMenuPopover__compact-button__n0DoJ\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgMore = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 12.25a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 6a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgMore as ReactComponent };","import React, { createContext, useContext, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./MoreMenuPopover.scss\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as MoreIcon } from \"../icons/More.svg\";\nimport { useIntl, defineMessage } from \"react-intl\";\n\nfunction MoreMenuItem({ item, closePopover }) {\n  const Icon = item.icon;\n\n  return (\n    <li onClick={closePopover}>\n      {item.href ? (\n        <a\n          className={styles.moreMenuItemTarget}\n          href={item.href}\n          target={item.target || \"_blank\"}\n          rel=\"noopener noreferrer\"\n        >\n          <Icon />\n          <span>{item.label}</span>\n        </a>\n      ) : (\n        <button className={styles.moreMenuItemTarget} onClick={event => item.onClick(item, event)}>\n          <Icon />\n          <span>{item.label}</span>\n        </button>\n      )}\n    </li>\n  );\n}\n\nMoreMenuItem.propTypes = {\n  item: PropTypes.shape({\n    href: PropTypes.string,\n    target: PropTypes.string,\n    icon: PropTypes.elementType.isRequired,\n    label: PropTypes.node.isRequired,\n    onClick: PropTypes.func\n  }).isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n\nfunction MoreMenuGroup({ group, closePopover }) {\n  return (\n    <li>\n      <h1 className={styles.moreMenuGroupLabel}>{group.label}</h1>\n      <ul className={styles.moreMenuItemList}>\n        {group.items.map(item => <MoreMenuItem key={item.id} item={item} closePopover={closePopover} />)}\n      </ul>\n    </li>\n  );\n}\n\nMoreMenuGroup.propTypes = {\n  group: PropTypes.object.isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n\nfunction MoreMenuPopoverContent({ menu, closePopover }) {\n  return (\n    <div className={styles.moreMenuPopover}>\n      <ul>{menu.map(group => <MoreMenuGroup key={group.id} group={group} closePopover={closePopover} />)}</ul>\n    </div>\n  );\n}\n\nMoreMenuPopoverContent.propTypes = {\n  menu: PropTypes.array.isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n\n// The MoreMenuContext allows us to control the more menu popover visibility from the MoreMenuPopoverButton\n// and CompactMoreMenuButton.\nconst MoreMenuContext = createContext([false, () => {}]);\n\nexport function MoreMenuContextProvider({ initiallyVisible, children }) {\n  const context = useState(initiallyVisible || false);\n  return <MoreMenuContext.Provider value={context}>{children}</MoreMenuContext.Provider>;\n}\n\nMoreMenuContextProvider.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  children: PropTypes.node\n};\n\nconst moreMenuTitle = defineMessage({\n  id: \"more-menu-popover.title\",\n  defaultMessage: \"More\"\n});\n\nexport function MoreMenuPopoverButton({ menu }) {\n  const intl = useIntl();\n  const [visible, setVisible] = useContext(MoreMenuContext);\n  const title = intl.formatMessage(moreMenuTitle);\n\n  return (\n    <Popover\n      title={title}\n      content={props => <MoreMenuPopoverContent menu={menu} {...props} />}\n      placement=\"top-end\"\n      offsetDistance={28}\n      isVisible={visible}\n      onChangeVisible={setVisible}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<MoreIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n        />\n      )}\n    </Popover>\n  );\n}\n\nMoreMenuPopoverButton.propTypes = {\n  menu: PropTypes.array.isRequired\n};\n\n// The CompactMoreMenuButton is only shown in the small breakpoint.\n// We actually render the popover in the MoreMenuPopoverButton so that when resizing the window,\n// the popover positions itself relative to the correct element.\nexport function CompactMoreMenuButton({ className, ...rest }) {\n  const intl = useIntl();\n  const [, setVisible] = useContext(MoreMenuContext);\n\n  return (\n    <button\n      className={classNames(styles.compactButton, className)}\n      aria-label={intl.formatMessage(moreMenuTitle)}\n      onClick={e => {\n        // Stop event bubbling so we don't immediately close the popover by clicking outside it.\n        e.stopPropagation();\n        setVisible(true);\n      }}\n      {...rest}\n    >\n      <MoreIcon />\n    </button>\n  );\n}\n\nCompactMoreMenuButton.propTypes = {\n  className: PropTypes.string\n};\n","import React, { createContext, useCallback, useContext, useEffect, useState, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  ChatSidebar,\n  ChatMessageGroup,\n  SystemMessage,\n  ChatMessageList,\n  ChatInput,\n  MessageAttachmentButton,\n  SpawnMessageButton,\n  ChatToolbarButton,\n  SendMessageButton,\n  EmojiPickerPopoverButton,\n  ChatLengthWarning\n} from \"./ChatSidebar\";\nimport { useMaintainScrollPosition } from \"../misc/useMaintainScrollPosition\";\nimport { spawnChatMessage } from \"../chat-message\";\nimport { discordBridgesForPresences } from \"../../utils/phoenix-utils\";\nimport { useIntl } from \"react-intl\";\nimport { MAX_MESSAGE_LENGTH } from \"../../utils/chat-message\";\n\nconst ChatContext = createContext({ messageGroups: [], sendMessage: () => {} });\n\nlet uniqueMessageId = 0;\n\nconst NEW_MESSAGE_GROUP_TIMEOUT = 1000 * 60;\n\nfunction shouldCreateNewMessageGroup(messageGroups, newMessage, now) {\n  if (messageGroups.length === 0) {\n    return true;\n  }\n\n  const lastMessageGroup = messageGroups[messageGroups.length - 1];\n\n  if (lastMessageGroup.senderSessionId !== newMessage.sessionId) {\n    return true;\n  }\n\n  const lastMessage = lastMessageGroup.messages[lastMessageGroup.messages.length - 1];\n\n  return now - lastMessage.timestamp > NEW_MESSAGE_GROUP_TIMEOUT;\n}\n\nfunction processChatMessage(messageGroups, newMessage) {\n  const now = Date.now();\n  const { name, sent, sessionId, ...messageProps } = newMessage;\n\n  if (shouldCreateNewMessageGroup(messageGroups, newMessage, now)) {\n    return [\n      ...messageGroups,\n      {\n        id: uniqueMessageId++,\n        timestamp: now,\n        sent,\n        sender: name,\n        senderSessionId: sessionId,\n        messages: [{ id: uniqueMessageId++, timestamp: now, ...messageProps }]\n      }\n    ];\n  }\n\n  const lastMessageGroup = messageGroups.pop();\n  lastMessageGroup.messages = [\n    ...lastMessageGroup.messages,\n    { id: uniqueMessageId++, timestamp: now, ...messageProps }\n  ];\n\n  return [...messageGroups, { ...lastMessageGroup }];\n}\n\n// Returns the new message groups array when we receive a message.\n// If the message is ignored, we return the original message group array.\nfunction updateMessageGroups(messageGroups, newMessage) {\n  switch (newMessage.type) {\n    case \"join\":\n    case \"entered\":\n    case \"leave\":\n    case \"display_name_changed\":\n    case \"scene_changed\":\n    case \"hub_name_changed\":\n    case \"hub_changed\":\n    case \"log\":\n      return [\n        ...messageGroups,\n        {\n          id: uniqueMessageId++,\n          systemMessage: true,\n          timestamp: Date.now(),\n          ...newMessage\n        }\n      ];\n    case \"chat\":\n    case \"image\":\n    case \"photo\":\n    case \"video\":\n      return processChatMessage(messageGroups, newMessage);\n    default:\n      return messageGroups;\n  }\n}\n\nexport function ChatContextProvider({ messageDispatch, children }) {\n  const [messageGroups, setMessageGroups] = useState([]);\n  const [unreadMessages, setUnreadMessages] = useState(false);\n\n  useEffect(\n    () => {\n      function onReceiveMessage(event) {\n        const newMessage = event.detail;\n        setMessageGroups(messages => updateMessageGroups(messages, newMessage));\n\n        if (\n          newMessage.type === \"chat\" ||\n          newMessage.type === \"image\" ||\n          newMessage.type === \"photo\" ||\n          newMessage.type === \"video\"\n        ) {\n          setUnreadMessages(true);\n        }\n      }\n\n      if (messageDispatch) {\n        messageDispatch.addEventListener(\"message\", onReceiveMessage);\n      }\n\n      return () => {\n        if (messageDispatch) {\n          messageDispatch.removeEventListener(\"message\", onReceiveMessage);\n        }\n      };\n    },\n    [messageDispatch, setMessageGroups, setUnreadMessages]\n  );\n\n  const sendMessage = useCallback(\n    message => {\n      if (messageDispatch) {\n        messageDispatch.dispatch(message);\n      }\n    },\n    [messageDispatch]\n  );\n\n  const setMessagesRead = useCallback(\n    () => {\n      setUnreadMessages(false);\n    },\n    [setUnreadMessages]\n  );\n\n  return (\n    <ChatContext.Provider value={{ messageGroups, unreadMessages, sendMessage, setMessagesRead }}>\n      {children}\n    </ChatContext.Provider>\n  );\n}\n\nChatContextProvider.propTypes = {\n  children: PropTypes.node,\n  messageDispatch: PropTypes.object\n};\n\nexport function ChatSidebarContainer({ scene, canSpawnMessages, presences, occupantCount, inputEffect, onClose }) {\n  const { messageGroups, sendMessage, setMessagesRead } = useContext(ChatContext);\n  const [onScrollList, listRef, scrolledToBottom] = useMaintainScrollPosition(messageGroups);\n  const [message, setMessage] = useState(\"\");\n  const typingTimeoutRef = useRef();\n  const intl = useIntl();\n  const inputRef = useRef();\n\n  const onKeyDown = useCallback(\n    e => {\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault();\n        if (e.target.value.length <= MAX_MESSAGE_LENGTH) {\n          sendMessage(e.target.value);\n          setMessage(\"\");\n          // intentionally only doing this on \"enter\" press and not clicking of send button\n          if (e.target.value.startsWith(\"/\")) {\n            onClose();\n          }\n        }\n      } else if (e.key === \"Escape\") {\n        onClose();\n      }\n      clearTimeout(typingTimeoutRef.current);\n      typingTimeoutRef.current = setTimeout(() => window.APP.hubChannel.endTyping(), 500);\n      window.APP.hubChannel.beginTyping();\n    },\n    [sendMessage, setMessage, onClose]\n  );\n\n  const onSendMessage = useCallback(\n    () => {\n      sendMessage(message.substring(0, MAX_MESSAGE_LENGTH));\n      setMessage(\"\");\n    },\n    [message, sendMessage, setMessage]\n  );\n\n  const onSpawnMessage = () => {\n    spawnChatMessage(message);\n    setMessage(\"\");\n  };\n\n  const onUploadAttachments = useCallback(\n    e => {\n      // TODO: Right now there's no way to upload files to the chat only.\n      // When we add the place menu whcih will have an explicit button for uploading files,\n      // should we make this attach button only upload to chat?\n      for (const file of e.target.files) {\n        scene.emit(\"add_media\", file);\n      }\n    },\n    [scene]\n  );\n\n  const onSelectEmoji = useCallback(\n    ({ emoji, pickerRemainedOpen }) => {\n      setMessage(message => message + emoji.native);\n      // If the picker remained open, avoid selecting the input so that the\n      // user can keep picking emojis.\n      if (!pickerRemainedOpen) inputRef.current.select();\n    },\n    [setMessage, inputRef]\n  );\n\n  useEffect(() => inputEffect(inputRef.current), [inputEffect, inputRef]);\n\n  useEffect(\n    () => {\n      if (scrolledToBottom) {\n        setMessagesRead();\n      }\n    },\n    [messageGroups, scrolledToBottom, setMessagesRead]\n  );\n\n  const discordBridges = discordBridgesForPresences(presences);\n  const discordSnippet = discordBridges.map(ch => \"#\" + ch).join(\", \");\n  let placeholder;\n\n  if (occupantCount <= 1) {\n    if (discordBridges.length === 0) {\n      placeholder = intl.formatMessage({\n        id: \"chat-sidebar-container.input-placeholder.empty-room\",\n        defaultMessage: \"Nobody is here yet...\"\n      });\n    } else {\n      placeholder = intl.formatMessage(\n        {\n          id: \"chat-sidebar-container.input-placeholder.empty-room-bot\",\n          defaultMessage: \"Send message to {discordChannels}\"\n        },\n        { discordChannels: discordSnippet }\n      );\n    }\n  } else {\n    if (discordBridges.length === 0) {\n      placeholder = intl.formatMessage(\n        {\n          id: \"chat-sidebar-container.input-placeholder.occupants\",\n          defaultMessage:\n            \"{occupantCount, plural, one {Send message to one other...} other {Send message to {occupantCount} others...} }\"\n        },\n        { discordChannels: discordSnippet, occupantCount: occupantCount - 1 }\n      );\n    } else {\n      placeholder = intl.formatMessage(\n        {\n          id: \"chat-sidebar-container.input-placeholder.occupants-and-bot\",\n          defaultMessage:\n            \"{occupantCount, plural, one {Send message to one other and {discordChannels}...} other {Send message to {occupantCount} others and {discordChannels}...} }\"\n        },\n        { discordChannels: discordSnippet, occupantCount: occupantCount - 1 }\n      );\n    }\n  }\n\n  const isMobile = AFRAME.utils.device.isMobile();\n  const isOverMaxLength = message.length > MAX_MESSAGE_LENGTH;\n  return (\n    <ChatSidebar onClose={onClose}>\n      <ChatMessageList ref={listRef} onScroll={onScrollList}>\n        {messageGroups.map(({ id, systemMessage, ...rest }) => {\n          if (systemMessage) {\n            return <SystemMessage key={id} {...rest} />;\n          } else {\n            return <ChatMessageGroup key={id} {...rest} />;\n          }\n        })}\n      </ChatMessageList>\n      <ChatInput\n        id=\"chat-input\"\n        ref={inputRef}\n        onKeyDown={onKeyDown}\n        onChange={e => setMessage(e.target.value)}\n        placeholder={placeholder}\n        value={message}\n        isOverMaxLength={isOverMaxLength}\n        warning={\n          <>\n            {message.length + 50 > MAX_MESSAGE_LENGTH && (\n              <ChatLengthWarning messageLength={message.length} maxLength={MAX_MESSAGE_LENGTH} />\n            )}\n          </>\n        }\n        afterInput={\n          <>\n            {!isMobile && <EmojiPickerPopoverButton onSelectEmoji={onSelectEmoji} />}\n            {message.length === 0 && canSpawnMessages ? (\n              <MessageAttachmentButton onChange={onUploadAttachments} />\n            ) : (\n              <SendMessageButton onClick={onSendMessage} disabled={message.length === 0 || isOverMaxLength} />\n            )}\n            {canSpawnMessages && (\n              <SpawnMessageButton disabled={message.length === 0 || isOverMaxLength} onClick={onSpawnMessage} />\n            )}\n          </>\n        }\n      />\n    </ChatSidebar>\n  );\n}\n\nChatSidebarContainer.propTypes = {\n  canSpawnMessages: PropTypes.bool,\n  presences: PropTypes.object.isRequired,\n  occupantCount: PropTypes.number.isRequired,\n  scene: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  inputEffect: PropTypes.func.isRequired\n};\n\nexport function ChatToolbarButtonContainer(props) {\n  const { unreadMessages } = useContext(ChatContext);\n  return <ChatToolbarButton {...props} statusColor={unreadMessages ? \"unread\" : undefined} />;\n}\n","import { useRef, useEffect, useCallback, useState } from \"react\";\n\nexport function useMaintainScrollPosition(items) {\n  const listRef = useRef();\n  const [scrolledToBottom, setScrolledToBottom] = useState(true);\n\n  const onScrollList = useCallback(\n    e => {\n      const el = e.target;\n      setScrolledToBottom(el.scrollHeight - el.scrollTop === el.clientHeight);\n    },\n    [setScrolledToBottom]\n  );\n\n  useEffect(\n    () => {\n      if (scrolledToBottom) {\n        const el = listRef.current;\n\n        if (el.scrollTop !== el.scrollHeight) {\n          el.scrollTop = el.scrollHeight;\n        }\n      }\n    },\n    [items, scrolledToBottom]\n  );\n\n  return [onScrollList, listRef, scrolledToBottom];\n}\n","// eslint-disable-next-line no-unused-vars\nimport React, { Children } from \"react\";\n\nexport function joinChildren(children, renderSeparator) {\n  const result = Children.toArray(children).reduce(\n    (acc, child) =>\n      acc === null ? (\n        child\n      ) : (\n        <>\n          {acc}\n          {renderSeparator()}\n          {child}\n        </>\n      ),\n    null\n  );\n\n  return result;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"content-menu\":\"ContentMenu__content-menu__ihhYT\",\"contentMenu\":\"ContentMenu__content-menu__ihhYT\",\"content-menu-button\":\"ContentMenu__content-menu-button__I7_3d\",\"contentMenuButton\":\"ContentMenu__content-menu-button__I7_3d\",\"active\":\"ContentMenu__active__UBWaK\",\"separator\":\"ContentMenu__separator__x4GLA\"};","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgObjects = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M9.152 1.791a1.466 1.466 0 0 1 1.449 0l3.424 1.948c.163.093.298.226.393.386.094.16.143.341.144.526v3.76c0 .037-.003.075-.007.113.17.028.334.086.485.171l3.423 1.948c.163.093.299.226.393.386.094.16.144.341.144.526v3.76c0 .184-.05.366-.144.526-.094.16-.229.293-.392.386l-3.424 1.948a1.468 1.468 0 0 1-1.449 0l-3.424-1.948A1.086 1.086 0 0 1 10 16.11a1.083 1.083 0 0 1-.166.117L6.41 18.175a1.468 1.468 0 0 1-1.45 0l-3.423-1.948a1.07 1.07 0 0 1-.393-.386A1.038 1.038 0 0 1 1 15.315v-3.76c0-.185.05-.366.144-.526.094-.16.23-.293.393-.386L4.96 8.695c.079-.044.161-.082.246-.111a1.033 1.033 0 0 1-.014-.173V4.65c0-.185.05-.366.144-.526.094-.16.23-.293.393-.386L9.152 1.79Zm.364 8.672L6.41 8.695a1.462 1.462 0 0 0-.477-.17.345.345 0 0 1-.02-.115V4.837l3.604 2.072v3.554Zm4.265-1.859c-.065.026-.13.056-.19.091l-3.354 1.908V6.91l3.604-2.072V8.41a.347.347 0 0 1-.06.194Zm-8.206.613a.73.73 0 0 0-.252.087L2.097 11.14l3.588 2.063 3.414-1.963-3.37-1.917a1.082 1.082 0 0 1-.154-.106Zm5.204 1.953 3.536 2.033 3.589-2.063-3.227-1.836a.732.732 0 0 0-.506-.08c-.045.036-.094.07-.146.099l-3.246 1.847Zm-.903-8.866a.732.732 0 0 0-.362.096L6.288 4.235 9.877 6.3l3.588-2.064L10.238 2.4a.732.732 0 0 0-.362-.096Zm-.246 13.01v-3.562l-3.585 2.061v3.754h.002l3.423-1.948a.356.356 0 0 0 .165-.206 1.034 1.034 0 0 1-.005-.098Zm.769.176a.35.35 0 0 1-.034-.077c.003-.033.005-.066.005-.098v-3.563l3.585 2.061v3.754h-.002l-3.423-1.948a.357.357 0 0 1-.131-.129Zm-5.074-1.677L1.72 11.741v3.574a.346.346 0 0 0 .178.304l3.424 1.947.002.001v-3.754Zm9.35 3.754h.002l3.424-1.948a.356.356 0 0 0 .178-.304V11.74l-3.603 2.072v3.754Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgObjects as ReactComponent };","import React from \"react\";\nimport className from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport { joinChildren } from \"../misc/joinChildren\";\nimport styles from \"./ContentMenu.scss\";\nimport { ReactComponent as ObjectsIcon } from \"../icons/Objects.svg\";\nimport { ReactComponent as PeopleIcon } from \"../icons/People.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function ContentMenuButton({ active, children, ...props }) {\n  return (\n    <button className={className(styles.contentMenuButton, { [styles.active]: active })} {...props}>\n      {children}\n    </button>\n  );\n}\n\nContentMenuButton.propTypes = {\n  children: PropTypes.node,\n  active: PropTypes.bool\n};\n\nexport function ObjectsMenuButton(props) {\n  return (\n    <ContentMenuButton {...props}>\n      <ObjectsIcon />\n      <span>\n        <FormattedMessage id=\"content-menu.objects-menu-button\" defaultMessage=\"Objects\" />\n      </span>\n    </ContentMenuButton>\n  );\n}\n\nexport function PeopleMenuButton(props) {\n  return (\n    <ContentMenuButton {...props}>\n      <PeopleIcon />\n      <span>\n        <FormattedMessage\n          id=\"content-menu.people-menu-button\"\n          defaultMessage=\"People ({presenceCount})\"\n          values={{ presenceCount: props.presencecount }}\n        />\n      </span>\n    </ContentMenuButton>\n  );\n}\nPeopleMenuButton.propTypes = {\n  presencecount: PropTypes.number\n};\n\nexport function ContentMenu({ children }) {\n  return <div className={styles.contentMenu}>{joinChildren(children, () => <div className={styles.separator} />)}</div>;\n}\n\nContentMenu.propTypes = {\n  children: PropTypes.node\n};\n","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgCamera = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m13.693 5.807-1.04-1.643a1.126 1.126 0 0 0-.856-.414H8.203c-.337 0-.637.159-.856.414l-1.04 1.643c-.22.256-.502.443-.838.443H3.125a1.25 1.25 0 0 0-1.25 1.25V15a1.25 1.25 0 0 0 1.25 1.25h13.75a1.25 1.25 0 0 0 1.25-1.25V7.5a1.25 1.25 0 0 0-1.25-1.25H14.57c-.338 0-.658-.187-.877-.443Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 13.75a3.125 3.125 0 1 0 0-6.25 3.125 3.125 0 0 0 0 6.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.844 6.171v-.86h-.938v.86\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgCamera as ReactComponent };","var _g, _defs;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAvatar = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#a)\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.688 3.75a1.563 1.563 0 1 0 0-3.126 1.563 1.563 0 0 0 0 3.125Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m7.785 11.547-1.187 6.727a.937.937 0 0 0 1.46.93.928.928 0 0 0 .38-.606l.82-4.683v.007s.203-1.27.683-1.27h.121c.489 0 .684 1.27.684 1.27v-.004l.82 4.684a.935.935 0 0 0 1.84-.328l-1.187-6.727-.192-1.16c-.113-.707-.164-1.86.02-2.332.156-.406.552-.555.906-.555h3.61a.937.937 0 0 0 0-1.875H3.438a.937.937 0 1 0 0 1.875H7.05c.36 0 .75.149.906.555.184.473.133 1.625.02 2.332l-.192 1.16Z\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"a\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 20,\n    height: 20,\n    fill: \"#fff\"\n  })))));\n};\n\nexport { SvgAvatar as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDelete = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m4.375 4.375.781 12.5c.037.723.563 1.25 1.25 1.25h7.188c.69 0 1.206-.527 1.25-1.25l.781-12.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.125 4.375h13.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 4.375V2.813a.935.935 0 0 1 .938-.938h3.124a.935.935 0 0 1 .938.938v1.562\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 6.876v8.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m7.188 6.876.312 8.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.813 6.876-.313 8.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgDelete as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgFavorites = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.188 5.2h10.78\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.188 10.2h10.78\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.188 15.2h10.78\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.516 6.562a.127.127 0 0 1-.074-.023l-1.005-.715-1.005.715a.127.127 0 0 1-.192-.062.12.12 0 0 1 0-.077l.393-1.14-1.016-.683a.123.123 0 0 1-.049-.138.123.123 0 0 1 .045-.062.127.127 0 0 1 .074-.024H2.94l.378-1.143a.123.123 0 0 1 .046-.062.127.127 0 0 1 .192.062l.378 1.143h1.253c.027 0 .053.008.075.024a.123.123 0 0 1 .044.14.123.123 0 0 1-.048.06l-1.016.684.392 1.14a.12.12 0 0 1-.061.148.127.127 0 0 1-.057.013Z\",\n    fill: \"currentColor\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.516 11.562a.126.126 0 0 1-.074-.023l-1.005-.715-1.005.715a.126.126 0 0 1-.192-.062.12.12 0 0 1 0-.077l.393-1.14-1.016-.683a.123.123 0 0 1-.049-.138.123.123 0 0 1 .045-.062.127.127 0 0 1 .074-.024H2.94l.378-1.143a.123.123 0 0 1 .046-.062.127.127 0 0 1 .192.062l.378 1.143h1.253c.027 0 .053.008.075.024a.123.123 0 0 1 .044.14.123.123 0 0 1-.048.06l-1.016.684.392 1.14a.12.12 0 0 1-.061.148.127.127 0 0 1-.057.013Z\",\n    fill: \"currentColor\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.516 16.562a.126.126 0 0 1-.074-.023l-1.005-.715-1.005.715a.126.126 0 0 1-.192-.062.12.12 0 0 1 0-.077l.393-1.14-1.016-.683a.12.12 0 0 1-.004-.2.127.127 0 0 1 .074-.024H2.94l.378-1.143a.126.126 0 0 1 .238 0l.378 1.143h1.253c.027 0 .053.008.075.024a.12.12 0 0 1-.003.2l-1.017.684.392 1.14a.12.12 0 0 1-.061.148.127.127 0 0 1-.057.013Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgFavorites as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgStarOutline = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.75 8.125h-6.719L10 1.875l-2.031 6.25H1.25l5.469 3.75-2.11 6.25L10 14.219l5.39 3.906-2.109-6.25 5.469-3.75Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgStarOutline as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgWarningCircle = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.5 10c0-4.14-3.36-7.5-7.5-7.5-4.14 0-7.5 3.36-7.5 7.5 0 4.14 3.36 7.5 7.5 7.5 4.14 0 7.5-3.36 7.5-7.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.776 6.487 10 11.25l.224-4.763a.223.223 0 0 0-.226-.235v0a.224.224 0 0 0-.222.235v0Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 14.371a.782.782 0 1 1 0-1.563.782.782 0 0 1 0 1.563Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgWarningCircle as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHome = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3.125 8.28v9.22a.625.625 0 0 0 .625.625H7.5v-5.313a.937.937 0 0 1 .938-.937h3.124a.938.938 0 0 1 .938.937v5.313h3.75a.625.625 0 0 0 .625-.625V8.28\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m18.75 10-8.325-7.968c-.195-.206-.652-.209-.85 0L1.25 10\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.625 6.992V2.5H13.75v2.695\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgHome as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgTextDocument = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 8.643v7.608a1.875 1.875 0 0 1-1.875 1.875h-8.75A1.875 1.875 0 0 1 3.75 16.25V3.75a1.875 1.875 0 0 1 1.875-1.875h3.857c.332 0 .65.131.884.366l5.518 5.518c.234.234.366.552.366.883Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 2.188v4.688a1.25 1.25 0 0 0 1.25 1.25h4.688\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875 11.25h6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875 14.376h6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgTextDocument as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6, _path7, _path8, _path9, _path10;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgSupport = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.125a8.125 8.125 0 1 0 0-16.25 8.125 8.125 0 0 0 0 16.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 13.125a3.125 3.125 0 1 0 0-6.25 3.125 3.125 0 0 0 0 6.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.125 2.11.313 5.156\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.563 7.266.312-5.157\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.125 17.892.313-5.157\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.563 12.735.312 5.157\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path7 || (_path7 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m17.89 8.125-5.156.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path8 || (_path8 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.734 11.562 5.157.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path9 || (_path9 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m2.11 8.125 5.156.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path10 || (_path10 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m7.266 11.562-5.157.313\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgSupport as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgShield = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.09 4.39C14.597 3.763 13.153 3.3 10 1.875 6.847 3.3 5.403 3.763 1.91 4.39 1.277 14.42 9.398 17.883 10 18.125c.602-.242 8.723-3.706 8.09-13.735Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgShield as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDiscord = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.246 8.55c-.513 0-.918.45-.918 1 0 .549.414.999.918.999.513 0 .918-.45.918-1 .01-.548-.405-.998-.918-.998Zm3.285 0c-.513 0-.918.45-.918 1 0 .549.414.999.918.999.513 0 .918-.45.918-1 0-.548-.405-.998-.918-.998Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.905 1H3.845A1.85 1.85 0 0 0 2 2.854v12.168a1.85 1.85 0 0 0 1.845 1.854h10.206l-.477-1.665 1.152 1.071 1.089 1.008L17.75 19V2.854A1.85 1.85 0 0 0 15.905 1Zm-3.474 11.754s-.324-.387-.594-.729c1.179-.333 1.629-1.071 1.629-1.071a5.15 5.15 0 0 1-1.035.531c-.45.189-.882.315-1.305.387a6.305 6.305 0 0 1-2.331-.009 7.555 7.555 0 0 1-1.323-.387 5.274 5.274 0 0 1-.657-.306c-.027-.018-.054-.027-.081-.045-.018-.009-.027-.018-.036-.027-.162-.09-.252-.153-.252-.153s.432.72 1.575 1.062c-.27.342-.603.747-.603.747-1.989-.063-2.745-1.368-2.745-1.368 0-2.898 1.296-5.247 1.296-5.247 1.296-.972 2.529-.945 2.529-.945l.09.108c-1.62.468-2.367 1.179-2.367 1.179s.198-.108.531-.261c.963-.423 1.728-.54 2.043-.567.054-.009.099-.018.153-.018a7.336 7.336 0 0 1 4.527.846s-.711-.675-2.241-1.143l.126-.144s1.233-.027 2.529.945c0 0 1.296 2.349 1.296 5.247 0 0-.765 1.305-2.754 1.368Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgDiscord as ReactComponent };","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLeave = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.5 6.875V5.312a1.563 1.563 0 0 0-1.563-1.562h-7.5a1.562 1.562 0 0 0-1.562 1.562v9.375a1.562 1.562 0 0 0 1.563 1.563h7.5a1.562 1.562 0 0 0 1.562-1.563v-1.562\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16 6.875 19.125 10 16 13.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.46 10h10.665\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgLeave as ReactComponent };","// extracted by mini-css-extract-plugin\nexport default {\"person\":\"PeopleSidebar__person__hP26x\",\"moderator-icon\":\"PeopleSidebar__moderator-icon__ssMMu\",\"moderatorIcon\":\"PeopleSidebar__moderator-icon__ssMMu\",\"presence\":\"PeopleSidebar__presence__xlecK\"};","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgDesktop = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.122 3H2.979C2.328 3 1.8 3.528 1.8 4.179v9.428c0 .651.528 1.179 1.179 1.179h14.143c.65 0 1.178-.528 1.178-1.179V4.18C18.3 3.528 17.772 3 17.122 3Z\",\n    stroke: \"currentColor\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m11.818 17.142-.295-2.357H8.577l-.295 2.357h3.536Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.175 17.142h-8.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.8 11.839v1.768a1.182 1.182 0 0 0 1.179 1.178h14.143a1.182 1.182 0 0 0 1.178-1.178v-1.768H1.8Zm8.25 2.357a.59.59 0 1 1 0-1.18.59.59 0 0 1 0 1.18Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgDesktop as ReactComponent };","var _g, _defs;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPhone = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    clipPath: \"url(#a)\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125.625h-6.25C5.839.625 5 1.465 5 2.5v15c0 1.035.84 1.875 1.875 1.875h6.25c1.036 0 1.875-.84 1.875-1.875v-15c0-1.036-.84-1.875-1.875-1.875Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.875.625h.938a.312.312 0 0 1 .312.312.625.625 0 0 0 .625.625h2.5a.625.625 0 0 0 .625-.625.312.312 0 0 1 .313-.312h.937\"\n  }))), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"a\"\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    width: 20,\n    height: 20,\n    fill: \"#fff\"\n  })))));\n};\n\nexport { SvgPhone as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVolumeHigh = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.922 7.501H2.188a.312.312 0 0 0-.313.313v4.375a.313.313 0 0 0 .313.312h2.72a.623.623 0 0 1 .396.138l3.573 2.926a.313.313 0 0 0 .498-.251V4.689a.313.313 0 0 0-.498-.252L5.304 7.363a.586.586 0 0 1-.382.138Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.5 12.5c.38-.758.625-1.596.625-2.5 0-.918-.234-1.736-.625-2.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.375 14.374c.76-1.325 1.25-2.502 1.25-4.375 0-1.872-.469-3.036-1.25-4.375\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 16.248c1.172-1.797 1.875-3.571 1.875-6.25 0-2.678-.703-4.414-1.875-6.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgVolumeHigh as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVolumeMuted = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 16.876 2.5 3.126\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.75 5.349v1.32c0 .041.017.08.046.11l.937.938a.156.156 0 0 0 .267-.11V4.71a.958.958 0 0 0-.495-.849.934.934 0 0 0-1.024.092L7.234 4.974a.156.156 0 0 0-.012.232l.666.666a.156.156 0 0 0 .21.01l.652-.533Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.75 14.652 5.7 12.155a1.25 1.25 0 0 0-.792-.28H2.5v-3.75h1.981a.156.156 0 0 0 .11-.267l-.937-.937a.156.156 0 0 0-.11-.046H2.187a.937.937 0 0 0-.937.938v4.375a.937.937 0 0 0 .938.937h2.724l3.57 2.922a.934.934 0 0 0 1.392-.27.957.957 0 0 0 .126-.486v-1.96a.156.156 0 0 0-.046-.11l-.937-.937a.157.157 0 0 0-.24.023.157.157 0 0 0-.027.087v2.258Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.75 10c0-.959-.227-1.87-.693-2.783a.625.625 0 0 0-1.114.567c.375.734.557 1.46.557 2.217 0 .104-.004.21-.012.317a.312.312 0 0 0 .09.244l.768.769a.156.156 0 0 0 .264-.079c.093-.41.14-.83.14-1.252Z\",\n    fill: \"currentColor\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 10.001c0-2-.511-3.277-1.335-4.69a.625.625 0 0 0-1.08.63C14.573 7.206 15 8.276 15 10c0 .93-.129 1.675-.366 2.37a.313.313 0 0 0 .074.322l.655.655a.156.156 0 0 0 .255-.05c.4-.958.632-1.972.632-3.297Z\",\n    fill: \"currentColor\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.75 10c0-2.9-.789-4.73-1.973-6.586a.625.625 0 1 0-1.055.673C16.79 5.757 17.5 7.403 17.5 10c0 1.854-.348 3.208-.922 4.414a.156.156 0 0 0 .03.178l.697.697a.157.157 0 0 0 .25-.039c.839-1.647 1.195-3.258 1.195-5.25Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgVolumeMuted as ReactComponent };","var _style, _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHandRaised = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"Layer_1\",\n    x: 0,\n    y: 0,\n    viewBox: \"0 0 1.025 0.782\",\n    xmlSpace: \"preserve\",\n    width: 20,\n    height: 20,\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _style || (_style = /*#__PURE__*/React.createElement(\"style\", {\n    type: \"text/css\",\n    id: \"style869\"\n  }, \".st0{fill:#ffd3b6}\")), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    className: \"st0\",\n    d: \"M220.8 196.584\",\n    id: \"path871\"\n  })), /*#__PURE__*/React.createElement(\"g\", {\n    id: \"g1059\",\n    transform: \"matrix(.05125 0 0 .05125 -14.217 -12.843)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    className: \"st0\",\n    d: \"M288.372 256.007\",\n    id: \"path1044\",\n    style: {\n      strokeWidth: 0.0389037\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M294.69 257.645c-.424-.378-1.361-.899-3.287.953-.358.342-.572.467-.844.762v-9.134c0-.591-.467-1.074-1.062-1.074-.596 0-1.078.483-1.078 1.074v5.419c0 .506-.654.549-.767.132v-6.465c0-.592-.466-1.074-1.062-1.074-.595 0-1.077.478-1.077 1.074v6.485c-.082.397-.665.381-.708-.047v-5.664a1.06 1.06 0 0 0-1.062-1.07c-.596 0-1.078.478-1.078 1.07v5.575c-.004.007-.004.02-.004.039 0 .486-.626.529-.74.136v-3.992a1.06 1.06 0 0 0-1.061-1.07c-.595 0-1.078.479-1.078 1.07v9.392a4.768 4.768 0 0 0 2.739 4.314v1.525c0 .591.482 1.074 1.074 1.074h4.295c.591 0 1.073-.483 1.073-1.074v-1.081a2.517 2.517 0 0 0 1.755-1.031.313.313 0 0 0 .031-.047c.035-.039.078-.109.128-.21.028-.047.051-.093.074-.144.494-1 1.623-3.708 3.646-5.458.416-.417.517-1.082.093-1.46z\",\n    id: \"path1046\",\n    style: {\n      strokeWidth: 0.0389037,\n      fill: \"#ffd469\"\n    }\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M288.726 266.013H285.4l.007-.007h-.871a4.774 4.774 0 0 1-2.027-.451v1.361c.194.102.38.168.54.168h5.373c.156 0 .339-.051.53-.133v-.949l-.226.012z\",\n    id: \"path1048\",\n    style: {\n      strokeWidth: 0.0389037,\n      fill: \"#ffb636\"\n    }\n  })));\n};\n\nexport { SvgHandRaised as ReactComponent };","import React, { forwardRef } from \"react\";\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./List.scss\";\n\nexport const List = forwardRef(({ className, children, ...rest }, ref) => {\n  return (\n    <ul {...rest} className={classNames(styles.list, className)} ref={ref}>\n      {children}\n    </ul>\n  );\n});\n\nList.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function ListItem({ className, children, ...rest }) {\n  return (\n    <li {...rest} className={classNames(styles.listItem, styles.listItemContent, className)}>\n      {children}\n    </li>\n  );\n}\n\nListItem.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function ButtonListItem({ className, children, ...rest }) {\n  return (\n    <li className={styles.listItem}>\n      <button {...rest} className={classNames(styles.listItemContent, styles.buttonListItem, className)}>\n        {children}\n      </button>\n    </li>\n  );\n}\n\nButtonListItem.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"list\":\"List__list__wrDsj\",\"list-item\":\"List__list-item__Wa7vr\",\"listItem\":\"List__list-item__Wa7vr\",\"list-item-content\":\"List__list-item-content__fiqda\",\"listItemContent\":\"List__list-item-content__fiqda\",\"button-list-item\":\"List__button-list-item__psIZ3\",\"buttonListItem\":\"List__button-list-item__psIZ3\",\"selected\":\"List__selected__TOa6J\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./PeopleSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as StarIcon } from \"../icons/Star.svg\";\nimport { ReactComponent as DesktopIcon } from \"../icons/Desktop.svg\";\nimport { ReactComponent as DiscordIcon } from \"../icons/Discord.svg\";\nimport { ReactComponent as PhoneIcon } from \"../icons/Phone.svg\";\nimport { ReactComponent as VRIcon } from \"../icons/VR.svg\";\nimport { ReactComponent as VolumeOffIcon } from \"../icons/VolumeOff.svg\";\nimport { ReactComponent as VolumeHighIcon } from \"../icons/VolumeHigh.svg\";\nimport { ReactComponent as VolumeMutedIcon } from \"../icons/VolumeMuted.svg\";\nimport { ReactComponent as HandRaisedIcon } from \"../icons/HandRaised.svg\";\nimport { List, ButtonListItem } from \"../layout/List\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nfunction getDeviceLabel(ctx, intl) {\n  if (ctx) {\n    if (ctx.hmd) {\n      return intl.formatMessage({ id: \"people-sidebar.device-label.vr\", defaultMessage: \"VR\" });\n    } else if (ctx.discord) {\n      return intl.formatMessage({ id: \"people-sidebar.device-label.discord\", defaultMessage: \"Discord Bot\" });\n    } else if (ctx.mobile) {\n      return intl.formatMessage({ id: \"people-sidebar.device-label.mobile\", defaultMessage: \"Mobile\" });\n    }\n  }\n\n  return intl.formatMessage({ id: \"people-sidebar.device-label.desktop\", defaultMessage: \"Desktop\" });\n}\n\nfunction getDeviceIconComponent(ctx) {\n  if (ctx) {\n    if (ctx.hmd) {\n      return VRIcon;\n    } else if (ctx.discord) {\n      return DiscordIcon;\n    } else if (ctx.mobile) {\n      return PhoneIcon;\n    }\n  }\n\n  return DesktopIcon;\n}\n\nfunction getVoiceLabel(micPresence, intl) {\n  if (micPresence) {\n    if (micPresence.talking) {\n      return intl.formatMessage({ id: \"people-sidebar.voice-label.talking\", defaultMessage: \"Talking\" });\n    } else if (micPresence.muted) {\n      return intl.formatMessage({ id: \"people-sidebar.voice-label.muted\", defaultMessage: \"Muted\" });\n    }\n  }\n\n  return intl.formatMessage({ id: \"people-sidebar.voice-label.not-talking\", defaultMessage: \"Not Talking\" });\n}\n\nfunction getVoiceIconComponent(micPresence) {\n  if (micPresence) {\n    if (micPresence.muted) {\n      return VolumeMutedIcon;\n    } else if (micPresence.talking) {\n      return VolumeHighIcon;\n    }\n  }\n\n  return VolumeOffIcon;\n}\n\nfunction getPresenceMessage(presence, intl) {\n  switch (presence) {\n    case \"lobby\":\n      return intl.formatMessage({ id: \"people-sidebar.presence.in-lobby\", defaultMessage: \"In Lobby\" });\n    case \"room\":\n      return intl.formatMessage({ id: \"people-sidebar.presence.in-room\", defaultMessage: \"In Room\" });\n    case \"entering\":\n      return intl.formatMessage({ id: \"people-sidebar.presence.entering\", defaultMessage: \"Entering Room\" });\n    default:\n      return undefined;\n  }\n}\n\nfunction getPersonName(person, intl) {\n  const you = intl.formatMessage({\n    id: \"people-sidebar.person-name.you\",\n    defaultMessage: \"You\"\n  });\n\n  return person.profile.displayName + (person.isMe ? ` (${you})` : \"\");\n}\n\nexport function PeopleSidebar({ people, onSelectPerson, onClose, showMuteAll, onMuteAll }) {\n  const intl = useIntl();\n\n  return (\n    <Sidebar\n      title={\n        <FormattedMessage\n          id=\"people-sidebar.title\"\n          defaultMessage=\"People ({numPeople})\"\n          values={{ numPeople: people.length }}\n        />\n      }\n      beforeTitle={<CloseButton onClick={onClose} />}\n      afterTitle={\n        showMuteAll ? (\n          <IconButton onClick={onMuteAll}>\n            <FormattedMessage id=\"people-sidebar.mute-all-button\" defaultMessage=\"Mute All\" />\n          </IconButton>\n        ) : (\n          undefined\n        )\n      }\n    >\n      <List>\n        {people.map(person => {\n          const DeviceIcon = getDeviceIconComponent(person.context);\n          const VoiceIcon = getVoiceIconComponent(person.micPresence);\n\n          return (\n            <ButtonListItem\n              className={styles.person}\n              key={person.id}\n              type=\"button\"\n              onClick={e => onSelectPerson(person, e)}\n            >\n              {person.hand_raised && <HandRaisedIcon />}\n              {<DeviceIcon title={getDeviceLabel(person.context, intl)} />}\n              {!person.context.discord && VoiceIcon && <VoiceIcon title={getVoiceLabel(person.micPresence, intl)} />}\n              <p>{getPersonName(person, intl)}</p>\n              {person.roles.owner && (\n                <StarIcon\n                  title={intl.formatMessage({ id: \"people-sidebar.moderator-label\", defaultMessage: \"Moderator\" })}\n                  className={styles.moderatorIcon}\n                  width={12}\n                  height={12}\n                />\n              )}\n              <p className={styles.presence}>{getPresenceMessage(person.presence, intl)}</p>\n            </ButtonListItem>\n          );\n        })}\n      </List>\n    </Sidebar>\n  );\n}\n\nPeopleSidebar.propTypes = {\n  people: PropTypes.array,\n  onSelectPerson: PropTypes.func,\n  showMuteAll: PropTypes.bool,\n  onMuteAll: PropTypes.func,\n  onClose: PropTypes.func\n};\n\nPeopleSidebar.defaultProps = {\n  people: [],\n  onSelectPerson: () => {}\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button, CancelButton } from \"../input/Button\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Column } from \"../layout/Column\";\n\nexport function PromoteClientModal({ onClose, onConfirm, displayName }) {\n  return (\n    <Modal title=\"Promote User\" beforeTitle={<CloseButton onClick={onClose} />}>\n      <Column center padding>\n        <p>\n          <FormattedMessage\n            id=\"promote-client-modal.message\"\n            defaultMessage=\"Promoting a user will grant full access to room settings and moderation tools.{linebreak}Are you sure?\"\n            values={{ linebreak: <br /> }}\n          />\n        </p>\n        <Button preset=\"accept\" onClick={onConfirm}>\n          <FormattedMessage\n            id=\"promote-client-modal.confirm-prefix\"\n            defaultMessage=\"Yes, promote {name}\"\n            values={{ name: displayName }}\n          />\n        </Button>\n        <CancelButton preset=\"cancel\" onClick={onClose} />\n      </Column>\n    </Modal>\n  );\n}\n\nPromoteClientModal.propTypes = {\n  displayName: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { BackButton } from \"../input/BackButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport styles from \"./UserProfileSidebar.scss\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { Slider } from \"../input/Slider\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as VolumeHigh } from \"../icons/VolumeHigh.svg\";\nimport { ReactComponent as VolumeMuted } from \"../icons/VolumeMuted.svg\";\nimport useAvatarVolume from \"./useAvatarVolume\";\nimport { calcLevel, calcGainMultiplier, MAX_VOLUME_LABELS } from \"../../utils/avatar-volume-utils\";\n\nconst MIN = 0;\nconst MAX = MAX_VOLUME_LABELS - 1;\n\nexport function UserProfileSidebar({\n  className,\n  userId,\n  displayName,\n  identityName,\n  avatarPreview,\n  hasMicPresence,\n  isSignedIn,\n  canPromote,\n  onPromote,\n  canDemote,\n  onDemote,\n  isHidden,\n  onToggleHidden,\n  canMute,\n  isNetworkMuted,\n  onMute,\n  canKick,\n  onKick,\n  showBackButton,\n  onBack,\n  onClose,\n  ...rest\n}) {\n  const intl = useIntl();\n  const [multiplier, updateMultiplier, isMuted, updateMuted] = useAvatarVolume(userId);\n  const onLevelChanged = useCallback(\n    level => {\n      updateMultiplier(calcGainMultiplier(level));\n    },\n    [updateMultiplier]\n  );\n  const newLevel = calcLevel(multiplier);\n  return (\n    <Sidebar\n      title={identityName ? `${displayName} (${identityName})` : displayName}\n      beforeTitle={showBackButton ? <BackButton onClick={onBack} /> : <CloseButton onClick={onClose} />}\n      className={className}\n      {...rest}\n    >\n      <Column center padding>\n        <div className={styles.avatarPreviewContainer}>{avatarPreview || <div />}</div>\n        {hasMicPresence && (\n          <div className={styles.sliderContainer}>\n            <ToolbarButton\n              icon={isNetworkMuted || isMuted ? <VolumeMuted /> : <VolumeHigh />}\n              selected={isNetworkMuted || isMuted}\n              preset=\"accent4\"\n              style={{ display: \"block\" }}\n              onClick={() => {\n                updateMuted(!isMuted);\n              }}\n              disabled={isNetworkMuted}\n            />\n            <Slider\n              min={MIN}\n              max={MAX}\n              step={1}\n              value={newLevel}\n              onChange={onLevelChanged}\n              className={styles.sliderInputContainer}\n              disabled={isNetworkMuted || isMuted}\n            />\n          </div>\n        )}\n        {canPromote && (\n          <Button\n            preset=\"accept\"\n            disabled={!isSignedIn}\n            title={\n              isSignedIn\n                ? intl.formatMessage({ id: \"user-profile-sidebar.promote-button\", defaultMessage: \"Promote\" })\n                : intl.formatMessage(\n                    {\n                      id: \"user-profile-sidebar.promote-button-disabled-label\",\n                      defaultMessage: \"{displayName} is signed out.\"\n                    },\n                    { displayName }\n                  )\n            }\n            onClick={onPromote}\n          >\n            <FormattedMessage id=\"user-profile-sidebar.promote-button\" defaultMessage=\"Promote\" />\n          </Button>\n        )}\n        {canDemote && (\n          <Button\n            preset=\"cancel\"\n            disabled={!isSignedIn}\n            title={\n              isSignedIn\n                ? intl.formatMessage({ id: \"user-profile-sidebar.demote-button\", defaultMessage: \"Demote\" })\n                : intl.formatMessage(\n                    {\n                      id: \"user-profile-sidebar.demote-button-disabled-label\",\n                      defaultMessage: \"{displayName} is signed out.\"\n                    },\n                    { displayName }\n                  )\n            }\n            onClick={onDemote}\n          >\n            <FormattedMessage id=\"user-profile-sidebar.demote-button\" defaultMessage=\"Demote\" />\n          </Button>\n        )}\n        <Button onClick={onToggleHidden}>\n          {isHidden ? (\n            <FormattedMessage id=\"user-profile-sidebar.unhide-button\" defaultMessage=\"Unhide\" />\n          ) : (\n            <FormattedMessage id=\"user-profile-sidebar.hide-button\" defaultMessage=\"Hide\" />\n          )}\n        </Button>\n        {canMute && (\n          <Button preset=\"cancel\" onClick={onMute}>\n            <FormattedMessage id=\"user-profile-sidebar.mute-button\" defaultMessage=\"Mute\" />\n          </Button>\n        )}\n        {canKick && (\n          <Button preset=\"cancel\" onClick={onKick}>\n            <FormattedMessage id=\"user-profile-sidebar.kick-button\" defaultMessage=\"Kick\" />\n          </Button>\n        )}\n      </Column>\n    </Sidebar>\n  );\n}\n\nUserProfileSidebar.propTypes = {\n  className: PropTypes.string,\n  userId: PropTypes.string,\n  displayName: PropTypes.string,\n  identityName: PropTypes.string,\n  avatarPreview: PropTypes.node,\n  hasMicPresence: PropTypes.bool,\n  isSignedIn: PropTypes.bool,\n  canPromote: PropTypes.bool,\n  onPromote: PropTypes.func,\n  canDemote: PropTypes.bool,\n  onDemote: PropTypes.func,\n  isHidden: PropTypes.bool,\n  onToggleHidden: PropTypes.func,\n  canMute: PropTypes.bool,\n  isNetworkMuted: PropTypes.bool,\n  onMute: PropTypes.func,\n  canKick: PropTypes.bool,\n  onKick: PropTypes.func,\n  showBackButton: PropTypes.bool,\n  onBack: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import { useCallback, useEffect, useState } from \"react\";\nimport { getPlayerInfo } from \"../../utils/component-utils\";\n\nexport default function useAvatarVolume(sessionId, onMultiplierChanged) {\n  const playerInfo = getPlayerInfo(sessionId);\n  const controlsEl = playerInfo?.el.querySelector(\"[avatar-volume-controls]\");\n  const controls = controlsEl?.components[\"avatar-volume-controls\"];\n  const [multiplier, setMultiplier] = useState(0);\n  const [isMuted, setIsMuted] = useState(false);\n\n  const onMultiplierUpdated = useCallback(\n    ({ detail: { gainMultiplier } }) => {\n      setMultiplier(gainMultiplier);\n      onMultiplierChanged && onMultiplierChanged(gainMultiplier);\n    },\n    [onMultiplierChanged]\n  );\n\n  const updateMultiplier = useCallback(\n    gainMultiplier => {\n      if (!controls) return;\n      setMultiplier(gainMultiplier);\n      controls.updateGainMultiplier(gainMultiplier, true);\n    },\n    [controls]\n  );\n\n  const onLocalMutedUpdated = useCallback(({ detail: { muted } }) => {\n    setIsMuted(muted);\n  }, []);\n\n  const updateMuted = useCallback(\n    muted => {\n      if (!controls) return;\n      setIsMuted(!!muted);\n      controls.updateLocalMuted(!!muted, true);\n    },\n    [controls]\n  );\n\n  useEffect(\n    () => {\n      if (!controlsEl) return;\n      controlsEl.addEventListener(\"gain_multiplier_updated\", onMultiplierUpdated);\n      controlsEl.addEventListener(\"local_muted_updated\", onLocalMutedUpdated);\n\n      const gainMultiplier = APP.gainMultipliers.get(controls.audioEl);\n      onMultiplierUpdated({ detail: { gainMultiplier } });\n      const isLocalMuted = APP.mutedState.has(controls.audioEl);\n      setIsMuted(isLocalMuted);\n\n      return () => {\n        controlsEl.removeEventListener(\"gain_multiplier_updated\", onMultiplierUpdated);\n        controlsEl.removeEventListener(\"local_muted_updated\", onLocalMutedUpdated);\n      };\n    },\n    [controls, controlsEl, onMultiplierUpdated, onLocalMutedUpdated]\n  );\n\n  return [multiplier, updateMultiplier, isMuted, updateMuted];\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"avatar-preview-container\":\"UserProfileSidebar__avatar-preview-container__K9Anq\",\"avatarPreviewContainer\":\"UserProfileSidebar__avatar-preview-container__K9Anq\",\"slider-container\":\"UserProfileSidebar__slider-container__yafCa\",\"sliderContainer\":\"UserProfileSidebar__slider-container__yafCa\",\"slider-input-container\":\"UserProfileSidebar__slider-input-container__q8fBZ\",\"sliderInputContainer\":\"UserProfileSidebar__slider-input-container__q8fBZ\"};","import React, { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { PromoteClientModal } from \"./PromoteClientModal\";\nimport { getAvatarThumbnailUrl } from \"../../utils/avatar-utils\";\nimport { UserProfileSidebar } from \"./UserProfileSidebar.js\";\nimport { SignInMessages } from \"../auth/SignInModal\";\n\nexport function UserProfileSidebarContainer({\n  user,\n  hubChannel,\n  performConditionalSignIn,\n  showBackButton,\n  onBack,\n  onClose,\n  onCloseDialog,\n  showNonHistoriedDialog\n}) {\n  const [avatarThumbnailUrl, setAvatarThumbnailUrl] = useState();\n\n  const {\n    id: userId,\n    profile: { displayName, identityName, avatarId },\n    roles\n  } = user;\n  const mayKick = hubChannel.canOrWillIfCreator(\"kick_users\");\n  const hasMicPresence = !!user.micPresence;\n  const isNetworkMuted = user.micPresence?.muted;\n  const mayMute = !isNetworkMuted && hubChannel.canOrWillIfCreator(\"mute_users\");\n  const [isOwner, setIsOwner] = useState(!!roles.owner);\n  const isCreator = !!roles.creator;\n  const isSignedIn = !!roles.signed_in;\n  const mayAddOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && !isOwner && !isCreator;\n  const mayRemoveOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && isOwner && !isCreator;\n  const [isHidden, setIsHidden] = useState(hubChannel.isHidden(user.id));\n\n  useEffect(\n    () => {\n      if (avatarId) {\n        getAvatarThumbnailUrl(avatarId).then(avatarThumbnailUrl => setAvatarThumbnailUrl(avatarThumbnailUrl));\n      }\n    },\n    [avatarId, setAvatarThumbnailUrl, user]\n  );\n\n  const addOwner = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"update_roles\"),\n        async () => {\n          showNonHistoriedDialog(PromoteClientModal, {\n            displayName,\n            onConfirm: async () => {\n              setIsOwner(true);\n              await hubChannel.addOwner(userId);\n              onCloseDialog();\n            }\n          });\n        },\n        SignInMessages.addOwner\n      );\n    },\n    [performConditionalSignIn, hubChannel, showNonHistoriedDialog, userId, onCloseDialog, displayName]\n  );\n\n  const removeOwner = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"update_roles\"),\n        async () => {\n          setIsOwner(false);\n          await hubChannel.removeOwner(userId);\n        },\n        SignInMessages.removeOwner\n      );\n    },\n    [performConditionalSignIn, hubChannel, userId]\n  );\n\n  const toggleHidden = useCallback(\n    () => {\n      if (isHidden) {\n        hubChannel.unhide(userId);\n      } else {\n        hubChannel.hide(userId);\n      }\n\n      setIsHidden(!isHidden);\n    },\n    [isHidden, userId, hubChannel]\n  );\n\n  const mute = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"mute_users\"),\n        async () => await hubChannel.mute(userId),\n        SignInMessages.muteUser\n      );\n    },\n    [performConditionalSignIn, hubChannel, userId]\n  );\n\n  const kick = useCallback(\n    () => {\n      performConditionalSignIn(\n        () => hubChannel.can(\"kick_users\"),\n        async () => await hubChannel.kick(userId),\n        SignInMessages.kickUser\n      );\n\n      if (onClose) {\n        onClose();\n      } else if (onBack) {\n        onBack();\n      }\n    },\n    [performConditionalSignIn, hubChannel, userId, onClose, onBack]\n  );\n\n  return (\n    <UserProfileSidebar\n      userId={user.id}\n      displayName={displayName}\n      identityName={identityName}\n      avatarPreview={<img src={avatarThumbnailUrl} />}\n      isSignedIn={isSignedIn}\n      canPromote={mayAddOwner}\n      onPromote={addOwner}\n      canDemote={mayRemoveOwner}\n      onDemote={removeOwner}\n      isHidden={isHidden}\n      onToggleHidden={toggleHidden}\n      canMute={mayMute}\n      isNetworkMuted={isNetworkMuted}\n      onMute={mute}\n      canKick={mayKick}\n      onKick={kick}\n      showBackButton={showBackButton}\n      onClose={onClose}\n      onBack={onBack}\n      hasMicPresence={hasMicPresence}\n    />\n  );\n}\n\nUserProfileSidebarContainer.propTypes = {\n  user: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object,\n  performConditionalSignIn: PropTypes.func,\n  showBackButton: PropTypes.bool,\n  onBack: PropTypes.func,\n  onClose: PropTypes.func,\n  onCloseDialog: PropTypes.func.isRequired,\n  showNonHistoriedDialog: PropTypes.func\n};\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { PeopleSidebar } from \"./PeopleSidebar\";\nimport { getMicrophonePresences } from \"../../utils/microphone-presence\";\nimport ProfileEntryPanel from \"../profile-entry-panel\";\nimport { UserProfileSidebarContainer } from \"./UserProfileSidebarContainer\";\n\nexport function userFromPresence(sessionId, presence, micPresences, mySessionId) {\n  const meta = presence.metas[presence.metas.length - 1];\n  const micPresence = micPresences.get(sessionId);\n  return { id: sessionId, isMe: mySessionId === sessionId, micPresence, ...meta };\n}\n\nfunction usePeopleList(presences, mySessionId, micUpdateFrequency = 500) {\n  const [people, setPeople] = useState([]);\n\n  useEffect(\n    () => {\n      let timeout;\n\n      function updateMicrophoneState() {\n        const micPresences = getMicrophonePresences();\n\n        setPeople(\n          Object.entries(presences).map(([id, presence]) => {\n            return userFromPresence(id, presence, micPresences, mySessionId);\n          })\n        );\n\n        timeout = setTimeout(updateMicrophoneState, micUpdateFrequency);\n      }\n\n      updateMicrophoneState();\n\n      return () => {\n        clearTimeout(timeout);\n      };\n    },\n    [presences, micUpdateFrequency, setPeople, mySessionId]\n  );\n\n  return people;\n}\n\nfunction PeopleListContainer({ hubChannel, people, onSelectPerson, onClose }) {\n  const onMuteAll = useCallback(\n    () => {\n      for (const person of people) {\n        if (person.presence === \"room\" && person.permissions && !person.permissions.mute_users) {\n          hubChannel.mute(person.id);\n        }\n      }\n    },\n    [people, hubChannel]\n  );\n\n  return (\n    <PeopleSidebar\n      people={people}\n      onSelectPerson={onSelectPerson}\n      onClose={onClose}\n      onMuteAll={onMuteAll}\n      showMuteAll={hubChannel.can(\"mute_users\")}\n    />\n  );\n}\n\nPeopleListContainer.propTypes = {\n  onSelectPerson: PropTypes.func.isRequired,\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  people: PropTypes.array.isRequired\n};\n\nexport function PeopleSidebarContainer({\n  hubChannel,\n  presences,\n  mySessionId,\n  displayNameOverride,\n  store,\n  mediaSearchStore,\n  performConditionalSignIn,\n  onCloseDialog,\n  showNonHistoriedDialog,\n  onClose\n}) {\n  const people = usePeopleList(presences, mySessionId);\n  const [selectedPersonId, setSelectedPersonId] = useState(null);\n  const selectedPerson = people.find(person => person.id === selectedPersonId);\n  const setSelectedPerson = useCallback(\n    person => {\n      setSelectedPersonId(person.id);\n    },\n    [setSelectedPersonId]\n  );\n\n  if (selectedPerson) {\n    if (selectedPerson.id === mySessionId) {\n      return (\n        <ProfileEntryPanel\n          containerType=\"sidebar\"\n          displayNameOverride={displayNameOverride}\n          store={store}\n          mediaSearchStore={mediaSearchStore}\n          finished={() => setSelectedPersonId(null)}\n          history={history}\n          showBackButton\n          onBack={() => setSelectedPersonId(null)}\n        />\n      );\n    } else {\n      return (\n        <UserProfileSidebarContainer\n          user={selectedPerson}\n          hubChannel={hubChannel}\n          performConditionalSignIn={performConditionalSignIn}\n          showBackButton\n          onBack={() => setSelectedPersonId(null)}\n          onCloseDialog={onCloseDialog}\n          showNonHistoriedDialog={showNonHistoriedDialog}\n        />\n      );\n    }\n  }\n\n  return (\n    <PeopleListContainer onSelectPerson={setSelectedPerson} onClose={onClose} hubChannel={hubChannel} people={people} />\n  );\n}\n\nPeopleSidebarContainer.propTypes = {\n  displayNameOverride: PropTypes.string,\n  store: PropTypes.object.isRequired,\n  mediaSearchStore: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object.isRequired,\n  history: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  mySessionId: PropTypes.string.isRequired,\n  presences: PropTypes.object.isRequired,\n  performConditionalSignIn: PropTypes.func.isRequired,\n  onCloseDialog: PropTypes.func.isRequired,\n  showNonHistoriedDialog: PropTypes.func.isRequired\n};\n","import { faVideo } from \"@fortawesome/free-solid-svg-icons/faVideo\";\nimport { faMusic } from \"@fortawesome/free-solid-svg-icons/faMusic\";\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\nimport { faNewspaper } from \"@fortawesome/free-solid-svg-icons/faNewspaper\";\nimport { faQuestion } from \"@fortawesome/free-solid-svg-icons/faQuestion\";\nimport { faCube } from \"@fortawesome/free-solid-svg-icons/faCube\";\n\nexport const SORT_ORDER_VIDEO = 0;\nexport const SORT_ORDER_AUDIO = 1;\nexport const SORT_ORDER_IMAGE = 2;\nexport const SORT_ORDER_PDF = 3;\nexport const SORT_ORDER_MODEL = 4;\nexport const SORT_ORDER_UNIDENTIFIED = 5;\n\nexport function mediaSortOrder(el) {\n  if (el.components[\"media-video\"] && el.components[\"media-video\"].data.contentType.startsWith(\"audio/\")) {\n    return SORT_ORDER_AUDIO;\n  }\n  if (el.components[\"media-video\"]) return SORT_ORDER_VIDEO;\n  if (el.components[\"media-image\"]) return SORT_ORDER_IMAGE;\n  if (el.components[\"media-pdf\"]) return SORT_ORDER_PDF;\n  if (el.components[\"gltf-model-plus\"]) return SORT_ORDER_MODEL;\n  return SORT_ORDER_UNIDENTIFIED;\n}\n\nexport function mediaSort(el1, el2) {\n  return mediaSortOrder(el1) - mediaSortOrder(el2);\n}\n\nexport const DISPLAY_IMAGE = new Map([\n  [SORT_ORDER_VIDEO, faVideo],\n  [SORT_ORDER_AUDIO, faMusic],\n  [SORT_ORDER_IMAGE, faImage],\n  [SORT_ORDER_PDF, faNewspaper],\n  [SORT_ORDER_UNIDENTIFIED, faQuestion],\n  [SORT_ORDER_MODEL, faCube]\n]);\n\nconst SORT_ORDER_TO_TYPE = {\n  [SORT_ORDER_VIDEO]: \"video\",\n  [SORT_ORDER_AUDIO]: \"audio\",\n  [SORT_ORDER_IMAGE]: \"image\",\n  [SORT_ORDER_PDF]: \"pdf\",\n  [SORT_ORDER_MODEL]: \"model\"\n};\n\nexport function getMediaType(el) {\n  const order = mediaSortOrder(el);\n  return SORT_ORDER_TO_TYPE[order];\n}\n","import React, { useState, useEffect, useContext, createContext, useCallback, Children, cloneElement } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { mediaSort, getMediaType } from \"../../utils/media-sorting.js\";\n\nfunction getDisplayString(el) {\n  // Having a listed-media component does not guarantee the existence of a media-loader component,\n  // so don't crash if there isn't one.\n  const url = (el.components[\"media-loader\"] && el.components[\"media-loader\"].data.src) || \"\";\n  const split = url.split(\"/\");\n  const resourceName = split[split.length - 1].split(\"?\")[0];\n  let httpIndex = -1;\n  for (let i = 0; i < split.length; i++) {\n    if (split[i].indexOf(\"http\") !== -1) {\n      httpIndex = i;\n    }\n  }\n\n  let host = \"\";\n  let lessHost = \"\";\n  if (httpIndex !== -1 && split.length > httpIndex + 3) {\n    host = split[httpIndex + 2];\n    const hostSplit = host.split(\".\");\n    if (hostSplit.length > 1) {\n      lessHost = `${hostSplit[hostSplit.length - 2]}.${hostSplit[hostSplit.length - 1]}`;\n    }\n  }\n\n  const firstPart =\n    url.indexOf(\"sketchfab.com\") !== -1 ? \"Sketchfab\" : url.indexOf(\"youtube.com\") !== -1 ? \"YouTube\" : lessHost;\n\n  return `${firstPart} ... ${resourceName.substr(0, 4)}`;\n}\n\nconst ObjectListContext = createContext({\n  objects: [],\n  focusedObject: null,\n  selectedObject: null,\n  focusObject: () => {},\n  unfocusObject: () => {},\n  inspectObject: () => {},\n  uninspectObject: () => {}\n});\n\nfunction handleInspect(scene, object, callback) {\n  const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n\n  callback(object);\n\n  if (object.el.object3D !== cameraSystem.inspectable) {\n    if (cameraSystem.inspectable) {\n      cameraSystem.uninspect(false);\n    }\n\n    cameraSystem.inspect(object.el, 1.5, false);\n  }\n}\n\nfunction handleDeselect(scene, object, callback) {\n  const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n\n  callback(null);\n\n  cameraSystem.uninspect(false);\n\n  if (object) {\n    cameraSystem.inspect(object.el, 1.5, false);\n  }\n}\n\nexport function ObjectListProvider({ scene, children }) {\n  const [objects, setObjects] = useState([]);\n  const [focusedObject, setFocusedObject] = useState(null); // The object currently shown in the viewport\n  const [selectedObject, setSelectedObject] = useState(null); // The object currently selected in the object list\n  const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n  const [lightsEnabled, setLightsEnabled] = useState(cameraSystem.lightsEnabled);\n\n  useEffect(\n    () => {\n      function updateMediaEntities() {\n        const objects = scene.systems[\"listed-media\"].els.sort(mediaSort).map(el => ({\n          id: el.object3D.id,\n          name: getDisplayString(el),\n          type: getMediaType(el),\n          el\n        }));\n\n        setObjects(objects);\n      }\n\n      let timeout;\n\n      function onListedMediaChanged() {\n        // HACK: The listed-media component exists before the media-loader component does, in cases where an entity is created from a network template because of an incoming message, so don't updateMediaEntities right away.\n        // Sorry in advance for the day this comment is out of date.\n        timeout = setTimeout(() => updateMediaEntities(), 0);\n      }\n\n      scene.addEventListener(\"listed_media_changed\", onListedMediaChanged);\n\n      updateMediaEntities();\n\n      return () => {\n        scene.removeEventListener(\"listed_media_changed\", updateMediaEntities);\n        clearTimeout(timeout);\n      };\n    },\n    [scene, setObjects]\n  );\n\n  useEffect(\n    () => {\n      function onInspectTargetChanged() {\n        const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n\n        const inspectedEl = cameraSystem.inspectable && cameraSystem.inspectable.el;\n\n        if (inspectedEl) {\n          const object = objects.find(o => o.el === inspectedEl);\n\n          if (object) {\n            setSelectedObject(object);\n          } else {\n            setSelectedObject({\n              id: inspectedEl.object3D.id,\n              name: getDisplayString(inspectedEl),\n              type: getMediaType(inspectedEl),\n              el: inspectedEl\n            });\n          }\n        } else {\n          setSelectedObject(null);\n        }\n      }\n\n      scene.addEventListener(\"inspect-target-changed\", onInspectTargetChanged);\n\n      return () => {\n        scene.removeEventListener(\"inspect-target-changed\", onInspectTargetChanged);\n      };\n    },\n    [scene, setSelectedObject, objects]\n  );\n\n  useEffect(\n    () => {\n      function onLightsChanged() {\n        const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n        setLightsEnabled(cameraSystem.lightsEnabled);\n      }\n\n      scene.addEventListener(\"inspect-lights-changed\", onLightsChanged);\n\n      return () => {\n        scene.removeEventListener(\"inspect-lights-changed\", onLightsChanged);\n      };\n    },\n    [scene]\n  );\n\n  const selectObject = useCallback(object => handleInspect(scene, object, setSelectedObject), [\n    scene,\n    setSelectedObject\n  ]);\n\n  const deselectObject = useCallback(() => handleDeselect(scene, focusedObject, setSelectedObject), [\n    scene,\n    setSelectedObject,\n    focusedObject\n  ]);\n\n  const focusObject = useCallback(object => handleInspect(scene, object, setFocusedObject), [scene, setFocusedObject]);\n\n  const unfocusObject = useCallback(() => handleDeselect(scene, selectedObject, setFocusedObject), [\n    scene,\n    setFocusedObject,\n    selectedObject\n  ]);\n\n  const selectNextObject = useCallback(\n    () => {\n      const curObjIdx = objects.indexOf(selectedObject);\n\n      if (curObjIdx !== -1) {\n        const nextObjIdx = (curObjIdx + 1) % objects.length;\n        selectObject(objects[nextObjIdx]);\n      }\n    },\n    [selectObject, objects, selectedObject]\n  );\n\n  const selectPrevObject = useCallback(\n    () => {\n      const curObjIdx = objects.indexOf(selectedObject);\n\n      if (curObjIdx !== -1) {\n        const nextObjIdx = curObjIdx === 0 ? objects.length - 1 : curObjIdx - 1;\n        selectObject(objects[nextObjIdx]);\n      }\n    },\n    [selectObject, objects, selectedObject]\n  );\n\n  const toggleLights = useCallback(\n    () => {\n      const cameraSystem = scene.systems[\"hubs-systems\"].cameraSystem;\n      cameraSystem.toggleLights();\n    },\n    [scene]\n  );\n\n  const context = {\n    objects,\n    activeObject: focusedObject || selectedObject,\n    focusedObject,\n    selectedObject,\n    focusObject,\n    unfocusObject,\n    selectObject,\n    deselectObject,\n    selectPrevObject,\n    selectNextObject,\n    toggleLights,\n    lightsEnabled\n  };\n\n  // Note: If we move ui-root to a functional component and use hooks,\n  // we can use the useObjectList hook instead of cloneElement.\n\n  return (\n    <ObjectListContext.Provider value={context}>\n      {Children.map(children, child => cloneElement(child, { ...context }))}\n    </ObjectListContext.Provider>\n  );\n}\n\nObjectListProvider.propTypes = {\n  scene: PropTypes.object.isRequired,\n  children: PropTypes.node\n};\n\nexport function useObjectList() {\n  return useContext(ObjectListContext);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"object\":\"ObjectsSidebar__object__sVTgg\",\"no-objects\":\"ObjectsSidebar__no-objects__R4i8v\",\"noObjects\":\"ObjectsSidebar__no-objects__R4i8v\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgObject = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.5 13.336v-6.67a1.25 1.25 0 0 0-.62-1.079l-5.938-3.455a1.873 1.873 0 0 0-1.885 0L3.121 5.587A1.25 1.25 0 0 0 2.5 6.666v6.67a1.25 1.25 0 0 0 .62 1.08l5.938 3.455a1.875 1.875 0 0 0 1.885 0l5.937-3.456a1.249 1.249 0 0 0 .62-1.079Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.695 6.016 10 10.313l7.305-4.297\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 18.125v-7.812\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgObject as ReactComponent };","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgImage = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 3.125H3.75c-1.035 0-1.875.84-1.875 1.875v10c0 1.036.84 1.875 1.875 1.875h12.5c1.036 0 1.875-.839 1.875-1.874V5c0-1.036-.84-1.876-1.875-1.876Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.125 8.125a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.875 13.116 8.334 9.581a1.25 1.25 0 0 0-1.714-.05l-4.745 4.218\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m8.75 16.875 4.818-4.818a1.25 1.25 0 0 1 1.684-.078l2.873 2.396\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgImage as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgVideo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14.64 12.061 3.231 2.275a.625.625 0 0 0 .879-.572v-7.53a.625.625 0 0 0-.879-.57l-3.23 2.274a.625.625 0 0 0-.266.51v3.102a.624.624 0 0 0 .265.511Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.469 14.998H3.28a2.037 2.037 0 0 1-2.031-2.03V7.03a2.037 2.037 0 0 1 2.031-2.031h7.207A2.019 2.019 0 0 1 12.5 7.01v5.956a2.037 2.037 0 0 1-2.031 2.031Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgVideo as ReactComponent };","var _path, _path2;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgAudio = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M7.5 8.516V8.28c0-.58.39-1.054.947-1.195l6.82-1.823a.782.782 0 0 1 .983.753v.86\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.25 11.559v3.125c0 .543-.349 1-.86 1.171l-.859.313c-1.011.34-2.031-.407-2.031-1.484a1.304 1.304 0 0 1 .898-1.25l1.993-.71c.51-.171.859-.622.859-1.165Zm0 0V2.264a.392.392 0 0 0-.492-.375l-7.79 2.094a.644.644 0 0 0-.468.625v8.828c0 .543-.349 1-.86 1.172l-2.03.703c-.543.183-.86.672-.86 1.25 0 1.077 1.036 1.818 2.031 1.484l.86-.312c.51-.172.859-.628.859-1.172v-3.125\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgAudio as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ObjectsSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { ButtonListItem } from \"../layout/List\";\nimport listStyles from \"../layout/List.scss\";\nimport { ReactComponent as ObjectIcon } from \"../icons/Object.svg\";\nimport { ReactComponent as ImageIcon } from \"../icons/Image.svg\";\nimport { ReactComponent as VideoIcon } from \"../icons/Video.svg\";\nimport { ReactComponent as AudioIcon } from \"../icons/Audio.svg\";\nimport { ReactComponent as TextDocumentIcon } from \"../icons/TextDocument.svg\";\nimport { defineMessages, FormattedMessage, useIntl } from \"react-intl\";\n\nfunction getObjectIcon(type) {\n  switch (type) {\n    case \"video\":\n      return VideoIcon;\n    case \"audio\":\n      return AudioIcon;\n    case \"image\":\n      return ImageIcon;\n    case \"pdf\":\n      return TextDocumentIcon;\n    case \"model\":\n    default:\n      return ObjectIcon;\n  }\n}\n\nconst objectTypeNames = defineMessages({\n  video: { id: \"objects-sidebar.object-type.video\", defaultMessage: \"Video\" },\n  audio: { id: \"objects-sidebar.object-type.audio\", defaultMessage: \"Audio\" },\n  image: { id: \"objects-sidebar.object-type.image\", defaultMessage: \"Image\" },\n  pdf: { id: \"objects-sidebar.object-type.pdf\", defaultMessage: \"PDF\" },\n  model: { id: \"objects-sidebar.object-type.model\", defaultMessage: \"Model\" },\n  default: { id: \"objects-sidebar.object-type.default\", defaultMessage: \"Object\" }\n});\n\nexport function ObjectsSidebarItem({ selected, object, ...rest }) {\n  const intl = useIntl();\n  const ObjectTypeIcon = getObjectIcon(object.type);\n\n  return (\n    <ButtonListItem\n      {...rest}\n      className={classNames(styles.object, { [listStyles.selected]: selected })}\n      type=\"button\"\n      aria-label={intl.formatMessage(\n        { id: \"objects-sidebar.object-label\", defaultMessage: \"{objectType}: {objectName}\" },\n        {\n          objectType: intl.formatMessage(objectTypeNames[object.type] || objectTypeNames.default),\n          objectName: object.name\n        }\n      )}\n    >\n      <ObjectTypeIcon />\n      <p>{object.name}</p>\n    </ButtonListItem>\n  );\n}\n\nObjectsSidebarItem.propTypes = {\n  selected: PropTypes.bool,\n  object: PropTypes.shape({\n    id: PropTypes.any.isRequired,\n    name: PropTypes.string.isRequired,\n    type: PropTypes.string\n  })\n};\n\nexport function NoObjects({ canAddObjects }) {\n  return (\n    <li className={styles.noObjects}>\n      <p>\n        <FormattedMessage id=\"objects-sidebar.no-objects\" defaultMessage=\"There are no objects in the room.\" />\n      </p>\n      {canAddObjects && (\n        <p>\n          <FormattedMessage id=\"objects-sidebar.place-menu-tip\" defaultMessage=\"Use the place menu to add objects.\" />\n        </p>\n      )}\n    </li>\n  );\n}\n\nNoObjects.propTypes = {\n  canAddObjects: PropTypes.bool\n};\n\nexport function ObjectsSidebar({ children, objectCount, onClose }) {\n  return (\n    <Sidebar\n      title={\n        <FormattedMessage\n          id=\"objects-sidebar.title\"\n          defaultMessage=\"Objects ({objectCount})\"\n          values={{ objectCount }}\n        />\n      }\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <ul>{children}</ul>\n    </Sidebar>\n  );\n}\n\nObjectsSidebar.propTypes = {\n  objectCount: PropTypes.number.isRequired,\n  children: PropTypes.node,\n  onClose: PropTypes.func\n};\n\nObjectsSidebar.defaultProps = {\n  objectCount: 0\n};\n","import React, { useCallback, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { NoObjects, ObjectsSidebar, ObjectsSidebarItem } from \"./ObjectsSidebar\";\nimport { List } from \"../layout/List\";\nimport { useObjectList } from \"./useObjectList\";\n\nexport function ObjectsSidebarContainer({ onClose, hubChannel }) {\n  const listRef = useRef();\n  const { objects, selectedObject, selectObject, unfocusObject, focusObject } = useObjectList();\n\n  const onUnfocusListItem = useCallback(\n    e => {\n      if (e.relatedTarget === listRef.current || !listRef.current.contains(e.relatedTarget)) {\n        unfocusObject();\n      }\n    },\n    [unfocusObject, listRef]\n  );\n\n  return (\n    <ObjectsSidebar objectCount={objects.length} onClose={onClose}>\n      {objects.length > 0 ? (\n        <List ref={listRef}>\n          {objects.map(object => (\n            <ObjectsSidebarItem\n              selected={selectedObject === object}\n              object={object}\n              key={object.id}\n              onClick={() => selectObject(object)}\n              onMouseOver={() => focusObject(object)}\n              onFocus={() => focusObject(object)}\n              onMouseOut={onUnfocusListItem}\n              onBlur={onUnfocusListItem}\n            />\n          ))}\n        </List>\n      ) : (\n        <NoObjects canAddObjects={hubChannel.can(\"spawn_and_move_media\")} />\n      )}\n    </ObjectsSidebar>\n  );\n}\n\nObjectsSidebarContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"back-button\":\"ObjectMenu__back-button__ICMWs\",\"backButton\":\"ObjectMenu__back-button__ICMWs\",\"lights-button\":\"ObjectMenu__lights-button__fapNn\",\"lightsButton\":\"ObjectMenu__lights-button__fapNn\",\"object-menu-container\":\"ObjectMenu__object-menu-container__ot90K\",\"objectMenuContainer\":\"ObjectMenu__object-menu-container__ot90K\",\"object-menu\":\"ObjectMenu__object-menu__IKHRK\",\"objectMenu\":\"ObjectMenu__object-menu__IKHRK\",\"header\":\"ObjectMenu__header__Rbudi\",\"close-button\":\"ObjectMenu__close-button__WCIkA\",\"closeButton\":\"ObjectMenu__close-button__WCIkA\",\"lights-header-button\":\"ObjectMenu__lights-header-button__Cowoe\",\"lightsHeaderButton\":\"ObjectMenu__lights-header-button__Cowoe\",\"menu\":\"ObjectMenu__menu__CAJfI\",\"object-menu-button\":\"ObjectMenu__object-menu-button__TEFnB\",\"objectMenuButton\":\"ObjectMenu__object-menu-button__TEFnB\",\"separator\":\"ObjectMenu__separator__rZsbV\",\"pagination\":\"ObjectMenu__pagination__tAo_e\"};","var _path, _path2, _path3;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLightbulb = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.25 18.125h-2.5a.625.625 0 1 0 0 1.25h2.5a.625.625 0 0 0 0-1.25Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.875 16.25h-3.75a.625.625 0 0 0 0 1.25h3.75a.625.625 0 1 0 0-1.25Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M14.43 2.449A6.214 6.214 0 0 0 10 .625a6.235 6.235 0 0 0-6.25 6.25c0 1.821.698 3.525 1.914 4.674l.17.16c.704.657 1.666 1.558 1.666 2.354V15a.625.625 0 0 0 .625.625h.938a.313.313 0 0 0 .312-.312v-4.578a.313.313 0 0 0-.2-.291 5.104 5.104 0 0 1-1.022-.561.625.625 0 1 1 .726-1.016c.289.205.845.508 1.121.508s.832-.304 1.122-.508a.625.625 0 0 1 .725 1.016 5.102 5.102 0 0 1-1.022.56.313.313 0 0 0-.2.291v4.579a.313.313 0 0 0 .313.312h.937A.625.625 0 0 0 12.5 15v-.937c0-.777.952-1.677 1.646-2.335l.192-.182c1.251-1.194 1.912-2.811 1.912-4.67a6.216 6.216 0 0 0-1.82-4.427Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgLightbulb as ReactComponent };","var _path, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgLightbulbOutline = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.875 15v-.937c0-1.133 1.232-2.204 2.031-2.969 1.127-1.077 1.719-2.523 1.719-4.218A5.595 5.595 0 0 0 10 1.25a5.61 5.61 0 0 0-5.625 5.625c0 1.634.618 3.179 1.719 4.218.795.75 2.031 1.825 2.031 2.97V15\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.75 18.75h2.5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M8.125 16.875h3.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 15v-5\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.484 9.375S10.644 10 10 10s-1.484-.625-1.484-.625\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgLightbulbOutline as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { joinChildren } from \"../misc/joinChildren\";\nimport styles from \"./ObjectMenu.scss\";\nimport { IconButton } from \"../input/IconButton\";\nimport { ReactComponent as CloseIcon } from \"../icons/Close.svg\";\nimport { ReactComponent as ChevronBackIcon } from \"../icons/ChevronBack.svg\";\nimport { ReactComponent as ArrowBackIcon } from \"../icons/ArrowBack.svg\";\nimport { ReactComponent as ArrowForwardIcon } from \"../icons/ArrowForward.svg\";\nimport { ReactComponent as LightbulbIcon } from \"../icons/Lightbulb.svg\";\nimport { ReactComponent as LightbulbOutlineIcon } from \"../icons/LightbulbOutline.svg\";\n\nexport function ObjectMenuButton({ children, className, ...rest }) {\n  return (\n    <IconButton compactSm className={classNames(styles.objectMenuButton, className)} {...rest}>\n      {children}\n    </IconButton>\n  );\n}\n\nObjectMenuButton.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport function ObjectMenu({\n  children,\n  title,\n  onClose,\n  onBack,\n  onPrevObject,\n  onNextObject,\n  currentObjectIndex,\n  objectCount,\n  onToggleLights,\n  lightsEnabled\n}) {\n  return (\n    <>\n      <IconButton className={styles.backButton} onClick={onBack}>\n        <ChevronBackIcon width={24} height={24} />\n      </IconButton>\n      <IconButton className={styles.lightsButton} onClick={onToggleLights}>\n        {lightsEnabled ? (\n          <LightbulbOutlineIcon title=\"Turn Lights Off\" width={24} height={24} />\n        ) : (\n          <LightbulbIcon title=\"Turn Lights On\" width={24} height={24} />\n        )}\n      </IconButton>\n      <div className={styles.objectMenuContainer}>\n        <div className={styles.objectMenu}>\n          <div className={styles.header}>\n            <IconButton className={styles.closeButton} onClick={onClose}>\n              <CloseIcon width={16} height={16} />\n            </IconButton>\n            <h5>{title}</h5>\n            <IconButton className={styles.lightsHeaderButton} onClick={onToggleLights}>\n              {lightsEnabled ? (\n                <LightbulbOutlineIcon title=\"Turn Lights Off\" width={16} height={16} />\n              ) : (\n                <LightbulbIcon title=\"Turn Lights On\" width={16} height={16} />\n              )}\n            </IconButton>\n          </div>\n          <div className={styles.menu}>{joinChildren(children, () => <div className={styles.separator} />)}</div>\n        </div>\n        <div className={styles.pagination}>\n          <IconButton onClick={onPrevObject}>\n            <ArrowBackIcon width={24} height={24} />\n          </IconButton>\n          <p>\n            {currentObjectIndex + 1}/{objectCount}\n          </p>\n          <IconButton onClick={onNextObject}>\n            <ArrowForwardIcon width={24} height={24} />\n          </IconButton>\n        </div>\n      </div>\n    </>\n  );\n}\n\nObjectMenu.propTypes = {\n  currentObjectIndex: PropTypes.number.isRequired,\n  objectCount: PropTypes.number.isRequired,\n  onPrevObject: PropTypes.func,\n  onNextObject: PropTypes.func,\n  children: PropTypes.node,\n  title: PropTypes.node,\n  onClose: PropTypes.func,\n  onBack: PropTypes.func,\n  onToggleLights: PropTypes.func,\n  lightsEnabled: PropTypes.bool\n};\n","export function removeNetworkedObject(scene, targetEl) {\n  if (!NAF.utils.isMine(targetEl) && !NAF.utils.takeOwnership(targetEl)) return;\n\n  targetEl.setAttribute(\"animation__remove\", {\n    property: \"scale\",\n    dur: 200,\n    to: { x: 0.01, y: 0.01, z: 0.01 },\n    easing: \"easeInQuad\"\n  });\n\n  targetEl.addEventListener(\"animationcomplete\", () => {\n    scene.systems[\"hubs-systems\"].cameraSystem.uninspect();\n    NAF.utils.takeOwnership(targetEl);\n    targetEl.parentNode.removeChild(targetEl);\n  });\n}\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgPin = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 22,\n    height: 22,\n    viewBox: \"0 0 22 22\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M10.463 12.668a.751.751 0 0 1-.07.08l-5.08 5.081a.75.75 0 1 1-1.061-1.06l5.08-5.081a.758.758 0 0 1 .081-.07l-.386-.386-2.536-2.537a1.12 1.12 0 0 1-.331-.8c0-.266.092-.542.285-.753a4.598 4.598 0 0 1 3.593-1.516h.193a2.74 2.74 0 0 0 2.739-2.739v-.67c0-.304.119-.589.33-.8a1.143 1.143 0 0 1 1.608 0l5.68 5.68c.211.21.33.495.33.799 0 .625-.514 1.14-1.13 1.14h-.67a2.74 2.74 0 0 0-2.74 2.738V11.986a4.995 4.995 0 0 1-1.47 3.528 1.143 1.143 0 0 1-1.608 0l-2.536-2.546-.3-.3Zm-.486-5.544.03.002h.224a4.24 4.24 0 0 0 4.233-4.032L18.91 7.54a4.24 4.24 0 0 0-4.031 4.234V11.986c0 .798-.28 1.574-.787 2.197l-2.266-2.273-.001-.002-1.737-1.737-2.276-2.275a3.098 3.098 0 0 1 2.165-.772Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgPin as ReactComponent };","import { useEffect, useState, useCallback, useMemo } from \"react\";\nimport { removeNetworkedObject } from \"../../utils/removeNetworkedObject\";\nimport { rotateInPlaceAroundWorldUp, affixToWorldUp } from \"../../utils/three-utils\";\nimport { getPromotionTokenForFile } from \"../../utils/media-utils\";\nimport { hasComponent } from \"bitecs\";\nimport { Pinnable, Pinned, Static } from \"../../bit-components\";\n\nfunction getPinnedState(el) {\n  return !!(hasComponent(APP.world, Pinnable, el.eid) && hasComponent(APP.world, Pinned, el.eid));\n}\n\nexport function isMe(object) {\n  return object.el.id === \"avatar-rig\";\n}\n\nexport function isPlayer(object) {\n  return !!object.el.components[\"networked-avatar\"];\n}\n\nexport function getObjectUrl(object) {\n  const mediaLoader = object.el.components[\"media-loader\"];\n\n  const url =\n    mediaLoader && ((mediaLoader.data.mediaOptions && mediaLoader.data.mediaOptions.href) || mediaLoader.data.src);\n\n  if (url && !url.startsWith(\"hubs://\")) {\n    return url;\n  }\n\n  return null;\n}\n\nexport function usePinObject(hubChannel, scene, object) {\n  const [isPinned, setIsPinned] = useState(getPinnedState(object.el));\n\n  const pinObject = useCallback(\n    () => {\n      const el = object.el;\n      if (!NAF.utils.isMine(el) && !NAF.utils.takeOwnership(el)) return;\n      window.APP.pinningHelper.setPinned(el, true);\n    },\n    [object]\n  );\n\n  const unpinObject = useCallback(\n    () => {\n      const el = object.el;\n      if (!NAF.utils.isMine(el) && !NAF.utils.takeOwnership(el)) return;\n      window.APP.pinningHelper.setPinned(el, false);\n    },\n    [object]\n  );\n\n  const togglePinned = useCallback(\n    () => {\n      if (isPinned) {\n        unpinObject();\n      } else {\n        pinObject();\n      }\n    },\n    [isPinned, pinObject, unpinObject]\n  );\n\n  useEffect(\n    () => {\n      const el = object.el;\n\n      function onPinStateChanged() {\n        setIsPinned(getPinnedState(el));\n      }\n      el.addEventListener(\"pinned\", onPinStateChanged);\n      el.addEventListener(\"unpinned\", onPinStateChanged);\n      setIsPinned(getPinnedState(el));\n      return () => {\n        el.removeEventListener(\"pinned\", onPinStateChanged);\n        el.removeEventListener(\"unpinned\", onPinStateChanged);\n      };\n    },\n    [object]\n  );\n\n  const el = object.el;\n\n  let userOwnsFile = false;\n\n  if (el.components[\"media-loader\"]) {\n    const { fileIsOwned, fileId } = el.components[\"media-loader\"].data;\n    userOwnsFile = fileIsOwned || (fileId && getPromotionTokenForFile(fileId));\n  }\n\n  const canPin = !!(\n    scene.is(\"entered\") &&\n    !isPlayer(object) &&\n    !hasComponent(APP.world, Static, el.eid) &&\n    hubChannel.can(\"pin_objects\") &&\n    userOwnsFile\n  );\n\n  return { canPin, isPinned, togglePinned, pinObject, unpinObject };\n}\n\nexport function useGoToSelectedObject(scene, object) {\n  const goToSelectedObject = useCallback(\n    () => {\n      const viewingCamera = document.getElementById(\"viewing-camera\");\n      const targetMatrix = new THREE.Matrix4();\n      const translation = new THREE.Matrix4();\n      viewingCamera.object3DMap.camera.updateMatrices();\n      targetMatrix.copy(viewingCamera.object3DMap.camera.matrixWorld);\n      affixToWorldUp(targetMatrix, targetMatrix);\n      translation.makeTranslation(0, -1.6, 0.15);\n      targetMatrix.multiply(translation);\n      rotateInPlaceAroundWorldUp(targetMatrix, Math.PI, targetMatrix);\n\n      scene.systems[\"hubs-systems\"].characterController.enqueueWaypointTravelTo(targetMatrix, true, {\n        willDisableMotion: false,\n        willDisableTeleporting: false,\n        snapToNavMesh: false,\n        willMaintainInitialOrientation: false\n      });\n    },\n    [scene]\n  );\n\n  const uiRoot = useMemo(() => document.getElementById(\"ui-root\"), []);\n  const isSpectating = uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n  const canGoTo = !isSpectating && !isPlayer(object);\n\n  return { canGoTo, goToSelectedObject };\n}\n\nexport function useRemoveObject(hubChannel, scene, object) {\n  const removeObject = useCallback(\n    () => {\n      removeNetworkedObject(scene, object.el);\n    },\n    [scene, object]\n  );\n\n  const el = object.el;\n\n  const canRemoveObject = !!(\n    scene.is(\"entered\") &&\n    !isPlayer(object) &&\n    !getPinnedState(el) &&\n    !hasComponent(APP.world, Static, el.eid) &&\n    hubChannel.can(\"spawn_and_move_media\")\n  );\n\n  return { removeObject, canRemoveObject };\n}\n\nexport function useHideAvatar(hubChannel, avatarEl) {\n  const hideAvatar = useCallback(\n    () => {\n      if (avatarEl.components.networked) {\n        const clientId = avatarEl.components.networked.data.owner;\n\n        if (clientId && clientId !== NAF.clientId) {\n          hubChannel.hide(clientId);\n        }\n      }\n    },\n    [hubChannel, avatarEl]\n  );\n\n  return hideAvatar;\n}\n","var _path, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgGoTo = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m12.274 18.84-2.218-4.482-1.753-2.242a2.844 2.844 0 0 1-.396-1.447V5.624h.612a1.57 1.57 0 0 1 1.572 1.571v7.163\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.996 11.446v-2.91s1.456-2.912 2.911-2.912\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m14.457 10.719-2.582-1.696\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m6.661 18.684 2.09-3.06\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.09 4.169a1.455 1.455 0 1 0 0-2.911 1.455 1.455 0 0 0 0 2.91Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgGoTo as ReactComponent };","var _path, _path2, _path3, _path4, _path5;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgHide = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.875 17.5a.623.623 0 0 1-.442-.183L2.683 3.567a.625.625 0 0 1 .884-.883l13.75 13.75a.624.624 0 0 1-.442 1.066Z\",\n    fill: \"currentColor\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9.987 15c-1.62 0-3.184-.48-4.646-1.426-1.33-.859-2.528-2.09-3.464-3.554v-.003c.779-1.116 1.632-2.06 2.548-2.821a.078.078 0 0 0 .006-.115l-.779-.777a.078.078 0 0 0-.105-.005C2.573 7.12 1.67 8.126.848 9.304a1.247 1.247 0 0 0-.025 1.388c1.032 1.615 2.36 2.975 3.84 3.932 1.665 1.08 3.458 1.626 5.324 1.626a9.34 9.34 0 0 0 2.96-.491.079.079 0 0 0 .05-.096.079.079 0 0 0-.02-.034l-.842-.842a.156.156 0 0 0-.15-.04A8 8 0 0 1 9.987 15Z\",\n    fill: \"currentColor\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M19.173 9.32C18.14 7.722 16.8 6.364 15.296 5.393c-1.663-1.075-3.5-1.643-5.31-1.643a8.88 8.88 0 0 0-2.925.5.078.078 0 0 0-.03.13l.843.842a.156.156 0 0 0 .151.039A7.532 7.532 0 0 1 9.987 5c1.59 0 3.147.485 4.63 1.445 1.356.875 2.569 2.105 3.507 3.555a.005.005 0 0 1 0 .006 12.136 12.136 0 0 1-2.505 2.84.078.078 0 0 0-.023.089c.004.01.01.02.017.027l.777.777a.078.078 0 0 0 .106.005 13.42 13.42 0 0 0 2.681-3.066 1.258 1.258 0 0 0-.004-1.358Z\",\n    fill: \"currentColor\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 6.25c-.281 0-.561.03-.835.093a.078.078 0 0 0-.039.132l4.398 4.397a.078.078 0 0 0 .132-.039A3.75 3.75 0 0 0 10 6.249Z\",\n    fill: \"currentColor\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.476 9.128a.078.078 0 0 0-.132.039 3.75 3.75 0 0 0 4.492 4.492.077.077 0 0 0 .059-.054.078.078 0 0 0-.02-.078l-4.4-4.4Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgHide as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ObjectMenu, ObjectMenuButton } from \"./ObjectMenu\";\nimport { useObjectList } from \"./useObjectList\";\nimport {\n  usePinObject,\n  useRemoveObject,\n  useGoToSelectedObject,\n  getObjectUrl,\n  isPlayer,\n  isMe,\n  useHideAvatar\n} from \"./object-hooks\";\nimport { ReactComponent as PinIcon } from \"../icons/Pin.svg\";\nimport { ReactComponent as LinkIcon } from \"../icons/Link.svg\";\nimport { ReactComponent as GoToIcon } from \"../icons/GoTo.svg\";\nimport { ReactComponent as DeleteIcon } from \"../icons/Delete.svg\";\nimport { ReactComponent as AvatarIcon } from \"../icons/Avatar.svg\";\nimport { ReactComponent as HideIcon } from \"../icons/Hide.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nfunction MyMenuItems({ onOpenProfile }) {\n  return (\n    <ObjectMenuButton onClick={onOpenProfile}>\n      <AvatarIcon />\n      <span>\n        <FormattedMessage id=\"object-menu.edit-avatar-button\" defaultMessage=\"Edit Avatar\" />\n      </span>\n    </ObjectMenuButton>\n  );\n}\n\nMyMenuItems.propTypes = {\n  onOpenProfile: PropTypes.func.isRequired\n};\n\nfunction PlayerMenuItems({ hubChannel, activeObject, deselectObject }) {\n  const hideAvatar = useHideAvatar(hubChannel, activeObject.el);\n\n  return (\n    <ObjectMenuButton\n      onClick={() => {\n        deselectObject();\n        hideAvatar();\n      }}\n    >\n      <HideIcon />\n      <span>\n        <FormattedMessage id=\"object-menu.hide-avatar-button\" defaultMessage=\"Hide\" />\n      </span>\n    </ObjectMenuButton>\n  );\n}\n\nPlayerMenuItems.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  activeObject: PropTypes.object.isRequired,\n  deselectObject: PropTypes.func.isRequired\n};\n\nfunction ObjectMenuItems({ hubChannel, scene, activeObject, deselectObject, onGoToObject }) {\n  const { canPin, isPinned, togglePinned } = usePinObject(hubChannel, scene, activeObject);\n  const { canRemoveObject, removeObject } = useRemoveObject(hubChannel, scene, activeObject);\n  const { canGoTo, goToSelectedObject } = useGoToSelectedObject(scene, activeObject);\n  const url = getObjectUrl(activeObject);\n\n  return (\n    <>\n      <ObjectMenuButton disabled={!canPin} onClick={togglePinned}>\n        <PinIcon />\n        <span>\n          {isPinned ? (\n            <FormattedMessage id=\"object-menu.unpin-object-button\" defaultMessage=\"Unpin\" />\n          ) : (\n            <FormattedMessage id=\"object-menu.pin-object-button\" defaultMessage=\"Pin\" />\n          )}\n        </span>\n      </ObjectMenuButton>\n      {url && (\n        <ObjectMenuButton as=\"a\" href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n          <LinkIcon />\n          <span>\n            <FormattedMessage id=\"object-menu.object-link-button\" defaultMessage=\"Link\" />\n          </span>\n        </ObjectMenuButton>\n      )}\n      <ObjectMenuButton\n        disabled={!canGoTo}\n        onClick={() => {\n          goToSelectedObject();\n          deselectObject();\n          onGoToObject();\n        }}\n      >\n        <GoToIcon />\n        <span>\n          <FormattedMessage id=\"object-menu.view-object-button\" defaultMessage=\"View\" />\n        </span>\n      </ObjectMenuButton>\n      <ObjectMenuButton\n        disabled={!canRemoveObject}\n        onClick={() => {\n          removeObject();\n          deselectObject();\n        }}\n      >\n        <DeleteIcon />\n        <span>\n          <FormattedMessage id=\"object-menu.delete-object-button\" defaultMessage=\"Delete\" />\n        </span>\n      </ObjectMenuButton>\n    </>\n  );\n}\n\nObjectMenuItems.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  activeObject: PropTypes.object.isRequired,\n  deselectObject: PropTypes.func.isRequired,\n  onGoToObject: PropTypes.func.isRequired\n};\n\nexport function ObjectMenuContainer({ hubChannel, scene, onOpenProfile, onGoToObject }) {\n  const {\n    objects,\n    activeObject,\n    deselectObject,\n    selectNextObject,\n    selectPrevObject,\n    toggleLights,\n    lightsEnabled\n  } = useObjectList();\n\n  let menuItems;\n\n  if (isMe(activeObject)) {\n    menuItems = <MyMenuItems onOpenProfile={onOpenProfile} />;\n  } else if (isPlayer(activeObject)) {\n    menuItems = <PlayerMenuItems hubChannel={hubChannel} activeObject={activeObject} deselectObject={deselectObject} />;\n  } else {\n    menuItems = (\n      <ObjectMenuItems\n        hubChannel={hubChannel}\n        scene={scene}\n        activeObject={activeObject}\n        deselectObject={deselectObject}\n        onGoToObject={onGoToObject}\n      />\n    );\n  }\n\n  return (\n    <ObjectMenu\n      title={<FormattedMessage id=\"object-menu.title\" defaultMessage=\"Object\" />}\n      currentObjectIndex={objects.indexOf(activeObject)}\n      objectCount={objects.length}\n      onClose={deselectObject}\n      onBack={deselectObject}\n      onNextObject={selectNextObject}\n      onPrevObject={selectPrevObject}\n      onToggleLights={toggleLights}\n      lightsEnabled={lightsEnabled}\n    >\n      {menuItems}\n    </ObjectMenu>\n  );\n}\n\nObjectMenuContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  onOpenProfile: PropTypes.func.isRequired,\n  onGoToObject: PropTypes.func.isRequired\n};\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgGif = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M3.25 15.375a1.125 1.125 0 0 1-1.125-1.125v-9c0-.621.504-1.125 1.125-1.125h13.5c.621 0 1.125.504 1.125 1.125v9c0 .621-.504 1.125-1.125 1.125H3.25ZM1 14.25a2.25 2.25 0 0 0 2.25 2.25h13.5A2.25 2.25 0 0 0 19 14.25v-9A2.25 2.25 0 0 0 16.75 3H3.25A2.25 2.25 0 0 0 1 5.25v9Zm7.958-2.558c-.204.244-.492.434-.865.57-.373.133-.786.2-1.239.2-.476 0-.894-.103-1.254-.31a2.105 2.105 0 0 1-.83-.906c-.194-.395-.294-.86-.299-1.393v-.374c0-.55.092-1.024.276-1.424.186-.403.453-.71.8-.922.35-.214.76-.32 1.228-.32.652 0 1.162.156 1.53.468.367.31.585.761.653 1.356H7.855c-.05-.315-.162-.546-.336-.692-.171-.146-.408-.219-.71-.219-.385 0-.679.145-.88.435-.201.29-.303.72-.306 1.291v.352c0 .576.11 1.012.329 1.306.219.295.54.442.963.442.425 0 .729-.09.91-.272v-.948H6.794v-.834h2.164v2.194Zm2.126.695H9.951V6.888h1.133v5.499Zm2.187-2.247h2.175v-.914H13.27v-1.42h2.447v-.918h-3.58v5.499h1.133V10.14Z\",\n    fill: \"currentColor\"\n  })));\n};\n\nexport { SvgGif as ReactComponent };","var _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgScene = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 1.874a8.125 8.125 0 1 0 0 16.25 8.125 8.125 0 0 0 0-16.25Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 1.874C7.73 1.874 5.599 5.512 5.599 10s2.132 8.125 4.4 8.125c2.27 0 4.402-3.638 4.402-8.125S12.268 1.874 10 1.874Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M4.583 4.583C6.077 5.643 7.958 6.276 10 6.276c2.043 0 3.923-.633 5.417-1.693\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.417 15.417c-1.494-1.06-3.374-1.693-5.417-1.693-2.042 0-3.923.633-5.417 1.693\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10 1.874v16.25\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M18.125 9.999H1.875\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10\n  })));\n};\n\nexport { SvgScene as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport styles from \"./ButtonGridPopover.scss\";\n\nexport function ButtonGridPopover({ fullscreen, items, closePopover }) {\n  return (\n    <div className={classNames(styles.buttonGridPopover, { [styles.fullscreen]: fullscreen })}>\n      {items.map(item => {\n        const Icon = item.icon;\n        return (\n          <ToolbarButton\n            key={item.id}\n            icon={<Icon />}\n            preset={item.color}\n            onClick={() => {\n              if (item.onSelect) {\n                item.onSelect(item);\n              }\n\n              closePopover();\n            }}\n            label={item.label}\n            selected={item.selected}\n          />\n        );\n      })}\n    </div>\n  );\n}\n\nButtonGridPopover.propTypes = {\n  fullscreen: PropTypes.bool,\n  items: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      icon: PropTypes.elementType.isRequired,\n      color: PropTypes.string,\n      label: PropTypes.element.isRequired,\n      onSelect: PropTypes.func\n    })\n  ).isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"button-grid-popover\":\"ButtonGridPopover__button-grid-popover__udJ1S\",\"buttonGridPopover\":\"ButtonGridPopover__button-grid-popover__udJ1S\",\"fullscreen\":\"ButtonGridPopover__fullscreen__kypKC\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ButtonGridPopover } from \"../popover/ButtonGridPopover\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ObjectIcon } from \"../icons/Object.svg\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst placePopoverTitle = defineMessage({\n  id: \"place-popover.title\",\n  defaultMessage: \"Place\"\n});\n\nexport function PlacePopoverButton({ items }) {\n  const intl = useIntl();\n  const filteredItems = items.filter(item => !!item);\n\n  // The button is removed if you can't place anything.\n  if (filteredItems.length === 0) {\n    return null;\n  }\n\n  const title = intl.formatMessage(placePopoverTitle);\n\n  return (\n    <Popover\n      title={title}\n      content={props => <ButtonGridPopover items={filteredItems} {...props} />}\n      placement=\"top\"\n      offsetDistance={28}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<ObjectIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n          preset=\"accent3\"\n        />\n      )}\n    </Popover>\n  );\n}\n\nPlacePopoverButton.propTypes = {\n  items: PropTypes.array.isRequired\n};\n","import React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ReactComponent as PenIcon } from \"../icons/Pen.svg\";\nimport { ReactComponent as CameraIcon } from \"../icons/Camera.svg\";\n// import { ReactComponent as TextIcon } from \"../icons/Text.svg\";\n// import { ReactComponent as LinkIcon } from \"../icons/Link.svg\";\nimport { ReactComponent as GIFIcon } from \"../icons/GIF.svg\";\nimport { ReactComponent as ObjectIcon } from \"../icons/Object.svg\";\nimport { ReactComponent as AvatarIcon } from \"../icons/Avatar.svg\";\nimport { ReactComponent as SceneIcon } from \"../icons/Scene.svg\";\nimport { ReactComponent as UploadIcon } from \"../icons/Upload.svg\";\nimport { PlacePopoverButton } from \"./PlacePopover\";\nimport { ObjectUrlModalContainer } from \"./ObjectUrlModalContainer\";\nimport configs from \"../../utils/configs\";\nimport { FormattedMessage } from \"react-intl\";\nimport { anyEntityWith } from \"../../utils/bit-utils\";\nimport { MyCameraTool } from \"../../bit-components\";\n\nexport function PlacePopoverContainer({ scene, mediaSearchStore, showNonHistoriedDialog, hubChannel }) {\n  const [items, setItems] = useState([]);\n\n  useEffect(\n    () => {\n      function updateItems() {\n        const hasActiveCamera = !!anyEntityWith(APP.world, MyCameraTool);\n        const hasActivePen = !!scene.systems[\"pen-tools\"].getMyPen();\n\n        let nextItems = [\n          hubChannel.can(\"spawn_drawing\") && {\n            id: \"pen\",\n            icon: PenIcon,\n            color: \"accent5\",\n            label: <FormattedMessage id=\"place-popover.item-type.pen\" defaultMessage=\"Pen\" />,\n            onSelect: () => scene.emit(\"penButtonPressed\"),\n            selected: hasActivePen\n          },\n          hubChannel.can(\"spawn_camera\") && {\n            id: \"camera\",\n            icon: CameraIcon,\n            color: \"accent5\",\n            label: <FormattedMessage id=\"place-popover.item-type.camera\" defaultMessage=\"Camera\" />,\n            onSelect: () => scene.emit(\"action_toggle_camera\"),\n            selected: hasActiveCamera\n          }\n        ];\n\n        if (hubChannel.can(\"spawn_and_move_media\")) {\n          nextItems = [\n            ...nextItems,\n            // TODO: Create text/link dialog\n            // { id: \"text\", icon: TextIcon, color: \"blue\", label: \"Text\" },\n            // { id: \"link\", icon: LinkIcon, color: \"blue\", label: \"Link\" },\n            configs.integration(\"tenor\") && {\n              id: \"gif\",\n              icon: GIFIcon,\n              color: \"accent2\",\n              label: <FormattedMessage id=\"place-popover.item-type.gif\" defaultMessage=\"GIF\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"gifs\")\n            },\n            configs.integration(\"sketchfab\") && {\n              id: \"model\",\n              icon: ObjectIcon,\n              color: \"accent2\",\n              label: <FormattedMessage id=\"place-popover.item-type.model\" defaultMessage=\"3D Model\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"sketchfab\")\n            },\n            {\n              id: \"avatar\",\n              icon: AvatarIcon,\n              color: \"accent1\",\n              label: <FormattedMessage id=\"place-popover.item-type.avatar\" defaultMessage=\"Avatar\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"avatars\")\n            },\n            {\n              id: \"scene\",\n              icon: SceneIcon,\n              color: \"accent1\",\n              label: <FormattedMessage id=\"place-popover.item-type.scene\" defaultMessage=\"Scene\" />,\n              onSelect: () => mediaSearchStore.sourceNavigate(\"scenes\")\n            },\n            // TODO: Launch system file prompt directly\n            {\n              id: \"upload\",\n              icon: UploadIcon,\n              color: \"accent3\",\n              label: <FormattedMessage id=\"place-popover.item-type.upload\" defaultMessage=\"Upload\" />,\n              onSelect: () => showNonHistoriedDialog(ObjectUrlModalContainer, { scene })\n            }\n          ];\n        }\n\n        setItems(nextItems);\n      }\n\n      hubChannel.addEventListener(\"permissions_updated\", updateItems);\n\n      updateItems();\n\n      function onSceneStateChange(event) {\n        if (event.detail === \"camera\" || event.detail === \"pen\") {\n          updateItems();\n        }\n      }\n\n      scene.addEventListener(\"stateadded\", onSceneStateChange);\n      scene.addEventListener(\"stateremoved\", onSceneStateChange);\n\n      return () => {\n        hubChannel.removeEventListener(\"permissions_updated\", updateItems);\n        scene.removeEventListener(\"stateadded\", onSceneStateChange);\n        scene.removeEventListener(\"stateremoved\", onSceneStateChange);\n      };\n    },\n    [hubChannel, mediaSearchStore, showNonHistoriedDialog, scene]\n  );\n\n  return <PlacePopoverButton items={items} />;\n}\n\nPlacePopoverContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired,\n  mediaSearchStore: PropTypes.object.isRequired,\n  showNonHistoriedDialog: PropTypes.func.isRequired\n};\n","var _path, _path2, _path3, _path4;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgShare = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 20,\n    viewBox: \"0 0 20 20\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M17.545 4H2.555C1.863 4 1.3 4.562 1.3 5.255v8.114c0 .694.562 1.256 1.256 1.256h14.989c.693 0 1.255-.562 1.255-1.255V5.255C18.8 4.562 18.238 4 17.545 4Z\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinejoin: \"round\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M5.05 16.502h10\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeMiterlimit: 10,\n    strokeLinecap: \"round\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12.697 9.325 10.123 6.75 7.55 9.325\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.123 11.415V6.752\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgShare as ReactComponent };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ButtonGridPopover } from \"../popover/ButtonGridPopover\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ShareIcon } from \"../icons/Share.svg\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst sharePopoverTitle = defineMessage({\n  id: \"share-popover.title\",\n  defaultMessage: \"Share\"\n});\n\nexport function SharePopoverButton({ items }) {\n  const intl = useIntl();\n  const title = intl.formatMessage(sharePopoverTitle);\n\n  const filteredItems = items.filter(item => !!item);\n\n  // The button is removed if you can't share anything.\n  if (filteredItems.length === 0) {\n    return null;\n  }\n\n  const activeItem = filteredItems.find(item => item.active);\n\n  // If there's one item to share (your smartphone camera), or an item is active (recording), then only show that button.\n  if (filteredItems.length === 1 || activeItem) {\n    const item = filteredItems[0];\n    const Icon = item.icon;\n    return (\n      <ToolbarButton\n        icon={<Icon />}\n        onClick={() => {\n          if (item.onSelect) {\n            item.onSelect(item);\n          }\n        }}\n        label={title}\n        preset=\"accent5\"\n        statusColor={activeItem && \"recording\"}\n      />\n    );\n  }\n\n  return (\n    <Popover\n      title={title}\n      content={props => <ButtonGridPopover items={filteredItems} {...props} />}\n      placement=\"top\"\n      offsetDistance={28}\n      disableFullscreen\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={<ShareIcon />}\n          selected={popoverVisible}\n          onClick={togglePopover}\n          label={title}\n          preset=\"accent5\"\n        />\n      )}\n    </Popover>\n  );\n}\n\nSharePopoverButton.propTypes = {\n  items: PropTypes.array.isRequired\n};\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ReactComponent as VideoIcon } from \"../icons/Video.svg\";\nimport { ReactComponent as DesktopIcon } from \"../icons/Desktop.svg\";\nimport { ReactComponent as AvatarIcon } from \"../icons/Avatar.svg\";\nimport { SharePopoverButton } from \"./SharePopover\";\nimport { FormattedMessage } from \"react-intl\";\nimport useAvatar from \"./useAvatar\";\nimport { MediaDevicesEvents, MediaDevices } from \"../../utils/media-devices-utils\";\n\nfunction useShare(scene, hubChannel) {\n  const mediaDevicesManager = APP.mediaDevicesManager;\n  const [sharingSource, setSharingSource] = useState(null);\n  const [canShareCamera, setCanShareCamera] = useState(false);\n  const [canShareScreen, setCanShareScreen] = useState(false);\n  const [canShareCameraToAvatar, setCanShareCameraToAvatar] = useState(false);\n  const { hasVideoTextureTarget } = useAvatar();\n\n  useEffect(\n    () => {\n      function onShareVideoEnabled(event) {\n        setSharingSource(event.detail.source);\n      }\n\n      function onShareVideoDisabled() {\n        setSharingSource(null);\n      }\n\n      function onPermissionsUpdated() {\n        const canShareMedia = hubChannel.can(\"spawn_and_move_media\");\n\n        if (canShareMedia) {\n          navigator.mediaDevices\n            .enumerateDevices()\n            .then(devices => {\n              const hasCamera = devices.some(device => device.kind === \"videoinput\");\n              setCanShareCamera(hasCamera);\n              setCanShareCameraToAvatar(hasCamera && hasVideoTextureTarget);\n            })\n            .catch(() => {\n              setCanShareCamera(false);\n              setCanShareCameraToAvatar(false);\n            });\n\n          setCanShareScreen(!!navigator.mediaDevices.getDisplayMedia);\n        } else {\n          setCanShareScreen(false);\n          setCanShareCamera(false);\n          setCanShareCameraToAvatar(false);\n        }\n      }\n\n      scene.addEventListener(\"share_video_enabled\", onShareVideoEnabled);\n      scene.addEventListener(\"share_video_disabled\", onShareVideoDisabled);\n      // TODO: Show share error dialog\n      scene.addEventListener(\"share_video_failed\", onShareVideoDisabled);\n      hubChannel.addEventListener(\"permissions_updated\", onPermissionsUpdated);\n\n      onPermissionsUpdated();\n\n      // We currently only support sharing one video stream at the same time\n      setSharingSource(\n        mediaDevicesManager.isVideoShared\n          ? mediaDevicesManager.isWebcamShared\n            ? MediaDevices.CAMERA\n            : MediaDevices.SCREEN\n          : null\n      );\n\n      return () => {\n        scene.removeEventListener(\"share_video_enabled\", onShareVideoEnabled);\n        scene.removeEventListener(\"share_video_disabled\", onShareVideoDisabled);\n        scene.removeEventListener(\"share_video_failed\", onShareVideoDisabled);\n        hubChannel.removeEventListener(\"permissions_updated\", onPermissionsUpdated);\n      };\n    },\n    [scene, hubChannel, hasVideoTextureTarget, mediaDevicesManager]\n  );\n\n  const toggleShareCamera = useCallback(\n    () => {\n      if (sharingSource) {\n        scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      } else {\n        scene.emit(\"action_share_camera\");\n      }\n    },\n    [scene, sharingSource]\n  );\n\n  const toggleShareScreen = useCallback(\n    () => {\n      if (sharingSource) {\n        scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      } else {\n        scene.emit(\"action_share_screen\");\n      }\n    },\n    [scene, sharingSource]\n  );\n\n  const toggleShareCameraToAvatar = useCallback(\n    () => {\n      if (sharingSource) {\n        scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n      } else {\n        scene.emit(\"action_share_camera\", { target: \"avatar\" });\n      }\n    },\n    [scene, sharingSource]\n  );\n\n  return {\n    sharingSource,\n    canShareCamera,\n    canShareCameraToAvatar,\n    canShareScreen,\n    toggleShareCamera,\n    toggleShareCameraToAvatar,\n    toggleShareScreen\n  };\n}\n\nexport function SharePopoverContainer({ scene, hubChannel }) {\n  const {\n    sharingSource,\n    canShareCamera,\n    toggleShareCamera,\n    canShareScreen,\n    toggleShareScreen,\n    canShareCameraToAvatar,\n    toggleShareCameraToAvatar\n  } = useShare(scene, hubChannel);\n\n  const items = [\n    canShareCamera && {\n      id: \"camera\",\n      icon: VideoIcon,\n      color: \"accent5\",\n      label: <FormattedMessage id=\"share-popover.source.camera\" defaultMessage=\"Camera\" />,\n      onSelect: toggleShareCamera,\n      active: sharingSource === MediaDevices.CAMERA\n    },\n    canShareScreen && {\n      id: \"screen\",\n      icon: DesktopIcon,\n      color: \"accent5\",\n      label: <FormattedMessage id=\"share-popover.source.screen\" defaultMessage=\"Screen\" />,\n      onSelect: toggleShareScreen,\n      active: sharingSource === MediaDevices.SCREEN\n    },\n    canShareCameraToAvatar && {\n      id: \"camera-to-avatar\",\n      icon: AvatarIcon,\n      color: \"accent5\",\n      label: <FormattedMessage id=\"share-popover.source.avatar-camera\" defaultMessage=\"Avatar Camera\" />,\n      onSelect: toggleShareCameraToAvatar,\n      active: sharingSource === \"camera-to-avatar\"\n    }\n  ];\n\n  return <SharePopoverButton items={items} />;\n}\n\nSharePopoverContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  scene: PropTypes.object.isRequired\n};\n","import { useState, useEffect } from \"react\";\n\nexport default function useAvatar() {\n  const [state, setState] = useState({ hasVideoTextureTarget: false });\n\n  useEffect(() => {\n    const avatarModelEl = document.querySelector(\"#avatar-rig .model\");\n\n    function onAvatarModelLoaded() {\n      const hasVideoTextureTarget = !!avatarModelEl.querySelector(\"[video-texture-target]\");\n      setState({ hasVideoTextureTarget });\n    }\n\n    onAvatarModelLoaded();\n\n    avatarModelEl.addEventListener(\"model-loaded\", onAvatarModelLoaded);\n\n    return () => {\n      avatarModelEl.removeEventListener(\"model-loaded\", onAvatarModelLoaded);\n    };\n  }, []);\n\n  return state;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"audio-toolbar-popover\":\"AudioPopover__audio-toolbar-popover__tZfFp\",\"audioToolbarPopover\":\"AudioPopover__audio-toolbar-popover__tZfFp\",\"selection-input\":\"AudioPopover__selection-input__jyQyN\",\"selectionInput\":\"AudioPopover__selection-input__jyQyN\",\"buttons-container\":\"AudioPopover__buttons-container__PFwbt\",\"buttonsContainer\":\"AudioPopover__buttons-container__PFwbt\",\"icon-enabled\":\"AudioPopover__icon-enabled__LKt6O\",\"iconEnabled\":\"AudioPopover__icon-enabled__LKt6O\",\"icon-disabled\":\"AudioPopover__icon-disabled__dqi0K\",\"iconDisabled\":\"AudioPopover__icon-disabled__dqi0K\",\"arrow-button\":\"AudioPopover__arrow-button__rlPlJ\",\"arrowButton\":\"AudioPopover__arrow-button__rlPlJ\",\"arrow-button-selected\":\"AudioPopover__arrow-button-selected__vHFuE\",\"arrowButtonSelected\":\"AudioPopover__arrow-button-selected__vHFuE\",\"level-bar\":\"AudioPopover__level-bar__WlJAN\",\"levelBar\":\"AudioPopover__level-bar__WlJAN\"};","// extracted by mini-css-extract-plugin\nexport default {\"flex-row\":\"Row__flex-row__kHRrv\",\"flexRow\":\"Row__flex-row__kHRrv\",\"space-between\":\"Row__space-between__vh9wm\",\"spaceBetween\":\"Row__space-between__vh9wm\",\"sm-breakpoint-column\":\"Row__sm-breakpoint-column__ErhgV\",\"smBreakpointColumn\":\"Row__sm-breakpoint-column__ErhgV\",\"md-breakpoint-column\":\"Row__md-breakpoint-column__Tr6kD\",\"mdBreakpointColumn\":\"Row__md-breakpoint-column__Tr6kD\",\"no-flex-wrap\":\"Row__no-flex-wrap__kfuaV\",\"noFlexWrap\":\"Row__no-flex-wrap__kfuaV\",\"2xs-children-margin-r\":\"Row__2xs-children-margin-r__f7nyn\",\"2XsChildrenMarginR\":\"Row__2xs-children-margin-r__f7nyn\",\"xs-children-margin-r\":\"Row__xs-children-margin-r__Sy1dQ\",\"xsChildrenMarginR\":\"Row__xs-children-margin-r__Sy1dQ\",\"sm-children-margin-r\":\"Row__sm-children-margin-r__aUOJn\",\"smChildrenMarginR\":\"Row__sm-children-margin-r__aUOJn\",\"md-children-margin-r\":\"Row__md-children-margin-r__QLh3b\",\"mdChildrenMarginR\":\"Row__md-children-margin-r__QLh3b\",\"lg-children-margin-r\":\"Row__lg-children-margin-r__vJ1JM\",\"lgChildrenMarginR\":\"Row__lg-children-margin-r__vJ1JM\",\"xl-children-margin-r\":\"Row__xl-children-margin-r__EW_z3\",\"xlChildrenMarginR\":\"Row__xl-children-margin-r__EW_z3\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./Row.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\nimport classNames from \"classnames\";\n\nexport const Row = ({\n  children,\n  padding,\n  gap,\n  spaceBetween,\n  breakpointColumn,\n  topMargin,\n  flexClassName,\n  flexBasis,\n  noWrap = false,\n  childrenMarginR,\n  className\n}) => {\n  const paddingClass = padding === true ? styleUtils.lgPadding : styleUtils[`${padding}Padding`];\n  const gapClass = gap === true ? styleUtils.mdGap : styleUtils[`${gap}Gap`];\n  const breakpointColumnClass = breakpointColumn === true ? \"\" : styles[`${breakpointColumn}BreakpointColumn`];\n  const topMarginClass = topMargin ? styleUtils[`${topMargin}WrapMargin`] : \"\";\n  const flexBasisClass = flexBasis ? styleUtils[`flexBasis${flexBasis}`] : \"\";\n  const childrenMarginRClass = childrenMarginR ? styles[`${childrenMarginR}ChildrenMarginR`] : \"\";\n\n  return (\n    <div className={classNames(paddingClass, gapClass, className)}>\n      <div\n        className={classNames(\n          styles.flexRow,\n          breakpointColumnClass,\n          topMarginClass,\n          childrenMarginRClass,\n          {\n            [styles.spaceBetween]: spaceBetween,\n            [styles.noFlexWrap]: noWrap\n          },\n          flexClassName,\n          flexBasisClass\n        )}\n      >\n        {children}\n      </div>\n    </div>\n  );\n};\n\nRow.propTypes = {\n  children: PropTypes.node,\n  padding: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  gap: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  topMargin: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  breakpointColumn: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  childrenMarginR: PropTypes.string,\n  spaceBetween: PropTypes.bool,\n  className: PropTypes.string,\n  flexClassName: PropTypes.string,\n  flexBasis: PropTypes.oneOf([10, 20, 30, 40, 50, 60, 70, 80, 90]),\n  noWrap: PropTypes.bool\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./Divider.scss\";\nimport styleUtils from \"../styles/style-utils.scss\";\nimport classNames from \"classnames\";\n\nexport const Divider = ({ margin = false }) => {\n  const marginClass = margin === false ? \"\" : styleUtils[`${margin}MarginY`];\n  return <div className={classNames(styles.divider, marginClass)} />;\n};\n\nDivider.propTypes = {\n  margin: PropTypes.oneOf([\"xs\", \"sm\", \"md\", \"lg\", \"xl\"])\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"divider\":\"Divider__divider___idW6\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./AudioPopover.scss\";\nimport { ReactComponent as MicrophoneIcon } from \"../icons/Microphone.svg\";\nimport { ReactComponent as MicrophoneMutedIcon } from \"../icons/MicrophoneMuted.svg\";\nimport { ReactComponent as VolumeOff } from \"../icons/VolumeOff.svg\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\nimport { SelectInputField } from \"../input/SelectInputField\";\nimport { Row } from \"../layout/Row\";\nimport { ToggleInput } from \"../input/ToggleInput\";\nimport { Divider } from \"../layout/Divider\";\nimport { Button } from \"../input/Button\";\n\nexport const AudioPopoverContent = ({\n  micLevelBar,\n  speakerLevelBar,\n  microphoneOptions,\n  onChangeMicrophone,\n  isMicrophoneEnabled,\n  isMicrophoneMuted,\n  onChangeMicrophoneMuted,\n  speakerOptions,\n  onChangeSpeaker,\n  onPlaySound,\n  isAudioInputSelectAvailable,\n  isAudioOutputSelectAvailable\n}) => {\n  const iconStyle = isMicrophoneEnabled ? styles.iconEnabled : styles.iconDisabled;\n  return (\n    <Column padding grow gap=\"lg\" className={styles.audioToolbarPopover}>\n      <p style={{ alignSelf: \"start\" }}>\n        <FormattedMessage id=\"mic-setup-modal.microphone-text\" defaultMessage=\"Microphone\" />\n      </p>\n      {isAudioInputSelectAvailable && (\n        <SelectInputField\n          className={styles.selectionInput}\n          buttonClassName={styles.selectionInput}\n          onChange={onChangeMicrophone}\n          {...microphoneOptions}\n        />\n      )}\n      <Row noWrap>\n        {isMicrophoneEnabled && !isMicrophoneMuted ? (\n          <MicrophoneIcon className={iconStyle} style={{ marginRight: \"12px\" }} />\n        ) : (\n          <MicrophoneMutedIcon className={iconStyle} style={{ marginRight: \"12px\" }} />\n        )}\n        <> {micLevelBar}</>\n      </Row>\n      <Row nowrap>\n        <ToggleInput\n          label={<FormattedMessage id=\"mic-setup-modal.mute-mic-toggle-v2\" defaultMessage=\"Mute\" />}\n          checked={isMicrophoneMuted}\n          onChange={onChangeMicrophoneMuted}\n        />\n      </Row>\n      <Divider />\n      <p style={{ alignSelf: \"start\" }}>\n        <FormattedMessage id=\"mic-setup-modal.speakers-text\" defaultMessage=\"Speakers\" />\n      </p>\n      {isAudioOutputSelectAvailable && (\n        <SelectInputField\n          className={styles.selectionInput}\n          buttonClassName={styles.selectionInput}\n          onChange={onChangeSpeaker}\n          {...speakerOptions}\n        />\n      )}\n      <Row noWrap>\n        <VolumeOff className={iconStyle} style={{ marginRight: \"12px\" }} />\n        <> {speakerLevelBar} </>\n      </Row>\n      <Button preset=\"basic\" onClick={onPlaySound} sm>\n        <FormattedMessage id=\"mic-setup-modal.test-audio-button\" defaultMessage=\"Test Audio\" />\n      </Button>\n    </Column>\n  );\n};\n\nAudioPopoverContent.propTypes = {\n  micLevelBar: PropTypes.node,\n  speakerLevelBar: PropTypes.node,\n  isSoundPlaying: PropTypes.bool,\n  onPlaySound: PropTypes.func,\n  isMicrophoneEnabled: PropTypes.bool,\n  isMicrophoneMuted: PropTypes.bool,\n  onChangeMicrophoneMuted: PropTypes.func,\n  microphoneOptions: PropTypes.object,\n  onChangeMicrophone: PropTypes.func,\n  speakerOptions: PropTypes.object,\n  onChangeSpeaker: PropTypes.func,\n  isAudioInputSelectAvailable: PropTypes.bool,\n  isAudioOutputSelectAvailable: PropTypes.bool\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AudioPopoverContent } from \"./AudioPopoverContent\";\nimport { useMicrophone } from \"./useMicrophone\";\nimport { useSpeakers } from \"./useSpeakers\";\nimport { useSound } from \"./useSound\";\nimport { SOUND_SPEAKER_TONE } from \"../../systems/sound-effects-system\";\nimport { useMicrophoneStatus } from \"./useMicrophoneStatus\";\nimport MediaDevicesManager from \"../../utils/media-devices-manager\";\nimport { VolumeLevelBar } from \"../misc/VolumeLevelBar\";\nimport styles from \"./AudioPopover.scss\";\n\nexport const AudioPopoverContentContainer = ({ scene }) => {\n  const { isMicMuted, toggleMute, isMicEnabled } = useMicrophoneStatus(scene);\n  const { micDeviceChanged, micDevices } = useMicrophone(scene);\n  const { speakerDeviceChanged, speakerDevices } = useSpeakers();\n  const { playSound } = useSound({\n    scene,\n    sound: SOUND_SPEAKER_TONE\n  });\n  return (\n    <AudioPopoverContent\n      micLevelBar={<VolumeLevelBar scene={scene} type=\"mic\" className={styles.levelBar} />}\n      speakerLevelBar={<VolumeLevelBar scene={scene} type=\"mixer\" className={styles.levelBar} />}\n      microphoneOptions={micDevices}\n      onChangeMicrophone={micDeviceChanged}\n      isMicrophoneEnabled={isMicEnabled}\n      isMicrophoneMuted={isMicMuted}\n      onChangeMicrophoneMuted={toggleMute}\n      speakerOptions={speakerDevices}\n      onChangeSpeaker={speakerDeviceChanged}\n      onPlaySound={playSound}\n      isAudioInputSelectAvailable={MediaDevicesManager.isAudioInputSelectEnabled}\n      isAudioOutputSelectAvailable={MediaDevicesManager.isAudioOutputSelectEnabled}\n    />\n  );\n};\n\nAudioPopoverContentContainer.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","var _path;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport * as React from \"react\";\n\nconst SvgArrow = _ref => {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 10,\n    viewBox: \"0 0 16 10\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.25 8.375 8 1.625l6.75 6.75\",\n    stroke: \"currentColor\",\n    strokeWidth: 1.5,\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  })));\n};\n\nexport { SvgArrow as ReactComponent };","import React, { useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./AudioPopover.scss\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ArrowIcon } from \"../icons/Arrow.svg\";\nimport { defineMessage, useIntl } from \"react-intl\";\n\nconst invitePopoverTitle = defineMessage({\n  id: \"audio-toolbar-popover.title\",\n  defaultMessage: \"Audio Settings\"\n});\n\nexport const AudioPopoverButton = ({ initiallyVisible, content, micButton }) => {\n  const intl = useIntl();\n  const title = intl.formatMessage(invitePopoverTitle);\n  const popoverApiRef = useRef();\n\n  return (\n    <Popover\n      title={title}\n      content={content}\n      placement=\"top-start\"\n      offsetDistance={28}\n      initiallyVisible={initiallyVisible}\n      popoverApiRef={popoverApiRef}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <div className={styles.buttonsContainer}>\n          <ToolbarButton\n            ref={triggerRef}\n            icon={<ArrowIcon />}\n            preset=\"basic\"\n            selected={popoverVisible}\n            onClick={togglePopover}\n            type={\"left\"}\n            className={popoverVisible ? styles.arrowButton : styles.arrowButtonSelected}\n            title={\"Audio Settings\"}\n          />\n          {micButton}\n        </div>\n      )}\n    </Popover>\n  );\n};\n\nAudioPopoverButton.propTypes = {\n  initiallyVisible: PropTypes.bool,\n  content: PropTypes.element,\n  micButton: PropTypes.element\n};\n","import React, { useCallback, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { useVolumeMeter } from \"../misc/useVolumeMeter\";\n\nexport function ToolbarMicButton({ scene, ...rest }) {\n  const ref = useRef();\n  const setRef = node => {\n    if (node) {\n      ref.current = node.querySelector(\"rect\");\n    }\n  };\n  const update = useCallback(level => {\n    const rect = ref.current;\n    if (rect) {\n      if (level <= 0.1) {\n        rect.setAttribute(\"height\", 0);\n      } else if (level < 0.3) {\n        rect.setAttribute(\"y\", 8);\n        rect.setAttribute(\"height\", 4);\n      } else {\n        rect.setAttribute(\"y\", 4);\n        rect.setAttribute(\"height\", 8);\n      }\n    }\n  }, []);\n  useVolumeMeter({\n    analyser: scene.systems[\"hubs-systems\"].audioSystem.outboundAnalyser,\n    update\n  });\n  return (\n    <ToolbarButton\n      ref={setRef}\n      label={<FormattedMessage id=\"voice-button-container.label\" defaultMessage=\"Voice\" />}\n      preset=\"basic\"\n      type={\"right\"}\n      {...rest}\n    />\n  );\n}\n\nToolbarMicButton.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AudioPopoverButton } from \"./AudioPopoverButton\";\nimport { useMicrophoneStatus } from \"./useMicrophoneStatus\";\nimport { ToolbarMicButton } from \"../input/ToolbarMicButton\";\nimport { ReactComponent as MicrophoneIcon } from \"../icons/Microphone.svg\";\nimport { ReactComponent as MicrophoneMutedIcon } from \"../icons/MicrophoneMuted.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport const AudioPopoverButtonContainer = ({ scene, initiallyVisible, content }) => {\n  const { isMicMuted, toggleMute, isMicEnabled } = useMicrophoneStatus(scene);\n  return (\n    <AudioPopoverButton\n      initiallyVisible={initiallyVisible}\n      content={content}\n      micButton={\n        <ToolbarMicButton\n          scene={scene}\n          icon={isMicMuted || !isMicEnabled ? <MicrophoneMutedIcon /> : <MicrophoneIcon />}\n          label={<FormattedMessage id=\"voice-button-container.label\" defaultMessage=\"Voice\" />}\n          preset=\"basic\"\n          onClick={toggleMute}\n          statusColor={isMicMuted || !isMicEnabled ? \"disabled\" : \"enabled\"}\n          type={\"right\"}\n        />\n      }\n      onChangeMicrophoneMuted={toggleMute}\n    />\n  );\n};\n\nAudioPopoverButtonContainer.propTypes = {\n  scene: PropTypes.object.isRequired,\n  initiallyVisible: PropTypes.bool,\n  content: PropTypes.element\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AudioPopoverContentContainer } from \"./AudioPopoverContentContainer\";\nimport { AudioPopoverButtonContainer } from \"./AudioPopoverButtonContainer\";\n\nexport const AudioPopoverContainer = ({ scene }) => {\n  return <AudioPopoverButtonContainer scene={scene} content={<AudioPopoverContentContainer scene={scene} />} />;\n};\n\nAudioPopoverContainer.propTypes = {\n  scene: PropTypes.object.isRequired\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./ImageGridPopover.scss\";\n\nexport function ImageGridPopover({ fullscreen, items, closePopover }) {\n  return (\n    <div className={classNames(styles.imageGridPopover, { [styles.fullscreen]: fullscreen })}>\n      {items.map(item => {\n        return (\n          <img\n            key={item.id}\n            // crossOrigin: \"anonymous\" is a workaround for CORS error on Chrome. See #4400\n            crossOrigin=\"anonymous\"\n            src={item.src}\n            alt={item.label}\n            onClick={() => {\n              if (item.onSelect) {\n                item.onSelect(item);\n              }\n\n              closePopover();\n            }}\n          />\n        );\n      })}\n    </div>\n  );\n}\n\nImageGridPopover.propTypes = {\n  fullscreen: PropTypes.bool,\n  items: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      src: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n      onSelect: PropTypes.func\n    })\n  ).isRequired,\n  closePopover: PropTypes.func.isRequired\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"image-grid-popover\":\"ImageGridPopover__image-grid-popover__vLSbg\",\"imageGridPopover\":\"ImageGridPopover__image-grid-popover__vLSbg\",\"fullscreen\":\"ImageGridPopover__fullscreen__XUMU4\"};","import React from \"react\";\nimport className from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./ReactionButton.scss\";\nimport { ReactComponent as HandRaisedIcon } from \"../icons/HandRaised.svg\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function ReactionButton({ active, children, ...props }) {\n  return (\n    <button className={className(styles.reactionButton, { [styles.active]: active })} {...props}>\n      {children}\n    </button>\n  );\n}\n\nReactionButton.propTypes = {\n  children: PropTypes.node,\n  active: PropTypes.bool\n};\n\nexport function HandRaisedButton({ active, ...props }) {\n  return (\n    <ReactionButton active={active} {...props}>\n      <HandRaisedIcon width=\"42px\" height=\"42px\" />\n      <p>\n        {active ? (\n          <FormattedMessage id=\"reaction-popover.lower-hand\" defaultMessage=\"Lower Hand\" />\n        ) : (\n          <FormattedMessage id=\"reaction-popover.raise-hand\" defaultMessage=\"Raise Hand\" />\n        )}\n      </p>\n    </ReactionButton>\n  );\n}\n\nHandRaisedButton.propTypes = {\n  active: PropTypes.bool\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"reaction-button\":\"ReactionButton__reaction-button__vpr7k\",\"reactionButton\":\"ReactionButton__reaction-button__vpr7k\",\"active\":\"ReactionButton__active__EANmD\"};","import React, { useCallback, useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { ImageGridPopover } from \"../popover/ImageGridPopover\";\nimport { Popover } from \"../popover/Popover\";\nimport { ToolbarButton } from \"../input/ToolbarButton\";\nimport { ReactComponent as ReactionIcon } from \"../icons/Reaction.svg\";\nimport { ReactComponent as HandRaisedIcon } from \"../icons/HandRaised.svg\";\nimport { defineMessage, FormattedMessage, useIntl } from \"react-intl\";\nimport { Column } from \"../layout/Column\";\nimport { Row } from \"../layout/Row\";\nimport { HandRaisedButton } from \"./ReactionButton\";\nimport styles from \"./ReactionPopover.scss\";\nimport { Button } from \"../input/Button\";\n\nconst reactionPopoverTitle = defineMessage({\n  id: \"reaction-popover.title\",\n  defaultMessage: \"React\"\n});\n\nfunction ReactionPopoverContent({ items, presence, onToggleHandRaised, ...rest }) {\n  return (\n    <Column padding=\"sm\" grow gap=\"sm\">\n      <Row noWrap>\n        <ImageGridPopover items={items} {...rest} />\n      </Row>\n      <Row>\n        <label className={styles.label}>\n          <FormattedMessage id=\"reaction-popover.action\" defaultMessage=\"Actions\" />\n        </label>\n      </Row>\n      <Row nowrap>\n        <HandRaisedButton active={presence.hand_raised} onClick={onToggleHandRaised} />\n      </Row>\n    </Column>\n  );\n}\n\nReactionPopoverContent.propTypes = {\n  items: PropTypes.array.isRequired,\n  presence: PropTypes.object,\n  onToggleHandRaised: PropTypes.func\n};\n\nfunction TooltipPopoverContent({ onToggleHandRaised }) {\n  return (\n    <Row nowrap className={styles.popover}>\n      <Column padding=\"xs\" grow gap=\"xs\">\n        <FormattedMessage id=\"reaction-popover.hand-raised-warning\" defaultMessage=\"Your hand is raised\" />\n      </Column>\n      <Column padding=\"xs\" grow gap=\"xs\">\n        <Button sm thin preset={\"primary\"} onClick={onToggleHandRaised}>\n          <FormattedMessage id=\"reaction-popover.lower-hand\" defaultMessage=\"Lower Hand\" />\n        </Button>\n      </Column>\n    </Row>\n  );\n}\n\nTooltipPopoverContent.propTypes = {\n  onToggleHandRaised: PropTypes.func\n};\n\nexport function ReactionPopoverButton({ items, presence, onToggleHandRaised }) {\n  const [isReactionsVisible, setIsReactionsVisible] = useState(false);\n  const [isTooltipVisible, setIsTooltipVisible] = useState(false);\n  const intl = useIntl();\n  const title = intl.formatMessage(reactionPopoverTitle);\n  const popoverApiRef = useRef();\n\n  const onTooltipHandLowered = useCallback(\n    () => {\n      setIsTooltipVisible(false);\n      onToggleHandRaised();\n    },\n    [onToggleHandRaised]\n  );\n\n  return (\n    <Popover\n      title={title}\n      content={props => {\n        return isTooltipVisible ? (\n          <TooltipPopoverContent onToggleHandRaised={onTooltipHandLowered} />\n        ) : (\n          <ReactionPopoverContent\n            items={items}\n            presence={presence}\n            onToggleHandRaised={onToggleHandRaised}\n            {...props}\n          />\n        );\n      }}\n      placement=\"top\"\n      offsetDistance={28}\n      popoverApiRef={popoverApiRef}\n      showHeader={!isTooltipVisible}\n      isVisible={isReactionsVisible || isTooltipVisible}\n      onChangeVisible={visible => {\n        if (!visible) {\n          setIsReactionsVisible(false);\n          setIsTooltipVisible(presence.hand_raised);\n        }\n      }}\n      disableFullscreen={isTooltipVisible}\n    >\n      {({ togglePopover, popoverVisible, triggerRef }) => (\n        <ToolbarButton\n          ref={triggerRef}\n          icon={\n            presence.hand_raised ? (\n              <HandRaisedIcon width=\"32px\" height=\"32px\" style={{ marginLeft: \"5px\" }} />\n            ) : (\n              <ReactionIcon />\n            )\n          }\n          selected={popoverVisible}\n          onClick={() => {\n            setIsReactionsVisible(!isReactionsVisible);\n            if (presence.hand_raised) {\n              setIsTooltipVisible(!isTooltipVisible);\n            } else {\n              setIsTooltipVisible(false);\n              togglePopover();\n            }\n          }}\n          label={title}\n          preset=\"accent2\"\n        />\n      )}\n    </Popover>\n  );\n}\n\nReactionPopoverButton.propTypes = {\n  items: PropTypes.array.isRequired,\n  presence: PropTypes.object,\n  onToggleHandRaised: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"label\":\"ReactionPopover__label__DVF6P\",\"popover\":\"ReactionPopover__popover__Bu0zs\"};","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useState, useEffect } from \"react\";\nimport { ReactionPopoverButton } from \"./ReactionPopover\";\nimport { spawnEmojiInFrontOfUser, emojis } from \"../../components/emoji\";\nimport { defineMessages, useIntl } from \"react-intl\";\n\nconst emojiLabels = defineMessages({\n  smile: { id: \"reaction-popover.emoji-label.smile\", defaultMessage: \"Smile\" },\n  laugh: { id: \"reaction-popover.emoji-label.laugh\", defaultMessage: \"Laugh\" },\n  clap: { id: \"reaction-popover.emoji-label.clap\", defaultMessage: \"Clap\" },\n  heart: { id: \"reaction-popover.emoji-label.heart\", defaultMessage: \"Heart\" },\n  wave: { id: \"reaction-popover.emoji-label.wave\", defaultMessage: \"Wave\" },\n  angry: { id: \"reaction-popover.emoji-label.angry\", defaultMessage: \"Angry\" },\n  cry: { id: \"reaction-popover.emoji-label.cry\", defaultMessage: \"Cry\" }\n});\n\nfunction usePresence(scene, initialPresence) {\n  const [presence, setPresence] = useState(initialPresence);\n\n  const onPresenceUpdate = ({ detail: presence }) => {\n    if (presence.sessionId === NAF.clientId) setPresence(presence);\n  };\n  useEffect(\n    () => {\n      scene.addEventListener(\"presence_updated\", onPresenceUpdate);\n      return () => scene.removeEventListener(\"presence_updated\", onPresenceUpdate);\n    },\n    [scene]\n  );\n\n  return presence;\n}\n\nexport function ReactionPopoverContainer({ scene, initialPresence }) {\n  const intl = useIntl();\n  const presence = usePresence(scene, initialPresence);\n\n  const items = emojis.map(emoji => ({\n    src: emoji.particleEmitterConfig.src,\n    onSelect: spawnEmojiInFrontOfUser,\n    label: intl.formatMessage(emojiLabels[emoji.id]),\n    ...emoji\n  }));\n\n  const onToggleHandRaised = useCallback(\n    () => {\n      if (presence.hand_raised) {\n        window.APP.hubChannel.lowerHand();\n      } else {\n        window.APP.hubChannel.raiseHand();\n      }\n    },\n    [presence]\n  );\n\n  return <ReactionPopoverButton items={items} presence={presence} onToggleHandRaised={onToggleHandRaised} />;\n}\n\nReactionPopoverContainer.propTypes = {\n  scene: PropTypes.object,\n  initialPresence: PropTypes.object\n};\n","import React from \"react\";\nimport { Modal } from \"../modal/Modal\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function SafariMicModal() {\n  return (\n    <Modal title={<FormattedMessage id=\"safari-mic-modal.title\" defaultMessage=\"Microphone Access Required\" />}>\n      <Column center padding>\n        <FormattedMessage\n          id=\"safari-mic-modal.message\"\n          defaultMessage=\"<p>Hubs requires microphone permissions in Safari.</p><p>Please reload and allow microphone access to continue.</p>\"\n          values={{\n            // eslint-disable-next-line react/display-name\n            p: chunks => <p>{chunks}</p>\n          }}\n        />\n        <Button preset=\"accept\" onClick={() => location.reload()}>\n          <FormattedMessage id=\"safari-mic-modal.reload-button\" defaultMessage=\"Reload\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { SignInModal, SignInStep, SubmitEmail, WaitForVerification, SignInComplete } from \"./SignInModal\";\nimport { TERMS, PRIVACY } from \"../../constants\";\n\n// TODO: Migrate to use AuthContext\nexport function RoomSignInModalContainer({ onClose, step, onSubmitEmail, message, onContinue }) {\n  const [cachedEmail, setCachedEmail] = useState();\n\n  return (\n    <SignInModal onClose={onClose} closeable>\n      {step === SignInStep.submit && (\n        <SubmitEmail\n          onSubmitEmail={email => {\n            setCachedEmail(email);\n            onSubmitEmail(email);\n          }}\n          initialEmail={cachedEmail}\n          termsUrl={configs.link(\"terms_of_use\", TERMS)}\n          showTerms={configs.feature(\"show_terms\")}\n          privacyUrl={configs.link(\"privacy_notice\", PRIVACY)}\n          showPrivacy={configs.feature(\"show_privacy\")}\n          message={message}\n        />\n      )}\n      {step === SignInStep.waitForVerification && (\n        <WaitForVerification\n          onCancel={onClose}\n          email={cachedEmail}\n          showNewsletterSignup={configs.feature(\"show_newsletter_signup\")}\n        />\n      )}\n      {step === SignInStep.complete && <SignInComplete message={message} onContinue={onContinue} />}\n    </SignInModal>\n  );\n}\n\nRoomSignInModalContainer.propTypes = {\n  onClose: PropTypes.func,\n  onSubmitEmail: PropTypes.func,\n  step: PropTypes.string,\n  message: PropTypes.object,\n  onContinue: PropTypes.func\n};\n","  import React from \"react\";\n  import { useIntl, defineMessages, FormattedMessage } from \"react-intl\";\n  import PropTypes, { func } from \"prop-types\";\n  import { Modal } from \"../modal/Modal\";\n  import { CloseButton } from \"../input/CloseButton\";\n  import { Button } from \"../input/Button\";\n  import { Column } from \"../layout/Column\";\n\n  export const LeaveReason = {\n    leaveRoom: \"leaveRoom\",\n    joinRoom: \"joinRoom\",\n    createRoom: \"createRoom\"\n  };\n\n  const reasonMessages = defineMessages({\n    [LeaveReason.leaveRoom]: {\n      id: \"leave-room-modal.leave-room.message\",\n      defaultMessage: \"Are you sure you want to leave the room?\"\n    },\n    [LeaveReason.joinRoom]: {\n      id: \"leave-room-modal.join-room.message\",\n      defaultMessage: \"Joining a new room will leave this one. Are you sure?\"\n    },\n    [LeaveReason.createRoom]: {\n      id: \"leave-room-modal.create-room.message\",\n      defaultMessage: \"Creating a new room will leave this one. Are you sure?\"\n    }\n  });\n\n  const confirmationMessages = defineMessages({\n    [LeaveReason.leaveRoom]: {\n      id: \"leave-room-modal.leave-room.confirm\",\n      defaultMessage: \"Leave Room\"\n    },\n    [LeaveReason.joinRoom]: {\n      id: \"leave-room-modal.join-room.confirm\",\n      defaultMessage: \"Join Room\"\n    },\n    [LeaveReason.createRoom]: {\n      id: \"leave-room-modal.create-room.confirm\",\n      defaultMessage: \"Leave and Create Room\"\n    }\n  });\n\n  export function LeaveRoomModal({ reason, destinationUrl, onClose }) {\n    console.log(destinationUrl);\n    const intl = useIntl();\n\n    return (   \n      <Modal\n        title={<FormattedMessage id=\"leave-room-modal.title\" defaultMessage=\"Leave Room\" />}\n        beforeTitle={<CloseButton onClick={onClose} />}\n      >\n        <Column padding center centerMd=\"both\" grow>\n          <p>{intl.formatMessage(reasonMessages[reason])}</p>\n          <Button as=\"a\" preset=\"cancel\" href=\"http://ncomz.com\" rel=\"noopener noreferrer\">\n            {intl.formatMessage(confirmationMessages[reason])}\n          </Button>\n        </Column>\n      </Modal>\n    );\n  }\n\n  LeaveRoomModal.propTypes = {\n    reason: PropTypes.string,\n    destinationUrl: PropTypes.string,\n    onClose: PropTypes.func\n  };","// extracted by mini-css-extract-plugin\nexport default {\"section-title\":\"RoomSidebar__section-title__UFzx_\",\"sectionTitle\":\"RoomSidebar__section-title__UFzx_\",\"scene-screenshot-container\":\"RoomSidebar__scene-screenshot-container__wKUn4\",\"sceneScreenshotContainer\":\"RoomSidebar__scene-screenshot-container__wKUn4\",\"scene-screenshot-image\":\"RoomSidebar__scene-screenshot-image__BRWhJ\",\"sceneScreenshotImage\":\"RoomSidebar__scene-screenshot-image__BRWhJ\",\"scene-info\":\"RoomSidebar__scene-info__S3PYs\",\"sceneInfo\":\"RoomSidebar__scene-info__S3PYs\",\"scene-name\":\"RoomSidebar__scene-name__cvlSk\",\"sceneName\":\"RoomSidebar__scene-name__cvlSk\",\"scene-creator\":\"RoomSidebar__scene-creator__xT9wM\",\"sceneCreator\":\"RoomSidebar__scene-creator__xT9wM\",\"attribution\":\"RoomSidebar__attribution__2GZFa\",\"attribution-name\":\"RoomSidebar__attribution-name__cdndd\",\"attributionName\":\"RoomSidebar__attribution-name__cdndd\",\"attribution-author\":\"RoomSidebar__attribution-author__tlmWS\",\"attributionAuthor\":\"RoomSidebar__attribution-author__tlmWS\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./RoomSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { InputField } from \"../input/InputField\";\nimport { IconButton } from \"../input/IconButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\n\nfunction SceneAttribution({ attribution }) {\n  const intl = useIntl();\n\n  const unknown = intl.formatMessage({ id: \"room-sidebar.unknown\", defaultMessage: \"unknown\" });\n\n  const name = attribution.name || attribution.title || unknown;\n  const author = attribution.author || unknown;\n\n  if (attribution.url) {\n    const source = attribution.url.includes(\"sketchfab.com\") ? \"Sketchfab\" : null;\n\n    return (\n      <li className={styles.attribution}>\n        <div className={styles.attributionName}>\n          <a href={attribution.url} target=\"_blank\" rel=\"noopener noreferrer\">\n            {name}\n          </a>\n        </div>\n        <div className={styles.attributionAuthor}>\n          {source ? (\n            <FormattedMessage\n              id=\"room-sidebar.scene-attribution-with-source\"\n              defaultMessage=\"by {author} on {source}\"\n              values={{\n                author,\n                source\n              }}\n            />\n          ) : (\n            <FormattedMessage\n              id=\"room-sidebar.scene-attribution\"\n              defaultMessage=\"by {author}\"\n              values={{\n                author\n              }}\n            />\n          )}\n        </div>\n      </li>\n    );\n  } else if (attribution.author) {\n    return (\n      <li className={styles.attribution}>\n        <div className={styles.attributionName}>{name}</div>\n        <div className={styles.attributionAuthor}>\n          <FormattedMessage\n            id=\"room-sidebar.scene-attribution\"\n            defaultMessage=\"by {author}\"\n            values={{\n              author\n            }}\n          />\n        </div>\n      </li>\n    );\n  } else {\n    return null;\n  }\n}\n\n// To assist with content control, we avoid displaying scene links to users who are not the scene\n// creator, unless the scene is remixable or promotable.\nfunction allowDisplayOfSceneLink(accountId, scene) {\n  return scene && ((accountId && scene.account_id === accountId) || scene.allow_promotion || scene.allow_remixing);\n}\n\nexport function SceneInfo({ accountId, scene, showAttributions, canChangeScene, onChangeScene }) {\n  const changeSceneButton = canChangeScene && (\n    <Button preset=\"primary\" onClick={onChangeScene}>\n      <FormattedMessage id=\"room-sidebar.scene-info.change-scene-button\" defaultMessage=\"Change Scene\" />\n    </Button>\n  );\n  if (!scene) return changeSceneButton;\n  const showSceneLink = allowDisplayOfSceneLink(accountId, scene);\n  const attributions = (scene.attributions && scene.attributions.content) || [];\n  const creator = scene.attributions && scene.attributions.creator;\n\n  const filteredAttributionElements = attributions\n    .filter(a => a.url || a.author)\n    .map((attribution, i) => <SceneAttribution attribution={attribution} key={i} />);\n\n  return (\n    <>\n      <h2 className={styles.sectionTitle}>\n        <FormattedMessage id=\"room-sidebar.scene-info.title\" defaultMessage=\"Scene\" />\n      </h2>\n      <div className={styles.sceneScreenshotContainer}>\n        {showSceneLink ? (\n          <a href={scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n            <img className={styles.sceneScreenshotImage} src={scene.screenshot_url} />\n          </a>\n        ) : (\n          <img className={styles.sceneScreenshotImage} src={scene.screenshot_url} />\n        )}\n      </div>\n      <div className={styles.sceneInfo}>\n        {showSceneLink ? (\n          <b className={styles.sceneName}>\n            <a href={scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n              {scene.name}\n            </a>\n          </b>\n        ) : (\n          <b className={styles.sceneName}>{scene.name}</b>\n        )}\n        <div className={styles.sceneCreator}>\n          <FormattedMessage\n            id=\"room-sidebar.scene-info.scene-creator\"\n            defaultMessage=\"by {creator}\"\n            values={{ creator }}\n          />\n        </div>\n      </div>\n      {showAttributions &&\n        filteredAttributionElements.length > 0 && (\n          <InputField\n            label={<FormattedMessage id=\"room-sidebar.scene-info.attributions\" defaultMessage=\"Attributions\" />}\n          >\n            <ul className={styles.attributions}>{filteredAttributionElements}</ul>\n          </InputField>\n        )}\n      {changeSceneButton}\n    </>\n  );\n}\n\nexport function RoomSidebar({ room, accountId, onClose, canEdit, onEdit, onChangeScene }) {\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"room-sidebar.title\" defaultMessage=\"Room\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n      afterTitle={\n        canEdit && (\n          <IconButton onClick={onEdit}>\n            <FormattedMessage id=\"room-sidebar.edit-button\" defaultMessage=\"Edit\" />\n          </IconButton>\n        )\n      }\n    >\n      <Column padding>\n        <InputField label={<FormattedMessage id=\"room-sidebar.room-name\" defaultMessage=\"Name\" />}>\n          {room.name}\n        </InputField>\n        {room.description && (\n          <InputField label={<FormattedMessage id=\"room-sidebar.room-description\" defaultMessage=\"Description\" />}>\n            {room.description}\n          </InputField>\n        )}\n        <SceneInfo\n          accountId={accountId}\n          scene={room.scene}\n          showAttributions\n          canChangeScene={canEdit}\n          onChangeScene={onChangeScene}\n        />\n      </Column>\n    </Sidebar>\n  );\n}\n\nRoomSidebar.propTypes = {\n  accountId: PropTypes.string,\n  room: PropTypes.object.isRequired,\n  onClose: PropTypes.func,\n  canEdit: PropTypes.bool,\n  onEdit: PropTypes.func,\n  onChangeScene: PropTypes.func\n};\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { useId } from \"./useId\";\nimport { TextAreaInput } from \"./TextAreaInput\";\n\nexport const TextAreaInputField = memo(\n  forwardRef(({ className, error, description, inputClassName, label, fullWidth, ...rest }, ref) => {\n    const id = useId();\n    const labelId = useId();\n\n    return (\n      <InputField\n        id={labelId}\n        htmlFor={id}\n        className={className}\n        label={label}\n        error={error}\n        description={description}\n        fullWidth={fullWidth}\n      >\n        <TextAreaInput id={id} ref={ref} className={inputClassName} {...rest} />\n      </InputField>\n    );\n  })\n);\n\nTextAreaInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  fullWidth: PropTypes.bool\n};\n","import React, { forwardRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./RadioInput.scss\";\n\nexport function RadioInputContainer({ className, children, ...rest }) {\n  return (\n    <div className={classNames(styles.radioInput, className)} {...rest}>\n      {children}\n    </div>\n  );\n}\n\nRadioInputContainer.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node\n};\n\nexport const RadioInputOption = forwardRef(({ label, description, className, labelClassName, ...rest }, ref) => (\n  <label className={classNames(styles.option, className)}>\n    <input className={styles.input} type=\"radio\" ref={ref} {...rest} />\n    <div className={classNames(styles.content, labelClassName)}>\n      <span className={styles.label}>{label}</span>\n      {description && <span className={styles.description}>{description}</span>}\n    </div>\n  </label>\n));\n\nRadioInputOption.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node.isRequired,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"radio-input\":\"RadioInput__radio-input__mNUNn\",\"radioInput\":\"RadioInput__radio-input__mNUNn\",\"option\":\"RadioInput__option__MLMdX\",\"input\":\"RadioInput__input__Ehhbt\",\"content\":\"RadioInput__content__gNy40\",\"label\":\"RadioInput__label__63PKv\",\"description\":\"RadioInput__description__NxZVE\"};","import React, { memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { RadioInputContainer, RadioInputOption as _RadioInputOption } from \"./RadioInput\";\n\nexport const RadioInputField = memo(\n  ({ className, error, description, inputClassName, label, children, fullWidth, ...rest }) => {\n    return (\n      <InputField className={className} label={label} error={error} description={description} fullWidth={fullWidth}>\n        <RadioInputContainer className={inputClassName} {...rest}>\n          {children}\n        </RadioInputContainer>\n      </InputField>\n    );\n  }\n);\n\nRadioInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  children: PropTypes.node,\n  fullWidth: PropTypes.bool\n};\n\nexport const RadioInputOption = _RadioInputOption;\n","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./NumericInput.scss\";\nimport { TextInput } from \"./TextInput\";\n\nexport const NumericInput = memo(\n  forwardRef(({ className, afterInput, ...rest }, ref) => {\n    return (\n      <TextInput\n        inputMode=\"numeric\"\n        {...rest}\n        type=\"number\"\n        className={classNames(styles.numericInput, className)}\n        ref={ref}\n        afterInput={afterInput}\n      />\n    );\n  })\n);\n\nNumericInput.propTypes = {\n  afterInput: PropTypes.node,\n  className: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"numeric-input\":\"NumericInput__numeric-input__wvn7B\",\"numericInput\":\"NumericInput__numeric-input__wvn7B\"};","import React, { forwardRef, memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { InputField } from \"./InputField\";\nimport { useId } from \"./useId\";\nimport { NumericInput } from \"./NumericInput\";\n\nexport const NumericInputField = memo(\n  forwardRef(({ className, error, description, inputClassName, label, fullWidth, ...rest }, ref) => {\n    const id = useId();\n    const labelId = useId();\n\n    return (\n      <InputField\n        id={labelId}\n        htmlFor={id}\n        className={className}\n        label={label}\n        error={error}\n        description={description}\n        fullWidth={fullWidth}\n      >\n        <NumericInput id={id} ref={ref} className={inputClassName} {...rest} />\n      </InputField>\n    );\n  })\n);\n\nNumericInputField.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.node,\n  error: PropTypes.node,\n  description: PropTypes.node,\n  labelClassName: PropTypes.string,\n  inputClassName: PropTypes.string,\n  fullWidth: PropTypes.bool\n};\n","import React, { useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useForm } from \"react-hook-form\";\nimport styles from \"./RoomSettingsSidebar.scss\";\nimport { Sidebar } from \"../sidebar/Sidebar\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { InputField } from \"../input/InputField\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { ApplyButton } from \"../input/Button\";\nimport { TextInputField } from \"../input/TextInputField\";\nimport { TextAreaInputField } from \"../input/TextAreaInputField\";\nimport { ToggleInput } from \"../input/ToggleInput\";\nimport { RadioInputField, RadioInputOption } from \"../input/RadioInputField\";\nimport { NumericInputField } from \"../input/NumericInputField\";\nimport { BackButton } from \"../input/BackButton\";\nimport { SceneInfo } from \"./RoomSidebar\";\nimport { Column } from \"../layout/Column\";\nimport { InviteLinkInputField } from \"./InviteLinkInputField\";\n\nexport function RoomSettingsSidebar({\n  showBackButton,\n  accountId,\n  room,\n  fetchingInvite,\n  inviteUrl,\n  onRevokeInvite,\n  maxRoomSize,\n  showPublicRoomSetting,\n  onSubmit,\n  onClose,\n  canChangeScene,\n  onChangeScene\n}) {\n  const intl = useIntl();\n  const { handleSubmit, register, watch, errors, setValue } = useForm({\n    defaultValues: room\n  });\n\n  const entryMode = watch(\"entry_mode\");\n  const spawnAndMoveMedia = watch(\"member_permissions.spawn_and_move_media\");\n\n  useEffect(\n    () => {\n      if (!spawnAndMoveMedia) {\n        setValue(\"member_permissions.spawn_camera\", false, { shouldDirty: true });\n        setValue(\"member_permissions.pin_objects\", false, { shouldDirty: true });\n      }\n    },\n    [spawnAndMoveMedia, setValue]\n  );\n\n  return (\n    <Sidebar\n      title={<FormattedMessage id=\"room-settings-sidebar.title\" defaultMessage=\"Room Settings\" />}\n      beforeTitle={showBackButton ? <BackButton onClick={onClose} /> : <CloseButton onClick={onClose} />}\n    >\n      <Column padding as=\"form\" onSubmit={handleSubmit(onSubmit)}>\n        <SceneInfo\n          accountId={accountId}\n          scene={room.scene}\n          canChangeScene={canChangeScene}\n          onChangeScene={onChangeScene}\n        />\n        <TextInputField\n          name=\"name\"\n          type=\"text\"\n          required\n          autoComplete=\"off\"\n          placeholder={intl.formatMessage({\n            id: \"room-settings-sidebar.name-placeholder\",\n            defaultMessage: \"Room name\"\n          })}\n          minLength={1}\n          maxLength={64}\n          label={<FormattedMessage id=\"room-settings-sidebar.name\" defaultMessage=\"Room Name\" />}\n          ref={register}\n          error={errors.name}\n          fullWidth\n        />\n        <TextAreaInputField\n          name=\"description\"\n          autoComplete=\"off\"\n          placeholder={intl.formatMessage({\n            id: \"room-settings-sidebar.description-placeholder\",\n            defaultMessage: \"Room Description\"\n          })}\n          label={<FormattedMessage id=\"room-settings-sidebar.description\" defaultMessage=\"Room Description\" />}\n          minRows={3}\n          ref={register}\n          error={errors.description}\n          fullWidth\n        />\n        <NumericInputField\n          name=\"room_size\"\n          required\n          min={0}\n          max={maxRoomSize}\n          placeholder={intl.formatMessage({\n            id: \"room-settings-sidebar.room-size-placeholder\",\n            defaultMessage: \"Member Limit\"\n          })}\n          label={<FormattedMessage id=\"room-settings-sidebar.room-size\" defaultMessage=\"Room Size\" />}\n          ref={register}\n          error={errors.room_size}\n          fullWidth\n        />\n        <RadioInputField\n          label={<FormattedMessage id=\"room-settings-sidebar.room-access\" defaultMessage=\"Room Access\" />}\n          fullWidth\n        >\n          <RadioInputOption\n            name=\"entry_mode\"\n            value=\"allow\"\n            label={<FormattedMessage id=\"room-settings-sidebar.access-shared-link\" defaultMessage=\"Shared link\" />}\n            description={\n              <FormattedMessage\n                id=\"room-settings-sidebar.access-shared-link-description\"\n                defaultMessage=\"Only those with the link can join\"\n              />\n            }\n            ref={register}\n            error={errors.entry_mode}\n          />\n          <RadioInputOption\n            name=\"entry_mode\"\n            value=\"invite\"\n            label={<FormattedMessage id=\"room-settings-sidebar.access-invite\" defaultMessage=\"Invite only\" />}\n            description={\n              <FormattedMessage\n                id=\"room-settings-sidebar.access-invite-description\"\n                defaultMessage=\"Invite people with a link that can be revoked\"\n              />\n            }\n            ref={register}\n            error={errors.entry_mode}\n          />\n        </RadioInputField>\n        {entryMode === \"invite\" && (\n          <InviteLinkInputField fetchingInvite={fetchingInvite} inviteUrl={inviteUrl} onRevokeInvite={onRevokeInvite} />\n        )}\n        {showPublicRoomSetting && (\n          <ToggleInput\n            name=\"allow_promotion\"\n            label={<FormattedMessage id=\"room-settings-sidebar.access-public\" defaultMessage=\"Public\" />}\n            description={\n              <FormattedMessage\n                id=\"room-settings-sidebar.access-public-description\"\n                defaultMessage=\"Listed on the homepage\"\n              />\n            }\n            ref={register}\n          />\n        )}\n        <InputField\n          label={<FormattedMessage id=\"room-settings-sidebar.permissions\" defaultMessage=\"Room Member Permissions\" />}\n          fullWidth\n        >\n          <div className={styles.roomPermissions}>\n            <ToggleInput\n              name=\"member_permissions.spawn_and_move_media\"\n              label={\n                <FormattedMessage\n                  id=\"room-settings-sidebar.spawn-and-move-media\"\n                  defaultMessage=\"Create and move objects\"\n                />\n              }\n              ref={register}\n            />\n            <div className={styles.permissionsGroup}>\n              <ToggleInput\n                name=\"member_permissions.spawn_camera\"\n                label={<FormattedMessage id=\"room-settings-sidebar.spawn-camera\" defaultMessage=\"Create cameras\" />}\n                ref={register}\n                disabled={!spawnAndMoveMedia}\n              />\n              <ToggleInput\n                name=\"member_permissions.pin_objects\"\n                label={<FormattedMessage id=\"room-settings-sidebar.pin-objects\" defaultMessage=\"Pin objects\" />}\n                ref={register}\n                disabled={!spawnAndMoveMedia}\n              />\n            </div>\n            <ToggleInput\n              name=\"member_permissions.spawn_drawing\"\n              label={<FormattedMessage id=\"room-settings-sidebar.spawn-drawing\" defaultMessage=\"Create drawings\" />}\n              ref={register}\n            />\n            <ToggleInput\n              name=\"member_permissions.spawn_emoji\"\n              label={<FormattedMessage id=\"room-settings-sidebar.spawn-emoji\" defaultMessage=\"Create emoji\" />}\n              ref={register}\n            />\n            <ToggleInput\n              name=\"member_permissions.fly\"\n              label={<FormattedMessage id=\"room-settings-sidebar.fly\" defaultMessage=\"Allow flying\" />}\n              ref={register}\n            />\n          </div>\n        </InputField>\n        <ApplyButton type=\"submit\" />\n      </Column>\n    </Sidebar>\n  );\n}\n\nRoomSettingsSidebar.propTypes = {\n  accountId: PropTypes.string,\n  showBackButton: PropTypes.bool,\n  room: PropTypes.object.isRequired,\n  fetchingInvite: PropTypes.bool,\n  inviteUrl: PropTypes.string,\n  onRevokeInvite: PropTypes.func,\n  roomSize: PropTypes.number,\n  maxRoomSize: PropTypes.number,\n  showPublicRoomSetting: PropTypes.bool,\n  onSubmit: PropTypes.func,\n  onClose: PropTypes.func,\n  canChangeScene: PropTypes.bool,\n  onChangeScene: PropTypes.func\n};\n","import React, { useCallback } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { RoomSettingsSidebar } from \"./RoomSettingsSidebar\";\nimport configs from \"../../utils/configs\";\nimport { useInviteUrl } from \"./useInviteUrl\";\n\nexport function RoomSettingsSidebarContainer({ showBackButton, room, hubChannel, onChangeScene, onClose }) {\n  const maxRoomSize = configs.feature(\"max_room_size\");\n\n  const { fetchingInvite, inviteUrl, revokeInvite } = useInviteUrl(hubChannel);\n\n  const applyChanges = useCallback(\n    settings => {\n      hubChannel.updateHub(settings);\n      onClose();\n    },\n    [hubChannel, onClose]\n  );\n\n  return (\n    <RoomSettingsSidebar\n      showBackButton={showBackButton}\n      room={room}\n      fetchingInvite={fetchingInvite}\n      inviteUrl={inviteUrl}\n      onRevokeInvite={revokeInvite}\n      maxRoomSize={maxRoomSize}\n      showPublicRoomSetting={hubChannel.can(\"update_hub_promotion\")}\n      onSubmit={applyChanges}\n      canChangeScene\n      onChangeScene={onChangeScene}\n      onClose={onClose}\n    />\n  );\n}\n\nRoomSettingsSidebarContainer.propTypes = {\n  showBackButton: PropTypes.bool,\n  room: PropTypes.object.isRequired,\n  hubChannel: PropTypes.object.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onChangeScene: PropTypes.func\n};\n","import React from \"react\";\nimport { FormattedMessage, defineMessages, useIntl } from \"react-intl\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CancelButton } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\n\nexport const AutoExitReason = {\n  concurrentSession: \"concurrentSession\",\n  idle: \"idle\"\n};\n\nconst messages = defineMessages({\n  [AutoExitReason.concurrentSession]: {\n    id: \"auto-exit-warning-modal.reason.concurrent-session\",\n    defaultMessage: \"You have started another session.\"\n  },\n  [AutoExitReason.idle]: {\n    id: \"auto-exit-warning-modal.reason.idle\",\n    defaultMessage: \"You have been idle for too long.\"\n  }\n});\n\nexport function AutoExitWarningModal({ onCancel, reason, secondsRemaining }) {\n  const intl = useIntl();\n\n  return (\n    <Modal title=\"Warning\">\n      <Column padding center>\n        <b>\n          <FormattedMessage\n            id=\"auto-exit-warning-modal.message\"\n            defaultMessage=\"Auto-ending session in {secondsRemaining} seconds\"\n            values={{ secondsRemaining }}\n          />\n        </b>\n        <p>{intl.formatMessage(messages[reason])}</p>\n        <CancelButton onClick={onCancel} />\n      </Column>\n    </Modal>\n  );\n}\n\nAutoExitWarningModal.propTypes = {\n  reason: PropTypes.string.isRequired,\n  secondsRemaining: PropTypes.number.isRequired,\n  onCancel: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { defineMessages, FormattedMessage, useIntl } from \"react-intl\";\nimport { LoadingScreenLayout } from \"../layout/LoadingScreenLayout\";\nimport { Button } from \"../input/Button\";\n\nexport const ExitReason = {\n  exited: \"exited\",\n  closed: \"closed\",\n  denied: \"denied\",\n  disconnected: \"disconnected\",\n  left: \"left\",\n  full: \"full\",\n  sceneError: \"sceneError\",\n  connectError: \"connectError\",\n  versionMismatch: \"versionMismatch\"\n};\n\nconst messages = defineMessages({\n  [ExitReason.exited]: {\n    id: \"exited-room-screen.reason.exited\",\n    defaultMessage: \"Your session has ended. Refresh your browser to start a new one.\"\n  },\n  [ExitReason.closed]: {\n    id: \"exited-room-screen.reason.closed\",\n    defaultMessage: \"This room is no longer available.\"\n  },\n  [ExitReason.denied]: {\n    id: \"exited-room-screen.reason.denied\",\n    defaultMessage: \"You are not permitted to join this room. Please request permission from the room creator.\"\n  },\n  [ExitReason.disconnected]: {\n    id: \"exited-room-screen.reason.disconnected\",\n    defaultMessage: \"You have disconnected from the room. Refresh the page to try to reconnect.\"\n  },\n  [ExitReason.left]: {\n    id: \"exited-room-screen.reason.left\",\n    defaultMessage: \"You have left the room.\"\n  },\n  [ExitReason.full]: {\n    id: \"exited-room-screen.reason.full\",\n    defaultMessage: \"This room is full, please try again later.\"\n  },\n  [ExitReason.sceneError]: {\n    id: \"exited-room-screen.reason.scene-error\",\n    defaultMessage: \"The scene failed to load.\"\n  },\n  [ExitReason.connectError]: {\n    id: \"exited-room-screen.reason.connect-error\",\n    defaultMessage: \"Unable to connect to this room, please try again later.\"\n  },\n  [ExitReason.versionMismatch]: {\n    id: \"exited-room-screen.reason.version-mismatch\",\n    defaultMessage: \"The version you deployed is not available yet. Your browser will refresh in 5 seconds.\"\n  }\n});\n\nexport function ExitedRoomScreen({ reason, showTerms, termsUrl, showSourceLink }) {\n  const intl = useIntl();\n\n  let subtitle = null;\n  if (reason === ExitReason.closed) {\n    const contactEmail = intl.formatMessage({ id: \"contact-email\" });\n\n    subtitle = (\n      <>\n        <b>\n          <FormattedMessage\n            id=\"exited-room-screen.no-longer-available\"\n            defaultMessage=\"Sorry, this room is no longer available.\"\n          />\n        </b>\n        {showTerms && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.closed-room-tos\"\n              defaultMessage=\"A room may be closed by the room owner, or if we receive reports that it violates our <toslink>Terms of Use</toslink>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                toslink: chunks => (\n                  <a target=\"_blank\" rel=\"noreferrer noopener\" href={termsUrl}>\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          </p>\n        )}\n        <p>\n          <FormattedMessage\n            id=\"exited-room-screen.contact-us\"\n            defaultMessage=\"If you have questions, contact us at {contactEmail}.\"\n            values={{ contactEmail: <a href={`mailto:${contactEmail}`}>{contactEmail}</a> }}\n          />\n        </p>\n        {showSourceLink && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.source-link\"\n              defaultMessage=\"If you'd like to run your own server, Hubs's source code is available on <a>GitHub</a>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => <a href=\"https://github.com/mozilla/hubs\">{chunks}</a>\n              }}\n            />\n          </p>\n        )}\n\n        <Button as=\"a\" preset=\"accept\" href=\"/\">\n          <FormattedMessage id=\"exited-room-screen.home-button\" defaultMessage=\"Back to Home\" />\n        </Button>\n      </>\n    );\n  } else {\n    const tcpUrl = new URL(document.location.toString());\n    const tcpParams = new URLSearchParams(tcpUrl.search);\n    tcpParams.set(\"force_tcp\", true);\n    tcpUrl.search = tcpParams.toString();\n\n    subtitle = (\n      <>\n        <b>{intl.formatMessage(messages[reason])}</b>\n\n        {reason === ExitReason.connectError && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.connect-tcp\"\n              defaultMessage=\"You can try <a>connecting via TCP</a>, which may work better on some networks.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => <a href={tcpUrl.toString()}>{chunks}</a>\n              }}\n            />\n          </p>\n        )}\n        {![ExitReason.left, ExitReason.disconnected, ExitReason.sceneError].includes(reason) && (\n          <p>\n            <FormattedMessage\n              id=\"exited-room-screen.create-room\"\n              defaultMessage=\"You can also <a>create a new room</a>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => <a href=\"/\">{chunks}</a>\n              }}\n            />\n          </p>\n        )}\n\n        <Button as=\"a\" preset=\"accept\" href={window.location.href}>\n          <FormattedMessage id=\"exited-room-screen.refresh-page-button\" defaultMessage=\"Refresh Page\" />\n        </Button>\n      </>\n    );\n  }\n\n  return <LoadingScreenLayout center={subtitle} />;\n}\n\nExitedRoomScreen.propTypes = {\n  reason: PropTypes.string.isRequired,\n  showTerms: PropTypes.bool,\n  termsUrl: PropTypes.string,\n  showSourceLink: PropTypes.bool\n};\n\n","import React, { useState, useCallback } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button, CancelButton } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { TextInputField } from \"../input/TextInputField\";\n\nexport function CloseRoomModal({ roomName, onClose, onConfirm }) {\n  const [confirmText, setConfirmText] = useState(\"\");\n  const [showIsNotMatchError, setShowIsNotMatchError] = useState(false);\n\n  const onClickConfirm = useCallback(\n    () => {\n      if (confirmText.toLowerCase() === roomName.toLowerCase()) {\n        onConfirm();\n      } else {\n        setShowIsNotMatchError(true);\n      }\n    },\n    [onConfirm, confirmText, roomName]\n  );\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"close-room-modal.title\" defaultMessage=\"Close Room\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center centerMd=\"both\" grow>\n        <p>\n          <FormattedMessage\n            id=\"close-room-modal.message\"\n            defaultMessage=\"Closing this room will remove yourself and others from the room, shutting it down permanently.{linebreak}Are you sure? This action cannot be undone.\"\n            values={{ linebreak: <br /> }}\n          />\n        </p>\n        <p>\n          <FormattedMessage\n            id=\"close-room-modal.type-to-confirm\"\n            defaultMessage=\"Type room name to confirm: {roomName}\"\n            values={{ roomName: <b>{roomName}</b> }}\n          />\n        </p>\n        <TextInputField\n          label={<FormattedMessage id=\"close-room-modal.confirm-room-name-field\" defaultMessage=\"Confirm Room Name\" />}\n          onChange={e => setConfirmText(e.target.value)}\n          value={confirmText}\n          error={\n            showIsNotMatchError && (\n              <FormattedMessage id=\"close-room-modal.room-name-match-error\" defaultMessage=\"Room name does not match\" />\n            )\n          }\n        />\n        <Button preset=\"accept\" onClick={onClickConfirm}>\n          <FormattedMessage id=\"close-room-modal.confirm\" defaultMessage=\"Yes, Close Room\" />\n        </Button>\n        <CancelButton onClick={onClose} />\n      </Column>\n    </Modal>\n  );\n}\n\nCloseRoomModal.propTypes = {\n  roomName: PropTypes.string,\n  onConfirm: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function WebVRUnsupportedModal({ onClose }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"webvr-unsupported-modal.title\" defaultMessage=\"Enter in VR\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center>\n        <p>\n          <FormattedMessage\n            id=\"webvr-unsupported-modal.message\"\n            defaultMessage=\"WebVR isn't supported in this browser, to enter with Oculus or SteamVR, use Firefox.\"\n          />\n        </p>\n        <Button\n          as=\"a\"\n          preset=\"accent2\"\n          href=\"https://www.mozilla.org/firefox/\"\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n        >\n          <span>\n            <FormattedMessage id=\"webvr-unsupported-modal.download-firefox-button\" defaultMessage=\"Download Firefox\" />\n          </span>\n        </Button>\n        <p>\n          <small>\n            <FormattedMessage\n              id=\"webvr-unsupported-modal.webvr-rocks-link\"\n              defaultMessage=\"For a list of browsers with experimental VR support, visit <a>WebVR Rocks</a>.\"\n              values={{\n                // eslint-disable-next-line react/display-name\n                a: chunks => (\n                  <a href=\"https://webvr.rocks\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {chunks}\n                  </a>\n                )\n              }}\n            />\n          </small>\n        </p>\n      </Column>\n    </Modal>\n  );\n}\n\nWebVRUnsupportedModal.propTypes = {\n  onClose: PropTypes.func\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"media\":\"TweetEditorModal__media__LKb3w\",\"editor\":\"TweetEditorModal__editor__SVwvM\",\"editor-inner\":\"TweetEditorModal__editor-inner__N0yZn\",\"editorInner\":\"TweetEditorModal__editor-inner__N0yZn\",\"emoji-button\":\"TweetEditorModal__emoji-button__sdm3x\",\"emojiButton\":\"TweetEditorModal__emoji-button__sdm3x\",\"counter\":\"TweetEditorModal__counter__KuZoI\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\nimport createEmojiPlugin from \"draft-js-emoji-plugin\";\nimport createHashtagPlugin from \"draft-js-hashtag-plugin\";\nimport createLinkifyPlugin from \"draft-js-linkify-plugin\";\nimport createCounterPlugin from \"draft-js-counter-plugin\";\nimport Editor from \"draft-js-plugins-editor\";\nimport \"draft-js-emoji-plugin/lib/plugin.css\";\nimport \"draft-js-hashtag-plugin/lib/plugin.css\";\nimport \"draft-js-linkify-plugin/lib/plugin.css\";\nimport \"draft-js-counter-plugin/lib/plugin.css\";\nimport styles from \"./TweetEditorModal.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst emojiPlugin = createEmojiPlugin();\nconst hashtagPlugin = createHashtagPlugin();\nconst linkifyPlugin = createLinkifyPlugin();\nconst counterPlugin = createCounterPlugin();\n\nexport function TweetEditorModal({\n  editorState,\n  editorRef,\n  sending,\n  mediaThumbnailUrl,\n  contentSubtype,\n  onClickEditor,\n  onChange,\n  onSend,\n  onClose\n}) {\n  const { EmojiSuggestions, EmojiSelect } = emojiPlugin;\n  const { CharCounter } = counterPlugin;\n\n  const tweetLength = editorState.getCurrentContent().getPlainText().length;\n\n  return (\n    <Modal\n      title={<FormattedMessage id=\"tweet-editor-modal.title\" defaultMessage=\"Tweet\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center>\n        <div className={styles.media}>\n          {contentSubtype && contentSubtype.startsWith(\"video\") ? (\n            <video src={mediaThumbnailUrl} width={450} height={255} controls />\n          ) : (\n            <img src={mediaThumbnailUrl} width={450} height={255} />\n          )}\n        </div>\n        <div className={styles.editor}>\n          <div className={styles.editorInner} onClick={onClickEditor}>\n            <Editor\n              ref={editorRef}\n              editorState={editorState}\n              onChange={onChange}\n              plugins={[emojiPlugin, hashtagPlugin, linkifyPlugin, counterPlugin]}\n            />\n          </div>\n\n          <div className={styles.emojiButton}>\n            <EmojiSelect />\n          </div>\n\n          <div className={styles.emojiSuggestions}>\n            <EmojiSuggestions />\n          </div>\n\n          {tweetLength > 200 && (\n            <div className={styles.counter}>\n              <CharCounter editorState={editorState} limit={280} /> / 280\n            </div>\n          )}\n        </div>\n        <Button preset=\"accent4\" disabled={sending || tweetLength > 280} onClick={onSend}>\n          {sending ? (\n            <FormattedMessage id=\"tweet-editor-modal.sending-tweet\" defaultMessage=\"Sending Tweet...\" />\n          ) : (\n            <FormattedMessage id=\"tweet-editor-modal.tweet-button\" defaultMessage=\"Tweet\" />\n          )}\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nTweetEditorModal.propTypes = {\n  editorRef: PropTypes.any,\n  editorState: PropTypes.object.isRequired,\n  onChange: PropTypes.func,\n  sending: PropTypes.bool,\n  mediaThumbnailUrl: PropTypes.string,\n  contentSubtype: PropTypes.string,\n  onClickEditor: PropTypes.func,\n  onSend: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useRef, useEffect, useState, useCallback, useMemo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { TweetEditorModal } from \"./TweetEditorModal\";\nimport { Modifier, EditorState } from \"draft-js\";\nimport { createEditorStateWithText } from \"draft-js-plugins-editor\";\nimport { fetchReticulumAuthenticated } from \"../../utils/phoenix-utils\";\nimport { scaledThumbnailUrlFor } from \"../../utils/media-url-utils\";\n\n// Taken from draft-js-emoji\nconst addEmoji = (emoji, editorState) => {\n  const contentState = editorState.getCurrentContent();\n  const contentStateWithEntity = contentState.createEntity(\"emoji\", \"IMMUTABLE\", { emojiUnicode: emoji });\n  const entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n  const currentSelectionState = editorState.getSelection();\n\n  let emojiAddedContent;\n  let emojiEndPos = 0;\n  let blockSize = 0;\n\n  // in case text is selected it is removed and then the emoji is added\n  const afterRemovalContentState = Modifier.removeRange(contentState, currentSelectionState, \"backward\");\n\n  // deciding on the position to insert emoji\n  const targetSelection = afterRemovalContentState.getSelectionAfter();\n\n  emojiAddedContent = Modifier.insertText(afterRemovalContentState, targetSelection, emoji, null, entityKey);\n\n  emojiEndPos = targetSelection.getAnchorOffset();\n  const blockKey = targetSelection.getAnchorKey();\n  blockSize = contentState.getBlockForKey(blockKey).getLength();\n\n  // If the emoji is inserted at the end, a space is appended right after for\n  // a smooth writing experience.\n  if (emojiEndPos === blockSize) {\n    emojiAddedContent = Modifier.insertText(emojiAddedContent, emojiAddedContent.getSelectionAfter(), \" \");\n  }\n\n  const newEditorState = EditorState.push(editorState, emojiAddedContent, \"insert-emoji\");\n  return EditorState.forceSelection(newEditorState, emojiAddedContent.getSelectionAfter());\n};\n\nexport function TweetEditorModalContainer({ initialTweet, mediaUrl, contentSubtype, onClose }) {\n  const [editorState, setEditorState] = useState(() => createEditorStateWithText(initialTweet || \"\"));\n  const editorRef = useRef();\n\n  useEffect(() => {\n    // Other attempts at doing this resulted in no visible cursor or weird editor behavior:\n    setEditorState(editorState => addEmoji(\"🐤\", editorState));\n  }, []);\n\n  const [sending, setSending] = useState(false);\n\n  const sendTweet = useCallback(\n    async () => {\n      setSending(true);\n\n      try {\n        const body = editorState.getCurrentContent().getPlainText();\n        // For now assume url is a stored file media url\n        await fetchReticulumAuthenticated(\"/api/v1/twitter/tweets\", \"POST\", { media_stored_file_url: mediaUrl, body });\n      } catch (error) {\n        setSending(false);\n        console.error(error);\n      }\n\n      onClose();\n    },\n    [mediaUrl, editorState, onClose]\n  );\n\n  const mediaThumbnailUrl = useMemo(\n    () => {\n      return contentSubtype && !contentSubtype.startsWith(\"video\")\n        ? scaledThumbnailUrlFor(mediaUrl, 450, 255)\n        : mediaUrl;\n    },\n    [contentSubtype, mediaUrl]\n  );\n\n  return (\n    <TweetEditorModal\n      editorState={editorState}\n      editorRef={editorRef}\n      onClose={onClose}\n      sending={sending}\n      onSend={sendTweet}\n      onChange={setEditorState}\n      mediaThumbnailUrl={mediaThumbnailUrl}\n      contentSubtype={contentSubtype}\n    />\n  );\n}\n\nTweetEditorModalContainer.propTypes = {\n  mediaUrl: PropTypes.string,\n  contentSubtype: PropTypes.string,\n  initialTweet: PropTypes.object.isRequired,\n  onClose: PropTypes.func\n};\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\nimport { Modal } from \"../modal/Modal\";\nimport { CloseButton } from \"../input/CloseButton\";\nimport { Button } from \"../input/Button\";\nimport { Column } from \"../layout/Column\";\n\nexport function TwitterOAuthModal({ appName, onConnect, onClose }) {\n  return (\n    <Modal\n      title={<FormattedMessage id=\"twitter-oauth-modal.title\" defaultMessage=\"Connect to Twitter\" />}\n      beforeTitle={<CloseButton onClick={onClose} />}\n    >\n      <Column padding center centerMd=\"both\" grow>\n        <p>\n          <FormattedMessage\n            id=\"twitter-oauth-modal.message\"\n            defaultMessage=\"Connect to Twitter to send tweets from {appName}.\"\n            values={{ appName }}\n          />\n        </p>\n        <Button preset=\"accent4\" onClick={onConnect}>\n          <FormattedMessage id=\"twitter-oauth-modal.connect-button\" defaultMessage=\"Connect to Twitter\" />\n        </Button>\n      </Column>\n    </Modal>\n  );\n}\n\nTwitterOAuthModal.propTypes = {\n  appName: PropTypes.string.isRequired,\n  onConnect: PropTypes.func,\n  onClose: PropTypes.func\n};\n","import React, { useCallback, useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { TwitterOAuthModal } from \"./TwitterOAuthModal\";\nimport configs from \"../../utils/configs\";\n\nexport function TwitterOAuthModalContainer({ hubChannel, onConnected, onClose, isAdmin }) {\n  const popupRef = useRef();\n\n  const onConnect = useCallback(\n    async () => {\n      try {\n        if (popupRef.current) {\n          popupRef.current.close();\n        }\n\n        const url = await hubChannel.getTwitterOAuthURL();\n\n        const width = 600;\n        const height = 760;\n        const left = (window.innerWidth - width) / 2 + window.screenLeft;\n        const top = (window.innerHeight - height) / 2 + window.screenTop;\n\n        window.doingTwitterOAuth = true;\n\n        const popup = window.open(\n          url,\n          \"_blank\",\n          `resizable=yes,width=${width},height=${height},left=${left},top=${top}toolbar=no,titlebar=no,menubar=no,scrollbars=yes`\n        );\n        popup.focus();\n        popupRef.current = popup;\n      } catch (error) {\n        console.error(error);\n        if (error.message === \"twitter_api_error\" && isAdmin) {\n          console.warn(\n            \"Twitter might be misconfigured for Hubs Cloud. Check the docs here: https://hubs.mozilla.com/docs/hubs-cloud-third-party-integrations.html#twitter\"\n          );\n        }\n        onClose();\n      }\n    },\n    [hubChannel, isAdmin, onClose]\n  );\n\n  useEffect(\n    () => {\n      function onMessage({ data }) {\n        if (data === \"oauth-successful\") {\n          onConnected();\n          popupRef.current = null;\n          delete window.doingTwitterOAuth;\n          window.removeEventListener(\"message\", onMessage);\n        }\n      }\n\n      window.addEventListener(\"message\", onMessage);\n\n      return () => {\n        if (popupRef.current) {\n          popupRef.current.close();\n        }\n\n        delete window.doingTwitterOAuth;\n        window.removeEventListener(\"message\", onMessage);\n      };\n    },\n    [onConnected]\n  );\n\n  return <TwitterOAuthModal appName={configs.translation(\"app-name\")} onConnect={onConnect} onClose={onClose} />;\n}\n\nTwitterOAuthModalContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  onConnected: PropTypes.func.isRequired,\n  onClose: PropTypes.func,\n  isAdmin: PropTypes.bool\n};\n","import React, { useCallback, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { TweetEditorModalContainer } from \"./TweetEditorModalContainer\";\nimport { TwitterOAuthModalContainer } from \"./TwitterOAuthModalContainer\";\nimport configs from \"../../utils/configs\";\n\nexport function TweetModalContainer({ hubChannel, initialTweet, mediaUrl, contentSubtype, onClose, isAdmin }) {\n  const [canTweet, setCanTweet] = useState(hubChannel.can(\"tweet\"));\n\n  const onConnected = useCallback(() => {\n    setCanTweet(true);\n  }, []);\n\n  if (canTweet) {\n    return (\n      <TweetEditorModalContainer\n        initialTweet={initialTweet}\n        mediaUrl={mediaUrl}\n        contentSubtype={contentSubtype}\n        onClose={onClose}\n      />\n    );\n  } else {\n    return (\n      <TwitterOAuthModalContainer\n        appName={configs.translation(\"app-name\")}\n        hubChannel={hubChannel}\n        onConnected={onConnected}\n        onClose={onClose}\n        isAdmin={isAdmin}\n      />\n    );\n  }\n}\n\nTweetModalContainer.propTypes = {\n  hubChannel: PropTypes.object.isRequired,\n  initialTweet: PropTypes.string,\n  mediaUrl: PropTypes.string,\n  contentSubtype: PropTypes.string,\n  onClose: PropTypes.func,\n  isAdmin: PropTypes.bool\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./Tip.scss\";\n\nexport function Tip({ className, children, onDismiss, dismissLabel, ...rest }) {\n  return (\n    <div className={classNames(styles.tip, className)} {...rest}>\n      <div className={styles.content}>{children}</div>\n      {onDismiss && (\n        <button className={styles.dismissButton} onClick={onDismiss}>\n          {dismissLabel}\n        </button>\n      )}\n    </div>\n  );\n}\n\nTip.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node,\n  onDismiss: PropTypes.func,\n  dismissLabel: PropTypes.node\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"tip\":\"Tip__tip__o5Hrk\",\"content\":\"Tip__content__ywfjP\",\"dismiss-button\":\"Tip__dismiss-button__kt5sA\",\"dismissButton\":\"Tip__dismiss-button__kt5sA\"};","import React, { useCallback, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage, useIntl, defineMessages } from \"react-intl\";\nimport { Tip } from \"./Tip\";\nimport { useEffect } from \"react\";\nimport { discordBridgesForPresences, hasEmbedPresences } from \"../../utils/phoenix-utils\";\nimport configs from \"../../utils/configs\";\n\n// These keys are hardcoded in the input system to be based on the physical location on the keyboard rather than character\nlet moveKeys = \"W A S D\";\nlet turnLeftKey = \"Q\";\nlet turnRightKey = \"E\";\n\n// TODO The API to map from physical key to character is experimental. Depending on prospects of this getting wider\n// implimentation we may want to cook up our own polyfill based on observing key inputs\nif (window.navigator.keyboard !== undefined && window.navigator.keyboard.getLayoutMap) {\n  window.navigator.keyboard\n    .getLayoutMap()\n    .then(function(map) {\n      moveKeys = `${map.get(\"KeyW\") || \"W\"} ${map.get(\"KeyA\") || \"A\"} ${map.get(\"KeyS\") || \"S\"} ${map.get(\"KeyD\") ||\n        \"D\"}`.toUpperCase();\n      turnLeftKey = map.get(\"KeyQ\")?.toUpperCase();\n      turnRightKey = map.get(\"KeyE\")?.toUpperCase();\n    })\n    .catch(function(e) {\n      // This occurs on Chrome 93 when the Hubs page is in an iframe\n      console.warn(`Unable to remap keyboard: ${e}`);\n    });\n}\n\nconst onboardingMessages = defineMessages({\n  \"tips.mobile.look\": {\n    id: \"tips.mobile.look\",\n    defaultMessage: \"Welcome! 👋 Tap and drag to look around.\"\n  },\n  \"tips.mobile.locomotion\": {\n    id: \"tips.mobile.locomotion\",\n    defaultMessage: \"Great! To move, pinch with two fingers.\"\n  },\n  \"tips.mobile.invite\": {\n    id: \"tips.mobile.invite\",\n    defaultMessage: \"Use the Invite button in the bottom left to share this room.\"\n  },\n  \"tips.desktop.look\": {\n    id: \"tips.desktop.look\",\n    defaultMessage: \"Welcome to {appName}! Let's take a quick tour. 👋 Click and drag to look around.\"\n  },\n  \"tips.desktop.locomotion\": {\n    id: \"tips.desktop.locomotion\",\n    defaultMessage: \"Use the {moveKeys} keys to move. Hold shift to boost.\"\n  },\n  \"tips.desktop.turning\": {\n    id: \"tips.desktop.turning\",\n    defaultMessage: \"Perfect. Use the {turnLeftKey} and {turnRightKey} keys to rotate.\"\n  },\n  \"tips.desktop.invite\": {\n    id: \"tips.desktop.invite\",\n    defaultMessage: \"Nobody else is here. Use the invite button in the bottom left to share this room.\"\n  }\n});\n\nfunction OkDismissLabel() {\n  return <FormattedMessage id=\"tips.dismiss.ok\" defaultMessage=\"Ok\" />;\n}\n\nfunction SkipDismissLabel() {\n  return <FormattedMessage id=\"tips.dismiss.skip\" defaultMessage=\"Skip\" />;\n}\n\nexport function FullscreenTip(props) {\n  return (\n    <Tip {...props} dismissLabel={<OkDismissLabel />}>\n      <FormattedMessage id=\"tips.fullscreen\" defaultMessage=\"Entered fullscreen mode. Press Escape to show UI.\" />\n    </Tip>\n  );\n}\n\nexport function TipContainer({ hide, inLobby, inRoom, isStreaming, isEmbedded, scene, store, hubId, presences }) {\n  const intl = useIntl();\n  const [lobbyTipDismissed, setLobbyTipDismissed] = useState(false);\n  const [broadcastTipDismissed, setBroadcastTipDismissed] = useState(() =>\n    store.state.confirmedBroadcastedRooms.includes(hubId)\n  );\n  const [streamingTipDismissed, setStreamingTipDismissed] = useState(false);\n  const [embeddedTipDismissed, setEmbeddedTipDismissed] = useState(false);\n  const [onboardingTipId, setOnboardingTipId] = useState(null);\n\n  const onSkipOnboarding = useCallback(\n    () => {\n      scene.systems.tips.skipTips();\n    },\n    [scene]\n  );\n\n  useEffect(\n    () => {\n      function onSceneTipChanged({ detail: tipId }) {\n        setOnboardingTipId(tipId);\n      }\n\n      scene.addEventListener(\"tip-changed\", onSceneTipChanged);\n\n      setOnboardingTipId(scene.systems.tips.activeTip);\n    },\n    [scene]\n  );\n\n  const discordBridges = presences ? discordBridgesForPresences(presences) : [];\n  const isBroadcasting = discordBridges.length > 0;\n\n  // TODO: This only exists because we store local state in this component.\n  // If we move tip state to a context then we can remove this and not render this component at all.\n  if (hide) {\n    return null;\n  }\n\n  if (inLobby) {\n    if (lobbyTipDismissed) {\n      return null;\n    }\n\n    return (\n      <Tip onDismiss={() => setLobbyTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n        <FormattedMessage id=\"tips.lobby\" defaultMessage=\"You're in the lobby. Others cannot see or hear you.\" />\n      </Tip>\n    );\n  } else if (inRoom) {\n    if (onboardingTipId) {\n      return (\n        <Tip onDismiss={onSkipOnboarding} dismissLabel={<SkipDismissLabel />}>\n          {intl.formatMessage(onboardingMessages[onboardingTipId], {\n            appName: configs.translation(\"app-name\"),\n            moveKeys,\n            turnLeftKey,\n            turnRightKey\n          })}\n        </Tip>\n      );\n    }\n\n    if (isStreaming && !streamingTipDismissed) {\n      return (\n        <Tip onDismiss={() => setStreamingTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n          <FormattedMessage\n            id=\"tips.streaming\"\n            defaultMessage=\"Now broadcasting to the lobby. Exit streamer mode in the more menu when you're done.\"\n          />\n        </Tip>\n      );\n    }\n\n    if (isBroadcasting && !broadcastTipDismissed) {\n      return (\n        <Tip onDismiss={() => setBroadcastTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n          <FormattedMessage\n            id=\"tips.discord\"\n            defaultMessage=\"Chat in this room is being bridged to {broadcastTarget} on Discord.\"\n            values={{ broadcastTarget: discordBridges.map(channelName => \"#\" + channelName).join(\", \") }}\n          />\n        </Tip>\n      );\n    }\n\n    if ((isEmbedded || hasEmbedPresences(presences)) && !embeddedTipDismissed) {\n      return (\n        <Tip onDismiss={() => setEmbeddedTipDismissed(true)} dismissLabel={<OkDismissLabel />}>\n          <FormattedMessage\n            id=\"tips.embedded\"\n            defaultMessage=\"This room is embedded, so it may be visible to visitors on other websites.\"\n          />\n        </Tip>\n      );\n    }\n\n    return null;\n  }\n\n  return null;\n}\n\nTipContainer.propTypes = {\n  hide: PropTypes.bool,\n  inLobby: PropTypes.bool,\n  inRoom: PropTypes.bool,\n  isStreaming: PropTypes.bool,\n  isEmbedded: PropTypes.bool,\n  scene: PropTypes.object.isRequired,\n  store: PropTypes.object.isRequired,\n  hubId: PropTypes.string,\n  presences: PropTypes.object\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./SpectatingLabel.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport function SpectatingLabel({ name }) {\n  return (\n    <div className={styles.label}>\n      <b>\n        <FormattedMessage id=\"spectating-label.label\" defaultMessage=\"Spectating\" />\n      </b>\n      <p>{name}</p>\n    </div>\n  );\n}\n\nSpectatingLabel.propTypes = {\n  name: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"label\":\"SpectatingLabel__label__xmRHK\"};","import React, { Component, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport copy from \"copy-to-clipboard\";\nimport { FormattedMessage } from \"react-intl\";\nimport screenfull from \"screenfull\";\n\nimport configs from \"../utils/configs\";\nimport { VR_DEVICE_AVAILABILITY } from \"../utils/vr-caps-detect\";\nimport { canShare } from \"../utils/share\";\nimport styles from \"../assets/stylesheets/ui-root.scss\";\nimport styleUtils from \"./styles/style-utils.scss\";\nimport { ReactAudioContext } from \"./wrap-with-audio\";\nimport {\n  pushHistoryState,\n  clearHistoryState,\n  popToBeginningOfHubHistory,\n  navigateToPriorPage,\n  sluglessPath\n} from \"../utils/history\";\nimport StateRoute from \"./state-route.js\";\nimport { getPresenceProfileForSession, hubUrl } from \"../utils/phoenix-utils\";\nimport { getMicrophonePresences } from \"../utils/microphone-presence\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\nimport { isIOS } from \"../utils/is-mobile\";\nimport { CAMERA_MODE_THIRD_PERSON_VIEW, CAMERA_MODE_FIRST_PERSON } from \"../systems/camera-system\";\n\nimport ProfileEntryPanel from \"./profile-entry-panel\";\nimport MediaBrowserContainer from \"./media-browser\";\n\nimport EntryStartPanel from \"./entry-start-panel.js\";\nimport AvatarEditor from \"./avatar-editor\";\nimport PreferencesScreen from \"./preferences-screen.js\";\nimport PresenceLog from \"./presence-log.js\";\nimport PreloadOverlay from \"./preload-overlay.js\";\nimport RTCDebugPanel from \"./debug-panel/RtcDebugPanel.js\";\nimport { showFullScreenIfAvailable, showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport { handleExitTo2DInterstitial, exit2DInterstitialAndEnterVR, isIn2DInterstitial } from \"../utils/vr-interstitial\";\nimport maskEmail from \"../utils/mask-email\";\n\nimport qsTruthy from \"../utils/qs_truthy\";\nimport { LoadingScreenContainer } from \"./room/LoadingScreenContainer\";\n\nimport { RoomLayoutContainer } from \"./room/RoomLayoutContainer\";\nimport roomLayoutStyles from \"./layout/RoomLayout.scss\";\nimport { useAccessibleOutlineStyle } from \"./input/useAccessibleOutlineStyle\";\nimport { ToolbarButton } from \"./input/ToolbarButton\";\nimport { RoomEntryModal } from \"./room/RoomEntryModal\";\nimport { EnterOnDeviceModal } from \"./room/EnterOnDeviceModal\";\nimport { MicSetupModalContainer } from \"./room/MicSetupModalContainer\";\nimport { InvitePopoverContainer } from \"./room/InvitePopoverContainer\";\nimport { MoreMenuPopoverButton, CompactMoreMenuButton, MoreMenuContextProvider } from \"./room/MoreMenuPopover\";\nimport { ChatSidebarContainer, ChatContextProvider, ChatToolbarButtonContainer } from \"./room/ChatSidebarContainer\";\nimport { ContentMenu, PeopleMenuButton, ObjectsMenuButton } from \"./room/ContentMenu\";\nimport { ReactComponent as CameraIcon } from \"./icons/Camera.svg\";\nimport { ReactComponent as AvatarIcon } from \"./icons/Avatar.svg\";\nimport { ReactComponent as AddIcon } from \"./icons/Add.svg\";\nimport { ReactComponent as DeleteIcon } from \"./icons/Delete.svg\";\nimport { ReactComponent as FavoritesIcon } from \"./icons/Favorites.svg\";\nimport { ReactComponent as StarOutlineIcon } from \"./icons/StarOutline.svg\";\nimport { ReactComponent as StarIcon } from \"./icons/Star.svg\";\nimport { ReactComponent as SettingsIcon } from \"./icons/Settings.svg\";\nimport { ReactComponent as WarningCircleIcon } from \"./icons/WarningCircle.svg\";\nimport { ReactComponent as HomeIcon } from \"./icons/Home.svg\";\nimport { ReactComponent as TextDocumentIcon } from \"./icons/TextDocument.svg\";\nimport { ReactComponent as SupportIcon } from \"./icons/Support.svg\";\nimport { ReactComponent as ShieldIcon } from \"./icons/Shield.svg\";\nimport { ReactComponent as DiscordIcon } from \"./icons/Discord.svg\";\nimport { ReactComponent as VRIcon } from \"./icons/VR.svg\";\nimport { ReactComponent as LeaveIcon } from \"./icons/Leave.svg\";\nimport { ReactComponent as EnterIcon } from \"./icons/Enter.svg\";\nimport { ReactComponent as InviteIcon } from \"./icons/Invite.svg\";\nimport { PeopleSidebarContainer, userFromPresence } from \"./room/PeopleSidebarContainer\";\nimport { ObjectListProvider } from \"./room/useObjectList\";\nimport { ObjectsSidebarContainer } from \"./room/ObjectsSidebarContainer\";\nimport { ObjectMenuContainer } from \"./room/ObjectMenuContainer\";\nimport { useCssBreakpoints } from \"react-use-css-breakpoints\";\nimport { PlacePopoverContainer } from \"./room/PlacePopoverContainer\";\nimport { SharePopoverContainer } from \"./room/SharePopoverContainer\";\nimport { AudioPopoverContainer } from \"./room/AudioPopoverContainer\";\nimport { ReactionPopoverContainer } from \"./room/ReactionPopoverContainer\";\nimport { SafariMicModal } from \"./room/SafariMicModal\";\nimport { RoomSignInModalContainer } from \"./auth/RoomSignInModalContainer\";\nimport { SignInStep } from \"./auth/SignInModal\";\nimport { LeaveReason, LeaveRoomModal } from \"./room/LeaveRoomModal\";\nimport { RoomSidebar } from \"./room/RoomSidebar\";\nimport { RoomSettingsSidebarContainer } from \"./room/RoomSettingsSidebarContainer\";\nimport { AutoExitWarningModal, AutoExitReason } from \"./room/AutoExitWarningModal\";\nimport { ExitReason } from \"./room/ExitedRoomScreen\";\nimport { UserProfileSidebarContainer } from \"./room/UserProfileSidebarContainer\";\nimport { CloseRoomModal } from \"./room/CloseRoomModal\";\nimport { WebVRUnsupportedModal } from \"./room/WebVRUnsupportedModal\";\nimport { TweetModalContainer } from \"./room/TweetModalContainer\";\nimport { TipContainer, FullscreenTip } from \"./room/TipContainer\";\nimport { SpectatingLabel } from \"./room/SpectatingLabel\";\nimport { SignInMessages } from \"./auth/SignInModal\";\nimport { MediaDevicesEvents } from \"../utils/media-devices-utils\";\nimport { TERMS, PRIVACY } from \"../constants\";\n\nconst avatarEditorDebug = qsTruthy(\"avatarEditorDebug\");\n\nconst IN_ROOM_MODAL_ROUTER_PATHS = [\"/media\"];\nconst IN_ROOM_MODAL_QUERY_VARS = [\"media_source\"];\n\nconst LOBBY_MODAL_ROUTER_PATHS = [\"/media/scenes\", \"/media/avatars\", \"/media/favorites\"];\nconst LOBBY_MODAL_QUERY_VARS = [\"media_source\"];\nconst LOBBY_MODAL_QUERY_VALUES = [\"scenes\", \"avatars\", \"favorites\"];\n\nasync function grantedMicLabels() {\n  const mediaDevices = await navigator.mediaDevices.enumerateDevices();\n  return mediaDevices.filter(d => d.label && d.kind === \"audioinput\").map(d => d.label);\n}\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst AUTO_EXIT_TIMER_SECONDS = 10;\n\nclass UIRoot extends Component {\n  willCompileAndUploadMaterials = false;\n\n  static propTypes = {\n    enterScene: PropTypes.func,\n    exitScene: PropTypes.func,\n    onSendMessage: PropTypes.func,\n    disableAutoExitOnIdle: PropTypes.bool,\n    forcedVREntryType: PropTypes.string,\n    isBotMode: PropTypes.bool,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    scene: PropTypes.object,\n    authChannel: PropTypes.object,\n    hubChannel: PropTypes.object,\n    linkChannel: PropTypes.object,\n    hub: PropTypes.object,\n    availableVREntryTypes: PropTypes.object,\n    checkingForDeviceAvailability: PropTypes.bool,\n    environmentSceneLoaded: PropTypes.bool,\n    entryDisallowed: PropTypes.bool,\n    roomUnavailableReason: PropTypes.string,\n    hubIsBound: PropTypes.bool,\n    isSupportAvailable: PropTypes.bool,\n    presenceLogEntries: PropTypes.array,\n    presences: PropTypes.object,\n    sessionId: PropTypes.string,\n    subscriptions: PropTypes.object,\n    initialIsFavorited: PropTypes.bool,\n    showSignInDialog: PropTypes.bool,\n    signInMessage: PropTypes.object,\n    onContinueAfterSignIn: PropTypes.func,\n    showSafariMicDialog: PropTypes.bool,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    onAvatarSaved: PropTypes.func,\n    location: PropTypes.object,\n    history: PropTypes.object,\n    showInterstitialPrompt: PropTypes.bool,\n    onInterstitialPromptClicked: PropTypes.func,\n    performConditionalSignIn: PropTypes.func,\n    hide: PropTypes.bool,\n    showPreload: PropTypes.bool,\n    onPreloadLoadClicked: PropTypes.func,\n    embed: PropTypes.bool,\n    embedToken: PropTypes.string,\n    onLoaded: PropTypes.func,\n    activeObject: PropTypes.object,\n    selectedObject: PropTypes.object,\n    breakpoint: PropTypes.string\n  };\n\n  state = {\n    enterInVR: false,\n    entered: false,\n    entering: false,\n    dialog: null,\n    showShareDialog: false,\n    linkCode: null,\n    linkCodeCancel: null,\n    miniInviteActivated: false,\n\n    didConnectToNetworkedScene: false,\n    noMoreLoadingUpdates: false,\n    hideLoader: false,\n    showPrefs: false,\n    watching: false,\n    isStreaming: false,\n\n    waitingOnAudio: false,\n    audioTrackClone: null,\n\n    autoExitTimerStartedAt: null,\n    autoExitTimerInterval: null,\n    autoExitReason: null,\n    secondsRemainingBeforeAutoExit: Infinity,\n\n    signedIn: false,\n    videoShareMediaSource: null,\n    showVideoShareFailed: false,\n\n    objectInfo: null,\n    objectSrc: \"\",\n    sidebarId: null,\n    presenceCount: 0,\n    chatInputEffect: () => {}\n  };\n\n  constructor(props) {\n    super(props);\n\n    props.mediaSearchStore.setHistory(props.history);\n\n    // An exit handler that discards event arguments and can be cleaned up.\n    this.exitEventHandler = () => this.props.exitScene();\n    this.mediaDevicesManager = APP.mediaDevicesManager;\n  }\n\n  componentDidUpdate(prevProps) {\n    const { hubChannel, showSignInDialog } = this.props;\n    if (hubChannel) {\n      const { signedIn } = hubChannel;\n      if (signedIn !== this.state.signedIn) {\n        this.setState({ signedIn });\n      }\n    }\n    if (prevProps.showSignInDialog !== showSignInDialog) {\n      if (showSignInDialog) {\n        this.showContextualSignInDialog();\n      } else {\n        this.closeDialog();\n      }\n    }\n    if (!this.willCompileAndUploadMaterials && this.state.noMoreLoadingUpdates) {\n      this.willCompileAndUploadMaterials = true;\n      // We want to ensure that react and the browser have had the chance to render / update.\n      // See https://stackoverflow.com/a/34999925 , although our solution flipped setTimeout and requestAnimationFrame\n      window.requestAnimationFrame(() => {\n        window.setTimeout(() => {\n          if (!this.props.isBotMode) {\n            try {\n              this.props.scene.renderer.compile(this.props.scene.object3D, this.props.scene.camera);\n              this.props.scene.object3D.traverse(obj => {\n                if (!obj.material) {\n                  return;\n                }\n                const materials = Array.isArray(obj.material) ? obj.material : [obj.material];\n                for (const material of materials) {\n                  for (const prop in material) {\n                    if (material[prop] && material[prop].isTexture) {\n                      this.props.scene.renderer.initTexture(material[prop]);\n                    }\n                  }\n                }\n              });\n            } catch (e) {\n              console.error(e);\n              this.props.exitScene(ExitReason.sceneError); // https://github.com/mozilla/hubs/issues/1950\n            }\n          }\n\n          if (!this.state.hideLoader) {\n            this.setState({ hideLoader: true });\n          }\n        }, 0);\n      });\n    }\n\n    if (!this.props.selectedObject || !prevProps.selectedObject) {\n      const sceneEl = this.props.scene;\n\n      if (this.props.selectedObject) {\n        sceneEl.classList.add(roomLayoutStyles.sceneSmFullScreen);\n      } else {\n        sceneEl.classList.remove(roomLayoutStyles.sceneSmFullScreen);\n      }\n    }\n\n    if (this.state.presenceCount != this.occupantCount()) {\n      this.setState({ presenceCount: this.occupantCount() });\n    }\n  }\n\n  onConcurrentLoad = () => {\n    if (qsTruthy(\"allow_multi\") || this.props.store.state.preferences.allowMultipleHubsInstances) return;\n    this.startAutoExitTimer(AutoExitReason.concurrentSession);\n  };\n\n  onIdleDetected = () => {\n    if (\n      this.props.disableAutoExitOnIdle ||\n      this.state.isStreaming ||\n      this.props.store.state.preferences.disableIdleDetection\n    )\n      return;\n    this.startAutoExitTimer(AutoExitReason.idle);\n  };\n\n  onActivityDetected = () => {\n    if (this.state.autoExitTimerInterval) {\n      this.endAutoExitTimer();\n    }\n  };\n\n  componentDidMount() {\n    window.addEventListener(\"concurrentload\", this.onConcurrentLoad);\n    window.addEventListener(\"idle_detected\", this.onIdleDetected);\n    window.addEventListener(\"activity_detected\", this.onActivityDetected);\n    window.addEventListener(\"focus_chat\", this.onFocusChat);\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.showShareDialog) {\n        this.setState({ showShareDialog: false });\n      }\n    });\n\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.addEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.addEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.addEventListener(\"share_video_failed\", this.onShareVideoFailed);\n    this.props.scene.addEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.addEventListener(\"action_exit_watch\", () => {\n      if (this.state.hide) {\n        this.setState({ hide: false, hideUITip: false });\n      } else {\n        this.setState({ watching: false });\n      }\n    });\n    this.props.scene.addEventListener(\"action_toggle_ui\", () =>\n      this.setState({ hide: !this.state.hide, hideUITip: false })\n    );\n    this.props.scene.addEventListener(\"devicechange\", () => {\n      this.forceUpdate();\n    });\n\n    const scene = this.props.scene;\n\n    const unsubscribe = this.props.history.listen((location, action) => {\n      const state = location.state;\n\n      // If we just hit back into the entry flow, just go back to the page before the room landing page.\n      if (action === \"POP\" && state && state.entry_step && this.state.entered) {\n        unsubscribe();\n        navigateToPriorPage(this.props.history);\n        return;\n      }\n    });\n\n    // If we refreshed the page with any state history (eg if we were in the entry flow\n    // or had a modal/overlay open) just reset everything to the beginning of the flow by\n    // erasing all history that was accumulated for this room (including across refreshes.)\n    //\n    // We don't do this for the media browser case, since we want to be able to share\n    // links to the browser pages\n    if (this.props.history.location.state && !sluglessPath(this.props.history.location).startsWith(\"/media\")) {\n      popToBeginningOfHubHistory(this.props.history);\n    }\n\n    this.setState({\n      audioContext: {\n        playSound: sound => {\n          scene.emit(sound);\n        },\n        onMouseLeave: () => {\n          //          scene.emit(\"play_sound-hud_mouse_leave\");\n        }\n      }\n    });\n\n    if (this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\")) {\n      this.props.scene.addEventListener(\n        \"loading_finished\",\n        () => {\n          console.log(\"Loading has finished. Checking for forced room entry\");\n          setTimeout(() => this.handleForceEntry(), 1000);\n        },\n        { once: true }\n      );\n    }\n\n    this.playerRig = scene.querySelector(\"#avatar-rig\");\n\n    scene.addEventListener(\"action_media_tweet\", this.onTweet);\n  }\n\n  UNSAFE_componentWillMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.removeEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.removeEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.removeEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.removeEventListener(\"share_video_failed\", this.onShareVideoFailed);\n    this.props.scene.removeEventListener(\"action_media_tweet\", this.onTweet);\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    window.removeEventListener(\"concurrentload\", this.onConcurrentLoad);\n    window.removeEventListener(\"idle_detected\", this.onIdleDetected);\n    window.removeEventListener(\"activity_detected\", this.onActivityDetected);\n    window.removeEventListener(\"focus_chat\", this.onFocusChat);\n  }\n\n  storeUpdated = () => {\n    this.forceUpdate();\n  };\n\n  showContextualSignInDialog = () => {\n    const { signInMessage, authChannel, onContinueAfterSignIn } = this.props;\n    this.showNonHistoriedDialog(RoomSignInModalContainer, {\n      step: SignInStep.submit,\n      message: signInMessage,\n      onSubmitEmail: async email => {\n        const { authComplete } = await authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(RoomSignInModalContainer, {\n          step: SignInStep.waitForVerification,\n          onClose: onContinueAfterSignIn || this.closeDialog\n        });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.showNonHistoriedDialog(RoomSignInModalContainer, {\n          step: SignInStep.complete,\n          onClose: onContinueAfterSignIn || this.closeDialog,\n          onContinue: onContinueAfterSignIn || this.closeDialog\n        });\n      },\n      onClose: onContinueAfterSignIn || this.closeDialog\n    });\n  };\n\n  updateSubscribedState = () => {\n    const isSubscribed = this.props.subscriptions && this.props.subscriptions.isSubscribed();\n    this.setState({ isSubscribed });\n  };\n\n  toggleFavorited = () => {\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      () => {\n        const isFavorited = this.isFavorited();\n\n        this.props.hubChannel[isFavorited ? \"unfavorite\" : \"favorite\"]();\n        this.setState({ isFavorited: !isFavorited });\n      },\n      SignInMessages.favoriteRoom\n    );\n  };\n\n  isFavorited = () => {\n    return this.state.isFavorited !== undefined ? this.state.isFavorited : this.props.initialIsFavorited;\n  };\n\n  onLoadingFinished = () => {\n    console.log(\"UI root loading has finished\");\n    this.setState({ noMoreLoadingUpdates: true });\n    this.props.scene.emit(\"loading_finished\");\n\n    if (this.props.onLoaded) {\n      this.props.onLoaded();\n    }\n  };\n\n  onSceneLoaded = () => {\n    console.log(\"UI root scene has loaded\");\n    this.setState({ sceneLoaded: true });\n  };\n\n  onShareVideoEnabled = e => {\n    this.setState({ videoShareMediaSource: e.detail.source });\n  };\n\n  onShareVideoDisabled = () => {\n    this.setState({ videoShareMediaSource: null });\n  };\n\n  onShareVideoFailed = () => {\n    this.setState({ showVideoShareFailed: true });\n  };\n\n  shareVideo = mediaSource => {\n    this.props.scene.emit(`action_share_${mediaSource}`);\n  };\n\n  endShareVideo = () => {\n    this.props.scene.emit(MediaDevicesEvents.VIDEO_SHARE_ENDED);\n  };\n\n  spawnPen = () => {\n    this.props.scene.emit(\"penButtonPressed\");\n  };\n\n  onSubscribeChanged = async () => {\n    if (!this.props.subscriptions) return;\n\n    await this.props.subscriptions.toggle();\n    this.updateSubscribedState();\n  };\n\n  handleForceEntry = () => {\n    console.log(\"Forced entry type: \" + this.props.forcedVREntryType);\n\n    if (!this.props.forcedVREntryType) return;\n\n    if (this.props.forcedVREntryType.startsWith(\"daydream\")) {\n      this.enterDaydream();\n    } else if (this.props.forcedVREntryType.startsWith(\"vr\")) {\n      this.enterVR();\n    } else if (this.props.forcedVREntryType.startsWith(\"2d\")) {\n      this.enter2D();\n    }\n  };\n\n  startAutoExitTimer = autoExitReason => {\n    if (this.state.autoExitTimerInterval) return;\n\n    const autoExitTimerInterval = setInterval(() => {\n      let secondsRemainingBeforeAutoExit = Infinity;\n\n      if (this.state.autoExitTimerStartedAt) {\n        const secondsSinceStart = (new Date() - this.state.autoExitTimerStartedAt) / 1000;\n        secondsRemainingBeforeAutoExit = Math.max(0, Math.floor(AUTO_EXIT_TIMER_SECONDS - secondsSinceStart));\n      }\n\n      this.setState({ secondsRemainingBeforeAutoExit });\n      this.checkForAutoExit();\n    }, 500);\n\n    this.setState({ autoExitTimerStartedAt: new Date(), autoExitTimerInterval, autoExitReason });\n  };\n\n  checkForAutoExit = () => {\n    if (this.state.secondsRemainingBeforeAutoExit !== 0) return;\n    this.endAutoExitTimer();\n    this.props.exitScene();\n  };\n\n  isWaitingForAutoExit = () => {\n    return this.state.secondsRemainingBeforeAutoExit <= AUTO_EXIT_TIMER_SECONDS;\n  };\n\n  endAutoExitTimer = () => {\n    clearInterval(this.state.autoExitTimerInterval);\n    this.setState({\n      autoExitTimerStartedAt: null,\n      autoExitTimerInterval: null,\n      autoExitReason: null,\n      secondsRemainingBeforeAutoExit: Infinity\n    });\n  };\n\n  performDirectEntryFlow = async enterInVR => {\n    this.setState({ enterInVR, waitingOnAudio: true });\n\n    const hasGrantedMic = (await grantedMicLabels()).length > 0;\n\n    if (hasGrantedMic) {\n      if (!this.mediaDevicesManager.isMicShared) {\n        await this.mediaDevicesManager.startMicShare({});\n      }\n      this.beginOrSkipAudioSetup();\n    } else {\n      this.onRequestMicPermission();\n      this.pushHistoryState(\"entry_step\", \"audio\");\n    }\n\n    this.setState({ waitingOnAudio: false });\n  };\n\n  enter2D = async () => {\n    console.log(\"Entering in 2D mode\");\n    await this.performDirectEntryFlow(false);\n  };\n\n  enterVR = async () => {\n    console.log(\"Entering in VR mode\");\n    if (this.props.forcedVREntryType || this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.maybe) {\n      await this.performDirectEntryFlow(true);\n    } else {\n      this.showNonHistoriedDialog(WebVRUnsupportedModal);\n    }\n  };\n\n  enterDaydream = async () => {\n    console.log(\"Entering in Daydream mode\");\n    await this.performDirectEntryFlow(true);\n  };\n\n  onRequestMicPermission = async () => {\n    await this.mediaDevicesManager.startMicShare({});\n  };\n\n  beginOrSkipAudioSetup = () => {\n    const skipAudioSetup = this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\");\n    if (skipAudioSetup) {\n      console.log(`Skipping audio setup (forcedVREntryType = ${this.props.forcedVREntryType})`);\n      this.onAudioReadyButton();\n    } else {\n      console.log(`Starting audio setup`);\n      this.pushHistoryState(\"entry_step\", \"audio\");\n    }\n  };\n\n  shouldShowFullScreen = () => {\n    // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n    return (isMobile || AFRAME.utils.device.isMobileVR()) && !isIOS() && !this.state.enterInVR && screenfull.enabled;\n  };\n\n  onAudioReadyButton = async () => {\n    if (!this.state.enterInVR) {\n      await showFullScreenIfAvailable();\n    }\n\n    // Push the new history state before going into VR, otherwise menu button will take us back\n    clearHistoryState(this.props.history);\n\n    const muteOnEntry = this.props.store.state.preferences.muteMicOnEntry;\n    await this.props.enterScene(this.state.enterInVR, muteOnEntry);\n\n    this.setState({ entered: true, entering: false, showShareDialog: false });\n\n    if (this.mediaDevicesManager.isMicShared) {\n      console.log(`Using microphone: ${this.mediaDevicesManager.selectedMicLabel}`);\n    }\n\n    if (this.mediaDevicesManager.isVideoShared) {\n      console.log(\"Screen sharing enabled.\");\n    }\n  };\n\n  attemptLink = async () => {\n    this.pushHistoryState(\"entry_step\", \"device\");\n    const { code, cancel, onFinished } = await this.props.linkChannel.generateCode();\n    this.setState({ linkCode: code, linkCodeCancel: cancel });\n    onFinished.then(() => {\n      this.setState({ log: false, linkCode: null, linkCodeCancel: null });\n      this.props.exitScene();\n    });\n  };\n\n  toggleShareDialog = async () => {\n    this.props.store.update({ activity: { hasOpenedShare: true } });\n    this.setState({ showShareDialog: !this.state.showShareDialog });\n  };\n\n  closeDialog = () => {\n    if (this.state.dialog) {\n      this.setState({ dialog: null });\n    }\n\n    if (isIn2DInterstitial()) {\n      exit2DInterstitialAndEnterVR();\n    } else {\n      showFullScreenIfWasFullScreen();\n    }\n  };\n\n  showNonHistoriedDialog = (DialogClass, props = {}) => {\n    this.setState({\n      dialog: <DialogClass {...{ onClose: this.closeDialog, ...props }} />\n    });\n  };\n\n  toggleStreamerMode = () => {\n    const isStreaming = !this.state.isStreaming;\n    this.props.scene.systems[\"hubs-systems\"].characterController.fly = isStreaming;\n\n    if (isStreaming) {\n      this.props.hubChannel.beginStreaming();\n    } else {\n      this.props.hubChannel.endStreaming();\n    }\n\n    this.setState({ isStreaming });\n  };\n\n  renderDialog = (DialogClass, props = {}) => <DialogClass {...{ onClose: this.closeDialog, ...props }} />;\n\n  signOut = async () => {\n    await this.props.authChannel.signOut(this.props.hubChannel);\n    this.setState({ signedIn: false });\n  };\n\n  onMiniInviteClicked = () => {\n    const link = `https://${configs.SHORTLINK_DOMAIN}/${this.props.hub.hub_id}`;\n\n    this.setState({ miniInviteActivated: true });\n    setTimeout(() => {\n      this.setState({ miniInviteActivated: false });\n    }, 5000);\n\n    if (canShare()) {\n      navigator.share({ title: document.title, url: link });\n    } else {\n      copy(link);\n    }\n  };\n\n  sendMessage = msg => {\n    this.props.onSendMessage(msg);\n  };\n\n  occupantCount = () => {\n    return this.props.presences ? Object.entries(this.props.presences).length : 0;\n  };\n\n  hasEmbedPresence = () => {\n    if (!this.props.presences) {\n      return false;\n    } else {\n      for (const p of Object.values(this.props.presences)) {\n        for (const m of p.metas) {\n          if (m.context && m.context.embed) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  onTweet = ({ detail }) => {\n    handleExitTo2DInterstitial(true, () => {}).then(() => {\n      this.props.performConditionalSignIn(\n        () => this.props.hubChannel.signedIn,\n        () => {\n          this.showNonHistoriedDialog(TweetModalContainer, {\n            hubChannel: this.props.hubChannel,\n            isAdmin: configs.isAdmin(),\n            ...detail\n          });\n        },\n        SignInMessages.tweet\n      );\n    });\n  };\n\n  onChangeScene = () => {\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.can(\"update_hub\"),\n      () => {\n        showFullScreenIfAvailable();\n        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\", \"use\");\n      },\n      SignInMessages.changeScene\n    );\n  };\n\n  pushHistoryState = (k, v) => pushHistoryState(this.props.history, k, v);\n\n  setSidebar(sidebarId, otherState) {\n    this.setState({ sidebarId, chatInputEffect: () => {}, selectedUserId: null, ...otherState });\n  }\n\n  toggleSidebar(sidebarId, otherState) {\n    this.setState(({ sidebarId: curSidebarId }) => {\n      const nextSidebarId = curSidebarId === sidebarId ? null : sidebarId;\n\n      return {\n        sidebarId: nextSidebarId,\n        selectedUserId: null,\n        ...otherState\n      };\n    });\n  }\n\n  onFocusChat = e => {\n    this.setSidebar(\"chat\", {\n      chatInputEffect: input => {\n        input.focus();\n        input.value = e.detail.prefix;\n      }\n    });\n  };\n\n  renderInterstitialPrompt = () => {\n    return (\n      <div className={styles.interstitial} onClick={() => this.props.onInterstitialPromptClicked()}>\n        <div>\n          <FormattedMessage id=\"ui-root.interstitial-prompt\" defaultMessage=\"Continue\" />\n        </div>\n      </div>\n    );\n  };\n\n  renderBotMode = () => {\n    return (\n      <div className=\"loading-panel\">\n        <img className=\"loading-panel__logo\" src={configs.image(\"logo\")} />\n        <input type=\"file\" id=\"bot-audio-input\" accept=\"audio/*\" />\n        <input type=\"file\" id=\"bot-data-input\" accept=\"application/json\" />\n      </div>\n    );\n  };\n\n  onEnteringCanceled = () => {\n    this.props.hubChannel.sendEnteringCancelledEvent();\n    this.setState({ entering: false });\n  };\n\n  renderEntryStartPanel = () => {\n    const { hasAcceptedProfile, hasChangedName } = this.props.store.state.activity;\n    const promptForNameAndAvatarBeforeEntry = this.props.hubIsBound ? !hasAcceptedProfile : !hasChangedName;\n\n    // TODO: What does onEnteringCanceled do?\n    return (\n      <>\n        <RoomEntryModal\n          roomName={this.props.hub.name}\n          showJoinRoom={!this.state.waitingOnAudio && !this.props.entryDisallowed}\n          onJoinRoom={() => {\n            if (promptForNameAndAvatarBeforeEntry || !this.props.forcedVREntryType) {\n              this.setState({ entering: true });\n              this.props.hubChannel.sendEnteringEvent();\n\n              if (promptForNameAndAvatarBeforeEntry) {\n                this.pushHistoryState(\"entry_step\", \"profile\");\n              } else {\n                this.onRequestMicPermission();\n                this.pushHistoryState(\"entry_step\", \"audio\");\n              }\n            } else {\n              this.handleForceEntry();\n            }\n          }}\n          showEnterOnDevice={!this.state.waitingOnAudio && !this.props.entryDisallowed && !isMobileVR}\n          onEnterOnDevice={() => this.attemptLink()}\n          showSpectate={!this.state.waitingOnAudio}\n          onSpectate={() => this.setState({ watching: true })}\n          showOptions={this.props.hubChannel.canOrWillIfCreator(\"update_hub\")}\n          onOptions={() => {\n            this.props.performConditionalSignIn(\n              () => this.props.hubChannel.can(\"update_hub\"),\n              () => this.setSidebar(\"room-settings\"),\n              SignInMessages.roomSettings\n            );\n          }}\n        />\n        {!this.state.waitingOnAudio && (\n          <EntryStartPanel\n            hubChannel={this.props.hubChannel}\n            entering={this.state.entering}\n            onEnteringCanceled={this.onEnteringCanceled}\n          />\n        )}\n      </>\n    );\n  };\n\n  renderDevicePanel = () => {\n    return (\n      <EnterOnDeviceModal\n        shortUrl={configs.SHORTLINK_DOMAIN}\n        loadingCode={!this.state.linkCode}\n        code={this.state.linkCode}\n        headsetConnected={\n          this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no ||\n          this.props.availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no\n        }\n        unsupportedBrowser={this.props.availableVREntryTypes.generic === VR_DEVICE_AVAILABILITY.maybe}\n        onEnterOnConnectedHeadset={() => {\n          // TODO: This is bad. linkCodeCancel should be tied to component lifecycle not these callback methods.\n          this.state.linkCodeCancel();\n          this.setState({ linkCode: null, linkCodeCancel: null });\n          this.enterVR();\n        }}\n        onBack={() => {\n          if (this.state.linkCodeCancel) {\n            // If the back button is pressed rapidly\n            // (before link code generation finishes),\n            // linkCodeCancel will not be a function\n            // and attempting to call it will throw.\n            // TODO: If that happens it may be ideal to\n            // interrupt and cancel link code generation.\n            this.state.linkCodeCancel();\n          }\n          this.setState({ linkCode: null, linkCodeCancel: null });\n          this.props.history.goBack();\n        }}\n      />\n    );\n  };\n\n  renderAudioSetupPanel = () => {\n    // TODO: Show HMD mic not chosen warning\n    return (\n      <MicSetupModalContainer\n        scene={this.props.scene}\n        onEnterRoom={this.onAudioReadyButton}\n        onBack={() => this.props.history.goBack()}\n      />\n    );\n  };\n\n  isInModalOrOverlay = () => {\n    if (\n      this.state.entered &&\n      (IN_ROOM_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        IN_ROOM_MODAL_QUERY_VARS.find(x => new URLSearchParams(this.props.history.location.search).get(x)))\n    ) {\n      return true;\n    }\n\n    if (\n      !this.state.entered &&\n      (LOBBY_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        LOBBY_MODAL_QUERY_VARS.find(\n          (x, i) => new URLSearchParams(this.props.history.location.search).get(x) === LOBBY_MODAL_QUERY_VALUES[i]\n        ))\n    ) {\n      return true;\n    }\n\n    if (this.state.objectInfo && this.state.objectInfo.object3D) {\n      return true; // TODO: Get object info dialog to use history\n    }\n    if (this.state.sidebarId !== null) {\n      return true;\n    }\n\n    return !!(\n      (this.props.history &&\n        this.props.history.location.state &&\n        (this.props.history.location.state.modal || this.props.history.location.state.overlay)) ||\n      this.state.dialog\n    );\n  };\n\n  getSelectedUser() {\n    const selectedUserId = this.state.selectedUserId;\n    const presence = this.props.presences[selectedUserId];\n    const micPresences = getMicrophonePresences();\n    return userFromPresence(selectedUserId, presence, micPresences, this.props.sessionId);\n  }\n\n  render() {\n    const isGhost =\n      configs.feature(\"enable_lobby_ghosts\") && (this.state.watching || (this.state.hide || this.props.hide));\n    const hide = this.state.hide || this.props.hide;\n\n    const rootStyles = {\n      [styles.ui]: true,\n      \"ui-root\": true,\n      \"in-modal-or-overlay\": this.isInModalOrOverlay(),\n      isGhost,\n      hide\n    };\n    if (this.props.hide || this.state.hide) {\n      return (\n        <div className={classNames(rootStyles)}>\n          <RoomLayoutContainer\n            scene={this.props.scene}\n            store={this.props.store}\n            viewport={!this.state.hideUITip && <FullscreenTip onDismiss={() => this.setState({ hideUITip: true })} />}\n          />\n        </div>\n      );\n    }\n\n    if (this.props.showSafariMicDialog) {\n      return (\n        <div className={classNames(rootStyles)}>\n          <RoomLayoutContainer scene={this.props.scene} store={this.props.store} modal={<SafariMicModal />} />\n        </div>\n      );\n    }\n\n    const preload = this.props.showPreload;\n\n    const isLoading = !preload && !this.state.hideLoader;\n\n    if (isLoading && this.state.showPrefs) {\n      return (\n        <div>\n          <LoadingScreenContainer scene={this.props.scene} onLoaded={this.onLoadingFinished} />\n          <PreferencesScreen\n            onClose={() => {\n              this.setState({ showPrefs: false });\n            }}\n            store={this.props.store}\n            scene={this.props.scene}\n          />\n        </div>\n      );\n    }\n    if (this.props.isBotMode) return this.renderBotMode();\n    if (isLoading) {\n      return <LoadingScreenContainer scene={this.props.scene} onLoaded={this.onLoadingFinished} />;\n    }\n    if (this.state.showPrefs) {\n      return (\n        <PreferencesScreen\n          onClose={() => {\n            this.setState({ showPrefs: false });\n          }}\n          store={this.props.store}\n          scene={this.props.scene}\n        />\n      );\n    }\n\n    if (this.props.showInterstitialPrompt) return this.renderInterstitialPrompt();\n\n    const entered = this.state.entered;\n    const watching = this.state.watching;\n    const enteredOrWatching = entered || watching;\n    const showRtcDebugPanel = this.props.store.state.preferences.showRtcDebugPanel;\n    const showAudioDebugPanel = this.props.store.state.preferences.showAudioDebugPanel;\n    const displayNameOverride = this.props.hubIsBound\n      ? getPresenceProfileForSession(this.props.presences, this.props.sessionId).displayName\n      : null;\n\n    const enableSpectateVRButton =\n      configs.feature(\"enable_lobby_ghosts\") &&\n      isGhost &&\n      !hide &&\n      this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no;\n\n    const entryDialog =\n      this.props.availableVREntryTypes &&\n      !preload &&\n      (this.isWaitingForAutoExit() ? (\n        <AutoExitWarningModal\n          reason={this.state.autoExitReason}\n          secondsRemaining={this.state.secondsRemainingBeforeAutoExit}\n          onCancel={this.endAutoExitTimer}\n        />\n      ) : (\n        <>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"device\" history={this.props.history}>\n            {this.renderDevicePanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"audio\" history={this.props.history}>\n            {this.renderAudioSetupPanel()}\n          </StateRoute>\n          <StateRoute\n            stateKey=\"entry_step\"\n            stateValue=\"profile\"\n            history={this.props.history}\n            render={props => (\n              <ProfileEntryPanel\n                {...props}\n                containerType=\"modal\"\n                displayNameOverride={displayNameOverride}\n                finished={() => {\n                  if (this.props.forcedVREntryType) {\n                    this.pushHistoryState();\n                    this.handleForceEntry();\n                  } else {\n                    this.onRequestMicPermission();\n                    this.pushHistoryState(\"entry_step\", \"audio\");\n                  }\n                }}\n                showBackButton\n                onBack={() => this.pushHistoryState()}\n                store={this.props.store}\n                mediaSearchStore={this.props.mediaSearchStore}\n                avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n              />\n            )}\n          />\n          <StateRoute stateKey=\"entry_step\" stateValue=\"\" history={this.props.history}>\n            {this.renderEntryStartPanel()}\n          </StateRoute>\n        </>\n      ));\n\n    const presenceLogEntries = this.props.presenceLogEntries || [];\n\n    const mediaSource = this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location);\n\n    // Allow scene picker pre-entry, otherwise wait until entry\n    const showMediaBrowser =\n      mediaSource && ([\"scenes\", \"avatars\", \"favorites\"].includes(mediaSource) || this.state.entered);\n\n    const streaming = this.state.isStreaming;\n\n    const showObjectList = enteredOrWatching;\n\n    const streamer = getCurrentStreamer();\n    const streamerName = streamer && streamer.displayName;\n\n    const renderEntryFlow = (!enteredOrWatching && this.props.hub) || this.isWaitingForAutoExit();\n\n    const canCreateRoom = !configs.feature(\"disable_room_creation\") || configs.isAdmin();\n    const canCloseRoom = this.props.hubChannel && !!this.props.hubChannel.canOrWillIfCreator(\"close_hub\");\n    const isModerator = this.props.hubChannel && this.props.hubChannel.canOrWillIfCreator(\"kick_users\") && !isMobileVR;\n\n    const moreMenu = [\n      {\n        id: \"user\",\n        label: !this.state.signedIn ? (\n          <FormattedMessage id=\"more-menu.not-signed-in\" defaultMessage=\"You are not signed in\" />\n        ) : (\n          <FormattedMessage\n            id=\"more-menu.you-signed-in-as\"\n            defaultMessage=\"Signed in as: {email}\"\n            values={{ email: maskEmail(this.props.store.state.credentials.email) }}\n          />\n        ),\n        items: [\n          this.state.signedIn\n            ? {\n                id: \"sign-out\",\n                label: <FormattedMessage id=\"more-menu.sign-out\" defaultMessage=\"Sign Out\" />,\n                icon: LeaveIcon,\n                onClick: async () => {\n                  await this.props.authChannel.signOut(this.props.hubChannel);\n                  this.setState({ signedIn: false });\n                }\n              }\n            : {\n                id: \"sign-in\",\n                label: <FormattedMessage id=\"more-menu.sign-in\" defaultMessage=\"Sign In\" />,\n                icon: EnterIcon,\n                onClick: () => this.showContextualSignInDialog()\n              },\n          canCreateRoom && {\n            id: \"create-room\",\n            label: <FormattedMessage id=\"more-menu.create-room\" defaultMessage=\"Create Room\" />,\n            icon: AddIcon,\n            onClick: () =>\n              this.showNonHistoriedDialog(LeaveRoomModal, {\n                destinationUrl: \"/\",\n                reason: LeaveReason.createRoom\n              })\n          },\n          {\n            id: \"user-profile\",\n            label: <FormattedMessage id=\"more-menu.profile\" defaultMessage=\"Change Name & Avatar\" />,\n            icon: AvatarIcon,\n            onClick: () => this.setSidebar(\"profile\")\n          },\n          {\n            id: \"favorite-rooms\",\n            label: <FormattedMessage id=\"more-menu.favorite-rooms\" defaultMessage=\"Favorite Rooms\" />,\n            icon: FavoritesIcon,\n            onClick: () =>\n              this.props.performConditionalSignIn(\n                () => this.props.hubChannel.signedIn,\n                () => {\n                  showFullScreenIfAvailable();\n                  this.props.mediaSearchStore.sourceNavigateWithNoNav(\"favorites\", \"use\");\n                },\n                SignInMessages.favoriteRooms\n              )\n          },\n          {\n            id: \"preferences\",\n            label: <FormattedMessage id=\"more-menu.preferences\" defaultMessage=\"Preferences\" />,\n            icon: SettingsIcon,\n            onClick: () => this.setState({ showPrefs: true })\n          }\n        ].filter(item => item)\n      },\n      {\n        id: \"room\",\n        label: <FormattedMessage id=\"more-menu.room\" defaultMessage=\"Room\" />,\n        items: [\n          {\n            id: \"room-info\",\n            label: <FormattedMessage id=\"more-menu.room-info\" defaultMessage=\"Room Info and Settings\" />,\n            icon: HomeIcon,\n            onClick: () => this.setSidebar(\"room-info\")\n          },\n          (this.props.breakpoint === \"sm\" || this.props.breakpoint === \"md\") &&\n            (this.props.hub.entry_mode !== \"invite\" || this.props.hubChannel.can(\"update_hub\")) && {\n              id: \"invite\",\n              label: <FormattedMessage id=\"more-menu.invite\" defaultMessage=\"Invite\" />,\n              icon: InviteIcon,\n              onClick: () => this.props.scene.emit(\"action_invite\")\n            },\n          this.isFavorited()\n            ? {\n                id: \"unfavorite-room\",\n                label: <FormattedMessage id=\"more-menu.unfavorite-room\" defaultMessage=\"Unfavorite Room\" />,\n                icon: StarIcon,\n                onClick: () => this.toggleFavorited()\n              }\n            : {\n                id: \"favorite-room\",\n                label: <FormattedMessage id=\"more-menu.favorite-room\" defaultMessage=\"Favorite Room\" />,\n                icon: StarOutlineIcon,\n                onClick: () => this.toggleFavorited()\n              },\n          isModerator &&\n            entered && {\n              id: \"streamer-mode\",\n              label: streaming ? (\n                <FormattedMessage id=\"more-menu.exit-streamer-mode\" defaultMessage=\"Exit Streamer Mode\" />\n              ) : (\n                <FormattedMessage id=\"more-menu.enter-streamer-mode\" defaultMessage=\"Enter Streamer Mode\" />\n              ),\n              icon: CameraIcon,\n              onClick: () => this.toggleStreamerMode()\n            },\n          (this.props.breakpoint === \"sm\" || this.props.breakpoint === \"md\") &&\n            entered && {\n              id: \"leave-room\",\n              label: <FormattedMessage id=\"more-menu.enter-leave-room\" defaultMessage=\"Leave Room\" />,\n              icon: LeaveIcon,\n              onClick: () => {\n                this.showNonHistoriedDialog(LeaveRoomModal, {\n                  destinationUrl: \"/\",\n                  reason: LeaveReason.leaveRoom\n                });\n              }\n            },\n          canCloseRoom && {\n            id: \"close-room\",\n            label: <FormattedMessage id=\"more-menu.close-room\" defaultMessage=\"Close Room\" />,\n            icon: DeleteIcon,\n            onClick: () =>\n              this.props.performConditionalSignIn(\n                () => this.props.hubChannel.can(\"update_hub\"),\n                () => {\n                  this.showNonHistoriedDialog(CloseRoomModal, {\n                    roomName: this.props.hub.name,\n                    onConfirm: () => {\n                      this.props.hubChannel.closeHub();\n                    }\n                  });\n                },\n                SignInMessages.closeRoom\n              )\n          }\n        ].filter(item => item)\n      },\n      {\n        id: \"support\",\n        label: <FormattedMessage id=\"more-menu.support\" defaultMessage=\"Support\" />,\n        items: [\n          configs.feature(\"show_community_link\") && {\n            id: \"community\",\n            label: <FormattedMessage id=\"more-menu.community\" defaultMessage=\"Community\" />,\n            icon: DiscordIcon,\n            href: configs.link(\"community\", \"https://discord.gg/dFJncWwHun\")\n          },\n          configs.feature(\"show_issue_report_link\") && {\n            id: \"report-issue\",\n            label: <FormattedMessage id=\"more-menu.report-issue\" defaultMessage=\"Report Issue\" />,\n            icon: WarningCircleIcon,\n            href: configs.link(\"issue_report\", \"https://hubs.mozilla.com/docs/help.html\")\n          },\n          entered && {\n            id: \"start-tour\",\n            label: <FormattedMessage id=\"more-menu.start-tour\" defaultMessage=\"Start Tour\" />,\n            icon: SupportIcon,\n            onClick: () => this.props.scene.systems.tips.resetTips()\n          },\n          configs.feature(\"show_docs_link\") && {\n            id: \"help\",\n            label: <FormattedMessage id=\"more-menu.help\" defaultMessage=\"Help\" />,\n            icon: SupportIcon,\n            href: configs.link(\"docs\", \"https://hubs.mozilla.com/docs\")\n          },\n          configs.feature(\"show_controls_link\") && {\n            id: \"controls\",\n            label: <FormattedMessage id=\"more-menu.controls\" defaultMessage=\"Controls\" />,\n            icon: SupportIcon,\n            href: configs.link(\"controls\", \"https://hubs.mozilla.com/docs/hubs-controls.html\")\n          },\n          configs.feature(\"show_whats_new_link\") && {\n            id: \"whats-new\",\n            label: <FormattedMessage id=\"more-menu.whats-new\" defaultMessage=\"What's New\" />,\n            icon: SupportIcon,\n            href: \"/whats-new\"\n          },\n          configs.feature(\"show_terms\") && {\n            id: \"tos\",\n            label: <FormattedMessage id=\"more-menu.tos\" defaultMessage=\"Terms of Service\" />,\n            icon: TextDocumentIcon,\n            href: configs.link(\"terms_of_use\", TERMS)\n          },\n          configs.feature(\"show_privacy\") && {\n            id: \"privacy\",\n            label: <FormattedMessage id=\"more-menu.privacy\" defaultMessage=\"Privacy Notice\" />,\n            icon: ShieldIcon,\n            href: configs.link(\"privacy_notice\", PRIVACY)\n          }\n        ].filter(item => item)\n      }\n    ];\n\n    return (\n      <MoreMenuContextProvider>\n        <ReactAudioContext.Provider value={this.state.audioContext}>\n          <div className={classNames(rootStyles)}>\n            {preload &&\n              this.props.hub && (\n                <PreloadOverlay\n                  hubName={this.props.hub.name}\n                  hubScene={this.props.hub.scene}\n                  baseUrl={hubUrl(this.props.hub.hub_id).href}\n                  onLoadClicked={this.props.onPreloadLoadClicked}\n                />\n              )}\n            {!this.state.dialog && (\n              <StateRoute\n                stateKey=\"overlay\"\n                stateValue=\"avatar-editor\"\n                history={this.props.history}\n                render={props => (\n                  <AvatarEditor\n                    className={styles.avatarEditor}\n                    signedIn={this.state.signedIn}\n                    onSignIn={this.showContextualSignInDialog}\n                    onSave={() => {\n                      if (props.location.state.detail && props.location.state.detail.returnToProfile) {\n                        this.props.history.goBack();\n                      } else {\n                        this.props.history.goBack();\n                        // We are returning to the media browser. Trigger an update so that the filter switches to\n                        // my-avatars, now that we've saved an avatar.\n                        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\", \"use\");\n                      }\n                      this.props.onAvatarSaved();\n                    }}\n                    onClose={() => this.props.history.goBack()}\n                    store={this.props.store}\n                    debug={avatarEditorDebug}\n                    avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                    hideDelete={props.location.state.detail && props.location.state.detail.hideDelete}\n                  />\n                )}\n              />\n            )}\n            {!this.state.dialog &&\n              showMediaBrowser && (\n                <MediaBrowserContainer\n                  history={this.props.history}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  hubChannel={this.props.hubChannel}\n                  onMediaSearchResultEntrySelected={(entry, selectAction) => {\n                    if (entry.type === \"room\") {\n                      this.showNonHistoriedDialog(LeaveRoomModal, {\n                        destinationUrl: entry.url,\n                        reason: LeaveReason.joinRoom\n                      });\n                    } else {\n                      this.props.onMediaSearchResultEntrySelected(entry, selectAction);\n                    }\n                  }}\n                  performConditionalSignIn={this.props.performConditionalSignIn}\n                  showNonHistoriedDialog={this.showNonHistoriedDialog}\n                  store={this.props.store}\n                  scene={this.props.scene}\n                />\n              )}\n            {this.props.hub && (\n              <RoomLayoutContainer\n                scene={this.props.scene}\n                store={this.props.store}\n                objectFocused={!!this.props.selectedObject}\n                streaming={streaming}\n                viewport={\n                  <>\n                    {!this.state.dialog && renderEntryFlow ? entryDialog : undefined}\n                    {!this.props.selectedObject && <CompactMoreMenuButton />}\n                    {(!this.props.selectedObject ||\n                      (this.props.breakpoint !== \"sm\" && this.props.breakpoint !== \"md\")) && (\n                      <ContentMenu>\n                        {showObjectList && (\n                          <ObjectsMenuButton\n                            active={this.state.sidebarId === \"objects\"}\n                            onClick={() => this.toggleSidebar(\"objects\")}\n                          />\n                        )}\n                        <PeopleMenuButton\n                          active={this.state.sidebarId === \"people\"}\n                          onClick={() => this.toggleSidebar(\"people\")}\n                          presencecount={this.state.presenceCount}\n                        />\n                      </ContentMenu>\n                    )}\n                    {!entered && !streaming && !isMobile && streamerName && <SpectatingLabel name={streamerName} />}\n                    {this.props.activeObject && (\n                      <ObjectMenuContainer\n                        hubChannel={this.props.hubChannel}\n                        scene={this.props.scene}\n                        onOpenProfile={() => this.setSidebar(\"profile\")}\n                        onGoToObject={() => {\n                          if (this.props.breakpoint === \"sm\") {\n                            this.setSidebar(null);\n                          }\n                        }}\n                      />\n                    )}\n                    {this.state.sidebarId !== \"chat\" &&\n                      this.props.hub && (\n                        <PresenceLog\n                          inRoom={true}\n                          presences={this.props.presences}\n                          entries={presenceLogEntries}\n                          hubId={this.props.hub.hub_id}\n                          history={this.props.history}\n                          onViewProfile={sessionId => this.setSidebar(\"user\", { selectedUserId: sessionId })}\n                        />\n                      )}\n                    <TipContainer\n                      hide={this.props.activeObject}\n                      inLobby={watching}\n                      inRoom={entered}\n                      isEmbedded={this.props.embed}\n                      isStreaming={streaming}\n                      hubId={this.props.hub.hub_id}\n                      presences={this.props.presences}\n                      scene={this.props.scene}\n                      store={this.props.store}\n                    />\n                    {(showRtcDebugPanel || showAudioDebugPanel) && (\n                      <RTCDebugPanel\n                        history={this.props.history}\n                        store={window.APP.store}\n                        scene={this.props.scene}\n                        presences={this.props.presences}\n                        sessionId={this.props.sessionId}\n                        showRtcDebug={showRtcDebugPanel}\n                        showAudioDebug={showAudioDebugPanel}\n                      />\n                    )}\n                  </>\n                }\n                sidebar={\n                  this.state.sidebarId ? (\n                    <>\n                      {this.state.sidebarId === \"chat\" && (\n                        <ChatSidebarContainer\n                          presences={this.props.presences}\n                          occupantCount={this.occupantCount()}\n                          canSpawnMessages={entered && this.props.hubChannel.can(\"spawn_and_move_media\")}\n                          scene={this.props.scene}\n                          onClose={() => this.setSidebar(null)}\n                          inputEffect={this.state.chatInputEffect}\n                        />\n                      )}\n                      {this.state.sidebarId === \"objects\" && (\n                        <ObjectsSidebarContainer\n                          hubChannel={this.props.hubChannel}\n                          onClose={() => this.setSidebar(null)}\n                        />\n                      )}\n                      {this.state.sidebarId === \"people\" && (\n                        <PeopleSidebarContainer\n                          displayNameOverride={displayNameOverride}\n                          store={this.props.store}\n                          mediaSearchStore={this.props.mediaSearchStore}\n                          hubChannel={this.props.hubChannel}\n                          history={this.props.history}\n                          mySessionId={this.props.sessionId}\n                          presences={this.props.presences}\n                          onClose={() => this.setSidebar(null)}\n                          onCloseDialog={() => this.closeDialog()}\n                          showNonHistoriedDialog={this.showNonHistoriedDialog}\n                          performConditionalSignIn={this.props.performConditionalSignIn}\n                        />\n                      )}\n                      {this.state.sidebarId === \"profile\" && (\n                        <ProfileEntryPanel\n                          history={this.props.history}\n                          containerType=\"sidebar\"\n                          displayNameOverride={displayNameOverride}\n                          finished={() => this.setSidebar(null)}\n                          onClose={() => this.setSidebar(null)}\n                          store={this.props.store}\n                          mediaSearchStore={this.props.mediaSearchStore}\n                        />\n                      )}\n                      {this.state.sidebarId === \"user\" && (\n                        <UserProfileSidebarContainer\n                          user={this.getSelectedUser()}\n                          hubChannel={this.props.hubChannel}\n                          performConditionalSignIn={this.props.performConditionalSignIn}\n                          onClose={() => this.setSidebar(null)}\n                          onCloseDialog={() => this.closeDialog()}\n                          showNonHistoriedDialog={this.showNonHistoriedDialog}\n                        />\n                      )}\n                      {this.state.sidebarId === \"room-info\" && (\n                        <RoomSidebar\n                          accountId={this.props.sessionId}\n                          room={this.props.hub}\n                          canEdit={this.props.hubChannel.canOrWillIfCreator(\"update_hub\")}\n                          onEdit={() => {\n                            this.props.performConditionalSignIn(\n                              () => this.props.hubChannel.can(\"update_hub\"),\n                              () => this.setSidebar(\"room-info-settings\"),\n                              SignInMessages.roomSettings\n                            );\n                          }}\n                          onClose={() => this.setSidebar(null)}\n                          onChangeScene={this.onChangeScene}\n                        />\n                      )}\n                      {this.state.sidebarId === \"room-info-settings\" && (\n                        <RoomSettingsSidebarContainer\n                          room={this.props.hub}\n                          hubChannel={this.props.hubChannel}\n                          showBackButton\n                          onClose={() => this.setSidebar(\"room-info\")}\n                          onChangeScene={this.onChangeScene}\n                        />\n                      )}\n                      {this.state.sidebarId === \"room-settings\" && (\n                        <RoomSettingsSidebarContainer\n                          room={this.props.hub}\n                          accountId={this.props.sessionId}\n                          hubChannel={this.props.hubChannel}\n                          onClose={() => this.setSidebar(null)}\n                          onChangeScene={this.onChangeScene}\n                        />\n                      )}\n                    </>\n                  ) : (\n                    undefined\n                  )\n                }\n                modal={this.state.dialog}\n                toolbarLeft={\n                  <InvitePopoverContainer\n                    hub={this.props.hub}\n                    hubChannel={this.props.hubChannel}\n                    scene={this.props.scene}\n                  />\n                }\n                toolbarCenter={\n                  <>\n                    {watching && (\n                      <>\n                        <ToolbarButton\n                          icon={<EnterIcon />}\n                          label={<FormattedMessage id=\"toolbar.join-room-button\" defaultMessage=\"Join Room\" />}\n                          preset=\"accept\"\n                          onClick={() => this.setState({ watching: false })}\n                        />\n                        {enableSpectateVRButton && (\n                          <ToolbarButton\n                            icon={<VRIcon />}\n                            preset=\"accent5\"\n                            label={\n                              <FormattedMessage id=\"toolbar.spectate-in-vr-button\" defaultMessage=\"Spectate in VR\" />\n                            }\n                            onClick={() => this.props.scene.enterVR()}\n                          />\n                        )}\n                      </>\n                    )}\n                    {entered && (\n                      <>\n                        <AudioPopoverContainer scene={this.props.scene} />\n                        <SharePopoverContainer scene={this.props.scene} hubChannel={this.props.hubChannel} />\n                        <PlacePopoverContainer\n                          scene={this.props.scene}\n                          hubChannel={this.props.hubChannel}\n                          mediaSearchStore={this.props.mediaSearchStore}\n                          showNonHistoriedDialog={this.showNonHistoriedDialog}\n                        />\n                        {this.props.hubChannel.can(\"spawn_emoji\") && (\n                          <ReactionPopoverContainer\n                            scene={this.props.scene}\n                            initialPresence={getPresenceProfileForSession(this.props.presences, this.props.sessionId)}\n                          />\n                        )}\n                      </>\n                    )}\n                    <ChatToolbarButtonContainer onClick={() => this.toggleSidebar(\"chat\")} />\n                    {entered && (\n                      <ToolbarButton\n                        icon={<VRIcon />}\n                        label={<FormattedMessage id=\"toolbar.camera-view\" defaultMessage=\"3rd person view\" />}\n                        onClick={() => {\n                          const cameraMode = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode;\n\n                          if (cameraMode === CAMERA_MODE_FIRST_PERSON) {\n                            AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode = CAMERA_MODE_THIRD_PERSON_VIEW;\n                          }\n\n                          if (cameraMode === CAMERA_MODE_THIRD_PERSON_VIEW) {\n                            AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode = CAMERA_MODE_FIRST_PERSON;\n                          }\n                        }}\n                      />\n                    )}\n                    {entered &&\n                      isMobileVR && (\n                        <ToolbarButton\n                          className={styleUtils.hideLg}\n                          icon={<VRIcon />}\n                          preset=\"accept\"\n                          label={<FormattedMessage id=\"toolbar.enter-vr-button\" defaultMessage=\"Enter VR\" />}\n                          onClick={() => exit2DInterstitialAndEnterVR(true)}\n                        />\n                      )}\n                  </>\n                }\n                toolbarRight={\n                  <>\n                    {entered &&\n                      isMobileVR && (\n                        <ToolbarButton\n                          icon={<VRIcon />}\n                          preset=\"accept\"\n                          label={<FormattedMessage id=\"toolbar.enter-vr-button\" defaultMessage=\"Enter VR\" />}\n                          onClick={() => exit2DInterstitialAndEnterVR(true)}\n                        />\n                      )}\n                    {entered && (\n                      <ToolbarButton\n                        icon={<LeaveIcon />}\n                        label={<FormattedMessage id=\"toolbar.leave-room-button\" defaultMessage=\"Leave\" />}\n                        preset=\"cancel\"\n                        onClick={() => {\n                          this.showNonHistoriedDialog(LeaveRoomModal, {\n                            destinationUrl: \"/\",\n                            reason: LeaveReason.leaveRoom\n                          });\n                        }}\n                      />\n                    )}\n                    <MoreMenuPopoverButton menu={moreMenu} />\n                  </>\n                }\n              />\n            )}\n          </div>\n        </ReactAudioContext.Provider>\n      </MoreMenuContextProvider>\n    );\n  }\n}\n\nfunction UIRootHooksWrapper(props) {\n  useAccessibleOutlineStyle();\n  const breakpoint = useCssBreakpoints();\n\n  useEffect(\n    () => {\n      const el = document.getElementById(\"preload-overlay\");\n      el.classList.add(\"loaded\");\n\n      const sceneEl = props.scene;\n\n      sceneEl.classList.add(roomLayoutStyles.scene);\n\n      // Remove the preload overlay after the animation has finished.\n      const timeout = setTimeout(() => {\n        el.remove();\n      }, 500);\n\n      return () => {\n        clearTimeout(timeout);\n        sceneEl.classList.remove(roomLayoutStyles.scene);\n      };\n    },\n    [props.scene]\n  );\n\n  return (\n    <ChatContextProvider messageDispatch={props.messageDispatch}>\n      <ObjectListProvider scene={props.scene}>\n        <UIRoot breakpoint={breakpoint} {...props} />\n      </ObjectListProvider>\n    </ChatContextProvider>\n  );\n}\n\nUIRootHooksWrapper.propTypes = {\n  scene: PropTypes.object.isRequired,\n  messageDispatch: PropTypes.object,\n  store: PropTypes.object.isRequired\n};\n\nexport default UIRootHooksWrapper;\n","import { useEffect, useState } from \"react\";\n\n// The page is styled by default not to have any outlines on selected input elements.\n// When the user presses the tab key the keyboardUserClass is added to the body and all outlines are re-enabled.\n// The next time you click this keyboardUserClass will be removed, removing the outline styles.\n// This lets us provide a clean look for mouse users, while still maintaining accessibility for keyboard users.\nexport function useAccessibleOutlineStyle(keyboardUserClass = \"keyboard-user\") {\n  const [keyboardUser, setKeyboardUser] = useState(false);\n\n  useEffect(\n    () => {\n      function onMouseDown() {\n        if (keyboardUser) {\n          document.body.classList.remove(keyboardUserClass);\n          setKeyboardUser(false);\n        }\n      }\n\n      function onKeyDown(e) {\n        if (e.key === \"Tab\" && !keyboardUser) {\n          document.body.classList.add(keyboardUserClass);\n          setKeyboardUser(true);\n        }\n      }\n\n      window.addEventListener(\"keydown\", onKeyDown);\n      window.addEventListener(\"mousedown\", onMouseDown);\n\n      return () => {\n        window.removeEventListener(\"keydown\", onKeyDown);\n        window.removeEventListener(\"mousedown\", onMouseDown);\n      };\n    },\n    [keyboardUserClass, keyboardUser]\n  );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { ExitedRoomScreen } from \"./ExitedRoomScreen\";\nimport constants from \"../../constants\";\n\nexport function ExitedRoomScreenContainer({ reason }) {\n  return (\n    <ExitedRoomScreen\n      showTerms={configs.feature(\"show_terms\")}\n      termsUrl={configs.link(\"terms_of_use\", constants.TERMS)}\n      showSourceLink={configs.feature(\"show_source_link\")}\n      reason={reason}\n      contactEmail={configs.translation(\"contact-email\")}\n    />\n  );\n}\n\nExitedRoomScreenContainer.propTypes = {\n  reason: PropTypes.string.isRequired\n};\n","import uuid from \"uuid/v4\";\n\nexport default class AuthChannel {\n  constructor(store) {\n    this.store = store;\n    this.socket = null;\n    this._signedIn = !!this.store.state.credentials.token;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  get email() {\n    return this.store.state.credentials.email;\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  signOut = async hubChannel => {\n    if (hubChannel) {\n      await hubChannel.signOut();\n    }\n    this.store.update({ credentials: { token: null, email: null } });\n    await this.store.resetToRandomDefaultAvatar();\n    this._signedIn = false;\n  };\n\n  verifyAuthentication(authTopic, authToken, authPayload) {\n    const channel = this.socket.channel(authTopic);\n    return new Promise((resolve, reject) => {\n      channel.onError(() => {\n        channel.leave();\n        reject();\n      });\n\n      channel\n        .join()\n        .receive(\"ok\", () => {\n          channel.on(\"auth_credentials\", async ({ credentials: token, payload: payload }) => {\n            await this.handleAuthCredentials(payload.email, token);\n            resolve();\n          });\n\n          channel.push(\"auth_verified\", { token: authToken, payload: authPayload });\n        })\n        .receive(\"error\", reject);\n    });\n  }\n\n  async startAuthentication(email, hubChannel) {\n    const channel = this.socket.channel(`auth:${uuid()}`);\n    await new Promise((resolve, reject) =>\n      channel\n        .join()\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject)\n    );\n\n    const authComplete = new Promise(resolve =>\n      channel.on(\"auth_credentials\", async ({ credentials: token }) => {\n        await this.handleAuthCredentials(email, token, hubChannel);\n        resolve();\n      })\n    );\n\n    channel.push(\"auth_request\", { email, origin: \"hubs\" });\n\n    // Returning an object with the authComplete promise since we want the caller to wait for the above await but not\n    // for authComplete.\n    return { authComplete };\n  }\n\n  async handleAuthCredentials(email, token, hubChannel) {\n    this.store.update({ credentials: { email, token } });\n\n    if (hubChannel) {\n      await hubChannel.signIn(token);\n    }\n\n    this._signedIn = true;\n  }\n}\n","import jwtDecode from \"jwt-decode\";\nimport { EventTarget } from \"event-target-shim\";\nimport { Presence } from \"phoenix\";\nimport { migrateChannelToSocket, discordBridgesForPresences, migrateToChannel } from \"./phoenix-utils\";\nimport configs from \"./configs\";\n\nconst MS_PER_DAY = 1000 * 60 * 60 * 24;\nconst MS_PER_MONTH = 1000 * 60 * 60 * 24 * 30;\n\nfunction isSameMonth(da, db) {\n  return da.getFullYear() == db.getFullYear() && da.getMonth() == db.getMonth();\n}\n\nfunction isSameDay(da, db) {\n  return isSameMonth(da, db) && da.getDate() == db.getDate();\n}\n\n// Permissions that will be assumed if the user becomes the creator.\nconst HUB_CREATOR_PERMISSIONS = [\n  \"update_hub\",\n  \"update_hub_promotion\",\n  \"update_roles\",\n  \"close_hub\",\n  \"mute_users\",\n  \"kick_users\",\n  \"amplify_audio\"\n];\nconst VALID_PERMISSIONS = HUB_CREATOR_PERMISSIONS.concat([\n  \"tweet\",\n  \"spawn_camera\",\n  \"spawn_drawing\",\n  \"spawn_and_move_media\",\n  \"pin_objects\",\n  \"spawn_emoji\",\n  \"fly\"\n]);\n\nexport default class HubChannel extends EventTarget {\n  constructor(store, hubId) {\n    super();\n    this.store = store;\n    this.hubId = hubId;\n    this._signedIn = !!this.store.state.credentials.token;\n    this._permissions = {};\n    this._blockedSessionIds = new Set();\n\n    store.addEventListener(\"profilechanged\", this.sendProfileUpdate.bind(this));\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  // Returns true if this current session has the given permission.\n  can(permission) {\n    if (!VALID_PERMISSIONS.includes(permission)) throw new Error(`Invalid permission name: ${permission}`);\n    return this._permissions && this._permissions[permission];\n  }\n\n  userCan(clientId, permission) {\n    const presenceState = this.presence.state[clientId];\n    if (!presenceState) {\n      console.warn(`userCan: Had no presence state for ${clientId}`);\n      return false;\n    }\n\n    return !!presenceState.metas[0].permissions[permission];\n  }\n\n  // Returns true if the current session has the given permission, *or* will get the permission\n  // if they sign in and become the creator.\n  canOrWillIfCreator(permission) {\n    if (this._getCreatorAssignmentToken() && HUB_CREATOR_PERMISSIONS.includes(permission)) return true;\n    return this.can(permission);\n  }\n\n  canEnterRoom(hub) {\n    if (!hub) return false;\n    if (this.canOrWillIfCreator(\"update_hub\")) return true;\n\n    const roomEntrySlotCount = Object.values(this.presence.state).reduce((acc, { metas }) => {\n      const meta = metas[metas.length - 1];\n      const usingSlot = meta.presence === \"room\" || (meta.context && meta.context.entering);\n      return acc + (usingSlot ? 1 : 0);\n    }, 0);\n\n    // This now exists in room settings but a default is left here to support old reticulum servers\n    const DEFAULT_ROOM_SIZE = 24;\n    return roomEntrySlotCount < (hub.room_size !== undefined ? hub.room_size : DEFAULT_ROOM_SIZE);\n  }\n\n  // Migrates this hub channel to a new phoenix channel and presence\n  async migrateToSocket(socket, params) {\n    let presenceBindings;\n\n    // Unbind presence, and then set up bindings after reconnect\n    if (this.presence) {\n      presenceBindings = {\n        onJoin: this.presence.caller.onJoin,\n        onLeave: this.presence.caller.onLeave,\n        onSync: this.presence.caller.onSync\n      };\n\n      this.presence.onJoin(function() {});\n      this.presence.onLeave(function() {});\n      this.presence.onSync(function() {});\n    }\n\n    this.channel = await migrateChannelToSocket(this.channel, socket, params);\n    this.presence = new Presence(this.channel);\n\n    if (presenceBindings) {\n      this.presence.onJoin(presenceBindings.onJoin);\n      this.presence.onLeave(presenceBindings.onLeave);\n      this.presence.onSync(presenceBindings.onSync);\n    }\n  }\n\n  async migrateToHub(hubId) {\n    let presenceBindings;\n\n    const newChannel = this.channel.socket.channel(`hub:${hubId}`, APP.hubChannelParamsForPermsToken());\n    const data = await migrateToChannel(this.channel, newChannel);\n\n    if (this.presence) {\n      presenceBindings = {\n        onJoin: this.presence.caller.onJoin,\n        onLeave: this.presence.caller.onLeave,\n        onSync: this.presence.caller.onSync\n      };\n\n      this.presence.onJoin(function() {});\n      this.presence.onLeave(function() {});\n      this.presence.onSync(function() {});\n    }\n\n    this.channel = newChannel;\n    this.presence = new Presence(this.channel);\n    this.hubId = data.hubs[0].hub_id;\n\n    this.setPermissionsFromToken(data.perms_token);\n\n    if (presenceBindings) {\n      this.presence.onJoin(presenceBindings.onJoin);\n      this.presence.onLeave(presenceBindings.onLeave);\n      this.presence.onSync(presenceBindings.onSync);\n    }\n    return data;\n  }\n\n  setPermissionsFromToken = token => {\n    // Note: token is not verified.\n    this.token = token;\n    this._permissions = jwtDecode(token);\n    configs.setIsAdmin(this._permissions.postgrest_role === \"ret_admin\");\n    this.dispatchEvent(new CustomEvent(\"permissions_updated\"));\n\n    // Refresh the token 1 minute before it expires.\n    const nextRefresh = new Date(this._permissions.exp * 1000 - 60 * 1000) - new Date();\n    if (this.fetchPermissionsTimeout) {\n      clearTimeout(this.fetchPermissionsTimeout);\n    }\n    this.fetchPermissionsTimeout = setTimeout(this.fetchPermissions, nextRefresh);\n  };\n\n  sendEnteringEvent = async () => {\n    this.channel.push(\"events:entering\", {});\n  };\n\n  sendEnteringCancelledEvent = async () => {\n    this.channel.push(\"events:entering_cancelled\", {});\n  };\n\n  sendEnteredEvent = async () => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before room entry.\");\n      return;\n    }\n\n    let entryDisplayType = \"Screen\";\n\n    if (navigator.getVRDisplays) {\n      const vrDisplay = (await navigator.getVRDisplays()).find(d => d.isPresenting);\n\n      if (vrDisplay) {\n        entryDisplayType = vrDisplay.displayName;\n      }\n    }\n\n    const initialOccupantCount = this.presence\n      .list((key, presence) => {\n        return { key, entryState: presence.metas[presence.metas.length - 1].presence };\n      })\n      .filter(({ key, entryState }) => {\n        return key !== NAF.clientId && entryState === \"room\";\n      }).length;\n\n    const entryTimingFlags = this.getEntryTimingFlags();\n\n    const entryEvent = {\n      ...entryTimingFlags,\n      initialOccupantCount,\n      entryDisplayType,\n      userAgent: navigator.userAgent\n    };\n\n    this.channel.push(\"events:entered\", entryEvent);\n  };\n\n  beginStreaming() {\n    this.channel.push(\"events:begin_streaming\", {});\n  }\n\n  endStreaming() {\n    this.channel.push(\"events:end_streaming\", {});\n  }\n\n  beginRecording() {\n    this.channel.push(\"events:begin_recording\", {});\n  }\n\n  endRecording() {\n    this.channel.push(\"events:end_recording\", {});\n  }\n\n  raiseHand() {\n    this.channel.push(\"events:raise_hand\", {});\n  }\n\n  lowerHand() {\n    this.channel.push(\"events:lower_hand\", {});\n  }\n\n  beginTyping() {\n    this.channel.push(\"events:begin_typing\", {});\n  }\n\n  endTyping() {\n    this.channel.push(\"events:end_typing\", {});\n  }\n\n  getEntryTimingFlags = () => {\n    const entryTimingFlags = { isNewDaily: true, isNewMonthly: true, isNewDayWindow: true, isNewMonthWindow: true };\n    const storedLastEnteredAt = this.store.state.activity.lastEnteredAt;\n\n    if (!storedLastEnteredAt) {\n      return entryTimingFlags;\n    }\n\n    const now = new Date();\n    const lastEntered = new Date(storedLastEnteredAt);\n    const msSinceLastEntered = now - lastEntered;\n\n    // note that new daily and new monthly is based on client local time\n    entryTimingFlags.isNewDaily = !isSameDay(now, lastEntered);\n    entryTimingFlags.isNewMonthly = !isSameMonth(now, lastEntered);\n    entryTimingFlags.isNewDayWindow = msSinceLastEntered > MS_PER_DAY;\n    entryTimingFlags.isNewMonthWindow = msSinceLastEntered > MS_PER_MONTH;\n\n    return entryTimingFlags;\n  };\n\n  sendObjectSpawnedEvent = objectType => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before object spawn.\");\n      return;\n    }\n\n    const spawnEvent = {\n      object_type: objectType\n    };\n\n    this.channel.push(\"events:object_spawned\", spawnEvent);\n  };\n\n  sendProfileUpdate = () => {\n    this.channel.push(\"events:profile_updated\", { profile: this.store.state.profile });\n  };\n\n  updateScene = url => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_scene\", { url });\n  };\n\n  updateHub = settings => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_hub\", settings);\n  };\n\n  fetchInvite = () => {\n    return new Promise(resolve => this.channel.push(\"fetch_invite\", {}).receive(\"ok\", resolve));\n  };\n\n  revokeInvite = hubInviteId => {\n    return new Promise(resolve =>\n      this.channel.push(\"revoke_invite\", { hub_invite_id: hubInviteId }).receive(\"ok\", resolve)\n    );\n  };\n\n  closeHub = () => {\n    if (!this._permissions.close_hub) return \"unauthorized\";\n    this.channel.push(\"close_hub\", {});\n  };\n\n  subscribe = subscription => {\n    this.channel.push(\"subscribe\", { subscription });\n  };\n\n  // If true, will tell the server to not send us any NAF traffic\n  allowNAFTraffic = allow => {\n    this.channel.push(allow ? \"unblock_naf\" : \"block_naf\", {});\n  };\n\n  unsubscribe = subscription => {\n    return new Promise(resolve => this.channel.push(\"unsubscribe\", { subscription }).receive(\"ok\", resolve));\n  };\n\n  sendMessage = (body, type = \"chat\") => {\n    if (!body) return;\n    this.channel.push(\"message\", { body, type });\n  };\n\n  _getCreatorAssignmentToken = () => {\n    const creatorAssignmentTokenEntry =\n      this.store.state.creatorAssignmentTokens &&\n      this.store.state.creatorAssignmentTokens.find(t => t.hubId === this.hubId);\n\n    return creatorAssignmentTokenEntry && creatorAssignmentTokenEntry.creatorAssignmentToken;\n  };\n\n  signIn = token => {\n    return new Promise((resolve, reject) => {\n      const creator_assignment_token = this._getCreatorAssignmentToken();\n\n      this.channel\n        .push(\"sign_in\", { token, creator_assignment_token })\n        .receive(\"ok\", ({ perms_token }) => {\n          this.setPermissionsFromToken(perms_token);\n          this._signedIn = true;\n          resolve();\n        })\n        .receive(\"error\", err => {\n          if (err.reason === \"invalid_token\") {\n            console.warn(\"sign in failed\", err);\n            // Token expired or invalid TODO purge from storage if possible\n            resolve();\n          } else {\n            console.error(\"sign in failed\", err);\n            reject();\n          }\n        });\n    });\n  };\n\n  signOut = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"sign_out\")\n        .receive(\"ok\", async () => {\n          this._signedIn = false;\n          const params = this.channel.params();\n          delete params.auth_token;\n          delete params.perms_token;\n          await this.fetchPermissions();\n          resolve();\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getHost = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"get_host\")\n        .receive(\"ok\", res => {\n          resolve(res);\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getTwitterOAuthURL = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"oauth\", { type: \"twitter\" })\n        .receive(\"ok\", res => {\n          resolve(res.oauth_url);\n        })\n        .receive(\"error\", err => reject(new Error(err.reason)));\n    });\n  };\n\n  discordBridges = () => {\n    if (!this.presence || !this.presence.state) return [];\n    return discordBridgesForPresences(this.presence.state);\n  };\n\n  pin = (id, gltfNode, fileId, fileAccessToken, promotionToken) => {\n    const payload = { id, gltf_node: gltfNode };\n    if (fileId && promotionToken) {\n      payload.file_id = fileId;\n      payload.file_access_token = fileAccessToken;\n      payload.promotion_token = promotionToken;\n    }\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"pin\", payload)\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject);\n    });\n  };\n\n  unpin = (id, fileId) => {\n    const payload = { id };\n    if (fileId) {\n      payload.file_id = fileId;\n    }\n    this.channel.push(\"unpin\", payload);\n  };\n\n  fetchPermissions = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"refresh_perms_token\")\n        .receive(\"ok\", res => {\n          this.setPermissionsFromToken(res.perms_token);\n          resolve({ permsToken: res.perms_token, permissions: this._permissions });\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  mute = sessionId => this.channel.push(\"mute\", { session_id: sessionId });\n  addOwner = sessionId => this.channel.push(\"add_owner\", { session_id: sessionId });\n  removeOwner = sessionId => this.channel.push(\"remove_owner\", { session_id: sessionId });\n\n  hide = sessionId => {\n    NAF.connection.adapter.block(sessionId);\n    APP.dialog.block(sessionId);\n    this.channel.push(\"block\", { session_id: sessionId });\n    this._blockedSessionIds.add(sessionId);\n  };\n\n  unhide = sessionId => {\n    if (!this._blockedSessionIds.has(sessionId)) return;\n    NAF.connection.adapter.unblock(sessionId);\n    APP.dialog.unblock(sessionId);\n    NAF.connection.entities.completeSync(sessionId);\n    this.channel.push(\"unblock\", { session_id: sessionId });\n    this._blockedSessionIds.delete(sessionId);\n  };\n\n  isHidden = sessionId => this._blockedSessionIds.has(sessionId);\n\n  kick = async sessionId => {\n    APP.dialog.kick(sessionId);\n    this.channel.push(\"kick\", { session_id: sessionId });\n  };\n\n  requestSupport = () => this.channel.push(\"events:request_support\", {});\n  favorite = () => this.channel.push(\"favorite\", {});\n  unfavorite = () => this.channel.push(\"unfavorite\", {});\n\n  disconnect = () => {\n    if (this.channel) {\n      this.channel.socket.disconnect();\n    }\n  };\n}\n","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\n\nasync function deriveKey(privateKey, publicKey) {\n  return crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: publicKey },\n    privateKey,\n    { name: \"AES-CBC\", length: 256 },\n    true,\n    [\"encrypt\", \"decrypt\"]\n  );\n}\n\nasync function publicKeyToString(key) {\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\n}\n\nasync function stringToPublicKey(s) {\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\n\nfunction stringToArrayBuffer(s) {\n  const buf = new Uint8Array(s.length);\n\n  for (let i = 0; i < s.length; i++) {\n    buf[i] = s.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nfunction arrayBufferToString(b) {\n  const buf = new Uint8Array(b);\n  let s = \"\";\n\n  for (let i = 0; i < buf.byteLength; i++) {\n    s += String.fromCharCode(buf[i]);\n  }\n\n  return s;\n}\n\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\n\n// Requestor generates a public key and private key, and should send the public key to receiver.\nexport async function generateKeys() {\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  return { publicKeyString, privateKey: keyPair.privateKey };\n}\n\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\n  const iv = new Uint8Array(16);\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\n\n  const encryptedData = btoa(\n    arrayBufferToString(\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\n    )\n  );\n\n  return { publicKeyString, encryptedData };\n}\n\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\n  const iv = new Uint8Array(16);\n  const publicKey = await stringToPublicKey(publicKeyString);\n  const secret = await deriveKey(privateKey, publicKey);\n  const ciphertext = stringToArrayBuffer(atob(base64value));\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\n  return JSON.parse(arrayBufferToString(data));\n}\n","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\n\nconst LINK_ACTION_TIMEOUT = 10000;\n\nexport default class LinkChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  // Returns a promise that, when resolved, will forward an object with three keys:\n  //\n  // code: The code that was made available to use for link.\n  //\n  // cancel: A function that the caller can call to cancel the use of the code.\n  //\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\n  // because it was either successfully used by the remote device or it has expired\n  // (\"used\" or \"expired\" is passed to the callback).\n  generateCode = () => {\n    return new Promise(resolve => {\n      const onFinished = new Promise(finished => {\n        const step = () => {\n          const getLetter = () => \"ABCDEFGHI\"[Math.floor(Math.random() * 9)];\n          const code = `${getLetter()}${getLetter()}${getLetter()}${getLetter()}`;\n\n          // Only respond to one link_request in this channel.\n          let readyToSend = false;\n          let leftChannel = false;\n\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n\n          const leave = () => {\n            if (!leftChannel) channel.leave();\n            leftChannel = true;\n          };\n\n          const cancel = () => leave();\n\n          channel.on(\"link_expired\", () => finished(\"expired\"));\n\n          channel.on(\"presence_state\", state => {\n            if (readyToSend) return;\n\n            if (Object.keys(state).length > 0) {\n              // Code is in use by someone else, try a new one\n              step();\n            } else {\n              readyToSend = true;\n              resolve({ code, cancel, onFinished });\n            }\n          });\n\n          channel.on(\"link_request\", incoming => {\n            if (readyToSend) {\n              const data = { path: location.pathname };\n\n              // Copy profile data to link'ed device if it's been set.\n              if (this.store.state.activity.hasChangedName) {\n                data.profile = { ...this.store.state.profile };\n              }\n              data.credentials = { ...this.store.state.credentials };\n\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\n                ({ publicKeyString, encryptedData }) => {\n                  const payload = {\n                    target_session_id: incoming.reply_to_session_id,\n                    public_key: publicKeyString,\n                    data: encryptedData\n                  };\n\n                  if (!leftChannel) {\n                    channel.push(\"link_response\", payload);\n                  }\n\n                  leave();\n\n                  finished(\"used\");\n                  readyToSend = false;\n                }\n              );\n            }\n          });\n\n          channel.join().receive(\"error\", r => console.error(r));\n        };\n\n        step();\n      });\n    });\n  };\n\n  // Attempts to receive a link payload from a remote device using the given code.\n  //\n  // Promise rejects if the code is invalid or there is a problem with the channel.\n  // Promise resolves and passes payload of link source on successful link.\n  attemptLink = code => {\n    return new Promise((resolve, reject) => {\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n      let finished = false;\n\n      generateKeys().then(({ publicKeyString, privateKey }) => {\n        channel.on(\"presence_state\", state => {\n          const numOccupants = Object.keys(state).length;\n\n          if (numOccupants === 1) {\n            // Great, only sender is in topic, request link\n            channel.push(\"link_request\", {\n              reply_to_session_id: this.socket.params().session_id,\n              public_key: publicKeyString\n            });\n\n            setTimeout(() => {\n              if (finished) return;\n              channel.leave();\n              reject(new Error(\"no_response\"));\n            }, LINK_ACTION_TIMEOUT);\n          } else if (numOccupants === 0) {\n            // Nobody in this channel, probably a bad code.\n            channel.leave();\n            reject(new Error(\"failed\"));\n          } else {\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\n            channel.leave();\n            reject(new Error(\"in_use\"));\n          }\n        });\n\n        channel.on(\"link_response\", payload => {\n          finished = true;\n          channel.leave();\n\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\n        });\n\n        channel\n          .join()\n          .receive(\"ok\", data => (this.socket.params().session_id = data.session_id))\n          .receive(\"error\", r => console.error(r));\n      });\n    });\n  };\n}\n","import { isIOS as detectIOS } from \"./is-mobile\";\nconst isIOS = detectIOS();\n\n// TODO should we be using touch-action CSS for this?\nexport function disableiOSZoom() {\n  if (!isIOS) return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import { SHAPE, FIT } from \"three-ammo/constants\";\n\nfunction exceedsDensityThreshold(count, subtree) {\n  const bounds = subtree.boundingData;\n  const triangleThreshold = 1000;\n  const minimumVolume = 0.1;\n  const minimumTriangles = 100;\n  const dx = bounds[3] - bounds[0];\n  const dy = bounds[4] - bounds[1];\n  const dz = bounds[5] - bounds[2];\n  const volume = dx * dy * dz;\n\n  if (volume < minimumVolume) {\n    return false;\n  }\n\n  if (count < minimumTriangles) {\n    return false;\n  }\n\n  return count / volume > triangleThreshold;\n}\n\nfunction isHighDensity(subtree) {\n  if (subtree.continueGeneration) {\n    subtree.continueGeneration();\n  }\n  if (subtree.count) {\n    const result = exceedsDensityThreshold(subtree.count, subtree);\n    return result === true ? true : subtree.count;\n  } else {\n    const leftResult = isHighDensity(subtree.left);\n    if (leftResult === true) return true;\n    const rightResult = isHighDensity(subtree.right);\n    if (rightResult === true) return true;\n\n    const count = leftResult + rightResult;\n    const result = exceedsDensityThreshold(count, subtree);\n    return result === true ? true : count;\n  }\n}\n\nfunction isGeometryHighDensity(geo) {\n  const bvh = geo.boundsTree;\n  const roots = bvh._roots;\n  for (let i = 0; i < roots.length; ++i) {\n    return isHighDensity(roots[i]) === true;\n  }\n  return false;\n}\n\nexport const traverseMeshesAndAddShapes = (function() {\n  const shapePrefix = \"shape-helper__\";\n  const shapes = [];\n  return function(el) {\n    const meshRoot = el.object3DMap.mesh;\n    while (shapes.length > 0) {\n      const { id, entity } = shapes.pop();\n      entity.removeAttribute(id);\n    }\n\n    console.group(\"traverseMeshesAndAddShapes\");\n\n    if (document.querySelector([\"[shape-helper__trimesh]\", \"[shape-helper__heightfield]\"])) {\n      console.log(\"heightfield or trimesh found on scene\");\n    } else {\n      console.log(\"collision not found in scene\");\n\n      let isHighDensity = false;\n      meshRoot.traverse(o => {\n        if (\n          o.isMesh &&\n          (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\n          !o.name.startsWith(\"Floor_Plan\") &&\n          !o.name.startsWith(\"Ground_Plane\") &&\n          o.geometry.boundsTree\n        ) {\n          if (isGeometryHighDensity(o.geometry)) {\n            isHighDensity = true;\n            return;\n          }\n        }\n      });\n\n      let navMesh = null;\n\n      if (isHighDensity) {\n        console.log(\"mesh contains high triangle density region\");\n        navMesh = document.querySelector(\"[nav-mesh]\");\n      }\n\n      if (navMesh) {\n        console.log(`mesh density exceeded, using floor plan only`);\n        navMesh.setAttribute(shapePrefix + \"floorPlan\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL,\n          includeInvisible: true\n        });\n        shapes.push({ id: shapePrefix + \"floorPlan\", entity: navMesh });\n      } else if (!isHighDensity) {\n        el.setAttribute(shapePrefix + \"environment\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL\n        });\n        shapes.push({ id: shapePrefix + \"environment\", entity: el });\n        console.log(\"adding mesh shape for all visible meshes\");\n      } else {\n        el.setAttribute(shapePrefix + \"defaultFloor\", {\n          type: SHAPE.BOX,\n          margin: 0.01,\n          halfExtents: { x: 4000, y: 0.5, z: 4000 },\n          offset: { x: 0, y: -0.5, z: 0 },\n          fit: FIT.MANUAL\n        });\n        shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\n        console.log(\"adding default floor collision\");\n      }\n    }\n    console.groupEnd();\n  };\n})();\n","import { addComponent, removeComponent, defineQuery, hasComponent } from \"bitecs\";\nimport {\n  HoverButton,\n  HoveredHandLeft,\n  HoveredHandRight,\n  HoveredRemoteLeft,\n  HoveredRemoteRight,\n  Interacted,\n  SingleActionButton,\n  TextButton\n} from \"../bit-components\";\nimport { hasAnyComponent } from \"../utils/bit-utils\";\nimport { getThemeColor } from \"../utils/theme\";\nimport { CAMERA_MODE_INSPECT } from \"./camera-system\";\nimport { paths } from \"./userinput/paths\";\n\nfunction interact(world, entities, path, interactor) {\n  if (AFRAME.scenes[0].systems.userinput.get(path)) {\n    for (let i = 0; i < entities.length; i++) {\n      const eid = entities[i];\n      addComponent(world, Interacted, eid);\n\n      // TODO: New systems should not listen for this event\n      // Delete this when we're done interoping with old world systems\n      world.eid2obj.get(eid).dispatchEvent({\n        type: \"interact\",\n        object3D: interactor\n      });\n    }\n  }\n}\n\nconst interactedQuery = defineQuery([Interacted]);\nconst rightRemoteQuery = defineQuery([SingleActionButton, HoveredRemoteRight]);\nconst leftRemoteQuery = defineQuery([SingleActionButton, HoveredRemoteLeft]);\n\nfunction singleActionButtonSystem(world) {\n  // Clear the interactions from previous frames\n  const interactedEnts = interactedQuery(world);\n  for (let i = 0; i < interactedEnts.length; i++) {\n    const eid = interactedEnts[i];\n    removeComponent(world, Interacted, eid);\n  }\n\n  if (AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT) {\n    // TODO: Fix issue where button objects are \"visible\" but not on the inspect layer,\n    // which makes it so we can interact with them but cannot see them.\n    return;\n  }\n\n  const interactorSettings = AFRAME.scenes[0].systems.interaction.options;\n  interact(\n    world,\n    leftRemoteQuery(world),\n    paths.actions.cursor.left.grab,\n    interactorSettings.leftRemote.entity.object3D\n  );\n  interact(\n    world,\n    rightRemoteQuery(world),\n    paths.actions.cursor.right.grab,\n    interactorSettings.rightRemote.entity.object3D\n  );\n}\n\nexport const BUTTON_TYPES = {\n  DEFAULT: 0,\n  ACTION: 1\n};\n\nconst buttonStyles = {};\n// TODO these colors come from what we are doing in theme.js for aframe mixins but they seem fishy\nfunction applyTheme() {\n  buttonStyles[BUTTON_TYPES.DEFAULT] = {\n    color: new THREE.Color(0xffffff),\n    hoverColor: new THREE.Color(0xaaaaaa),\n    textColor: new THREE.Color(getThemeColor(\"action-color\")),\n    textHoverColor: new THREE.Color(getThemeColor(\"action-color-highlight\"))\n  };\n  buttonStyles[BUTTON_TYPES.ACTION] = {\n    color: new THREE.Color(getThemeColor(\"action-color\")),\n    hoverColor: new THREE.Color(getThemeColor(\"action-color-highlight\")),\n    textColor: new THREE.Color(0xffffff),\n    textHoverColor: new THREE.Color(0xffffff)\n  };\n}\nwindow.addEventListener(\"update_theme\", applyTheme);\napplyTheme();\n\nconst hoverComponents = [HoveredRemoteRight, HoveredRemoteLeft, HoveredHandRight, HoveredHandLeft];\n\nconst hoverButtonsQuery = defineQuery([HoverButton]);\nfunction hoverButtonSystem(world) {\n  hoverButtonsQuery(world).forEach(function(eid) {\n    const obj = world.eid2obj.get(eid);\n    const isHovered = hasAnyComponent(world, hoverComponents, eid);\n    const style = buttonStyles[HoverButton.type[eid]];\n    obj.material.color.copy(isHovered ? style.hoverColor : style.color);\n    if (hasComponent(world, TextButton, eid)) {\n      const lbl = world.eid2obj.get(TextButton.labelRef[eid]);\n      lbl.color = isHovered ? style.textHoverColor : style.textColor;\n    }\n  });\n}\n\nexport function buttonSystems(world) {\n  hoverButtonSystem(world);\n  singleActionButtonSystem(world);\n}\n","import { defineQuery, enterQuery, entityExists, exitQuery, hasComponent, Not } from \"bitecs\";\nimport { Object3DTag, Rigidbody, PhysicsShape, AEntity } from \"../bit-components\";\nimport { ACTIVATION_STATE, FIT, SHAPE } from \"three-ammo/constants\";\n// import { holdableButtonSystem } from \"./holdable-button-system\";\n\nconst rigidbodyQuery = defineQuery([Rigidbody, Object3DTag, Not(AEntity)]);\nconst rigidbodyEnteredQuery = enterQuery(rigidbodyQuery);\nconst rigidbodyExitedQuery = exitQuery(rigidbodyQuery);\nconst shapeExitQuery = exitQuery(defineQuery([PhysicsShape]));\n\nexport const RIGIDBODY_FLAGS = {\n  DISABLE_COLLISIONS: 1 << 0\n};\n\nexport const physicsCompatSystem = world => {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  const eids = rigidbodyEnteredQuery(world);\n  for (let i = 0; i < eids.length; i++) {\n    const eid = eids[i];\n\n    const obj = world.eid2obj.get(eid);\n\n    // TODO these are all hardcoded values, RigidBody should actually have (some of?) these properties\n    const bodyId = physicsSystem.addBody(obj, {\n      mass: 1,\n      gravity: { x: 0, y: Rigidbody.gravity[eid], z: 0 },\n      linearDamping: 0.01,\n      angularDamping: 0.01,\n      linearSleepingThreshold: 1.6,\n      angularSleepingThreshold: 2.5,\n      angularFactor: { x: 1, y: 1, z: 1 },\n      activationState: ACTIVATION_STATE.ACTIVE_TAG,\n      emitCollisionEvents: false,\n      scaleAutoUpdate: false,\n      type: \"kinematic\",\n      disableCollision: Rigidbody.flags[eid] & RIGIDBODY_FLAGS.DISABLE_COLLISIONS,\n      collisionFilterGroup: Rigidbody.collisionGroup[eid],\n      collisionFilterMask: Rigidbody.collisionMask[eid]\n    });\n    Rigidbody.bodyId[eid] = bodyId;\n\n    // TODO same deal for these, hardcoded, also we may want to support nested shapes\n    if (hasComponent(world, PhysicsShape, eid)) {\n      const halfExtents = PhysicsShape.halfExtents[eid];\n      PhysicsShape.bodyId[eid] = bodyId;\n      const shapeId = physicsSystem.addShapes(bodyId, obj, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        halfExtents: { x: halfExtents[0], y: halfExtents[1], z: halfExtents[2] },\n        margin: 0.01,\n        offset: { x: 0, y: 0, z: 0 },\n        orientation: { x: 0, y: 0, z: 0, w: 1 }\n      });\n      PhysicsShape.shapeId[eid] = shapeId;\n    }\n  }\n\n  {\n    const eids = shapeExitQuery(world);\n    for (let i = 0; i < eids.length; i++) {\n      const eid = eids[i];\n      physicsSystem.removeShapes(PhysicsShape.bodyId[eid], PhysicsShape.shapeId[eid]);\n    }\n  }\n\n  {\n    const eids = rigidbodyExitedQuery(world);\n    for (let i = 0; i < eids.length; i++) {\n      const eid = eids[i];\n      if (entityExists(world, eid) && hasComponent(world, PhysicsShape, eid)) {\n        physicsSystem.removeShapes(PhysicsShape.bodyId[eid], PhysicsShape.shapeId[eid]);\n        // The PhysicsShape is still on this entity!\n      }\n      physicsSystem.removeBody(Rigidbody.bodyId[eid]);\n    }\n  }\n\n  return world;\n};\n","import { addObject3DComponent } from \"../utils/jsx-entity\";\nimport { NetworkedMediaFrame, MediaFrame, Rigidbody, PhysicsShape, Networked } from \"../bit-components\";\nimport { addComponent, hasComponent } from \"bitecs\";\nimport { MediaType } from \"../utils/media-utils\";\nimport { COLLISION_LAYERS } from \"../constants\";\nimport { RIGIDBODY_FLAGS } from \"../systems/bit-physics\";\nimport { Layers } from \"../components/layers\";\n\nconst DEFAULTS = {\n  bounds: { x: 1, y: 1, z: 1 },\n  mediaType: \"all\"\n};\nexport function inflateMediaFrame(world, eid, componentProps) {\n  componentProps = Object.assign({}, DEFAULTS, componentProps);\n  const guide = new THREE.Mesh(\n    new THREE.BoxBufferGeometry(componentProps.bounds.x, componentProps.bounds.y, componentProps.bounds.z),\n    new THREE.ShaderMaterial({\n      uniforms: {\n        color: { value: new THREE.Color(0x2f80ed) }\n      },\n      vertexShader: `\n            varying vec2 vUv;\n            void main()\n            {\n              gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n              vUv = uv;\n            }\n          `,\n      fragmentShader: `\n            // adapted from https://www.shadertoy.com/view/Mlt3z8\n            float bayerDither2x2( vec2 v ) {\n              return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );\n            }\n            float bayerDither4x4( vec2 v ) {\n              vec2 P1 = mod( v, 2.0 );\n              vec2 P2 = mod( floor( 0.5  * v ), 2.0 );\n              return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );\n            }\n\n            varying vec2 vUv;\n            uniform vec3 color;\n            void main() {\n              float alpha = max(step(0.45, abs(vUv.x - 0.5)), step(0.45, abs(vUv.y - 0.5))) - 0.5;\n              if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;\n              gl_FragColor = vec4(color, 1.0);\n            }\n          `,\n      side: THREE.DoubleSide\n    })\n  );\n  guide.layers.set(Layers.CAMERA_LAYER_UI);\n  // TODO: This is a hack around the physics system addBody call requiring its body to have parent\n  guide.parent = new THREE.Group();\n  addObject3DComponent(world, eid, guide);\n  addComponent(world, MediaFrame, eid, true);\n  addComponent(world, NetworkedMediaFrame, eid, true);\n\n  if (!hasComponent(world, Networked, eid)) addComponent(world, Networked, eid);\n\n  MediaFrame.mediaType[eid] = {\n    all: MediaType.ALL,\n    \"all-2d\": MediaType.ALL_2D,\n    model: MediaType.MODEL,\n    image: MediaType.IMAGE,\n    video: MediaType.VIDEO,\n    pdf: MediaType.PDF\n  }[componentProps.mediaType];\n  MediaFrame.bounds[eid].set([componentProps.bounds.x, componentProps.bounds.y, componentProps.bounds.z]);\n\n  addComponent(world, Rigidbody, eid);\n  Rigidbody.collisionGroup[eid] = COLLISION_LAYERS.MEDIA_FRAMES;\n  Rigidbody.collisionMask[eid] = COLLISION_LAYERS.INTERACTABLES;\n  Rigidbody.flags[eid] = RIGIDBODY_FLAGS.DISABLE_COLLISIONS;\n  addComponent(world, PhysicsShape, eid);\n  PhysicsShape.halfExtents[eid].set([\n    componentProps.bounds.x / 2,\n    componentProps.bounds.y / 2,\n    componentProps.bounds.z / 2\n  ]);\n}\n","import { addComponent } from \"bitecs\";\nimport { Text as TroikaText } from \"troika-three-text\";\nimport { Text } from \"../bit-components\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\n\nconst THREE_SIDES = {\n  front: THREE.FrontSide,\n  back: THREE.BackSide,\n  double: THREE.DoubleSide\n};\n\nconst DEFAULTS = {\n  textAlign: \"center\",\n  anchorX: \"center\",\n  anchorY: \"middle\"\n};\n\nexport function inflateText(world, eid, componentProps) {\n  componentProps = Object.assign({}, DEFAULTS, componentProps);\n  addComponent(world, Text, eid);\n  const text = new TroikaText();\n  Object.entries(componentProps).forEach(([name, value]) => {\n    switch (name) {\n      case \"value\":\n        text.text = value;\n        break;\n      case \"side\":\n        text.material.side = THREE_SIDES[value];\n        break;\n      case \"opacity\":\n        text.material.side = value;\n        break;\n      case \"fontUrl\":\n        text.font = value;\n        break;\n      default:\n        text[name] = value;\n    }\n  });\n  text.sync();\n  addObject3DComponent(world, eid, text);\n}\n","import { addComponent, addEntity, hasComponent } from \"bitecs\";\nimport { preloadFont } from \"troika-three-text\";\nimport {\n  CameraTool,\n  CursorRaycastable,\n  DestroyAtExtremeDistance,\n  FloatyObject,\n  HandCollisionTarget,\n  Holdable,\n  HoldableButton,\n  HoverButton,\n  MakeKinematicOnRelease,\n  Networked,\n  NetworkedTransform,\n  Object3DTag,\n  OffersHandConstraint,\n  OffersRemoteConstraint,\n  PhysicsShape,\n  RemoteHoverTarget,\n  Rigidbody,\n  SingleActionButton,\n  TextButton\n} from \"../bit-components\";\nimport { inflateMediaFrame } from \"../inflators/media-frame\";\nimport { inflateModel } from \"../inflators/model\";\nimport { inflateSlice9 } from \"../inflators/slice9\";\nimport { inflateText } from \"../inflators/text\";\n\n// TODO we should do this in a more explicit spot for \"preloading\" during the loading screen\npreloadFont({ characters: \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_<()>[]|0123456789\" }, function() {});\n\nfunction isValidChild(child) {\n  if (child === undefined) {\n    console.warn(\"found undefined node\");\n    return false;\n  } else if (typeof child === \"string\") {\n    console.warn(\"found text node\", child);\n    return false;\n  }\n\n  return true;\n}\n\nconst reservedAttrs = [\"position\", \"rotation\", \"scale\", \"visible\", \"name\", \"layers\"];\n\nclass Ref {\n  constructor() {\n    this.current = null;\n  }\n}\nexport function createRef() {\n  return new Ref();\n}\nfunction resolveRef(world, ref) {\n  if (ref.current === null) {\n    ref.current = addEntity(world);\n  }\n  return ref.current;\n}\n\nexport function createElementEntity(tag, attrs, ...children) {\n  attrs = attrs || {};\n  if (typeof tag === \"function\") {\n    return tag(attrs, children);\n  } else if (tag === \"entity\") {\n    const outputAttrs = {};\n    const components = [];\n    let ref = null;\n\n    for (const attr in attrs) {\n      if (reservedAttrs.includes(attr)) {\n        outputAttrs[attr] = attrs[attr];\n      } else if (attr === \"ref\") {\n        ref = attrs[attr];\n      } else {\n        // if jsx transformed the attr into attr: true, change it to attr: {}.\n        components[attr] = attrs[attr] === true ? {} : attrs[attr];\n      }\n    }\n\n    return {\n      attrs: outputAttrs,\n      components,\n      children: children.flat().filter(isValidChild),\n      ref\n    };\n  } else {\n    throw new Error(\"invalid tag\", tag);\n  }\n}\n\nexport function addObject3DComponent(world, eid, obj) {\n  if (hasComponent(APP.world, Object3DTag, eid)) {\n    throw new Error(\"Tried to an object3D tag to an entity that already has one\");\n  }\n  addComponent(APP.world, Object3DTag, eid);\n  world.eid2obj.set(eid, obj);\n  obj.eid = eid;\n  return eid;\n}\n\n// TODO HACK gettting internal bitecs symbol, should expose an API to check a properties type\nconst $isEidType = Object.getOwnPropertySymbols(CameraTool.screenRef).find(s => s.description === \"isEidType\");\nconsole.log($isEidType);\n\nconst createDefaultInflator = (Component, defaults = {}) => {\n  return (world, eid, componentProps) => {\n    componentProps = Object.assign({}, defaults, componentProps);\n    addComponent(world, Component, eid, true);\n    Object.keys(componentProps).forEach(propName => {\n      const prop = Component[propName];\n      if (!prop) {\n        console.error(`${propName} is not a valid property of`, Component);\n        return;\n      }\n      const value = componentProps[propName];\n      prop[eid] = prop[$isEidType] ? resolveRef(world, value) : value;\n    });\n  };\n};\n\nconst inflators = {\n  \"cursor-raycastable\": createDefaultInflator(CursorRaycastable),\n  \"remote-hover-target\": createDefaultInflator(RemoteHoverTarget),\n  \"hand-collision-target\": createDefaultInflator(HandCollisionTarget),\n  \"offers-remote-constraint\": createDefaultInflator(OffersRemoteConstraint),\n  \"offers-hand-constraint\": createDefaultInflator(OffersHandConstraint),\n  \"single-action-button\": createDefaultInflator(SingleActionButton),\n  \"holdable-button\": createDefaultInflator(HoldableButton),\n  \"text-button\": createDefaultInflator(TextButton),\n  \"hover-button\": createDefaultInflator(HoverButton),\n  holdable: createDefaultInflator(Holdable),\n  rigidbody: createDefaultInflator(Rigidbody),\n  \"physics-shape\": createDefaultInflator(PhysicsShape),\n  \"floaty-object\": createDefaultInflator(FloatyObject),\n  \"make-kinematic-on-release\": createDefaultInflator(MakeKinematicOnRelease),\n  \"destroy-at-extreme-distance\": createDefaultInflator(DestroyAtExtremeDistance),\n  \"networked-transform\": createDefaultInflator(NetworkedTransform),\n  networked: createDefaultInflator(Networked),\n  \"camera-tool\": createDefaultInflator(CameraTool, { captureDurIdx: 1 }),\n\n  // inflators that create Object3Ds\n  \"media-frame\": inflateMediaFrame,\n  object3D: addObject3DComponent,\n  slice9: inflateSlice9,\n  text: inflateText,\n  model: inflateModel\n};\n\nexport function renderAsEntity(world, entityDef) {\n  const eid = entityDef.ref ? resolveRef(world, entityDef.ref) : addEntity(world);\n\n  Object.keys(entityDef.components).forEach(name => {\n    if (!inflators[name]) {\n      throw new Error(`Failed to inflate unknown component called ${name}`);\n    }\n\n    inflators[name](world, eid, entityDef.components[name]);\n  });\n\n  let obj = world.eid2obj.get(eid);\n  if (!obj) {\n    obj = new THREE.Group();\n    addObject3DComponent(world, eid, obj);\n  }\n\n  if (entityDef.attrs.position) {\n    obj.position.fromArray(entityDef.attrs.position);\n  }\n  if (entityDef.attrs.rotation) {\n    obj.rotation.fromArray(entityDef.attrs.rotation);\n  }\n  if (entityDef.attrs.scale) {\n    obj.scale.fromArray(entityDef.attrs.scale);\n  }\n  if (entityDef.attrs.name) {\n    obj.name = entityDef.attrs.name;\n  }\n  if (entityDef.attrs.layers !== undefined) {\n    obj.layers.mask = entityDef.attrs.layers;\n  }\n  if (entityDef.attrs.visible !== undefined) {\n    obj.visible = entityDef.attrs.visible;\n  }\n  entityDef.children.forEach(child => {\n    if (child.type === \"a-entity\") {\n      throw new Error(\"a-entity can only be children of a-entity\");\n    } else {\n      const childEid = renderAsEntity(world, child);\n      obj.add(world.eid2obj.get(childEid));\n    }\n  });\n  return eid;\n}\n","import { addComponent } from \"bitecs\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\nimport { Slice9 } from \"../bit-components\";\nimport { updateSlice9Geometry } from \"../update-slice9-geometry\";\n\nexport function inflateSlice9(world, eid, { size, insets, texture }) {\n  const geometry = new THREE.PlaneBufferGeometry(1, 1, 3, 3);\n  const material = new THREE.MeshBasicMaterial({ map: texture, transparent: true, toneMapped: false });\n  const obj = new THREE.Mesh(geometry, material);\n  addObject3DComponent(world, eid, obj);\n\n  addComponent(world, Slice9, eid);\n  Slice9.insets[eid].set(insets);\n  Slice9.size[eid].set(size);\n  updateSlice9Geometry(world, eid);\n}\n","import { Slice9 } from \"./bit-components\";\n\nexport function updateSlice9Geometry(world, eid) {\n  const geometry = world.eid2obj.get(eid).geometry;\n  const pos = geometry.attributes.position.array;\n  const uvs = geometry.attributes.uv.array;\n\n  const [width, height] = Slice9.size[eid];\n  const [top, bottom, left, right] = Slice9.insets[eid];\n\n  /*\n      0--1------------------------------2--3\n      |  |                              |  |\n      4--5------------------------------6--7\n      |  |                              |  |\n      |  |                              |  |\n      |  |                              |  |\n      8--9-----------------------------10--11\n      |  |                              |  |\n      12-13----------------------------14--15\n    */\n  function setPos(id, x, y) {\n    pos[3 * id] = x;\n    pos[3 * id + 1] = y;\n  }\n\n  function setUV(id, u, v) {\n    uvs[2 * id] = u;\n    uvs[2 * id + 1] = v;\n  }\n\n  // Update UVS\n  // TODO hardcoded\n  const textureHeight = 128;\n  const textureWidth = 128;\n\n  const uv = {\n    left: left / textureWidth,\n    right: right / textureWidth,\n    top: top / textureHeight,\n    bottom: bottom / textureHeight\n  };\n\n  setUV(1, uv.left, 1);\n  setUV(2, uv.right, 1);\n\n  setUV(4, 0, uv.bottom);\n  setUV(5, uv.left, uv.bottom);\n  setUV(6, uv.right, uv.bottom);\n  setUV(7, 1, uv.bottom);\n\n  setUV(8, 0, uv.top);\n  setUV(9, uv.left, uv.top);\n  setUV(10, uv.right, uv.top);\n  setUV(11, 1, uv.top);\n\n  setUV(13, uv.left, 0);\n  setUV(14, uv.right, 0);\n\n  // Update vertex positions\n  const w2 = width / 2;\n  const h2 = height / 2;\n  const leftPadded = -w2 + 0.1;\n  const rightPadded = w2 - 0.1;\n  const topPadded = h2 - 0.1;\n  const bottomPadded = -h2 + 0.1;\n\n  setPos(0, -w2, h2);\n  setPos(1, leftPadded, h2);\n  setPos(2, rightPadded, h2);\n  setPos(3, w2, h2);\n\n  setPos(4, -w2, topPadded);\n  setPos(5, leftPadded, topPadded);\n  setPos(6, rightPadded, topPadded);\n  setPos(7, w2, topPadded);\n\n  setPos(8, -w2, bottomPadded);\n  setPos(9, leftPadded, bottomPadded);\n  setPos(10, rightPadded, bottomPadded);\n  setPos(11, w2, bottomPadded);\n\n  setPos(13, leftPadded, -h2);\n  setPos(14, rightPadded, -h2);\n  setPos(12, -w2, -h2);\n  setPos(15, w2, -h2);\n\n  geometry.attributes.position.needsUpdate = true;\n  geometry.attributes.uv.needsUpdate = true;\n}\n","import { addComponent, addEntity } from \"bitecs\";\nimport { GLTFModel } from \"../bit-components\";\nimport { loadModel } from \"../components/gltf-model-plus\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\n\nexport function inflateModel(world, eid, { src }) {\n  const obj = new THREE.Group();\n  addObject3DComponent(world, eid, obj);\n  loadModel(src, null, true).then(gltf => {\n    // TODO inflating components and create animation mixers\n    const modelEid = addEntity(world);\n    addObject3DComponent(world, modelEid, gltf.scene);\n    addComponent(world, GLTFModel, modelEid);\n    gltf.scene.userData.gltfSrc = src;\n    obj.add(gltf.scene);\n  });\n}\n","/** @jsx createElementEntity */\n\nimport cameraModelSrc from \"../assets/camera_tool.glb\";\nimport buttonSrc from \"../assets/hud/button.9.png\";\nimport { loadModel } from \"../components/gltf-model-plus\";\nimport { Layers } from \"../components/layers\";\nimport { COLLISION_LAYERS } from \"../constants\";\nimport { BUTTON_TYPES } from \"../systems/single-action-button-system\";\nimport { createElementEntity, createRef } from \"../utils/jsx-entity\";\nimport { textureLoader } from \"../utils/media-utils\";\n\nconst buttonTexture = textureLoader.load(buttonSrc);\n\n// eslint-disable-next-line react/prop-types\nfunction Button({ text, width, height, texture = buttonTexture, type = BUTTON_TYPES.DEFAULT, ...props }) {\n  const labelRef = createRef();\n  return (\n    <entity\n      name=\"Button\"\n      slice9={{ size: [width, height], insets: [64, 66, 64, 66], texture }}\n      cursor-raycastable\n      remote-hover-target\n      hover-button={{ type }}\n      text-button={{ labelRef }}\n      single-action-button\n      layers={1 << Layers.CAMERA_LAYER_UI}\n      {...props}\n    >\n      <entity\n        ref={labelRef}\n        layers={1 << Layers.CAMERA_LAYER_UI}\n        text={{ value: text, color: \"#000000\", textAlign: \"center\", anchorX: \"center\", anchorY: \"middle\" }}\n        position={[0, 0, 0.01]}\n      />\n    </entity>\n  );\n}\n\n// eslint-disable-next-line react/prop-types\nfunction Label({ text, ...props }, ...children) {\n  const value = children.join(\"\\n\");\n  return <entity name=\"Label\" text={{ value, ...text }} layers={1 << Layers.CAMERA_LAYER_UI} {...props} />;\n}\n\nconst RENDER_WIDTH = 1280;\nconst RENDER_HEIGHT = 720;\n\n// Pre load and upload camera model, and intentionally never \"release\" it from the cache.\n// TODO we should do this in a more explicit spot for \"preloading\" during the loading screen\nloadModel(cameraModelSrc, null, true);\n\nexport function CameraPrefab() {\n  const snapMenuRef = createRef();\n\n  const snapRef = createRef();\n  const cancelRef = createRef();\n  const recVideoRef = createRef();\n  const button_next = createRef();\n  const button_prev = createRef();\n  const sndToggleRef = createRef();\n\n  const countdownLblRef = createRef();\n  const captureDurLblRef = createRef();\n\n  const screenRef = createRef();\n  const selfieScreenRef = createRef();\n\n  const screenMaterial = new THREE.MeshBasicMaterial({ toneMapped: false });\n\n  const width = 0.28;\n  const aspect = 1280 / 720;\n  const screenGeometry = new THREE.PlaneBufferGeometry(width, width / aspect);\n\n  const cameraRef = createRef();\n  const camera = new THREE.PerspectiveCamera(50, RENDER_WIDTH / RENDER_HEIGHT, 0.1, 30000);\n\n  camera.layers.enable(Layers.CAMERA_LAYER_VIDEO_TEXTURE_TARGET);\n  camera.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n\n  const buttonHeight = 0.2;\n  const buttonScale = [0.4, 0.4, 0.4];\n  const smallButtonScale = [0.2, 0.2, 0.2];\n\n  const uiZ = 0.1;\n\n  return (\n    <entity\n      name=\"Camera Tool\"\n      networked\n      networked-transform\n      cursor-raycastable\n      remote-hover-target\n      hand-collision-target\n      offers-remote-constraint\n      offers-hand-constraint\n      make-kinematic-on-release\n      holdable\n      rigidbody={{ collisionGroup: COLLISION_LAYERS.INTERACTABLES, collisionMask: COLLISION_LAYERS.HANDS }}\n      physics-shape={{ halfExtents: [0.22, 0.14, 0.1] }}\n      camera-tool={{\n        snapRef,\n        cancelRef,\n        button_next,\n        button_prev,\n        screenRef,\n        selfieScreenRef,\n        cameraRef,\n        countdownLblRef,\n        captureDurLblRef,\n        recVideoRef,\n        snapMenuRef,\n        sndToggleRef\n      }}\n    >\n      <entity\n        name=\"Screen\"\n        object3D={new THREE.Mesh(screenGeometry, screenMaterial)}\n        ref={screenRef}\n        position={[0, 0, -0.042]}\n        rotation={[0, Math.PI, 0]}\n      />\n      <entity\n        name=\"Selfie Screen\"\n        ref={selfieScreenRef}\n        object3D={new THREE.Mesh(screenGeometry, screenMaterial)}\n        position={[0, 0.4, 0]}\n        scale={[-2, 2, 2]}\n      />\n\n      <entity name=\"Camera Model\" model={{ src: cameraModelSrc }} scale={[2, 2, 2]} />\n\n      <entity ref={cameraRef} object3D={camera} position={[0, 0, 0.05]} rotation={[0, Math.PI, 0]} />\n\n      <entity name=\"Snap Menu\" ref={snapMenuRef}>\n        <Label ref={countdownLblRef} position={[0, 0, uiZ + 0.002]} />\n        <Label ref={captureDurLblRef} position={[0, 0, uiZ + 0.002]} />\n\n        <Button\n          ref={cancelRef}\n          scale={buttonScale}\n          position={[0, 0.1, uiZ]}\n          width={0.4}\n          height={buttonHeight}\n          text={\"Cancel\"}\n        />\n        <Button\n          ref={snapRef}\n          scale={buttonScale}\n          position={[0, 0.1, uiZ]}\n          width={0.4}\n          height={buttonHeight}\n          type={BUTTON_TYPES.ACTION}\n          text={\"Photo\"}\n        />\n\n        <Button\n          ref={button_prev}\n          scale={smallButtonScale}\n          position={[-0.082, 0, uiZ]}\n          width={buttonHeight}\n          height={buttonHeight}\n          text={\"<\"}\n        />\n        <Button\n          ref={recVideoRef}\n          scale={buttonScale}\n          position={[0, -0.1, uiZ]}\n          width={0.4}\n          height={buttonHeight}\n          type={BUTTON_TYPES.ACTION}\n          text={\"Video\"}\n        />\n        <Button\n          ref={button_next}\n          scale={smallButtonScale}\n          position={[0.082, 0, uiZ]}\n          width={buttonHeight}\n          height={buttonHeight}\n          text={\">\"}\n        />\n\n        <Button\n          ref={sndToggleRef}\n          scale={smallButtonScale}\n          position={[0, -0.17, uiZ]}\n          width={0.6}\n          height={buttonHeight}\n          text={\"Sound OFF\"}\n        />\n      </entity>\n    </entity>\n  );\n}\n\nexport function CubeMediaFramePrefab() {\n  return (\n    <entity\n      name=\"Media Frame\"\n      networked\n      networked-transform\n      cursor-raycastable\n      remote-hover-target\n      hand-collision-target\n      offers-remote-constraint\n      offers-hand-constraint\n      floaty-object\n      destroy-at-extreme-distance\n      holdable\n      rigidbody={{\n        gravity: -9.8,\n        collisionGroup: COLLISION_LAYERS.INTERACTABLES,\n        collisionMask:\n          COLLISION_LAYERS.HANDS |\n          COLLISION_LAYERS.ENVIRONMENT |\n          COLLISION_LAYERS.INTERACTABLES |\n          COLLISION_LAYERS.AVATAR\n      }}\n      physics-shape={{ halfExtents: [0.5, 0.5, 0.5] }}\n      object3D={new THREE.Mesh(new THREE.BoxBufferGeometry(), new THREE.MeshStandardMaterial())}\n    >\n      <entity media-frame position={[0, 1, 0]} />\n    </entity>\n  );\n}\n","import { addComponent, defineQuery, enterQuery, exitQuery, hasComponent, removeComponent, removeEntity } from \"bitecs\";\nimport { AEntity, Networked, NetworkedMediaFrame, NetworkedTransform, Owned } from \"../bit-components\";\nimport { CameraPrefab, CubeMediaFramePrefab } from \"../network-prefabs/camera-tool\";\nimport { defineNetworkSchema } from \"../utils/bit-utils\";\nimport { renderAsEntity } from \"../utils/jsx-entity\";\n\nconst prefabs = new Map(\n  Object.entries({\n    camera: {\n      permission: \"spawn_camera\",\n      template: CameraPrefab\n    },\n    cube: {\n      template: CubeMediaFramePrefab\n    }\n  })\n);\n\nexport function takeOwnership(world, eid) {\n  // TODO we do this to have a single API for taking ownership of things in new code, but it obviously relies on NAF/AFrame\n  if (hasComponent(world, AEntity, eid)) {\n    const el = world.eid2obj.get(eid).el;\n    !NAF.utils.isMine(el) && NAF.utils.takeOwnership(el);\n  } else {\n    addComponent(world, Owned, eid);\n    Networked.lastOwnerTime[eid] = Math.max(NAF.connection.getServerTime(), Networked.lastOwnerTime[eid] + 1);\n    Networked.owner[eid] = APP.getSid(NAF.clientId);\n  }\n}\n\nconst createMessageDatas = new Map();\n\nexport function createNetworkedEntityFromRemote(world, prefabName, initialData, rootNid, creator, owner) {\n  const eid = renderAsEntity(world, prefabs.get(prefabName).template(initialData));\n  const obj = world.eid2obj.get(eid);\n\n  createMessageDatas.set(eid, { prefabName, initialData });\n\n  let i = 0;\n  obj.traverse(function(o) {\n    if (o.eid && hasComponent(world, Networked, o.eid)) {\n      const eid = o.eid;\n      Networked.id[eid] = APP.getSid(i === 0 ? rootNid : `${rootNid}.${i}`);\n      APP.world.nid2eid.set(Networked.id[eid], eid);\n      Networked.creator[eid] = APP.getSid(creator);\n      Networked.owner[eid] = APP.getSid(owner);\n      if (NAF.clientId === creator) takeOwnership(world, eid);\n      i += 1;\n    }\n  });\n\n  AFRAME.scenes[0].object3D.add(obj);\n  return eid;\n}\n\nfunction spawnAllowed(creator, prefabName) {\n  const perm = prefabs.get(prefabName).permission;\n  return !perm || APP.hubChannel.userCan(creator, perm);\n}\n\nexport function createNetworkedEntity(world, prefabName, initialData) {\n  if (!spawnAllowed(NAF.clientId, prefabName)) throw new Error(`You do not have permission to spawn ${prefabName}`);\n  const rootNid = NAF.utils.createNetworkId();\n  return createNetworkedEntityFromRemote(world, prefabName, initialData, rootNid, NAF.clientId, NAF.clientId);\n}\n\nconst networkedObjectsQuery = defineQuery([Networked]);\nconst ownedNetworkObjectsQuery = defineQuery([Networked, Owned]);\n\nconst schemas = new Map([\n  [NetworkedMediaFrame, defineNetworkSchema(NetworkedMediaFrame)],\n  [NetworkedTransform, defineNetworkSchema(NetworkedTransform)]\n]);\nconst networkableComponents = Array.from(schemas.keys());\n\nconst pendingMessages = [];\nconst pendingJoins = [];\nconst pendingParts = [];\n\n// TODO messaging, joining, and leaving should not be using NAF\nNAF.connection.subscribeToDataChannel(\"nn\", function(fromClientId, _dataType, data) {\n  data.fromClientId = fromClientId;\n  pendingMessages.push(data);\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  document.body.addEventListener(\"clientConnected\", function({ detail: { clientId } }) {\n    console.log(\"client joined\", clientId);\n    pendingJoins.push(APP.getSid(clientId));\n  });\n  document.body.addEventListener(\"clientDisconnected\", function({ detail: { clientId } }) {\n    console.log(\"client left\", clientId);\n    pendingParts.push(APP.getSid(clientId));\n  });\n});\n\nfunction messageFor(world, created, updated, deleted, isFullSync) {\n  const message = {\n    creates: [],\n    updates: [],\n    deletes: []\n  };\n\n  created.forEach(eid => {\n    const { prefabName, initialData } = createMessageDatas.get(eid);\n    message.creates.push([APP.getString(Networked.id[eid]), prefabName, initialData]);\n  });\n\n  updated.forEach(eid => {\n    const updateMessage = {\n      nid: APP.getString(Networked.id[eid]),\n      lastOwnerTime: Networked.lastOwnerTime[eid],\n      owner: APP.getString(Networked.owner[eid]), // This should always be NAF.clientId. If it's not, something bad happened\n      creator: APP.getString(Networked.creator[eid]),\n      componentIds: [],\n      data: []\n    };\n\n    for (let j = 0; j < networkableComponents.length; j++) {\n      const Component = networkableComponents[j];\n      if (hasComponent(world, Component, eid)) {\n        if (schemas.get(Component).serialize(world, eid, updateMessage.data, isFullSync)) {\n          updateMessage.componentIds.push(j);\n        }\n      }\n    }\n\n    // TODO: If the owner/lastOwnerTime changed, we need to send this updateMessage\n    if (updateMessage.componentIds.length) {\n      message.updates.push(updateMessage);\n    }\n  });\n\n  deleted.forEach(eid => {\n    // TODO: We are reading component data of a deleted entity here.\n    const nid = Networked.id[eid];\n    message.deletes.push(APP.getString(nid));\n  });\n\n  if (message.creates.length || message.updates.length || message.deletes.length) {\n    return message;\n  }\n\n  return null;\n}\n\nfunction isNetworkInstantiated(eid) {\n  return createMessageDatas.has(eid);\n}\n\nfunction isNetworkInstantiatedByMe(eid) {\n  return isNetworkInstantiated(eid) && Networked.creator[eid] === APP.getSid(NAF.clientId);\n}\n\nconst pendingUpdatesForNid = new Map();\n\nconst rcvEnteredNetworkedObjectsQuery = enterQuery(defineQuery([Networked]));\nexport function networkReceiveSystem(world) {\n  // When a user leaves:\n  // - locally delete all the entities that user network instantiated\n  // - everyone attempts to take ownership of any objects that user owned\n  {\n    const networkedObjects = networkedObjectsQuery(world);\n    pendingParts.forEach(partingClientId => {\n      networkedObjects\n        .filter(eid => isNetworkInstantiated(eid) && Networked.creator[eid] === partingClientId)\n        .forEach(eid => removeEntity(world, eid));\n\n      // ignore entities the parting user created as they were just deleted\n      networkedObjects\n        .filter(eid => Networked.owner[eid] === partingClientId && Networked.creator[eid] !== partingClientId)\n        .forEach(eid => takeOwnership(world, eid));\n    });\n    pendingParts.length = 0;\n  }\n\n  // If we were hanging onto updates for any newly created non network instantiated entities\n  // we can now apply them. Network instantiated entities are handled when processing creates.\n  rcvEnteredNetworkedObjectsQuery(world).forEach(eid => {\n    const nid = Networked.id[eid];\n    if (pendingUpdatesForNid.has(nid)) {\n      console.log(\"had pending updates for\", APP.getString(nid), pendingUpdatesForNid.get(nid));\n      pendingMessages.unshift({ creates: [], updates: pendingUpdatesForNid.get(nid), deletes: [] });\n      pendingUpdatesForNid.delete(nid);\n    }\n  });\n\n  for (let i = 0; i < pendingMessages.length; i++) {\n    const message = pendingMessages[i];\n\n    for (let j = 0; j < message.creates.length; j++) {\n      const [nidString, prefabName, initialData] = message.creates[j];\n      const creator = message.fromClientId;\n\n      const nid = APP.getSid(nidString);\n\n      if (world.deletedNids.has(nid)) {\n        // TODO we may need to allow this for reconnects\n        console.log(`Received a create message for an object I've already deleted. Skipping ${nidString}`);\n      } else if (world.nid2eid.has(nid)) {\n        console.log(`Received create message for object I already created. Skipping ${nidString}`);\n      } else if (!spawnAllowed(creator, prefabName)) {\n        // this should only ever happen if there is a bug or the sender is maliciously modified\n        console.log(`Received create from a user who does not have permission to spawn ${prefabName}`);\n        world.ignoredNids.add(nid); // TODO should we just use deletedNids for this?\n      } else {\n        const eid = createNetworkedEntityFromRemote(world, prefabName, initialData, nidString, creator, creator);\n        console.log(\"got create message for\", nidString, eid);\n\n        // If we were hanging onto updates for this nid we can now apply them. And they should be processed before other updates.\n        if (pendingUpdatesForNid.has(nid)) {\n          console.log(\"had pending updates for\", nidString, pendingUpdatesForNid.get(nid));\n          Array.prototype.unshift.apply(message.updates, pendingUpdatesForNid.get(nid));\n          pendingUpdatesForNid.delete(nid);\n        }\n      }\n    }\n\n    for (let j = 0; j < message.updates.length; j++) {\n      const updateMessage = message.updates[j];\n      const nid = APP.getSid(updateMessage.nid);\n\n      if (world.ignoredNids.has(nid)) {\n        console.log(`Ignoring update for ignored entity ${updateMessage.nid}`);\n        continue;\n      }\n\n      if (world.deletedNids.has(nid)) {\n        console.log(`Ignoring update for deleted entity ${updateMessage.nid}`);\n        continue;\n      }\n\n      if (!world.nid2eid.has(nid)) {\n        console.log(`Holding onto an update for ${updateMessage.nid} because we don't have it yet.`);\n        // TODO: What if we will NEVER be able to apply this update?\n        // TODO would be nice if we could squash these updates\n        const updates = pendingUpdatesForNid.get(nid) || [];\n        updates.push(updateMessage);\n        pendingUpdatesForNid.set(nid, updates);\n        console.log(pendingUpdatesForNid);\n        continue;\n      }\n\n      const eid = world.nid2eid.get(nid);\n\n      if (\n        Networked.lastOwnerTime[eid] > updateMessage.lastOwnerTime ||\n        (Networked.lastOwnerTime[eid] === updateMessage.lastOwnerTime &&\n          APP.getString(Networked.owner[eid]) < updateMessage.owner) // arbitrary (but consistent) tiebreak\n      ) {\n        console.log(\n          \"Received update from an old owner, skipping\",\n          updateMessage.nid,\n          Networked.lastOwnerTime[eid],\n          updateMessage.lastOwnerTime\n        );\n        continue;\n      }\n\n      if (hasComponent(world, Owned, eid)) {\n        if (updateMessage.owner === NAF.clientId) {\n          // TODO: Should it be valid that we can receive a message where we are told we are the owner now?\n          console.error(\"Got a message telling us we are the owner.\");\n        } else {\n          console.log(\"Lost ownership: \", updateMessage.nid);\n          removeComponent(world, Owned, eid);\n        }\n      }\n\n      Networked.lastOwnerTime[eid] = updateMessage.lastOwnerTime;\n      Networked.creator[eid] = APP.getSid(updateMessage.creator);\n      Networked.owner[eid] = APP.getSid(updateMessage.owner);\n\n      // TODO HACK simulating a buffer with a cursor using an array\n      updateMessage.data.cursor = 0;\n      for (let s = 0; s < updateMessage.componentIds.length; s++) {\n        const componentId = updateMessage.componentIds[s];\n        const schema = schemas.get(networkableComponents[componentId]);\n        schema.deserialize(world, eid, updateMessage.data);\n      }\n      delete updateMessage.data.cursor;\n    }\n\n    for (let j = 0; j < message.deletes.length; j += 1) {\n      const nid = APP.getSid(message.deletes[j]);\n      if (world.deletedNids.has(nid)) continue;\n\n      world.deletedNids.add(nid);\n      const eid = world.nid2eid.get(nid);\n      createMessageDatas.delete(eid);\n      world.nid2eid.delete(nid);\n      removeEntity(world, eid);\n\n      console.log(\"OK, deleting \", APP.getString(nid));\n    }\n  }\n\n  pendingMessages.length = 0;\n\n  // TODO If there's a scene owned object, we should take ownership of it\n}\n\nconst TICK_RATE = 1000 / 12;\nlet nextNetworkTick = 0;\n\nconst sendEnteredNetworkedObjectsQuery = enterQuery(networkedObjectsQuery);\nconst sendExitedNetworkedObjectsQuery = exitQuery(networkedObjectsQuery);\n\nexport function networkSendSystem(world) {\n  if (performance.now() < nextNetworkTick) return;\n  nextNetworkTick = performance.now() + TICK_RATE;\n\n  // Tell joining users about objects I network instantiated, and full updates for objects I own\n  {\n    if (pendingJoins.length) {\n      const message = messageFor(\n        world,\n        networkedObjectsQuery(world).filter(isNetworkInstantiatedByMe),\n        ownedNetworkObjectsQuery(world),\n        [],\n        true\n      );\n      if (message) {\n        pendingJoins.forEach(clientId => NAF.connection.sendDataGuaranteed(APP.getString(clientId), \"nn\", message));\n      }\n      pendingJoins.length = 0;\n    }\n  }\n\n  // Tell everyone about objects I created, objects I own, and objects that were deleted\n  {\n    const created = sendEnteredNetworkedObjectsQuery(world).filter(isNetworkInstantiatedByMe);\n    // TODO: Lots of people will send delete messages about the same object\n    const deleted = sendExitedNetworkedObjectsQuery(world).filter(eid => {\n      return !world.deletedNids.has(Networked.id[eid]) && isNetworkInstantiated(eid);\n    });\n\n    const message = messageFor(world, created, ownedNetworkObjectsQuery(world), deleted, false);\n    if (message) NAF.connection.broadcastDataGuaranteed(\"nn\", message);\n\n    deleted.forEach(eid => {\n      createMessageDatas.delete(eid);\n      world.deletedNids.add(Networked.id[eid]);\n      world.nid2eid.delete(Networked.id[eid]);\n    });\n  }\n}\n\n// TODO: Handle reconnect\n// TODO: Handle blocking/unblocking. Does this already work?\n","import \"./utils/configs\";\nimport { getAbsoluteHref } from \"./utils/media-url-utils\";\nimport { isValidSceneUrl } from \"./utils/scene-url-utils\";\nimport { spawnChatMessage } from \"./react-components/chat-message\";\nimport { SOUND_CHAT_MESSAGE, SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"./systems/sound-effects-system\";\nimport ducky from \"./assets/models/DuckyMesh.glb\";\nimport { EventTarget } from \"event-target-shim\";\nimport { ExitReason } from \"./react-components/room/ExitedRoomScreen\";\nimport { LogMessageType } from \"./react-components/room/ChatSidebar\";\nimport { createNetworkedEntity } from \"./systems/netcode\";\n\nlet uiRoot;\n// Handles user-entered messages\nexport default class MessageDispatch extends EventTarget {\n  constructor(scene, entryManager, hubChannel, remountUI, mediaSearchStore) {\n    super();\n    this.scene = scene;\n    this.entryManager = entryManager;\n    this.hubChannel = hubChannel;\n    this.remountUI = remountUI;\n    this.mediaSearchStore = mediaSearchStore;\n    this.presenceLogEntries = [];\n  }\n\n  addToPresenceLog(entry) {\n    entry.key = Date.now().toString();\n\n    this.presenceLogEntries.push(entry);\n    this.remountUI({ presenceLogEntries: this.presenceLogEntries });\n    if (entry.type === \"chat\" && this.scene.is(\"loaded\")) {\n      this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CHAT_MESSAGE);\n    }\n\n    // Fade out and then remove\n    setTimeout(() => {\n      entry.expired = true;\n      this.remountUI({ presenceLogEntries: this.presenceLogEntries });\n\n      setTimeout(() => {\n        this.presenceLogEntries.splice(this.presenceLogEntries.indexOf(entry), 1);\n        this.remountUI({ presenceLogEntries: this.presenceLogEntries });\n      }, 5000);\n    }, 20000);\n  }\n\n  receive(message) {\n    this.addToPresenceLog(message);\n    this.dispatchEvent(new CustomEvent(\"message\", { detail: message }));\n  }\n\n  log = (messageType, props) => {\n    this.receive({ type: \"log\", messageType, props });\n  };\n\n  dispatch = message => {\n    if (message.startsWith(\"/\")) {\n      const commandParts = message.substring(1).split(/\\s+/);\n      this.dispatchCommand(commandParts[0], ...commandParts.slice(1));\n      document.activeElement.blur(); // Commands should blur\n    } else {\n      this.hubChannel.sendMessage(message);\n    }\n  };\n\n  dispatchCommand = async (command, ...args) => {\n    const entered = this.scene.is(\"entered\");\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n\n    // TODO: Some of the commands below should be available without requiring room entry.\n    if (!entered && (!isGhost || command === \"duck\")) {\n      this.log(LogMessageType.roomEntryRequired);\n      return;\n    }\n\n    const avatarRig = document.querySelector(\"#avatar-rig\");\n    const scales = [0.0625, 0.125, 0.25, 0.5, 1.0, 1.5, 3, 5, 7.5, 12.5];\n    const curScale = avatarRig.object3D.scale;\n    let err;\n    let physicsSystem;\n    const captureSystem = this.scene.systems[\"capture-system\"];\n\n    switch (command) {\n      case \"fly\":\n        if (this.scene.systems[\"hubs-systems\"].characterController.fly) {\n          this.scene.systems[\"hubs-systems\"].characterController.enableFly(false);\n          this.log(LogMessageType.flyModeDisabled);\n        } else {\n          if (this.scene.systems[\"hubs-systems\"].characterController.enableFly(true)) {\n            this.log(LogMessageType.flyModeEnabled);\n          }\n        }\n        break;\n      case \"grow\":\n        for (let i = 0; i < scales.length; i++) {\n          if (scales[i] > curScale.x) {\n            avatarRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            avatarRig.object3D.matrixNeedsUpdate = true;\n            break;\n          }\n        }\n\n        break;\n      case \"shrink\":\n        for (let i = scales.length - 1; i >= 0; i--) {\n          if (curScale.x > scales[i]) {\n            avatarRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            avatarRig.object3D.matrixNeedsUpdate = true;\n            break;\n          }\n        }\n\n        break;\n      case \"leave\":\n        this.entryManager.exitScene();\n        this.remountUI({ roomUnavailableReason: ExitReason.left });\n        break;\n      case \"duck\":\n        spawnChatMessage(getAbsoluteHref(location.href, ducky));\n        if (Math.random() < 0.01) {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n        } else {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n        }\n        break;\n      case \"cube\": {\n        const avatarPov = document.querySelector(\"#avatar-pov-node\").object3D;\n        const eid = createNetworkedEntity(APP.world, \"cube\");\n        const obj = APP.world.eid2obj.get(eid);\n        obj.position.copy(avatarPov.localToWorld(new THREE.Vector3(0, 0, -1.5)));\n        obj.lookAt(avatarPov.getWorldPosition(new THREE.Vector3()));\n        break;\n      }\n      case \"debug\":\n        physicsSystem = document.querySelector(\"a-scene\").systems[\"hubs-systems\"].physicsSystem;\n        physicsSystem.setDebug(!physicsSystem.debugEnabled);\n        break;\n      case \"vrstats\":\n        document.getElementById(\"stats\").components[\"stats-plus\"].toggleVRStats();\n        break;\n      case \"scene\":\n        if (args[0]) {\n          if (await isValidSceneUrl(args[0])) {\n            err = this.hubChannel.updateScene(args[0]);\n            if (err === \"unauthorized\") {\n              this.log(LogMessageType.unauthorizedSceneChange);\n            }\n          } else {\n            this.log(LogMessageType.inalidSceneUrl);\n          }\n        } else if (this.hubChannel.canOrWillIfCreator(\"update_hub\")) {\n          this.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\", \"use\");\n        }\n\n        break;\n      case \"rename\":\n        err = this.hubChannel.rename(args.join(\" \"));\n        if (err === \"unauthorized\") {\n          this.log(LogMessageType.unauthorizedRoomRename);\n        }\n        break;\n      case \"capture\":\n        if (!captureSystem.available()) {\n          this.log(LogMessageType.captureUnavailable);\n          break;\n        }\n        if (args[0] === \"stop\") {\n          if (captureSystem.started()) {\n            captureSystem.stop();\n            this.log(LogMessageType.captureStopped);\n          } else {\n            this.log(LogMessageType.captureAlreadyStopped);\n          }\n        } else {\n          if (captureSystem.started()) {\n            this.log(LogMessageType.captureAlreadyRunning);\n          } else {\n            captureSystem.start();\n            this.log(LogMessageType.captureStarted);\n          }\n        }\n        break;\n      case \"audioNormalization\":\n        {\n          if (args.length === 1) {\n            const factor = Number(args[0]);\n            if (!isNaN(factor)) {\n              const effectiveFactor = Math.max(0.0, Math.min(255.0, factor));\n              window.APP.store.update({\n                preferences: { audioNormalization: effectiveFactor }\n              });\n              if (factor) {\n                this.log(LogMessageType.setAudioNormalizationFactor, { factor: effectiveFactor });\n              } else {\n                this.log(LogMessageType.audioNormalizationDisabled);\n              }\n            } else {\n              this.log(LogMessageType.audioNormalizationNaN);\n            }\n          } else {\n            this.log(LogMessageType.invalidAudioNormalizationRange);\n          }\n        }\n        break;\n    }\n  };\n}\n","import qsTruthy from \"./utils/qs_truthy\";\nimport nextTick from \"./utils/next-tick\";\nimport { hackyMobileSafariTest } from \"./utils/detect-touchscreen\";\nimport { SignInMessages } from \"./react-components/auth/SignInModal\";\nimport { createNetworkedEntity } from \"./systems/netcode\";\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isMobile = AFRAME.utils.device.isMobile();\nconst forceEnableTouchscreen = hackyMobileSafariTest();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isDebug = qsTruthy(\"debug\");\nconst qs = new URLSearchParams(location.search);\n\nimport { addMedia } from \"./utils/media-utils\";\nimport {\n  isIn2DInterstitial,\n  handleExitTo2DInterstitial,\n  exit2DInterstitialAndEnterVR,\n  forceExitFrom2DInterstitial\n} from \"./utils/vr-interstitial\";\nimport { ObjectContentOrigins } from \"./object-types\";\nimport { getAvatarSrc, getAvatarType } from \"./utils/avatar-utils\";\nimport { SOUND_ENTER_SCENE } from \"./systems/sound-effects-system\";\nimport { MediaDevices, MediaDevicesEvents } from \"./utils/media-devices-utils\";\nimport { addComponent, removeEntity } from \"bitecs\";\nimport { MyCameraTool } from \"./bit-components\";\nimport { anyEntityWith } from \"./utils/bit-utils\";\n\nexport default class SceneEntryManager {\n  constructor(hubChannel, authChannel, history) {\n    this.hubChannel = hubChannel;\n    this.authChannel = authChannel;\n    this.store = window.APP.store;\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n    this.scene = document.querySelector(\"a-scene\");\n    this.rightCursorController = document.getElementById(\"right-cursor-controller\");\n    this.leftCursorController = document.getElementById(\"left-cursor-controller\");\n    this.avatarRig = document.getElementById(\"avatar-rig\");\n    this._entered = false;\n    this.performConditionalSignIn = () => {};\n    this.history = history;\n  }\n\n  init = () => {\n    this.whenSceneLoaded(() => {\n      console.log(\"Scene is loaded so setting up controllers\");\n      this.rightCursorController.components[\"cursor-controller\"].enabled = false;\n      this.leftCursorController.components[\"cursor-controller\"].enabled = false;\n      this.mediaDevicesManager = APP.mediaDevicesManager;\n      this._setupBlocking();\n    });\n  };\n\n  hasEntered = () => {\n    return this._entered;\n  };\n\n  enterScene = async (enterInVR, muteOnEntry) => {\n    console.log(\"Entering scene...\");\n    document.getElementById(\"viewing-camera\").removeAttribute(\"scene-preview-camera\");\n\n    if (isDebug && NAF.connection.adapter.session) {\n      NAF.connection.adapter.session.options.verbose = true;\n    }\n\n    if (enterInVR) {\n      // This specific scene state var is used to check if the user went through the\n      // entry flow and chose VR entry, and is used to preempt VR mode on refreshes.\n      this.scene.addState(\"vr-entered\");\n\n      // HACK - A-Frame calls getVRDisplays at module load, we want to do it here to\n      // force gamepads to become live.\n      \"getVRDisplays\" in navigator && navigator.getVRDisplays();\n\n      await exit2DInterstitialAndEnterVR(true);\n    }\n\n    const waypointSystem = this.scene.systems[\"hubs-systems\"].waypointSystem;\n    waypointSystem.moveToSpawnPoint();\n\n    if (isMobile || forceEnableTouchscreen || qsTruthy(\"force_enable_touchscreen\")) {\n      this.avatarRig.setAttribute(\"virtual-gamepad-controls\", {});\n    }\n\n    this._setupPlayerRig();\n    this._setupKicking();\n    this._setupMedia();\n    this._setupCamera();\n\n    if (qsTruthy(\"offline\")) return;\n\n    this._spawnAvatar();\n\n    this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_ENTER_SCENE);\n\n    if (isBotMode) {\n      this._runBot();\n      this.scene.addState(\"entered\");\n      this.hubChannel.sendEnteredEvent();\n      return;\n    }\n\n    this.scene.classList.remove(\"hand-cursor\");\n    this.scene.classList.add(\"no-cursor\");\n\n    this.rightCursorController.components[\"cursor-controller\"].enabled = true;\n    this.leftCursorController.components[\"cursor-controller\"].enabled = true;\n    this._entered = true;\n\n    // Delay sending entry event telemetry until VR display is presenting.\n    (async () => {\n      while (enterInVR && !this.scene.renderer.xr.isPresenting) {\n        await nextTick();\n      }\n\n      this.hubChannel.sendEnteredEvent().then(() => {\n        this.store.update({ activity: { lastEnteredAt: new Date().toISOString() } });\n      });\n    })();\n\n    // Bump stored entry count after 30s\n    setTimeout(() => this.store.bumpEntryCount(), 30000);\n\n    this.scene.addState(\"entered\");\n\n    APP.mediaDevicesManager.micEnabled = !muteOnEntry;\n  };\n\n  whenSceneLoaded = callback => {\n    if (this.scene.hasLoaded) {\n      console.log(\"Scene already loaded so callback invoked directly\");\n      callback();\n    } else {\n      console.log(\"Scene not yet loaded so callback is deferred\");\n      this.scene.addEventListener(\"loaded\", callback);\n    }\n  };\n\n  enterSceneWhenLoaded = (enterInVR, muteOnEntry) => {\n    this.whenSceneLoaded(() => this.enterScene(enterInVR, muteOnEntry));\n  };\n\n  exitScene = () => {\n    this.scene.exitVR();\n    if (APP.dialog && APP.dialog.localMediaStream) {\n      APP.dialog.localMediaStream.getTracks().forEach(t => t.stop());\n    }\n    if (this.hubChannel) {\n      this.hubChannel.disconnect();\n    }\n    if (this.scene.renderer) {\n      this.scene.renderer.setAnimationLoop(null); // Stop animation loop, TODO A-Frame should do this\n    }\n    this.scene.parentNode.removeChild(this.scene);\n  };\n\n  _setupPlayerRig = () => {\n    this._setPlayerInfoFromProfile();\n\n    // Explict user action changed avatar or updated existing avatar.\n    this.scene.addEventListener(\"avatar_updated\", () => this._setPlayerInfoFromProfile(true));\n\n    // Store updates can occur to avatar id in cases like error, auth reset, etc.\n    this.store.addEventListener(\"statechanged\", () => this._setPlayerInfoFromProfile());\n\n    const avatarScale = parseInt(qs.get(\"avatar_scale\"), 10);\n    if (avatarScale) {\n      this.avatarRig.setAttribute(\"scale\", { x: avatarScale, y: avatarScale, z: avatarScale });\n    }\n  };\n\n  _setPlayerInfoFromProfile = async (force = false) => {\n    const avatarId = this.store.state.profile.avatarId;\n    if (!force && this._lastFetchedAvatarId === avatarId) return; // Avoid continually refetching based upon state changing\n\n    this._lastFetchedAvatarId = avatarId;\n    const avatarSrc = await getAvatarSrc(avatarId);\n\n    this.avatarRig.setAttribute(\"player-info\", { avatarSrc, avatarType: getAvatarType(avatarId) });\n  };\n\n  _setupKicking = () => {\n    // This event is only received by the kicker\n    document.body.addEventListener(\"kicked\", ({ detail }) => {\n      const { clientId: kickedClientId } = detail;\n      const { entities } = NAF.connection.entities;\n      for (const id in entities) {\n        const entity = entities[id];\n        if (NAF.utils.getCreator(entity) !== kickedClientId) continue;\n\n        if (entity.components.networked.data.persistent) {\n          NAF.utils.takeOwnership(entity);\n          window.APP.pinningHelper.unpinElement(entity);\n          entity.parentNode.removeChild(entity);\n        } else {\n          NAF.entities.removeEntity(id);\n        }\n      }\n    });\n  };\n\n  _setupBlocking = () => {\n    document.body.addEventListener(\"blocked\", ev => {\n      NAF.connection.entities.removeEntitiesOfClient(ev.detail.clientId);\n    });\n\n    document.body.addEventListener(\"unblocked\", ev => {\n      NAF.connection.entities.completeSync(ev.detail.clientId, true);\n    });\n  };\n\n  _setupMedia = () => {\n    const offset = { x: 0, y: 0, z: -1.5 };\n    const spawnMediaInfrontOfPlayer = (src, contentOrigin) => {\n      if (!this.hubChannel.can(\"spawn_and_move_media\")) return;\n      const { entity, orientation } = addMedia(\n        src,\n        \"#interactable-media\",\n        contentOrigin,\n        null,\n        !(src instanceof MediaStream),\n        true\n      );\n      orientation.then(or => {\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#avatar-pov-node\",\n          offset,\n          orientation: or\n        });\n      });\n\n      return entity;\n    };\n\n    this.scene.addEventListener(\"add_media\", e => {\n      const contentOrigin = e.detail instanceof File ? ObjectContentOrigins.FILE : ObjectContentOrigins.URL;\n\n      spawnMediaInfrontOfPlayer(e.detail, contentOrigin);\n    });\n\n    this.scene.addEventListener(\"object_spawned\", e => {\n      this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType);\n    });\n\n    this.scene.addEventListener(\"action_spawn\", () => {\n      handleExitTo2DInterstitial(false, () => window.APP.mediaSearchStore.pushExitMediaBrowserHistory());\n      window.APP.mediaSearchStore.sourceNavigateToDefaultSource();\n    });\n\n    this.scene.addEventListener(\"action_kick_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"kick_users\"),\n        async () => await window.APP.hubChannel.kick(clientId),\n        SignInMessages.kickUser\n      );\n    });\n\n    this.scene.addEventListener(\"action_mute_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"mute_users\"),\n        () => window.APP.hubChannel.mute(clientId),\n        SignInMessages.muteUser\n      );\n    });\n\n    this.scene.addEventListener(\"action_vr_notice_closed\", () => forceExitFrom2DInterstitial());\n\n    document.addEventListener(\"paste\", e => {\n      if (\n        (e.target.matches(\"input, textarea\") || e.target.contentEditable === \"true\") &&\n        document.activeElement === e.target\n      )\n        return;\n\n      // Never paste into scene if dialog is open\n      const uiRoot = document.querySelector(\".ui-root\");\n      if (uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\")) return;\n\n      const url = e.clipboardData.getData(\"text\");\n      const files = e.clipboardData.files && e.clipboardData.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.CLIPBOARD);\n        }\n      }\n    });\n\n    document.addEventListener(\"dragover\", e => e.preventDefault());\n\n    let lastDebugScene;\n    document.addEventListener(\"drop\", e => {\n      e.preventDefault();\n\n      if (qsTruthy(\"debugLocalScene\")) {\n        URL.revokeObjectURL(lastDebugScene);\n        const url = URL.createObjectURL(e.dataTransfer.files[0]);\n        this.hubChannel.updateScene(url);\n        lastDebugScene = url;\n        return;\n      }\n\n      let url = e.dataTransfer.getData(\"url\");\n\n      if (!url) {\n        // Sometimes dataTransfer text contains a valid URL, so try for that.\n        try {\n          url = new URL(e.dataTransfer.getData(\"text\")).href;\n        } catch (e) {\n          // Nope, not this time.\n        }\n      }\n\n      const files = e.dataTransfer.files;\n\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.FILE);\n        }\n      }\n    });\n\n    let currentVideoShareEntity;\n    let isHandlingVideoShare = false;\n\n    const shareSuccess = (isDisplayMedia, isVideoTrackAdded, target) => {\n      isHandlingVideoShare = false;\n\n      if (isVideoTrackAdded) {\n        if (target === \"avatar\") {\n          this.avatarRig.setAttribute(\"player-info\", { isSharingAvatarCamera: true });\n        } else {\n          currentVideoShareEntity = spawnMediaInfrontOfPlayer(this.mediaDevicesManager.mediaStream, undefined);\n          // Wire up custom removal event which will stop the stream.\n          currentVideoShareEntity.setAttribute(\n            \"emit-scene-event-on-remove\",\n            `event:${MediaDevicesEvents.VIDEO_SHARE_ENDED}`\n          );\n        }\n\n        this.scene.emit(\"share_video_enabled\", { source: isDisplayMedia ? MediaDevices.SCREEN : MediaDevices.CAMERA });\n        this.scene.addState(\"sharing_video\");\n      }\n    };\n\n    const shareError = error => {\n      console.error(error);\n      isHandlingVideoShare = false;\n      this.scene.emit(\"share_video_failed\");\n    };\n\n    this.scene.addEventListener(\"action_share_camera\", event => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n      this.mediaDevicesManager.startVideoShare({\n        isDisplayMedia: false,\n        target: event.detail?.target,\n        success: shareSuccess,\n        error: shareError\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_screen\", () => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n      this.mediaDevicesManager.startVideoShare({\n        isDisplayMedia: true,\n        target: null,\n        success: shareSuccess,\n        error: shareError\n      });\n    });\n\n    this.scene.addEventListener(MediaDevicesEvents.VIDEO_SHARE_ENDED, async () => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      if (currentVideoShareEntity && currentVideoShareEntity.parentNode) {\n        NAF.utils.takeOwnership(currentVideoShareEntity);\n        currentVideoShareEntity.parentNode.removeChild(currentVideoShareEntity);\n      }\n\n      await this.mediaDevicesManager.stopVideoShare();\n      currentVideoShareEntity = null;\n\n      this.avatarRig.setAttribute(\"player-info\", { isSharingAvatarCamera: false });\n      this.scene.emit(\"share_video_disabled\");\n      this.scene.removeState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    });\n\n    this.scene.addEventListener(MediaDevicesEvents.MIC_SHARE_ENDED, async () => {\n      await this.mediaDevicesManager.stopMicShare();\n    });\n\n    this.scene.addEventListener(\"action_selected_media_result_entry\", async e => {\n      // TODO spawn in space when no rights\n      const { entry, selectAction } = e.detail;\n      if (selectAction !== \"spawn\") return;\n\n      const delaySpawn = isIn2DInterstitial() && !isMobileVR;\n      await exit2DInterstitialAndEnterVR();\n\n      // If user has HMD lifted up or gone through interstitial, delay spawning for now. eventually show a modal\n      if (delaySpawn) {\n        setTimeout(() => {\n          spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\n        }, 3000);\n      } else {\n        spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\n      }\n    });\n\n    this.mediaSearchStore.addEventListener(\"media-exit\", () => {\n      exit2DInterstitialAndEnterVR();\n    });\n  };\n\n  _setupCamera = () => {\n    this.scene.addEventListener(\"action_toggle_camera\", () => {\n      const myCam = anyEntityWith(APP.world, MyCameraTool);\n      if (myCam) {\n        removeEntity(APP.world, myCam);\n        this.scene.removeState(\"camera\");\n      } else {\n        const avatarPov = document.querySelector(\"#avatar-pov-node\").object3D;\n        const eid = createNetworkedEntity(APP.world, \"camera\");\n        addComponent(APP.world, MyCameraTool, eid);\n\n        const obj = APP.world.eid2obj.get(eid);\n        obj.position.copy(avatarPov.localToWorld(new THREE.Vector3(0, 0, -1.5)));\n        obj.lookAt(avatarPov.getWorldPosition(new THREE.Vector3()));\n\n        this.scene.addState(\"camera\");\n      }\n    });\n  };\n\n  _spawnAvatar = () => {\n    this.avatarRig.setAttribute(\"networked\", \"template: #remote-avatar; attachTemplateToLocal: false;\");\n    this.avatarRig.setAttribute(\"networked-avatar\", \"\");\n    this.avatarRig.emit(\"entered\");\n  };\n\n  _runBot = async () => {\n    const audioEl = document.createElement(\"audio\");\n    let audioInput;\n    let dataInput;\n\n    // Wait for startup to render form\n    do {\n      audioInput = document.querySelector(\"#bot-audio-input\");\n      dataInput = document.querySelector(\"#bot-data-input\");\n      await nextTick();\n    } while (!audioInput || !dataInput);\n\n    const getAudio = () => {\n      audioEl.loop = true;\n      audioEl.muted = false;\n      audioEl.crossorigin = \"anonymous\";\n      audioEl.src = URL.createObjectURL(audioInput.files[0]);\n      document.body.appendChild(audioEl);\n    };\n\n    if (audioInput.files && audioInput.files.length > 0) {\n      getAudio();\n    } else {\n      audioInput.onchange = getAudio;\n    }\n\n    const camera = document.querySelector(\"#avatar-pov-node\");\n    const leftController = document.querySelector(\"#player-left-controller\");\n    const rightController = document.querySelector(\"#player-right-controller\");\n    const getRecording = () => {\n      fetch(URL.createObjectURL(dataInput.files[0]))\n        .then(resp => resp.json())\n        .then(recording => {\n          camera.setAttribute(\"replay\", \"\");\n          camera.components[\"replay\"].poses = recording.camera.poses;\n\n          leftController.setAttribute(\"replay\", \"\");\n          leftController.components[\"replay\"].poses = recording.left.poses;\n          leftController.removeAttribute(\"visibility-by-path\");\n          leftController.removeAttribute(\"track-pose\");\n          leftController.setAttribute(\"visible\", true);\n\n          rightController.setAttribute(\"replay\", \"\");\n          rightController.components[\"replay\"].poses = recording.right.poses;\n          rightController.removeAttribute(\"visibility-by-path\");\n          rightController.removeAttribute(\"track-pose\");\n          rightController.setAttribute(\"visible\", true);\n        });\n    };\n\n    if (dataInput.files && dataInput.files.length > 0) {\n      getRecording();\n    } else {\n      dataInput.onchange = getRecording;\n    }\n\n    await new Promise(resolve => audioEl.addEventListener(\"canplay\", resolve));\n\n    const audioStream = audioEl.captureStream\n      ? audioEl.captureStream()\n      : audioEl.mozCaptureStream\n        ? audioEl.mozCaptureStream()\n        : null;\n\n    if (audioStream) {\n      let audioVolume = Number(qs.get(\"audio_volume\") || \"1.0\");\n      if (isNaN(audioVolume)) {\n        audioVolume = 1.0;\n      }\n      const audioContext = THREE.AudioContext.getContext();\n      const audioSource = audioContext.createMediaStreamSource(audioStream);\n      const audioDestination = audioContext.createMediaStreamDestination();\n      const gainNode = audioContext.createGain();\n      audioSource.connect(gainNode);\n      gainNode.connect(audioDestination);\n      gainNode.gain.value = audioVolume;\n      this.mediaDevicesManager.mediaStream.addTrack(audioDestination.stream.getAudioTracks()[0]);\n    }\n\n    const connect = async () => {\n      await APP.dialog.setLocalMediaStream(this.mediaDevicesManager.mediaStream);\n      audioEl.play();\n    };\n    if (APP.dialog._sendTransport) {\n      connect();\n    } else {\n      this.scene.addEventListener(\"didConnectToDialog\", connect);\n    }\n  };\n}\n","import nextTick from \"./utils/next-tick.js\";\nconst INIT_TIMEOUT_MS = 5000;\n\n// Manages web push subscriptions\n//\nfunction urlBase64ToUint8Array(base64String) {\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, \"+\").replace(/_/g, \"/\");\n\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n}\n\nexport default class Subscriptions {\n  constructor(hubId) {\n    this.hubId = hubId;\n  }\n\n  register() {\n    if (navigator.serviceWorker) {\n      try {\n        navigator.serviceWorker\n          .register(\"/hub.service.js\")\n          .then(() => {\n            navigator.serviceWorker.ready\n              .then(registration => this.setRegistration(registration))\n              .catch(e => this.setRegistrationFailed(e));\n          })\n          .catch(e => this.setRegistrationFailed(e));\n      } catch (e) {\n        this.setRegistrationFailed(e);\n      }\n    } else {\n      this.setRegistrationFailed(\"Not supported\");\n    }\n  }\n\n  setHubChannel = hubChannel => {\n    this.hubChannel = hubChannel;\n  };\n\n  setRegistration = registration => {\n    console.log(\"Service worker registered\");\n    this.registration = registration;\n  };\n\n  setRegistrationFailed = e => {\n    console.error(\"Service worker registration failed\", e);\n    this.registration = null;\n  };\n\n  setVapidPublicKey = vapidPublicKey => {\n    this.vapidPublicKey = vapidPublicKey;\n  };\n\n  setSubscribed = isSubscribed => {\n    this._isSubscribed = isSubscribed;\n  };\n\n  isSubscribed = () => {\n    return this._isSubscribed;\n  };\n\n  getCurrentEndpoint = async () => {\n    if (!navigator.serviceWorker) return null;\n    const startedAt = performance.now();\n\n    // registration becomes null if failed, non null if registered\n    while (this.registration === undefined && performance.now() - startedAt < INIT_TIMEOUT_MS) await nextTick();\n    if (performance.now() - startedAt >= INIT_TIMEOUT_MS) console.warn(\"Service worker registration timed out.\");\n    if (!this.registration || !this.registration.pushManager) return null;\n\n    while (this.vapidPublicKey === undefined) await nextTick();\n    if (this.vapidPublicKey === null) return null;\n\n    try {\n      const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n      if (\n        (await this.registration.pushManager.permissionState({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        })) !== \"granted\"\n      )\n        return null;\n    } catch (e) {\n      return null; // Chrome can throw here complaining about userVisible if push is not right\n    }\n    const sub = await this.registration.pushManager.getSubscription();\n    if (!sub) return null;\n\n    return sub.endpoint;\n  };\n\n  toggle = async () => {\n    if (!this.registration) return;\n\n    if (this._isSubscribed) {\n      const pushSubscription = await this.registration.pushManager.getSubscription();\n      const res = await this.hubChannel.unsubscribe(pushSubscription);\n\n      if (res && res.has_remaining_subscriptions === false) {\n        pushSubscription.unsubscribe();\n      }\n    } else {\n      let pushSubscription = await this.registration.pushManager.getSubscription();\n\n      if (!pushSubscription) {\n        const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n        pushSubscription = await this.registration.pushManager.subscribe({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        });\n      }\n\n      this.hubChannel.subscribe(pushSubscription);\n    }\n\n    this._isSubscribed = !this._isSubscribed;\n  };\n}\n","const { Pathfinding } = require(\"three-pathfinding\");\nimport qsTruthy from \"../utils/qs_truthy\";\n\nAFRAME.registerSystem(\"nav\", {\n  init: function() {\n    this.pathfinder = new Pathfinding();\n    this.mesh = null;\n    this.el.addEventListener(\"reset_scene\", this.removeNavMeshData.bind(this));\n    this.el.addEventListener(\"leaving_loading_environment\", this.removeNavMeshData.bind(this));\n  },\n\n  loadMesh: function(mesh, zone) {\n    if (this.mesh) {\n      console.error(\"tried to load multiple nav meshes\");\n      this.removeNavMeshData();\n    }\n    const geometry = mesh.geometry.clone();\n    mesh.updateMatrices();\n    geometry.applyMatrix4(mesh.matrixWorld);\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\n    this.mesh = mesh;\n\n    const teleporters = document.querySelectorAll(\"[teleporter]\");\n    for (let i = 0; i < teleporters.length; i++) {\n      teleporters[i].components[\"teleporter\"].queryCollisionEntities();\n    }\n\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\n\n    if (qsTruthy(\"debugNavmesh\")) {\n      this.helperMesh = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({ wireframe: true }));\n      this.el.sceneEl.object3D.add(this.helperMesh);\n    }\n  },\n\n  removeNavMeshData() {\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\n      // If it's using the debug view material, restore the original material so it can be disposed.\n      if (this.mesh._hubs_audio_debug_prev_material) {\n        this.mesh.material = this.mesh._hubs_audio_debug_prev_material;\n        this.mesh._hubs_audio_debug_prev_material = null;\n      }\n    }\n    if (this.helperMesh) {\n      this.helperMesh.material?.dispose();\n      this.helperMesh.geometry?.dispose();\n      this.helperMesh.removeFromParent();\n      this.helperMesh = null;\n    }\n    this.mesh = null;\n    this.pathfinder.zones = {};\n  }\n});\n","export default function traverseFilteredSubtrees(object, cb) {\n  if (cb(object) === false) {\n    return;\n  }\n\n  const children = object.children;\n\n  for (let i = 0; i < children.length; i++) {\n    traverseFilteredSubtrees(children[i], cb);\n  }\n}\n","import { hasComponent } from \"bitecs\";\nimport { IgnoreSpaceBubble } from \"../bit-components\";\nimport { forEachMaterial } from \"../utils/material-utils\";\nimport qsTruthy from \"../utils/qs_truthy\";\nimport traverseFilteredSubtrees from \"../utils/traverseFilteredSubtrees\";\n\nconst invaderPos = new THREE.Vector3();\nconst bubblePos = new THREE.Vector3();\nconst isDebug = qsTruthy(\"debug\");\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\n/**\n * Updates invaders every tick, doing one per frame on mobile VR.\n * testing multiline things\n * @namespace avatar/personal-space-bubble\n * @system personal-space-bubble\n */\nAFRAME.registerSystem(\"personal-space-bubble\", {\n  schema: {\n    debug: { default: false },\n    enabled: { default: true }\n  },\n\n  init() {\n    this.invaders = [];\n    this.bubbles = [];\n    this.tickCount = 0;\n    this._updateInvaders = this._updateInvaders.bind(this);\n  },\n\n  registerBubble(bubble) {\n    this.bubbles.push(bubble);\n  },\n\n  unregisterBubble(bubble) {\n    const index = this.bubbles.indexOf(bubble);\n\n    if (index !== -1) {\n      this.bubbles.splice(index, 1);\n    }\n  },\n\n  registerInvader(invader) {\n    NAF.utils.getNetworkedEntity(invader.el).then(networkedEl => {\n      const owner = NAF.utils.getNetworkOwner(networkedEl);\n\n      if (owner !== NAF.clientId) {\n        this.invaders.push(invader);\n      }\n    });\n  },\n\n  unregisterInvader(invader) {\n    const index = this.invaders.indexOf(invader);\n\n    if (index !== -1) {\n      this.invaders.splice(index, 1);\n    }\n  },\n\n  update() {\n    for (let i = 0; i < this.bubbles.length; i++) {\n      this.bubbles[i].updateDebug();\n    }\n\n    for (let i = 0; i < this.invaders.length; i++) {\n      this.invaders[i].updateDebug();\n      if (!this.data.enabled) {\n        this.invaders[i].setInvading(false);\n      }\n    }\n\n    if (this.data.enabled) {\n      this.el.addState(\"spacebubble\");\n    } else {\n      this.el.removeState(\"spacebubble\");\n    }\n  },\n\n  tick() {\n    this._updateInvaders();\n    this.tickCount++;\n  },\n\n  _updateInvaders: (function () {\n    const tempInvasionFlags = [];\n\n    const setInvaderFlag = (i, invaders, bubble) => {\n      // Hide the invader if inside the bubble\n      const invader = invaders[i];\n      invaderPos.setFromMatrixPosition(invader.el.object3D.matrixWorld);\n\n      const distanceSquared = bubblePos.distanceToSquared(invaderPos);\n      const radiusSum = bubble.data.radius + invader.data.radius;\n\n      if (distanceSquared < radiusSum * radiusSum) {\n        tempInvasionFlags[i] = true;\n      }\n    };\n\n    const flushInvadingFlagsForIndex = (i, invaders) => {\n      if (invaders[i].invading !== tempInvasionFlags[i]) {\n        invaders[i].setInvading(tempInvasionFlags[i]);\n      }\n    };\n\n    return function () {\n      if (!this.data.enabled) return;\n      if (this.invaders.length === 0) return;\n\n      tempInvasionFlags.length = 0;\n\n      // precondition for this stuff -- the bubbles and invaders need updated world matrices.\n      // right now this is satisfied because we update the world matrices in the character controller\n      for (let i = 0; i < this.invaders.length; i++) {\n        this.invaders[i].el.object3D.updateMatrices(); // We read matrixWorld below, update matrices here\n        tempInvasionFlags[i] = false;\n      }\n\n      // Loop through all of the space bubbles (usually one)\n      for (let i = 0; i < this.bubbles.length; i++) {\n        const bubble = this.bubbles[i];\n\n        bubble.el.object3D.updateMatrices();\n        bubblePos.setFromMatrixPosition(bubble.el.object3D.matrixWorld);\n\n        if (!isMobileVR) {\n          for (let j = 0; j < this.invaders.length; j++) {\n            setInvaderFlag(j, this.invaders, bubble);\n          }\n        } else {\n          // Optimization: update one invader per frame on mobile VR\n          setInvaderFlag(this.tickCount % this.invaders.length, this.invaders, bubble);\n        }\n      }\n\n      if (!isMobileVR) {\n        for (let i = 0; i < this.invaders.length; i++) {\n          flushInvadingFlagsForIndex(i, this.invaders);\n        }\n      } else {\n        flushInvadingFlagsForIndex(this.tickCount % this.invaders.length, this.invaders);\n      }\n    };\n  })()\n});\n\nfunction createSphereGizmo(radius) {\n  const geometry = new THREE.SphereBufferGeometry(radius, 10, 10);\n  const wireframe = new THREE.WireframeGeometry(geometry);\n  const line = new THREE.LineSegments(wireframe);\n  line.material.opacity = 0.5;\n  line.material.transparent = true;\n  return line;\n}\n\nfunction getGLTFModelRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"gltf-model-plus\"])) {\n    entity = entity.parentNode;\n  }\n\n  return entity;\n}\n\nconst DEBUG_OBJ = \"psb-debug\";\n\n/**\n * Represents an entity that can invade a personal space bubble\n * @namespace avatar/personal-space-bubble\n * @component personal-space-invader\n */\nAFRAME.registerComponent(\"personal-space-invader\", {\n  schema: {\n    radius: { type: \"number\", default: 0.1 },\n    useMaterial: { default: false },\n    debug: { default: false },\n    invadingOpacity: { default: 0.3 }\n  },\n\n  init() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    system.registerInvader(this);\n\n    if (this.data.useMaterial) {\n      this.gltfRootEl = getGLTFModelRoot(this.el);\n    }\n\n    this.invading = false;\n    this.alwaysHidden = false;\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  // Allow external callers to tell this invader to always hide this element, regardless of invasion state\n  setAlwaysHidden(alwaysHidden) {\n    this.alwaysHidden = alwaysHidden;\n    this.applyInvasionToMesh(this.invading);\n  },\n\n  updateDebug() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    if (system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"personal-space-bubble\"].unregisterInvader(this);\n  },\n\n  setInvading(invading) {\n    if (this.invading === invading) return;\n\n    this.applyInvasionToMesh(invading);\n    this.invading = invading;\n  },\n\n  disable() {\n    if (this.invading) {\n      this.applyInvasionToMesh(false);\n    }\n\n    this.disabled = true;\n  },\n\n  enable() {\n    this.disabled = false;\n    this.applyInvasionToMesh(this.invading);\n  },\n\n  applyInvasionToMesh(invading) {\n    if (this.disabled) return;\n\n    // Note: Model isn't loaded on init because this object is inflated before the root is.\n    // object3DMap.mesh is not initially set and must be checked before traversing.\n    if (this.gltfRootEl && this.gltfRootEl.object3DMap.mesh && !this.alwaysHidden) {\n      traverseFilteredSubtrees(this.gltfRootEl.object3DMap.mesh, obj => {\n        // Prevents changing the opacity of ui elements\n        if (obj.el && hasComponent(APP.world, IgnoreSpaceBubble, obj.el.eid)) {\n          // Skip all objects under this branch by returning false\n          return false;\n        }\n\n        if (!obj.material) {\n          return;\n        }\n\n        forEachMaterial(obj, material => {\n          let originalProps = material.userData.originalProps;\n\n          if (!material.userData.originalProps) {\n            originalProps = material.userData.originalProps = {\n              opacity: material.opacity,\n              transparent: material.transparent,\n              format: material.format,\n              blending: material.blending,\n              side: material.side\n            };\n          }\n\n          // Note: Sharing materials will cause all objects with the material to turn transparent / opaque\n          // This is generally fine for avatars since a material will only be shared within a glTF model,\n          // not across avatars in the room.\n          material.opacity = invading ? this.data.invadingOpacity : originalProps.opacity;\n          material.transparent = invading || originalProps.transparent;\n\n          // Note: Since ThreeJS 0.132 the default format for GLTF imported opaque materials is RGBFormat\n          // so we need to switch before enabling transparency.\n          material.format = invading ? THREE.RGBAFormat : originalProps.format;\n          material.blending = invading ? THREE.NormalBlending : originalProps.blending;\n          // This shouldn't be necessary but for some reason transparency doens't work on some models if they are single sided.\n          material.side = invading ? THREE.DoubleSide : originalProps.side;\n        });\n      });\n    } else {\n      this.el.object3D.visible = !invading && !this.alwaysHidden;\n    }\n  }\n});\n\n/**\n * Represents a personal space bubble on an entity.\n * @namespace avatar/personal-space-bubble\n * @component personal-space-bubble\n */\nAFRAME.registerComponent(\"personal-space-bubble\", {\n  schema: {\n    radius: { type: \"number\", default: 0.8 },\n    debug: { default: false }\n  },\n  init() {\n    this.system.registerBubble(this);\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    if (!isDebug) return;\n\n    if (this.system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.system.unregisterBubble(this);\n  }\n});\n","import { paths } from \"./userinput/paths\";\nconst qs = new URLSearchParams(location.search);\nconst IDLE_TIMEOUT_MS = (parseInt(qs.get(\"idle_timeout\"), 10) || 2 * 60 * 60) * 1000;\nconst INPUT_CHECK_INTERVAL_MS = 1000;\n\nconst CHARACTER_ACCELERATION_PATH = paths.actions.characterAcceleration;\nconst BASIC_ACTIVITY_PATHS = [\n  paths.actions.startGazeTeleport,\n  paths.actions.rightHand.startTeleport,\n  paths.actions.leftHand.startTeleport,\n  paths.actions.snapRotateRight,\n  paths.actions.snapRotateLeft,\n  paths.actions.cursor.right.grab,\n  paths.actions.cursor.left.grab,\n  paths.actions.rightHand.grab,\n  paths.actions.leftHand.grab,\n  paths.actions.angularVelocity\n];\n\nAFRAME.registerSystem(\"idle-detector\", {\n  init() {\n    this.resetTimeout = this.resetTimeout.bind(this);\n    this.idleTimeout = null;\n    this.lastInputCheck = 0;\n\n    const events = [\"click\", \"pointerdown\", \"touchstart\", \"keyup\"];\n\n    for (const event of events) {\n      window.addEventListener(event, this.resetTimeout);\n    }\n\n    this.resetTimeout();\n  },\n  resetTimeout() {\n    if (this.idleTimeout) clearTimeout(this.idleTimeout);\n    this.idleTimeout = setTimeout(this.onIdleTimeout, IDLE_TIMEOUT_MS);\n    window.dispatchEvent(new CustomEvent(\"activity_detected\"));\n  },\n  onIdleTimeout() {\n    window.dispatchEvent(new CustomEvent(\"idle_detected\"));\n  },\n  tick(time) {\n    if (time - this.lastInputCheck < INPUT_CHECK_INTERVAL_MS) return;\n\n    const userinput = this.el.systems.userinput;\n\n    let basicActivity = false;\n    for (const activityPath of BASIC_ACTIVITY_PATHS) {\n      basicActivity = basicActivity || !!userinput.get(activityPath);\n    }\n\n    const characterAcceleration = userinput.get(CHARACTER_ACCELERATION_PATH);\n\n    const active =\n      basicActivity ||\n      !!(characterAcceleration && characterAcceleration[0]) ||\n      !!(characterAcceleration && characterAcceleration[1]);\n\n    if (active) {\n      this.resetTimeout();\n    }\n  },\n  remove() {}\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\n// Used for tracking and managing pen tools in the scene\nAFRAME.registerSystem(\"pen-tools\", {\n  init() {\n    this.penEls = [];\n    this.updateMyPen = this.updateMyPen.bind(this);\n\n    waitForDOMContentLoaded().then(() => {\n      this.updateMyPen();\n    });\n  },\n\n  register(el) {\n    this.penEls.push(el);\n    el.addEventListener(\"ownership-changed\", this.updateMyPen);\n    this.updateMyPen();\n  },\n\n  deregister(el) {\n    this.penEls.splice(this.penEls.indexOf(el), 1);\n    el.removeEventListener(\"ownership-changed\", this.updateMyPen);\n    this.updateMyPen();\n  },\n\n  getMyPen() {\n    return this.myPen;\n  },\n\n  updateMyPen() {\n    this.myPen = this.penEls.find(NAF.utils.isMine);\n\n    if (this.myPen) {\n      this.sceneEl.addState(\"pen\");\n    } else {\n      this.sceneEl.removeState(\"pen\");\n    }\n  }\n});\n","export const sets = {};\nsets.global = \"global\";\nsets.inputFocused = \"inputFocused\";\nsets.rightCursorHoveringOnPen = \"rightCursorHoveringOnPen\";\nsets.rightCursorHoveringOnCamera = \"rightCursorHoveringOnCamera\";\nsets.rightCursorHoveringOnInteractable = \"rightCursorHoveringOnInteractable\";\nsets.rightCursorHoveringOnUI = \"rightCursorHoveringOnUI\";\nsets.rightCursorHoveringOnVideo = \"rightCursorHoveringOnVideo\";\nsets.rightCursorHoveringOnNothing = \"rightCursorHoveringOnNothing\";\nsets.rightCursorHoldingPen = \"rightCursorHoldingPen\";\nsets.rightCursorHoldingCamera = \"rightCursorHoldingCamera\";\nsets.rightCursorHoldingInteractable = \"rightCursorHoldingInteractable\";\nsets.rightCursorHoldingUI = \"rightCursorHoldingUI\";\nsets.rightCursorHoldingNothing = \"rightCursorHoldingNothing\";\nsets.leftCursorHoveringOnPen = \"leftCursorHoveringOnPen\";\nsets.leftCursorHoveringOnCamera = \"leftCursorHoveringOnCamera\";\nsets.leftCursorHoveringOnInteractable = \"leftCursorHoveringOnInteractable\";\nsets.leftCursorHoveringOnUI = \"leftCursorHoveringOnUI\";\nsets.leftCursorHoveringOnVideo = \"leftCursorHoveringOnVideo\";\nsets.leftCursorHoveringOnNothing = \"leftCursorHoveringOnNothing\";\nsets.leftCursorHoldingPen = \"leftCursorHoldingPen\";\nsets.leftCursorHoldingCamera = \"leftCursorHoldingCamera\";\nsets.leftCursorHoldingInteractable = \"leftCursorHoldingInteractable\";\nsets.leftCursorHoldingUI = \"leftCursorHoldingUI\";\nsets.leftCursorHoldingNothing = \"leftCursorHoldingNothing\";\nsets.rightHandTeleporting = \"rightHandTeleporting\";\nsets.rightHandHoveringOnPen = \"rightHandHoveringOnPen\";\nsets.rightHandHoveringOnCamera = \"rightHandHoveringOnCamera\";\nsets.rightHandHoveringOnInteractable = \"rightHandHoveringOnInteractable\";\nsets.rightHandHoveringOnNothing = \"rightHandHoveringOnNothing\";\nsets.rightHandHoldingPen = \"rightHandHoldingPen\";\nsets.rightHandHoldingCamera = \"rightHandHoldingCamera\";\nsets.rightHandHoldingInteractable = \"rightHandHoldingInteractable\";\nsets.leftHandTeleporting = \"leftHandTeleporting\";\nsets.leftHandHoveringOnPen = \"leftHandHoveringOnPen\";\nsets.leftHandHoveringOnCamera = \"leftHandHoveringOnCamera\";\nsets.leftHandHoveringOnInteractable = \"leftHandHoveringOnInteractable\";\nsets.leftHandHoldingPen = \"leftHandHoldingPen\";\nsets.leftHandHoldingCamera = \"leftHandHoldingCamera\";\nsets.leftHandHoldingInteractable = \"leftHandHoldingInteractable\";\nsets.leftHandHoveringOnNothing = \"leftHandHoveringOnNothing\";\nsets.debugUserInput = \"debugUserInput\";\nsets.inspecting = \"inspecting\";\n","import { paths } from \"../paths\";\n\n// TODO: Where do these values (500, 10, 2) come from?\nconst modeMod = {\n  [WheelEvent.DOM_DELTA_PIXEL]: 500,\n  [WheelEvent.DOM_DELTA_LINE]: 10,\n  [WheelEvent.DOM_DELTA_PAGE]: 2\n};\n\nconst isInModal = (function() {\n  let uiRoot;\n  return function isInModal() {\n    // TODO: Tech debt. Find better way to handle this state that is available in react.\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    return (\n      (uiRoot && uiRoot.children[0] && uiRoot.children[0].classList.contains(\"in-modal-or-overlay\")) ||\n      window.APP.preferenceScreenIsVisible\n    );\n  };\n})();\n\nexport class MouseDevice {\n  constructor() {\n    this.events = [];\n    this.coords = [0, 0]; // normalized screenspace coordinates in [(-1, 1), (-1, 1)]\n    this.movementXY = [0, 0]; // deltas\n    this.buttonLeft = false;\n    this.buttonRight = false;\n    this.buttonMiddle = false;\n    this.wheel = 0; // delta\n\n    const queueEvent = this.events.push.bind(this.events);\n    this.canvas = document.querySelector(\"canvas\");\n    this.canvas.addEventListener(\"contextmenu\", e => {\n      if (e.button === 2) {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      }\n    });\n    [\"mousedown\", \"wheel\"].map(x => this.canvas.addEventListener(x, queueEvent, { passive: false }));\n    [\"mousemove\", \"mouseup\"].map(x => window.addEventListener(x, queueEvent, { passive: false }));\n\n    document.addEventListener(\n      \"wheel\",\n      e => {\n        // Only capture wheel events when the canvas is focused\n        if (document.activeElement.classList.contains(\"a-canvas\")) {\n          e.preventDefault();\n        }\n      },\n      { passive: false }\n    );\n  }\n\n  process(event) {\n    if (event.type === \"wheel\") {\n      this.wheel += (event.deltaX + event.deltaY) / modeMod[event.deltaMode];\n      return true;\n    }\n\n    const left = event.button === 0;\n    const middle = event.button === 1;\n    const right = event.button === 2;\n    // Note: This assumes the canvas always starts in the top left.\n    // This works with the current sidebar and toolbar layout.\n    this.coords[0] = (event.clientX / this.canvas.clientWidth) * 2 - 1;\n    this.coords[1] = -(event.clientY / this.canvas.clientHeight) * 2 + 1;\n    this.movementXY[0] += event.movementX;\n    this.movementXY[1] += event.movementY;\n    if (event.type === \"mousedown\" && left) {\n      this.mouseDownLeftThisFrame = true;\n      this.buttonLeft = true;\n    } else if (event.type === \"mousedown\" && right) {\n      this.mouseDownRightThisFrame = true;\n      this.buttonRight = true;\n    } else if (event.type === \"mousedown\" && middle) {\n      this.mouseDownMiddleThisFrame = true;\n      this.buttonMiddle = true;\n    } else if (event.type === \"mouseup\" && left) {\n      if (this.mouseDownLeftThisFrame) {\n        return false;\n      }\n      this.buttonLeft = false;\n    } else if (event.type === \"mouseup\" && right) {\n      if (this.mouseDownRightThisFrame) {\n        return false;\n      }\n      this.buttonRight = false;\n    } else if (event.type === \"mouseup\" && middle) {\n      if (this.mouseDownMiddleThisFrame) {\n        return false;\n      }\n      this.buttonMiddle = false;\n    }\n    return true;\n  }\n\n  write(frame) {\n    this.movementXY[0] = 0; // deltas\n    this.movementXY[1] = 0; // deltas\n    this.wheel = 0; // delta\n\n    this.didStopProcessingEarly = false;\n    this.mouseDownLeftThisFrame = false;\n    this.mouseDownRightThisFrame = false;\n    this.mouseDownMiddleThisFrame = false;\n\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (!this.process(event)) {\n        this.didStopProcessingEarly = true;\n        this.events.splice(0, i);\n        break;\n      }\n    }\n\n    if (!this.didStopProcessingEarly) {\n      this.events.length = 0;\n    }\n\n    frame.setVector2(paths.device.mouse.coords, this.coords[0], this.coords[1]);\n    frame.setVector2(paths.device.mouse.movementXY, this.movementXY[0], this.movementXY[1]);\n    frame.setValueType(paths.device.mouse.buttonLeft, this.buttonLeft);\n    frame.setValueType(paths.device.mouse.buttonRight, this.buttonRight);\n    frame.setValueType(paths.device.mouse.buttonMiddle, this.buttonMiddle);\n    frame.setValueType(paths.device.mouse.wheel, this.wheel);\n  }\n}\n\nwindow.oncontextmenu = e => {\n  if (!isInModal()) {\n    e.preventDefault();\n  }\n};\n","// You might prefer to use this over a Set because iterating over a set allocates memory\nexport function ArrayBackedSet(initialItems) {\n  return {\n    items: initialItems || [],\n    has(item) {\n      return this.items.indexOf(item) !== -1;\n    },\n    add(item) {\n      if (!this.has(item)) {\n        this.items.push(item);\n      }\n    },\n    delete(item) {\n      const index = this.items.indexOf(item);\n      if (index !== -1) {\n        this.items[index] = this.items[this.items.length - 1];\n        this.items.pop();\n      }\n    },\n    clear() {\n      this.items.length = 0;\n    }\n  };\n}\n","import { paths } from \"../paths\";\nimport { ArrayBackedSet } from \"../array-backed-set\";\n\n// TODO currently hardcoding these keys to be physical location based instead of character based. We likely want to make this part of the bindings themselves.\nconst CODE_TO_KEY = {\n  KeyW: \"w\",\n  KeyA: \"a\",\n  KeyS: \"s\",\n  KeyD: \"d\",\n  KeyQ: \"q\",\n  KeyE: \"e\"\n};\n\nexport class KeyboardDevice {\n  constructor() {\n    this.seenKeys = new ArrayBackedSet();\n    this.keys = {};\n    this.events = [];\n\n    [\"keydown\", \"keyup\"].map(x =>\n      document.addEventListener(x, e => {\n        if (!e.key) return;\n        this.events.push(e);\n\n        // Block browser hotkeys for chat command, media browser and freeze\n        if (\n          (e.type === \"keydown\" &&\n            e.key === \"/\" &&\n            ![\"TEXTAREA\", \"INPUT\"].includes(document.activeElement && document.activeElement.nodeName) &&\n            !(document.activeElement && document.activeElement.contentEditable === \"true\")) ||\n          (e.ctrlKey &&\n            (e.key === \"1\" ||\n              e.key === \"2\" ||\n              e.key === \"3\" ||\n              e.key === \"4\" ||\n              e.key === \"5\" ||\n              e.key === \"6\" ||\n              e.key === \"7\" ||\n              e.key === \"8\" ||\n              e.key === \"9\" ||\n              e.key === \"0\")) ||\n          (e.key === \"Tab\" && document.activeElement.classList.contains(\"a-canvas\"))\n        ) {\n          e.preventDefault();\n          return false;\n        }\n      })\n    );\n    [\"blur\"].map(x => window.addEventListener(x, this.events.push.bind(this.events)));\n  }\n\n  write(frame) {\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (event.type === \"blur\") {\n        this.keys = {};\n        this.seenKeys.clear();\n      } else {\n        let key = event.key.toLowerCase();\n        // Use event.code and not event.key for wasdqe controls so this works\n        // for non QWERTY keyboards.\n        key = (event.code && CODE_TO_KEY[event.code]) || key;\n        this.keys[key] = event.type === \"keydown\";\n        this.seenKeys.add(key);\n      }\n    }\n\n    this.events.length = 0;\n\n    for (let i = 0; i < this.seenKeys.items.length; i++) {\n      const key = this.seenKeys.items[i];\n      const path = paths.device.keyboard.key(key);\n      frame.setValueType(path, this.keys[key]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class HudDevice {\n  constructor() {\n    this.events = [];\n    document.querySelector(\"a-scene\").addEventListener(\"penButtonPressed\", this.events.push.bind(this.events));\n  }\n\n  write(frame) {\n    frame.setValueType(paths.device.hud.penButton, this.events.length !== 0);\n    while (this.events.length) {\n      this.events.pop();\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class XboxControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [\n      { name: \"a\", buttonId: 0 },\n      { name: \"b\", buttonId: 1 },\n      { name: \"x\", buttonId: 2 },\n      { name: \"y\", buttonId: 3 },\n      { name: \"leftBumper\", buttonId: 4 },\n      { name: \"rightBumper\", buttonId: 5 },\n      { name: \"leftTrigger\", buttonId: 6 },\n      { name: \"rightTrigger\", buttonId: 7 },\n      { name: \"back\", buttonId: 8 },\n      { name: \"start\", buttonId: 9 },\n      { name: \"leftJoystick\", buttonId: 10 },\n      { name: \"rightJoystick\", buttonId: 11 },\n      { name: \"dpadUp\", buttonId: 12 },\n      { name: \"dpadDown\", buttonId: 13 },\n      { name: \"dpadLeft\", buttonId: 14 },\n      { name: \"dpadRight\", buttonId: 15 }\n    ];\n    this.axisMap = [\n      { name: \"leftJoystickHorizontal\", axisId: 0 },\n      { name: \"leftJoystickVertical\", axisId: 1 },\n      { name: \"rightJoystickHorizontal\", axisId: 2 },\n      { name: \"rightJoystickVertical\", axisId: 3 }\n    ];\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (this.gamepad.connected) {\n      const xboxPaths = paths.device.xbox;\n      this.buttonMap.forEach(b => {\n        const path = xboxPaths.button(b.name);\n        const button = this.gamepad.buttons[b.buttonId];\n        frame.setValueType(path.pressed, !!button.pressed);\n        frame.setValueType(path.touched, !!button.touched);\n        frame.setValueType(path.value, button.value);\n      });\n      frame.setValueType(xboxPaths.axesSum, 0);\n      this.axisMap.forEach(axis => {\n        frame.setValueType(xboxPaths.axis(axis.name), this.gamepad.axes[axis.axisId]);\n        frame.setValueType(xboxPaths.axesSum, frame.get(xboxPaths.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n      });\n\n      if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n        frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n      }\n    }\n  }\n}\n","import { Vector3, Quaternion } from \"three\";\nconst forward = new Vector3(0, 0, -1);\nexport function Pose() {\n  return {\n    position: new Vector3(),\n    direction: new Vector3(),\n    orientation: new Quaternion(),\n    fromOriginAndDirection: function (origin, direction) {\n      this.position = origin;\n      this.direction = direction;\n      this.orientation = this.orientation.setFromUnitVectors(forward, direction);\n      return this;\n    },\n    fromCameraProjection: function (camera, normalizedX, normalizedY) {\n      this.position.setFromMatrixPosition(camera.matrixWorld);\n      this.direction.set(normalizedX, normalizedY, 0.5).unproject(camera).sub(this.position).normalize();\n      this.fromOriginAndDirection(this.position, this.direction);\n      return this;\n    },\n    copy: function (pose) {\n      this.position.copy(pose.position);\n      this.direction.copy(pose.direction);\n      this.orientation.copy(pose.orientation);\n    }\n  };\n}\n","// Vector from eyes to elbow (divided by user height).\nconst EYES_TO_ELBOW = { x: 0.175, y: -0.3, z: -0.03 };\n// Vector from eyes to elbow (divided by user height).\nconst FOREARM = { x: 0, y: 0, z: -0.175 };\n\nexport const applyArmModel = (function() {\n  const controllerEuler = new THREE.Euler();\n  const deltaControllerPosition = new THREE.Vector3();\n  const controllerQuaternion = new THREE.Quaternion();\n  const controllerPosition = new THREE.Vector3();\n  return function applyArmModel(gamepadPose, hand, headObject3D, userHeight) {\n    headObject3D.updateMatrices();\n    controllerPosition.copy(headObject3D.position);\n    controllerPosition.y = controllerPosition.y - userHeight;\n    deltaControllerPosition.set(\n      EYES_TO_ELBOW.x * (hand === \"left\" ? -1 : hand === \"right\" ? 1 : 0),\n      EYES_TO_ELBOW.y,\n      EYES_TO_ELBOW.z\n    );\n    deltaControllerPosition.multiplyScalar(userHeight);\n    deltaControllerPosition.applyAxisAngle(headObject3D.up, headObject3D.rotation.y);\n    controllerPosition.add(deltaControllerPosition);\n    deltaControllerPosition.set(FOREARM.x, FOREARM.y, FOREARM.z);\n    deltaControllerPosition.multiplyScalar(userHeight);\n    controllerQuaternion.fromArray(gamepadPose.orientation);\n    controllerEuler.setFromQuaternion(controllerQuaternion);\n    controllerEuler.set(controllerEuler.x, controllerEuler.y, 0);\n    deltaControllerPosition.applyEuler(controllerEuler);\n    controllerPosition.add(deltaControllerPosition);\n    return controllerPosition;\n  };\n})();\n","export const copySittingToStandingTransform = function copySittingToStandingTransform(matrix) {\n  navigator.getVRDisplays &&\n    navigator.getVRDisplays().then(displays => {\n      if (displays[0] && displays[0].stageParameters && displays[0].stageParameters.sittingToStandingTransform) {\n        matrix.fromArray(displays[0].stageParameters.sittingToStandingTransform);\n      } else {\n        setTimeout(() => {\n          copySittingToStandingTransform(matrix);\n        }, 1000); // Try again when the display is ready\n      }\n    });\n};\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\nimport { waitForDOMContentLoaded } from \"../../../utils/async-utils\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst m = new THREE.Matrix4();\n\nconst TOUCHPAD = paths.device.oculusgo.touchpad;\nconst TRIGGER = paths.device.oculusgo.trigger;\n\nexport class OculusGoControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.pose = new Pose();\n    this.q = new THREE.Quaternion();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n\n    // TODO ideally we should just be getting pose from the gamepad\n    // TODO if controller is set to left hand, we still use right hand query here\n    // because otherwise things break.\n    waitForDOMContentLoaded().then(() => {\n      this.rayObject = document.querySelector(\"#player-right-controller\").object3D;\n      this.headObject3D = document.querySelector(\"#avatar-pov-node\").object3D;\n    });\n\n    navigator.getGamepads();\n  }\n\n  write(frame) {\n    if (!this.rayObject || !this.headObject3D) return;\n\n    // Have to call navigator.getGamepads() in order for the gamepad object to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      frame.setValueType(TOUCHPAD.axisX, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD.axisY, this.gamepad.axes[1]);\n      frame.setValueType(TOUCHPAD.pressed, this.gamepad.buttons[0].pressed);\n      frame.setValueType(TOUCHPAD.touched, this.gamepad.buttons[0].touched);\n      frame.setValueType(TOUCHPAD.value, this.gamepad.buttons[0].value);\n      frame.setValueType(TRIGGER.pressed, this.gamepad.buttons[1].pressed);\n      frame.setValueType(TRIGGER.touched, this.gamepad.buttons[1].touched);\n      frame.setValueType(TRIGGER.value, this.gamepad.buttons[1].value);\n\n      this.rayObject.updateMatrices();\n      this.rayObject.getWorldQuaternion(this.q);\n      frame.setValueType(paths.actions.rayObjectRotation, this.q);\n      const rayMatrixWorld = this.rayObject.matrixWorld;\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n\n      this.pose.position.setFromMatrixPosition(rayMatrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.oculusgo.pose, this.pose);\n\n      if (this.gamepad.pose.orientation) {\n        // TODO if controller is set to left hand, we still draw right hand until\n        // bindings are overhauled to handle primary/secondary hands.\n        frame.setMatrix4(\n          paths.device.oculusgo.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.gearVRController.button(\"touchpad\");\nconst TRIGGER = paths.device.gearVRController.button(\"trigger\");\nconst TOUCHPAD_X = paths.device.gearVRController.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.gearVRController.axis(\"touchpadY\");\n\nconst m = new THREE.Matrix4();\n\nexport class GearVRControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [{ name: \"touchpad\", buttonId: 0 }, { name: \"trigger\", buttonId: 1 }];\n    this.axisMap = [{ name: \"touchpadX\", axisId: 0 }, { name: \"touchpadY\", axisId: 1 }];\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    // Chrome requires a call to getGamepads() for the gamepad state to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      const touchpad = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!touchpad.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!touchpad.touched);\n      frame.setValueType(TOUCHPAD.value, !!touchpad.value);\n\n      const trigger = this.gamepad.buttons[1];\n      frame.setValueType(TRIGGER.pressed, !!trigger.pressed);\n      frame.setValueType(TRIGGER.touched, !!trigger.touched);\n      frame.setValueType(TRIGGER.value, !!trigger.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.gearVRController.pose, this.pose);\n      this.headObject3D = this.headObject3D || document.querySelector(\"#avatar-pov-node\").object3D;\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          paths.device.gearVRController.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nexport const leftOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"x\", buttonId: 3 },\n  { name: \"y\", buttonId: 4 }\n];\nexport const rightOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"a\", buttonId: 3 },\n  { name: \"b\", buttonId: 4 }\n];\n\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.1);\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.1);\n\nconst m = new THREE.Matrix4();\n\nexport class OculusTouchControllerDevice {\n  constructor(gamepad) {\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    const buttonMaps = {\n      left: leftOculusTouchButtonMap,\n      right: rightOculusTouchButtonMap\n    };\n\n    const devicePaths = {\n      left: paths.device.leftOculusTouch,\n      right: paths.device.rightOculusTouch\n    };\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n    this.buttonMap = buttonMaps[gamepad.hand];\n    this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.path = devicePaths[gamepad.hand];\n    this.selector = `#player-${gamepad.hand}-controller`;\n\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n    this.handOffset = this.gamepad.hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET;\n  }\n\n  write(frame) {\n    if (!this.gamepad) return;\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad || !this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.orientation.copy(this.rayObjectRotation);\n\n    frame.setPose(this.path.pose, this.pose);\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(this.handOffset)\n      );\n    }\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().makeTranslation(0, 0, -0.04);\nconst m = new THREE.Matrix4();\n\nconst TOUCHPAD = paths.device.daydream.button(\"touchpad\");\nconst TOUCHPAD_X = paths.device.daydream.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.daydream.axis(\"touchpadY\");\nconst POSE = paths.device.daydream.pose;\nconst MATRIX = paths.device.daydream.matrix;\n\nexport class DaydreamControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand || \"right\"}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[0];\n    if (this.gamepad && this.gamepad.connected) {\n      const button = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!button.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!button.touched);\n      frame.setValueType(TOUCHPAD.value, !!button.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO ideally we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(POSE, this.pose);\n\n      this.headObject3D = this.headObject3D || document.querySelector(\"#avatar-pov-node\").object3D;\n\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          MATRIX,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n            .multiply(HAND_OFFSET)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, 0, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.MathUtils.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\nconst RAY_ROTATION = new THREE.Quaternion();\nconst m = new THREE.Matrix4();\n\nexport class ViveControllerDevice {\n  constructor(gamepad) {\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n    this.gamepad = gamepad;\n\n    if (this.gamepad.id === \"OpenVR Cosmos\") {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n      this.buttonMap = [\n        { name: \"trigger\", buttonId: 0 },\n        { name: \"grip\", buttonId: 1 },\n        { name: \"primary\", buttonId: 2 },\n        { name: \"secondary\", buttonId: 3 },\n        { name: \"joystick\", buttonId: 4 },\n        { name: \"bumper\", buttonId: 5 }\n      ];\n      this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n    } else if (this.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), Math.PI / 15);\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 }\n      ];\n      this.axisMap = [{ name: \"touchX\", axisId: 0 }, { name: \"touchY\", axisId: 1 }];\n    } else if (this.gamepad.axes.length === 4) {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 },\n        { name: \"primary\", buttonId: 3 },\n        { name: \"secondary\", buttonId: 4 },\n        { name: \"joystick\", buttonId: 5 },\n        { name: \"index\", buttonId: 6 },\n        { name: \"middle\", buttonId: 7 },\n        { name: \"ring\", buttonId: 8 },\n        { name: \"pinky\", buttonId: 9 }\n      ];\n      this.axisMap = [\n        { name: \"touchX\", axisId: 0 },\n        { name: \"touchY\", axisId: 1 },\n        { name: \"joyX\", axisId: 2 },\n        { name: \"joyY\", axisId: 3 }\n      ];\n    } else {\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 },\n        { name: \"primary\", buttonId: 3 }\n      ];\n      this.axisMap = [{ name: \"touchX\", axisId: 0 }, { name: \"touchY\", axisId: 1 }];\n    }\n\n    this.pose = new Pose();\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.path = paths.device.vive[gamepad.hand || \"right\"];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    const gamepads = navigator.getGamepads();\n    if (gamepads.length < this.gamepad.index + 1) {\n      //workaround for: https://bugzilla.mozilla.org/show_bug.cgi?id=1568076\n      return;\n    }\n    this.gamepad = gamepads[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    if (!this.selector) {\n      if (this.gamepad.hand) {\n        this.path = paths.device.vive[this.gamepad.hand];\n        this.selector = `#player-${this.gamepad.hand}-controller`;\n        console.warn(\"gamepad hand eventually specified\");\n      } else {\n        return;\n      }\n    }\n    const el = document.querySelector(this.selector);\n    const rayObject = el.object3D;\n    rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(rayObject.matrixWorld));\n    this.pose.position.setFromMatrixPosition(rayObject.matrixWorld);\n    this.pose.direction\n      .set(0, 0, -1)\n      .applyQuaternion(RAY_ROTATION)\n      .applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, -0.017, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.MathUtils.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\nconst m = new THREE.Matrix4();\n\nexport class WindowsMixedRealityControllerDevice {\n  constructor(gamepad) {\n    this.rayObject = null;\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n\n    if (gamepad.hand) {\n      this.selector = `#player-${gamepad.hand}-controller`;\n    }\n\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n  write(frame) {\n    if (!this.gamepad) return;\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad || !this.gamepad.connected) return;\n\n    const path = paths.device.wmr[this.gamepad.hand || \"right\"];\n\n    frame.setValueType(path.touchpad.pressed, this.gamepad.buttons[0].pressed);\n    frame.setValueType(path.touchpad.touched, this.gamepad.buttons[0].touched);\n    frame.setValueType(path.touchpad.value, this.gamepad.buttons[0].value);\n\n    frame.setValueType(path.trigger.pressed, this.gamepad.buttons[1].pressed);\n    frame.setValueType(path.trigger.touched, this.gamepad.buttons[1].touched);\n    frame.setValueType(path.trigger.value, this.gamepad.buttons[1].value);\n\n    frame.setValueType(path.grip.pressed, this.gamepad.buttons[2].pressed);\n    frame.setValueType(path.grip.touched, this.gamepad.buttons[2].touched);\n    frame.setValueType(path.grip.value, this.gamepad.buttons[2].value);\n\n    frame.setValueType(path.menu.pressed, this.gamepad.buttons[3].pressed);\n    frame.setValueType(path.menu.touched, this.gamepad.buttons[3].touched);\n    frame.setValueType(path.menu.value, this.gamepad.buttons[3].value);\n\n    frame.setValueType(path.touchpad.axisX, this.gamepad.axes[0]);\n    frame.setValueType(path.touchpad.axisY, this.gamepad.axes[1]);\n    frame.setValueType(path.joystick.axisX, this.gamepad.axes[2]);\n    frame.setValueType(path.joystick.axisY, this.gamepad.axes[3]);\n\n    if (!this.selector) {\n      if (!this.gamepad.hand) return;\n      this.selector = `#player-${this.gamepad.hand}-controller`;\n    }\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n// Note these offests are specifically for the oculus touch controllers on a Quest.\n// We'll have to account for other headsets and controllers as we expand WebXR support.\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.12);\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.12);\nconst m = new THREE.Matrix4();\n\nexport class WebXRControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n\n    this.selector = `#player-${gamepad.hand}-controller`;\n    this.rayObject = null;\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.pose = new Pose();\n\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n  write(frame, scene, referenceSpace) {\n    if (!referenceSpace || !this.gamepad) return;\n\n    const hand = this.gamepad.hand || \"right\";\n    const path = paths.device.webxr[hand];\n\n    if (this.gamepad.buttons[0]) {\n      frame.setValueType(path.button.trigger.pressed, this.gamepad.buttons[0].pressed);\n      frame.setValueType(path.button.trigger.touched, this.gamepad.buttons[0].touched);\n      frame.setValueType(path.button.trigger.value, this.gamepad.buttons[0].value);\n    }\n\n    if (this.gamepad.buttons[1]) {\n      frame.setValueType(path.button.grip.pressed, this.gamepad.buttons[1].pressed);\n      frame.setValueType(path.button.grip.touched, this.gamepad.buttons[1].touched);\n      frame.setValueType(path.button.grip.value, this.gamepad.buttons[1].value);\n    }\n\n    if (this.gamepad.buttons[2]) {\n      frame.setValueType(path.button.touchpad.pressed, this.gamepad.buttons[2].pressed);\n      frame.setValueType(path.button.touchpad.touched, this.gamepad.buttons[2].touched);\n      frame.setValueType(path.button.touchpad.value, this.gamepad.buttons[2].value);\n    }\n\n    if (this.gamepad.buttons[3]) {\n      frame.setValueType(path.button.thumbStick.pressed, this.gamepad.buttons[3].pressed);\n      frame.setValueType(path.button.thumbStick.touched, this.gamepad.buttons[3].touched);\n      frame.setValueType(path.button.thumbStick.value, this.gamepad.buttons[3].value);\n    }\n\n    if (this.gamepad.buttons[4]) {\n      frame.setValueType(path.button.a.pressed, this.gamepad.buttons[4].pressed);\n      frame.setValueType(path.button.a.touched, this.gamepad.buttons[4].touched);\n      frame.setValueType(path.button.a.value, this.gamepad.buttons[4].value);\n    }\n\n    if (this.gamepad.buttons[5]) {\n      frame.setValueType(path.button.b.pressed, this.gamepad.buttons[5].pressed);\n      frame.setValueType(path.button.b.touched, this.gamepad.buttons[5].touched);\n      frame.setValueType(path.button.b.value, this.gamepad.buttons[5].value);\n    }\n\n    if (this.gamepad.axes.length >= 4) {\n      frame.setValueType(path.axis.touchpadX, this.gamepad.axes[0]);\n      frame.setValueType(path.axis.touchpadY, this.gamepad.axes[1]);\n      frame.setValueType(path.axis.joyX, this.gamepad.axes[2]);\n      frame.setValueType(path.axis.joyY, this.gamepad.axes[3]);\n    }\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\n\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.orientation.copy(this.rayObjectRotation);\n\n    frame.setPose(path.pose, this.pose);\n\n    const pose = scene.frame.getPose(this.gamepad.targetRaySpace, referenceSpace);\n\n    if (pose && pose.transform.position && pose.transform.orientation) {\n      this.position.copy(pose.transform.position);\n      this.orientation.copy(pose.transform.orientation);\n      this.matrix.compose(\n        this.position,\n        this.orientation,\n        ONES\n      );\n      this.matrix.multiply(hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET);\n      frame.setMatrix4(path.matrix, this.matrix);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nconst TWOPI = Math.PI * 2;\n\nclass CircularBuffer {\n  constructor(length) {\n    this.items = new Array(length).fill(0);\n    this.writePtr = 0;\n  }\n\n  push(item) {\n    this.items[this.writePtr] = item;\n    this.writePtr = (this.writePtr + 1) % this.items.length;\n  }\n}\n\nconst abs = Math.abs;\n// Input: two numbers between [-Math.PI, Math.PI]\n// Output: difference between them, where -Math.PI === Math.PI\nconst difference = (curr, prev) => {\n  const a = curr - prev;\n  const b = curr + TWOPI - prev;\n  const c = curr - (prev + TWOPI);\n  if (abs(a) < abs(b)) {\n    if (abs(a) < abs(c)) {\n      return a;\n    }\n  }\n  if (abs(b) < abs(c)) {\n    return b;\n  }\n\n  return c;\n};\n\nconst average = a => {\n  let sum = 0;\n  for (let i = 0; i < a.length; i++) {\n    const n = a[i];\n    sum += n;\n  }\n  return sum / a.length;\n};\n\nexport class GyroDevice {\n  constructor() {\n    this.hmdEuler = new THREE.Euler();\n    this.hmdQuaternion = new THREE.Quaternion();\n    this.prevX = this.hmdEuler.x;\n    this.prevY = this.hmdEuler.y;\n    this.dXBuffer = new CircularBuffer(6);\n    this.dYBuffer = new CircularBuffer(6);\n    this.hasPolyfill = window.webvrpolyfill;\n    if (this.hasPolyfill) {\n      this.vrDisplay = window.webvrpolyfill.getPolyfillDisplays()[0];\n      this.frameData = new window.webvrpolyfill.constructor.VRFrameData();\n    }\n\n    this.enableGyro = window.APP.store.state.preferences.enableGyro;\n    window.APP.store.addEventListener(\"statechanged\", () => {\n      this.enableGyro = window.APP.store.state.preferences.enableGyro;\n    });\n  }\n\n  write(frame) {\n    if (!this.enableGyro || !this.hasPolyfill || !this.vrDisplay || !this.frameData) {\n      return;\n    }\n    const hmdEuler = this.hmdEuler;\n    this.vrDisplay.getFrameData(this.frameData);\n    if (this.frameData.pose.orientation !== null) {\n      this.hmdQuaternion.fromArray(this.frameData.pose.orientation);\n      hmdEuler.setFromQuaternion(this.hmdQuaternion, \"YXZ\");\n    }\n\n    // Don't use gyro values when device is lying flat\n    if (hmdEuler.x < -Math.PI * 0.475) return;\n\n    const dX = difference(hmdEuler.x, this.prevX);\n    const dY = difference(hmdEuler.y, this.prevY);\n\n    this.dXBuffer.push(Math.abs(dX) < 0.001 ? 0 : dX);\n    this.dYBuffer.push(Math.abs(dY) < 0.001 ? 0 : dY);\n\n    this.averageDeltaX = average(this.dXBuffer.items);\n    this.averageDeltaY = average(this.dYBuffer.items);\n\n    this.prevX = hmdEuler.x;\n    this.prevY = hmdEuler.y;\n    frame.setValueType(paths.device.gyro.averageDeltaX, this.averageDeltaX);\n    frame.setValueType(paths.device.gyro.averageDeltaY, this.averageDeltaY);\n  }\n}\n","import { HeldRemoteRight } from \"../../../bit-components\";\nimport { anyEntityWith } from \"../../../utils/bit-utils\";\nimport { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\n\nconst calculateCursorPose = (function() {\n  const origin = new THREE.Vector3();\n  const direction = new THREE.Vector3();\n  return function(cursorPose, camera, coords) {\n    origin.setFromMatrixPosition(camera.matrixWorld);\n    direction\n      .set(coords[0], coords[1], 0.5)\n      .unproject(camera)\n      .sub(origin)\n      .normalize();\n    cursorPose.fromOriginAndDirection(origin, direction);\n    return cursorPose;\n  };\n})();\n\nexport class AppAwareMouseDevice {\n  constructor() {\n    this.cursorPose = new Pose();\n  }\n  write(frame) {\n    const transformSystem = AFRAME.scenes[0].systems[\"transform-selected-object\"];\n\n    const buttonLeft = frame.get(paths.device.mouse.buttonLeft);\n    const buttonRight = frame.get(paths.device.mouse.buttonRight);\n\n    if ((buttonRight && !transformSystem.transforming) || (buttonLeft && !anyEntityWith(APP.world, HeldRemoteRight))) {\n      const movementXY = frame.get(paths.device.mouse.movementXY);\n      if (movementXY) {\n        frame.setVector2(paths.device.smartMouse.cameraDelta, movementXY[0], movementXY[1]);\n      }\n      frame.setValueType(paths.device.smartMouse.shouldMoveCamera, true);\n    }\n\n    if (!this.camera) {\n      this.camera = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n    }\n\n    if (this.camera) {\n      frame.setPose(\n        paths.device.smartMouse.cursorPose,\n        calculateCursorPose(this.cursorPose, this.camera, frame.get(paths.device.mouse.coords))\n      );\n    }\n  }\n}\n","export function touchIsAssigned(touch, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.touch.identifier === touch.identifier;\n    }) !== undefined\n  );\n}\n\nexport function jobIsAssigned(job, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.job === job;\n    }) !== undefined\n  );\n}\n\nexport function assign(touch, job, assignments) {\n  if (touchIsAssigned(touch, assignments) || jobIsAssigned(job, assignments)) {\n    console.error(\"cannot reassign touches or jobs. unassign first\");\n    return undefined;\n  }\n  const assignment = { job, touch };\n  assignments.push(assignment);\n  return assignment;\n}\n\nexport function unassign(touch, job, assignments) {\n  function match(assignment) {\n    return assignment.touch.identifier === touch.identifier && assignment.job === job;\n  }\n  assignments.splice(assignments.findIndex(match), 1);\n}\n\nexport function findByJob(job, assignments) {\n  return assignments.find(assignment => {\n    return assignment.job === job;\n  });\n}\n\nexport function findByTouch(touch, assignments) {\n  return assignments.find(assignment => {\n    return assignment.touch.identifier === touch.identifier;\n  });\n}\n","import { addComponent, defineQuery, hasComponent, removeComponent } from \"bitecs\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\nimport {\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredRemoteLeft,\n  HoveredRemoteRight,\n  NotRemoteHoverTarget,\n  RemoteHoverTarget\n} from \"../bit-components\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { sets } from \"../systems/userinput/sets\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\nimport { Layers } from \"./layers\";\n\nexport function findRemoteHoverTarget(world, object3D) {\n  if (!object3D) return null;\n  if (!object3D.eid) return findRemoteHoverTarget(world, object3D.parent);\n  if (hasComponent(world, NotRemoteHoverTarget, object3D.eid)) return null;\n  if (hasComponent(world, RemoteHoverTarget, object3D.eid)) return object3D.eid;\n  return findRemoteHoverTarget(world, object3D.parent);\n}\n\nconst hoveredRightRemoteQuery = defineQuery([HoveredRemoteRight]);\nconst hoveredLeftRemoteQuery = defineQuery([HoveredRemoteLeft]);\n\nconst HIGHLIGHT = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nconst NO_HIGHLIGHT = new THREE.Color(190 / 255, 190 / 255, 190 / 255);\nconst TRANSFORM_COLOR_1 = new THREE.Color(150 / 255, 80 / 255, 150 / 255);\nconst TRANSFORM_COLOR_2 = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nAFRAME.registerComponent(\"cursor-controller\", {\n  schema: {\n    cursor: { type: \"selector\" },\n    camera: { type: \"selector\" },\n    far: { default: 100 },\n    near: { default: 0.01 },\n    defaultDistance: { default: 4 },\n    minDistance: { default: 0.18 }\n  },\n\n  init: function() {\n    this.enabled = false;\n\n    this.cursorVisual = new THREE.Mesh(\n      new THREE.PlaneBufferGeometry(),\n      new THREE.ShaderMaterial({\n        depthTest: false,\n        uniforms: {\n          color: { value: new THREE.Color(0x2f80ed) }\n        },\n        vertexShader: `\n          varying vec2 vPos;\n          void main() {\n            vPos = position.xy;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n            vec2 scale = vec2(\n              length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) ),\n              length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) )\n            );\n\n            float distance = -mvPosition.z;\n            scale *= distance; // negates projection scale\n            scale += min(1.0/distance, 0.3); // scale in screen space\n\n            float radius = 0.02;\n            mvPosition.xy += position.xy * radius * scale;\n            gl_Position = projectionMatrix * mvPosition;\n          }`,\n        fragmentShader: `\n          uniform vec3 color;\n          varying vec2 vPos;\n\n          void main() {\n            float distance = length(vPos);\n            if (distance > 0.5) {\n                discard;\n            }\n\n            gl_FragColor = vec4(\n              mix(color, vec3(0.0), step(0.35, distance)),\n              0.8\n            );\n\n            // #include <tonemapping_fragment>\n            #include <encodings_fragment>\n          }`\n      })\n    );\n\n    const setCursorScale = () => {\n      this.cursorVisual.scale.setScalar(APP.store.state.preferences[\"cursorSize\"] || 1);\n      this.cursorVisual.matrixNeedsUpdate = true;\n    };\n    APP.store.addEventListener(\"statechanged\", setCursorScale);\n    setCursorScale();\n\n    this.cursorVisual.renderOrder = window.APP.RENDER_ORDER.CURSOR;\n    this.cursorVisual.material.transparent = true;\n    this.cursorVisual.layers.set(Layers.CAMERA_LAYER_UI);\n    this.data.cursor.object3D.add(this.cursorVisual);\n\n    this.intersection = null;\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n    this.distance = this.data.far;\n    this.color = this.cursorVisual.material.uniforms.color.value;\n\n    const lineGeometry = new THREE.BufferGeometry();\n    lineGeometry.setAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\n\n    this.line = new THREE.Line(\n      lineGeometry,\n      new THREE.LineBasicMaterial({\n        color: \"white\",\n        opacity: 0.2,\n        transparent: true,\n        visible: false\n      })\n    );\n    this.el.setObject3D(\"line\", this.line);\n  },\n\n  update: function() {\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick2: (() => {\n    const rawIntersections = [];\n    const cameraPos = new THREE.Vector3();\n    const v = new THREE.Vector3();\n\n    return function(t, left) {\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const cursorPose = userinput.get(left ? paths.actions.cursor.left.pose : paths.actions.cursor.right.pose);\n      const hideLine = userinput.get(left ? paths.actions.cursor.left.hideLine : paths.actions.cursor.right.hideLine);\n\n      this.data.cursor.object3D.visible = this.enabled && !!cursorPose;\n      this.line.material.visible = !!(this.enabled && !hideLine);\n\n      this.intersection = null;\n\n      if (!this.enabled || !cursorPose) {\n        return;\n      }\n\n      this.el.sceneEl.systems[\"hubs-systems\"].characterController.avatarPOV.object3D.updateMatrices();\n      const playerScale = v\n        .setFromMatrixColumn(\n          this.el.sceneEl.systems[\"hubs-systems\"].characterController.avatarPOV.object3D.matrixWorld,\n          1\n        )\n        .length();\n      this.raycaster.far = this.data.far * playerScale;\n      this.raycaster.near = this.data.near * playerScale;\n\n      const isGrabbing = left ? anyEntityWith(APP.world, HeldRemoteLeft) : anyEntityWith(APP.world, HeldRemoteRight);\n      let isHoveringSomething = false;\n      if (!isGrabbing) {\n        rawIntersections.length = 0;\n        this.raycaster.ray.origin = cursorPose.position;\n        this.raycaster.ray.direction = cursorPose.direction;\n        this.raycaster.intersectObjects(\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n          true,\n          rawIntersections\n        );\n        this.intersection = rawIntersections[0];\n\n        const remoteHoverTarget = this.intersection && findRemoteHoverTarget(APP.world, this.intersection.object);\n        isHoveringSomething = !!remoteHoverTarget;\n        if (remoteHoverTarget) {\n          addComponent(APP.world, left ? HoveredRemoteLeft : HoveredRemoteRight, remoteHoverTarget);\n        }\n        const hovered = left ? hoveredLeftRemoteQuery(APP.world) : hoveredRightRemoteQuery(APP.world);\n        for (let i = 0; i < hovered.length; i++) {\n          // Unhover anything that should no longer be hovered\n          if (remoteHoverTarget !== hovered[i]) {\n            removeComponent(APP.world, left ? HoveredRemoteLeft : HoveredRemoteRight, hovered[i]);\n          }\n        }\n        this.distance = remoteHoverTarget ? this.intersection.distance : this.data.defaultDistance * playerScale;\n      }\n\n      const { cursor, minDistance, far, camera } = this.data;\n\n      const cursorModDelta =\n        userinput.get(left ? paths.actions.cursor.left.modDelta : paths.actions.cursor.right.modDelta) || 0;\n      if (isGrabbing && !userinput.activeSets.includes(left ? sets.leftCursorHoldingUI : sets.rightCursorHoldingUI)) {\n        this.distance = THREE.MathUtils.clamp(this.distance - cursorModDelta, minDistance, far * playerScale);\n      }\n      cursor.object3D.position.copy(cursorPose.position).addScaledVector(cursorPose.direction, this.distance);\n      // The cursor will always be oriented towards the player about its Y axis, so objects held by the cursor will rotate towards the player.\n      getLastWorldPosition(camera.object3D, cameraPos);\n      cameraPos.y = cursor.object3D.position.y;\n      cursor.object3D.lookAt(cameraPos);\n      cursor.object3D.matrixNeedsUpdate = true;\n\n      // TODO : Check if the selected object being transformed is for this cursor!\n      const transformObjectSystem = AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      if (\n        transformObjectSystem.transforming &&\n        ((left && transformObjectSystem.hand.el.id === \"player-left-controller\") ||\n          (!left && transformObjectSystem.hand.el.id === \"player-right-controller\"))\n      ) {\n        this.color.copy(TRANSFORM_COLOR_1).lerpHSL(TRANSFORM_COLOR_2, 0.5 + 0.5 * Math.sin(t / 1000.0));\n      } else if (isGrabbing || isHoveringSomething) {\n        this.color.copy(HIGHLIGHT);\n      } else {\n        this.color.copy(NO_HIGHLIGHT);\n      }\n\n      if (this.line.material.visible) {\n        const posePosition = cursorPose.position;\n        const cursorPosition = cursor.object3D.position;\n        const positionArray = this.line.geometry.attributes.position.array;\n\n        positionArray[0] = posePosition.x;\n        positionArray[1] = posePosition.y;\n        positionArray[2] = posePosition.z;\n        positionArray[3] = cursorPosition.x;\n        positionArray[4] = cursorPosition.y;\n        positionArray[5] = cursorPosition.z;\n\n        this.line.geometry.attributes.position.needsUpdate = true;\n        this.line.geometry.computeBoundingSphere();\n      }\n    };\n  })()\n});\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { touchIsAssigned, jobIsAssigned, assign, unassign, findByJob, findByTouch } from \"./touchscreen/assignments\";\nimport { findRemoteHoverTarget } from \"../../../components/cursor-controller\";\n// import { canMove } from \"../../../utils/permissions-utils\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { hasComponent } from \"bitecs\";\nimport {\n  AEntity,\n  HeldRemoteRight,\n  OffersRemoteConstraint,\n  Pinnable,\n  Pinned,\n  SingleActionButton,\n  Static\n} from \"../../../bit-components\";\nimport { anyEntityWith } from \"../../../utils/bit-utils\";\n\nconst MOVE_CURSOR_JOB = \"MOVE CURSOR\";\nconst MOVE_CAMERA_JOB = \"MOVE CAMERA\";\nconst FIRST_PINCHER_JOB = \"FIRST PINCHER\";\nconst SECOND_PINCHER_JOB = \"SECOND PINCHER\";\n\nconst TAP_PATHS = [\n  paths.device.touchscreen.tap1,\n  paths.device.touchscreen.tap2,\n  paths.device.touchscreen.tap3,\n  paths.device.touchscreen.tap4,\n  paths.device.touchscreen.tap5\n];\n\nfunction distance(x1, y1, x2, y2) {\n  const dx = x1 - x2;\n  const dy = y1 - y2;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nconst getPlayerCamera = function() {\n  return AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n};\n\nfunction shouldMoveCursor(touch, rect, raycaster) {\n  const isCursorGrabbing = anyEntityWith(APP.world, HeldRemoteRight);\n  if (isCursorGrabbing) return true;\n\n  // Check if this touch might result in an interact or grab eventually\n  const rawIntersections = [];\n  raycaster.setFromCamera(\n    {\n      x: ((touch.clientX - rect.left) / rect.width) * 2 - 1,\n      y: -((touch.clientY - rect.top) / rect.height) * 2 + 1\n    },\n    getPlayerCamera()\n  );\n  raycaster.intersectObjects(\n    AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n    true,\n    rawIntersections\n  );\n  const intersection = rawIntersections[0];\n  const remoteHoverTarget = intersection && findRemoteHoverTarget(APP.world, intersection.object);\n  if (!remoteHoverTarget) return false;\n\n  const isSingleActionButton = hasComponent(APP.world, SingleActionButton, remoteHoverTarget);\n\n  const isInteractable =\n    hasComponent(APP.world, OffersRemoteConstraint, remoteHoverTarget) ||\n    (hasComponent(APP.world, AEntity, remoteHoverTarget) &&\n      APP.world.eid2obj\n        .get(remoteHoverTarget)\n        .el.matches(\".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon\"));\n\n  const isPinned =\n    hasComponent(APP.world, Pinnable, remoteHoverTarget) && hasComponent(APP.world, Pinned, remoteHoverTarget);\n  const isSceneFrozen = AFRAME.scenes[0].is(\"frozen\");\n\n  // TODO isStatic is likely a superfluous check for things matched via OffersRemoteConstraint\n  const isStatic = hasComponent(APP.world, Static, remoteHoverTarget);\n  return (\n    isSingleActionButton || (isInteractable && (isSceneFrozen || !isPinned) && !isStatic)\n    // TODO check canMove\n    //&& (remoteHoverTarget && canMove(remoteHoverTarget))\n  );\n}\n\nexport class AppAwareTouchscreenDevice {\n  constructor() {\n    this.raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(), 0, 100);\n    this.assignments = [];\n    this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n    // When touches appear, this timestamps and then watches for the high water mark of # of touches\n    this.pendingTap = { maxTouchCount: 0, startedAt: 0 };\n    this.tapIndexToWriteNextFrame = 0;\n\n    this.canvas = document.querySelector(\"canvas\");\n\n    this.events = [];\n    [\"touchstart\", \"touchend\", \"touchmove\", \"touchcancel\"].map(x =>\n      this.canvas.addEventListener(x, this.events.push.bind(this.events))\n    );\n    this.canvasRect = this.canvas.getBoundingClientRect();\n    new ResizeObserver(() => (this.canvasRect = this.canvas.getBoundingClientRect())).observe(this.canvas);\n  }\n\n  end(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      console.warn(\"touch does not have a job\", touch);\n    } else {\n      const assignment = findByTouch(touch, this.assignments);\n      switch (assignment.job) {\n        case MOVE_CURSOR_JOB:\n        case MOVE_CAMERA_JOB:\n          // If grab was being delayed, we should fire the initial grab and also delay the unassignment\n          // to ensure we write at least two frames with the grab down (since the action set will change)\n          // and otherwise we'd not see the falling xform.\n          if (assignment.framesUntilGrab > 0) {\n            assignment.framesUntilUnassign = assignment.framesUntilGrab + 2;\n          } else {\n            unassign(assignment.touch, assignment.job, this.assignments);\n          }\n\n          break;\n        case FIRST_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n          if (jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n            const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n            unassign(second.touch, second.job, this.assignments);\n            if (jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n              // reassign secondPincher to firstPincher\n              const first = assign(second.touch, FIRST_PINCHER_JOB, this.assignments);\n              first.clientX = second.clientX;\n              first.clientY = second.clientY;\n            } else {\n              // reassign secondPincher to moveCamera\n              const cameraMover = assign(second.touch, MOVE_CAMERA_JOB, this.assignments);\n              cameraMover.clientX = second.clientX;\n              cameraMover.clientY = second.clientY;\n              cameraMover.delta = [0, 0];\n            }\n          }\n          break;\n        case SECOND_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n          if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && !jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n            //reassign firstPincher to moveCamera\n            const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n            unassign(first.touch, first.job, this.assignments);\n            const cameraMover = assign(first.touch, MOVE_CAMERA_JOB, this.assignments);\n            cameraMover.clientX = first.clientX;\n            cameraMover.clientY = first.clientY;\n            cameraMover.delta = [0, 0];\n          }\n          break;\n      }\n    }\n\n    // Touches cleared, determine what to do with pending tap\n    if (this.assignments.length === 0) {\n      if (this.pendingTap.maxTouchCount > 0 && performance.now() - this.pendingTap.startedAt <= 125) {\n        this.tapIndexToWriteNextFrame = this.pendingTap.maxTouchCount;\n      }\n\n      this.pendingTap = { maxTouchCount: 0 };\n    }\n  }\n\n  move(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      if (!touch.target.classList[0] || !touch.target.classList[0].startsWith(\"virtual-gamepad-controls\")) {\n        console.warn(\"touch does not have job\", touch);\n      }\n      return;\n    }\n\n    const assignment = findByTouch(touch, this.assignments);\n    switch (assignment.job) {\n      case MOVE_CURSOR_JOB:\n        // Don't move the cursor until after the grab so that the grab happens at the touch's initial position\n        if (assignment.framesUntilGrab < 0) {\n          assignment.cursorPose.fromCameraProjection(\n            getPlayerCamera(),\n            ((touch.clientX - this.canvasRect.left) / this.canvasRect.width) * 2 - 1,\n            -((touch.clientY - this.canvasRect.top) / this.canvasRect.height) * 2 + 1\n          );\n        }\n        break;\n      case MOVE_CAMERA_JOB:\n        assignment.delta[0] += touch.clientX - assignment.clientX;\n        assignment.delta[1] += touch.clientY - assignment.clientY;\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        break;\n      case FIRST_PINCHER_JOB:\n      case SECOND_PINCHER_JOB:\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n          const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n          const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n          const currentDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n          this.pinch.delta += currentDistance - this.pinch.currentDistance;\n          this.pinch.currentDistance = currentDistance;\n        }\n        break;\n    }\n  }\n\n  start(touch) {\n    if (touchIsAssigned(touch, this.assignments)) {\n      console.error(\"touch already has a job\");\n      return;\n    }\n\n    const isFirstTouch = this.assignments.length === 0;\n    const isSecondTouch = this.assignments.length === 1;\n    const isThirdTouch = this.assignments.length === 2;\n\n    const hasSecondPinch = !!findByJob(SECOND_PINCHER_JOB, this.assignments);\n\n    if (isFirstTouch || (isThirdTouch && hasSecondPinch)) {\n      let assignment;\n\n      // First touch or third touch and other two fingers were pinching\n      if (shouldMoveCursor(touch, this.canvasRect, this.raycaster)) {\n        assignment = assign(touch, MOVE_CURSOR_JOB, this.assignments);\n\n        // Grabbing objects is delayed by several frames:\n        // - We don't want the physics constraint to be applied too early, which results in crazy velocities\n        // - We don't want to mis-trigger grabs if the user is about to put down a second finger.\n        assignment.framesUntilGrab = 8;\n      } else {\n        assignment = assign(touch, MOVE_CAMERA_JOB, this.assignments);\n        assignment.delta = [0, 0];\n      }\n\n      assignment.clientX = touch.clientX;\n      assignment.clientY = touch.clientY;\n\n      // On touch down, we always move the cursor on the first frame, but the MOVE_CURSOR_JOB indicates\n      // the touch will then track the cursor (instead of the camera)\n      assignment.cursorPose = new Pose().fromCameraProjection(\n        getPlayerCamera(),\n        ((touch.clientX - this.canvasRect.left) / this.canvasRect.width) * 2 - 1,\n        -((touch.clientY - this.canvasRect.top) / this.canvasRect.height) * 2 + 1\n      );\n    } else if (isSecondTouch || isThirdTouch) {\n      const cursorJob = findByJob(MOVE_CURSOR_JOB, this.assignments);\n\n      if (isSecondTouch && cursorJob && cursorJob.framesUntilGrab < 0) {\n        // The second touch is happening after grab activated, so assign this touch to first pinch.\n        const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n        first.clientX = touch.clientX;\n        first.clientY = touch.clientY;\n      } else {\n        // Second or third touch, but third touch only if not pinching\n        if (isSecondTouch) {\n          // The second touch is happening before the grab activated, so re-assign the first\n          // to the first pinch, and effectively cancel the grab.\n          const previousAssignment = this.assignments[0];\n          unassign(previousAssignment.touch, previousAssignment.job, this.assignments);\n          const first = assign(previousAssignment.touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = previousAssignment.clientX;\n          first.clientY = previousAssignment.clientY;\n        }\n\n        const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n\n        if (!first) {\n          const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = touch.clientX;\n          first.clientY = touch.clientY;\n          return;\n        } else {\n          const second = assign(touch, SECOND_PINCHER_JOB, this.assignments);\n          second.clientX = touch.clientX;\n          second.clientY = touch.clientY;\n\n          const initialDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n\n          this.pinch = {\n            initialDistance,\n            currentDistance: initialDistance,\n            delta: 0\n          };\n        }\n      }\n    }\n\n    if (this.pendingTap.maxTouchCount === 0 && this.assignments.length > 0) {\n      this.pendingTap.startedAt = performance.now();\n    }\n\n    this.pendingTap.maxTouchCount = Math.max(this.pendingTap.maxTouchCount, this.assignments.length);\n  }\n\n  process(event) {\n    switch (event.type) {\n      case \"touchstart\":\n        for (const touch of event.changedTouches) {\n          this.start(touch);\n        }\n        break;\n      case \"touchmove\":\n        for (const touch of event.touches) {\n          this.move(touch);\n        }\n        break;\n      case \"touchend\":\n      case \"touchcancel\":\n        for (const touch of event.changedTouches) {\n          this.end(touch);\n        }\n        break;\n    }\n  }\n\n  write(frame) {\n    if (this.pinch) {\n      this.pinch.delta = 0;\n    }\n    const cameraMover =\n      jobIsAssigned(MOVE_CAMERA_JOB, this.assignments) && findByJob(MOVE_CAMERA_JOB, this.assignments);\n    if (cameraMover) {\n      cameraMover.delta[0] = 0;\n      cameraMover.delta[1] = 0;\n    }\n\n    this.events.forEach(event => {\n      this.process(event);\n    });\n    while (this.events.length) {\n      this.events.pop();\n    }\n\n    const path = paths.device.touchscreen;\n    const hasCursorJob = jobIsAssigned(MOVE_CURSOR_JOB, this.assignments);\n    const hasCameraJob = jobIsAssigned(MOVE_CAMERA_JOB, this.assignments);\n\n    if (hasCursorJob || hasCameraJob) {\n      frame.setValueType(path.isTouching, true);\n\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments) || findByJob(MOVE_CAMERA_JOB, this.assignments);\n      frame.setPose(path.cursorPose, assignment.cursorPose);\n      this.lastPose = assignment.cursorPose;\n    } else if (this.lastPose) {\n      // TODO We want to be able to \"hover\" on things with the touchscreen so we keep the cursor at its last know position\n      // This is not ideal but its also unclear what the \"right\" interaction for this should be on a touchscreen.\n      frame.setPose(path.cursorPose, this.lastPose);\n    }\n\n    frame.setValueType(path.isTouchingGrabbable, false);\n\n    if (hasCursorJob) {\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments);\n      frame.setValueType(path.isTouchingGrabbable, assignment.framesUntilGrab <= 0);\n      assignment.framesUntilGrab--;\n\n      if (assignment.framesUntilUnassign >= 0) {\n        if (assignment.framesUntilUnassign === 0) {\n          unassign(assignment.touch, assignment.job, this.assignments);\n        }\n\n        assignment.framesUntilUnassign--;\n      }\n    }\n\n    if (hasCameraJob) {\n      const delta = findByJob(MOVE_CAMERA_JOB, this.assignments).delta;\n      frame.setVector2(path.touchCameraDelta, delta[0] / this.canvas.clientWidth, delta[1] / this.canvas.clientHeight);\n    }\n\n    frame.setValueType(path.pinch.delta, this.pinch.delta);\n    frame.setValueType(path.pinch.initialDistance, this.pinch.initialDistance);\n    frame.setValueType(path.pinch.currentDistance, this.pinch.currentDistance);\n\n    if (this.tapIndexToWriteNextFrame && this.tapIndexToWriteNextFrame < TAP_PATHS.length) {\n      // write to tap-X path if we had an X-fingered tap\n      frame.setValueType(TAP_PATHS[this.tapIndexToWriteNextFrame - 1], true);\n    }\n\n    this.tapIndexToWriteNextFrame = 0;\n\n    frame.setValueType(path.anything, this.assignments.length !== 0);\n  }\n}\n","export function angleTo4Direction(angle) {\n  angle = (angle * THREE.MathUtils.RAD2DEG + 180 + 45) % 360;\n  if (angle > 0 && angle < 90) {\n    return \"north\";\n  } else if (angle >= 90 && angle < 180) {\n    return \"west\";\n  } else if (angle >= 180 && angle < 270) {\n    return \"south\";\n  } else {\n    return \"east\";\n  }\n}\n\nexport function angleTo8Direction(angle) {\n  angle = (angle * THREE.MathUtils.RAD2DEG + 180 + 45) % 360;\n  let direction = \"\";\n  if ((angle >= 0 && angle < 120) || angle >= 330) {\n    direction += \"north\";\n  }\n  if (angle >= 150 && angle < 300) {\n    direction += \"south\";\n  }\n  if (angle >= 60 && angle < 210) {\n    direction += \"west\";\n  }\n  if ((angle >= 240 && angle < 360) || angle < 30) {\n    direction += \"east\";\n  }\n  return direction;\n}\n","import { Pose } from \"../pose\";\nimport { angleTo4Direction } from \"../../../utils/dpad\";\n\nexport const xforms = {\n  noop: function() {},\n  copy: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.value));\n  },\n  scale: function(scalar) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        frame.setValueType(dest.value, frame.get(src.value) * scalar);\n      }\n    };\n  },\n  scaleExp: function(scalar, exp = 1) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        if (exp === 1) {\n          frame.setValueType(dest.value, frame.get(src.value) * scalar);\n        } else {\n          frame.setValueType(dest.value, Math.pow(frame.get(src.value), exp) * scalar);\n        }\n      }\n    };\n  },\n  deadzone: function(deadzoneSize) {\n    return function deadzone(frame, src, dest) {\n      frame.setValueType(dest.value, Math.abs(frame.get(src.value)) < deadzoneSize ? 0 : frame.get(src.value));\n    };\n  },\n  split_vec2: function(frame, src, dest) {\n    const value = frame.get(src.value);\n    if (value !== undefined) {\n      frame.setValueType(dest.x, value[0]);\n      frame.setValueType(dest.y, value[1]);\n    }\n  },\n  compose_vec2: function(frame, src, dest) {\n    const x = frame.get(src.x);\n    const y = frame.get(src.y);\n    if (x !== undefined && y !== undefined) {\n      frame.setVector2(dest.value, x, y);\n    }\n  },\n  negate: function(frame, src, dest) {\n    frame.setValueType(dest.value, -frame.get(src.value));\n  },\n  copyIfFalse: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? undefined : frame.get(src.value));\n  },\n  copyIfTrue: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? frame.get(src.value) : undefined);\n  },\n  copyVec2IfTrue: function(frame, src, dest) {\n    if (frame.get(src.bool)) {\n      const v2 = frame.get(src.value);\n      frame.setVector2(dest.value, v2[0], v2[1]);\n    }\n  },\n  zeroIfDefined: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) !== undefined ? 0 : frame.get(src.value));\n  },\n  true: function(frame, src, dest) {\n    frame.setValueType(dest.value, true);\n  },\n  rising: function rising(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, frame.get(src.value) && prevState === false);\n    return !!frame.get(src.value);\n  },\n  risingWithFrameDelay: function(n) {\n    return function risingWithFrameDelay(frame, src, dest, state = { values: new Array(n) }) {\n      frame.setValueType(dest.value, state.values.shift());\n      state.values.push(frame.get(src.value) && !state.prev);\n      state.prev = frame.get(src.value);\n      return state;\n    };\n  },\n  falling: function falling(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, !frame.get(src.value) && prevState);\n    return !!frame.get(src.value);\n  },\n  vec2Zero: function(frame, _, dest) {\n    frame.setVector2(dest.value, 0, 0);\n  },\n  poseFromCameraProjection: function() {\n    const pose = new Pose();\n    return function poseFromCameraProjection(frame, src, dest) {\n      const camera = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.viewingCamera;\n      const value = frame.get(src.value);\n      frame.setPose(dest.value, pose.fromCameraProjection(camera, value[0], value[1]));\n    };\n  },\n  vec2dpad: function(deadzoneRadius, invertX = false, invertY = false) {\n    const deadzoneRadiusSquared = deadzoneRadius * deadzoneRadius;\n\n    return function vec2dpad(frame, src, dest) {\n      if (!frame.get(src.value)) return;\n      const [x, y] = frame.get(src.value);\n      const inCenter = x * x + y * y < deadzoneRadiusSquared;\n      const direction = inCenter ? \"center\" : angleTo4Direction(Math.atan2(invertX ? -x : x, invertY ? -y : y));\n      if (!dest[direction]) return;\n      frame.setValueType(dest[direction], true);\n    };\n  },\n  always: function(constValue) {\n    return function always(frame, _, dest) {\n      frame.setValueType(dest.value, constValue);\n    };\n  },\n  wasd_to_vec2: function(frame, { w, a, s, d }, { vec2 }) {\n    let x = 0;\n    let y = 0;\n    if (frame.get(a)) x -= 1;\n    if (frame.get(d)) x += 1;\n    if (frame.get(w)) y += 1;\n    if (frame.get(s)) y -= 1;\n    frame.setVector2(vec2, x, y);\n  },\n  add_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      frame.setVector2(dest.value, first[0] + second[0], first[1] + second[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  max_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      const max =\n        first[0] * first[0] + first[1] * first[1] > second[0] * second[0] + second[1] * second[1] ? first : second;\n      frame.setVector2(dest.value, max[0], max[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  normalize_vec2: function(frame, src, dest) {\n    const vec2 = frame.get(src.value);\n    if (vec2) {\n      if (vec2[0] === 0 && vec2[0] === 0) {\n        frame.setVector2(dest.value, vec2[0], vec2[1]);\n      } else {\n        const l = Math.sqrt(vec2[0] * vec2[0] + vec2[1] * vec2[1]);\n        frame.setVector2(dest.value, vec2[0] / l, vec2[1] / l);\n      }\n    }\n  },\n  all: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (!frame.get(path)) {\n        frame.setValueType(dest.value, false);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, true);\n  },\n  any: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (frame.get(path)) {\n        frame.setValueType(dest.value, true);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, false);\n  },\n  touch_axis_scroll(scale = 1, snap_to) {\n    return function touch_axis_scroll(frame, src, dest, state = { value: 0, touching: false }) {\n      if (snap_to === undefined || Math.abs(frame.get(src.value) - state.value) >= snap_to) {\n        frame.setValueType(\n          dest.value,\n          state.touching && frame.get(src.touching) ? scale * (frame.get(src.value) - state.value) : 0\n        );\n      }\n\n      state.value = frame.get(src.value);\n      state.touching = frame.get(src.touching);\n\n      return state;\n    };\n  },\n  diff_vec2: function diff_vec2(frame, src, dest, state = [0, 0]) {\n    const v2 = frame.get(src.value);\n    if (v2) {\n      frame.setVector2(dest.value, v2[0] - state[0], v2[1] - state[1]);\n      state[0] = v2[0];\n      state[1] = v2[1];\n    }\n    return state;\n  },\n  invert_vec2_if_preference(preference) {\n    return function invert_vec2_if_preference(frame, src, dest) {\n      const vec2 = frame.get(src.value);\n      if (vec2) {\n        const invert =\n          window.APP &&\n          window.APP.store &&\n          window.APP.store.state &&\n          window.APP.store.state.preferences &&\n          (window.APP.store.state.preferences[preference] ||\n            window.APP.store.state.preferences[preference] === undefined);\n        const oneOrMinusOne = invert ? -1 : 1;\n        frame.setVector2(dest.value, vec2[0] * oneOrMinusOne, vec2[1] * oneOrMinusOne);\n      }\n    };\n  }\n};\n","export const addSetsToBindings = mapping => {\n  for (const setName in mapping) {\n    for (const binding of mapping[setName]) {\n      if (!binding.sets) {\n        binding.sets = [];\n      }\n      binding.sets.push(setName);\n    }\n  }\n  return mapping;\n};\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// import { Pose } from \"../pose\";\n\nconst wasd_vec2 = \"/var/mouse-and-keyboard/wasd_vec2\";\nconst keyboardCharacterAcceleration = \"/var/mouse-and-keyboard/keyboardCharacterAcceleration\";\nconst arrows_vec2 = \"/var/mouse-and-keyboard/arrows_vec2\";\nconst togglePenWithRMB = \"/vars/mouse-and-keyboard/drop_pen_with_RMB\";\nconst togglePenWithEsc = \"/vars/mouse-and-keyboard/drop_pen_with_esc\";\nconst togglePenWithP = \"/vars/mouse-and-keyboard/drop_pen_with_p\";\nconst togglePenWithHud = \"/vars/mouse-and-keyboard/drop_pen_with_hud\";\nconst togglePen = \"/vars/mouse-and-keyboard/togglePen\";\nconst startInspectingViaMouse = \"/vars/mouse-and-keyboard/startInspectingViaMouse\";\nconst startInspectingViaKeyboard = \"/vars/mouse-and-keyboard/startInspectingViaKeyboard\";\nconst stopInspectingViaKeyboard = \"/vars/mouse-and-keyboard/stopInspectingViaKeyboard\";\nconst stopInspectingViaKeyboardFocus = \"/vars/mouse-and-keyboard/stopInspectingViaKeyboardFocus\";\nconst stopInspectingSelf = \"/vars/mouse-and-keyboard/stopInspectingSelf\";\n\nconst qs = new URLSearchParams(location.search);\nconst inspectZoomSpeed = parseFloat(qs.get(\"izs\")) || -10.0;\n\nconst k = name => {\n  return `/keyboard-mouse-user/keyboard-var/${name}`;\n};\n\nexport const keyboardMouseUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.always(true)\n    },\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.always(false)\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: keyboardCharacterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.dCharSpeed },\n      xform: xforms.scale(-0.3)\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.camera.exitMirror },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"g\") },\n      dest: { value: paths.actions.toggleFly },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"`\") },\n      dest: { value: paths.actions.toggleUI },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: togglePenWithP },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePenWithHud },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithHud, togglePenWithP],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.smartMouse.cursorPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.mouse.coords },\n      dest: { value: \"/var/mouseCoordsDelta\" },\n      xform: xforms.diff_vec2\n    },\n    {\n      src: { value: \"/var/mouseCoordsDelta\" },\n      dest: { x: \"/var/mouseCoordsX\", y: \"/var/mouseCoordsY\" },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: \"/var/mouseCoordsX\" },\n      dest: { value: \"/var/mouseCoordsXScaled\" },\n      xform: xforms.scale(-Math.PI)\n    },\n    {\n      src: { value: \"/var/mouseCoordsY\" },\n      dest: { value: \"/var/mouseCoordsYScaled\" },\n      xform: xforms.scale((2 * Math.PI) / 3)\n    },\n    {\n      src: { x: \"/var/mouseCoordsXScaled\", y: \"/var/mouseCoordsYScaled\" },\n      dest: { value: \"/var/actions/cameraDelta\" },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: \"/var/actions/cameraDelta\",\n        bool: paths.device.smartMouse.shouldMoveCamera\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.copyVec2IfTrue\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/control+1\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/control+2\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/control+3\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/control+4\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/control+5\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/control+6\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/control+7\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/control+8\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling,\n      priority: 100\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"o\") },\n      dest: { value: paths.actions.nextCameraMode },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/notcontrol+1\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+1\" },\n      dest: { value: paths.actions.spawnEmoji0 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/notcontrol+2\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+2\" },\n      dest: { value: paths.actions.spawnEmoji1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/notcontrol+3\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+3\" },\n      dest: { value: paths.actions.spawnEmoji2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/notcontrol+4\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+4\" },\n      dest: { value: paths.actions.spawnEmoji3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/notcontrol+5\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+5\" },\n      dest: { value: paths.actions.spawnEmoji4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/notcontrol+6\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+6\" },\n      dest: { value: paths.actions.spawnEmoji5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/notcontrol+7\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notcontrol+7\" },\n      dest: { value: paths.actions.spawnEmoji6 },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"i\") },\n      dest: { value: paths.actions.startInspectingSelf },\n      xform: xforms.rising\n    }\n\n    // Helpful bindings for debugging hands in 2D\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.rightHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(0.2, 1.3, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // },\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.leftHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(-0.2, 1.4, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // }\n  ],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/shift+q\" },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/shift+q\" },\n      dest: { value: paths.actions.cursor.right.penPrevColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/shift+e\" },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/shift+e\" },\n      dest: { value: paths.actions.cursor.right.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/notshift+q\" },\n      xform: xforms.copyIfFalse,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/notshift+q\" },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/notshift+e\" },\n      xform: xforms.copyIfFalse,\n      priority: 1\n    },\n    {\n      src: { value: \"/var/notshift+e\" },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: \"/var/cursorScalePenTipWheel\" },\n      xform: xforms.copy,\n      priority: 200\n    },\n    {\n      src: { value: \"/var/cursorScalePenTipWheel\" },\n      dest: { value: paths.actions.cursor.right.scalePenTip },\n      xform: xforms.scale(0.03)\n    },\n    {\n      src: { value: paths.device.mouse.buttonRight },\n      dest: { value: togglePenWithRMB },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: togglePenWithEsc },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithRMB, togglePenWithEsc, togglePenWithP, togglePenWithHud],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"z\")\n      },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      priority: 1001,\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 200\n    }\n  ],\n\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: paths.actions.cursor.right.scaleGrabbedGrabbable },\n      xform: xforms.noop,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithShift\")\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithoutShift\")\n      },\n      xform: xforms.copyIfFalse,\n      priority: 1\n    },\n    {\n      src: {\n        value: k(\"wheelWithoutShift\")\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: paths.actions.cursor.right.scaleGrabbedGrabbable },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.transformModifier },\n      xform: xforms.copy,\n      priority: 1\n    }\n  ],\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.mouse.buttonRight },\n      dest: { value: startInspectingViaMouse },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"f\") },\n      dest: { value: startInspectingViaKeyboard },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: [startInspectingViaMouse, startInspectingViaKeyboard],\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.any,\n      priority: 201\n    }\n  ],\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(-0.3),\n      priority: 1\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/control+1\" },\n      xform: xforms.copyIfTrue,\n      priority: 1001\n    },\n    {\n      src: { value: \"/var/control+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/control+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/control+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/control+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/control+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/control+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/control+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/control+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/control+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.inspecting]: [\n    {\n      src: { value: paths.device.keyboard.key(\"space\") },\n      dest: { value: k(\"space-rising\") },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        paths.device.keyboard.key(\"Escape\"),\n        paths.device.keyboard.key(\"w\"),\n        paths.device.keyboard.key(\"a\"),\n        paths.device.keyboard.key(\"s\"),\n        paths.device.keyboard.key(\"d\"),\n        paths.device.keyboard.key(\"q\"),\n        paths.device.keyboard.key(\"e\"),\n        k(\"space-rising\")\n      ],\n      dest: { value: stopInspectingViaKeyboard },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.inspectZoom },\n      xform: xforms.scale(inspectZoomSpeed),\n      priority: 1\n    },\n    {\n      src: { value: paths.device.mouse.movementXY },\n      dest: { x: \"/var/movementX\", y: \"/var/movementY\" },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { bool: paths.device.mouse.buttonMiddle, value: \"/var/movementY\" },\n      dest: { value: \"/var/middle-mouse-move-y\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/middle-mouse-move-y\" },\n      dest: { value: paths.actions.inspectPanY },\n      xform: xforms.scale(0.001)\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"f\") },\n      dest: { value: stopInspectingViaKeyboardFocus },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"i\") },\n      dest: { value: stopInspectingSelf },\n      xform: xforms.rising\n    },\n    {\n      src: [stopInspectingViaKeyboard, stopInspectingViaKeyboardFocus, stopInspectingSelf],\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.any\n    }\n  ],\n  [sets.debugUserInput]: [\n    {\n      src: { value: paths.device.keyboard.key(\"m\") },\n      dest: { value: paths.actions.debugUserInput.describeCurrentMasks },\n      xform: xforms.rising,\n      priority: 10\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst zero = \"/vars/touchscreen/zero\";\nconst forward = \"/vars/touchscreen/pinchDeltaForward\";\nconst touchCamDeltaMaybeInverted = \"vars/touchscreen/touchCameraDeltaMaybeInverted\";\nconst touchCamDelta = \"vars/touchscreen/touchCameraDelta\";\nconst touchCamDeltaX = \"vars/touchscreen/touchCameraDelta/x\";\nconst touchCamDeltaY = \"vars/touchscreen/touchCameraDelta/y\";\nconst touchCamDeltaXScaled = \"vars/touchscreen/touchCameraDelta/x/scaled\";\nconst touchCamDeltaYScaled = \"vars/touchscreen/touchCameraDelta/y/scaled\";\nconst gyroCamDelta = \"vars/gyro/gyroCameraDelta\";\nconst gyroCamDeltaXScaled = \"vars/gyro/gyroCameraDelta/x/scaled\";\nconst gyroCamDeltaYScaled = \"vars/gyro/gyroCameraDelta/y/scaled\";\nconst togglePen = \"/vars/touchscreen/togglePen\";\n\nexport const touchscreenUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: paths.device.touchscreen.pinch.delta },\n      dest: { value: forward },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: { value: paths.device.touchscreen.tap2 },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.copy\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: { x: zero, y: forward },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.touchscreen.cursorPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.touchCameraDelta },\n      dest: { x: touchCamDeltaX, y: touchCamDeltaY },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: touchCamDeltaX },\n      dest: { value: touchCamDeltaXScaled },\n      xform: xforms.scale(-Math.PI)\n    },\n    {\n      src: { value: touchCamDeltaY },\n      dest: { value: touchCamDeltaYScaled },\n      xform: xforms.scale(-Math.PI / 2)\n    },\n    {\n      src: { x: touchCamDeltaXScaled, y: touchCamDeltaYScaled },\n      dest: { value: touchCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: touchCamDelta },\n      dest: { value: touchCamDeltaMaybeInverted },\n      xform: xforms.invert_vec2_if_preference(\"invertTouchscreenCameraMove\")\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaX },\n      dest: { value: gyroCamDeltaXScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaY },\n      dest: { value: gyroCamDeltaYScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { x: gyroCamDeltaYScaled, y: gyroCamDeltaXScaled },\n      dest: { value: gyroCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: touchCamDeltaMaybeInverted,\n        second: gyroCamDelta\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.add_vec2\n    },\n    {\n      src: { value: touchCamDeltaMaybeInverted },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.risingWithFrameDelay(5),\n      priority: 2\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 3\n    }\n  ],\n\n  [sets.inspecting]: [\n    {\n      src: { value: paths.device.touchscreen.pinch.delta },\n      dest: { value: paths.actions.inspectZoom },\n      xform: xforms.scale(0.025),\n      priority: 1\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const keyboardDebuggingBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst name = \"/touch/var/\";\n\nconst leftButton = paths.device.leftOculusTouch.button;\nconst leftAxis = paths.device.leftOculusTouch.axis;\nconst leftPose = paths.device.leftOculusTouch.pose;\nconst rightButton = paths.device.rightOculusTouch.button;\nconst rightAxis = paths.device.rightOculusTouch.axis;\nconst rightPose = paths.device.rightOculusTouch.pose;\n\nconst wakeLeft = `${name}left/wake`;\nconst wakeRight = `${name}right/wake`;\nconst leftJoyXDeadzoned = `${name}left/joy/x/deadzoned`;\nconst leftJoyYDeadzoned = `${name}left/joy/y/deadzoned`;\nconst scaledLeftJoyX = `${name}left/scaledJoyX`;\nconst scaledLeftJoyY = `${name}left/scaledJoyY`;\nconst cursorDrop2 = `${name}right/cursorDrop2`;\nconst cursorDrop1 = `${name}right/cursorDrop1`;\nconst leftCursorDrop2 = `${name}left/cursorDrop2`;\nconst leftCursorDrop1 = `${name}left/cursorDrop1`;\nconst rightHandDrop2 = `${name}right/rightHandDrop2`;\nconst rightGripRisingGrab = `${name}right/grip/RisingGrab`;\nconst rightTriggerRisingGrab = `${name}right/trigger/RisingGrab`;\nconst leftGripRisingGrab = `${name}left/grip/RisingGrab`;\nconst leftTriggerRisingGrab = `${name}left/trigger/RisingGrab`;\nconst rightDpadNorth = `${name}rightDpad/north`;\nconst rightDpadSouth = `${name}rightDpad/south`;\nconst rightDpadEast = `${name}rightDpad/east`;\nconst rightDpadWest = `${name}rightDpad/west`;\nconst rightDpadCenter = `${name}rightDpad/center`;\nconst rightJoy = `${name}right/joy`;\nconst rightJoyY1 = `${name}right/joyY1`;\nconst rightJoyY2 = `${name}right/joyY2`;\nconst rightJoyYDeadzoned = `${name}right/joy/y/deadzoned`;\nconst leftDpadNorth = `${name}leftDpad/north`;\nconst leftDpadSouth = `${name}leftDpad/south`;\nconst leftDpadEast = `${name}leftDpad/east`;\nconst leftDpadWest = `${name}leftDpad/west`;\nconst leftDpadCenter = `${name}leftDpad/center`;\nconst leftJoy = `${name}left/joy`;\nconst oculusTouchCharacterAcceleration = `${name}characterAcceleration`;\nconst keyboardCharacterAcceleration = \"/var/keyboard/characterAcceleration\";\nconst characterAcceleration = \"/var/oculus-touch/nonNormalizedCharacterAcceleration\";\nconst wasd_vec2 = \"/var/keyboard/wasd_vec2\";\nconst arrows_vec2 = \"/var/keyboard/arrows_vec2\";\nconst keyboardBoost = \"/var/keyboard-oculus/boost\";\nconst rightBoost = \"/var/right-oculus/boost\";\nconst leftBoost = \"/var/left-oculus/boost\";\nconst rightTouchSnapRight = `${name}/right/snap-right`;\nconst rightTouchSnapLeft = `${name}/right/snap-left`;\nconst keyboardSnapRight = `${name}/keyboard/snap-right`;\nconst keyboardSnapLeft = `${name}/keyboard/snap-left`;\n\nconst lowerButtons = `${name}buttons/lower`;\nconst upperButtons = `${name}buttons/upper`;\n\nconst ensureFrozenViaButtons = `${name}buttons/ensureFrozen`;\nconst ensureFrozenViaKeyboard = `${name}keyboard/ensureFrozen`;\n\nconst thawViaButtons = `${name}buttons/thaw`;\nconst thawViaKeyboard = `${name}keyboard/thaw`;\n\nconst v = s => {\n  return \"/oculus-touch-user-vars/\" + s;\n};\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\n\nexport const oculusTouchUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.leftOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.rightOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaButtons, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaButtons, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").touched, leftButton(\"y\").touched, leftButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rightButton(\"a\").touched, rightButton(\"b\").touched, rightButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: leftAxis(\"joyX\"),\n        y: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: leftJoy\n      },\n      dest: {\n        north: leftDpadNorth,\n        south: leftDpadSouth,\n        east: leftDpadEast,\n        west: leftDpadWest,\n        center: leftDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY2 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rightAxis(\"joyX\"),\n        y: rightJoyY1\n      },\n      dest: {\n        value: rightJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rightJoy\n      },\n      dest: {\n        north: rightDpadNorth,\n        south: rightDpadSouth,\n        east: rightDpadEast,\n        west: rightDpadWest,\n        center: rightDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: rightTouchSnapRight\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapRight, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").pressed, rightButton(\"a\").pressed],\n      dest: { value: lowerButtons },\n      xform: xforms.any\n    },\n    {\n      src: [leftButton(\"y\").pressed, rightButton(\"b\").pressed],\n      dest: { value: upperButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: ensureFrozenViaButtons },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: thawViaButtons },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: rightTouchSnapLeft\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapLeft, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyYDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyY\n      },\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: leftAxis(\"joyX\")\n      },\n      dest: {\n        value: leftJoyXDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyXDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyX\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        x: scaledLeftJoyX,\n        y: scaledLeftJoyY\n      },\n      dest: { value: oculusTouchCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: oculusTouchCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        value: characterAcceleration,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"y\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"b\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"thumbStick\").pressed\n      },\n      dest: {\n        value: paths.actions.nextCameraMode\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: rightButton(\"thumbStick\").pressed\n      },\n      dest: {\n        value: paths.actions.toggleFly\n      },\n      xform: xforms.rising\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.cursor.left.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [\n        leftButton(\"y\").pressed,\n        leftButton(\"x\").pressed,\n        leftButton(\"trigger\").pressed,\n        leftButton(\"grip\").pressed\n      ],\n      dest: { value: wakeLeft },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeLeft },\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        rightButton(\"b\").pressed,\n        rightButton(\"a\").pressed,\n        rightButton(\"trigger\").pressed,\n        rightButton(\"grip\").pressed\n      ],\n      dest: { value: wakeRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeRight },\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoveringOnUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.leftCursorHoveringOnVideo]: [\n    {\n      src: { value: leftAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.rightCursorHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftCursorHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.inspecting]: [\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: leftDpadEast,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: leftDpadWest,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"y\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"x\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftCursorHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n  [sets.leftCursorHoldingUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftCursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoldingInteractable]: [\n    {\n      src: { value: leftAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftCursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [leftCursorDrop1, leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n  [sets.leftCursorHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: leftButton(\"y\").pressed },\n      dest: { value: paths.actions.cursor.left.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: {\n        value: rightHandDrop2\n      },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [rightHandDrop2],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: {\n        value: rightJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rightJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 2\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightButton(\"a\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftCursorHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst leftButton = paths.device.webxr.left.button;\nconst leftAxis = paths.device.webxr.left.axis;\nconst leftPose = paths.device.webxr.left.pose;\nconst rightButton = paths.device.webxr.right.button;\nconst rightAxis = paths.device.webxr.right.axis;\nconst rightPose = paths.device.webxr.right.pose;\n\nconst v = path => \"/webxr/var/\" + path;\nconst wakeLeft = v(\"left/wake\");\nconst wakeRight = v(\"right/wake\");\nconst leftJoyXDeadzoned = v(\"left/joy/x/deadzoned\");\nconst leftJoyYDeadzoned = v(\"left/joy/y/deadzoned\");\nconst scaledLeftJoyX = v(\"left/scaledJoyX\");\nconst scaledLeftJoyY = v(\"left/scaledJoyY\");\nconst cursorDrop1 = v(\"right/cursorDrop1\");\nconst cursorDrop2 = v(\"right/cursorDrop2\");\nconst cursorDrop3 = v(\"right/cursorDrop3\");\nconst leftCursorDrop2 = v(\"left/cursorDrop2\");\nconst leftCursorDrop1 = v(\"left/cursorDrop1\");\nconst rightHandDrop2 = v(\"right/rightHandDrop2\");\nconst rightGripRisingGrab = v(\"right/grip/RisingGrab\");\nconst leftGripRisingGrab = v(\"left/grip/RisingGrab\");\nconst rightDpadNorth = v(\"rightDpad/north\");\nconst rightDpadSouth = v(\"rightDpad/south\");\nconst rightDpadEast = v(\"rightDpad/east\");\nconst rightDpadWest = v(\"rightDpad/west\");\nconst rightDpadCenter = v(\"rightDpad/center\");\nconst rightJoy = v(\"right/joy\");\nconst rightJoyY1 = v(\"right/joyY1\");\nconst rightJoyYDeadzoned = v(\"right/joy/y/deadzoned\");\nconst leftDpadNorth = v(\"leftDpad/north\");\nconst leftDpadSouth = v(\"leftDpad/south\");\nconst leftDpadEast = v(\"leftDpad/east\");\nconst leftDpadWest = v(\"leftDpad/west\");\nconst leftDpadCenter = v(\"leftDpad/center\");\nconst leftJoy = v(\"left/joy\");\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\nconst rightBoost = v(\"right/boost\");\nconst leftBoost = v(\"left/boost\");\nconst lowerButtons = v(\"buttons/lower\");\nconst upperButtons = v(\"buttons/upper\");\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\nconst touchpad = v(\"touchpad\");\nconst touchpadRising = v(\"touchpad/rising\");\nconst dpadNorth = v(\"dpadNorth\");\nconst dpadSouth = v(\"dpadSouth\");\nconst dpadEast = v(\"dpadEast\");\nconst dpadWest = v(\"dpadWest\");\nconst dpadCenter = v(\"dpadCenter\");\nconst dpadCenterStrip = v(\"dpadCenterStrip\");\nconst snapRotateRight1 = v(\"snapRotateRight1\");\nconst snapRotateRight2 = v(\"snapRotateRight2\");\nconst snapRotateLeft1 = v(\"snapRotateLeft1\");\nconst snapRotateLeft2 = v(\"snapRotateLeft2\");\nconst centerStripPressed = v(\"centerStripPressed\");\nconst touchpadReleased = v(\"touchpadReleased\");\nconst lowerButtonsReleased = v(\"lowerButtonsReleased\");\n\nexport const webXRUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.webxr.left.matrix },\n      dest: { value: paths.actions.leftHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.webxr.right.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.grip.pressed },\n      dest: { value: leftGripPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.grip.pressed },\n      dest: { value: leftGripPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftGripPressed1 },\n      dest: { value: paths.actions.leftHand.middleRingPinky },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton.a.touched, leftButton.b.touched, leftButton.thumbStick.touched],\n      dest: { value: paths.actions.leftHand.thumb },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftButton.trigger.pressed },\n      dest: { value: leftTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.trigger.pressed },\n      dest: { value: leftTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: { value: paths.actions.leftHand.index },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.grip.pressed },\n      dest: { value: rightGripPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.grip.pressed },\n      dest: { value: rightGripPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightGripPressed1 },\n      dest: { value: paths.actions.rightHand.middleRingPinky },\n      xform: xforms.copy\n    },\n    {\n      src: [rightButton.a.touched, rightButton.b.touched, rightButton.thumbStick.touched],\n      dest: { value: paths.actions.rightHand.thumb },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton.trigger.pressed },\n      dest: { value: rightTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.trigger.pressed },\n      dest: { value: rightTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: { value: paths.actions.rightHand.index },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: leftAxis.joyX,\n        y: leftAxis.joyY\n      },\n      dest: { value: leftJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: leftJoy },\n      dest: {\n        north: leftDpadNorth,\n        south: leftDpadSouth,\n        east: leftDpadEast,\n        west: leftDpadWest,\n        center: leftDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: rightJoyY1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rightAxis.joyX,\n        y: rightJoyY1\n      },\n      dest: { value: rightJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: rightJoy },\n      dest: {\n        north: rightDpadNorth,\n        south: rightDpadSouth,\n        east: rightDpadEast,\n        west: rightDpadWest,\n        center: rightDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: { value: rightDpadEast },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [leftButton.a.pressed, rightButton.a.pressed],\n      dest: { value: lowerButtons },\n      xform: xforms.any\n    },\n    {\n      src: [leftButton.b.pressed, rightButton.b.pressed],\n      dest: { value: upperButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightDpadWest },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftAxis.joyY },\n      dest: { value: leftJoyYDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: scaledLeftJoyY },\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\n    },\n    {\n      src: { value: leftAxis.joyX },\n      dest: { value: leftJoyXDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: leftJoyXDeadzoned },\n      dest: { value: scaledLeftJoyX },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        x: scaledLeftJoyX,\n        y: scaledLeftJoyY\n      },\n      dest: { value: characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: characterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.b.pressed },\n      dest: { value: leftBoost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton.b.pressed },\n      dest: { value: rightBoost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton.thumbStick.pressed },\n      dest: { value: paths.actions.nextCameraMode },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightButton.thumbStick.pressed },\n      dest: { value: paths.actions.toggleFly },\n      xform: xforms.rising\n    },\n    {\n      src: [leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.cursor.left.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftButton.b.pressed, leftButton.a.pressed, leftButton.trigger.pressed, leftButton.grip.pressed],\n      dest: { value: wakeLeft },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeLeft },\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [rightButton.b.pressed, rightButton.a.pressed, rightButton.trigger.pressed, rightButton.grip.pressed],\n      dest: { value: wakeRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeRight },\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        x: rightAxis.touchpadX,\n        y: rightAxis.touchpadY\n      },\n      dest: { value: touchpad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: touchpad\n      },\n      dest: {\n        north: dpadNorth,\n        south: dpadSouth,\n        east: dpadEast,\n        west: dpadWest,\n        center: dpadCenter\n      },\n      xform: xforms.vec2dpad(0.3)\n    },\n    {\n      src: [dpadNorth, dpadCenter, dpadSouth],\n      dest: { value: dpadCenterStrip },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: dpadCenterStrip,\n        bool: rightButton.touchpad.pressed\n      },\n      dest: { value: centerStripPressed },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: [centerStripPressed, lowerButtons],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton.touchpad.pressed },\n      dest: { value: touchpadReleased },\n      xform: xforms.falling\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: lowerButtonsReleased },\n      xform: xforms.falling\n    },\n    {\n      src: [touchpadReleased, lowerButtonsReleased],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton.touchpad.pressed },\n      dest: { value: touchpadRising },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: dpadEast,\n        bool: touchpadRising\n      },\n      dest: { value: snapRotateRight1 },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadWest,\n        bool: touchpadRising\n      },\n      dest: { value: snapRotateLeft1 },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rightDpadEast },\n      dest: { value: snapRotateRight2 },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightDpadWest },\n      dest: { value: snapRotateLeft2 },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [snapRotateRight1, snapRotateRight2],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: [snapRotateLeft1, snapRotateLeft2],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoveringOnUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.leftCursorHoveringOnVideo]: [\n    {\n      src: { value: leftAxis.joyY },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.rightCursorHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftCursorHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.inspecting]: [\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: leftDpadEast },\n      dest: { value: paths.actions.leftHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftDpadWest },\n      dest: { value: paths.actions.leftHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    },\n    {\n      src: { value: leftButton.b.pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftButton.a.pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab, rightTriggerPressed2],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftCursorHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: upperButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n  [sets.leftCursorHoldingUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftCursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop3 },\n      xform: xforms.falling,\n      priority: 4\n    },\n    {\n      src: [cursorDrop1, cursorDrop2, cursorDrop3],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoldingInteractable]: [\n    {\n      src: { value: leftAxis.joyY },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftCursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [leftCursorDrop1, leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton.b.pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n  [sets.leftCursorHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: leftButton.b.pressed },\n      dest: { value: paths.actions.cursor.left.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightHandDrop2 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [rightHandDrop2],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightDpadEast },\n      dest: { value: paths.actions.rightHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightDpadWest },\n      dest: { value: paths.actions.rightHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightAxis.joyY },\n      dest: { value: rightJoyYDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rightJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 2\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton.b.pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightButton.a.pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop3 },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n  [sets.leftCursorHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [],\n  [sets.inputFocused]: []\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst v = name => {\n  return `/vive-user/vive-var/${name}`;\n};\n\nconst wakeLeft = `${name}left/wake`;\nconst wakeRight = `${name}right/wake`;\n\nconst lButton = paths.device.vive.left.button;\nconst lAxis = paths.device.vive.left.axis;\nconst lPose = paths.device.vive.left.pose;\nconst lJoy = v(\"left/joy\");\nconst lJoyScaled = v(\"left/joy/scaled\");\nconst lJoyXScaled = v(\"left/joyX/scaled\");\nconst lJoyYScaled = v(\"left/joyY/scaled\");\nconst lJoyYDeadzoned = v(\"left/joyY/deadzoned\");\nconst lTouch = v(\"left/touch\");\nconst lTouchScaled = v(\"left/touch/scaled\");\nconst lTouchXScaled = v(\"left/touchX/scaled\");\nconst lTouchY = v(\"left/touchY\");\nconst lTouchYScaled = v(\"left/touchY/scaled\");\nconst lDpadNorth1 = v(\"left/dpad/north1\");\nconst lDpadSouth1 = v(\"left/dpad/south1\");\nconst lDpadEast1 = v(\"left/dpad/east1\");\nconst lDpadWest1 = v(\"left/dpad/west1\");\nconst lDpadCenter1 = v(\"left/dpad/center1\");\nconst lDpadNorth2 = v(\"left/dpad/north2\");\nconst lDpadSouth2 = v(\"left/dpad/south2\");\nconst lDpadEast2 = v(\"left/dpad/east2\");\nconst lDpadWest2 = v(\"left/dpad/west2\");\nconst lDpadCenter2 = v(\"left/dpad/center2\");\nconst lTriggerFallingStopDrawing = v(\"left/trigger/falling/stopDrawing\");\nconst lGripFallingStopDrawing = v(\"left/grip/falling/stopDrawing\");\nconst lTriggerRisingGrab = v(\"left/trigger/rising/grab\");\nconst lGripRisingGrab = v(\"left/grab/rising/grab\");\nconst lTouchpadRising2 = v(\"left/touchpad/rising2\");\nconst lTouchpadRising1 = v(\"left/touchpad/rising1\");\nconst touchCharacterAcceleration = v(\"left/touch/characterAcceleration\");\nconst lCharacterAcceleration = v(\"left/characterAcceleration\");\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\nconst leftBoost = v(\"left/boost\");\nconst leftUndoDrawing = v(\"left/drawing/undo\");\n\nconst rButton = paths.device.vive.right.button;\nconst rAxis = paths.device.vive.right.axis;\nconst rPose = paths.device.vive.right.pose;\nconst rTouch = v(\"right/touch\");\nconst rJoy = v(\"right/joy\");\nconst rJoyYDeadzoned = v(\"right/joyY/deadzoned\");\nconst rDpadNorth1 = v(\"right/dpad/north1\");\nconst rDpadSouth1 = v(\"right/dpad/south1\");\nconst rDpadEast1 = v(\"right/dpad/east1\");\nconst rDpadWest1 = v(\"right/dpad/west1\");\nconst rDpadCenter1 = v(\"right/dpad/center\");\nconst rDpadNorth2 = v(\"right/dpad/north2\");\nconst rDpadSouth2 = v(\"right/dpad/south2\");\nconst rDpadEast2 = v(\"right/dpad/east2\");\nconst rDpadWest2 = v(\"right/dpad/west2\");\nconst rDpadCenter2 = v(\"right/dpad/center2\");\nconst rDpadCenterStrip = v(\"right/dpad/centerStrip\");\nconst rTouchpadRising = v(\"right/touchpad/rising\");\nconst rTouchpadFalling = v(\"right/touchpad/falling\");\nconst rightBoost = v(\"right/boost\");\nconst rTriggerRisingGrab = v(\"right/trigger/rising/grab\");\nconst rGripRisingGrab = v(\"right/grab/rising/grab\");\nconst rightCursorDrop1 = v(\"right/cursorDrop1\");\nconst rightCursorDrop2 = v(\"right/cursorDrop2\");\nconst leftCursorDrop1 = v(\"left/cursorDrop1\");\nconst leftCursorDrop2 = v(\"left/cursorDrop2\");\nconst rTriggerStopTeleport = v(\"right/trigger/stopTeleport\");\nconst rTouchpadStopTeleport = v(\"right/touchpad/stopTeleport\");\nconst rootForFrozenOverrideWhenHolding = \"rootForFrozenOverrideWhenHolding\";\nconst rightUndoDrawing = v(\"right/drawing/undo\");\n\nconst ensureFrozenViaDpad = v(\"dpad/ensureFrozen\");\nconst ensureFrozenViaKeyboard = v(\"keyboard/ensureFrozen\");\nconst ensureFrozenViaButtons = v(\"buttons/ensureFrozen\");\n\nconst thawViaDpad = v(\"dpad/thaw\");\nconst thawViaKeyboard = v(\"keyboard/thaw\");\nconst thawViaButtons = v(\"buttons/thaw\");\n\nconst freezeButtons = v(\"buttons/freeze\");\nconst inspectButtons = v(\"buttons/inspect\");\n\nconst rSnapRight1 = v(\"right/snap-right\");\nconst rSnapLeft1 = v(\"right/snap-left\");\nconst rSnapRight2 = v(\"right/snap-right2\");\nconst rSnapLeft2 = v(\"right/snap-left2\");\n\nconst k = name => {\n  return `/vive-user/keyboard-var/${name}`;\n};\nconst keyboardSnapRight = k(\"snap-right\");\nconst keyboardSnapLeft = k(\"snap-left\");\nconst keyboardCharacterAcceleration = k(\"characterAcceleration\");\nconst wasd_vec2 = k(\"wasd_vec2\");\nconst arrows_vec2 = k(\"arrows_vec2\");\nconst keyboardBoost = k(\"boost\");\n\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst leftTouchpadPressed1 = v(\"leftTouchpadPressed1\");\nconst leftTouchpadPressed2 = v(\"leftTouchpadPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\nconst leftTouchpadFallingStopTeleport = v(\"leftTouchpadFallingStopTeleport\");\nconst leftTriggerFallingStopTeleport = v(\"leftTriggerFallingStopTeleport\");\nconst leftGripFallingWhileHoldingPen = v(\"leftGripFallingWhileHoldingPen\");\n\nexport const viveUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.vive.left.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.vive.right.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaDpad, ensureFrozenViaKeyboard, ensureFrozenViaButtons],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaDpad, thawViaKeyboard, thawViaButtons],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [lButton(\"touchpad\").touched, lButton(\"primary\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rButton(\"touchpad\").touched, rButton(\"primary\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: lAxis(\"touchX\"),\n        y: lAxis(\"touchY\")\n      },\n      dest: {\n        value: lTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: lTouch\n      },\n      dest: {\n        north: lDpadNorth1,\n        south: lDpadSouth1,\n        east: lDpadEast1,\n        west: lDpadWest1,\n        center: lDpadCenter1\n      },\n      xform: xforms.vec2dpad(0.35)\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rAxis(\"touchX\"),\n        y: rAxis(\"touchY\")\n      },\n      dest: {\n        value: rTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rTouch\n      },\n      dest: {\n        north: rDpadNorth1,\n        south: rDpadSouth1,\n        east: rDpadEast1,\n        west: rDpadWest1,\n        center: rDpadCenter1\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: {\n        x: rAxis(\"joyX\"),\n        y: rAxis(\"joyY\")\n      },\n      dest: {\n        value: rJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rJoy\n      },\n      dest: {\n        north: rDpadNorth2,\n        south: rDpadSouth2,\n        east: rDpadEast2,\n        west: rDpadWest2,\n        center: rDpadCenter2\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: [rDpadNorth1, rDpadSouth1, rDpadCenter1],\n      dest: { value: rDpadCenterStrip },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadRising\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadFalling\n      },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadEast1\n      },\n      dest: {\n        value: rSnapRight1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadEast2\n      },\n      dest: {\n        value: rSnapRight2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapRight1, rSnapRight2, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed, bool: rDpadCenterStrip },\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rTouchpadFalling },\n      dest: { value: thawViaDpad },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadWest1\n      },\n      dest: {\n        value: rSnapLeft1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadWest2\n      },\n      dest: {\n        value: rSnapLeft2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapLeft1, rSnapLeft2, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\")\n      },\n      dest: {\n        value: lTouchXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lTouchY\n      },\n      dest: { value: lTouchYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lTouchXScaled,\n        y: lTouchYScaled\n      },\n      dest: { value: lTouchScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        bool: leftTouchpadPressed2,\n        value: lTouchScaled\n      },\n      dest: { value: touchCharacterAcceleration },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: lAxis(\"joyX\")\n      },\n      dest: {\n        value: lJoyXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lJoyXScaled,\n        y: lJoyYScaled\n      },\n      dest: { value: lJoyScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lJoyScaled,\n        second: touchCharacterAcceleration\n      },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: characterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"primary\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"primary\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: { value: lPose },\n      dest: { value: paths.actions.cursor.left.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: [\n        lButton(\"primary\").pressed,\n        lButton(\"trigger\").pressed,\n        lButton(\"grip\").pressed,\n        lButton(\"touchpad\").pressed\n      ],\n      dest: { value: wakeLeft },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeLeft },\n      dest: { value: paths.actions.cursor.left.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        rButton(\"primary\").pressed,\n        rButton(\"trigger\").pressed,\n        rButton(\"grip\").pressed,\n        rButton(\"touchpad\").pressed\n      ],\n      dest: { value: wakeRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: wakeRight },\n      dest: { value: paths.actions.cursor.right.wake },\n      xform: xforms.rising\n    },\n    {\n      src: [\n        rButton(\"secondary\").pressed,\n        lButton(\"secondary\").pressed,\n        rButton(\"bumper\").pressed,\n        lButton(\"bumper\").pressed\n      ],\n      dest: { value: freezeButtons },\n      xform: xforms.any\n    },\n    {\n      src: [rButton(\"primary\").pressed, lButton(\"primary\").pressed],\n      dest: { value: inspectButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: freezeButtons },\n      dest: { value: ensureFrozenViaButtons },\n      xform: xforms.copy\n    },\n    {\n      src: { value: freezeButtons },\n      dest: { value: thawViaButtons },\n      xform: xforms.falling\n    }\n  ],\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed },\n      dest: { value: rTouchpadStopTeleport },\n      xform: xforms.falling\n    },\n    {\n      src: [rTriggerStopTeleport, rTouchpadStopTeleport],\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandTeleporting]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftTriggerFallingStopTeleport, leftTouchpadFallingStopTeleport, leftGripFallingWhileHoldingPen],\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnNothing]: [],\n\n  [sets.leftCursorHoveringOnNothing]: [],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftCursorHoveringOnUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.scale(0.02)\n    }\n  ],\n\n  [sets.leftCursorHoveringOnVideo]: [\n    {\n      src: {\n        value: lAxis(\"touchY\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\n      xform: xforms.scale(0.02)\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: [lGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTouchpadPressed2 },\n      dest: { value: leftTouchpadFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising1\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadCenter1\n      },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripFallingWhileHoldingPen },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [lTriggerFallingStopDrawing, lGripFallingStopDrawing],\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadNorth1\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadSouth1\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: [rButton(\"primary\").pressed, lButton(\"secondary\").pressed],\n      dest: { value: leftUndoDrawing },\n      xform: xforms.any,\n      priority: 1\n    },\n    {\n      src: { value: leftUndoDrawing },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: lButton(\"primary\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any\n    },\n    {\n      src: { value: inspectButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftCursorHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [lGripRisingGrab],\n      dest: { value: paths.actions.cursor.left.grab },\n      xform: xforms.any\n    },\n    {\n      src: { value: inspectButtons },\n      dest: { value: paths.actions.startInspecting },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: {\n        value: rightCursorDrop2\n      },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n\n  [sets.leftCursorHoldingUI]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: {\n        value: leftCursorDrop2\n      },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.touch_axis_scroll(-1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(-0.02)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightCursorDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [rightCursorDrop1, rightCursorDrop2],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.leftCursorHoldingInteractable]: [\n    {\n      src: {\n        value: lAxis(\"touchY\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.touch_axis_scroll(-1)\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.left.modDelta },\n      xform: xforms.scale(-0.02),\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftCursorDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftCursorDrop1, leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.any\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.rightCursorHoveringOnPen]: [],\n\n  [sets.leftCursorHoveringOnPen]: [],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: [rightCursorDrop1],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: [rightCursorDrop2],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.cursor.right.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.cursor.right.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rButton(\"primary\").pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.leftCursorHoldingPen]: [\n    {\n      src: [leftCursorDrop1],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: [leftCursorDrop2],\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.cursor.left.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.left.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising1\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadNorth1\n      },\n      dest: {\n        value: paths.actions.cursor.left.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadSouth1\n      },\n      dest: {\n        value: paths.actions.cursor.left.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: lButton(\"primary\").pressed },\n      dest: { value: paths.actions.cursor.left.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: [lButton(\"primary\").pressed, rButton(\"secondary\").pressed],\n      dest: { value: rightUndoDrawing },\n      xform: xforms.any,\n      priority: 1\n    },\n    {\n      src: { value: rightUndoDrawing },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rButton(\"primary\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.leftCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy\n    }\n  ],\n  [sets.rightCursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.leftCursorHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ],\n  [sets.inspecting]: [\n    {\n      src: { value: inspectButtons },\n      dest: { value: paths.actions.stopInspecting },\n      xform: xforms.falling\n    }\n  ]\n});\n\nexport const viveWandUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.copy\n    }\n  ],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ]\n});\n\nexport const indexUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.copy\n    }\n  ]\n});\n\nexport const viveFocusPlusUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.negate\n    }\n  ],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ]\n});\n\nexport const viveCosmosUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchY },\n      xform: xforms.copy\n    }\n  ],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: {\n        x: lAxis(\"joyX\"),\n        y: lAxis(\"joyY\")\n      },\n      dest: {\n        value: lJoy\n      },\n      xform: xforms.compose_vec2,\n      priority: 1\n    },\n    {\n      src: {\n        value: lJoy\n      },\n      dest: {\n        north: lDpadNorth2,\n        south: lDpadSouth2,\n        east: lDpadEast2,\n        west: lDpadWest2,\n        center: lDpadCenter2\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: lDpadEast2,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.leftHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: lDpadWest2,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.leftHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: {\n        value: lJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1),\n      priority: 1\n    },\n    {\n      src: { value: lJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rDpadEast2 },\n      dest: { value: paths.actions.rightHand.penNextColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rDpadWest2 },\n      dest: { value: paths.actions.rightHand.penPrevColor },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: {\n        value: rJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst lGripPressed = paths.device.wmr.left.grip.pressed;\nconst rGripPressed = paths.device.wmr.right.grip.pressed;\nconst rTriggerPressed = paths.device.wmr.right.trigger.pressed;\n\nconst rJoyNorth = paths.device.wmr.v(\"right/joy/north\");\nconst rGripRising = paths.device.wmr.v(\"right/grip/rising\");\nconst rTriggerRising = paths.device.wmr.v(\"right/trigger/rising\");\nconst rGripFalling = paths.device.wmr.v(\"right/grip/falling\");\nconst rTriggerFalling = paths.device.wmr.v(\"right/trigger/falling\");\n\nfunction dpadVariables(hand) {\n  return {\n    padWest: paths.device.wmr.v(hand + \"/pad/west\"),\n    padEast: paths.device.wmr.v(hand + \"/pad/east\"),\n    padNorth: paths.device.wmr.v(hand + \"/pad/north\"),\n    padSouth: paths.device.wmr.v(hand + \"/pad/south\"),\n    padCenter: paths.device.wmr.v(hand + \"/pad/center\"),\n    padCenterStrip: paths.device.wmr.v(hand + \"/pad/centerStrip\")\n  };\n}\n\nfunction dpadBindings(hand) {\n  const { padWest, padEast, padNorth, padSouth, padCenter, padCenterStrip } = dpadVariables(hand);\n  const pad = paths.device.wmr.v(hand + \"/pad\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr[hand].touchpad.axisX,\n        y: paths.device.wmr[hand].touchpad.axisY\n      },\n      dest: { value: pad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: pad },\n      dest: {\n        west: padWest,\n        east: padEast,\n        north: padNorth,\n        south: padSouth,\n        center: padCenter\n      },\n      xform: xforms.vec2dpad(0.5, false, false)\n    },\n    {\n      src: [padNorth, padCenter, padSouth],\n      dest: { value: padCenterStrip },\n      xform: xforms.any\n    }\n  ];\n}\n\nconst neverFrozenBinding = {\n  src: {},\n  dest: { value: paths.actions.ensureFrozen },\n  xform: xforms.always(false)\n};\n\nfunction penBindings(hand, forCursor) {\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const padPressed = paths.device.wmr[hand].touchpad.pressed;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padRising = paths.device.wmr.v(hand + \"/pad/rising\");\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padWest, padEast, padCenter, padCenterStrip } = dpadVariables(hand);\n\n  const actions = forCursor ? paths.actions.cursor[hand] : paths.actions[hand + \"Hand\"];\n\n  return [\n    neverFrozenBinding,\n    ...dpadBindings(hand),\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.startDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.stopDrawing },\n      xform: xforms.falling\n    },\n    {\n      src: { value: padPressed },\n      dest: { value: padRising },\n      xform: xforms.rising\n    },\n    {\n      src: { bool: padRising, value: padWest },\n      dest: { value: actions.penPrevColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { bool: padRising, value: padEast },\n      dest: { value: actions.penNextColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: actions.scalePenTip },\n      xform: xforms.touch_axis_scroll(-0.05)\n    },\n    {\n      src: [padRising, padCenter],\n      dest: { value: actions.undoDrawing },\n      xform: xforms.all\n    }\n  ];\n}\n\nfunction handPoseBindings(hand) {\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const gripPressed = paths.device.wmr[hand].grip.pressed;\n  const actions = paths.actions[hand + \"Hand\"];\n  return [\n    {\n      src: { value: padTouched },\n      dest: { value: actions.thumb },\n      xform: xforms.copy\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.index },\n      xform: xforms.copy\n    },\n    {\n      src: { value: gripPressed },\n      dest: { value: actions.middleRingPinky },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction freezeBindings() {\n  const leftPadPressed = paths.device.wmr.left.touchpad.pressed;\n  const rightPadPressed = paths.device.wmr.right.touchpad.pressed;\n  const leftPadFalling = paths.device.wmr.v(\"left/touchpad/falling\");\n  const rightPadFalling = paths.device.wmr.v(\"right/touchpad/falling\");\n  const keyboardSaceFalling = paths.device.wmr.k(\"space/falling\");\n  return [\n    {\n      src: [paths.device.keyboard.key(\" \"), leftPadPressed, rightPadPressed],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: keyboardSaceFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftPadPressed },\n      dest: { value: leftPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rightPadPressed },\n      dest: { value: rightPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [keyboardSaceFalling, leftPadFalling, rightPadFalling],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction characterAccelerationBindings() {\n  const wasd_vec2 = paths.device.wmr.k(\"wasd_vec2\");\n  const arrows_vec2 = paths.device.wmr.k(\"arrows_vec2\");\n  const keyboardCharacterAcceleration = paths.device.wmr.k(\"characterAcceleration\");\n  const lJoyXDeadzoned = paths.device.wmr.v(\"left/joy/x/deadzoned\");\n  const lJoyYDeadzoned = paths.device.wmr.v(\"left/joy/y/deadzoned\");\n  const lJoyXScaled = paths.device.wmr.v(\"left/joy/x/scaled\");\n  const lJoyYScaled = paths.device.wmr.v(\"left/joy/y/scaled\");\n  const lCharacterAcceleration = paths.device.wmr.v(\"left/characterAcceleration\");\n  return [\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisX },\n      dest: { value: lJoyXDeadzoned },\n      xform: xforms.deadzone(0.2)\n    },\n    {\n      src: { value: lJoyXDeadzoned },\n      dest: { value: lJoyXScaled },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisY },\n      dest: { value: lJoyYDeadzoned },\n      xform: xforms.deadzone(0.2)\n    },\n    {\n      src: { value: lJoyYDeadzoned },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(-1.5) // vertical character speed modifier\n    },\n    {\n      src: { x: lJoyXScaled, y: lJoyYScaled },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: [\n        paths.device.wmr.left.trigger.pressed,\n        paths.device.wmr.right.trigger.pressed,\n        paths.device.keyboard.key(\"shift\")\n      ],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction cursorModDeltaBindings() {\n  const { padNorth, padSouth } = dpadVariables(\"right\");\n  const rPadNorthOrSouth = paths.device.wmr.v(\"right/pad/northOrSouth\");\n  const rPadNorthOrSouthPressed = paths.device.wmr.v(\"right/pad/northOrSouth/pressed\");\n  const rPadNorthOrSouthPressedY = paths.device.wmr.v(\"right/pad/northOrSouthpressed/y\");\n  return [\n    ...dpadBindings(\"right\"),\n    {\n      src: [padNorth, padSouth],\n      dest: { value: rPadNorthOrSouth },\n      xform: xforms.any\n    },\n    {\n      src: [rPadNorthOrSouth, paths.device.wmr.right.touchpad.pressed],\n      dest: { value: rPadNorthOrSouthPressed },\n      xform: xforms.all\n    },\n    {\n      src: {\n        bool: rPadNorthOrSouthPressed,\n        value: paths.device.wmr.right.touchpad.axisY\n      },\n      dest: { value: rPadNorthOrSouthPressedY },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rPadNorthOrSouthPressedY },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.scale(0.1)\n    }\n  ];\n}\n\nfunction cursorMediaVolumeModBindings() {\n  const hand = \"right\";\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padCenterStrip } = dpadVariables(hand);\n\n  return [\n    ...dpadBindings(hand),\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: paths.actions.cursor[hand].mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ];\n}\n\nfunction holdingCameraBindings(hand, forCursor) {\n  const actions = forCursor ? paths.actions.cursor[hand] : paths.actions[hand + \"Hand\"];\n  return [\n    neverFrozenBinding,\n    {\n      src: { value: paths.device.wmr[hand].trigger.pressed },\n      dest: { value: actions.takeSnapshot },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction teleportationAndRotationBindings() {\n  const rJoy = paths.device.wmr.v(\"right/joy\");\n  const rJoyWest = paths.device.wmr.v(\"right/joy/west\");\n  const rJoyEast = paths.device.wmr.v(\"right/joy/East\");\n  const rJoyWestRising = paths.device.wmr.v(\"right/joy/west/rising\");\n  const rJoyEastRising = paths.device.wmr.v(\"right/joy/east/rising\");\n  const keyboardQRising = paths.device.wmr.k(\"q/rising\");\n  const keyboardERising = paths.device.wmr.k(\"e/rising\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr.right.joystick.axisX,\n        y: paths.device.wmr.right.joystick.axisY\n      },\n      dest: { value: rJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: rJoy },\n      dest: {\n        north: rJoyNorth,\n        west: rJoyWest,\n        east: rJoyEast\n      },\n      xform: xforms.vec2dpad(0.2, false, false)\n    },\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyWest },\n      dest: { value: rJoyWestRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyEast },\n      dest: { value: rJoyEastRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardQRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardERising },\n      xform: xforms.rising\n    },\n    {\n      src: [rJoyWestRising, keyboardQRising],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: [rJoyEastRising, keyboardERising],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    }\n  ];\n}\n\nexport const wmrUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.wmr.left.matrix },\n      dest: { value: paths.actions.leftHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.left.pose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    ...handPoseBindings(\"left\"),\n    ...handPoseBindings(\"right\"),\n    ...freezeBindings(),\n    ...teleportationAndRotationBindings(),\n    ...characterAccelerationBindings(),\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [],\n  [sets.rightCursorHoveringOnNothing]: [],\n  [sets.rightHandHoveringOnNothing]: [],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.rightCursorHoveringOnVideo]: [...cursorMediaVolumeModBindings()],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.rightCursorHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerRising },\n      xform: xforms.rising\n    },\n    {\n      src: [rGripRising, rTriggerRising],\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n  [sets.rightCursorHoldingInteractable]: [\n    neverFrozenBinding,\n    ...cursorModDeltaBindings(),\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [rGripFalling, rTriggerFalling],\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.rightCursorHoveringOnPen]: [],\n  [sets.rightHandHoveringOnPen]: [],\n\n  [sets.leftHandHoldingPen]: penBindings(\"left\"),\n  [sets.rightCursorHoldingPen]: penBindings(\"right\", true),\n  [sets.rightHandHoldingPen]: penBindings(\"right\"),\n\n  [sets.leftHandHoveringOnCamera]: [],\n  [sets.rightCursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n\n  [sets.leftHandHoldingCamera]: holdingCameraBindings(\"left\"),\n  [sets.rightCursorHoldingCamera]: holdingCameraBindings(\"right\", true),\n  [sets.rightHandHoldingCamera]: holdingCameraBindings(\"right\"),\n\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst button = paths.device.xbox.button;\nconst axis = paths.device.xbox.axis;\nconst scaledRightJoystickVertical = paths.device.xbox.v(\"scaledRightJoystickVertical\");\nconst scaledLeftJoystickCursorDelta = paths.device.xbox.v(\"scaledLeftJoystickCursorDelta\");\nconst scaledRightJoystickHorizontal = paths.device.xbox.v(\"scaledRightJoystickHorizontal\");\nconst deadzonedRightJoystickHorizontal = paths.device.xbox.v(\"deadzonedRightJoystickHorizontal\");\nconst deadzonedRightJoystickVertical = paths.device.xbox.v(\"deadzonedRightJoystickVertical\");\nconst deadzonedLeftJoystickHorizontal = paths.device.xbox.v(\"deadzonedLeftJoystickHorizontal\");\nconst deadzonedLeftJoystickVertical = paths.device.xbox.v(\"deadzonedLeftJoystickVertical\");\nconst vec2Zero = paths.device.xbox.v(\"vec2Zero\");\nconst zero = paths.device.xbox.v(\"zero\");\n\nfunction characterAccelerationBindings(disableForwardOnTrigger) {\n  const scaledLeftJoystickHorizontal = paths.device.xbox.v(\"scaledLeftJoystickHorizontal\");\n  const scaledLeftJoystickVertical = paths.device.xbox.v(\"scaledLeftJoystickVertical\");\n  const scaledLeftJoystickForwardAcceleration = paths.device.xbox.v(\"scaledLeftJoystickForwardAcceleration\");\n  return [\n    {\n      src: { value: deadzonedLeftJoystickHorizontal },\n      dest: { value: scaledLeftJoystickHorizontal },\n      xform: xforms.scale(1.5) // horizontal move speed modifier\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickVertical },\n      xform: xforms.scale(-1.25) // vertical move speed modifier\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickVertical\n      },\n      dest: { value: scaledLeftJoystickForwardAcceleration },\n      xform: disableForwardOnTrigger ? xforms.copyIfFalse : xforms.copy\n    },\n    {\n      src: {\n        x: scaledLeftJoystickHorizontal,\n        y: scaledLeftJoystickForwardAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    }\n  ];\n}\n\nexport const xboxControllerUserBindings = addSetsToBindings({\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: button(\"b\").pressed },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.cursor.right.undoDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.cursor.right.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"x\").pressed },\n      dest: { value: paths.actions.cursor.right.penPrevColor },\n      xform: xforms.rising\n    }\n  ],\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.right.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: axis(\"rightJoystickHorizontal\") },\n      dest: { value: deadzonedRightJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickHorizontal },\n      dest: { value: scaledRightJoystickHorizontal },\n      xform: xforms.scale(-0.125) // horizontal look speed modifier\n    },\n    {\n      src: { value: axis(\"rightJoystickVertical\") },\n      dest: { value: deadzonedRightJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickVertical },\n      dest: { value: scaledRightJoystickVertical },\n      xform: xforms.scale(-0.125) // vertical look speed modifier\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: {\n        x: scaledRightJoystickHorizontal,\n        y: scaledRightJoystickVertical\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: axis(\"leftJoystickHorizontal\") },\n      dest: { value: deadzonedLeftJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: axis(\"leftJoystickVertical\") },\n      dest: { value: deadzonedLeftJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: button(\"leftTrigger\").pressed },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"leftBumper\").pressed },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"rightBumper\").pressed },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: {},\n      dest: { value: vec2Zero },\n      xform: xforms.vec2Zero\n    },\n    {\n      src: { value: vec2Zero },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.poseFromCameraProjection()\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: button(\"start\").pressed },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.startGazeTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.stopGazeTeleport },\n      xform: xforms.falling\n    }\n  ],\n  [sets.rightCursorHoldingNothing]: [...characterAccelerationBindings()],\n  [sets.rightCursorHoldingInteractable]: [\n    ...characterAccelerationBindings(true),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.falling,\n      priority: 100\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickCursorDelta },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickCursorDelta\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copyIfTrue\n    }\n  ],\n  [sets.rightCursorHoveringOnUI]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.rightCursorHoveringOnInteractable]: [\n    ...characterAccelerationBindings(),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.right.grab },\n      xform: xforms.rising,\n      priority: 100\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// vars\nconst v = s => `/vars/daydream/${s}`;\nconst touchpad = v(\"touchpad/axis\");\nconst touchpadRising = v(\"touchpad/rising\");\nconst touchpadFalling = v(\"touchpad/falling\");\nconst touchpadPressed = v(\"touchpad/pressed\");\nconst dpadNorth = v(\"dpad/north\");\nconst dpadSouth = v(\"dpad/south\");\nconst dpadEast = v(\"dpad/east\");\nconst dpadWest = v(\"dpad/west\");\nconst dpadCenter = v(\"dpad/center\");\nconst brushSizeDelta = v(\"brushSizeDelta\");\nconst cursorModDelta = v(\"cursorModDelta\");\nconst dpadSouthDrop = v(\"dropSouth\");\nconst dpadCenterDrop = v(\"dropCenter\");\n\nconst grabBinding = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: paths.actions.cursor.right.grab },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  }\n];\n\nconst dropOnCenterOrSouth = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: dpadCenterDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: { value: dpadSouth, bool: touchpadRising },\n    dest: { value: dpadSouthDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: [dpadCenterDrop, dpadSouthDrop],\n    dest: { value: paths.actions.cursor.right.drop },\n    xform: xforms.any\n  }\n];\n\nexport const daydreamUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.daydream.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: paths.device.daydream.axis(\"touchpadX\"),\n        y: paths.device.daydream.axis(\"touchpadY\")\n      },\n      dest: { value: touchpad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadRising },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadPressed },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: touchpad\n      },\n      dest: {\n        north: dpadNorth,\n        south: dpadSouth,\n        east: dpadEast,\n        west: dpadWest,\n        center: dpadCenter\n      },\n      xform: xforms.vec2dpad(0.5)\n    },\n    {\n      src: {\n        value: dpadEast,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateRight\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadWest,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateLeft\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadCenter,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.cursor.right.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightCursorHoveringOnInteractable]: grabBinding,\n  [sets.rightCursorHoveringOnUI]: grabBinding,\n\n  [sets.rightCursorHoveringOnVideo]: [\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ],\n\n  [sets.rightCursorHoldingInteractable]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.right.drop },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: cursorModDelta },\n      xform: xforms.touch_axis_scroll()\n    },\n    {\n      src: { value: cursorModDelta },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightCursorHoldingPen]: [\n    {\n      src: { value: dpadNorth, bool: touchpadRising },\n      dest: { value: paths.actions.cursor.right.startDrawing },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.right.stopDrawing },\n      xform: xforms.copy,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadX\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: brushSizeDelta },\n      xform: xforms.touch_axis_scroll(-0.1)\n    },\n    {\n      src: {\n        value: brushSizeDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.right.scalePenTip },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    {\n      src: { value: dpadEast, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.right.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: dpadWest, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.right.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: {\n        value: cursorModDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.right.modDelta },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ],\n\n  [sets.rightCursorHoldingCamera]: [\n    // Don't drop on touchpad release\n    {\n      src: {\n        value: touchpadFalling\n      },\n      xform: xforms.noop,\n      priority: 100\n    },\n    {\n      src: {\n        value: dpadNorth,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\n      xform: xforms.copy,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const cardboardUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport default function generate3DOFTriggerBindings(device) {\n  const touchpad = device.v(\"touchpad\");\n  const touchpadButton = device.button(\"touchpad\");\n  const triggerButton = device.button(\"trigger\");\n  const touchpadX = device.axis(\"touchpadX\");\n  const touchpadXForPen = device.axis(\"touchpadXForPen\");\n  const touchpadY = device.axis(\"touchpadY\");\n  const touchpadYForPen = device.axis(\"touchpadYForPen\");\n  const touchpadRising = device.v(\"touchpad/rising\");\n  const touchpadFalling = device.v(\"touchpad/falling\");\n  const triggerRising = device.v(\"trigger/rising\");\n  const triggerFalling = device.v(\"trigger/falling\");\n  const dpadNorth = device.v(\"dpad/north\");\n  const dpadSouth = device.v(\"dpad/south\");\n  const dpadEast = device.v(\"dpad/east\");\n  const dpadWest = device.v(\"dpad/west\");\n  const dpadCenter = device.v(\"dpad/center\");\n  const dpadCenterStrip = device.v(\"dpad/centerStrip\");\n  const dpadBottomCenterStrip = device.v(\"dpad/bottomCenterStrip\");\n  const togglePen = \"/vars/oculus-go/togglePen\";\n\n  const grabBinding = {\n    src: {\n      value: triggerRising\n    },\n    dest: { value: paths.actions.cursor.right.grab },\n    xform: xforms.copy,\n    priority: 200\n  };\n  const dropBinding = {\n    src: {\n      value: triggerFalling\n    },\n    dest: { value: paths.actions.cursor.right.drop },\n    xform: xforms.copy,\n    priority: 200\n  };\n\n  return addSetsToBindings({\n    [sets.global]: [\n      {\n        src: { value: device.matrix },\n        dest: { value: paths.actions.rightHand.matrix },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerRising },\n        xform: xforms.rising\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerFalling },\n        xform: xforms.falling\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadRising },\n        xform: xforms.rising,\n        priority: 100\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadFalling },\n        xform: xforms.falling,\n        priority: 100\n      },\n      {\n        src: {\n          x: touchpadX,\n          y: touchpadY\n        },\n        dest: { value: touchpad },\n        xform: xforms.compose_vec2\n      },\n      {\n        src: { value: touchpadX },\n        dest: { value: touchpadXForPen },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadY },\n        dest: { value: touchpadYForPen },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: touchpad\n        },\n        dest: {\n          north: dpadNorth,\n          south: dpadSouth,\n          east: dpadEast,\n          west: dpadWest,\n          center: dpadCenter\n        },\n        xform: xforms.vec2dpad(0.3)\n      },\n      {\n        src: [dpadCenter, dpadSouth],\n        dest: { value: dpadBottomCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: [dpadNorth, dpadBottomCenterStrip],\n        dest: { value: dpadCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: {\n          value: dpadCenterStrip,\n          bool: touchpadButton.pressed\n        },\n        dest: {\n          value: paths.actions.ensureFrozen\n        },\n        priority: 100,\n        xform: xforms.copyIfTrue\n      },\n      {\n        src: { value: touchpadFalling },\n        dest: {\n          value: paths.actions.thaw\n        },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateRight\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateLeft\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.rightHand.startTeleport },\n        xform: xforms.copy,\n        priority: 100\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.cursor.right.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.rightHand.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadButton.touched },\n        dest: { value: paths.actions.rightHand.thumb },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.index },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.middleRingPinky },\n        xform: xforms.copy\n      }\n    ],\n\n    [sets.rightCursorHoveringOnInteractable]: [grabBinding],\n    [sets.rightCursorHoveringOnUI]: [grabBinding],\n    [sets.rightCursorHoldingUI]: [dropBinding],\n    [sets.rightCursorHoveringOnVideo]: [\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.mediaVolumeMod },\n        xform: xforms.touch_axis_scroll(-0.1)\n      }\n    ],\n\n    [sets.rightCursorHoldingInteractable]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.right.drop },\n        xform: xforms.copy,\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.modDelta },\n        xform: xforms.touch_axis_scroll()\n      },\n      {\n        src: { value: dpadCenterStrip },\n        priority: 200,\n        xform: xforms.noop\n      }\n    ],\n\n    [sets.rightHandTeleporting]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.rightHand.stopTeleport },\n        xform: xforms.copy,\n        priority: 100\n      }\n    ],\n\n    [sets.rightCursorHoldingPen]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.right.startDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.right.stopDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: touchpadXForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.scalePenTip },\n        xform: xforms.touch_axis_scroll(0.1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadYForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.right.modDelta },\n        xform: xforms.touch_axis_scroll(1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadBottomCenterStrip,\n          bool: touchpadFalling\n        },\n        dest: { value: togglePen },\n        xform: xforms.copyIfTrue,\n        priority: 300\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.cursor.right.drop },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.pen.remove },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.right.penPrevColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.right.penNextColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadNorth,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.right.undoDrawing\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      }\n    ],\n\n    [sets.rightCursorHoldingCamera]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.right.takeSnapshot },\n        xform: xforms.copy,\n        priority: 300\n      }\n    ]\n  });\n}\n","import { sets } from \"./sets\";\nimport { CAMERA_MODE_INSPECT } from \"../camera-system\";\nimport qsTruthy from \"../../utils/qs_truthy\";\nimport { anyEntityWith } from \"../../utils/bit-utils\";\nimport {\n  HeldRemoteRight,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldHandLeft,\n  HoveredRemoteRight,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredHandLeft,\n  SingleActionButton,\n  HoldableButton,\n  Pen,\n  OffersRemoteConstraint,\n  TogglesHoveredActionSet,\n  CameraTool,\n  OffersHandConstraint,\n  AEntity\n} from \"../../bit-components\";\nimport { hasComponent } from \"bitecs\";\nconst debugUserInput = qsTruthy(\"dui\");\n\nlet leftTeleporter, rightTeleporter;\n\nfunction hc(world, Component, eid) {\n  return eid && hasComponent(world, Component, eid);\n}\n\nfunction hcAFRAME(world, componentName, eid) {\n  return eid && hasComponent(world, AEntity, eid) && !!world.eid2obj.get(eid).el.components[componentName];\n}\n\nexport function resolveActionSets() {\n  leftTeleporter =\n    leftTeleporter ||\n    (document.getElementById(\"player-left-controller\") &&\n      document.getElementById(\"player-left-controller\").components.teleporter);\n  rightTeleporter =\n    rightTeleporter ||\n    (document.getElementById(\"player-right-controller\") &&\n      document.getElementById(\"player-right-controller\").components.teleporter);\n  if (!leftTeleporter || !rightTeleporter) return;\n  const userinput = AFRAME.scenes[0].systems.userinput;\n\n  const world = APP.world;\n\n  const leftHandHovering = anyEntityWith(world, HoveredHandLeft);\n  const leftHandHolding = anyEntityWith(world, HeldHandLeft);\n  const leftRemoteHovering = anyEntityWith(world, HoveredRemoteLeft);\n  const leftRemoteHolding = anyEntityWith(world, HeldRemoteLeft);\n  const rightHandHovering = anyEntityWith(world, HoveredHandRight);\n  const rightHandHolding = anyEntityWith(world, HeldHandRight);\n  const rightRemoteHovering = anyEntityWith(world, HoveredRemoteRight);\n  const rightRemoteHolding = anyEntityWith(world, HeldRemoteRight);\n\n  userinput.toggleSet(sets.leftHandHoldingInteractable, leftHandHolding);\n  userinput.toggleSet(sets.rightHandHoldingInteractable, rightHandHolding);\n  userinput.toggleSet(sets.leftCursorHoldingInteractable, leftRemoteHolding);\n  userinput.toggleSet(sets.rightCursorHoldingInteractable, rightRemoteHolding);\n\n  userinput.toggleSet(sets.leftHandHoveringOnNothing, !leftHandHovering);\n  userinput.toggleSet(sets.rightHandHoveringOnNothing, !rightHandHovering);\n  userinput.toggleSet(sets.leftCursorHoveringOnNothing, !leftRemoteHovering);\n  userinput.toggleSet(sets.rightCursorHoveringOnNothing, !rightRemoteHovering);\n\n  userinput.toggleSet(sets.leftHandHoveringOnPen, hc(world, Pen, leftHandHovering));\n  userinput.toggleSet(sets.rightHandHoveringOnPen, hc(world, Pen, rightHandHovering));\n  userinput.toggleSet(sets.leftCursorHoveringOnPen, hc(world, Pen, leftRemoteHovering));\n  userinput.toggleSet(sets.rightCursorHoveringOnPen, hc(world, Pen, rightRemoteHovering));\n\n  userinput.toggleSet(sets.leftHandHoveringOnCamera, hc(world, CameraTool, leftHandHovering));\n  userinput.toggleSet(sets.rightHandHoveringOnCamera, hc(world, CameraTool, rightHandHovering));\n  userinput.toggleSet(sets.leftCursorHoveringOnCamera, hc(world, CameraTool, leftRemoteHovering));\n  userinput.toggleSet(sets.rightCursorHoveringOnCamera, hc(world, CameraTool, rightRemoteHovering));\n\n  userinput.toggleSet(\n    sets.leftHandHoveringOnInteractable,\n    hc(world, OffersHandConstraint, leftHandHovering) || hcAFRAME(world, \"super-spawner\", leftHandHovering)\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnInteractable,\n    hc(world, OffersHandConstraint, rightHandHovering) || hcAFRAME(world, \"super-spawner\", rightHandHovering)\n  );\n  userinput.toggleSet(\n    sets.leftCursorHoveringOnInteractable,\n    hc(world, OffersRemoteConstraint, leftRemoteHovering) ||\n      hc(world, TogglesHoveredActionSet, leftRemoteHovering) ||\n      hcAFRAME(world, \"super-spawner\", leftRemoteHovering)\n  );\n  userinput.toggleSet(\n    sets.rightCursorHoveringOnInteractable,\n    hc(world, OffersRemoteConstraint, rightRemoteHovering) ||\n      hc(world, TogglesHoveredActionSet, rightRemoteHovering) ||\n      hcAFRAME(world, \"super-spawner\", rightRemoteHovering)\n  );\n\n  userinput.toggleSet(sets.leftHandHoveringOnVideo, hcAFRAME(world, \"media-video\", leftHandHovering));\n  userinput.toggleSet(sets.rightHandHoveringOnVideo, hcAFRAME(world, \"media-video\", rightHandHovering));\n  userinput.toggleSet(sets.leftCursorHoveringOnVideo, hcAFRAME(world, \"media-video\", leftRemoteHovering));\n  userinput.toggleSet(sets.rightCursorHoveringOnVideo, hcAFRAME(world, \"media-video\", rightRemoteHovering));\n\n  userinput.toggleSet(sets.leftHandHoldingPen, hc(world, Pen, leftHandHolding));\n  userinput.toggleSet(sets.rightHandHoldingPen, hc(world, Pen, rightHandHolding));\n  userinput.toggleSet(sets.leftCursorHoldingPen, hc(world, Pen, leftRemoteHolding));\n  userinput.toggleSet(sets.rightCursorHoldingPen, hc(world, Pen, rightRemoteHolding));\n\n  userinput.toggleSet(sets.leftHandHoldingCamera, hc(world, CameraTool, leftHandHolding));\n  userinput.toggleSet(sets.rightHandHoldingCamera, hc(world, CameraTool, rightHandHolding));\n  userinput.toggleSet(sets.leftCursorHoldingCamera, hc(world, CameraTool, leftRemoteHolding));\n  userinput.toggleSet(sets.rightCursorHoldingCamera, hc(world, CameraTool, rightRemoteHolding));\n\n  userinput.toggleSet(\n    sets.leftCursorHoveringOnUI,\n    hc(world, SingleActionButton, leftRemoteHovering) || hc(world, HoldableButton, leftRemoteHovering)\n  );\n  userinput.toggleSet(\n    sets.rightCursorHoveringOnUI,\n    hc(world, SingleActionButton, rightRemoteHovering) || hc(world, HoldableButton, rightRemoteHovering)\n  );\n\n  userinput.toggleSet(sets.leftCursorHoldingNothing, !leftRemoteHolding);\n  userinput.toggleSet(sets.rightCursorHoldingNothing, !rightRemoteHolding);\n\n  userinput.toggleSet(sets.leftCursorHoldingUI, hc(world, HoldableButton, leftRemoteHolding));\n  userinput.toggleSet(sets.rightCursorHoldingUI, hc(world, HoldableButton, rightRemoteHolding));\n\n  userinput.toggleSet(sets.leftHandTeleporting, leftTeleporter.isTeleporting);\n  userinput.toggleSet(sets.rightHandTeleporting, rightTeleporter.isTeleporting);\n\n  userinput.toggleSet(\n    sets.inputFocused,\n    document.activeElement.nodeName === \"INPUT\" ||\n      document.activeElement.nodeName === \"TEXTAREA\" ||\n      document.activeElement.contentEditable === \"true\"\n  );\n\n  userinput.toggleSet(sets.debugUserInput, debugUserInput);\n\n  if (AFRAME.scenes[0] && AFRAME.scenes[0].systems[\"hubs-systems\"]) {\n    userinput.toggleSet(\n      sets.inspecting,\n      AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT\n    );\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class GamepadDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n  }\n\n  write(frame) {\n    if (this.gamepad.connected) {\n      this.gamepad.buttons.forEach((button, i) => {\n        const buttonPath = paths.device.gamepad(this.gamepad.index).button(i);\n        frame.setValueType(buttonPath.pressed, !!button.pressed);\n        frame.setValueType(buttonPath.touched, !!button.touched);\n        frame.setValueType(buttonPath.value, button.value);\n      });\n      this.gamepad.axes.forEach((axis, i) => {\n        frame.setValueType(paths.device.gamepad(this.gamepad.index).axis(i), axis);\n      });\n    }\n  }\n}\n","export const gamepadBindings = {};\n","import { sets } from \"./sets\";\nimport { paths } from \"./paths\";\n\nimport { MouseDevice } from \"./devices/mouse\";\nimport { KeyboardDevice } from \"./devices/keyboard\";\nimport { HudDevice } from \"./devices/hud\";\nimport { XboxControllerDevice } from \"./devices/xbox-controller\";\nimport { OculusGoControllerDevice } from \"./devices/oculus-go-controller\";\nimport { GearVRControllerDevice } from \"./devices/gear-vr-controller\";\nimport { OculusTouchControllerDevice } from \"./devices/oculus-touch-controller\";\nimport { DaydreamControllerDevice } from \"./devices/daydream-controller\";\nimport { ViveControllerDevice } from \"./devices/vive-controller\";\nimport { WindowsMixedRealityControllerDevice } from \"./devices/windows-mixed-reality-controller\";\nimport { WebXRControllerDevice } from \"./devices/webxr-controller\";\nimport { GyroDevice } from \"./devices/gyro\";\n\nimport { AppAwareMouseDevice } from \"./devices/app-aware-mouse\";\nimport { AppAwareTouchscreenDevice } from \"./devices/app-aware-touchscreen\";\n\nimport { keyboardMouseUserBindings } from \"./bindings/keyboard-mouse-user\";\nimport { touchscreenUserBindings } from \"./bindings/touchscreen-user\";\nimport { keyboardDebuggingBindings } from \"./bindings/keyboard-debugging\";\nimport { oculusTouchUserBindings } from \"./bindings/oculus-touch-user\";\nimport { webXRUserBindings } from \"./bindings/webxr-user\";\nimport {\n  viveUserBindings,\n  viveWandUserBindings,\n  indexUserBindings,\n  viveFocusPlusUserBindings,\n  viveCosmosUserBindings\n} from \"./bindings/vive-user\";\nimport { wmrUserBindings } from \"./bindings/windows-mixed-reality-user\";\nimport { xboxControllerUserBindings } from \"./bindings/xbox-controller-user\";\nimport { daydreamUserBindings } from \"./bindings/daydream-user\";\nimport { cardboardUserBindings } from \"./bindings/cardboard-user\";\n\nimport generate3DOFTriggerBindings from \"./bindings/oculus-go-user\";\nconst oculusGoUserBindings = generate3DOFTriggerBindings(paths.device.oculusgo);\nconst gearVRControllerUserBindings = generate3DOFTriggerBindings(paths.device.gearVRController);\n\nimport { resolveActionSets } from \"./resolve-action-sets\";\nimport { GamepadDevice } from \"./devices/gamepad\";\nimport { gamepadBindings } from \"./bindings/generic-gamepad\";\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"../../utils/vr-caps-detect\";\nimport { hackyMobileSafariTest } from \"../../utils/detect-touchscreen\";\nimport { ArrayBackedSet } from \"./array-backed-set\";\n\nfunction arrayContentsDiffer(a, b) {\n  if (a.length !== b.length) return true;\n\n  for (let i = 0, il = a.length; i < il; i++) {\n    const elem = a[i];\n    let found = false;\n\n    for (let j = 0, jl = b.length; j < jl; j++) {\n      if (elem === b[j]) {\n        found = true;\n        break;\n      }\n    }\n\n    if (!found) return true;\n  }\n\n  return false;\n}\n\nconst satisfiesPath = (binding, path) => {\n  for (const key in binding.dest) {\n    if (binding.dest[key].indexOf(path) !== -1) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfyPath = (bindings, path) => {\n  for (const binding of bindings) {\n    if (satisfiesPath(binding, path)) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfiedBy = (binding, bindings) => {\n  for (const path of Object.values(binding.src)) {\n    if (path.startsWith(\"/device/\")) continue;\n    if (!satisfyPath(bindings, path)) return false;\n  }\n  return true;\n};\n\nfunction dependencySort(mappings) {\n  const unsorted = [];\n  for (const mapping of mappings) {\n    for (const setName in mapping) {\n      for (const binding of mapping[setName]) {\n        unsorted.push(binding);\n      }\n    }\n  }\n\n  const sorted = [];\n  while (unsorted.length > 0) {\n    const binding = unsorted.shift();\n    if (satisfiedBy(binding, sorted)) {\n      sorted.push(binding);\n    } else {\n      unsorted.push(binding);\n    }\n  }\n\n  return sorted;\n}\n\nfunction notEmpty(s) {\n  return s !== \"\";\n}\n\nfunction isSubpath(subpath, path) {\n  const a = subpath.split(\"/\").filter(notEmpty);\n  const b = path.split(\"/\").filter(notEmpty);\n  if (a.length > b.length) return false;\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) return false;\n  }\n  return true;\n}\n\nfunction canMask(masker, masked) {\n  if (masker.priority === undefined) {\n    masker.priority = 0;\n  }\n  if (masked.priority === undefined) {\n    masked.priority = 0;\n  }\n  if (masked.priority >= masker.priority) return false;\n  for (const maskerKey in masker.src) {\n    const maskerPath = masker.src[maskerKey];\n    for (const maskedKey in masked.src) {\n      const maskedPath = masked.src[maskedKey];\n      if (maskedPath.indexOf(maskerPath) !== -1 && isSubpath(maskerPath, maskedPath)) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction computeMasks(bindings) {\n  const masks = new Array(bindings.length);\n  for (let row = 0; row < bindings.length; row++) {\n    const masksRow = (masks[row] = []);\n    const bindingsRow = bindings[row];\n    for (let col = 0; col < bindings.length; col++) {\n      if (canMask(bindings[col], bindingsRow)) {\n        masksRow.push(col);\n      }\n    }\n  }\n  return masks;\n}\n\nfunction isActive(binding, sets) {\n  for (let i = 0; i < binding.sets.length; i++) {\n    if (sets.includes(binding.sets[i])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction computeExecutionStrategy(sortedBindings, masks, activeSets) {\n  const actives = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    actives[row] = isActive(sortedBindings[row], activeSets);\n  }\n\n  const masked = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    const maskedRow = (masked[row] = []);\n    const masksRow = masks[row];\n    for (let col = 0; col < sortedBindings.length; col++) {\n      if (actives[col] && masksRow.indexOf(col) !== -1) {\n        maskedRow.push(col);\n      }\n    }\n  }\n\n  return { actives, masked };\n}\n\nAFRAME.registerSystem(\"userinput\", {\n  get(path) {\n    if (!this.frame) return;\n    return this.frame.get(path);\n  },\n\n  toggleSet(set, value) {\n    this.pendingSetChanges.push(set);\n    this.pendingSetChanges.push(!!value);\n  },\n\n  init() {\n    this.frame = {\n      generation: 0,\n      values: {},\n      generations: {},\n      get: function(path) {\n        if (this.generations[path] !== this.generation) return undefined;\n        return this.values[path];\n      },\n      setValueType: function(path, value) {\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setVector2: function(path, a, b) {\n        const value = this.values[path] || [];\n        value[0] = a;\n        value[1] = b;\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setPose: function(path, pose) {\n        this.setValueType(path, pose);\n      },\n      setMatrix4: function(path, mat4) {\n        // Should we assume the incoming mat4 is safe to store instead of copying values?\n        const value = this.values[path] || new THREE.Matrix4();\n        value.copy(mat4);\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      }\n    };\n\n    this.prevActiveSets = [];\n    this.activeSets = [sets.global];\n    this.pendingSetChanges = [];\n    this.xformStates = new Map();\n    this.activeDevices = new ArrayBackedSet([new HudDevice()]);\n\n    const isMobile = AFRAME.utils.device.isMobile();\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\n    const forceEnableTouchscreen = hackyMobileSafariTest();\n\n    if (!(isMobile || isMobileVR || forceEnableTouchscreen)) {\n      this.activeDevices.add(new MouseDevice());\n      this.activeDevices.add(new AppAwareMouseDevice());\n      this.activeDevices.add(new KeyboardDevice());\n    } else if (!isMobileVR || forceEnableTouchscreen) {\n      this.activeDevices.add(new AppAwareTouchscreenDevice());\n      this.activeDevices.add(new KeyboardDevice());\n      this.activeDevices.add(new GyroDevice());\n    }\n\n    this.isMobile = isMobile;\n    this.isMobileVR = isMobileVR;\n\n    this.registeredMappings = new Set([keyboardDebuggingBindings]);\n    this.registeredMappingsChanged = true;\n\n    const vrGamepadMappings = new Map();\n    vrGamepadMappings.set(WindowsMixedRealityControllerDevice, wmrUserBindings);\n    vrGamepadMappings.set(ViveControllerDevice, viveUserBindings);\n    vrGamepadMappings.set(OculusTouchControllerDevice, oculusTouchUserBindings);\n    vrGamepadMappings.set(OculusGoControllerDevice, oculusGoUserBindings);\n    vrGamepadMappings.set(GearVRControllerDevice, gearVRControllerUserBindings);\n    vrGamepadMappings.set(DaydreamControllerDevice, daydreamUserBindings);\n    vrGamepadMappings.set(WebXRControllerDevice, webXRUserBindings);\n\n    const nonVRGamepadMappings = new Map();\n    nonVRGamepadMappings.set(XboxControllerDevice, xboxControllerUserBindings);\n    nonVRGamepadMappings.set(GamepadDevice, gamepadBindings);\n\n    const addExtraMappings = activeDevice => {\n      if (activeDevice instanceof ViveControllerDevice && activeDevice.gamepad) {\n        if (activeDevice.gamepad.id === \"OpenVR Cosmos\") {\n          //HTC Vive Cosmos Controller\n          this.registeredMappings.add(viveCosmosUserBindings);\n        } else if (activeDevice.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n          //HTC Vive Focus Plus Controller\n          this.registeredMappings.add(viveFocusPlusUserBindings);\n        } else if (activeDevice.gamepad.axes.length === 4) {\n          //Valve Index Controller\n          this.registeredMappings.add(indexUserBindings);\n        } else {\n          //HTC Vive Controller (wands)\n          this.registeredMappings.add(viveWandUserBindings);\n        }\n      }\n    };\n\n    const deleteExtraMappings = activeDevice => {\n      if (activeDevice instanceof ViveControllerDevice && activeDevice.gamepad) {\n        this.registeredMappings.delete(viveCosmosUserBindings);\n        this.registeredMappings.delete(viveFocusPlusUserBindings);\n        this.registeredMappings.delete(indexUserBindings);\n        this.registeredMappings.delete(viveWandUserBindings);\n      }\n    };\n\n    const updateBindingsForVRMode = () => {\n      const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n      const isMobile = AFRAME.utils.device.isMobile();\n      const forceEnableTouchscreen = hackyMobileSafariTest();\n\n      if (inVRMode) {\n        console.log(\"Using VR bindings.\");\n        this.registeredMappings.delete(\n          isMobile || forceEnableTouchscreen ? touchscreenUserBindings : keyboardMouseUserBindings\n        );\n        // add mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          const mapping = vrGamepadMappings.get(activeDevice.constructor);\n          mapping && this.registeredMappings.add(mapping);\n          addExtraMappings(activeDevice);\n        }\n\n        // Handle cardboard by looking of VR device caps\n        if (isMobile) {\n          getAvailableVREntryTypes().then(availableVREntryTypes => {\n            if (availableVREntryTypes.cardboard === VR_DEVICE_AVAILABILITY.yes) {\n              this.registeredMappings.add(cardboardUserBindings);\n              this.registeredMappingsChanged = true;\n            }\n          });\n        }\n      } else {\n        console.log(\"Using Non-VR bindings.\");\n        // remove mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          deleteExtraMappings(activeDevice);\n          this.registeredMappings.delete(vrGamepadMappings.get(activeDevice.constructor));\n        }\n        this.registeredMappings.add(\n          isMobile || forceEnableTouchscreen ? touchscreenUserBindings : keyboardMouseUserBindings\n        );\n      }\n\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        const mapping = nonVRGamepadMappings.get(activeDevice.constructor);\n        mapping && this.registeredMappings.add(mapping);\n      }\n\n      this.registeredMappingsChanged = true;\n    };\n\n    const gamepadConnected = e => {\n      let gamepadDevice;\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        if (!e.gamepad.isWebXRGamepad && activeDevice.gamepad && activeDevice.gamepad.index === e.gamepad.index) {\n          console.warn(\"connected already fired for gamepad\", e.gamepad);\n          return; // multiple connect events without a disconnect event\n        }\n      }\n      if (e.gamepad.isWebXRGamepad) {\n        gamepadDevice = new WebXRControllerDevice(e.gamepad);\n      } else if (\n        // HACK Firefox Nightly bug causes corrupt gamepad names for OpenVR, so do startsWith\n        e.gamepad.id.startsWith(\"OpenVR Gamepad\") ||\n        e.gamepad.id.startsWith(\"OpenVR Knuckles\") ||\n        e.gamepad.id === \"HTC Vive Focus Plus Controller\" ||\n        e.gamepad.id === \"OpenVR Cosmos\"\n      ) {\n        gamepadDevice = new ViveControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Oculus Touch\") || e.gamepad.id.startsWith(\"Pico Neo 2\")) {\n        gamepadDevice = new OculusTouchControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Spatial Controller\")) {\n        gamepadDevice = new WindowsMixedRealityControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Oculus Go Controller\" || e.gamepad.id === \"Pico G2 Controller\") {\n        gamepadDevice = new OculusGoControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Gear VR Controller\" || e.gamepad.id === \"HTC Vive Focus Controller\") {\n        gamepadDevice = new GearVRControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Daydream Controller\") {\n        gamepadDevice = new DaydreamControllerDevice(e.gamepad);\n      } else if (e.gamepad.mapping === \"standard\") {\n        // Our XboxController device and bindings should be generic enough for most gamepads.\n        gamepadDevice = new XboxControllerDevice(e.gamepad);\n      } else {\n        // This device doesn't actually have any bindings, but we need to fallback to something.\n        gamepadDevice = new GamepadDevice(e.gamepad);\n      }\n\n      this.activeDevices.add(gamepadDevice);\n\n      updateBindingsForVRMode();\n    };\n\n    const gamepadDisconnected = e => {\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const device = this.activeDevices.items[i];\n        if (device.gamepad && device.gamepad.index === e.gamepad.index) {\n          this.registeredMappings.delete(\n            vrGamepadMappings.get(device.constructor) || nonVRGamepadMappings.get(device.constructor)\n          );\n          this.activeDevices.delete(device);\n          return;\n        }\n      }\n\n      updateBindingsForVRMode();\n    };\n\n    window.addEventListener(\"gamepadconnected\", gamepadConnected, false);\n    window.addEventListener(\"gamepaddisconnected\", gamepadDisconnected, false);\n    for (const gamepad of navigator.getGamepads()) {\n      gamepad && gamepadConnected({ gamepad });\n    }\n\n    const retrieveXRGamepads = ({ added, removed }) => {\n      for (const inputSource of removed) {\n        gamepadDisconnected(inputSource);\n      }\n      for (const inputSource of added) {\n        inputSource.gamepad.isWebXRGamepad = true;\n        inputSource.gamepad.targetRaySpace = inputSource.targetRaySpace;\n        inputSource.gamepad.primaryProfile = inputSource.profiles[0];\n        // inputSource.gamepad.hand is a read-only property and still an experimental property.\n        // We read this property elsewhere. Only Firefox supports this property now.\n        // So we set this property if it's undefined.\n        if (inputSource.gamepad.hand === undefined) {\n          inputSource.gamepad.hand = inputSource.handedness;\n        }\n        gamepadConnected(inputSource);\n      }\n    };\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", () => {\n      const { xrSession } = this.el.sceneEl;\n      if (xrSession) {\n        xrSession.addEventListener(\"inputsourceschange\", retrieveXRGamepads);\n        xrSession.requestReferenceSpace(\"local-floor\").then(referenceSpace => {\n          this.xrReferenceSpace = referenceSpace;\n        });\n        xrSession.addEventListener(\"end\", () => {\n          this.activeDevices.items.filter(d => d.gamepad && d.gamepad.isWebXRGamepad).forEach(gamepadDisconnected);\n        });\n      }\n      updateBindingsForVRMode();\n    });\n    this.el.sceneEl.addEventListener(\"exit-vr\", updateBindingsForVRMode);\n\n    updateBindingsForVRMode();\n  },\n\n  maybeToggleXboxMapping() {\n    if (hackyMobileSafariTest() || this.isMobile || this.isMobileVR) return;\n\n    const vrAxesSum =\n      (this.get(paths.device.vive.left.axesSum) || 0) +\n      (this.get(paths.device.vive.right.axesSum) || 0) +\n      (this.get(paths.device.leftOculusTouch.axesSum) || 0) +\n      (this.get(paths.device.rightOculusTouch.axesSum) || 0);\n    const mouseMovement = this.get(paths.device.mouse.movementXY);\n    const nonXboxActivity = (mouseMovement && (mouseMovement[0] || mouseMovement[1])) > 2 || vrAxesSum > 0.5;\n\n    const hasXboxMapping = this.registeredMappings.has(xboxControllerUserBindings);\n\n    if (nonXboxActivity && hasXboxMapping) {\n      this.registeredMappings.delete(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    } else if (this.get(paths.device.xbox.axesSum) > 0.5 && !hasXboxMapping) {\n      this.registeredMappings.add(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    }\n  },\n\n  tick2() {\n    this.frame.generation += 1;\n    const registeredMappingsChanged = this.registeredMappingsChanged;\n    if (registeredMappingsChanged) {\n      this.registeredMappingsChanged = false;\n      this.prevSortedBindings = this.sortedBindings;\n      this.sortedBindings = dependencySort(this.registeredMappings);\n      if (!this.prevSortedBindings) {\n        this.prevSortedBindings = this.sortedBindings;\n      }\n      this.masks = computeMasks(this.sortedBindings);\n    }\n\n    this.prevActiveSets.length = 0;\n    for (let i = 0; i < this.activeSets.length; i++) {\n      const item = this.activeSets[i];\n      this.prevActiveSets.push(item);\n    }\n    resolveActionSets();\n    for (let i = 0, l = this.pendingSetChanges.length; i < l; i += 2) {\n      const set = this.pendingSetChanges[i];\n      const value = this.pendingSetChanges[i + 1];\n\n      if (value) {\n        if (!this.activeSets.includes(set)) {\n          this.activeSets.push(set);\n        }\n      } else {\n        const idx = this.activeSets.indexOf(set);\n\n        if (idx > -1) {\n          this.activeSets.splice(idx, 1);\n        }\n      }\n    }\n    const activeSetsChanged = arrayContentsDiffer(this.prevActiveSets, this.activeSets);\n    this.pendingSetChanges.length = 0;\n    if (registeredMappingsChanged || activeSetsChanged || (!this.actives && !this.masked)) {\n      this.prevActives = this.actives;\n      this.prevMasked = this.masked;\n      const { actives, masked } = computeExecutionStrategy(this.sortedBindings, this.masks, this.activeSets);\n      this.actives = actives;\n      this.masked = masked;\n    }\n\n    for (let i = 0; i < this.activeDevices.items.length; i++) {\n      this.activeDevices.items[i].write(this.frame, this.el.sceneEl, this.xrReferenceSpace);\n    }\n\n    for (let i = 0; i < this.sortedBindings.length; i++) {\n      if (!this.actives[i] || this.masked[i].length > 0) continue;\n\n      const binding = this.sortedBindings[i];\n\n      let bindingExistedLastFrame = true;\n      if (!registeredMappingsChanged && activeSetsChanged && this.prevSortedBindings) {\n        const j = this.prevSortedBindings.indexOf(binding);\n        bindingExistedLastFrame = j > -1 && this.prevActives[j] && this.prevMasked[j].length === 0;\n      }\n      if (!bindingExistedLastFrame) {\n        this.xformStates.delete(binding);\n      }\n\n      const { src, dest, xform, debug } = binding;\n\n      let oldValue;\n\n      if (debug) {\n        oldValue = this.frame.get(dest.value);\n      }\n\n      const newState = xform(this.frame, src, dest, this.xformStates.get(binding));\n\n      if (debug) {\n        // Note for now this only works with bindings that have { value: } sources and dests\n        console.log(\n          `${JSON.stringify(src.value)} (${src.value && JSON.stringify(this.frame.get(src.value))}) to ${JSON.stringify(\n            dest\n          )}: ${oldValue} -> ${this.frame.get(dest.value)}`\n        );\n      }\n\n      if (newState !== undefined) {\n        this.xformStates.set(binding, newState);\n      }\n    }\n\n    this.prevSortedBindings = this.sortedBindings;\n\n    this.maybeToggleXboxMapping();\n  }\n});\n","import { paths } from \"./paths\";\nimport qsTruthy from \"../../utils/qs_truthy\";\n\nconst PATHS_TO_SHOW = [\"/actions/\", \"/device/\", \"/var/\"];\nconst DELIMITER = \"-----------------------------------\";\n\nconst replacer = (k, v) => {\n  if (typeof v === \"number\") {\n    return `${v >= 0 ? \"+\" : \"\"}${v.toFixed(3)}`;\n  }\n  return v;\n};\nfunction describeCurrentMasks(userinput) {\n  const strings = [];\n  userinput.masked.forEach((maskers, i) => {\n    let val;\n    if (!userinput.actives[i]) return;\n    if (maskers.length) {\n      val = JSON.stringify(userinput.sortedBindings[i], replacer);\n      strings.push(DELIMITER);\n      strings.push(`Binding #${i}:`);\n      if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n      strings.push(`${val}\\n`);\n    }\n    maskers.forEach(masker => {\n      val = JSON.stringify(userinput.sortedBindings[masker], replacer);\n      if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n      strings.push(`- Masked by #${masker}:\\n${val}`);\n    });\n    if (maskers.length) {\n      strings.push(`\\n`);\n    }\n  });\n  return strings.join(\"\\n\");\n}\n\nAFRAME.registerSystem(\"userinput-debug\", {\n  active: true,\n\n  tick() {\n    if (!this.active) return;\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n\n    if (this.userinputFrameStatus) {\n      const pathsOutput = [];\n      const { frame } = userinput;\n      for (const key in frame.values) {\n        if (!frame.get(key)) continue;\n        if (!PATHS_TO_SHOW.some(x => key.startsWith(x))) continue;\n        let val = JSON.stringify(frame.get(key), replacer);\n        if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n        pathsOutput.push(`${key} -> ${val}`);\n      }\n      this.userinputFrameStatus.textContent = pathsOutput.join(\"\\n\");\n    }\n\n    if (userinput.get(paths.actions.debugUserInput.describeCurrentMasks)) {\n      console.log(describeCurrentMasks(userinput));\n    }\n\n    if (userinput.get(paths.actions.logDebugFrame)) {\n      if (qsTruthy(\"userinput_debug\") && !this.userinputFrameStatus) {\n        this.userinputFrameStatus = document.createElement(\"div\");\n        this.userinputFrameStatus.id = \"userinput-frame-status\";\n        this.userinputFrameStatus.style = `\n          position: absolute;\n          z-index: 2;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        `;\n        document.body.append(this.userinputFrameStatus);\n      }\n\n      console.log(userinput);\n      console.log(\"sorted\", JSON.parse(JSON.stringify(userinput.sortedBindings)));\n      console.log(\"actives\", JSON.parse(JSON.stringify(userinput.actives)));\n      console.log(\"masks\", JSON.parse(JSON.stringify(userinput.masks)));\n      console.log(\"masked\", JSON.parse(JSON.stringify(userinput.masked)));\n      console.log(\"devices\", userinput.activeDevices);\n      console.log(\"activeSets\", JSON.parse(JSON.stringify(userinput.activeSets)));\n      console.log(\"frame\", JSON.parse(JSON.stringify(userinput.frame)));\n      console.log(\"xformStates\", userinput.xformStates);\n      const { sortedBindings, actives, masked } = userinput;\n      for (const i in sortedBindings) {\n        const strings = [];\n        if (masked[i].length > 0) {\n          for (const j of masked[i]) {\n            strings.push(JSON.stringify(sortedBindings[j]));\n          }\n        }\n\n        if (this.logBindings) {\n          console.log(\n            \"binding: \",\n            i,\n            \"\\n\",\n            JSON.parse(JSON.stringify(sortedBindings[i])),\n            \"\\n\",\n            \"dest: \",\n            JSON.parse(JSON.stringify(sortedBindings[i].dest && Object.values(sortedBindings[i].dest))),\n            \"\\n\",\n            \"active: \",\n            JSON.parse(JSON.stringify(actives[i])),\n            \"\\n\",\n            \"maskedBy: \",\n            JSON.parse(JSON.stringify(masked[i])),\n            \"\\n\",\n            strings.join(\"\\n\"),\n            \"\\n\"\n          );\n        }\n      }\n    }\n  }\n});\n","import { paths } from \"./userinput/paths\";\nimport { SOURCES } from \"../storage/media-search-store\";\n\nconst MEDIA_SEARCH_PATHS = [\n  paths.actions.mediaSearch1,\n  paths.actions.mediaSearch2,\n  paths.actions.mediaSearch3,\n  paths.actions.mediaSearch4,\n  paths.actions.mediaSearch5,\n  paths.actions.mediaSearch6,\n  paths.actions.mediaSearch7,\n  paths.actions.mediaSearch8\n];\n\n// Every frame, looks for input paths that trigger UI-relevant events and handles them.\nAFRAME.registerSystem(\"ui-hotkeys\", {\n  init() {\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n  },\n\n  tick: function() {\n    if (!this.userinput) {\n      this.userinput = this.el.systems.userinput;\n    }\n\n    if (this.userinput.get(paths.actions.focusChat)) {\n      window.dispatchEvent(new CustomEvent(\"focus_chat\", { detail: { prefix: \"\" } }));\n    }\n\n    if (this.userinput.get(paths.actions.focusChatCommand)) {\n      window.dispatchEvent(new CustomEvent(\"focus_chat\", { detail: { prefix: \"/\" } }));\n    }\n\n    if (this.userinput.get(paths.actions.mediaExit)) {\n      const state = window.APP.history.location.state && window.APP.history.location.state.value;\n      const ignoredStates = new Set([\"avatar-editor\", \"link\", \"profile\", \"device\", \"audio\"]);\n      const maybeInMediaBrowser = !state || !ignoredStates.has(state);\n      if (maybeInMediaBrowser) {\n        // Do not push \"exit media browser\" to history\n        // if we know we are NOT in the media browser.\n        // TODO: If we set the state to \"media browser\"\n        //       while the media browser is open, then we\n        //       can check that condition directly.\n        //       Until then, we push \"exit media browser\"\n        //       to the history if state is undefined.\n        this.mediaSearchStore.pushExitMediaBrowserHistory();\n      }\n\n      this.el.emit(\"action_exit_watch\");\n    }\n\n    for (let i = 0; i < MEDIA_SEARCH_PATHS.length; i++) {\n      if (this.userinput.get(MEDIA_SEARCH_PATHS[i]) && window.APP.hubChannel.can(\"spawn_and_move_media\")) {\n        this.mediaSearchStore.sourceNavigate(SOURCES[i]);\n      }\n    }\n\n    if (this.userinput.get(paths.actions.toggleCamera)) {\n      this.el.emit(\"action_toggle_camera\");\n    }\n\n    if (this.userinput.get(paths.actions.toggleUI)) {\n      this.el.emit(\"action_toggle_ui\");\n    }\n  }\n});\n","import { paths } from \"./userinput/paths\";\n\n// The output of this system is activeTip. There are named tips (eg locomotion) that each have validators.\n//\n// Each frame we run all the non-finished validators and take the first tip (by order)\n// which is VALID. Any tip that returns FINISHED will no longer be considered without\n// a local storage reset.\n\n// Validators can return these values:\n//\n// INVALID - Tip is not valid to show\n// VALID - Tip is valid to show\n// FINISH - Tip should always be assumed INVALID going forward\n//\nconst INVALID = 0;\nconst VALID = 1;\nconst FINISH = 2;\n\nconst LOCAL_STORAGE_KEY = \"__hubs_finished_tips\";\n\nconst TIPS = {\n  desktop: [\"look\", \"locomotion\", \"turning\", \"invite\"],\n  mobile: [\"look\", \"locomotion\", \"invite\"],\n  standalone: []\n};\n\nlet localStorageCache = null;\nlet finished = false; // Optimization, lets system skip altogether once finished.\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst tipPlatform = () => {\n  if (isMobileVR) return \"standalone\";\n  return isMobile ? \"mobile\" : \"desktop\";\n};\n\nconst platformTips = TIPS[tipPlatform()];\n\nfunction markTipFinished(tip) {\n  const storeData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  storeData[tip] = { finished: true };\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(storeData));\n  localStorageCache = null;\n}\n\nconst VALIDATORS = {\n  look: function(userinput) {\n    const cameraDelta = userinput.get(\n      isMobile ? paths.device.touchscreen.touchCameraDelta : paths.device.smartMouse.cameraDelta\n    );\n    return cameraDelta ? FINISH : VALID;\n  },\n  locomotion: function(userinput) {\n    const accel = userinput.get(paths.actions.characterAcceleration);\n\n    // User moved\n    return accel && (accel[0] !== 0 || accel[1] !== 0) ? FINISH : VALID;\n  },\n  turning: function(userinput) {\n    if (userinput.get(paths.actions.snapRotateLeft) || userinput.get(paths.actions.snapRotateRight)) return FINISH;\n    return VALID;\n  },\n  invite: function(_userinput, scene, hub) {\n    if (hub && hub.entry_mode === \"invite\") return INVALID;\n    return scene.is(\"copresent\") ? FINISH : VALID;\n  }\n};\n\nAFRAME.registerSystem(\"tips\", {\n  init: function() {\n    this.activeTip = null;\n    this._performStep = this._performStep.bind(this);\n\n    if (localStorage.getItem(LOCAL_STORAGE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n    }\n  },\n\n  resetTips: function() {\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n    localStorageCache = null;\n    window.APP.store.resetTipActivityFlags();\n    window.APP.store.resetConfirmedBroadcastedRooms();\n    this.activeTip = null;\n    finished = false;\n  },\n\n  skipTips: function() {\n    for (let i = 0; i < platformTips.length; i++) {\n      const tipId = platformTips[i];\n      markTipFinished(tipId);\n    }\n  },\n\n  tick: function() {\n    if (isMobileVR) return; // Optimization for now, don't bother with this on mobile VR until we have real tips\n\n    if (!this._userinput) {\n      this._userinput = this.el.systems.userinput;\n\n      if (!this._userinput) return;\n    }\n\n    const tips = platformTips;\n\n    const prevTip = this.activeTip;\n\n    this._performStep(tips);\n\n    if (prevTip !== this.activeTip) {\n      this.el.emit(\"tip-changed\", this.activeTip);\n    }\n  },\n\n  _performStep: function(tips) {\n    if (finished) return;\n\n    let chosenTip = null;\n    let finishCount = 0;\n\n    for (let i = 0; i < tips.length; i++) {\n      const tip = tips[i];\n\n      if (localStorageCache === null) {\n        localStorageCache = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n      }\n\n      if (localStorageCache[tip] && localStorageCache[tip].finished) {\n        finishCount++;\n        continue;\n      }\n\n      switch (VALIDATORS[tip](this._userinput, this.el, window.APP.hub)) {\n        case FINISH:\n          markTipFinished(tip);\n          break;\n        case VALID:\n          chosenTip = `tips.${tipPlatform()}.${tip}`;\n          break;\n      }\n\n      if (chosenTip) break;\n    }\n\n    this.activeTip = chosenTip;\n\n    if (finishCount === tips.length) {\n      // Optimization: Tips are completed no need to re-walk.\n      finished = true;\n    }\n  }\n});\n","/* global AFRAME */\nimport { paths } from \"./userinput/paths\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { isTagged } from \"../components/tags\";\nimport { hasComponent } from \"bitecs\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\n\nimport {\n  HoveredRemoteRight,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredHandLeft,\n  HeldRemoteRight,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldHandLeft,\n  AEntity\n} from \"../bit-components\";\n\nfunction anyAframeEntityWith(world, component) {\n  const eid = anyEntityWith(world, component);\n  return eid && hasComponent(world, AEntity, eid) && world.eid2obj.get(eid).el;\n}\nexport function isUI(el) {\n  return isTagged(el, \"singleActionButton\") || isTagged(el, \"holdableButton\");\n}\n\nfunction identityFn(o) {\n  return o;\n}\n\nAFRAME.registerSystem(\"interaction\", {\n  getActiveIntersection() {\n    return (\n      (this.state.rightRemote.hovered && this.rightCursorControllerEl.components[\"cursor-controller\"].intersection) ||\n      (this.state.leftRemote.hovered && this.leftCursorControllerEl.components[\"cursor-controller\"].intersection)\n    );\n  },\n\n  isHoldingAnything(pred = identityFn) {\n    return !!(\n      pred(this.state.leftHand.held) ||\n      pred(this.state.rightHand.held) ||\n      pred(this.state.rightRemote.held) ||\n      pred(this.state.leftRemote.held)\n    );\n  },\n\n  isHeld(el) {\n    return (\n      this.state.leftHand.held === el ||\n      this.state.rightHand.held === el ||\n      this.state.rightRemote.held === el ||\n      this.state.leftRemote.held === el\n    );\n  },\n\n  init: function() {\n    this.options = {\n      leftHand: {\n        entity: null,\n        grabPath: paths.actions.leftHand.grab,\n        dropPath: paths.actions.leftHand.drop\n      },\n      rightHand: {\n        entity: null,\n        grabPath: paths.actions.rightHand.grab,\n        dropPath: paths.actions.rightHand.drop\n      },\n      rightRemote: {\n        entity: null,\n        grabPath: paths.actions.cursor.right.grab,\n        dropPath: paths.actions.cursor.right.drop\n      },\n      leftRemote: {\n        entity: null,\n        grabPath: paths.actions.cursor.left.grab,\n        dropPath: paths.actions.cursor.left.drop\n      }\n    };\n    this.state = {\n      leftHand: {\n        hovered: null,\n        held: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null\n      },\n      leftRemote: {\n        hovered: null,\n        held: null\n      }\n    };\n    this.previousState = {\n      leftHand: {\n        hovered: null,\n        held: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null\n      },\n      leftRemote: {\n        hovered: null,\n        held: null\n      }\n    };\n    waitForDOMContentLoaded().then(() => {\n      this.options.leftHand.entity = document.getElementById(\"player-left-controller\");\n      this.options.rightHand.entity = document.getElementById(\"player-right-controller\");\n      this.options.rightRemote.entity = document.getElementById(\"right-cursor\");\n      this.options.leftRemote.entity = document.getElementById(\"left-cursor\");\n      this.rightCursorControllerEl = document.getElementById(\"right-cursor-controller\");\n      this.leftCursorControllerEl = document.getElementById(\"left-cursor-controller\");\n      this.ready = true;\n    });\n  },\n\n  updateLegacyState() {\n    this.previousState.rightRemote.hovered = this.state.rightRemote.hovered;\n    this.previousState.rightRemote.held = this.state.rightRemote.held;\n    this.previousState.leftRemote.hovered = this.state.leftRemote.hovered;\n    this.previousState.leftRemote.held = this.state.leftRemote.held;\n    this.previousState.leftHand.hovered = this.state.leftHand.hovered;\n    this.previousState.leftHand.held = this.state.leftHand.held;\n    this.previousState.rightHand.hovered = this.state.rightHand.hovered;\n    this.previousState.rightHand.held = this.state.rightHand.held;\n\n    const world = APP.world;\n    this.state.rightRemote.hovered = anyAframeEntityWith(world, HoveredRemoteRight);\n    this.state.leftRemote.hovered = anyAframeEntityWith(world, HoveredRemoteLeft);\n    this.state.rightHand.hovered = anyAframeEntityWith(world, HoveredHandRight);\n    this.state.leftHand.hovered = anyAframeEntityWith(world, HoveredHandLeft);\n    this.state.rightRemote.held = anyAframeEntityWith(world, HeldRemoteRight);\n    this.state.leftRemote.held = anyAframeEntityWith(world, HeldRemoteLeft);\n    this.state.rightHand.held = anyAframeEntityWith(world, HeldHandRight);\n    this.state.leftHand.held = anyAframeEntityWith(world, HeldHandLeft);\n  }\n});\n","import { defineQuery, enterQuery, exitQuery } from \"bitecs\";\nimport { CursorRaycastable } from \"../bit-components\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nconst noop = function() {};\nAFRAME.registerComponent(\"overwrite-raycast-as-noop\", {\n  init() {\n    this.el.object3D.raycast = noop;\n    this.mesh = this.el.getObject3D(\"mesh\");\n    if (this.mesh) {\n      this.mesh.raycast = noop;\n    } else {\n      this.el.addEventListener(\"model-loaded\", () => {\n        this.mesh = this.el.getObject3D(\"mesh\");\n        if (this.mesh) {\n          this.mesh.raycast = noop;\n        }\n      });\n    }\n  }\n});\n\nconst cursorRaycastableQuery = defineQuery([CursorRaycastable]);\nconst enteredCursorRaycastableQuery = enterQuery(cursorRaycastableQuery);\nconst exitedCurserRaycastableQuery = exitQuery(cursorRaycastableQuery);\n\nexport class CursorTargettingSystem {\n  constructor() {\n    this.targets = [];\n    this.dirty = true;\n    this.onMutation = this.onMutation.bind(this);\n    this.onObject3DSet = this.onObject3DSet.bind(this);\n    this.onObject3DRemove = this.onObject3DRemove.bind(this);\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.onMutation);\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.rightRemote = document.getElementById(\"right-cursor-controller\");\n      this.leftRemote = document.getElementById(\"left-cursor-controller\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.onObject3DSet);\n      scene.addEventListener(\"object3dremove\", this.onObject3DRemove);\n    });\n  }\n\n  tick(t) {\n    if (\n      this.dirty ||\n      enteredCursorRaycastableQuery(APP.world).length ||\n      exitedCurserRaycastableQuery(APP.world).length\n    ) {\n      this.populateEntities(this.targets);\n      this.dirty = false;\n    }\n\n    if (this.rightRemote) {\n      this.rightRemote.components[\"cursor-controller\"].tick2(t);\n    }\n\n    if (this.leftRemote) {\n      this.leftRemote.components[\"cursor-controller\"].tick2(t, true);\n    }\n  }\n\n  onObject3DSet() {\n    this.dirty = true;\n  }\n\n  onObject3DRemove() {\n    this.dirty = true;\n  }\n\n  onMutation(records) {\n    // let's try to avoid re-querying the targets on attribute changes we know we can ignore\n    if (records.some(r => r.type === \"childList\" || (r.type === \"attributes\" && r.attributeName === \"class\"))) {\n      this.dirty = true;\n    }\n  }\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\n      \".collidable, .interactable, .ui, .drawing, .occupiable-waypoint-icon, .teleport-waypoint-icon, .avatar-inspect-collider\"\n    );\n    for (let i = 0; i < els.length; i++) {\n      if (els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n\n    const eids = cursorRaycastableQuery(APP.world);\n    for (let i = 0; i < eids.length; i++) {\n      targets.push(APP.world.eid2obj.get(eids[i]));\n    }\n  }\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.onObject3DSet);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.onObject3DRemove);\n  }\n}\n","import { hasComponent } from \"bitecs\";\nimport {\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredHandLeft,\n  HoveredHandRight,\n  Pen\n} from \"../bit-components\";\nimport { CAMERA_MODE_INSPECT } from \"../systems/camera-system\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\nimport { hackyMobileSafariTest } from \"../utils/detect-touchscreen\";\nimport { paths } from \"./userinput/paths\";\n\nfunction shouldEnableRemote(world, scene, handHovering, handHeld, remoteHeld, teleporting, woke) {\n  const vrRemotePenIntersection =\n    scene.is(\"vr-mode\") &&\n    remoteHeld &&\n    hasComponent(world, Pen, remoteHeld) &&\n    world.eid2obj.get(remoteHeld).el.children[0].components.pen.intersection;\n\n  return scene.is(\"entered\") && woke && !handHovering && !handHeld && !teleporting && !vrRemotePenIntersection;\n}\n\nexport class CursorTogglingSystem {\n  constructor() {\n    this.wakeLeft = false;\n    this.wakeRight = false;\n\n    waitForDOMContentLoaded().then(() => {\n      this.domContentLoadedButComponentsMayNotHave = true;\n    });\n  }\n\n  tick(interaction, userinput, scene) {\n    if (!this.domContentLoadedButComponentsMayNotHave) return;\n    if (!this.gotComponentReferences) {\n      this.gotComponentReferences = true;\n      this.rightCursorController = document.getElementById(\"right-cursor-controller\").components[\"cursor-controller\"];\n      this.leftCursorController = document.getElementById(\"left-cursor-controller\").components[\"cursor-controller\"];\n      this.rightHandTeleporter = document.getElementById(\"player-right-controller\").components[\"teleporter\"];\n      this.leftHandTeleporter = document.getElementById(\"player-left-controller\").components[\"teleporter\"];\n      this.gazeTeleporter = document.getElementById(\"gaze-teleport\").components[\"teleporter\"];\n    }\n\n    const world = APP.world;\n\n    // TODO this is also in resolveActionSets. It might be we actually do want something like the legacy interaction system state\n    const leftHandHovering = anyEntityWith(world, HoveredHandLeft);\n    const leftHandHolding = anyEntityWith(world, HeldHandLeft);\n    const leftRemoteHolding = anyEntityWith(world, HeldRemoteLeft);\n    const rightHandHovering = anyEntityWith(world, HoveredHandRight);\n    const rightHandHolding = anyEntityWith(world, HeldHandRight);\n    const rightRemoteHolding = anyEntityWith(world, HeldRemoteRight);\n\n    if (userinput.get(paths.actions.cursor.right.wake)) {\n      this.wakeRight = true;\n      if (!leftRemoteHolding) {\n        this.wakeLeft = false;\n      }\n    }\n\n    if (userinput.get(paths.actions.cursor.left.wake)) {\n      this.wakeLeft = true;\n      if (!rightRemoteHolding) {\n        this.wakeRight = false;\n      }\n    }\n\n    const inspecting = interaction.el.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT;\n    const shouldEnableLeftRemote =\n      !inspecting &&\n      shouldEnableRemote(\n        world,\n        scene,\n        leftHandHovering,\n        leftHandHolding,\n        leftRemoteHolding,\n        this.leftHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting,\n        this.wakeLeft\n      );\n    const isMobile = AFRAME.utils.device.isMobile();\n    const shouldEnableRightRemote =\n      isMobile ||\n      hackyMobileSafariTest() ||\n      (!inspecting &&\n        shouldEnableRemote(\n          world,\n          scene,\n          rightHandHovering,\n          rightHandHolding,\n          rightRemoteHolding,\n          this.rightHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting,\n          this.wakeRight\n        ));\n\n    this.leftCursorController.enabled = shouldEnableLeftRemote;\n    this.rightCursorController.enabled = shouldEnableRightRemote;\n  }\n}\n","import { AmmoWorker, WorkerHelpers, CONSTANTS } from \"three-ammo\";\nimport { AmmoDebugConstants, DefaultBufferSize } from \"ammo-debug-drawer\";\nimport configs from \"../utils/configs\";\nimport ammoWasmUrl from \"ammo.js/builds/ammo.wasm.wasm\";\n\nconst MESSAGE_TYPES = CONSTANTS.MESSAGE_TYPES,\n  TYPE = CONSTANTS.TYPE,\n  BUFFER_CONFIG = CONSTANTS.BUFFER_CONFIG;\n\nconst WORLD_CONFIG = {\n  debugDrawMode: AmmoDebugConstants.DrawWireframe,\n  gravity: { x: 0, y: -9.8, z: 0 }\n};\n\nconst MAX_BODIES = 512;\n\nexport class PhysicsSystem {\n  constructor(scene) {\n    this.ammoWorker = new AmmoWorker();\n    this.workerHelpers = new WorkerHelpers(this.ammoWorker);\n\n    this.bodyUuids = [];\n    this.indexToUuid = {};\n    this.bodyUuidToData = new Map();\n\n    this.debug = false;\n    this.debugRequested = false;\n    this.debugEnabled = false;\n    this.scene = scene;\n    this.stepDuration = 0;\n\n    this.ready = false;\n    this.nextBodyUuid = 1;\n    this.nextShapeUuid = 1;\n\n    const arrayBuffer = new ArrayBuffer(4 * BUFFER_CONFIG.BODY_DATA_SIZE * MAX_BODIES);\n    this.objectMatricesFloatArray = new Float32Array(arrayBuffer);\n    this.objectMatricesIntArray = new Int32Array(arrayBuffer);\n\n    this.ammoWorker.postMessage(\n      {\n        type: MESSAGE_TYPES.INIT,\n        worldConfig: WORLD_CONFIG,\n        arrayBuffer,\n        maxBodies: MAX_BODIES,\n        wasmUrl: new URL(ammoWasmUrl, configs.BASE_ASSETS_PATH || window.location).href\n      },\n      [arrayBuffer]\n    );\n\n    this.ammoWorker.onmessage = async event => {\n      if (event.data.type === MESSAGE_TYPES.READY) {\n        this.ready = true;\n      } else if (event.data.type === MESSAGE_TYPES.BODY_READY) {\n        const { uuid, index } = event.data;\n        const bodyData = this.bodyUuidToData.get(uuid);\n        bodyData.index = index;\n        bodyData.isInitialized = true;\n        if (bodyData.removeBodyMessageSent) {\n          this.bodyUuidToData.delete(uuid);\n        } else {\n          this.bodyUuids.push(uuid);\n          this.indexToUuid[index] = uuid;\n        }\n      } else if (event.data.type === MESSAGE_TYPES.SHAPES_READY) {\n        const bodyUuid = event.data.bodyUuid;\n        const shapesUuid = event.data.shapesUuid;\n        if (this.bodyUuidToData.has(bodyUuid)) {\n          this.bodyUuidToData.get(bodyUuid).shapes.push(shapesUuid);\n        } else {\n          console.warn(`Shape initialized on worker but body is missing.`);\n        }\n      } else if (event.data.type === MESSAGE_TYPES.TRANSFER_DATA) {\n        this.objectMatricesFloatArray = event.data.objectMatricesFloatArray;\n        this.objectMatricesIntArray = new Int32Array(this.objectMatricesFloatArray.buffer);\n        this.stepDuration = event.data.stepDuration;\n      }\n    };\n  }\n\n  setDebug(debug) {\n    this.debugRequested = debug;\n  }\n\n  enableDebug() {\n    if (!window.SharedArrayBuffer) {\n      console.warn(\"Physics debug rendering only available in browsers that support SharedArrayBuffers.\");\n      this.debugRequested = false;\n      return;\n    }\n\n    this.debugEnabled = true;\n\n    if (!this.debugMesh) {\n      this.debugSharedArrayBuffer = new window.SharedArrayBuffer(4 + 2 * DefaultBufferSize * 4);\n      this.debugIndex = new Uint32Array(this.debugSharedArrayBuffer, 0, 4);\n      const debugVertices = new Float32Array(this.debugSharedArrayBuffer, 4, DefaultBufferSize);\n      const debugColors = new Float32Array(this.debugSharedArrayBuffer, 4 + DefaultBufferSize, DefaultBufferSize);\n      this.debugGeometry = new THREE.BufferGeometry();\n      this.debugGeometry.addAttribute(\"position\", new THREE.BufferAttribute(debugVertices, 3));\n      this.debugGeometry.addAttribute(\"color\", new THREE.BufferAttribute(debugColors, 3));\n      const debugMaterial = new THREE.LineBasicMaterial({\n        vertexColors: true,\n        depthTest: true\n      });\n      this.debugMesh = new THREE.LineSegments(this.debugGeometry, debugMaterial);\n      this.debugMesh.frustumCulled = false;\n      this.debugMesh.renderOrder = 999;\n    }\n\n    if (!this.debugMesh.parent) {\n      this.scene.add(this.debugMesh);\n      this.workerHelpers.enableDebug(true, this.debugSharedArrayBuffer);\n    }\n  }\n\n  disableDebug() {\n    this.debugEnabled = false;\n    if (this.debugMesh) {\n      this.scene.remove(this.debugMesh);\n      this.workerHelpers.enableDebug(false);\n    }\n  }\n\n  tick = (() => {\n    const transform = new THREE.Matrix4();\n    const inverse = new THREE.Matrix4();\n    const matrix = new THREE.Matrix4();\n    const scale = new THREE.Vector3();\n    return function () {\n      if (this.ready) {\n        if (this.debugRequested !== this.debugEnabled) {\n          if (this.debugRequested) {\n            this.enableDebug();\n          } else {\n            this.disableDebug();\n          }\n        }\n\n        /** Buffer Schema\n         * Every physics body has 26 * 4 bytes (64bit float/int) assigned in the buffer\n         * 0-15   Matrix4 elements (floats)\n         * 16     Linear Velocity (float)\n         * 17     Angular Velocity (float)\n         * 18-25  first 8 Collisions (ints)\n         */\n\n        if (this.objectMatricesFloatArray.buffer.byteLength !== 0) {\n          for (let i = 0; i < this.bodyUuids.length; i++) {\n            const uuid = this.bodyUuids[i];\n            const body = this.bodyUuidToData.get(uuid);\n            const index = body.index;\n            const type = body.options.type ? body.options.type : TYPE.DYNAMIC;\n            const object3D = body.object3D;\n            if (!object3D.parent) {\n              // TODO: Fix me\n              console.error(\"Physics body exists but object3D has no parent.\");\n              continue;\n            }\n            if (type === TYPE.DYNAMIC) {\n              matrix.fromArray(\n                this.objectMatricesFloatArray,\n                index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.MATRIX_OFFSET\n              );\n              object3D.parent.updateMatrices();\n              inverse.copy(object3D.parent.matrixWorld).invert();\n              transform.multiplyMatrices(inverse, matrix);\n              transform.decompose(object3D.position, object3D.quaternion, scale);\n              object3D.matrixNeedsUpdate = true;\n            }\n\n            object3D.updateMatrices();\n            this.objectMatricesFloatArray.set(\n              object3D.matrixWorld.elements,\n              index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.MATRIX_OFFSET\n            );\n\n            body.linearVelocity =\n              this.objectMatricesFloatArray[\n                index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.LINEAR_VELOCITY_OFFSET\n              ];\n\n            body.angularVelocity =\n              this.objectMatricesFloatArray[\n                index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.ANGULAR_VELOCITY_OFFSET\n              ];\n\n            body.collisions.length = 0;\n\n            for (let j = BUFFER_CONFIG.COLLISIONS_OFFSET; j < BUFFER_CONFIG.BODY_DATA_SIZE; j++) {\n              const collidingIndex = this.objectMatricesIntArray[index * BUFFER_CONFIG.BODY_DATA_SIZE + j];\n              if (collidingIndex !== -1) {\n                const collision = this.indexToUuid[collidingIndex];\n                if (collision !== undefined) {\n                  // This will happen whenever you delete an object that is colliding with something\n                  // because we eagerly delete from the map when removing a body.\n                  body.collisions.push(this.indexToUuid[collidingIndex]);\n                }\n              }\n            }\n          }\n\n          this.ammoWorker.postMessage(\n            { type: MESSAGE_TYPES.TRANSFER_DATA, objectMatricesFloatArray: this.objectMatricesFloatArray },\n            [this.objectMatricesFloatArray.buffer]\n          );\n        }\n\n        /* DEBUG RENDERING */\n        if (this.debugEnabled) {\n          const index = window.Atomics.load(this.debugIndex, 0);\n          if (index !== 0) {\n            this.debugGeometry.attributes.position.needsUpdate = true;\n            this.debugGeometry.attributes.color.needsUpdate = true;\n          }\n          this.debugGeometry.setDrawRange(0, index);\n          window.Atomics.store(this.debugIndex, 0, 0);\n        }\n      }\n    };\n  })();\n\n  addBody(object3D, options) {\n    const bodyId = this.nextBodyUuid;\n    this.nextBodyUuid += 1;\n\n    this.workerHelpers.addBody(bodyId, object3D, options);\n\n    this.bodyUuidToData.set(bodyId, {\n      object3D: object3D,\n      options: options,\n      collisions: [],\n      linearVelocity: 0,\n      angularVelocity: 0,\n      index: -1,\n      shapes: [],\n      isInitialized: false,\n      removeBodyMessageSent: false\n    });\n\n    return bodyId;\n  }\n\n  updateBody(uuid, options) {\n    if (this.bodyUuidToData.has(uuid)) {\n      this.bodyUuidToData.get(uuid).options = options;\n      this.workerHelpers.updateBody(uuid, options);\n    } else {\n      console.warn(`updateBody called for uuid: ${uuid} but body missing.`);\n    }\n  }\n\n  // TODO inline updateBody\n  updateBodyOptions(bodyId, options) {\n    const bodyData = this.bodyUuidToData.get(bodyId);\n    if (!bodyData) {\n      // TODO: Fix me.\n      console.warn(\"updateBodyOptions called for invalid bodyId\");\n      return;\n    }\n    this.workerHelpers.updateBody(bodyId, Object.assign(this.bodyUuidToData.get(bodyId).options, options));\n  }\n\n  removeBody(uuid) {\n    const bodyData = this.bodyUuidToData.get(uuid);\n    if (!bodyData) {\n      // TODO: REMOVE ME. We should not ever see this!\n      console.error(`removeBody called for unknown body id`);\n      return;\n    }\n\n    this.workerHelpers.removeBody(uuid);\n    bodyData.removeBodyMessageSent = true;\n\n    if (bodyData.isInitialized) {\n      delete this.indexToUuid[bodyData.index];\n      bodyData.collisions.forEach(otherId => {\n        const otherData = this.bodyUuidToData.get(otherId).collisions;\n        otherData.splice(otherData.indexOf(uuid), 1);\n      });\n      this.bodyUuids.splice(this.bodyUuids.indexOf(uuid), 1);\n      this.bodyUuidToData.delete(uuid);\n    }\n  }\n\n  addShapes(bodyUuid, mesh, options) {\n    if (mesh) {\n      const scale = new THREE.Vector3();\n      mesh.updateMatrices();\n      scale.setFromMatrixScale(mesh.matrixWorld);\n    }\n    this.workerHelpers.addShapes(bodyUuid, this.nextShapeUuid, mesh, options);\n    this.bodyUuidToData.get(bodyUuid).shapes.push(this.nextShapeUuid);\n    return this.nextShapeUuid++;\n  }\n\n  removeShapes(bodyUuid, shapesUuid) {\n    if (this.bodyUuidToData.has(bodyUuid)) {\n      this.workerHelpers.removeShapes(bodyUuid, shapesUuid);\n      const idx = this.bodyUuidToData.get(bodyUuid).shapes.indexOf(shapesUuid);\n      if (idx !== -1) {\n        this.bodyUuidToData.get(bodyUuid).shapes.splice(idx, 1);\n      } else {\n        console.warn(`removeShapes called for shapesUuid: ${shapesUuid} on bodyUuid: ${bodyUuid} but shapes missing.`);\n      }\n    } else {\n      console.error(`Tried to remove shape for unknown body ${bodyUuid}`);\n    }\n  }\n\n  addConstraint(constraintId, bodyUuid, targetUuid, options) {\n    this.workerHelpers.addConstraint(constraintId, bodyUuid, targetUuid, options);\n  }\n\n  removeConstraint(constraintId) {\n    this.workerHelpers.removeConstraint(constraintId);\n  }\n\n  bodyInitialized(uuid) {\n    return this.bodyUuidToData.has(uuid) && this.bodyUuidToData.get(uuid).index !== -1;\n  }\n\n  getLinearVelocity(uuid) {\n    return this.bodyUuidToData.get(uuid).linearVelocity;\n  }\n\n  getAngularVelocity(uuid) {\n    return this.bodyUuidToData.get(uuid).angularVelocity;\n  }\n\n  getCollisions(uuid) {\n    return this.bodyUuidToData.get(uuid).collisions;\n  }\n\n  resetDynamicBody(uuid) {\n    this.workerHelpers.resetDynamicBody(uuid);\n  }\n\n  activateBody(uuid) {\n    this.workerHelpers.activateBody(uuid);\n  }\n}\n","/* global THREE AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst COLLISION_FILTER_MASK_HANDS = { collisionFilterMask: COLLISION_LAYERS.HANDS };\nexport const distanceBetweenStretchers = (() => {\n  const a = new THREE.Vector3();\n  const b = new THREE.Vector3();\n  return function distanceBetweenStretchers(obj1, obj2) {\n    obj1.getWorldPosition(a);\n    obj2.getWorldPosition(b);\n    return a.distanceTo(b);\n  };\n})();\n\nfunction existsAndHeldInEither(object, holderA, holderB) {\n  return object && (object === holderA.held || object === holderB.held);\n}\n\nexport class TwoPointStretchingSystem {\n  constructor() {\n    this.initialScale = new THREE.Vector3();\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    const { leftHand, rightHand, rightRemote, leftRemote } = interaction.state;\n\n    const stretching =\n      existsAndHeldInEither(leftHand.held, rightHand, rightRemote) ||\n      existsAndHeldInEither(leftRemote.held, rightHand, rightRemote);\n    const stretched = leftHand.held || leftRemote.held;\n    let leftStretcher, rightStretcher;\n    if (stretching) {\n      leftStretcher = leftHand.held\n        ? interaction.options.leftHand.entity.object3D\n        : interaction.options.leftRemote.entity.object3D;\n      rightStretcher = rightHand.held\n        ? interaction.options.rightHand.entity.object3D\n        : interaction.options.rightRemote.entity.object3D;\n      if (\n        leftStretcher !== this.previousLeftStretcher ||\n        rightStretcher !== this.previousRightStretcher ||\n        stretched !== this.stretched\n      ) {\n        this.initialStretchDistance = distanceBetweenStretchers(leftStretcher, rightStretcher);\n        this.stretched = stretched;\n        this.initialScale.copy(this.stretched.object3D.scale);\n        if (this.stretched.components[\"ammo-body\"]) {\n          this.stretched.setAttribute(\"ammo-body\", COLLISION_FILTER_MASK_HANDS);\n        }\n      }\n\n      this.stretched.object3D.scale\n        .copy(this.initialScale)\n        .multiplyScalar(distanceBetweenStretchers(leftStretcher, rightStretcher) / this.initialStretchDistance);\n      this.stretched.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.previousLeftStretcher = leftStretcher;\n    this.previousRightStretcher = rightStretcher;\n  }\n}\n","import { isTagged } from \"../components/tags\";\n\nexport class HoldableButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const held = interaction.state.rightRemote.held;\n\n    if (this.prevHeld && this.prevHeld !== held) {\n      // TODO: Should this check for holdable button?\n      this.prevHeld.object3D.dispatchEvent({\n        type: \"holdable-button-up\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n    if (held && this.prevHeld !== held) {\n      held.object3D.dispatchEvent({\n        type: \"holdable-button-down\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n\n    this.prevHeld = held;\n\n    const heldLeft = interaction.state.leftRemote.held;\n\n    if (this.prevHeldLeft && this.prevHeldLeft !== heldLeft) {\n      isTagged(this.prevHeldLeft, \"holdableButton\") &&\n        this.prevHeldLeft.object3D.dispatchEvent({\n          type: \"holdable-button-up\",\n          object3D: interaction.options.leftRemote.entity.object3D\n        });\n    }\n    if (heldLeft && this.prevHeldLeft !== heldLeft) {\n      isTagged(this.heldLeft, \"holdableButton\") &&\n        heldLeft.object3D.dispatchEvent({\n          type: \"holdable-button-down\",\n          object3D: interaction.options.leftRemote.entity.object3D\n        });\n    }\n\n    this.prevHeldLeft = heldLeft;\n  }\n}\n\nconst hasButtonComponent = (function() {\n  const BUTTON_COMPONENT_NAMES = [\n    \"icon-button\",\n    \"text-button\",\n    \"pin-networked-object-button\",\n    \"mic-button\",\n    \"inspect-button\"\n  ];\n  return function hasButtonComponent(components) {\n    for (let i = 0; i < BUTTON_COMPONENT_NAMES.length; i++) {\n      if (components[BUTTON_COMPONENT_NAMES[i]]) {\n        return true;\n      }\n    }\n    return false;\n  };\n})();\n\nfunction getHoverableButton(hovered) {\n  if (!hovered) return null;\n\n  if (\n    hasButtonComponent(hovered.components) ||\n    hovered.classList.contains(\"teleport-waypoint-icon\") ||\n    hovered.classList.contains(\"occupiable-waypoint-icon\")\n  ) {\n    return hovered;\n  }\n  if (hovered.children) {\n    // TODO: not sure if looping thru children here is desireable, but we did this to accomodate the rounded-button mixins\n    for (let i = 0; i < hovered.children.length; i++) {\n      if (\n        hasButtonComponent(hovered.children[i].components) ||\n        hovered.children[i].classList.contains(\"teleport-waypoint-icon\") ||\n        hovered.children[i].classList.contains(\"occupiable-waypoint-icon\")\n      ) {\n        return hovered.children[i];\n      }\n    }\n  }\n  return null;\n}\n\nfunction dispatch(el, event) {\n  el.object3D.dispatchEvent(event);\n  if (el.children) {\n    for (let i = 0; i < el.children.length; i++) {\n      if (\n        hasButtonComponent(el.children[i].components) ||\n        el.children[i].classList.contains(\"teleport-waypoint-icon\") ||\n        el.children[i].classList.contains(\"occupiable-waypoint-icon\")\n      ) {\n        el.children[i].object3D.dispatchEvent(event);\n      }\n    }\n  }\n}\n\nconst HOVERED = { type: \"hovered\" };\nconst UNHOVERED = { type: \"unhovered\" };\nexport class HoverButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const button = getHoverableButton(interaction.state.rightRemote.hovered);\n    const button2 = getHoverableButton(interaction.state.leftRemote.hovered);\n\n    if (this.prevButton && this.prevButton !== button) {\n      dispatch(this.prevButton, UNHOVERED);\n    }\n\n    if (button && this.prevButton !== button) {\n      dispatch(button, HOVERED);\n    }\n\n    this.prevButton = button;\n\n    // TODO: hover should respect both remotes\n    if (this.prevButtonLeft && this.prevButtonLeft !== button2) {\n      dispatch(this.prevButtonLeft, UNHOVERED);\n    }\n\n    if (button2 && this.prevButtonLeft !== button2) {\n      dispatch(button2, HOVERED);\n    }\n\n    this.prevButtonLeft = button2;\n  }\n}\n","import { hasComponent } from \"bitecs\";\nimport { SingleActionButton } from \"../bit-components\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { SOUND_PEN_UNDO_DRAW } from \"./sound-effects-system\";\n\n/**\n * Drawing Menu System\n * A system for showing menus for drawings.\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nexport class DrawingMenuSystem {\n  constructor(sceneEl) {\n    this.sceneEl = sceneEl;\n\n    this.sceneEl.addEventListener(\"stateremoved\", this.hideMenus.bind(this));\n\n    this.lastIntersection = new THREE.Vector3();\n\n    this.drawingMenus = [];\n    this.buttonMap = {};\n\n    waitForDOMContentLoaded().then(() => {\n      this.cursorControllers = document.querySelectorAll(\"[cursor-controller]\");\n      this.camera = this.sceneEl.querySelector(\"#avatar-pov-node\");\n    });\n  }\n\n  tick() {\n    if (!this.cursorControllers || this.cursorControllers.length === 0 || !this.camera) return;\n\n    if (this.sceneEl.is(\"frozen\") && window.APP.hubChannel.can(\"spawn_drawing\")) {\n      const hovered = this.getHovered();\n      if (hovered) {\n        for (let i = 0; i < this.cursorControllers.length; i++) {\n          if (this.cursorControllers[i].components[\"cursor-controller\"].intersection) {\n            const intersectionPoint = this.cursorControllers[i].components[\"cursor-controller\"].intersection.point;\n            this.showMenu(hovered, intersectionPoint);\n          }\n        }\n      }\n      this.handleButtons();\n      this.scaleMenus();\n    }\n  }\n\n  getMenuScale(distance) {\n    if (distance <= 1.5) {\n      return 0.5;\n    }\n    return Math.min(3, distance - 1);\n  }\n\n  scaleMenus = (() => {\n    const cameraWorldPos = new THREE.Vector3();\n    return function() {\n      if (!this.drawingMenus || this.drawingMenus.length === 0) return;\n\n      this.camera.object3D.getWorldPosition(cameraWorldPos);\n\n      for (let i = 0; i < this.drawingMenus.length; i++) {\n        const menu = this.drawingMenus[i];\n        if (menu.object3D.visible && !menu.getAttribute(\"animation__show\")) {\n          const dist = cameraWorldPos.distanceTo(menu.object3D.position);\n          menu.object3D.scale.setScalar(this.getMenuScale(dist));\n          menu.object3D.matrixNeedsUpdate = true;\n        }\n      }\n    };\n  })();\n\n  handleButtons = (() => {\n    const remotes = [\"rightRemote\", \"leftRemote\"];\n    return function() {\n      const interaction = AFRAME.scenes[0].systems.interaction;\n      const userinput = AFRAME.scenes[0].systems.userinput;\n\n      for (let i = 0; i < remotes.length; i++) {\n        const remote = remotes[i];\n        if (interaction.state[remote]) {\n          const hovered = interaction.state[remote].hovered;\n          if (\n            hovered &&\n            userinput.get(interaction.options[remote].grabPath) &&\n            hasComponent(APP.world, SingleActionButton, hovered.eid)\n          ) {\n            if (this.buttonMap[hovered.object3D.uuid]) {\n              const networkedEntity = this.buttonMap[hovered.object3D.uuid];\n              if (hovered.classList.contains(\"undo-drawing\")) {\n                networkedEntity.components[\"networked-drawing\"].undoDraw();\n                this.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\n              } else if (hovered.classList.contains(\"delete-drawing\")) {\n                NAF.utils.takeOwnership(networkedEntity);\n                this.sceneEl.removeChild(networkedEntity);\n              } else if (hovered.classList.contains(\"serialize-drawing\")) {\n                networkedEntity.components[\"networked-drawing\"].serializeDrawing().then(() => {\n                  const networkedEntity = this.buttonMap[hovered.object3D.uuid];\n                  NAF.utils.takeOwnership(networkedEntity);\n                  this.sceneEl.removeChild(networkedEntity);\n                });\n              }\n            }\n          }\n        }\n      }\n    };\n  })();\n\n  getHovered() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    let hovered = null;\n    if (\n      interaction.state.leftRemote &&\n      interaction.state.leftRemote.hovered &&\n      interaction.state.leftRemote.hovered.classList.contains(\"drawing\")\n    ) {\n      hovered = interaction.state.leftRemote.hovered;\n    } else if (\n      interaction.state.rightRemote &&\n      interaction.state.rightRemote.hovered &&\n      interaction.state.rightRemote.hovered.classList.contains(\"drawing\")\n    ) {\n      hovered = interaction.state.rightRemote.hovered;\n    }\n    return hovered;\n  }\n\n  showMenu = (() => {\n    const position = new THREE.Vector3();\n    const cameraWorldPos = new THREE.Vector3();\n    return function(hovered, intersectionPoint) {\n      const menu = hovered.children[0];\n\n      if (!menu.object3D.visible || !almostEquals(0.25, intersectionPoint, this.lastIntersection)) {\n        this.camera.object3D.getWorldPosition(cameraWorldPos);\n        position\n          .subVectors(cameraWorldPos, intersectionPoint)\n          .normalize()\n          .multiplyScalar(0.1);\n        menu.object3D.position.copy(intersectionPoint).add(position);\n        menu.object3D.lookAt(cameraWorldPos);\n        menu.object3D.matrixNeedsUpdate = true;\n        menu.object3D.visible = true;\n        this.lastIntersection.copy(intersectionPoint);\n\n        const isMine = hovered.components.networked.isMine();\n        menu.querySelector(\".undo-drawing\").object3D.visible = isMine;\n        menu.querySelector(\".serialize-drawing\").object3D.visible =\n          isMine && window.APP.hubChannel.can(\"spawn_and_move_media\");\n\n        const dist = cameraWorldPos.distanceTo(menu.object3D.position);\n        const finalScale = this.getMenuScale(dist);\n\n        menu.removeAttribute(\"animation__show\");\n\n        menu.setAttribute(\"animation__show\", {\n          property: \"scale\",\n          dur: 300,\n          from: { x: finalScale * 0.8, y: finalScale * 0.8, z: finalScale * 0.8 },\n          to: { x: finalScale, y: finalScale, z: finalScale },\n          easing: \"easeOutElastic\"\n        });\n\n        menu.addEventListener(\n          \"animationcomplete\",\n          () => {\n            menu.removeAttribute(\"animation__show\");\n          },\n          { once: true }\n        );\n      }\n    };\n  })();\n\n  hideMenus() {\n    if (!this.drawingMenus) return;\n\n    for (let i = 0; i < this.drawingMenus.length; i++) {\n      this.drawingMenus[i].object3D.visible = false;\n    }\n  }\n\n  registerDrawingMenu(networkedDrawingEl) {\n    const menuEl = networkedDrawingEl.querySelector(\".drawing-menu\");\n    this.drawingMenus.push(menuEl);\n    const undoButton = menuEl.querySelector(\".undo-drawing\");\n    this.buttonMap[undoButton.object3D.uuid] = networkedDrawingEl;\n    const deleteButton = menuEl.querySelector(\".delete-drawing\");\n    this.buttonMap[deleteButton.object3D.uuid] = networkedDrawingEl;\n    const serializeButton = menuEl.querySelector(\".serialize-drawing\");\n    this.buttonMap[serializeButton.object3D.uuid] = networkedDrawingEl;\n  }\n\n  unregisterDrawingMenu(networkedDrawingEl) {\n    const menuEl = networkedDrawingEl.querySelector(\".drawing-menu\");\n    const idx = this.drawingMenus.indexOf(menuEl);\n    if (idx !== -1) {\n      this.drawingMenus.splice(idx, 1);\n    }\n    const undoButton = menuEl.querySelector(\".undo-drawing\");\n    delete this.buttonMap[undoButton.object3D.uuid];\n    const deleteButton = menuEl.querySelector(\".delete-drawing\");\n    delete this.buttonMap[deleteButton.object3D.uuid];\n    const serializeButton = menuEl.querySelector(\".serialize-drawing\");\n    delete this.buttonMap[serializeButton.object3D.uuid];\n  }\n}\n","import { isTagged } from \"../components/tags\";\n\nfunction getSpecificHoverMenu(el) {\n  return (\n    el &&\n    el.components &&\n    (el.components[\"hover-menu\"] ||\n      el.components[\"hover-menu__video\"] ||\n      el.components[\"hover-menu__pager\"] ||\n      el.components[\"hover-menu__hubs-item\"] ||\n      el.components[\"hover-menu__link\"] ||\n      el.components[\"hover-menu__photo\"])\n  );\n}\n\nfunction findHoverMenu(hovered) {\n  if (!hovered) return null;\n  const hoverMenu = getSpecificHoverMenu(hovered);\n  // console.log(\"hoverMenu\", hoverMenu);\n  if (hoverMenu) {\n    return hoverMenu;\n  }\n  if (!isTagged(hovered, \"isHoverMenuChild\")) {\n    // console.log(\"not a hover menu child, aborting\", hovered);\n    return null;\n  }\n  let el = hovered.parentNode;\n  while (el && !getSpecificHoverMenu(el)) {\n    el = el.parentNode;\n  }\n  return getSpecificHoverMenu(el);\n}\n\nexport class HoverMenuSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const hoverMenu = findHoverMenu(interaction.state.rightRemote.hovered);\n\n    if (this.prevHoverMenu && this.prevHoverMenu !== hoverMenu) {\n      this.prevHoverMenu.hovering = false;\n      this.prevHoverMenu.applyHoverState();\n    }\n\n    if (hoverMenu && this.prevHoverMenu !== hoverMenu) {\n      hoverMenu.hovering = true;\n      hoverMenu.applyHoverState();\n    }\n\n    this.prevHoverMenu = hoverMenu;\n\n    //TODO: Menu be visible if either remote is hovering.\n    const hoverMenu2 = findHoverMenu(interaction.state.leftRemote.hovered);\n\n    if (this.prevHoverMenu2 && this.prevHoverMenu2 !== hoverMenu2) {\n      this.prevHoverMenu2.hovering = false;\n      this.prevHoverMenu2.applyHoverState();\n    }\n\n    if (hoverMenu2 && this.prevHoverMenu2 !== hoverMenu2) {\n      hoverMenu2.hovering = true;\n      hoverMenu2.applyHoverState();\n    }\n\n    this.prevHoverMenu2 = hoverMenu2;\n  }\n}\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { Held, HeldHandLeft, HeldHandRight, HeldRemoteLeft, HeldRemoteRight } from \"../bit-components\";\nimport { addComponent } from \"bitecs\";\n\n// WARNING: This system mutates interaction system state!\nexport class SuperSpawnerSystem {\n  maybeSpawn(state, grabPath, HeldComponent) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const superSpawner = state.hovered && state.hovered.components[\"super-spawner\"];\n\n    const isPermitted =\n      window.APP.hubChannel &&\n      (superSpawner && superSpawner.data.template === \"#interactable-emoji\"\n        ? window.APP.hubChannel.can(\"spawn_emoji\")\n        : window.APP.hubChannel.can(\"spawn_and_move_media\"));\n\n    if (\n      superSpawner &&\n      superSpawner.spawnedMediaScale &&\n      !superSpawner.cooldownTimeout &&\n      userinput.get(grabPath) &&\n      isPermitted\n    ) {\n      this.performSpawn(state, superSpawner, HeldComponent);\n    }\n  }\n\n  performSpawn(state, superSpawner, HeldComponent) {\n    const data = superSpawner.data;\n\n    const spawnedEntity = addMedia(\n      data.src,\n      data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      data.resolve,\n      true,\n      false,\n      data.mediaOptions\n    ).entity;\n\n    // TODO HACK objects become held mid frame here, so if something runs between here and\n    // when the networked component is initialized isMine will throw since data doesnt exist\n    // should probably fix isMine in networked aframe instead of merging this\n    if (spawnedEntity.components.networked && !spawnedEntity.components.networked.data) {\n      spawnedEntity.components.networked.data = {};\n    }\n\n    superSpawner.el.object3D.getWorldPosition(spawnedEntity.object3D.position);\n    superSpawner.el.object3D.getWorldQuaternion(spawnedEntity.object3D.quaternion);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n    superSpawner.el.emit(\"spawned-entity-created\", { target: spawnedEntity });\n\n    superSpawner.activateCooldown();\n\n    spawnedEntity.addEventListener(\n      \"media-loaded\",\n      () => {\n        spawnedEntity.object3D.scale.copy(superSpawner.spawnedMediaScale);\n        spawnedEntity.object3D.matrixNeedsUpdate = true;\n\n        superSpawner.el.emit(\"spawned-entity-loaded\", { target: spawnedEntity });\n\n        // TODO we do this in media loaded as the entity doesn't appear to actually be initialized right away (and thus doesn't have an eid)\n        // This is fairly hacky and is why we had equally hacky \"spawning\" state stuff before. This goes away with non aframe entities so\n        // just localizing and carrying forward the hack for now.\n        addComponent(APP.world, HeldComponent, spawnedEntity.eid);\n        addComponent(APP.world, Held, spawnedEntity.eid);\n      },\n      { once: true }\n    );\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (!interaction.ready) return; //DOMContentReady workaround\n    this.maybeSpawn(interaction.state.leftHand, interaction.options.leftHand.grabPath, HeldHandLeft);\n    this.maybeSpawn(interaction.state.rightHand, interaction.options.rightHand.grabPath, HeldHandRight);\n    this.maybeSpawn(interaction.state.rightRemote, interaction.options.rightRemote.grabPath, HeldRemoteRight);\n    this.maybeSpawn(interaction.state.leftRemote, interaction.options.leftRemote.grabPath, HeldRemoteLeft);\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { distanceBetweenStretchers } from \"./two-point-stretching-system\";\n\nfunction copyState(previous, current, isTeleporting) {\n  previous.held = current.held;\n  previous.hovered = current.hovered;\n  previous.isTeleporting = isTeleporting;\n}\n\n// TODO: These strengths should be written into bindings, since vibration strength varies across devices.\nconst STRENGTH = {\n  DROP: 0.1,\n  PICKUP: 0.2,\n  BUTTON_PRESSED: 0.2,\n  HOVER: 0.08,\n  STRETCH_BASE: 0.05,\n  STRETCH_DISTANCE: 0.2,\n  TELEPORTING: 0.08,\n  TELEPORTED: 0.2\n};\n\nfunction determineStrength(previous, current, isTeleporting) {\n  if (previous.held && !current.held) {\n    return STRENGTH.DROP;\n  } else if (!previous.held && current.held) {\n    return STRENGTH.PICKUP;\n  } else if (!previous.hovered && current.hovered) {\n    return STRENGTH.HOVER;\n  } else if (isTeleporting) {\n    return STRENGTH.TELEPORTING;\n  } else if (previous.isTeleporting && !isTeleporting) {\n    return STRENGTH.TELEPORTED;\n  } else {\n    return 0;\n  }\n}\n\nfunction determineStretchStrength(stretchSystem) {\n  if (!stretchSystem.stretcherLeft || !stretchSystem.stretcherRight) {\n    return 0;\n  }\n\n  return THREE.MathUtils.clamp(\n    STRENGTH.STRETCH_BASE +\n      STRENGTH.STRETCH_DISTANCE *\n        Math.abs(\n          distanceBetweenStretchers(stretchSystem.stretcherLeft, stretchSystem.stretcherRight) -\n            stretchSystem.initialStretchDistance\n        ),\n    0,\n    0.5\n  );\n}\n\nexport class HapticFeedbackSystem {\n  constructor() {\n    this.state = {\n      rightHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      rightRemote: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      leftHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      leftRemote: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      }\n    };\n  }\n\n  tick(twoPointStretchingSystem, interactLeft, interactRight) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const leftActuator = userinput.get(paths.haptics.actuators.left);\n    const rightActuator = userinput.get(paths.haptics.actuators.right);\n    if (!leftActuator && !rightActuator) {\n      return;\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote, leftRemote } = interaction.state;\n    this.leftTeleporter =\n      this.leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n    this.rightTeleporter =\n      this.rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n\n    const leftHandStrength = determineStrength(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    const rightHandStrength = determineStrength(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    const rightRemoteStrength = determineStrength(this.state.rightRemote, rightRemote, false);\n    const leftRemoteStrength = determineStrength(this.state.leftRemote, leftRemote, false);\n    const buttonLeftStrength = interactLeft ? STRENGTH.BUTTON_PRESSED : 0;\n    const buttonRightStrength = interactRight ? STRENGTH.BUTTON_PRESSED : 0;\n    const stretchingStrength = determineStretchStrength(twoPointStretchingSystem);\n\n    const leftStrength = Math.max(leftHandStrength, leftRemoteStrength, stretchingStrength, buttonLeftStrength);\n    const rightStrength = Math.max(rightHandStrength, rightRemoteStrength, stretchingStrength, buttonRightStrength);\n\n    if (leftStrength && leftActuator) {\n      leftActuator.pulse(leftStrength, 15);\n    }\n\n    if (rightStrength && rightActuator) {\n      rightActuator.pulse(rightStrength, 15);\n    }\n\n    copyState(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    copyState(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    copyState(this.state.rightRemote, rightRemote, false);\n    copyState(this.state.leftRemote, leftRemote, false);\n  }\n}\n","import { CAMERA_MODE_INSPECT } from \"./camera-system.js\";\nimport { setMatrixWorld } from \"../utils/three-utils\";\n\nlet viewingCamera;\nlet uiRoot;\nexport class ScenePreviewCameraSystem {\n  constructor() {\n    this.entities = [];\n  }\n\n  register(el) {\n    this.entities.push(el);\n  }\n\n  unregister(el) {\n    this.entities.splice(this.entities.indexOf(el), 1);\n  }\n\n  tick() {\n    viewingCamera = viewingCamera || document.getElementById(\"viewing-camera\");\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\n    const entered = viewingCamera && viewingCamera.sceneEl.is(\"entered\");\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n    for (let i = 0; i < this.entities.length; i++) {\n      const el = this.entities[i];\n      const hubsSystems = AFRAME.scenes[0].systems[\"hubs-systems\"];\n      if (el && (!hubsSystems || (hubsSystems.cameraSystem.mode !== CAMERA_MODE_INSPECT && !isGhost && !entered))) {\n        el.components[\"scene-preview-camera\"].tick2();\n        if (hubsSystems && viewingCamera) {\n          el.object3D.updateMatrices();\n          setMatrixWorld(viewingCamera.object3DMap.camera, el.object3D.matrixWorld);\n        }\n      }\n    }\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { SOUND_HOVER_OR_GRAB } from \"./sound-effects-system\";\nimport { isUI } from \"./interactions\";\nimport {\n  HeldHandLeft,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldRemoteRight,\n  HoveredHandLeft,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredRemoteRight\n} from \"../bit-components\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\n\nexport class InteractionSfxSystem {\n  constructor() {}\n\n  tick(interaction, userinput, sfx) {\n    const state = interaction.state;\n    const previousState = interaction.previousState;\n\n    if (\n      state.leftHand.held !== previousState.leftHand.held ||\n      state.rightHand.held !== previousState.rightHand.held ||\n      state.rightRemote.held !== previousState.rightRemote.held ||\n      (isUI(state.rightRemote.hovered) && state.rightRemote.hovered !== previousState.rightRemote.hovered) ||\n      state.leftRemote.held !== previousState.leftRemote.held ||\n      (isUI(state.leftRemote.hovered) && state.leftRemote.hovered !== previousState.leftRemote.hovered)\n    ) {\n      sfx.playSoundOneShot(SOUND_HOVER_OR_GRAB);\n    }\n\n    if (userinput.get(paths.actions.logInteractionState)) {\n      console.log(\n        \"Interaction System State\\nleftHand held\",\n        state.leftHand.held,\n        \"\\nleftHand hovered\",\n        state.leftHand.hovered,\n        \"\\nrightHand held\",\n        state.rightHand.held,\n        \"\\nrightHand hovered\",\n        state.rightHand.hovered,\n        \"\\nrightRemote held\",\n        state.rightRemote.held,\n        \"\\nrightRemote hovered\",\n        state.rightRemote.hovered,\n        \"\\nleftRemote held\",\n        state.leftRemote.held,\n        \"\\nleftRemote hovered\",\n        state.leftRemote.hovered\n      );\n\n      console.log(\n        \"Interaction System State\\nleftHand held\",\n        anyEntityWith(APP.world, HeldHandLeft),\n        \"\\nleftHand hovered\",\n        anyEntityWith(APP.world, HoveredHandLeft),\n        \"\\nrightHand held\",\n        anyEntityWith(APP.world, HeldHandRight),\n        \"\\nrightHand hovered\",\n        anyEntityWith(APP.world, HoveredHandRight),\n        \"\\nrightRemote held\",\n        anyEntityWith(APP.world, HeldRemoteRight),\n        \"\\nrightRemote hovered\",\n        anyEntityWith(APP.world, HoveredRemoteRight),\n        \"\\nleftRemote held\",\n        anyEntityWith(APP.world, HeldRemoteLeft),\n        \"\\nleftRemote hovered\",\n        anyEntityWith(APP.world, HoveredRemoteLeft)\n      );\n    }\n  }\n}\n","import \"./configs\";\nimport { getThemeColor } from \"./theme\";\nimport ColorShiftWorker from \"../workers/color-shift.worker.js\";\nimport { promisifyWorker } from \"./promisify-worker.js\";\nconst colorShift = promisifyWorker(new ColorShiftWorker());\n\nfunction getThemeColorShifter(type) {\n  // Goal of this algorithm is to take a ctx pointing to a spritesheet\n  // that has a single saturated color, and convert it to another.\n  return async (ctx, w, h) => {\n    const data = ctx.getImageData(0, 0, w, h);\n    const color = type === \"action\" ? getThemeColor(\"action-color\") : getThemeColor(\"notice-background-color\");\n    const res = await colorShift(data.data.buffer, [data.data.buffer], { type, color });\n    ctx.putImageData(new ImageData(res, w, h), 0, 0);\n  };\n}\n\nexport { getThemeColorShifter };\n","\nimport worker from \"!!../../node_modules/worker-loader/dist/runtime/inline.js\";\n\nexport default function Worker_fn() {\n  return worker(\"!function(){var r={168:function(r,n,t){var e=t(874),a={};for(var o in e)e.hasOwnProperty(o)&&(a[e[o]]=o);var l=r.exports={rgb:{channels:3,labels:\\\"rgb\\\"},hsl:{channels:3,labels:\\\"hsl\\\"},hsv:{channels:3,labels:\\\"hsv\\\"},hwb:{channels:3,labels:\\\"hwb\\\"},cmyk:{channels:4,labels:\\\"cmyk\\\"},xyz:{channels:3,labels:\\\"xyz\\\"},lab:{channels:3,labels:\\\"lab\\\"},lch:{channels:3,labels:\\\"lch\\\"},hex:{channels:1,labels:[\\\"hex\\\"]},keyword:{channels:1,labels:[\\\"keyword\\\"]},ansi16:{channels:1,labels:[\\\"ansi16\\\"]},ansi256:{channels:1,labels:[\\\"ansi256\\\"]},hcg:{channels:3,labels:[\\\"h\\\",\\\"c\\\",\\\"g\\\"]},apple:{channels:3,labels:[\\\"r16\\\",\\\"g16\\\",\\\"b16\\\"]},gray:{channels:1,labels:[\\\"gray\\\"]}};for(var i in l)if(l.hasOwnProperty(i)){if(!(\\\"channels\\\"in l[i]))throw new Error(\\\"missing channels property: \\\"+i);if(!(\\\"labels\\\"in l[i]))throw new Error(\\\"missing channel labels property: \\\"+i);if(l[i].labels.length!==l[i].channels)throw new Error(\\\"channel and label counts mismatch: \\\"+i);var s=l[i].channels,h=l[i].labels;delete l[i].channels,delete l[i].labels,Object.defineProperty(l[i],\\\"channels\\\",{value:s}),Object.defineProperty(l[i],\\\"labels\\\",{value:h})}l.rgb.hsl=function(r){var n,t,e=r[0]/255,a=r[1]/255,o=r[2]/255,l=Math.min(e,a,o),i=Math.max(e,a,o),s=i-l;return i===l?n=0:e===i?n=(a-o)/s:a===i?n=2+(o-e)/s:o===i&&(n=4+(e-a)/s),(n=Math.min(60*n,360))<0&&(n+=360),t=(l+i)/2,[n,100*(i===l?0:t<=.5?s/(i+l):s/(2-i-l)),100*t]},l.rgb.hsv=function(r){var n,t,e,a,o,l=r[0]/255,i=r[1]/255,s=r[2]/255,h=Math.max(l,i,s),u=h-Math.min(l,i,s),c=function(r){return(h-r)/6/u+.5};return 0===u?a=o=0:(o=u/h,n=c(l),t=c(i),e=c(s),l===h?a=e-t:i===h?a=1/3+n-e:s===h&&(a=2/3+t-n),a<0?a+=1:a>1&&(a-=1)),[360*a,100*o,100*h]},l.rgb.hwb=function(r){var n=r[0],t=r[1],e=r[2];return[l.rgb.hsl(r)[0],1/255*Math.min(n,Math.min(t,e))*100,100*(e=1-1/255*Math.max(n,Math.max(t,e)))]},l.rgb.cmyk=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255;return[100*((1-t-(n=Math.min(1-t,1-e,1-a)))/(1-n)||0),100*((1-e-n)/(1-n)||0),100*((1-a-n)/(1-n)||0),100*n]},l.rgb.keyword=function(r){var n=a[r];if(n)return n;var t,o,l,i=1/0;for(var s in e)if(e.hasOwnProperty(s)){var h=(o=r,l=e[s],Math.pow(o[0]-l[0],2)+Math.pow(o[1]-l[1],2)+Math.pow(o[2]-l[2],2));h<i&&(i=h,t=s)}return t},l.keyword.rgb=function(r){return e[r]},l.rgb.xyz=function(r){var n=r[0]/255,t=r[1]/255,e=r[2]/255;return[100*(.4124*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.3576*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.1805*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)),100*(.2126*n+.7152*t+.0722*e),100*(.0193*n+.1192*t+.9505*e)]},l.rgb.lab=function(r){var n=l.rgb.xyz(r),t=n[0],e=n[1],a=n[2];return e/=100,a/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]},l.hsl.rgb=function(r){var n,t,e,a,o,l=r[0]/360,i=r[1]/100,s=r[2]/100;if(0===i)return[o=255*s,o,o];n=2*s-(t=s<.5?s*(1+i):s+i-s*i),a=[0,0,0];for(var h=0;h<3;h++)(e=l+1/3*-(h-1))<0&&e++,e>1&&e--,o=6*e<1?n+6*(t-n)*e:2*e<1?t:3*e<2?n+(t-n)*(2/3-e)*6:n,a[h]=255*o;return a},l.hsl.hsv=function(r){var n=r[0],t=r[1]/100,e=r[2]/100,a=t,o=Math.max(e,.01);return t*=(e*=2)<=1?e:2-e,a*=o<=1?o:2-o,[n,100*(0===e?2*a/(o+a):2*t/(e+t)),(e+t)/2*100]},l.hsv.rgb=function(r){var n=r[0]/60,t=r[1]/100,e=r[2]/100,a=Math.floor(n)%6,o=n-Math.floor(n),l=255*e*(1-t),i=255*e*(1-t*o),s=255*e*(1-t*(1-o));switch(e*=255,a){case 0:return[e,s,l];case 1:return[i,e,l];case 2:return[l,e,s];case 3:return[l,i,e];case 4:return[s,l,e];case 5:return[e,l,i]}},l.hsv.hsl=function(r){var n,t,e,a=r[0],o=r[1]/100,l=r[2]/100,i=Math.max(l,.01);return e=(2-o)*l,t=o*i,[a,100*(t=(t/=(n=(2-o)*i)<=1?n:2-n)||0),100*(e/=2)]},l.hwb.rgb=function(r){var n,t,e,a,o,l,i,s=r[0]/360,h=r[1]/100,u=r[2]/100,c=h+u;switch(c>1&&(h/=c,u/=c),e=6*s-(n=Math.floor(6*s)),0!=(1&n)&&(e=1-e),a=h+e*((t=1-u)-h),n){default:case 6:case 0:o=t,l=a,i=h;break;case 1:o=a,l=t,i=h;break;case 2:o=h,l=t,i=a;break;case 3:o=h,l=a,i=t;break;case 4:o=a,l=h,i=t;break;case 5:o=t,l=h,i=a}return[255*o,255*l,255*i]},l.cmyk.rgb=function(r){var n=r[0]/100,t=r[1]/100,e=r[2]/100,a=r[3]/100;return[255*(1-Math.min(1,n*(1-a)+a)),255*(1-Math.min(1,t*(1-a)+a)),255*(1-Math.min(1,e*(1-a)+a))]},l.xyz.rgb=function(r){var n,t,e,a=r[0]/100,o=r[1]/100,l=r[2]/100;return t=-.9689*a+1.8758*o+.0415*l,e=.0557*a+-.204*o+1.057*l,n=(n=3.2406*a+-1.5372*o+-.4986*l)>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,[255*(n=Math.min(Math.max(0,n),1)),255*(t=Math.min(Math.max(0,t),1)),255*(e=Math.min(Math.max(0,e),1))]},l.xyz.lab=function(r){var n=r[0],t=r[1],e=r[2];return t/=100,e/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(t=t>.008856?Math.pow(t,1/3):7.787*t+16/116)-16,500*(n-t),200*(t-(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116))]},l.lab.xyz=function(r){var n,t,e,a=r[0];n=r[1]/500+(t=(a+16)/116),e=t-r[2]/200;var o=Math.pow(t,3),l=Math.pow(n,3),i=Math.pow(e,3);return t=o>.008856?o:(t-16/116)/7.787,n=l>.008856?l:(n-16/116)/7.787,e=i>.008856?i:(e-16/116)/7.787,[n*=95.047,t*=100,e*=108.883]},l.lab.lch=function(r){var n,t=r[0],e=r[1],a=r[2];return(n=360*Math.atan2(a,e)/2/Math.PI)<0&&(n+=360),[t,Math.sqrt(e*e+a*a),n]},l.lch.lab=function(r){var n,t=r[0],e=r[1];return n=r[2]/360*2*Math.PI,[t,e*Math.cos(n),e*Math.sin(n)]},l.rgb.ansi16=function(r){var n=r[0],t=r[1],e=r[2],a=1 in arguments?arguments[1]:l.rgb.hsv(r)[2];if(0===(a=Math.round(a/50)))return 30;var o=30+(Math.round(e/255)<<2|Math.round(t/255)<<1|Math.round(n/255));return 2===a&&(o+=60),o},l.hsv.ansi16=function(r){return l.rgb.ansi16(l.hsv.rgb(r),r[2])},l.rgb.ansi256=function(r){var n=r[0],t=r[1],e=r[2];return n===t&&t===e?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(t/255*5)+Math.round(e/255*5)},l.ansi16.rgb=function(r){var n=r%10;if(0===n||7===n)return r>50&&(n+=3.5),[n=n/10.5*255,n,n];var t=.5*(1+~~(r>50));return[(1&n)*t*255,(n>>1&1)*t*255,(n>>2&1)*t*255]},l.ansi256.rgb=function(r){if(r>=232){var n=10*(r-232)+8;return[n,n,n]}var t;return r-=16,[Math.floor(r/36)/5*255,Math.floor((t=r%36)/6)/5*255,t%6/5*255]},l.rgb.hex=function(r){var n=(((255&Math.round(r[0]))<<16)+((255&Math.round(r[1]))<<8)+(255&Math.round(r[2]))).toString(16).toUpperCase();return\\\"000000\\\".substring(n.length)+n},l.hex.rgb=function(r){var n=r.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var t=n[0];3===n[0].length&&(t=t.split(\\\"\\\").map((function(r){return r+r})).join(\\\"\\\"));var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]},l.rgb.hcg=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255,o=Math.max(Math.max(t,e),a),l=Math.min(Math.min(t,e),a),i=o-l;return n=i<=0?0:o===t?(e-a)/i%6:o===e?2+(a-t)/i:4+(t-e)/i+4,n/=6,[360*(n%=1),100*i,100*(i<1?l/(1-i):0)]},l.hsl.hcg=function(r){var n,t=r[1]/100,e=r[2]/100,a=0;return(n=e<.5?2*t*e:2*t*(1-e))<1&&(a=(e-.5*n)/(1-n)),[r[0],100*n,100*a]},l.hsv.hcg=function(r){var n=r[1]/100,t=r[2]/100,e=n*t,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},l.hcg.rgb=function(r){var n=r[0]/360,t=r[1]/100,e=r[2]/100;if(0===t)return[255*e,255*e,255*e];var a,o=[0,0,0],l=n%1*6,i=l%1,s=1-i;switch(Math.floor(l)){case 0:o[0]=1,o[1]=i,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=i;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=i,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return a=(1-t)*e,[255*(t*o[0]+a),255*(t*o[1]+a),255*(t*o[2]+a)]},l.hcg.hsv=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n),e=0;return t>0&&(e=n/t),[r[0],100*e,100*t]},l.hcg.hsl=function(r){var n=r[1]/100,t=r[2]/100*(1-n)+.5*n,e=0;return t>0&&t<.5?e=n/(2*t):t>=.5&&t<1&&(e=n/(2*(1-t))),[r[0],100*e,100*t]},l.hcg.hwb=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n);return[r[0],100*(t-n),100*(1-t)]},l.hwb.hcg=function(r){var n=r[1]/100,t=1-r[2]/100,e=t-n,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},l.apple.rgb=function(r){return[r[0]/65535*255,r[1]/65535*255,r[2]/65535*255]},l.rgb.apple=function(r){return[r[0]/255*65535,r[1]/255*65535,r[2]/255*65535]},l.gray.rgb=function(r){return[r[0]/100*255,r[0]/100*255,r[0]/100*255]},l.gray.hsl=l.gray.hsv=function(r){return[0,0,r[0]]},l.gray.hwb=function(r){return[0,100,r[0]]},l.gray.cmyk=function(r){return[0,0,0,r[0]]},l.gray.lab=function(r){return[r[0],0,0]},l.gray.hex=function(r){var n=255&Math.round(r[0]/100*255),t=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return\\\"000000\\\".substring(t.length)+t},l.rgb.gray=function(r){return[(r[0]+r[1]+r[2])/3/255*100]}},85:function(r,n,t){var e=t(168),a=t(111),o={};Object.keys(e).forEach((function(r){o[r]={},Object.defineProperty(o[r],\\\"channels\\\",{value:e[r].channels}),Object.defineProperty(o[r],\\\"labels\\\",{value:e[r].labels});var n=a(r);Object.keys(n).forEach((function(t){var e=n[t];o[r][t]=function(r){var n=function(n){if(null==n)return n;arguments.length>1&&(n=Array.prototype.slice.call(arguments));var t=r(n);if(\\\"object\\\"==typeof t)for(var e=t.length,a=0;a<e;a++)t[a]=Math.round(t[a]);return t};return\\\"conversion\\\"in r&&(n.conversion=r.conversion),n}(e),o[r][t].raw=function(r){var n=function(n){return null==n?n:(arguments.length>1&&(n=Array.prototype.slice.call(arguments)),r(n))};return\\\"conversion\\\"in r&&(n.conversion=r.conversion),n}(e)}))})),r.exports=o},111:function(r,n,t){var e=t(168);function a(r,n){return function(t){return n(r(t))}}function o(r,n){for(var t=[n[r].parent,r],o=e[n[r].parent][r],l=n[r].parent;n[l].parent;)t.unshift(n[l].parent),o=a(e[n[l].parent][l],o),l=n[l].parent;return o.conversion=t,o}r.exports=function(r){for(var n=function(r){var n=function(){for(var r={},n=Object.keys(e),t=n.length,a=0;a<t;a++)r[n[a]]={distance:-1,parent:null};return r}(),t=[r];for(n[r].distance=0;t.length;)for(var a=t.pop(),o=Object.keys(e[a]),l=o.length,i=0;i<l;i++){var s=o[i],h=n[s];-1===h.distance&&(h.distance=n[a].distance+1,h.parent=a,t.unshift(s))}return n}(r),t={},a=Object.keys(n),l=a.length,i=0;i<l;i++){var s=a[i];null!==n[s].parent&&(t[s]=o(s,n))}return t}},874:function(r){\\\"use strict\\\";r.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},818:function(r,n,t){var e=t(874),a=t(851),o=Object.hasOwnProperty,l=Object.create(null);for(var i in e)o.call(e,i)&&(l[e[i]]=i);var s=r.exports={to:{},get:{}};function h(r,n,t){return Math.min(Math.max(n,r),t)}function u(r){var n=Math.round(r).toString(16).toUpperCase();return n.length<2?\\\"0\\\"+n:n}s.get=function(r){var n,t;switch(r.substring(0,3).toLowerCase()){case\\\"hsl\\\":n=s.get.hsl(r),t=\\\"hsl\\\";break;case\\\"hwb\\\":n=s.get.hwb(r),t=\\\"hwb\\\";break;default:n=s.get.rgb(r),t=\\\"rgb\\\"}return n?{model:t,value:n}:null},s.get.rgb=function(r){if(!r)return null;var n,t,a,l=[0,0,0,1];if(n=r.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(a=n[2],n=n[1],t=0;t<3;t++){var i=2*t;l[t]=parseInt(n.slice(i,i+2),16)}a&&(l[3]=parseInt(a,16)/255)}else if(n=r.match(/^#([a-f0-9]{3,4})$/i)){for(a=(n=n[1])[3],t=0;t<3;t++)l[t]=parseInt(n[t]+n[t],16);a&&(l[3]=parseInt(a+a,16)/255)}else if(n=r.match(/^rgba?\\\\(\\\\s*([+-]?\\\\d+)(?=[\\\\s,])\\\\s*(?:,\\\\s*)?([+-]?\\\\d+)(?=[\\\\s,])\\\\s*(?:,\\\\s*)?([+-]?\\\\d+)\\\\s*(?:[,|\\\\/]\\\\s*([+-]?[\\\\d\\\\.]+)(%?)\\\\s*)?\\\\)$/)){for(t=0;t<3;t++)l[t]=parseInt(n[t+1],0);n[4]&&(n[5]?l[3]=.01*parseFloat(n[4]):l[3]=parseFloat(n[4]))}else{if(!(n=r.match(/^rgba?\\\\(\\\\s*([+-]?[\\\\d\\\\.]+)\\\\%\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)\\\\%\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)\\\\%\\\\s*(?:[,|\\\\/]\\\\s*([+-]?[\\\\d\\\\.]+)(%?)\\\\s*)?\\\\)$/)))return(n=r.match(/^(\\\\w+)$/))?\\\"transparent\\\"===n[1]?[0,0,0,0]:o.call(e,n[1])?((l=e[n[1]])[3]=1,l):null:null;for(t=0;t<3;t++)l[t]=Math.round(2.55*parseFloat(n[t+1]));n[4]&&(n[5]?l[3]=.01*parseFloat(n[4]):l[3]=parseFloat(n[4]))}for(t=0;t<3;t++)l[t]=h(l[t],0,255);return l[3]=h(l[3],0,1),l},s.get.hsl=function(r){if(!r)return null;var n=r.match(/^hsla?\\\\(\\\\s*([+-]?(?:\\\\d{0,3}\\\\.)?\\\\d+)(?:deg)?\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*,?\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*(?:[,|\\\\/]\\\\s*([+-]?(?=\\\\.\\\\d|\\\\d)(?:0|[1-9]\\\\d*)?(?:\\\\.\\\\d*)?(?:[eE][+-]?\\\\d+)?)\\\\s*)?\\\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,h(parseFloat(n[2]),0,100),h(parseFloat(n[3]),0,100),h(isNaN(t)?1:t,0,1)]}return null},s.get.hwb=function(r){if(!r)return null;var n=r.match(/^hwb\\\\(\\\\s*([+-]?\\\\d{0,3}(?:\\\\.\\\\d+)?)(?:deg)?\\\\s*,\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*,\\\\s*([+-]?[\\\\d\\\\.]+)%\\\\s*(?:,\\\\s*([+-]?(?=\\\\.\\\\d|\\\\d)(?:0|[1-9]\\\\d*)?(?:\\\\.\\\\d*)?(?:[eE][+-]?\\\\d+)?)\\\\s*)?\\\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,h(parseFloat(n[2]),0,100),h(parseFloat(n[3]),0,100),h(isNaN(t)?1:t,0,1)]}return null},s.to.hex=function(){var r=a(arguments);return\\\"#\\\"+u(r[0])+u(r[1])+u(r[2])+(r[3]<1?u(Math.round(255*r[3])):\\\"\\\")},s.to.rgb=function(){var r=a(arguments);return r.length<4||1===r[3]?\\\"rgb(\\\"+Math.round(r[0])+\\\", \\\"+Math.round(r[1])+\\\", \\\"+Math.round(r[2])+\\\")\\\":\\\"rgba(\\\"+Math.round(r[0])+\\\", \\\"+Math.round(r[1])+\\\", \\\"+Math.round(r[2])+\\\", \\\"+r[3]+\\\")\\\"},s.to.rgb.percent=function(){var r=a(arguments),n=Math.round(r[0]/255*100),t=Math.round(r[1]/255*100),e=Math.round(r[2]/255*100);return r.length<4||1===r[3]?\\\"rgb(\\\"+n+\\\"%, \\\"+t+\\\"%, \\\"+e+\\\"%)\\\":\\\"rgba(\\\"+n+\\\"%, \\\"+t+\\\"%, \\\"+e+\\\"%, \\\"+r[3]+\\\")\\\"},s.to.hsl=function(){var r=a(arguments);return r.length<4||1===r[3]?\\\"hsl(\\\"+r[0]+\\\", \\\"+r[1]+\\\"%, \\\"+r[2]+\\\"%)\\\":\\\"hsla(\\\"+r[0]+\\\", \\\"+r[1]+\\\"%, \\\"+r[2]+\\\"%, \\\"+r[3]+\\\")\\\"},s.to.hwb=function(){var r=a(arguments),n=\\\"\\\";return r.length>=4&&1!==r[3]&&(n=\\\", \\\"+r[3]),\\\"hwb(\\\"+r[0]+\\\", \\\"+r[1]+\\\"%, \\\"+r[2]+\\\"%\\\"+n+\\\")\\\"},s.to.keyword=function(r){return l[r.slice(0,3)]}},767:function(r,n,t){\\\"use strict\\\";var e=t(818),a=t(85),o=[].slice,l=[\\\"keyword\\\",\\\"gray\\\",\\\"hex\\\"],i={};Object.keys(a).forEach((function(r){i[o.call(a[r].labels).sort().join(\\\"\\\")]=r}));var s={};function h(r,n){if(!(this instanceof h))return new h(r,n);if(n&&n in l&&(n=null),n&&!(n in a))throw new Error(\\\"Unknown model: \\\"+n);var t,u;if(null==r)this.model=\\\"rgb\\\",this.color=[0,0,0],this.valpha=1;else if(r instanceof h)this.model=r.model,this.color=r.color.slice(),this.valpha=r.valpha;else if(\\\"string\\\"==typeof r){var c=e.get(r);if(null===c)throw new Error(\\\"Unable to parse color from string: \\\"+r);this.model=c.model,u=a[this.model].channels,this.color=c.value.slice(0,u),this.valpha=\\\"number\\\"==typeof c.value[u]?c.value[u]:1}else if(r.length){this.model=n||\\\"rgb\\\",u=a[this.model].channels;var f=o.call(r,0,u);this.color=g(f,u),this.valpha=\\\"number\\\"==typeof r[u]?r[u]:1}else if(\\\"number\\\"==typeof r)r&=16777215,this.model=\\\"rgb\\\",this.color=[r>>16&255,r>>8&255,255&r],this.valpha=1;else{this.valpha=1;var b=Object.keys(r);\\\"alpha\\\"in r&&(b.splice(b.indexOf(\\\"alpha\\\"),1),this.valpha=\\\"number\\\"==typeof r.alpha?r.alpha:0);var p=b.sort().join(\\\"\\\");if(!(p in i))throw new Error(\\\"Unable to parse color from object: \\\"+JSON.stringify(r));this.model=i[p];var v=a[this.model].labels,d=[];for(t=0;t<v.length;t++)d.push(r[v[t]]);this.color=g(d)}if(s[this.model])for(u=a[this.model].channels,t=0;t<u;t++){var m=s[this.model][t];m&&(this.color[t]=m(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function u(r,n,t){return(r=Array.isArray(r)?r:[r]).forEach((function(r){(s[r]||(s[r]=[]))[n]=t})),r=r[0],function(e){var a;return arguments.length?(t&&(e=t(e)),(a=this[r]()).color[n]=e,a):(a=this[r]().color[n],t&&(a=t(a)),a)}}function c(r){return function(n){return Math.max(0,Math.min(r,n))}}function f(r){return Array.isArray(r)?r:[r]}function g(r,n){for(var t=0;t<n;t++)\\\"number\\\"!=typeof r[t]&&(r[t]=0);return r}h.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(r){var n=this.model in e.to?this:this.rgb(),t=1===(n=n.round(\\\"number\\\"==typeof r?r:1)).valpha?n.color:n.color.concat(this.valpha);return e.to[n.model](t)},percentString:function(r){var n=this.rgb().round(\\\"number\\\"==typeof r?r:1),t=1===n.valpha?n.color:n.color.concat(this.valpha);return e.to.rgb.percent(t)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var r={},n=a[this.model].channels,t=a[this.model].labels,e=0;e<n;e++)r[t[e]]=this.color[e];return 1!==this.valpha&&(r.alpha=this.valpha),r},unitArray:function(){var r=this.rgb().color;return r[0]/=255,r[1]/=255,r[2]/=255,1!==this.valpha&&r.push(this.valpha),r},unitObject:function(){var r=this.rgb().object();return r.r/=255,r.g/=255,r.b/=255,1!==this.valpha&&(r.alpha=this.valpha),r},round:function(r){return r=Math.max(r||0,0),new h(this.color.map(function(r){return function(n){return function(r,n){return Number(r.toFixed(n))}(n,r)}}(r)).concat(this.valpha),this.model)},alpha:function(r){return arguments.length?new h(this.color.concat(Math.max(0,Math.min(1,r))),this.model):this.valpha},red:u(\\\"rgb\\\",0,c(255)),green:u(\\\"rgb\\\",1,c(255)),blue:u(\\\"rgb\\\",2,c(255)),hue:u([\\\"hsl\\\",\\\"hsv\\\",\\\"hsl\\\",\\\"hwb\\\",\\\"hcg\\\"],0,(function(r){return(r%360+360)%360})),saturationl:u(\\\"hsl\\\",1,c(100)),lightness:u(\\\"hsl\\\",2,c(100)),saturationv:u(\\\"hsv\\\",1,c(100)),value:u(\\\"hsv\\\",2,c(100)),chroma:u(\\\"hcg\\\",1,c(100)),gray:u(\\\"hcg\\\",2,c(100)),white:u(\\\"hwb\\\",1,c(100)),wblack:u(\\\"hwb\\\",2,c(100)),cyan:u(\\\"cmyk\\\",0,c(100)),magenta:u(\\\"cmyk\\\",1,c(100)),yellow:u(\\\"cmyk\\\",2,c(100)),black:u(\\\"cmyk\\\",3,c(100)),x:u(\\\"xyz\\\",0,c(100)),y:u(\\\"xyz\\\",1,c(100)),z:u(\\\"xyz\\\",2,c(100)),l:u(\\\"lab\\\",0,c(100)),a:u(\\\"lab\\\",1),b:u(\\\"lab\\\",2),keyword:function(r){return arguments.length?new h(r):a[this.model].keyword(this.color)},hex:function(r){return arguments.length?new h(r):e.to.hex(this.rgb().round().color)},rgbNumber:function(){var r=this.rgb().color;return(255&r[0])<<16|(255&r[1])<<8|255&r[2]},luminosity:function(){for(var r=this.rgb().color,n=[],t=0;t<r.length;t++){var e=r[t]/255;n[t]=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(r){var n=this.luminosity(),t=r.luminosity();return n>t?(n+.05)/(t+.05):(t+.05)/(n+.05)},level:function(r){var n=this.contrast(r);return n>=7.1?\\\"AAA\\\":n>=4.5?\\\"AA\\\":\\\"\\\"},isDark:function(){var r=this.rgb().color;return(299*r[0]+587*r[1]+114*r[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var r=this.rgb(),n=0;n<3;n++)r.color[n]=255-r.color[n];return r},lighten:function(r){var n=this.hsl();return n.color[2]+=n.color[2]*r,n},darken:function(r){var n=this.hsl();return n.color[2]-=n.color[2]*r,n},saturate:function(r){var n=this.hsl();return n.color[1]+=n.color[1]*r,n},desaturate:function(r){var n=this.hsl();return n.color[1]-=n.color[1]*r,n},whiten:function(r){var n=this.hwb();return n.color[1]+=n.color[1]*r,n},blacken:function(r){var n=this.hwb();return n.color[2]+=n.color[2]*r,n},grayscale:function(){var r=this.rgb().color,n=.3*r[0]+.59*r[1]+.11*r[2];return h.rgb(n,n,n)},fade:function(r){return this.alpha(this.valpha-this.valpha*r)},opaquer:function(r){return this.alpha(this.valpha+this.valpha*r)},rotate:function(r){var n=this.hsl(),t=n.color[0];return t=(t=(t+r)%360)<0?360+t:t,n.color[0]=t,n},mix:function(r,n){if(!r||!r.rgb)throw new Error('Argument to \\\"mix\\\" was not a Color instance, but rather an instance of '+typeof r);var t=r.rgb(),e=this.rgb(),a=void 0===n?.5:n,o=2*a-1,l=t.alpha()-e.alpha(),i=((o*l==-1?o:(o+l)/(1+o*l))+1)/2,s=1-i;return h.rgb(i*t.red()+s*e.red(),i*t.green()+s*e.green(),i*t.blue()+s*e.blue(),t.alpha()*a+e.alpha()*(1-a))}},Object.keys(a).forEach((function(r){if(-1===l.indexOf(r)){var n=a[r].channels;h.prototype[r]=function(){if(this.model===r)return new h(this);if(arguments.length)return new h(arguments,r);var t=\\\"number\\\"==typeof arguments[n]?n:this.valpha;return new h(f(a[this.model][r].raw(this.color)).concat(t),r)},h[r]=function(t){return\\\"number\\\"==typeof t&&(t=g(o.call(arguments),n)),new h(t,r)}}})),r.exports=h},851:function(r,n,t){\\\"use strict\\\";var e=t(594),a=Array.prototype.concat,o=Array.prototype.slice,l=r.exports=function(r){for(var n=[],t=0,l=r.length;t<l;t++){var i=r[t];e(i)?n=a.call(n,o.call(i)):n.push(i)}return n};l.wrap=function(r){return function(){return r(l(arguments))}}},594:function(r){r.exports=function(r){return!(!r||\\\"string\\\"==typeof r)&&(r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&\\\"String\\\"!==r.constructor.name))}}},n={};function t(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,t),o.exports}t.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(n,{a:n}),n},t.d=function(r,n){for(var e in n)t.o(n,e)&&!t.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:n[e]})},t.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},function(){\\\"use strict\\\";var r=t(767),n=t.n(r);self.onmessage=r=>{const t=function(r,t){const e=\\\"action\\\"===r?n()(\\\"#ff3464\\\"):n()(\\\"#2F80ED\\\"),a=n()(t).hsl(),o=e.hsl(),l=a.hue()-o.hue(),i=a.saturationl()/o.saturationl(),s=a.lightness()/o.lightness();return r=>{const t=(()=>{const r=(r,n)=>Math.abs(r-n)<5;return(n,t,e)=>r(n,t)&&r(t,e)&&r(n,e)})(),e={};for(let a=0,o=r.length;a<o;a+=4){const o=r[a],h=r[a+1],u=r[a+2];if(!t(o,h,u)){const t=o+1e3*h+1e6*u;if(!e[t]){let r=n()({r:o,g:h,b:u}).hsl();r=r.rotate(l),r.color[1]*=i,r.color[2]*=s;const[a,c,f]=r.rgb().array();e[t]=[a,c,f]}const[c,f,g]=e[t];r[a]=c,r[a+1]=f,r[a+2]=g}}return r}}(r.data.type,r.data.color)(new Uint8ClampedArray(r.data.payload));self.postMessage({id:r.data.id,result:t})}}()}();\\n\", \"Worker\", undefined, undefined);\n}\n","/* global AFRAME THREE */\n\n// See doc/spritesheet-generation.md for information about this spritesheet\nimport spritesheetAction from \"../assets/images/spritesheets/sprite-system-action-spritesheet.json\";\nimport spritesheetNotice from \"../assets/images/spritesheets/sprite-system-notice-spritesheet.json\";\nimport { createImageTexture } from \"../utils/media-utils\";\nimport spritesheetActionPng from \"../assets/images/spritesheets/sprite-system-action-spritesheet.png\";\nimport spritesheetNoticePng from \"../assets/images/spritesheets/sprite-system-notice-spritesheet.png\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport vertexShader from \"./sprites/sprite.vert\";\nimport fragmentShader from \"./sprites/sprite.frag\";\nimport { getThemeColorShifter } from \"../utils/theme-sprites\";\nimport { disposeTexture } from \"../utils/material-utils\";\nimport { Layers } from \"../components/layers\";\n\nconst MAX_SPRITES = 1024;\nconst SHEET_TYPES = [\"action\", \"notice\"];\nconst PNGS = {\n  action: spritesheetActionPng,\n  notice: spritesheetNoticePng\n};\nconst ZEROS = new Array(16 * 4).fill(0);\n\nconst getSheetType = sprite => (spritesheetAction.frames[sprite.data.name] ? \"action\" : \"notice\");\n\nconst isVisible = o => {\n  if (!o.visible) return false;\n  if (!o.parent) return true;\n  return isVisible(o.parent);\n};\n\nAFRAME.registerComponent(\"sprite\", {\n  schema: { name: { type: \"string\" } },\n  tick() {\n    // TODO when we run out of sprites we currently just stop rendering them. We need to do something better.\n    if (!(this.didRegisterWithSystem || this.didFailToRegister) && this.el.sceneEl.systems[\"hubs-systems\"]) {\n      const registered = this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.add(this);\n      this.didRegisterWithSystem = registered > 0;\n      this.didFailToRegister = registered < 0;\n    }\n  },\n\n  update() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.updateUVs(this);\n    }\n  },\n\n  remove() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.remove(this);\n    }\n  }\n});\n\nconst normalizedFrame = (function() {\n  const memo = new Map();\n  return function normalizedFrame(name, spritesheet) {\n    let ret = memo.get(name);\n    if (ret) {\n      return ret;\n    } else {\n      if (!spritesheet.frames[name]) {\n        ret = { x: 0, y: 0, w: 0, h: 0 };\n        memo.set(name, ret);\n        return ret;\n      }\n      const size = spritesheet.meta.size;\n      const frame = spritesheet.frames[name].frame;\n      ret = {\n        x: frame.x / size.w,\n        y: frame.y / size.h,\n        w: frame.w / size.w,\n        h: frame.h / size.h\n      };\n      memo.set(name, ret);\n      return ret;\n    }\n  };\n})();\n\nconst raycastOnSprite = (function() {\n  const vA = new THREE.Vector3();\n  const vB = new THREE.Vector3();\n  const vC = new THREE.Vector3();\n  const vD = new THREE.Vector3();\n  const point = new THREE.Vector3();\n  const intersectionInfo = { distance: 0, point, object: null };\n\n  return function raycast(raycaster, intersects) {\n    this.updateMatrices();\n    vA.set(-0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vB.set(0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vC.set(-0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n    let intersect = raycaster.ray.intersectTriangle(vA, vC, vB, false, point);\n    if (intersect === null) {\n      vD.set(0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n      intersect = raycaster.ray.intersectTriangle(vB, vC, vD, false, point);\n      if (intersect === null) {\n        return;\n      }\n    }\n\n    const distance = raycaster.ray.origin.distanceTo(point);\n    if (distance < raycaster.near || distance > raycaster.far) return;\n\n    intersectionInfo.distance = distance;\n    intersectionInfo.point = point;\n    intersectionInfo.object = this;\n    intersects.push(intersectionInfo);\n  };\n})();\n\nconst getHoverableVisuals = el => {\n  if (!el || !el.components) return null;\n  if (el.components[\"hoverable-visuals\"]) {\n    return el.components[\"hoverable-visuals\"];\n  }\n  return getHoverableVisuals(el.parentEl);\n};\n\nconst enableSweepingEffect = comp => {\n  const hoverableVisuals = getHoverableVisuals(comp.el);\n  if (!hoverableVisuals) {\n    return false;\n  }\n\n  const isPinned = hoverableVisuals.el.components.pinnable && hoverableVisuals.el.components.pinnable.data.pinned;\n  const isSpawner = !!hoverableVisuals.el.components[\"super-spawner\"];\n  const isFrozen = hoverableVisuals.el.sceneEl.is(\"frozen\");\n  const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\n  return hoverableVisuals.data.enableSweepingEffect && !hideDueToPinning;\n};\n\nconst createGeometry = maxSprites => {\n  // TODO: Consider to use InstancedBufferGeometry which would be more efficient and performant\n  const geometry = new THREE.BufferGeometry();\n\n  const positions = new Float32Array(maxSprites * 3 * 4);\n  for (let i = 0; i < maxSprites; i++) {\n    positions[i * 3 * 4 + 0] = -0.5;\n    positions[i * 3 * 4 + 1] = 0.5;\n    positions[i * 3 * 4 + 2] = 0.0;\n    positions[i * 3 * 4 + 3] = 0.5;\n    positions[i * 3 * 4 + 4] = 0.5;\n    positions[i * 3 * 4 + 5] = 0.0;\n    positions[i * 3 * 4 + 6] = -0.5;\n    positions[i * 3 * 4 + 7] = -0.5;\n    positions[i * 3 * 4 + 8] = 0.0;\n    positions[i * 3 * 4 + 9] = 0.5;\n    positions[i * 3 * 4 + 10] = -0.5;\n    positions[i * 3 * 4 + 11] = 0.0;\n  }\n  // We need to use \"position\" as the attribute name here. It was previously \"a_vertices\". It seems three.js\n  // might assume that geometries have a \"position\" attribute in some cases,\n  // like in https://github.com/mrdoob/three.js/pull/18044\n  geometry.setAttribute(\"position\", new THREE.BufferAttribute(positions, 3, false));\n\n  geometry.setAttribute(\n    \"a_hubs_EnableSweepingEffect\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4), 1, false)\n  );\n\n  geometry.setAttribute(\n    \"a_hubs_SweepParams\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4 * 2), 2, false)\n  );\n\n  geometry.setAttribute(\"a_uvs\", new THREE.BufferAttribute(new Float32Array(maxSprites * 2 * 4), 2, false));\n  geometry.setAttribute(\"a_mv\", new THREE.BufferAttribute(new Float32Array(maxSprites * 16 * 4), 16, false));\n\n  const indices = new Uint16Array(maxSprites * 3 * 2);\n  for (let i = 0; i < maxSprites; i++) {\n    indices[i * 3 * 2 + 0] = i * 4 + 0;\n    indices[i * 3 * 2 + 1] = i * 4 + 2;\n    indices[i * 3 * 2 + 2] = i * 4 + 1;\n    indices[i * 3 * 2 + 3] = i * 4 + 1;\n    indices[i * 3 * 2 + 4] = i * 4 + 2;\n    indices[i * 3 * 2 + 5] = i * 4 + 3;\n  }\n  geometry.setIndex(new THREE.BufferAttribute(indices, 1));\n\n  geometry.drawRange.count = 0;\n\n  return geometry;\n};\n\nconst createMaterial = spritesheetTexture => {\n  return new THREE.RawShaderMaterial({\n    uniforms: {\n      u_spritesheet: { value: spritesheetTexture },\n      hubs_Time: { value: 0 }\n    },\n    vertexShader,\n    fragmentShader,\n    side: THREE.DoubleSide,\n    transparent: true\n  });\n};\n\nexport class SpriteSystem {\n  raycast(raycaster, intersects) {\n    for (const sheetType of SHEET_TYPES) {\n      const sprites = this.sprites[sheetType];\n      for (const sprite of sprites) {\n        const o = sprite.el.object3D;\n        if (isVisible(o)) {\n          raycastOnSprite.call(o, raycaster, intersects);\n        }\n      }\n    }\n    return intersects;\n  }\n\n  constructor(scene) {\n    this.sprites = { action: [], notice: [] };\n    this.indicesFromSprites = { action: new WeakMap(), notice: new WeakMap() };\n    this.meshes = { action: null, notice: null };\n\n    waitForDOMContentLoaded().then(() => {\n      for (const type in PNGS) {\n        const spritesheetPng = PNGS[type];\n        createImageTexture(spritesheetPng, getThemeColorShifter(type)).then(spritesheetTexture => {\n          const geometry = createGeometry(MAX_SPRITES);\n          const material = createMaterial(spritesheetTexture);\n          const mesh = (this.meshes[type] = new THREE.Mesh(geometry, material));\n          const el = document.createElement(\"a-entity\");\n          el.classList.add(\"ui\");\n          scene.appendChild(el);\n          el.setObject3D(\"mesh\", mesh);\n          mesh.frustumCulled = false;\n          mesh.layers.set(Layers.CAMERA_LAYER_UI);\n          mesh.renderOrder = window.APP.RENDER_ORDER.HUD_ICONS;\n          mesh.raycast = this.raycast.bind(this);\n        });\n      }\n    });\n\n    APP.store.addEventListener(\"themechanged\", () => {\n      for (const type in PNGS) {\n        const spritesheetPng = PNGS[type];\n        // TODO: Fix me if possible\n        // 1. If theme is changed before meshes are initialized, no effect to textures.\n        // 2. If theme is changed before textures loading for the previous theme is completed\n        // and textures loading for the new theme is completed earlier than the previous ones,\n        // the previous ones are set.\n        if (this.meshes[type]) {\n          createImageTexture(spritesheetPng, getThemeColorShifter(type)).then(newTexture => {\n            const oldTexture = this.meshes[type].material.uniforms.u_spritesheet.value;\n            this.meshes[type].material.uniforms.u_spritesheet.value = newTexture;\n            this.meshes[type].material.uniformsNeedUpdate = true;\n            disposeTexture(oldTexture);\n          });\n        }\n      }\n    });\n  }\n\n  tick(t) {\n    for (let i = 0, il = SHEET_TYPES.length; i < il; i++) {\n      const sheetType = SHEET_TYPES[i];\n      const mesh = this.meshes[sheetType];\n\n      if (!mesh) continue;\n\n      mesh.material.uniforms.hubs_Time.value = t;\n      mesh.material.uniformsNeedUpdate = true;\n\n      const geometry = mesh.geometry;\n      const aMv = geometry.getAttribute(\"a_mv\");\n      const aEnableSweepingEffect = geometry.getAttribute(\"a_hubs_EnableSweepingEffect\");\n      const aSweepParams = geometry.getAttribute(\"a_hubs_SweepParams\");\n      const sprites = this.sprites[sheetType];\n\n      let aEnableSweepingEffectNeedsUpdate = false;\n      let aSweepParamsNeedsUpdate = false;\n\n      for (let j = 0, jl = sprites.length; j < jl; j++) {\n        const sprite = sprites[j];\n\n        if (isVisible(sprite.el.object3D)) {\n          const enableSweepingEffectValue = enableSweepingEffect(sprite) ? 1 : 0;\n          aEnableSweepingEffect.array[j * 4 + 0] = enableSweepingEffectValue;\n          aEnableSweepingEffect.array[j * 4 + 1] = enableSweepingEffectValue;\n          aEnableSweepingEffect.array[j * 4 + 2] = enableSweepingEffectValue;\n          aEnableSweepingEffect.array[j * 4 + 3] = enableSweepingEffectValue;\n          aEnableSweepingEffectNeedsUpdate = true;\n\n          if (enableSweepingEffectValue) {\n            const hoverableVisuals = getHoverableVisuals(sprite.el);\n            const s = hoverableVisuals.sweepParams[0];\n            const t = hoverableVisuals.sweepParams[1];\n            aSweepParams.setXY(j * 4 + 0, s, t);\n            aSweepParams.setXY(j * 4 + 1, s, t);\n            aSweepParams.setXY(j * 4 + 2, s, t);\n            aSweepParams.setXY(j * 4 + 3, s, t);\n            aSweepParamsNeedsUpdate = true;\n          }\n\n          // TODO: This tick should be invoked after updating the entire scene graph matrices.\n          // If we do it, we may remove this .updateMatrices() call\n          sprite.el.object3D.updateMatrices();\n          const mat4 = sprite.el.object3D.matrixWorld;\n          aMv.array.set(mat4.elements, j * 4 * 16);\n          aMv.array.set(mat4.elements, (j * 4 + 1) * 16);\n          aMv.array.set(mat4.elements, (j * 4 + 2) * 16);\n          aMv.array.set(mat4.elements, (j * 4 + 3) * 16);\n        } else {\n          aMv.array.set(ZEROS, j * 4 * 16);\n        }\n      }\n\n      aMv.needsUpdate = true;\n      aMv.updateRange.count = sprites.length * 4 * 16;\n\n      if (aEnableSweepingEffectNeedsUpdate) {\n        aEnableSweepingEffect.needsUpdate = true;\n        aEnableSweepingEffect.updateRange.count = sprites.length * 4;\n      }\n\n      if (aSweepParamsNeedsUpdate) {\n        aSweepParams.needsUpdate = true;\n        aSweepParams.updateRange.count = sprites.length * 4 * 2;\n      }\n    }\n  }\n\n  updateUVs(sprite) {\n    const sheetType = getSheetType(sprite);\n    const mesh = this.meshes[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!mesh) return;\n\n    const indicesFromSprites = this.indicesFromSprites[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!indicesFromSprites.has(sprite)) return;\n\n    const index = indicesFromSprites.get(sprite);\n    const flipY = mesh.material.uniforms.u_spritesheet.value.flipY;\n    const frame = normalizedFrame(sprite.data.name, sheetType === \"action\" ? spritesheetAction : spritesheetNotice);\n    const aUvs = mesh.geometry.getAttribute(\"a_uvs\");\n    aUvs.setXY(index * 4 + 0, frame.x, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(index * 4 + 1, frame.x + frame.w, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(index * 4 + 2, frame.x, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.setXY(index * 4 + 3, frame.x + frame.w, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.needsUpdate = true;\n    aUvs.updateRange.count = this.sprites[sheetType].length * 4 * 2;\n  }\n\n  add(sprite) {\n    const sheetType = getSheetType(sprite);\n    const mesh = this.meshes[sheetType];\n\n    if (!mesh) return 0;\n\n    const sprites = this.sprites[sheetType];\n    const indicesFromSprites = this.indicesFromSprites[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (indicesFromSprites.has(sprite)) {\n      console.error(\"This sprite is already added\");\n      return -1;\n    }\n\n    if (sprites.length >= MAX_SPRITES) {\n      console.error(\"Too many sprites\");\n      return -1;\n    }\n\n    const index = sprites.push(sprite) - 1;\n    indicesFromSprites.set(sprite, index);\n    this.updateUVs(sprite);\n\n    const geometry = mesh.geometry;\n    geometry.drawRange.count = sprites.length * 3 * 2;\n\n    return 1;\n  }\n\n  remove(sprite) {\n    const sheetType = getSheetType(sprite);\n    const mesh = this.meshes[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!mesh) return;\n\n    const sprites = this.sprites[sheetType];\n    const indicesFromSprites = this.indicesFromSprites[sheetType];\n\n    // TODO: Is this guard necessary?\n    if (!indicesFromSprites.has(sprite)) {\n      console.error(\"This sprite is not found\");\n      return;\n    }\n\n    const index = indicesFromSprites.get(sprite);\n    indicesFromSprites.delete(sprite);\n\n    const lastSprite = sprites.pop();\n\n    if (sprite !== lastSprite) {\n      // Move the last sprite to the place at the removed sprite index\n      sprites[index] = lastSprite;\n      indicesFromSprites.set(lastSprite, index);\n      this.updateUVs(lastSprite);\n    }\n\n    const geometry = mesh.geometry;\n    geometry.drawRange.count = sprites.length * 3 * 2;\n  }\n}\n","export default \"uniform mat4 modelViewMatrix;\\nuniform mat4 projectionMatrix;\\n\\nattribute mat4 a_mv;\\nattribute vec3 position;\\nattribute vec2 a_uvs;\\nvarying vec2 v_uvs;\\nattribute float a_hubs_EnableSweepingEffect;\\nvarying float v_hubs_EnableSweepingEffect;\\nattribute vec2 a_hubs_SweepParams;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\n\\nvoid main() {\\n  gl_Position = projectionMatrix * modelViewMatrix * a_mv * vec4(position, 1.0);\\n  v_uvs = a_uvs;\\n  v_hubs_EnableSweepingEffect = a_hubs_EnableSweepingEffect;\\n  v_hubs_SweepParams = a_hubs_SweepParams;\\n\\n  vec4 wt = vec4(position, 1.0);\\n  hubs_WorldPosition = (a_mv * wt).xyz;\\n}\\n\";","export default \"precision mediump float;\\n\\nuniform sampler2D u_spritesheet;\\n\\nvarying vec2 v_uvs;\\n\\nvarying float v_hubs_EnableSweepingEffect;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\nuniform bool hubs_HighlightInteractorOne;\\nuniform vec3 hubs_InteractorOnePos;\\nuniform bool hubs_HighlightInteractorTwo;\\nuniform vec3 hubs_InteractorTwoPos;\\nuniform float hubs_Time;\\n\\nvec4 LinearTosRGB( in vec4 value ) {\\n    return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\\n}\\n\\nvec4 linearToOutputTexel( vec4 value ) {\\n  return LinearTosRGB( value );\\n}\\n\\nvoid main() {\\n    vec4 texColor = texture2D(u_spritesheet, v_uvs);\\n\\n    float ratio = 0.0;\\n    if (v_hubs_EnableSweepingEffect > 0.9 ) {\\n        float size = v_hubs_SweepParams.t - v_hubs_SweepParams.s * 1.0;\\n        float line = mod(hubs_Time / 500.0 * size, size * 3.0) + v_hubs_SweepParams.s - size / 3.0;\\n        if (hubs_WorldPosition.y < line) {\\n            ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n        }\\n\\n    }\\n    ratio = min(1.0, ratio);\\n\\n    vec4 highlightColor = vec4(0.184, 0.499, 0.933, 1.0);\\n    gl_FragColor = linearToOutputTexel(vec4((texColor.rgb * (1.0 - ratio)) + (highlightColor.rgb * ratio), texColor.a));\\n}\\n\";","import { setMatrixWorld, affixToWorldUp } from \"../utils/three-utils\";\nimport { isTagged } from \"../components/tags\";\nimport { applyPersistentSync } from \"../utils/permissions-utils\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nconst calculateIconTransform = (function () {\n  const up = new THREE.Vector3();\n  const backward = new THREE.Vector3();\n  const forward = new THREE.Vector3();\n  const camToWaypoint = new THREE.Vector3();\n  const v1 = new THREE.Vector3();\n  const m1 = new THREE.Matrix4();\n  const position = new THREE.Vector3();\n  let scale = 1;\n\n  return function calculateIconTransform(waypoint, viewingCamera, outMat4) {\n    waypoint.updateMatrices();\n    viewingCamera.updateMatrices();\n    affixToWorldUp(m1.copy(waypoint.matrixWorld), m1).extractBasis(v1, up, backward);\n    position\n      .setFromMatrixPosition(waypoint.matrixWorld)\n      .add(v1.addVectors(up.multiplyScalar(1.6), backward.multiplyScalar(0.15)));\n    camToWaypoint.subVectors(position, v1.setFromMatrixPosition(viewingCamera.matrixWorld));\n    const distance = camToWaypoint.length();\n    const minDistance = distance < 0.2 * v1.setFromMatrixColumn(viewingCamera.matrixWorld, 0).length();\n    if (distance < minDistance) {\n      scale = 0.00001;\n      camToWaypoint.set(0, 0, -1);\n    } else {\n      scale = 0.1 + 0.05 * distance;\n    }\n    forward.copy(camToWaypoint).projectOnPlane(up.set(0, 1, 0)).normalize();\n\n    return outMat4\n      .makeBasis(\n        v1.crossVectors(forward, up).multiplyScalar(scale),\n        up.multiplyScalar(scale),\n        forward.multiplyScalar(scale * -1)\n      )\n      .setPosition(position);\n  };\n})();\nfunction isMineOrTakeOwnership(el) {\n  return NAF.utils.isMine(el) || NAF.utils.takeOwnership(el);\n}\nfunction isOccupiableSpawnPoint(waypointData) {\n  return waypointData.canBeOccupied && waypointData.canBeSpawnPoint;\n}\nfunction isUnoccupiableSpawnPoint(waypointData) {\n  return !waypointData.canBeOccupied && waypointData.canBeSpawnPoint;\n}\nfunction loadTemplateAndAddToScene(scene, templateId) {\n  return new Promise(resolve => {\n    const content = document.importNode(document.getElementById(templateId).content.children[0]);\n    scene.appendChild(content, true);\n    setTimeout(() => {\n      // Without this timeout, this resolves too early in Firefox for Android\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n      resolve(content);\n    }, 0);\n  });\n}\nfunction templatesToLoadForWaypointData(data) {\n  const templateIds = [];\n  if (data.canBeClicked && data.canBeOccupied) {\n    templateIds.push(\"occupiable-waypoint-icon\");\n  } else if (data.canBeClicked && !data.canBeOccupied) {\n    templateIds.push(\"teleport-waypoint-icon\");\n  } else if (isUnoccupiableSpawnPoint(data)) {\n    //    templateIds.push(\"teleport-waypoint-icon\");\n  } else if (isOccupiableSpawnPoint(data)) {\n    //    templateIds.push(\"occupiable-waypoint-icon\");\n  } else {\n    //templateIds.push(\"teleport-waypoint-icon\");\n  }\n  return templateIds;\n}\nfunction loadTemplatesForWaypointData(scene, data) {\n  return templatesToLoadForWaypointData(data).map(templateId => loadTemplateAndAddToScene(scene, templateId));\n}\n\nfunction shouldTryToOccupy(waypointComponent) {\n  return (\n    waypointComponent.data.canBeOccupied &&\n    (NAF.utils.isMine(waypointComponent.el) ||\n      !(\n        waypointComponent.data.isOccupied &&\n        NAF.utils.getNetworkOwner(waypointComponent.el) &&\n        NAF.connection.connectedClients[NAF.utils.getNetworkOwner(waypointComponent.el)]\n      ))\n  );\n}\n\nfunction isOccupiedByMe(waypointComponent) {\n  return (\n    waypointComponent.data.canBeOccupied &&\n    waypointComponent.data.isOccupied &&\n    waypointComponent.el.components.networked &&\n    NAF.utils.isMine(waypointComponent.el)\n  );\n}\nfunction unoccupyWaypoint(waypointComponent) {\n  waypointComponent.el.setAttribute(\"waypoint\", { isOccupied: false });\n}\nfunction unoccupyWaypoints(waypointComponents) {\n  waypointComponents.filter(isOccupiedByMe).forEach(unoccupyWaypoint);\n}\nfunction occupyWaypoint(waypointComponent) {\n  waypointComponent.el.setAttribute(\"waypoint\", { isOccupied: true });\n}\n\nfunction uuid(el) {\n  return el.object3D.uuid;\n}\n\nexport class WaypointSystem {\n  constructor(scene, characterController) {\n    this.helperMat4 = new THREE.Matrix4();\n    this.scene = scene;\n    this.loading = [];\n    this.ready = [];\n    this.previousWaypointHash = null;\n    this.initialSpawnHappened = false;\n\n    this.waypointForTemplateEl = {};\n    this.elementsFromTemplatesFor = {};\n    this.eventHandlers = [];\n    this.lostOwnershipOfWaypoint = this.lostOwnershipOfWaypoint.bind(this);\n    waitForDOMContentLoaded().then(() => {\n      loadTemplateAndAddToScene(scene, \"waypoint-preview-avatar-template\").then(el => {\n        this.waypointPreviewAvatar = el;\n        this.waypointPreviewAvatar.object3D.visible = false;\n      });\n    });\n    this.characterController = characterController;\n  }\n\n  releaseAnyOccupiedWaypoints() {\n    unoccupyWaypoints(this.ready);\n    if (this.currentWaypoint) {\n      this.currentWaypoint.el.removeEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\n    }\n  }\n\n  teleportToWaypoint(iconEl, waypointComponent) {\n    return function onInteract() {\n      this.moveToWaypoint(waypointComponent, false);\n    }.bind(this);\n  }\n  tryTeleportToOccupiableWaypoint(iconEl, waypointComponent) {\n    return function onInteract() {\n      const previouslyOccupiedWaypoints = this.ready.filter(isOccupiedByMe);\n      this.tryToOccupy(waypointComponent).then(didOccupy => {\n        if (didOccupy) {\n          waypointComponent.el.object3D.updateMatrices();\n          this.characterController.shouldLandWhenPossible = true;\n          this.characterController.enqueueWaypointTravelTo(\n            waypointComponent.el.object3D.matrixWorld,\n            false,\n            waypointComponent.data\n          );\n          unoccupyWaypoints(previouslyOccupiedWaypoints.filter(wp => wp !== waypointComponent));\n        }\n      });\n    }.bind(this);\n  }\n  setupEventHandlersFor(component) {\n    return function setupEventHandlers(el) {\n      const id = uuid(el);\n      this.eventHandlers[id] = this.eventHandlers[id] || {};\n      if (\n        component.data.canBeClicked &&\n        (el.classList.contains(\"teleport-waypoint-icon\") || el.classList.contains(\"occupiable-waypoint-icon\"))\n      ) {\n        const onHover = () => {\n          component.el.object3D.updateMatrices();\n          if (this.waypointPreviewAvatar && !this.waypointForTemplateEl[id].data.willMaintainInitialOrientation) {\n            this.waypointPreviewAvatar.object3D.visible = true;\n            component.el.object3D.updateMatrices();\n            setMatrixWorld(this.waypointPreviewAvatar.object3D, component.el.object3D.matrixWorld);\n          }\n        };\n        const onUnhover = () => {\n          if (this.waypointPreviewAvatar) {\n            this.waypointPreviewAvatar.object3D.visible = false;\n          }\n        };\n        el.object3D.addEventListener(\"hovered\", onHover);\n        el.object3D.addEventListener(\"unhovered\", onUnhover);\n        this.eventHandlers[id][\"hovered\"] = onHover;\n        this.eventHandlers[id][\"unhovered\"] = onUnhover;\n      }\n      if (isTagged(el, \"singleActionButton\") && component.data.canBeClicked) {\n        let onInteract = () => {\n          console.log(\"interacted with\", el, \"associated with waypoint\", component);\n        };\n        if (el.classList.contains(\"teleport-waypoint-icon\")) {\n          onInteract = this.teleportToWaypoint(el, component);\n        } else if (el.classList.contains(\"occupiable-waypoint-icon\")) {\n          onInteract = this.tryTeleportToOccupiableWaypoint(el, component);\n        }\n        el.object3D.addEventListener(\"interact\", onInteract);\n        this.eventHandlers[id][\"interact\"] = onInteract;\n      }\n    }.bind(this);\n  }\n  registerComponent(component) {\n    this.loading.push(component);\n    const setupEventHandlers = this.setupEventHandlersFor(component);\n    const waypointId = uuid(component.el);\n    this.elementsFromTemplatesFor[waypointId] = this.elementsFromTemplatesFor[waypointId] || [];\n    Promise.all(loadTemplatesForWaypointData(this.scene, component.data)).then(elementsFromTemplates => {\n      const li = this.loading.indexOf(component);\n      if (li === -1) {\n        return null;\n      }\n      this.loading.splice(li, 1);\n      this.ready.push(component);\n      this.elementsFromTemplatesFor[waypointId].push(...elementsFromTemplates);\n      elementsFromTemplates.forEach(el => {\n        this.waypointForTemplateEl[uuid(el)] = component;\n      });\n      elementsFromTemplates.forEach(setupEventHandlers);\n    });\n  }\n  unregisterComponent(component) {\n    const li = this.loading.indexOf(component);\n    if (li !== -1) {\n      this.loading.splice(li, 1);\n    }\n    const ri = this.ready.indexOf(component);\n    if (ri !== -1) {\n      this.ready.splice(ri, 1);\n      const waypointId = uuid(component.el);\n      const elementsFromTemplates = this.elementsFromTemplatesFor[waypointId];\n      for (let i = 0; i < elementsFromTemplates.length; i++) {\n        const el = elementsFromTemplates[i];\n        const id = uuid(el);\n        if (this.eventHandlers[id]) {\n          const removeEventListener = eventName => {\n            if (this.eventHandlers[id][eventName]) {\n              el.object3D.removeEventListener(eventName, this.eventHandlers[id][eventName]);\n              delete this.eventHandlers[id][eventName];\n            }\n          };\n          [\"interact\", \"hovered\", \"unhovered\"].map(removeEventListener);\n        }\n        el.parentNode.removeChild(el);\n      }\n      this.elementsFromTemplatesFor[waypointId].length = 0;\n    }\n  }\n  getUnoccupiableSpawnPoint() {\n    const candidates = this.ready.filter(component => isUnoccupiableSpawnPoint(component.data));\n    return candidates.length && candidates.splice(Math.floor(Math.random() * candidates.length), 1)[0];\n  }\n  lostOwnershipOfWaypoint(e) {\n    if (this.currentWaypoint && this.currentWaypoint.el === e.detail.el) {\n      this.mightNeedRespawn = true;\n      this.ownershipLostTime = performance.now();\n    }\n  }\n  tryToOccupy(waypointComponent) {\n    return new Promise(resolve => {\n      if (shouldTryToOccupy(waypointComponent) && isMineOrTakeOwnership(waypointComponent.el)) {\n        occupyWaypoint(waypointComponent);\n        if (this.currentWaypoint) {\n          this.currentWaypoint.el.removeEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\n        }\n        this.currentWaypoint = waypointComponent;\n        waypointComponent.el.addEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\n        resolve(true);\n      } else {\n        resolve(false);\n      }\n    });\n  }\n  tryToOccupyAnyOf(waypoints) {\n    if (!waypoints.length) return Promise.resolve(null);\n    const candidate = waypoints.splice(Math.floor(Math.random() * waypoints.length), 1)[0];\n    return this.tryToOccupy(candidate).then(didOccupy => {\n      if (didOccupy) {\n        return Promise.resolve(candidate);\n      } else {\n        return this.tryToOccupyAnyOf(waypoints);\n      }\n    });\n  }\n  moveToSpawnPoint() {\n    if (this.currentMoveToSpawn) {\n      return this.currentMoveToSpawn;\n    }\n    if (!this.nextMoveToSpawn) {\n      this.waitOneTick = true;\n      this.nextMoveToSpawn = new Promise(resolve => {\n        this.nextMoveToSpawnResolve = resolve;\n      });\n    }\n    // Reset system state to allow for waypoint selection based on URL fragments\n    this.previousWaypointHash = null;\n    this.initialSpawnHappened = false;\n    return this.nextMoveToSpawn;\n  }\n  moveToWaypoint(waypointComponent, instant) {\n    this.releaseAnyOccupiedWaypoints();\n    waypointComponent.el.object3D.updateMatrices();\n    this.characterController.shouldLandWhenPossible = true;\n    this.characterController.enqueueWaypointTravelTo(\n      waypointComponent.el.object3D.matrixWorld,\n      !window.APP.store.state.preferences.animateWaypointTransitions || instant,\n      waypointComponent.data\n    );\n  }\n  moveToUnoccupiableSpawnPoint() {\n    const waypointComponent = this.getUnoccupiableSpawnPoint();\n    if (waypointComponent) {\n      this.moveToWaypoint(waypointComponent, true);\n    }\n    return waypointComponent;\n  }\n  tick() {\n    if (this.waitOneTick) {\n      this.waitOneTick = false;\n      return;\n    }\n\n    const hashUpdated = window.location.hash !== \"\" && this.previousWaypointHash !== window.location.hash;\n\n    if (hashUpdated && this.initialSpawnHappened) {\n      const waypointName = window.location.hash.replace(\"#\", \"\");\n      const waypoint = this.ready.find(c => c.el.object3D.name === waypointName);\n      if (waypoint) {\n        this.moveToWaypoint(waypoint, this.previousWaypointHash === null);\n        window.history.replaceState(null, null, window.location.href.split(\"#\")[0]); // Reset so you can re-activate the same waypoint\n      }\n      this.previousWaypointHash = window.location.hash;\n    }\n\n    if (!this.currentMoveToSpawn && this.nextMoveToSpawn) {\n      this.mightNeedRespawn = false;\n      this.currentMoveToSpawn = this.nextMoveToSpawn;\n      this.currentMoveToSpawnResolve = this.nextMoveToSpawnResolve;\n      this.nextMoveToSpawn = null;\n      this.nextMoveToSpawnResolve = null;\n\n      let resolvedWaypointOrNull;\n\n      const previouslyOccupiedWaypoints = this.ready.filter(isOccupiedByMe);\n      this.tryToOccupyAnyOf(this.ready.filter(component => isOccupiableSpawnPoint(component.data))).then(\n        waypointComponentOrNull => {\n          if (waypointComponentOrNull) {\n            const waypointComponent = waypointComponentOrNull;\n            unoccupyWaypoints(previouslyOccupiedWaypoints.filter(wp => wp !== waypointComponent));\n            waypointComponent.el.object3D.updateMatrices();\n            this.characterController.shouldLandWhenPossible = true;\n            this.characterController.enqueueWaypointTravelTo(\n              waypointComponent.el.object3D.matrixWorld,\n              true,\n              waypointComponent.data\n            );\n            resolvedWaypointOrNull = waypointComponent;\n          } else if (waypointComponentOrNull === null) {\n            resolvedWaypointOrNull = this.moveToUnoccupiableSpawnPoint();\n          }\n          this.initialSpawnHappened = true;\n          this.currentMoveToSpawnResolve(resolvedWaypointOrNull);\n          this.currentMoveToSpawn = null;\n          this.currentMoveToSpawnResolve = null;\n        }\n      );\n    } else if (this.mightNeedRespawn && performance.now() - this.ownershipLostTime < 8000) {\n      this.mightNeedRespawn = false;\n      this.moveToSpawnPoint();\n    }\n    const tickTemplateEl = (elementFromTemplate, waypointComponent) => {\n      if (\n        elementFromTemplate.classList.contains(\"teleport-waypoint-icon\") ||\n        elementFromTemplate.classList.contains(\"occupiable-waypoint-icon\")\n      ) {\n        elementFromTemplate.object3D.visible = this.scene.is(\"frozen\");\n        if (elementFromTemplate.object3D.visible) {\n          this.viewingCamera = this.viewingCamera || document.getElementById(\"viewing-camera\").object3DMap.camera;\n          setMatrixWorld(\n            elementFromTemplate.object3D,\n            calculateIconTransform(waypointComponent.el.object3D, this.viewingCamera, this.helperMat4)\n          );\n        }\n      }\n    };\n    function tickWaypoint(waypointComponent) {\n      const elementsFromTemplates = this.elementsFromTemplatesFor[uuid(waypointComponent.el)];\n      elementsFromTemplates.forEach(el => tickTemplateEl(el, waypointComponent));\n    }\n    this.ready.forEach(tickWaypoint.bind(this));\n  }\n}\n\nAFRAME.registerComponent(\"waypoint\", {\n  schema: {\n    canBeSpawnPoint: { default: false },\n    canBeOccupied: { default: false },\n    canBeClicked: { default: false },\n    willDisableMotion: { default: false },\n    willDisableTeleporting: { default: false },\n    snapToNavMesh: { default: false },\n    willMaintainInitialOrientation: { default: false },\n    willMaintainWorldUp: { default: true },\n    isOccupied: { default: false }\n  },\n  init() {\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].waypointSystem;\n    this.didRegisterWithSystem = false;\n  },\n  play() {\n    if (!this.didRegisterWithSystem) {\n      if (this.el.components.networked) {\n        applyPersistentSync(this.el.components.networked.data.networkId);\n      }\n      this.system.registerComponent(this, this.el.sceneEl);\n      this.didRegisterWithSystem = true;\n    }\n  },\n  remove() {\n    if (!this.didRegisterWithSystem) {\n      console.warn(\"Waypoint removed without ever having registered with the system.\");\n    } else {\n      this.system.unregisterComponent(this);\n    }\n  }\n});\n","const mat4Pool = [];\nexport function getPooledMatrix4() {\n  return mat4Pool.shift() || new THREE.Matrix4();\n}\nexport function freePooledMatrix4(mat4) {\n  mat4Pool.push(mat4);\n}\n","export const getCurrentPlayerHeight = (function() {\n  let avatarPOV;\n  let avatarRig;\n  return function getCurrentPlayerHeight(world) {\n    avatarPOV = avatarPOV || document.getElementById(\"avatar-pov-node\");\n    avatarRig = avatarRig || document.getElementById(\"avatar-rig\");\n    avatarRig.object3D.updateMatrices();\n    avatarPOV.object3D.updateMatrices();\n    if (world) {\n      return avatarPOV.object3D.matrixWorld.elements[13] - avatarRig.object3D.matrixWorld.elements[13];\n    }\n    return avatarPOV.object3D.matrix.elements[13];\n  };\n})();\n","import { paths } from \"./userinput/paths\";\nimport { SOUND_SNAP_ROTATE, SOUND_WAYPOINT_START, SOUND_WAYPOINT_END } from \"./sound-effects-system\";\nimport { easeOutQuadratic } from \"../utils/easing\";\nimport { getPooledMatrix4, freePooledMatrix4 } from \"../utils/mat4-pool\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport {\n  childMatch,\n  rotateInPlaceAroundWorldUp,\n  calculateCameraTransformForWaypoint,\n  interpolateAffine,\n  affixToWorldUp\n} from \"../utils/three-utils\";\nimport { getCurrentPlayerHeight } from \"../utils/get-current-player-height\";\nimport qsTruthy from \"../utils/qs_truthy\";\n//import { m4String } from \"../utils/pretty-print\";\nconst NAV_ZONE = \"character\";\nconst qsAllowWaypointLerp = qsTruthy(\"waypointLerp\");\nconst isMobile = AFRAME.utils.device.isMobile();\n\nconst calculateDisplacementToDesiredPOV = (function() {\n  const translationCoordinateSpace = new THREE.Matrix4();\n  const translated = new THREE.Matrix4();\n  const localTranslation = new THREE.Matrix4();\n  return function calculateDisplacementToDesiredPOV(\n    povMat4,\n    allowVerticalMovement,\n    localDisplacement,\n    displacementToDesiredPOV\n  ) {\n    localTranslation.makeTranslation(localDisplacement.x, localDisplacement.y, localDisplacement.z);\n    translationCoordinateSpace.extractRotation(povMat4);\n    if (!allowVerticalMovement) {\n      affixToWorldUp(translationCoordinateSpace, translationCoordinateSpace);\n    }\n    translated.copy(translationCoordinateSpace).multiply(localTranslation);\n    return displacementToDesiredPOV.setFromMatrixPosition(translated);\n  };\n})();\n\n/**\n * A character controller that moves the avatar.\n * The controller accounts for playspace offset and orientation and depends on the nav mesh system for translation.\n * @namespace avatar\n */\nconst BASE_SPEED = 3.2; //TODO: in what units?\nexport class CharacterControllerSystem {\n  constructor(scene) {\n    this.scene = scene;\n    this.fly = false;\n    this.shouldLandWhenPossible = false;\n    this.waypoints = [];\n    this.waypointTravelStartTime = 0;\n    this.waypointTravelTime = 0;\n    this.navGroup = null;\n    this.navNode = null;\n    this.relativeMotion = new THREE.Vector3(0, 0, 0);\n    this.nextRelativeMotion = new THREE.Vector3(0, 0, 0);\n    this.dXZ = 0;\n    this.scene.addEventListener(\"nav-mesh-loaded\", () => {\n      this.navGroup = null;\n      this.navNode = null;\n    });\n    waitForDOMContentLoaded().then(() => {\n      this.avatarPOV = document.getElementById(\"avatar-pov-node\");\n      this.avatarRig = document.getElementById(\"avatar-rig\");\n    });\n  }\n  // Use this API for waypoint travel so that your matrix doesn't end up in the pool\n  enqueueWaypointTravelTo(inTransform, isInstant, waypointComponentData) {\n    this.waypoints.push({ transform: getPooledMatrix4().copy(inTransform), isInstant, waypointComponentData }); //TODO: don't create new object\n  }\n  enqueueRelativeMotion(motion) {\n    this.relativeMotion.add(motion);\n  }\n  enqueueInPlaceRotationAroundWorldUp(dXZ) {\n    this.dXZ += dXZ;\n  }\n  // We assume the rig is at the root, and its local position === its world position.\n  teleportTo = (function() {\n    const rig = new THREE.Vector3();\n    const head = new THREE.Vector3();\n    const deltaFromHeadToTargetForHead = new THREE.Vector3();\n    const targetForHead = new THREE.Vector3();\n    const targetForRig = new THREE.Vector3();\n    //TODO: Use enqueue waypoint\n    return function teleportTo(targetWorldPosition) {\n      this.isMotionDisabled = false;\n      this.avatarRig.object3D.getWorldPosition(rig);\n      this.avatarPOV.object3D.getWorldPosition(head);\n      targetForHead.copy(targetWorldPosition);\n      targetForHead.y += this.avatarPOV.object3D.position.y;\n      deltaFromHeadToTargetForHead.copy(targetForHead).sub(head);\n      targetForRig.copy(rig).add(deltaFromHeadToTargetForHead);\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\n      this.findPositionOnNavMesh(targetForRig, targetForRig, this.avatarRig.object3D.position, navMeshExists);\n      this.avatarRig.object3D.matrixNeedsUpdate = true;\n    };\n  })();\n\n  travelByWaypoint = (function() {\n    const inMat4Copy = new THREE.Matrix4();\n    const inPosition = new THREE.Vector3();\n    const outPosition = new THREE.Vector3();\n    const translation = new THREE.Matrix4();\n    const initialOrientation = new THREE.Matrix4();\n    const finalScale = new THREE.Vector3();\n    const finalPosition = new THREE.Vector3();\n    const finalPOV = new THREE.Matrix4();\n    return function travelByWaypoint(inMat4, snapToNavMesh, willMaintainInitialOrientation) {\n      this.avatarPOV.object3D.updateMatrices();\n      if (!this.fly && !snapToNavMesh) {\n        this.fly = true;\n        this.shouldLandWhenPossible = true;\n        this.shouldUnoccupyWaypointsOnceMoving = true;\n      }\n      inMat4Copy.copy(inMat4);\n      rotateInPlaceAroundWorldUp(inMat4Copy, Math.PI, finalPOV);\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\n      if (!navMeshExists && snapToNavMesh) {\n        console.warn(\"Tried to travel to a waypoint that wants to snap to the nav mesh, but there is no nav mesh\");\n      }\n      if (navMeshExists && snapToNavMesh) {\n        inPosition.setFromMatrixPosition(inMat4Copy);\n        this.findPositionOnNavMesh(inPosition, inPosition, outPosition, true);\n        finalPOV.setPosition(outPosition);\n        translation.makeTranslation(0, getCurrentPlayerHeight(), -0.15);\n      } else {\n        // If we are not snapping to the nav mesh, align the user's\n        // perspective exactly to the robot eyes as they appear in the\n        // waypoint indicator. (1.6 meters up and 0.15 meters forward)\n        // This does _not_ require taking the player's height into account\n        // on this line because we are only interested in where the\n        // camera will end up.\n        translation.makeTranslation(0, 1.6, -0.15);\n      }\n      finalPOV.multiply(translation);\n      if (willMaintainInitialOrientation) {\n        initialOrientation.extractRotation(this.avatarPOV.object3D.matrixWorld);\n        finalScale.setFromMatrixScale(finalPOV);\n        finalPosition.setFromMatrixPosition(finalPOV);\n        finalPOV\n          .copy(initialOrientation)\n          .scale(finalScale)\n          .setPosition(finalPosition);\n      }\n      calculateCameraTransformForWaypoint(this.avatarPOV.object3D.matrixWorld, finalPOV, finalPOV);\n      childMatch(this.avatarRig.object3D, this.avatarPOV.object3D, finalPOV);\n    };\n  })();\n\n  tick = (function() {\n    const snapRotatedPOV = new THREE.Matrix4();\n    const newPOV = new THREE.Matrix4();\n    const displacementToDesiredPOV = new THREE.Vector3();\n\n    const startPOVPosition = new THREE.Vector3();\n    const desiredPOVPosition = new THREE.Vector3();\n    const navMeshSnappedPOVPosition = new THREE.Vector3();\n    const AVERAGE_WAYPOINT_TRAVEL_SPEED_METERS_PER_SECOND = 50;\n    const startTransform = new THREE.Matrix4();\n    const interpolatedWaypoint = new THREE.Matrix4();\n    const startTranslation = new THREE.Matrix4();\n    const waypointPosition = new THREE.Vector3();\n    const v = new THREE.Vector3();\n\n    let uiRoot;\n    return function tick(t, dt) {\n      const entered = this.scene.is(\"entered\");\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\n      const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\n      if (!isGhost && !entered) return;\n      const vrMode = this.scene.is(\"vr-mode\");\n      this.sfx = this.sfx || this.scene.systems[\"hubs-systems\"].soundEffectsSystem;\n      this.waypointSystem = this.waypointSystem || this.scene.systems[\"hubs-systems\"].waypointSystem;\n\n      if (!this.activeWaypoint && this.waypoints.length) {\n        this.activeWaypoint = this.waypoints.splice(0, 1)[0];\n        // Normally, do not disable motion on touchscreens because there is no way to teleport out of it.\n        // But if motion AND teleporting is disabled, then disable motion because the waypoint author\n        // intended for the user to be stuck here.\n        this.isMotionDisabled =\n          this.activeWaypoint.waypointComponentData.willDisableMotion &&\n          (!isMobile || this.activeWaypoint.waypointComponentData.willDisableTeleporting);\n        this.isTeleportingDisabled = this.activeWaypoint.waypointComponentData.willDisableTeleporting;\n        this.avatarPOV.object3D.updateMatrices();\n        this.waypointTravelTime =\n          (vrMode && !qsAllowWaypointLerp) || this.activeWaypoint.isInstant\n            ? 0\n            : 1000 *\n              (new THREE.Vector3()\n                .setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld)\n                .distanceTo(waypointPosition.setFromMatrixPosition(this.activeWaypoint.transform)) /\n                AVERAGE_WAYPOINT_TRAVEL_SPEED_METERS_PER_SECOND);\n        rotateInPlaceAroundWorldUp(this.avatarPOV.object3D.matrixWorld, Math.PI, startTransform);\n        startTransform.multiply(startTranslation.makeTranslation(0, -1 * getCurrentPlayerHeight(), -0.15));\n        this.waypointTravelStartTime = t;\n        if (!vrMode && this.waypointTravelTime > 100) {\n          this.sfx.playSoundOneShot(SOUND_WAYPOINT_START);\n        }\n      }\n\n      const animationIsOver =\n        this.waypointTravelTime === 0 || t >= this.waypointTravelStartTime + this.waypointTravelTime;\n      if (this.activeWaypoint && !animationIsOver) {\n        const progress = THREE.MathUtils.clamp((t - this.waypointTravelStartTime) / this.waypointTravelTime, 0, 1);\n        interpolateAffine(\n          startTransform,\n          this.activeWaypoint.transform,\n          easeOutQuadratic(progress),\n          interpolatedWaypoint\n        );\n        this.travelByWaypoint(\n          interpolatedWaypoint,\n          false,\n          this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation\n        );\n      }\n      if (this.activeWaypoint && (this.waypoints.length || animationIsOver)) {\n        this.travelByWaypoint(\n          this.activeWaypoint.transform,\n          this.activeWaypoint.waypointComponentData.snapToNavMesh,\n          this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation\n        );\n        freePooledMatrix4(this.activeWaypoint.transform);\n        this.activeWaypoint = null;\n        if (vrMode || this.waypointTravelTime > 0) {\n          this.sfx.playSoundOneShot(SOUND_WAYPOINT_END);\n        }\n      }\n\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const wasFlying = this.fly;\n      if (userinput.get(paths.actions.toggleFly)) {\n        this.shouldLandWhenPossible = false;\n        this.avatarRig.messageDispatch.dispatch(\"/fly\"); // TODO: Separate the logic about displaying the message from toggling the fly state in such a way that it is clear that this.fly will be toggled here\n      }\n      const didStopFlying = wasFlying && !this.fly;\n      if (!this.fly && this.shouldLandWhenPossible) {\n        this.shouldLandWhenPossible = false;\n      }\n      if (this.fly) {\n        this.navNode = null;\n      }\n      const preferences = window.APP.store.state.preferences;\n      const snapRotateLeft = userinput.get(paths.actions.snapRotateLeft);\n      const snapRotateRight = userinput.get(paths.actions.snapRotateRight);\n      if (snapRotateLeft) {\n        this.dXZ += (preferences.snapRotationDegrees * Math.PI) / 180;\n      }\n      if (snapRotateRight) {\n        this.dXZ -= (preferences.snapRotationDegrees * Math.PI) / 180;\n      }\n      if (snapRotateLeft || snapRotateRight) {\n        this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n      }\n      const characterAcceleration = userinput.get(paths.actions.characterAcceleration);\n      if (characterAcceleration) {\n        const zCharacterAcceleration = -1 * characterAcceleration[1];\n        this.relativeMotion.set(\n          this.relativeMotion.x +\n            (preferences.disableMovement || preferences.disableStrafing ? 0 : characterAcceleration[0]),\n          this.relativeMotion.y,\n          this.relativeMotion.z +\n            (preferences.disableMovement\n              ? 0\n              : preferences.disableBackwardsMovement\n                ? Math.min(0, zCharacterAcceleration)\n                : zCharacterAcceleration)\n        );\n      }\n      const lerpC = vrMode ? 0 : 0.85; // TODO: To support drifting (\"ice skating\"), motion needs to keep initial direction\n      this.nextRelativeMotion.copy(this.relativeMotion).multiplyScalar(lerpC);\n      this.relativeMotion.multiplyScalar(1 - lerpC);\n\n      this.avatarPOV.object3D.updateMatrices();\n      rotateInPlaceAroundWorldUp(this.avatarPOV.object3D.matrixWorld, this.dXZ, snapRotatedPOV);\n\n      newPOV.copy(snapRotatedPOV);\n\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\n      if (!this.isMotionDisabled) {\n        const playerScale = v.setFromMatrixColumn(this.avatarPOV.object3D.matrixWorld, 1).length();\n        const triedToMove = this.relativeMotion.lengthSq() > 0.000001;\n\n        if (triedToMove) {\n          const speedModifier = preferences.movementSpeedModifier;\n          calculateDisplacementToDesiredPOV(\n            snapRotatedPOV,\n            this.fly || !navMeshExists,\n            this.relativeMotion.multiplyScalar(\n              ((userinput.get(paths.actions.boost) ? 2 : 1) *\n                speedModifier *\n                BASE_SPEED *\n                Math.sqrt(playerScale) *\n                dt) /\n                1000\n            ),\n            displacementToDesiredPOV\n          );\n\n          newPOV\n            .makeTranslation(displacementToDesiredPOV.x, displacementToDesiredPOV.y, displacementToDesiredPOV.z)\n            .multiply(snapRotatedPOV);\n        }\n\n        const shouldRecomputeNavGroupAndNavNode = didStopFlying || this.shouldLandWhenPossible;\n        const shouldResnapToNavMesh = navMeshExists && (shouldRecomputeNavGroupAndNavNode || triedToMove);\n\n        let squareDistNavMeshCorrection = 0;\n\n        if (shouldResnapToNavMesh) {\n          this.findPOVPositionAboveNavMesh(\n            startPOVPosition.setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld),\n            desiredPOVPosition.setFromMatrixPosition(newPOV),\n            navMeshSnappedPOVPosition,\n            shouldRecomputeNavGroupAndNavNode\n          );\n\n          squareDistNavMeshCorrection = desiredPOVPosition.distanceToSquared(navMeshSnappedPOVPosition);\n\n          if (this.fly && this.shouldLandWhenPossible && squareDistNavMeshCorrection < 0.5 && !this.activeWaypoint) {\n            this.shouldLandWhenPossible = false;\n            this.fly = false;\n            newPOV.setPosition(navMeshSnappedPOVPosition);\n          } else if (!this.fly) {\n            newPOV.setPosition(navMeshSnappedPOVPosition);\n          }\n        }\n\n        if (!this.activeWaypoint && this.shouldUnoccupyWaypointsOnceMoving && triedToMove) {\n          this.shouldUnoccupyWaypointsOnceMoving = false;\n          this.waypointSystem.releaseAnyOccupiedWaypoints();\n          if (this.fly && this.shouldLandWhenPossible && (shouldResnapToNavMesh && squareDistNavMeshCorrection < 3)) {\n            newPOV.setPosition(navMeshSnappedPOVPosition);\n            this.shouldLandWhenPossible = false;\n            this.fly = false;\n          }\n        }\n      }\n\n      childMatch(this.avatarRig.object3D, this.avatarPOV.object3D, newPOV);\n      this.relativeMotion.copy(this.nextRelativeMotion);\n      this.dXZ = 0;\n    };\n  })();\n\n  getClosestNode(pos) {\n    const pathfinder = this.scene.systems.nav.pathfinder;\n    if (!pathfinder.zones[NAV_ZONE].groups[this.navGroup]) {\n      return null;\n    }\n    return (\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup, true) ||\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup)\n    );\n  }\n\n  findPOVPositionAboveNavMesh = (function() {\n    const startingFeetPosition = new THREE.Vector3();\n    const desiredFeetPosition = new THREE.Vector3();\n    // TODO: Here we assume the player is standing straight up, but in VR it is often the case\n    // that you want to lean over the edge of a balcony/table that does not have nav mesh below.\n    // We should find way to allow leaning over the edge of a balcony and maybe disallow putting\n    // your head through a wall.\n    return function findPOVPositionAboveNavMesh(\n      startPOVPosition,\n      desiredPOVPosition,\n      outPOVPosition,\n      shouldRecomputeGroupAndNode\n    ) {\n      const playerHeight = getCurrentPlayerHeight(true);\n      startingFeetPosition.copy(startPOVPosition);\n      startingFeetPosition.y -= playerHeight;\n      desiredFeetPosition.copy(desiredPOVPosition);\n      desiredFeetPosition.y -= playerHeight;\n      this.findPositionOnNavMesh(\n        startingFeetPosition,\n        desiredFeetPosition,\n        outPOVPosition,\n        shouldRecomputeGroupAndNode\n      );\n      outPOVPosition.y += playerHeight;\n      return outPOVPosition;\n    };\n  })();\n\n  findPositionOnNavMesh(start, end, outPos, shouldRecomputeGroupAndNode) {\n    const pathfinder = this.scene.systems.nav.pathfinder;\n    if (!(NAV_ZONE in pathfinder.zones)) return;\n    this.navGroup =\n      shouldRecomputeGroupAndNode || this.navGroup === null\n        ? pathfinder.getGroup(NAV_ZONE, end, true, true)\n        : this.navGroup;\n    this.navNode =\n      shouldRecomputeGroupAndNode || this.navNode === null || this.navNode === undefined\n        ? this.getClosestNode(end)\n        : this.navNode;\n    if (this.navNode === null || this.navNode === undefined) {\n      // this.navNode can be null if it has never been set or if getClosestNode fails,\n      // and it can be undefined if clampStep fails, so we have to check both. We do not\n      // simply check if it is falsey (!this.navNode), because 0 (zero) is a valid value,\n      // and 0 is falsey.\n      outPos.copy(end);\n    } else {\n      this.navNode = pathfinder.clampStep(start, end, this.navNode, NAV_ZONE, this.navGroup, outPos);\n    }\n    return outPos;\n  }\n\n  enableFly(enabled) {\n    if (enabled && window.APP.hubChannel && window.APP.hubChannel.can(\"fly\")) {\n      this.fly = true;\n    } else {\n      this.fly = false;\n    }\n    return this.fly;\n  }\n}\n","const IDENTITY = new THREE.Matrix4().identity();\nexport class CursorPoseTrackingSystem {\n  constructor() {\n    this.pairs = [];\n  }\n  register(object3D, path) {\n    object3D.applyMatrix4(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\n    this.pairs.push({ object3D, path });\n  }\n  unregister(object3D) {\n    this.pairs = this.pairs.filter(p => p.object3D !== object3D);\n  }\n  tick() {\n    for (let i = 0; i < this.pairs.length; i++) {\n      const matrix = AFRAME.scenes[0].systems.userinput.get(this.pairs[i].path);\n      if (matrix) {\n        const o = this.pairs[i].object3D;\n        o.matrix.copy(matrix);\n        o.matrix.decompose(o.position, o.quaternion, o.scale);\n        o.matrixWorldNeedsUpdate = true;\n      }\n    }\n  }\n}\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { elasticOut } from \"../utils/easing\";\nconst MENU_ANIMATION_DURATION_MS = 750;\nexport class MenuAnimationSystem {\n  constructor() {\n    this.components = [];\n    this.data = new Map();\n    this.tick = this.tick.bind(this);\n    waitForDOMContentLoaded().then(() => {\n      this.viewingCameraEl = document.getElementById(\"viewing-camera\");\n    });\n  }\n  register(component, menuEl, chooseScale) {\n    this.components.push(component);\n    this.data.set(component, {\n      menuEl,\n      chooseScale,\n      menuOpenTime: -1,\n      startScaleAtMenuOpenTime: 0,\n      wasMenuVisible: false,\n      endingScale: 0\n    });\n  }\n  unregister(component) {\n    this.components.splice(this.components.indexOf(component), 1);\n    this.data.delete(component);\n  }\n  tick = (function() {\n    const menuToCamera = new THREE.Vector3();\n    const menuScale = new THREE.Vector3();\n    const menuParentScale = new THREE.Vector3();\n    const menuPosition = new THREE.Vector3();\n    const cameraPosition = new THREE.Vector3();\n    return function tick(t) {\n      if (!this.viewingCameraEl) {\n        return;\n      }\n      const camera = this.viewingCameraEl.object3DMap.camera;\n      camera.updateMatrices();\n      cameraPosition.setFromMatrixPosition(camera.matrixWorld);\n\n      for (let i = 0; i < this.components.length; i++) {\n        const datum = this.data.get(this.components[i]);\n        const isMenuVisible = datum.menuEl.object3D.visible;\n        const isMenuOpening = isMenuVisible && !datum.wasMenuVisible;\n        const distanceToMenu = menuToCamera\n          .subVectors(cameraPosition, menuPosition.setFromMatrixPosition(datum.menuEl.object3D.matrixWorld))\n          .length();\n        datum.menuEl.object3D.parent.updateMatrices();\n        menuParentScale.setFromMatrixScale(datum.menuEl.object3D.parent.matrixWorld);\n        if (isMenuOpening) {\n          const scale = datum.chooseScale\n            ? THREE.MathUtils.clamp(0.45 * distanceToMenu, 0.05, 4)\n            : menuScale.setFromMatrixScale(datum.menuEl.object3D.matrixWorld).x;\n          datum.endingScale = scale / menuParentScale.x;\n          datum.menuOpenTime = t;\n          datum.startScaleAtMenuOpenTime = datum.endingScale * 0.8;\n        }\n        if (isMenuVisible) {\n          const currentScale = THREE.MathUtils.lerp(\n            datum.startScaleAtMenuOpenTime,\n            datum.endingScale,\n            elasticOut(THREE.MathUtils.clamp((t - datum.menuOpenTime) / MENU_ANIMATION_DURATION_MS, 0, 1))\n          );\n          if (datum.menuEl.object3D.scale.x !== currentScale) {\n            datum.menuEl.object3D.scale.setScalar(currentScale);\n            datum.menuEl.object3D.matrixNeedsUpdate = true;\n          }\n        }\n        datum.wasMenuVisible = isMenuVisible;\n      }\n    };\n  })();\n}\n","import { SourceType } from \"../components/audio-params\";\nimport { updateAudioSettings } from \"../update-audio-settings\";\n\nexport class AudioSettingsSystem {\n  constructor(sceneEl) {\n    sceneEl.addEventListener(\"reset_scene\", this.onSceneReset);\n\n    if (window.APP.store.state.preferences.audioNormalization !== 0.0) {\n      //hack to always reset to 0.0 (disabled)\n      window.APP.store.update({\n        preferences: { audioNormalization: 0.0 }\n      });\n    }\n  }\n\n  onSceneReset = () => {\n    APP.sceneAudioDefaults.delete(SourceType.AVATAR_AUDIO_SOURCE);\n    APP.sceneAudioDefaults.delete(SourceType.MEDIA_VIDEO);\n    for (const [el, audio] of APP.audios.entries()) {\n      updateAudioSettings(el, audio);\n    }\n  };\n}\n","import { LogMessageType } from \"../react-components/room/ChatSidebar\";\nimport { GAIN_TIME_CONST, SourceType } from \"../components/audio-params\";\n\nlet delayedReconnectTimeout = null;\nfunction performDelayedReconnect(gainNode) {\n  if (delayedReconnectTimeout) {\n    clearTimeout(delayedReconnectTimeout);\n  }\n\n  delayedReconnectTimeout = setTimeout(() => {\n    delayedReconnectTimeout = null;\n    console.warn(\n      \"enableChromeAEC: recreate RTCPeerConnection loopback because the local connection was disconnected for 10s\"\n    );\n    // eslint-disable-next-line no-use-before-define\n    enableChromeAEC(gainNode);\n  }, 10000);\n}\n\nimport * as sdpTransform from \"sdp-transform\";\nimport MediaDevicesManager from \"../utils/media-devices-manager\";\n\nfunction isThreeAudio(node) {\n  return node instanceof THREE.Audio || node instanceof THREE.PositionalAudio;\n}\n\nasync function enableChromeAEC(gainNode) {\n  /**\n   *  workaround for: https://bugs.chromium.org/p/chromium/issues/detail?id=687574\n   *  1. grab the GainNode from the scene's THREE.AudioListener\n   *  2. disconnect the GainNode from the AudioDestinationNode (basically the audio out), this prevents hearing the audio twice.\n   *  3. create a local webrtc connection between two RTCPeerConnections (see this example: https://webrtc.github.io/samples/src/content/peerconnection/pc1/)\n   *  4. create a new MediaStreamDestination from the scene's THREE.AudioContext and connect the GainNode to it.\n   *  5. add the MediaStreamDestination's track  to one of those RTCPeerConnections\n   *  6. connect the other RTCPeerConnection's stream to a new audio element.\n   *  All audio is now routed through Chrome's audio mixer, thus enabling AEC, while preserving all the audio processing that was performed via the WebAudio API.\n   */\n\n  const audioEl = new Audio();\n  audioEl.setAttribute(\"autoplay\", \"autoplay\");\n  audioEl.setAttribute(\"playsinline\", \"playsinline\");\n\n  const context = THREE.AudioContext.getContext();\n  const loopbackDestination = context.createMediaStreamDestination();\n  const outboundPeerConnection = new RTCPeerConnection();\n  const inboundPeerConnection = new RTCPeerConnection();\n\n  const onError = e => {\n    console.error(\"enableChromeAEC: RTCPeerConnection loopback initialization error\", e);\n  };\n\n  outboundPeerConnection.addEventListener(\"icecandidate\", e => {\n    inboundPeerConnection.addIceCandidate(e.candidate).catch(onError);\n  });\n  outboundPeerConnection.addEventListener(\"iceconnectionstatechange\", () => {\n    console.warn(\n      \"enableChromeAEC: outboundPeerConnection state changed to \" + outboundPeerConnection.iceConnectionState\n    );\n    if (outboundPeerConnection.iceConnectionState === \"disconnected\") {\n      performDelayedReconnect(gainNode);\n    }\n    if (outboundPeerConnection.iceConnectionState === \"connected\") {\n      if (delayedReconnectTimeout) {\n        // The RTCPeerConnection reconnected by itself, cancel recreating the\n        // local connection.\n        clearTimeout(delayedReconnectTimeout);\n      }\n    }\n  });\n\n  inboundPeerConnection.addEventListener(\"icecandidate\", e => {\n    outboundPeerConnection.addIceCandidate(e.candidate).catch(onError);\n  });\n  inboundPeerConnection.addEventListener(\"iceconnectionstatechange\", () => {\n    console.warn(\"enableChromeAEC: inboundPeerConnection state changed to \" + inboundPeerConnection.iceConnectionState);\n    if (inboundPeerConnection.iceConnectionState === \"disconnected\") {\n      performDelayedReconnect(gainNode);\n    }\n    if (inboundPeerConnection.iceConnectionState === \"connected\") {\n      if (delayedReconnectTimeout) {\n        // The RTCPeerConnection reconnected by itself, cancel recreating the\n        // local connection.\n        clearTimeout(delayedReconnectTimeout);\n      }\n    }\n  });\n\n  inboundPeerConnection.addEventListener(\"track\", e => {\n    audioEl.srcObject = e.streams[0];\n  });\n\n  try {\n    //The following should never fail, but just in case, we won't disconnect/reconnect the gainNode unless all of this succeeds\n    loopbackDestination.stream.getTracks().forEach(track => {\n      outboundPeerConnection.addTrack(track, loopbackDestination.stream);\n    });\n\n    const offer = await outboundPeerConnection.createOffer();\n    outboundPeerConnection.setLocalDescription(offer);\n    await inboundPeerConnection.setRemoteDescription(offer);\n\n    const answer = await inboundPeerConnection.createAnswer();\n\n    // Rewrite SDP to be stereo and (variable) max bitrate\n    const parsedSdp = sdpTransform.parse(answer.sdp);\n    for (let i = 0; i < parsedSdp.media.length; i++) {\n      for (let j = 0; j < parsedSdp.media[i].fmtp.length; j++) {\n        parsedSdp.media[i].fmtp[j].config += `;stereo=1;cbr=0;maxaveragebitrate=510000;`;\n      }\n    }\n    answer.sdp = sdpTransform.write(parsedSdp);\n\n    inboundPeerConnection.setLocalDescription(answer);\n    outboundPeerConnection.setRemoteDescription(answer);\n\n    gainNode.disconnect();\n    gainNode.connect(loopbackDestination);\n  } catch (e) {\n    onError(e);\n  }\n}\n\nexport class AudioSystem {\n  constructor(sceneEl) {\n    this._sceneEl = sceneEl;\n\n    this.audioContext = THREE.AudioContext.getContext();\n    this.audioNodes = new Map();\n    this.mediaStreamDestinationNode = this.audioContext.createMediaStreamDestination(); // Voice, camera, screenshare\n    this.audioDestination = this.audioContext.createMediaStreamDestination(); // Media elements\n    this.outboundStream = this.mediaStreamDestinationNode.stream;\n    this.outboundGainNode = this.audioContext.createGain();\n    this.outboundAnalyser = this.audioContext.createAnalyser();\n    this.outboundAnalyser.fftSize = 32;\n    this.analyserLevels = new Uint8Array(this.outboundAnalyser.fftSize);\n    this.outboundGainNode.connect(this.outboundAnalyser);\n    this.outboundAnalyser.connect(this.mediaStreamDestinationNode);\n    this.audioContextNeedsToBeResumed = false;\n\n    this.mixer = {\n      [SourceType.AVATAR_AUDIO_SOURCE]: this.audioContext.createGain(),\n      [SourceType.MEDIA_VIDEO]: this.audioContext.createGain(),\n      [SourceType.SFX]: this.audioContext.createGain()\n    };\n    this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(this._sceneEl.audioListener.getInput());\n    this.mixer[SourceType.MEDIA_VIDEO].connect(this._sceneEl.audioListener.getInput());\n    this.mixer[SourceType.SFX].connect(this._sceneEl.audioListener.getInput());\n\n    // Analyser to show the output audio level\n    this.mixerAnalyser = this.audioContext.createAnalyser();\n    this.mixerAnalyser.fftSize = 32;\n    this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(this.mixerAnalyser);\n    this.mixer[SourceType.MEDIA_VIDEO].connect(this.mixerAnalyser);\n    this.mixer[SourceType.SFX].connect(this.mixerAnalyser);\n\n    // Webkit Mobile fix\n    this._safariMobileAudioInterruptionFix();\n\n    document.body.addEventListener(\"touchend\", this._resumeAudioContext, false);\n    document.body.addEventListener(\"mouseup\", this._resumeAudioContext, false);\n\n    this.onPrefsUpdated = this.updatePrefs.bind(this);\n    window.APP.store.addEventListener(\"statechanged\", this.onPrefsUpdated);\n  }\n\n  addStreamToOutboundAudio(id, mediaStream) {\n    if (this.audioNodes.has(id)) {\n      this.removeStreamFromOutboundAudio(id);\n    }\n\n    const sourceNode = this.audioContext.createMediaStreamSource(mediaStream);\n    const gainNode = this.audioContext.createGain();\n    sourceNode.connect(gainNode);\n    gainNode.connect(this.outboundGainNode);\n    this.audioNodes.set(id, { sourceNode, gainNode });\n  }\n\n  removeStreamFromOutboundAudio(id) {\n    if (this.audioNodes.has(id)) {\n      const nodes = this.audioNodes.get(id);\n      nodes.sourceNode.disconnect();\n      nodes.gainNode.disconnect();\n      this.audioNodes.delete(id);\n    }\n  }\n\n  addAudio({ sourceType, node }) {\n    let outputNode = node;\n    if (isThreeAudio(node)) {\n      node.gain.disconnect();\n      outputNode = node.gain;\n    }\n    outputNode.connect(this.mixer[sourceType]);\n  }\n\n  removeAudio({ node }) {\n    let outputNode = node;\n    if (isThreeAudio(node)) {\n      outputNode = node.gain;\n    }\n    outputNode.disconnect();\n  }\n\n  updatePrefs() {\n    const { globalVoiceVolume, globalMediaVolume, globalSFXVolume } = window.APP.store.state.preferences;\n    let newGain = globalMediaVolume / 100;\n    this.mixer[SourceType.MEDIA_VIDEO].gain.setTargetAtTime(newGain, this.audioContext.currentTime, GAIN_TIME_CONST);\n\n    newGain = globalSFXVolume / 100;\n    this.mixer[SourceType.SFX].gain.setTargetAtTime(newGain, this.audioContext.currentTime, GAIN_TIME_CONST);\n\n    newGain = globalVoiceVolume / 100;\n    this.mixer[SourceType.AVATAR_AUDIO_SOURCE].gain.setTargetAtTime(\n      newGain,\n      this.audioContext.currentTime,\n      GAIN_TIME_CONST\n    );\n\n    if (MediaDevicesManager.isAudioOutputSelectEnabled && APP.mediaDevicesManager) {\n      const sinkId = APP.mediaDevicesManager.selectedSpeakersDeviceId;\n      const isDefault = sinkId === APP.mediaDevicesManager.defaultOutputDeviceId;\n      if ((!this.outputMediaAudio && isDefault) || sinkId === this.outputMediaAudio?.sinkId) return;\n      const sink = isDefault ? this._sceneEl.audioListener.getInput() : this.audioDestination;\n      this.mixer[SourceType.AVATAR_AUDIO_SOURCE].disconnect();\n      this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(sink);\n      this.mixer[SourceType.AVATAR_AUDIO_SOURCE].connect(this.mixerAnalyser);\n      this.mixer[SourceType.MEDIA_VIDEO].disconnect();\n      this.mixer[SourceType.MEDIA_VIDEO].connect(sink);\n      this.mixer[SourceType.MEDIA_VIDEO].connect(this.mixerAnalyser);\n      this.mixer[SourceType.SFX].disconnect();\n      this.mixer[SourceType.SFX].connect(sink);\n      this.mixer[SourceType.SFX].connect(this.mixerAnalyser);\n      if (isDefault) {\n        if (this.outputMediaAudio) {\n          this.outputMediaAudio.pause();\n          this.outputMediaAudio.srcObject = null;\n          this.outputMediaAudio = null;\n        }\n      } else {\n        // Swithing the audio sync is only supported in Chrome at the time of writing this.\n        // It also seems to have some limitations and it only works on audio elements. We are piping all our media through the Audio Context\n        // and that doesn't seem to work.\n        // To workaround that we need to use a MediaStreamAudioDestinationNode that is set as the source of the audio element where we switch the sink.\n        // This is very hacky but there don't seem to have any better alternatives at the time of writing this.\n        // https://stackoverflow.com/a/67043782\n        if (!this.outputMediaAudio) {\n          this.outputMediaAudio = new Audio();\n          this.outputMediaAudio.srcObject = this.audioDestination.stream;\n        }\n        if (this.outputMediaAudio.sinkId !== sinkId) {\n          this.outputMediaAudio.setSinkId(sinkId).then(() => {\n            this.outputMediaAudio.play();\n          });\n        }\n      }\n    }\n  }\n\n  /**\n   * Chrome and Safari will start Audio contexts in a \"suspended\" state.\n   * A user interaction (touch/mouse event) is needed in order to resume the AudioContext.\n   */\n  _resumeAudioContext = () => {\n    this.audioContext.resume();\n\n    setTimeout(() => {\n      if (this.audioContext.state === \"running\") {\n        const disableAEC = window.APP.store.state.preferences.disableEchoCancellation;\n        if (!AFRAME.utils.device.isMobile() && /chrome/i.test(navigator.userAgent) && !disableAEC) {\n          enableChromeAEC(this._sceneEl.audioListener.gain);\n        }\n\n        document.body.removeEventListener(\"touchend\", this._resumeAudioContext, false);\n        document.body.removeEventListener(\"mouseup\", this._resumeAudioContext, false);\n      }\n    }, 0);\n  };\n\n  // Webkit mobile fix\n  // https://stackoverflow.com/questions/10232908/is-there-a-way-to-detect-a-mobile-safari-audio-interruption-headphones-unplugg\n  _safariMobileAudioInterruptionFix() {\n    this.audioContext.onstatechange = () => {\n      console.log(`AudioContext state changed to ${this.audioContext.state}`);\n      if (this.audioContext.state === \"suspended\") {\n        // When you unplug the headphone or when the bluetooth headset disconnects on\n        // iOS Safari or Chrome, the state changes to suspended.\n        // Chrome Android doesn't go in suspended state for this case.\n        document.getElementById(\"avatar-rig\").messageDispatch.log(LogMessageType.audioSuspended);\n        document.body.addEventListener(\"touchend\", this._resumeAudioContext, false);\n        document.body.addEventListener(\"mouseup\", this._resumeAudioContext, false);\n        this.audioContextNeedsToBeResumed = true;\n      } else if (this.audioContext.state === \"running\" && this.audioContextNeedsToBeResumed) {\n        this.audioContextNeedsToBeResumed = false;\n        document.getElementById(\"avatar-rig\").messageDispatch.log(LogMessageType.audioResumed);\n      }\n    };\n  }\n}\n","import { updateMaterials } from \"../utils/material-utils.js\";\n\nconst frustumBox = new THREE.Box3();\nconst inverseShadowCameraMatrixWorld = new THREE.Matrix4();\nconst tempBox = new THREE.Box3();\nconst FRUSTUM_PADDING = 1;\nconst NEAR_CLIPPING_PLANE = -500;\nconst FAR_CLIPPING_PLANE = 500;\nconst verts = [\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3()\n];\n\nfunction computeShadowCameraBoundingBox(object3D, boundingBox = new THREE.Box3()) {\n  boundingBox.makeEmpty();\n\n  object3D.updateMatrixWorld();\n\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\n  object3D.traverse(node => {\n    const geometry = node.geometry;\n\n    if (geometry && node.castShadow) {\n      if (!geometry.boundingBox) {\n        geometry.computeBoundingBox();\n      }\n\n      tempBox.copy(geometry.boundingBox);\n\n      // Apply matrix transforming bounding box from model space to world space\n      tempBox.applyMatrix4(node.matrixWorld);\n\n      boundingBox.union(tempBox);\n    }\n  });\n\n  tempBox.makeEmpty();\n\n  return boundingBox;\n}\n\nfunction resizeShadowCameraFrustum(light, boundingBox) {\n  // Reset bounding box\n  frustumBox.makeEmpty();\n\n  // Transform the resulting bounding box from world space to light space.\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\n  const min = boundingBox.min;\n  const max = boundingBox.max;\n\n  verts[0].set(min.x, min.y, min.z);\n  verts[1].set(min.x, min.y, max.z);\n  verts[2].set(min.x, max.y, min.z);\n  verts[3].set(min.x, max.y, max.z);\n  verts[4].set(max.x, min.y, min.z);\n  verts[5].set(max.x, min.y, max.z);\n  verts[6].set(max.x, max.y, min.z);\n  verts[7].set(max.x, max.y, max.z);\n\n  light.updateMatrices();\n  light.target.updateMatrices();\n  light.shadow.updateMatrices(light);\n  inverseShadowCameraMatrixWorld.copy(light.shadow.camera.matrixWorld).invert();\n\n  for (let i = 0; i < verts.length; i++) {\n    verts[i].applyMatrix4(inverseShadowCameraMatrixWorld);\n    frustumBox.expandByPoint(verts[i]);\n  }\n\n  // Update the camera frustum to fit the resulting bounding box.\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\n  const camera = light.shadow.camera;\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\n  camera.updateProjectionMatrix();\n}\n\nexport class ShadowSystem {\n  constructor(sceneEl) {\n    this.sceneEl = sceneEl;\n    this.shadowCameraBoundingBox = new THREE.Box3();\n    this.previousShadowsEnabled = this.realtimeShadowsEnabled = null;\n\n    // Defaults previously in hub.html\n    sceneEl.renderer.shadowMap.enabled = false;\n    sceneEl.renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n    sceneEl.renderer.shadowMap.autoUpdate = true;\n\n    window.APP.store.addEventListener(\"statechanged\", this.updatePrefs.bind(this));\n    this.updatePrefs();\n  }\n\n  updatePrefs() {\n    this.realtimeShadowsEnabled =\n      window.APP.store.state.preferences.enableDynamicShadows === true &&\n      window.APP.store.materialQualitySetting !== \"low\";\n    if (this.previousShadowsEnabled !== this.realtimeShadowsEnabled) {\n      this.sceneEl.renderer.shadowMap.enabled = this.realtimeShadowsEnabled;\n\n      // If scene has already rendered, materials which can receive shadows must be updated.\n      if (this.sceneEl.hasLoaded) {\n        this.sceneEl.object3D.traverse(node => {\n          if (node.receiveShadow && node.material) {\n            updateMaterials(node, material => {\n              material.needsUpdate = true;\n              return material;\n            });\n          }\n        });\n      }\n    }\n    this.previousShadowsEnabled = this.realtimeShadowsEnabled;\n  }\n\n  tick() {\n    if (!this.realtimeShadowsEnabled) {\n      return;\n    }\n    computeShadowCameraBoundingBox(this.sceneEl.object3D, this.shadowCameraBoundingBox);\n    this.sceneEl.object3D.traverse(object3D => {\n      if (object3D.isDirectionalLight) {\n        resizeShadowCameraFrustum(object3D, this.shadowCameraBoundingBox);\n      }\n    });\n  }\n}\n","import { paths } from \"./userinput/paths\";\nexport class InspectYourselfSystem {\n  tick(scene, userinput, cameraSystem) {\n    if (!scene.is(\"entered\")) return;\n    if (userinput.get(paths.actions.startInspectingSelf)) {\n      const rig = document.getElementById(\"avatar-rig\");\n      cameraSystem.inspect(rig, 1.5);\n    }\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { emojis, spawnEmojiInFrontOfUser } from \"../components/emoji\";\n\nconst actions = [\n  paths.actions.spawnEmoji0,\n  paths.actions.spawnEmoji1,\n  paths.actions.spawnEmoji2,\n  paths.actions.spawnEmoji3,\n  paths.actions.spawnEmoji4,\n  paths.actions.spawnEmoji5,\n  paths.actions.spawnEmoji6\n];\n\nconst EMOJI_RATE_LIMIT = 1000;\n\nexport class EmojiSystem {\n  constructor(scene) {\n    this.scene = scene;\n\n    this.scene.addEventListener(\"enter-vr\", () => {\n      if (!document.getElementById(\"emoji-hud\")) {\n        const emojiHudEntity = document.createElement(\"a-entity\");\n        emojiHudEntity.id = \"emoji-hud\";\n        emojiHudEntity.setAttribute(\"emoji-hud\", \"\");\n        scene.appendChild(emojiHudEntity);\n      }\n    });\n\n    this.scene.addEventListener(\"exit-vr\", () => {\n      const emojiHudEntity = document.getElementById(\"emoji-hud\");\n\n      if (emojiHudEntity) {\n        emojiHudEntity.remove();\n      }\n    });\n\n    this.lastSpawnedEmoji = 0;\n  }\n\n  tick(time, userinput) {\n    if (!this.scene.is(\"entered\")) return;\n\n    for (let i = 0; i < actions.length; i++) {\n      if (\n        userinput.get(actions[i]) &&\n        i < emojis.length &&\n        window.APP.hubChannel.can(\"spawn_emoji\") &&\n        time - this.lastSpawnedEmoji > EMOJI_RATE_LIMIT\n      ) {\n        this.lastSpawnedEmoji = time;\n        spawnEmojiInFrontOfUser(emojis[i]);\n      }\n    }\n  }\n}\n","// We apply the most restrictive audio parameters\nfunction paramsReducer(acc, curr) {\n  if (!curr && !acc) return {};\n  else if (curr && !acc) return curr;\n  else if (!curr && acc) return acc;\n  else\n    return [\n      \"gain\",\n      \"maxDistance\",\n      \"refDistance\",\n      \"rolloffFactor\",\n      \"coneInnerAngle\",\n      \"coneOuterAngle\",\n      \"coneOuterGain\"\n    ].reduce((result, key) => {\n      if (curr[key] !== undefined && acc[key] !== undefined) {\n        result[key] = Math.min(acc[key], curr[key]);\n      } else if (curr[key] !== undefined && acc[key] === undefined) {\n        result[key] = curr[key];\n      } else if (curr[key] === undefined && acc[key] !== undefined) {\n        result[key] = acc[key];\n      }\n      return result;\n    }, {});\n}\n\nfunction addOrRemoveZone(zones, zone, position) {\n  const isInZone = zone.isEnabled() && zone.contains(position);\n  const wasInZone = zones.has(zone);\n  if (isInZone && !wasInZone) {\n    zones.add(zone);\n  } else if (!isInZone && wasInZone) {\n    zones.delete(zone);\n  }\n}\n\nfunction any(set, predicate) {\n  for (const item of set) {\n    if (predicate(item)) return true;\n  }\n  return false;\n}\n\nfunction isUpdated(currZones, prevZones) {\n  return currZones.size !== prevZones.size || any(currZones, zone => !prevZones.has(zone));\n}\n\nconst setRay = (function() {\n  const direction = new THREE.Vector3();\n  return function setRay(ray, from, to) {\n    ray.set(from, direction.subVectors(to, from).normalize());\n  };\n})();\n\nfunction exclude(zones) {\n  return zone => {\n    return !zones.has(zone);\n  };\n}\n\nfunction hasIntersection(ray) {\n  const intersectTarget = new THREE.Vector3();\n  return zone => {\n    ray.intersectBox(zone.getBoundingBox(), intersectTarget);\n    return intersectTarget !== null;\n  };\n}\nconst updateSource = (function() {\n  const ray = new THREE.Ray();\n  return function updateSource(source, sourcePosition, sourceZones, listenerPosition, listenerZones) {\n    setRay(ray, listenerPosition, sourcePosition);\n\n    // TODO: Reimplement the desired sorting of zones\n    const inOutParams = Array.from(sourceZones)\n      .filter(zone => zone.data.inOut)\n      .filter(exclude(listenerZones))\n      .filter(hasIntersection(ray))\n      .map(zone => zone.getAudioParams())\n      .reduce(paramsReducer, null);\n\n    // TODO: Reimplement the desired sorting of zones\n    const outInParams = Array.from(listenerZones)\n      .filter(zone => zone.data.outIn)\n      .filter(exclude(sourceZones))\n      .filter(hasIntersection(ray))\n      .map(zone => zone.getAudioParams())\n      .reduce(paramsReducer, null);\n\n    if (!outInParams && !inOutParams) {\n      source.restore();\n    } else if (outInParams && !inOutParams) {\n      source.apply(outInParams);\n    } else if (!outInParams && inOutParams) {\n      source.apply(inOutParams);\n    } else {\n      // In this case two zones ar acting over the same source simultaneously.\n      // We apply the closest zone params with the lowest gain\n      source.apply(\n        Object.assign(\n          {},\n          inOutParams,\n          outInParams,\n          paramsReducer(\n            {\n              gain: outInParams.gain\n            },\n            {\n              gain: inOutParams.gain\n            }\n          )\n        )\n      );\n    }\n  };\n})();\n\nexport class AudioZonesSystem {\n  constructor() {\n    this.zones = [];\n    this.sources = [];\n    this.entities = [];\n    this.currZones = new Map();\n    this.prevZones = new Map();\n    this.didRegisterAudioListener = false;\n  }\n  registerZone(zone) {\n    this.zones.push(zone);\n  }\n  unregisterZone(zone) {\n    this.zones.splice(this.zones.indexOf(zone), 1);\n    this.entities.forEach(entity => {\n      this.currZones.get(entity).delete(zone);\n    });\n  }\n  registerSource(source) {\n    this.sources.push(source);\n    this.registerEntity(source);\n  }\n  unregisterSource(source) {\n    this.sources.splice(this.sources.indexOf(source), 1);\n    this.unregisterEntity(source);\n  }\n  registerEntity(entity) {\n    this.entities.push(entity);\n    this.currZones.set(entity, new Set());\n    this.prevZones.set(entity, new Set());\n  }\n  unregisterEntity(entity) {\n    this.entities.splice(this.entities.indexOf(entity), 1);\n    this.currZones.delete(entity);\n    this.prevZones.delete(entity);\n  }\n\n  tick = (function() {\n    const listenerPosition = new THREE.Vector3();\n    return function(scene) {\n      if (!scene.is(\"entered\")) return;\n\n      if (!this.didRegisterAudioListener) {\n        this.didRegisterAudioListener = true;\n        this.registerEntity(scene.audioListener);\n      }\n\n      const currListenerZones = this.currZones.get(scene.audioListener);\n      scene.audioListener.getWorldPosition(listenerPosition);\n      this.zones.forEach(zone => {\n        addOrRemoveZone(currListenerZones, zone, listenerPosition);\n        this.sources.forEach(source => {\n          addOrRemoveZone(this.currZones.get(source), zone, source.getPosition());\n        });\n      });\n\n      const isListenerUpdated = isUpdated(currListenerZones, this.prevZones.get(scene.audioListener));\n      this.sources\n        .filter(source => {\n          return isListenerUpdated || isUpdated(this.currZones.get(source), this.prevZones.get(source));\n        })\n        .forEach(source => {\n          updateSource(source, source.getPosition(), this.currZones.get(source), listenerPosition, currListenerZones);\n        });\n\n      this.entities.forEach(entity => {\n        const prevZones = this.prevZones.get(entity);\n        prevZones.clear();\n        this.currZones.get(entity).forEach(zone => prevZones.add(zone));\n      });\n    };\n  })();\n}\n","import {\n  getCurrentAudioSettings,\n  shouldAddSupplementaryAttenuation,\n  updateAudioSettings\n} from \"../update-audio-settings\";\n\nconst distanceModels = {\n  linear: function(distance, rolloffFactor, refDistance, maxDistance) {\n    return 1.0 - rolloffFactor * ((distance - refDistance) / (maxDistance - refDistance));\n  },\n  inverse: function(distance, rolloffFactor, refDistance) {\n    return refDistance / (refDistance + rolloffFactor * (Math.max(distance, refDistance) - refDistance));\n  },\n  exponential: function(distance, rolloffFactor, refDistance) {\n    return Math.pow(Math.max(distance, refDistance) / refDistance, -rolloffFactor);\n  }\n};\n\nconst calculateAttenuation = (() => {\n  const listenerPos = new THREE.Vector3();\n  const sourcePos = new THREE.Vector3();\n  return (el, audio) => {\n    el.sceneEl.audioListener.getWorldPosition(listenerPos);\n    audio.getWorldPosition(sourcePos);\n    const distance = sourcePos.distanceTo(listenerPos);\n    if (audio.panner) {\n      return distanceModels[audio.panner.distanceModel](\n        distance,\n        audio.panner.rolloffFactor,\n        audio.panner.refDistance,\n        audio.panner.maxDistance\n        // TODO: Why are coneInnerAngle, coneOuterAngle and coneOuterGain not used?\n      );\n    } else {\n      const { distanceModel, rolloffFactor, refDistance, maxDistance } = getCurrentAudioSettings(el);\n      if (!distanceModel) {\n        // Apparently, it is valid to give null as your distanceModel\n        return 1.0;\n      }\n      if (!distanceModels[distanceModel]) {\n        // TODO: Validate properties earlier in the process.\n        console.error(\"Unrecognized distance model.\");\n        return 1.0;\n      }\n\n      return distanceModels[distanceModel](distance, rolloffFactor, refDistance, maxDistance);\n    }\n  };\n})();\n\n// TODO: Rename \"GainSystem\" because the name is suspicious\nexport class GainSystem {\n  tick() {\n    const { enableAudioClipping, audioClippingThreshold } = window.APP.store.state.preferences;\n    for (const [el, audio] of APP.audios.entries()) {\n      const attenuation = calculateAttenuation(el, audio);\n\n      if (shouldAddSupplementaryAttenuation(el, audio)) {\n        APP.supplementaryAttenuation.set(el, attenuation);\n        updateAudioSettings(el, audio);\n      } else if (APP.supplementaryAttenuation.has(el)) {\n        APP.supplementaryAttenuation.delete(el);\n        updateAudioSettings(el, audio);\n      }\n\n      const isClipped = APP.clippingState.has(el);\n      const shouldBeClipped = enableAudioClipping && attenuation < audioClippingThreshold;\n      if (isClipped !== shouldBeClipped) {\n        if (shouldBeClipped) {\n          APP.clippingState.add(el);\n        } else {\n          APP.clippingState.delete(el);\n        }\n        updateAudioSettings(el, audio);\n      }\n    }\n  }\n}\n","import { GUI } from \"three/examples/jsm/libs/lil-gui.module.min\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nimport { LUTCubeLoader } from \"three/examples/jsm/loaders/LUTCubeLoader\";\nimport blenderLutPath from \"../assets/blender-lut.cube\";\n\nconst toneMappingOptions = {\n  None: \"NoToneMapping\",\n  Linear: \"LinearToneMapping\",\n  Reinhard: \"ReinhardToneMapping\",\n  Cineon: \"CineonToneMapping\",\n  ACESFilmic: \"ACESFilmicToneMapping\",\n  CustomToneMapping: \"CustomToneMapping\",\n  LUTToneMapping: \"LUTToneMapping\"\n};\n\nconst outputEncodingOptions = {\n  LinearEncoding: \"LinearEncoding\",\n  sRGBEncoding: \"sRGBEncoding\",\n  GBEEncoding: \"GBEEncoding\",\n  GBM7Encoding: \"GBM7Encoding\",\n  GBDEncoding: \"GBDEncoding\",\n  BasicDepthPacking: \"BasicDepthPacking\",\n  GBADepthPacking: \"GBADepthPackig\"\n};\n\nconst defaultEnvSettings = {\n  toneMapping: toneMappingOptions.Linear,\n  outputEncoding: outputEncodingOptions.sRGBEncoding,\n  toneMappingExposure: 1,\n  physicallyCorrectLights: true,\n  envMapTexture: null,\n  backgroundTexture: null,\n  backgroundColor: new THREE.Color(\"#000000\"),\n\n  fogType: null,\n  fogColor: new THREE.Color(\"#ffffff\"),\n  fogDensity: 0.00025,\n  fogFar: 1000,\n  fogNear: 1\n};\n\nlet blenderLUTPromise; // lazy loaded\n\nexport class EnvironmentSystem {\n  constructor(sceneEl) {\n    this.scene = sceneEl.object3D;\n    this.renderer = sceneEl.renderer;\n\n    this.pmremGenerator = new THREE.PMREMGenerator(this.renderer);\n\n    this.applyEnvSettings(defaultEnvSettings);\n\n    if (qsTruthy(\"envSettingsDebug\")) {\n      this.setupDebugView();\n    }\n  }\n\n  setupDebugView() {\n    const debugSettings = { ...defaultEnvSettings };\n\n    const updateDebug = () => {\n      this.applyEnvSettings(debugSettings);\n    };\n\n    const gui = new GUI();\n    gui\n      .add(debugSettings, \"toneMapping\", Object.values(toneMappingOptions))\n      .onChange(updateDebug)\n      .listen();\n    gui\n      .add(debugSettings, \"toneMappingExposure\", 0, 4, 0.01)\n      .onChange(updateDebug)\n      .listen();\n    gui\n      .add(debugSettings, \"outputEncoding\", Object.values(outputEncodingOptions))\n      .onChange(updateDebug)\n      .listen();\n    gui\n      .add(debugSettings, \"physicallyCorrectLights\", true)\n      .onChange(updateDebug)\n      .listen();\n    gui.open();\n\n    this.debugGui = gui;\n    this.debugSettings = debugSettings;\n    this.debugMode = true;\n\n    window.$E = this;\n  }\n\n  updateEnvironment(envEl) {\n    const envSettingsEl = envEl.querySelector(\"[environment-settings]\");\n    const skyboxEl = envEl.querySelector(\"[skybox]\");\n    const navmeshEl = envEl.querySelector(\"[nav-mesh]\");\n\n    const envSettings = {\n      ...defaultEnvSettings,\n      skybox: skyboxEl?.components[\"skybox\"]\n    };\n\n    if (envSettingsEl) {\n      Object.assign(envSettings, envSettingsEl.components[\"environment-settings\"].data);\n    }\n\n    const navMesh = navmeshEl?.object3D.getObjectByProperty(\"isMesh\", true);\n    if (navMesh) {\n      AFRAME.scenes[0].systems.nav.loadMesh(navMesh, navmeshEl.components[\"nav-mesh\"].data.zone);\n    }\n\n    // TODO animated objects should not be static\n    envEl.object3D.traverse(o => {\n      if (o.isMesh) {\n        o.reflectionProbeMode = \"static\";\n      }\n    });\n\n    this.applyEnvSettings(envSettings);\n  }\n\n  applyEnvSettings(settings) {\n    if (this.debugSettings) {\n      Object.assign(this.debugSettings, settings);\n    }\n\n    let materialsNeedUpdate = false;\n\n    if (this.debugMode) console.log(\"Applying environment settings\", settings);\n\n    if (this.renderer.physicallyCorrectLights !== settings.physicallyCorrectLights) {\n      this.renderer.physicallyCorrectLights = settings.physicallyCorrectLights;\n      materialsNeedUpdate = true;\n    }\n\n    const newToneMapping = THREE[settings.toneMapping];\n    if (this.renderer.toneMapping !== newToneMapping) {\n      this.renderer.toneMapping = newToneMapping;\n      materialsNeedUpdate = true;\n\n      // TODO clean up async behavior\n      if (newToneMapping === THREE.LUTToneMapping) {\n        if (!blenderLUTPromise) {\n          blenderLUTPromise = new Promise(function(resolve, reject) {\n            new LUTCubeLoader().load(blenderLutPath, ({ texture3D }) => resolve(texture3D), null, reject);\n          });\n        }\n\n        blenderLUTPromise\n          .then(t => {\n            this.renderer.tonemappingLUT = t;\n          })\n          .catch(function(e) {\n            console.error(\"Error loading Blender LUT\", e);\n            blenderLUTPromise = null;\n          });\n      } else {\n        this.renderer.tonemappingLUT = null;\n      }\n    }\n\n    this.renderer.toneMappingExposure = settings.toneMappingExposure;\n\n    const newOutputEncoding = THREE[settings.outputEncoding];\n    if (this.renderer.outputEncoding !== newOutputEncoding) {\n      this.renderer.outputEncoding = newOutputEncoding;\n      materialsNeedUpdate = true;\n    }\n\n    this.scene.remove(window.lp);\n\n    if (settings.backgroundTexture) {\n      // Assume texture is always an equirect for now\n      settings.backgroundTexture.mapping = THREE.EquirectangularReflectionMapping;\n      this.scene.background = settings.backgroundTexture;\n    } else {\n      this.scene.background = settings.backgroundColor;\n    }\n\n    if (settings.envMapTexture) {\n      if (this.prevEnvMapTextureUUID !== settings.envMapTexture.uuid) {\n        this.prevEnvMapTextureUUID = settings.envMapTexture.uuid;\n        // TODO PMREMGenerator should be fixed to not assume this\n        settings.envMapTexture.flipY = true;\n        // Assume texture is always an equirect for now\n        settings.envMapTexture.mapping = THREE.EquirectangularReflectionMapping;\n        this.scene.environment = settings.envMapTexture;\n      }\n    } else if (settings.skybox) {\n      if (this.prevEnvMapTextureUUID !== settings.skybox.uuid) {\n        this.prevEnvMapTextureUUID = settings.skybox.uuid;\n        this.scene.environment = settings.skybox.sky.generateEnvironmentMap(this.renderer);\n      }\n    } else {\n      this.scene.environment = null;\n      this.prevEnvMapTextureUUID = null;\n    }\n\n    if (this.scene.fog?.name !== settings.fogType) {\n      if (settings.fogType === \"linear\") {\n        this.scene.fog = new THREE.Fog(settings.fogColor, settings.fogNear, settings.fogFar);\n      } else if (settings.fogType === \"exponential\") {\n        this.scene.fog = new THREE.FogExp2(settings.fogColor, settings.fogDensity);\n      } else {\n        this.scene.fog = null;\n      }\n      materialsNeedUpdate = true;\n    } else if (settings.fogType) {\n      this.scene.fog.color.copy(settings.fogColor);\n      if (settings.fogType === \"linear\") {\n        this.scene.fog.near = settings.fogNear;\n        this.scene.fog.far = settings.fogFar;\n      } else if (settings.fogType === \"exponential\") {\n        this.scene.fog.density = settings.fogDensity;\n      }\n    }\n\n    if (materialsNeedUpdate) {\n      if (this.debugMode) console.log(\"materials need updating\");\n      this.scene.traverse(o => {\n        if (o.material) o.material.needsUpdate = true;\n      });\n    }\n  }\n}\n\nAFRAME.registerComponent(\"nav-mesh\", {\n  schema: {\n    zone: { default: \"character\" }\n  }\n});\n\nAFRAME.registerComponent(\"environment-settings\", {\n  schema: {\n    toneMapping: { default: defaultEnvSettings.toneMapping, oneOf: Object.values(toneMappingOptions) },\n    toneMappingExposure: { default: defaultEnvSettings.toneMappingExposure },\n    backgroundColor: { type: \"color\", default: defaultEnvSettings.background },\n\n    fogType: { type: \"string\", default: defaultEnvSettings.fogType },\n    fogColor: { type: \"color\", default: defaultEnvSettings.fogColor },\n    fogDensity: { type: \"number\", default: defaultEnvSettings.fogDensity },\n    fogNear: { type: \"number\", default: defaultEnvSettings.forNear },\n    fogFar: { type: \"number\", default: defaultEnvSettings.fogFar }\n  }\n});\n\nAFRAME.registerComponent(\"reflection-probe\", {\n  schema: {\n    size: { default: 1 },\n    envMapTexture: { type: \"map\" }\n  },\n\n  init: function() {\n    this.el.object3D.updateMatrices();\n\n    const box = new THREE.Box3()\n      .setFromCenterAndSize(new THREE.Vector3(), new THREE.Vector3().setScalar(this.data.size * 2))\n      .applyMatrix4(this.el.object3D.matrixWorld);\n\n    this.el.setObject3D(\"probe\", new THREE.ReflectionProbe(box, this.data.envMapTexture));\n\n    if (this.el.sceneEl.systems[\"hubs-systems\"].environmentSystem.debugMode) {\n      const debugBox = new THREE.Box3().setFromCenterAndSize(\n        new THREE.Vector3(),\n        new THREE.Vector3().setScalar(this.data.size * 2)\n      );\n      this.el.setObject3D(\n        \"helper\",\n        new THREE.Box3Helper(debugBox, new THREE.Color(Math.random(), Math.random(), Math.random()))\n      );\n    }\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nexport class NameTagVisibilitySystem {\n  constructor(sceneEl) {\n    this.sceneEl = sceneEl;\n    this.store = window.APP.store;\n    this.components = [];\n    this.lastUpdateTime = Date.now();\n    this.tick = this.tick.bind(this);\n    this.onStateChanged = this.onStateChanged.bind(this);\n    this.nametagVisibility = this.store.state.preferences.nametagVisibility;\n    this.nametagVisibilityDistance = Math.pow(this.store.state.preferences.nametagVisibilityDistance, 2);\n    waitForDOMContentLoaded().then(() => {\n      this.avatarRig = document.getElementById(\"avatar-rig\").object3D;\n    });\n    window.APP.store.addEventListener(\"statechanged\", this.onStateChanged);\n  }\n\n  register(component) {\n    this.components.push(component);\n  }\n\n  unregister(component) {\n    this.components.splice(this.components.indexOf(component), 1);\n  }\n\n  tick = (function() {\n    const worldPos = new THREE.Vector3();\n    const avatarRigWorldPos = new THREE.Vector3();\n    return function tick() {\n      this.avatarRig.getWorldPosition(avatarRigWorldPos);\n      this.components.forEach(nametag => {\n        if (this.nametagVisibility === \"showSpeaking\") {\n          const now = Date.now();\n          if (!nametag.isTalking && nametag.wasTalking) {\n            if (now - nametag.lastUpdateTime > 3000) {\n              nametag.shouldBeVisible = false;\n            }\n          } else if (nametag.isTalking && !nametag.wasTalking) {\n            nametag.lastUpdateTime = Date.now();\n            nametag.shouldBeVisible = true;\n          } else if (!nametag.isTalking && !nametag.wasTalking) {\n            if (now - nametag.lastUpdateTime > 3000) {\n              nametag.shouldBeVisible = false;\n            }\n          }\n        } else if (this.nametagVisibility === \"showFrozen\") {\n          nametag.shouldBeVisible = this.sceneEl.is(\"frozen\");\n        } else if (this.nametagVisibility === \"showNone\") {\n          nametag.shouldBeVisible = false;\n        } else if (this.nametagVisibility === \"showClose\") {\n          if (nametag.ikRoot) {\n            nametag.ikRoot.getWorldPosition(worldPos);\n            nametag.shouldBeVisible = worldPos.sub(avatarRigWorldPos).lengthSq() < this.nametagVisibilityDistance;\n          }\n        } else {\n          nametag.shouldBeVisible = true;\n        }\n      });\n    };\n  })();\n\n  onStateChanged() {\n    this.nametagVisibilityDistance = Math.pow(this.store.state.preferences.nametagVisibilityDistance, 2);\n    this.nametagVisibility = this.store.state.preferences.nametagVisibility;\n  }\n}\n","const UNOWNED_INTERACTABLE = require(\"../constants\").COLLISION_LAYERS.UNOWNED_INTERACTABLE;\nimport { exitQuery, defineQuery, removeComponent, hasComponent, entityExists } from \"bitecs\";\nimport {\n  Held,\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  Owned,\n  Rigidbody\n} from \"../bit-components\";\n\n// TODO this seems wrong, nothing sets it back unless its a floaty object\nconst exitOwned = exitQuery(defineQuery([Owned]));\nconst componentsToRemove = [Held, HeldHandRight, HeldHandLeft, HeldRemoteRight, HeldRemoteLeft];\nconst kinematicOptions = { type: \"kinematic\", collisionFilterMask: UNOWNED_INTERACTABLE };\nexport function onOwnershipLost(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  const entities = exitOwned(world);\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    if (!entityExists(world, eid)) continue;\n    for (let j = 0; j < componentsToRemove.length; j++) {\n      const component = componentsToRemove[j];\n      removeComponent(world, component, eid);\n    }\n\n    if (hasComponent(world, Rigidbody, eid)) {\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], kinematicOptions);\n    }\n  }\n}\n","import { addComponent, defineQuery, hasComponent, removeComponent } from \"bitecs\";\nimport { HandCollisionTarget, HoveredHandLeft, HoveredHandRight, Rigidbody } from \"../bit-components\";\n\nfunction findHandCollisionTargetForHand(world, hand) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n\n  // TODO physics system init is async so these don't get created right away.. They probably can be\n  if (!hasComponent(world, Rigidbody, hand)) return;\n\n  const handCollisions = physicsSystem.getCollisions(Rigidbody.bodyId[hand]);\n  if (handCollisions) {\n    for (let i = 0; i < handCollisions.length; i++) {\n      const bodyData = physicsSystem.bodyUuidToData.get(handCollisions[i]);\n      const object3D = bodyData && bodyData.object3D;\n      if (object3D && hasComponent(world, HandCollisionTarget, object3D.eid)) {\n        return object3D.eid;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction hoverHand(world, interactor, hoveredQuery, Component) {\n  hoveredQuery(world).forEach(eid => removeComponent(world, Component, eid));\n  const collision = findHandCollisionTargetForHand(world, interactor);\n  if (collision) addComponent(world, Component, collision);\n}\n\nconst leftHandHoveredQuery = defineQuery([HoveredHandLeft]);\nconst rightHandHoveredQuery = defineQuery([HoveredHandRight]);\nexport function handHoverSystem(world, legacyInteractionSystem) {\n  const interactorSettings = legacyInteractionSystem.options;\n  hoverHand(world, interactorSettings.leftHand.entity.object3D.eid, leftHandHoveredQuery, HoveredHandLeft);\n  hoverHand(world, interactorSettings.rightHand.entity.object3D.eid, rightHandHoveredQuery, HoveredHandRight);\n}\n","import { paths } from \"./userinput/paths\";\nimport { addComponent, removeComponent, defineQuery, hasComponent } from \"bitecs\";\nimport {\n  Held,\n  Holdable,\n  Pinned,\n  HoveredRemoteRight,\n  HeldRemoteRight,\n  HoveredRemoteLeft,\n  HeldRemoteLeft,\n  HoveredHandRight,\n  HeldHandRight,\n  HoveredHandLeft,\n  HeldHandLeft,\n  AEntity\n} from \"../bit-components\";\nimport { canMove } from \"../utils/permissions-utils\";\n\nconst GRAB_REMOTE_RIGHT = paths.actions.cursor.right.grab;\nconst DROP_REMOTE_RIGHT = paths.actions.cursor.right.drop;\nconst GRAB_REMOTE_LEFT = paths.actions.cursor.left.grab;\nconst DROP_REMOTE_LEFT = paths.actions.cursor.left.drop;\nconst GRAB_HAND_RIGHT = paths.actions.rightHand.grab;\nconst DROP_HAND_RIGHT = paths.actions.rightHand.drop;\nconst GRAB_HAND_LEFT = paths.actions.leftHand.grab;\nconst DROP_HAND_LEFT = paths.actions.leftHand.drop;\n\nfunction hasPermissionToGrab(world, eid) {\n  if (!hasComponent(world, AEntity, eid)) return true;\n  return canMove(world.eid2obj.get(eid).el);\n}\n\nfunction grab(world, userinput, queryHovered, held, grabPath) {\n  const hovered = queryHovered(world)[0];\n  if (\n    hovered &&\n    userinput.get(grabPath) &&\n    (!hasComponent(world, Pinned, hovered) || AFRAME.scenes[0].is(\"frozen\")) &&\n    hasPermissionToGrab(world, hovered)\n  ) {\n    addComponent(world, held, hovered);\n    addComponent(world, Held, hovered);\n  }\n}\n\nfunction drop(world, userinput, queryHeld, held, dropPath) {\n  const heldEid = queryHeld(world)[0];\n  if (heldEid && userinput.get(dropPath)) {\n    // TODO: Drop on ownership lost\n    removeComponent(world, held, heldEid);\n\n    if (\n      !hasComponent(world, HeldRemoteRight, heldEid) &&\n      !hasComponent(world, HeldRemoteLeft, heldEid) &&\n      !hasComponent(world, HeldHandRight, heldEid) &&\n      !hasComponent(world, HeldHandLeft, heldEid)\n    ) {\n      removeComponent(world, Held, heldEid);\n    }\n  }\n}\n\nconst queryHeldRemoteRight = defineQuery([Holdable, HeldRemoteRight]);\nconst queryHoveredRemoteRight = defineQuery([Holdable, HoveredRemoteRight]);\n\nconst queryHeldRemoteLeft = defineQuery([Holdable, HeldRemoteLeft]);\nconst queryHoveredRemoteLeft = defineQuery([Holdable, HoveredRemoteLeft]);\n\nconst queryHeldHandRight = defineQuery([Holdable, HeldHandRight]);\nconst queryHoveredHandRight = defineQuery([Holdable, HoveredHandRight]);\n\nconst queryHeldHandLeft = defineQuery([Holdable, HeldHandLeft]);\nconst queryHoveredHandLeft = defineQuery([Holdable, HoveredHandLeft]);\n\nexport function holdSystem(world, userinput) {\n  grab(world, userinput, queryHoveredRemoteRight, HeldRemoteRight, GRAB_REMOTE_RIGHT);\n  grab(world, userinput, queryHoveredRemoteLeft, HeldRemoteLeft, GRAB_REMOTE_LEFT);\n  grab(world, userinput, queryHoveredHandRight, HeldHandRight, GRAB_HAND_RIGHT);\n  grab(world, userinput, queryHoveredHandLeft, HeldHandLeft, GRAB_HAND_LEFT);\n\n  drop(world, userinput, queryHeldRemoteRight, HeldRemoteRight, DROP_REMOTE_RIGHT);\n  drop(world, userinput, queryHeldRemoteLeft, HeldRemoteLeft, DROP_REMOTE_LEFT);\n  drop(world, userinput, queryHeldHandRight, HeldHandRight, DROP_HAND_RIGHT);\n  drop(world, userinput, queryHeldHandLeft, HeldHandLeft, DROP_HAND_LEFT);\n}\n","import { defineQuery, removeComponent } from \"bitecs\";\nimport {\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredRemoteRight,\n  HoveredRemoteLeft,\n  HoveredHandRight,\n  HoveredHandLeft\n} from \"../bit-components\";\n\nfunction removeHover(world, entities, component) {\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    removeComponent(world, component, eid);\n  }\n}\n\nconst queryRemoteRight = defineQuery([HoveredRemoteRight, HeldRemoteRight]);\nconst queryRemoteLeft = defineQuery([HoveredRemoteLeft, HeldRemoteLeft]);\nconst queryHandRight = defineQuery([HoveredHandRight, HeldHandRight]);\nconst queryHandLeft = defineQuery([HoveredHandLeft, HeldHandLeft]);\nexport function dontHoverAndHold(world) {\n  removeHover(world, queryRemoteRight(world), HoveredRemoteRight);\n  removeHover(world, queryRemoteLeft(world), HoveredRemoteLeft);\n  removeHover(world, queryHandRight(world), HoveredHandRight);\n  removeHover(world, queryHandLeft(world), HoveredHandLeft);\n}\n\nconst queryDoubleHeldRight = defineQuery([HeldHandRight, HeldRemoteRight]);\nconst queryDoubleHeldLeft = defineQuery([HeldHandLeft, HeldRemoteLeft]);\nconst queryDoubleHoverRight = defineQuery([HoveredHandRight, HoveredRemoteRight]);\nconst queryDoubleHoverLeft = defineQuery([HoveredHandLeft, HoveredRemoteLeft]);\nexport function dontHoldWithHandAndRemote(world) {\n  queryDoubleHeldLeft(world).forEach(eid => removeComponent(world, HeldRemoteLeft, eid));\n  queryDoubleHeldRight(world).forEach(eid => removeComponent(world, HeldRemoteRight, eid));\n  // TODO this may not be needed because of CursorTogglingSystem\n  queryDoubleHoverLeft(world).forEach(eid => removeComponent(world, HoveredRemoteLeft, eid));\n  queryDoubleHoverRight(world).forEach(eid => removeComponent(world, HoveredRemoteRight, eid));\n}\n","import { removeNetworkedObject } from \"../utils/removeNetworkedObject\";\nimport { findAncestorWithComponent } from \"../utils/scene-graph\";\nimport { defineQuery } from \"bitecs\";\nimport { Interacted, RemoveNetworkedEntityButton } from \"../bit-components\";\n\nconst query = defineQuery([RemoveNetworkedEntityButton, Interacted]);\n\nexport function removeNetworkedObjectButtonSystem(world) {\n  const ents = query(world);\n  for (let i = 0; i < ents.length; i++) {\n    const eid = ents[i];\n    const button = world.eid2obj.get(eid);\n    const networkedEntity = findAncestorWithComponent(button.el, \"networked\");\n    removeNetworkedObject(networkedEntity.sceneEl, networkedEntity);\n    button.parent.visible = false;\n  }\n}\n","import { defineQuery, exitQuery, removeEntity } from \"bitecs\";\nimport { GLTFModel, MediaFrame, Object3DTag, Slice9, Text } from \"../bit-components\";\nimport { gltfCache } from \"../components/gltf-model-plus\";\n\nfunction cleanupObjOnExit(Component, f) {\n  const query = exitQuery(defineQuery([Component]));\n  return function(world) {\n    query(world).forEach(eid => f(world.eid2obj.get(eid)));\n  };\n}\n\n// NOTE we don't dispose of slice9's textures here, its non trivial since they are shared.\n// We want to keep them loaded anyway since we only have a few and want them to load instantly.\nconst cleanupSlice9s = cleanupObjOnExit(Slice9, obj => obj.geometry.dispose());\nconst cleanupGLTFs = cleanupObjOnExit(GLTFModel, obj => gltfCache.release(obj.userData.gltfSrc));\nconst cleanupTexts = cleanupObjOnExit(Text, obj => obj.dispose());\nconst cleanupMediaFrames = cleanupObjOnExit(MediaFrame, obj => obj.geometry.dispose());\n\n// TODO This feels messy and brittle\n//\n// This makes the assumption that we will not explicitly remove Object3DTag components.\n// Instead, they will only be removed when we call removeEntity.\n//\n// When we remove an entity with an Object3DTag:\n// - The associated object3D will be removed from the scene graph.\n// - The rest of the scene graph will be left intact.\n// - We will call removeEntity for all entities associated with the object3D's descendants.\n// - The descendants won't be removed from their parents.\n//\n// TODO AFRAME entities get cleaned up in an an odd way:\n//      When we remove an AFRAME entity, AFRAME will call `removeEntity` for all of its descendants,\n//      which means we will remove each descendent from its parent.\nconst exitedObject3DQuery = exitQuery(defineQuery([Object3DTag]));\nexport function removeObject3DSystem(world) {\n  function removeFromMap(eid) {\n    const o = world.eid2obj.get(eid);\n    world.eid2obj.delete(eid);\n    o.eid = null;\n  }\n\n  // remove entities that are children of any removed entities\n  const entities = exitedObject3DQuery(world);\n  entities.forEach(eid => {\n    const obj = world.eid2obj.get(eid);\n    obj.traverse(o => o.eid && removeEntity(world, o.eid));\n    obj.removeFromParent();\n  });\n\n  // cleanup any component specific resources\n  cleanupGLTFs(world);\n  cleanupSlice9s(world);\n  cleanupTexts(world);\n  cleanupMediaFrames(world);\n\n  // Finally remove all the entities we just removed from the eid2obj map\n  entities.forEach(removeFromMap);\n  exitedObject3DQuery(world).forEach(removeFromMap);\n}\n","import { defineQuery, hasComponent } from \"bitecs\";\nimport { NetworkedTransform, Owned } from \"../bit-components\";\n\nconst query = defineQuery([NetworkedTransform]);\n\nconst tmpVec = new THREE.Vector3();\nconst tmpQuat = new THREE.Quaternion();\nexport function networkedTransformSystem(world) {\n  const ents = query(world);\n  for (let i = 0; i < ents.length; i++) {\n    const eid = ents[i];\n    const obj = world.eid2obj.get(eid);\n    if (hasComponent(world, Owned, eid)) {\n      tmpVec.fromArray(NetworkedTransform.position[eid]);\n      if (!tmpVec.near(obj.position, 0.001)) {\n        obj.position.toArray(NetworkedTransform.position[eid]);\n      }\n      tmpQuat.fromArray(NetworkedTransform.rotation[eid]);\n      // TODO does it even make sense to check \"near\" in this way?\n      if (!tmpQuat.near(obj.quaternion, 0.001)) {\n        obj.quaternion.toArray(NetworkedTransform.rotation[eid]);\n      }\n      tmpVec.fromArray(NetworkedTransform.scale[eid]);\n      if (!tmpVec.near(obj.scale, 0.001)) {\n        obj.scale.toArray(NetworkedTransform.scale[eid]);\n      }\n    } else {\n      tmpVec.fromArray(NetworkedTransform.position[eid]);\n      if (!tmpVec.near(obj.position)) {\n        obj.position.copy(tmpVec);\n        obj.matrixNeedsUpdate = true;\n      }\n\n      tmpQuat.fromArray(NetworkedTransform.rotation[eid]);\n      if (!tmpQuat.near(obj.quaternion)) {\n        obj.quaternion.copy(tmpQuat);\n        obj.matrixNeedsUpdate = true;\n      }\n\n      tmpVec.fromArray(NetworkedTransform.scale[eid]);\n      if (!tmpVec.near(obj.scale)) {\n        obj.scale.copy(tmpVec);\n        obj.matrixNeedsUpdate = true;\n      }\n    }\n  }\n}\n\n// TODO lerping\n","import { anyEntityWith } from \"../utils/bit-utils\";\nimport { CONSTANTS } from \"three-ammo\";\nconst { DISABLE_DEACTIVATION, ACTIVE_TAG } = CONSTANTS.ACTIVATION_STATE;\n\nimport { defineQuery, enterQuery, entityExists, exitQuery, hasComponent } from \"bitecs\";\nimport {\n  RemoteRight,\n  RemoteLeft,\n  HandRight,\n  HandLeft,\n  HeldRemoteRight,\n  HeldRemoteLeft,\n  HeldHandRight,\n  HeldHandLeft,\n  OffersHandConstraint,\n  OffersRemoteConstraint,\n  Rigidbody\n} from \"../bit-components\";\nimport { takeOwnership } from \"./netcode\";\n\nconst queryRemoteRight = defineQuery([HeldRemoteRight, OffersRemoteConstraint, Rigidbody]);\nconst queryEnterRemoteRight = enterQuery(queryRemoteRight);\nconst queryExitRemoteRight = exitQuery(queryRemoteRight);\n\nconst queryRemoteLeft = defineQuery([HeldRemoteLeft, OffersRemoteConstraint, Rigidbody]);\nconst queryEnterRemoteLeft = enterQuery(queryRemoteLeft);\nconst queryExitRemoteLeft = exitQuery(queryRemoteLeft);\n\nconst queryHandRight = defineQuery([HeldHandRight, OffersHandConstraint, Rigidbody]);\nconst queryEnterHandRight = enterQuery(queryHandRight);\nconst queryExitHandRight = exitQuery(queryHandRight);\n\nconst queryHandLeft = defineQuery([HeldHandLeft, OffersHandConstraint, Rigidbody]);\nconst queryEnterHandLeft = enterQuery(queryHandLeft);\nconst queryExitHandLeft = exitQuery(queryHandLeft);\n\nconst grabBodyOptions = { type: \"dynamic\", activationState: DISABLE_DEACTIVATION };\nconst releaseBodyOptions = { activationState: ACTIVE_TAG };\n\nfunction add(world, physicsSystem, interactor, entities) {\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    takeOwnership(world, eid);\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], grabBodyOptions);\n    physicsSystem.addConstraint(interactor, Rigidbody.bodyId[eid], Rigidbody.bodyId[interactor], {});\n  }\n}\n\nfunction remove(world, offersConstraint, physicsSystem, interactor, entities) {\n  for (let i = 0; i < entities.length; i++) {\n    const eid = entities[i];\n    if (!entityExists(world, eid)) continue;\n    if (hasComponent(world, offersConstraint, eid) && hasComponent(world, Rigidbody, eid)) {\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[eid], releaseBodyOptions);\n      physicsSystem.removeConstraint(interactor);\n    }\n  }\n}\n\nexport function constraintsSystem(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  add(world, physicsSystem, anyEntityWith(world, RemoteRight), queryEnterRemoteRight(world));\n  add(world, physicsSystem, anyEntityWith(world, RemoteLeft), queryEnterRemoteLeft(world));\n  add(world, physicsSystem, anyEntityWith(world, HandRight), queryEnterHandRight(world));\n  add(world, physicsSystem, anyEntityWith(world, HandLeft), queryEnterHandLeft(world));\n  remove(world, OffersRemoteConstraint, physicsSystem, anyEntityWith(world, RemoteRight), queryExitRemoteRight(world));\n  remove(world, OffersRemoteConstraint, physicsSystem, anyEntityWith(world, RemoteLeft), queryExitRemoteLeft(world));\n  remove(world, OffersHandConstraint, physicsSystem, anyEntityWith(world, HandRight), queryExitHandRight(world));\n  remove(world, OffersHandConstraint, physicsSystem, anyEntityWith(world, HandLeft), queryExitHandLeft(world));\n}\n","// https://dev.reticulum.io/scenes/7vGnzkM/outdoor-meetup\n// A scene with media-frames\n\nimport { addEntity, defineQuery, entityExists, hasComponent, removeEntity } from \"bitecs\";\nimport {\n  AEntity,\n  Held,\n  MediaFrame,\n  MediaLoading,\n  Networked,\n  NetworkedMediaFrame,\n  Owned,\n  Rigidbody\n} from \"../bit-components\";\nimport { addObject3DComponent } from \"../utils/jsx-entity\";\nimport { updateMaterials } from \"../utils/material-utils\";\nimport { MediaType } from \"../utils/media-utils\";\nimport { cloneObject3D, setMatrixWorld } from \"../utils/three-utils\";\nimport { takeOwnership } from \"./netcode\";\n\nconst EMPTY_COLOR = 0x6fc0fd;\nconst HOVER_COLOR = 0x2f80ed;\nconst FULL_COLOR = 0x808080;\n\nconst mediaFramesQuery = defineQuery([MediaFrame]);\n\n// TODO currently only aframe entiteis can be placed in media frames\nfunction mediaTypeMaskFor(world, eid) {\n  if (!hasComponent(world, AEntity, eid)) return 0;\n\n  const el = world.eid2obj.get(eid).el;\n  let mediaTypeMask = 0;\n  mediaTypeMask |= el.components[\"gltf-model-plus\"] && MediaType.MODEL;\n  mediaTypeMask |= el.components[\"media-video\"] && MediaType.VIDEO;\n  mediaTypeMask |= el.components[\"media-image\"] && MediaType.IMAGE;\n  mediaTypeMask |= el.components[\"media-pdf\"] && MediaType.PDF;\n  return mediaTypeMask;\n}\n\nfunction isAncestor(a, b) {\n  let ancestor = b.parent;\n  while (ancestor) {\n    if (ancestor === a) return true;\n    ancestor = ancestor.parent;\n  }\n  return false;\n}\n\nfunction inOtherFrame(world, ignoredFrame, eid) {\n  const frames = mediaFramesQuery(world);\n  for (const frame of frames) {\n    if (frame === ignoredFrame) continue;\n    if (MediaFrame.capturedNid[frame] === Networked.id[eid] || MediaFrame.previewingNid[frame] === Networked.id[eid])\n      return true;\n  }\n  return false;\n}\n\nfunction getCapturableEntity(world, frame) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  const collisions = physicsSystem.getCollisions(Rigidbody.bodyId[frame]);\n  const frameObj = world.eid2obj.get(frame);\n  for (let i = 0; i < collisions.length; i++) {\n    const bodyData = physicsSystem.bodyUuidToData.get(collisions[i]);\n    const eid = bodyData.object3D.eid;\n    if (\n      MediaFrame.mediaType[frame] & mediaTypeMaskFor(world, eid) &&\n      !hasComponent(world, MediaLoading, eid) &&\n      !inOtherFrame(world, frame, eid) &&\n      !isAncestor(bodyData.object3D, frameObj)\n    ) {\n      return eid;\n    }\n  }\n  return null;\n}\n\nfunction isColliding(world, eidA, eidB) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  const collisions = physicsSystem.getCollisions(Rigidbody.bodyId[eidA]);\n  for (let i = 0; i < collisions.length; i++) {\n    const bodyData = physicsSystem.bodyUuidToData.get(collisions[i]);\n    const collidedEid = bodyData && bodyData.object3D && bodyData.object3D.eid;\n    if (collidedEid === eidB) {\n      return true;\n    }\n  }\n  return false;\n}\n\nconst snapToFrame = (() => {\n  const framePos = new THREE.Vector3();\n  const frameQuat = new THREE.Quaternion();\n  const frameScale = new THREE.Vector3();\n  const m4 = new THREE.Matrix4();\n\n  function scaleForAspectFit(containerSize, itemSize) {\n    return Math.min(containerSize[0] / itemSize.x, containerSize[1] / itemSize.y, containerSize[2] / itemSize.z);\n  }\n\n  return function snapToFrame(world, frame, target) {\n    const frameObj = world.eid2obj.get(frame);\n    const targetObj = world.eid2obj.get(target);\n\n    frameObj.updateMatrices();\n    frameObj.matrixWorld.decompose(framePos, frameQuat, frameScale);\n\n    // TODO we only allow capturing media-loader so rely on its bounds calculations for now\n    const contentBounds = targetObj.el.components[\"media-loader\"].contentBounds;\n\n    setMatrixWorld(\n      targetObj,\n      m4.compose(\n        framePos,\n        frameQuat,\n        frameScale.multiplyScalar(scaleForAspectFit(MediaFrame.bounds[frame], contentBounds))\n      )\n    );\n  };\n})();\n\nfunction setMatrixScale(obj, scaleArray) {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n  const scale = new THREE.Vector3();\n  const m4 = new THREE.Matrix4();\n  obj.updateMatrices();\n  obj.matrixWorld.decompose(position, quaternion, scale);\n  setMatrixWorld(\n    obj,\n    m4.compose(\n      position,\n      quaternion,\n      scale.fromArray(scaleArray)\n    )\n  );\n}\n\nfunction cloneForPreview(world, eid) {\n  // TODO We assume capturable object is an AFRAME entity\n  const el = world.eid2obj.get(eid).el;\n  const mesh = el.getObject3D(\"mesh\");\n  const meshClone = cloneObject3D(mesh, false);\n  meshClone.traverse(node => {\n    updateMaterials(node, function(srcMat) {\n      const mat = srcMat.clone();\n      mat.transparent = true;\n      mat.opacity = 0.5;\n      mat.format = THREE.RGBAFormat;\n      mat.blending = THREE.NormalBlending;\n      node.material = mat;\n      return mat;\n    });\n  });\n\n  // TODO play animations on previews\n\n  // TODO HACK We add this mesh to a group whose position is centered\n  //      so that putting this in the middle of a media frame is easy,\n  //      but we should just do this math when putting an object into a frame\n  //      and not assume an object's root is in the center of its geometry.\n  meshClone.position.setScalar(0);\n  meshClone.quaternion.identity();\n  meshClone.matrixNeedsUpdate = true;\n  const aabb = new THREE.Box3().setFromObject(meshClone);\n  aabb.getCenter(meshClone.position).multiplyScalar(-1);\n  meshClone.matrixNeedsUpdate = true;\n\n  const cloneObj = new THREE.Group();\n  cloneObj.el = el; // We rely on media-loader component for bounds\n  cloneObj.add(meshClone);\n  AFRAME.scenes[0].object3D.add(cloneObj);\n\n  return addObject3DComponent(world, addEntity(world), cloneObj);\n}\n\nfunction showPreview(world, frame, capturable) {\n  const clone = cloneForPreview(world, capturable);\n  MediaFrame.preview[frame] = clone;\n  MediaFrame.previewingNid[frame] = Networked.id[capturable];\n  snapToFrame(world, frame, clone);\n}\n\nfunction hidePreview(world, frame) {\n  // NOTE we intentionally do not dispose of geometries or textures since they are all shared with the original object\n  removeEntity(world, MediaFrame.preview[frame]);\n  MediaFrame.preview[frame] = 0;\n  MediaFrame.previewingNid[frame] = 0;\n}\n\nconst zero = [0, 0, 0];\nconst tmpVec3 = new THREE.Vector3();\n\nexport function display(world, frame, heldMediaTypes) {\n  const capturable = !MediaFrame.capturedNid[frame] && getCapturableEntity(world, frame);\n  const shouldPreviewBeVisible = capturable && hasComponent(world, Held, capturable);\n  if (shouldPreviewBeVisible && !MediaFrame.preview[frame]) {\n    showPreview(world, frame, capturable);\n  } else if (!shouldPreviewBeVisible && MediaFrame.preview[frame]) {\n    hidePreview(world, frame);\n  }\n\n  const frameObj = world.eid2obj.get(frame);\n  frameObj.visible = !!(MediaFrame.mediaType[frame] & heldMediaTypes);\n\n  if (frameObj.visible) {\n    const captured = world.nid2eid.get(MediaFrame.capturedNid[frame]) || 0;\n    const isHoldingObjectOfInterest =\n      (captured && hasComponent(world, Held, captured)) || (capturable && hasComponent(world, Held, capturable));\n\n    frameObj.material.uniforms.color.value.set(\n      isHoldingObjectOfInterest ? HOVER_COLOR : MediaFrame.capturedNid[frame] ? FULL_COLOR : EMPTY_COLOR\n    );\n  }\n}\n\nfunction mediaTypesOf(world, entities) {\n  let mask = 0;\n  for (let i = 0; i < entities.length; i++) {\n    mask |= mediaTypeMaskFor(world, entities[i]);\n  }\n  return mask;\n}\n\nconst heldQuery = defineQuery([Held]);\n// const droppedQuery = exitQuery(heldQuery);\nexport function mediaFramesSystem(world) {\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  const heldMediaTypes = mediaTypesOf(world, heldQuery(world));\n  // const droppedEntities = droppedQuery(world).filter(eid => entityExists(world, eid));\n  const mediaFrames = mediaFramesQuery(world);\n\n  for (let i = 0; i < mediaFrames.length; i++) {\n    const frame = mediaFrames[i];\n\n    const captured = world.nid2eid.get(MediaFrame.capturedNid[frame]) || 0;\n    const colliding = captured && isColliding(world, frame, captured);\n\n    if (captured && hasComponent(world, Owned, captured) && !hasComponent(world, Held, captured) && colliding) {\n      snapToFrame(world, frame, captured);\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[captured], { type: \"kinematic\" });\n    } else if (\n      (hasComponent(world, Owned, frame) &&\n        MediaFrame.capturedNid[frame] &&\n        world.deletedNids.has(MediaFrame.capturedNid[frame])) ||\n      (captured && hasComponent(world, Owned, captured) && !colliding)\n    ) {\n      takeOwnership(world, frame);\n      NetworkedMediaFrame.capturedNid[frame] = 0;\n      NetworkedMediaFrame.scale[frame].set(zero);\n      // TODO BUG: If an entity I do not own is captured by the media frame,\n      //           and then I take ownership of the entity (by grabbing it),\n      //           the physics system does not immediately notice the entity colliding with the frame,\n      //           so I immediately think the frame should be emptied.\n    } else if (!NetworkedMediaFrame.capturedNid[frame]) {\n      const capturable = getCapturableEntity(world, frame);\n      if (\n        capturable &&\n        hasComponent(world, Owned, capturable) &&\n        !hasComponent(world, Held, capturable) &&\n        !inOtherFrame(world, frame, capturable)\n      ) {\n        takeOwnership(world, frame);\n        NetworkedMediaFrame.capturedNid[frame] = Networked.id[capturable];\n        const obj = world.eid2obj.get(capturable);\n        obj.updateMatrices();\n        tmpVec3.setFromMatrixScale(obj.matrixWorld).toArray(NetworkedMediaFrame.scale[frame]);\n        snapToFrame(world, frame, capturable);\n        physicsSystem.updateBodyOptions(Rigidbody.bodyId[capturable], { type: \"kinematic\" });\n      }\n    }\n\n    if (\n      NetworkedMediaFrame.capturedNid[frame] !== MediaFrame.capturedNid[frame] &&\n      (captured && entityExists(world, captured) && hasComponent(world, Owned, captured))\n    ) {\n      // TODO: If you are resetting scale because you lost a race for the frame,\n      //       you should probably also move the object away from the frame.\n      setMatrixScale(world.eid2obj.get(captured), MediaFrame.scale[frame]);\n      physicsSystem.updateBodyOptions(Rigidbody.bodyId[captured], { type: \"dynamic\" });\n    }\n\n    MediaFrame.capturedNid[frame] = NetworkedMediaFrame.capturedNid[frame];\n    MediaFrame.scale[frame].set(NetworkedMediaFrame.scale[frame]);\n\n    display(world, frame, heldMediaTypes);\n  }\n}\n","const { detect } = require(\"detect-browser\");\nconst browser = detect();\n\nconst isFirefox = browser.name === \"firefox\";\n\nconst supportsCaptureStreamTrack = typeof window.CanvasCaptureMediaStreamTrack !== \"undefined\";\n\nfunction blitFramebuffer(renderer, src, srcX0, srcY0, srcX1, srcY1, dest, dstX0, dstY0, dstX1, dstY1) {\n  const gl = renderer.getContext();\n\n  // Copies from one framebuffer to another. Note that at the end of this function, you need to restore\n  // the original framebuffer via setRenderTarget\n  const srcFramebuffer = renderer.properties.get(src).__webglFramebuffer;\n  const destFramebuffer = renderer.properties.get(dest).__webglFramebuffer;\n\n  if (srcFramebuffer && destFramebuffer) {\n    gl.bindFramebuffer(gl.READ_FRAMEBUFFER, srcFramebuffer);\n    gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, destFramebuffer);\n\n    if (gl.checkFramebufferStatus(gl.READ_FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n      gl.blitFramebuffer(srcX0, srcY0, srcX1, srcY1, dstX0, dstY0, dstX1, dstY1, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n    }\n  }\n}\nconst createBlankAudioTrack = () => {\n  const context = THREE.AudioContext.getContext();\n  const oscillator = context.createOscillator();\n  const gain = context.createGain();\n  const destination = context.createMediaStreamDestination();\n  gain.gain.setValueAtTime(0.0001, context.currentTime);\n  oscillator.connect(destination);\n  gain.connect(destination);\n  return destination.stream.getAudioTracks()[0];\n};\n\nexport class RenderTargetRecorder {\n  constructor(renderer, mimeType, captureWidth, captureHeight, fps, srcAudioTrack) {\n    this.renderer = renderer;\n\n    // Create a separate render target for video because we need to flip (and sometimes downscale) it before\n    // encoding it to video.\n    this.videoRenderTarget = new THREE.WebGLRenderTarget(captureWidth, captureHeight, {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n\n    const tmpRenderTarget = renderer.getRenderTarget();\n    // Used to set up framebuffer in three.js as a side effect\n    renderer.setRenderTarget(this.videoRenderTarget);\n    renderer.setRenderTarget(tmpRenderTarget);\n\n    const videoCanvas = document.createElement(\"canvas\");\n    videoCanvas.width = this.videoRenderTarget.width;\n    videoCanvas.height = this.videoRenderTarget.height;\n\n    this.videoContext = videoCanvas.getContext(\"2d\");\n    this.videoImageData = this.videoContext.createImageData(\n      this.videoRenderTarget.width,\n      this.videoRenderTarget.height\n    );\n    // this.videoPixels = new Uint8Array(captureWidth * captureHeight * 4);\n    // this.videoImageData.data.set(this.videoPixels);\n\n    const stream = videoCanvas.captureStream(supportsCaptureStreamTrack ? 0 : fps);\n    this.videoTrack = stream.getVideoTracks()[0];\n\n    if (srcAudioTrack) {\n      stream.addTrack(srcAudioTrack);\n    } else if (isFirefox) {\n      // FF 73+ seems to fail to decode videos with no audio track, so we always include a silent track.\n      // Chrome has issues when the audio tracks are silent so we only do this for FF.\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=1223382\n      stream.addTrack(createBlankAudioTrack());\n    }\n\n    this.mediaRecorder = new MediaRecorder(stream, { mimeType });\n  }\n\n  start() {\n    this.chunks = [];\n    this.mediaRecorder.ondataavailable = e => this.chunks.push(e.data);\n    this.mediaRecorder.start();\n  }\n\n  captureFrame(srcRenderTarget) {\n    blitFramebuffer(\n      this.renderer,\n      srcRenderTarget,\n      0,\n      0,\n      srcRenderTarget.width,\n      srcRenderTarget.height,\n      this.videoRenderTarget,\n      0,\n      this.videoRenderTarget.height,\n      this.videoRenderTarget.width,\n      0\n    );\n    this.renderer.readRenderTargetPixels(\n      this.videoRenderTarget,\n      0,\n      0,\n      this.videoRenderTarget.width,\n      this.videoRenderTarget.height,\n      this.videoImageData.data\n    );\n    // this.videoImageData.data.set(this.videoPixels);\n    this.videoContext.putImageData(this.videoImageData, 0, 0);\n    if (supportsCaptureStreamTrack) {\n      this.videoTrack.requestFrame();\n    }\n  }\n\n  save() {\n    return new Promise(resolve => {\n      this.mediaRecorder.onstop = () => {\n        const chunks = this.chunks;\n        if (chunks.length === 0) resolve(null);\n        const mimeType = chunks[0].type;\n        const blob = new Blob(chunks, { type: mimeType });\n        const file = new File([blob], \"capture\", { type: mimeType.split(\";\")[0] }); // Drop codec\n        chunks.length = 0;\n        resolve(file);\n      };\n      this.mediaRecorder.stop();\n    });\n  }\n\n  cancel() {\n    this.mediaRecorder.ondataavailable = null;\n    this.mediaRecorder.stop();\n    this.chunks.length = 0;\n  }\n}\n\nexport async function pixelsToPNG(pixels, width, height) {\n  const snapCanvas = document.createElement(\"canvas\");\n  snapCanvas.width = width;\n  snapCanvas.height = height;\n  const context = snapCanvas.getContext(\"2d\");\n\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(pixels);\n  const bitmap = await createImageBitmap(imageData);\n  context.scale(1, -1);\n  context.drawImage(bitmap, 0, -height);\n  const blob = await new Promise(resolve => snapCanvas.toBlob(resolve));\n  return new File([blob], \"snap.png\", { type: \"image/png\" });\n}\n","import { defineQuery, enterQuery, entityExists, exitQuery, hasComponent } from \"bitecs\";\nimport {\n  CameraTool,\n  Held,\n  HeldHandLeft,\n  HeldHandRight,\n  HeldRemoteLeft,\n  HeldRemoteRight,\n  HoveredRemoteRight,\n  Interacted,\n  RemoteRight,\n  Rigidbody,\n  TextButton\n} from \"../bit-components\";\nimport { addMedia } from \"../utils/media-utils\";\nimport { pixelsToPNG, RenderTargetRecorder } from \"../utils/render-target-recorder\";\nimport { isFacingCamera } from \"../utils/three-utils\";\nimport { SOUND_CAMERA_TOOL_COUNTDOWN, SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { ObjectTypes } from \"../object-types\";\nimport { anyEntityWith } from \"../utils/bit-utils\";\n\n// Prefer h264 if available due to faster decoding speec on most platforms\nconst videoCodec = [\"h264\", \"vp9,opus\", \"vp8,opus\", \"vp9\", \"vp8\"].find(\n  codec => window.MediaRecorder && MediaRecorder.isTypeSupported(`video/webm; codecs=${codec}`)\n);\nconst videoMimeType = videoCodec ? `video/webm; codecs=${videoCodec}` : null;\nconst hasWebGL2 = !!document.createElement(\"canvas\").getContext(\"webgl2\");\nconst allowVideo = !!videoMimeType && hasWebGL2;\n\nconst RENDER_WIDTH = 1280;\nconst RENDER_HEIGHT = 720;\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isOculusBrowser = navigator.userAgent.match(/Oculus/);\n// TODO ported from old camera system. Do we still want these restrictions?\nconst CAPTURE_WIDTH = isMobileVR && !isOculusBrowser ? 640 : 1280;\nconst CAPTURE_HEIGHT = isMobileVR && !isOculusBrowser ? 360 : 720;\n\nconst VIDEO_FPS = 25;\nconst VIEWFINDER_UPDATE_RATE = 1000 / 6;\nconst VIDEO_UPDATE_RATE = 1000 / VIDEO_FPS;\n\nconst CAMERA_STATE = {\n  IDLE: 0,\n  COUNTDOWN_PHOTO: 1,\n  COUNTDOWN_VIDEO: 2,\n  SNAP_PHOTO: 3,\n  RECORDING_VIDEO: 4\n};\n\nconst CAPTURE_DURATIONS = [3, 7, 15, 30, 60];\n\nconst renderTargets = new Map();\nconst videoRecorders = new Map();\nlet captureAudio = false;\n\nconst tmpVec3 = new THREE.Vector3();\n\nfunction clicked(eid) {\n  return hasComponent(APP.world, Interacted, eid);\n}\n\nfunction grabberPressedSnapAction(world, camera) {\n  const userinput = AFRAME.scenes[0].systems.userinput;\n  return (\n    (hasComponent(world, HeldRemoteLeft, camera) && userinput.get(paths.actions.cursor.left.takeSnapshot)) ||\n    (hasComponent(world, HeldRemoteRight, camera) && userinput.get(paths.actions.cursor.right.takeSnapshot)) ||\n    (hasComponent(world, HeldHandLeft, camera) && userinput.get(paths.actions.leftHand.takeSnapshot)) ||\n    (hasComponent(world, HeldHandRight, camera) && userinput.get(paths.actions.rightHand.takeSnapshot))\n    // userinput.get(paths.actions.takeSnapshot)\n  );\n}\n\nfunction spawnCameraFile(cameraObj, file, type) {\n  const opts = type === \"video\" ? { videoPaused: true } : {};\n  const { entity } = addMedia(file, \"#interactable-media\", undefined, `${type}-camera`, false, false, true, opts);\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      AFRAME.scenes[0].systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n      // TODO animate and orient around camera\n      entity.object3D.position.copy(cameraObj.localToWorld(new THREE.Vector3(0, -0.5, 0)));\n      entity.object3D.quaternion.copy(cameraObj.quaternion);\n      entity.object3D.matrixNeedsUpdate = true;\n      APP.hubChannel.sendMessage({ src: entity.components[\"media-loader\"].data.src }, type);\n      APP.hubChannel.sendObjectSpawnedEvent(ObjectTypes.CAMERA);\n    },\n    { once: true }\n  );\n}\n\nfunction createRecorder(captureAudio) {\n  let srcAudioTrack;\n  // NOTE: if we don't have a self audio track, we can end up generating an empty video (browser bug?)\n  // if no audio comes through on the listener source. (Eg the room is otherwise silent.)\n  // So for now, if we don't have a track, just disable audio capture.\n  if (captureAudio && APP.dialog._micProducer?.track) {\n    const context = THREE.AudioContext.getContext();\n    const destination = context.createMediaStreamDestination();\n    if (APP.audioListener) {\n      // NOTE audio is not captured from camera vantage point for now.\n      APP.audioListener.getInput().connect(destination);\n    }\n    context.createMediaStreamSource(new MediaStream([APP.dialog._micProducer?.track])).connect(destination);\n    srcAudioTrack = destination.stream.getAudioTracks()[0];\n  }\n\n  return new RenderTargetRecorder(\n    AFRAME.scenes[0].renderer,\n    videoMimeType,\n    CAPTURE_WIDTH,\n    CAPTURE_HEIGHT,\n    VIDEO_FPS,\n    srcAudioTrack\n  );\n}\n\nfunction endRecording(world, camera, cancel) {\n  const recorder = videoRecorders.get(camera);\n  if (cancel) {\n    recorder.cancel();\n  } else {\n    recorder.save().then(file => {\n      spawnCameraFile(world.eid2obj.get(camera), file, \"video\");\n    });\n  }\n  videoRecorders.delete(camera);\n  APP.hubChannel.endRecording();\n}\n\nfunction updateRenderTarget(world, camera) {\n  const sceneEl = AFRAME.scenes[0];\n  const renderer = AFRAME.scenes[0].renderer;\n\n  const tmpVRFlag = renderer.xr.enabled;\n  renderer.xr.enabled = false;\n\n  // TODO we are doing this because aframe uses this hook for tock.\n  // Namely to capture what camera was rendering. We don't actually use that in any of our tocks.\n  // Also tock can likely go away as a concept since we can just direclty order things after render in raf if we want to.\n  const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\n  delete sceneEl.object3D.onAfterRender;\n\n  // TODO this assumption is now not true since we are not running after render. We should probably just permentently turn of autoUpdate and run matrix updates at a point we wnat to.\n  // The entire scene graph matrices should already be updated\n  // in tick(). They don't need to be recomputed again in tock().\n  const tmpAutoUpdate = sceneEl.object3D.autoUpdate;\n  sceneEl.object3D.autoUpdate = false;\n\n  const bubbleSystem = AFRAME.scenes[0].systems[\"personal-space-bubble\"];\n  const boneVisibilitySystem = AFRAME.scenes[0].systems[\"hubs-systems\"].boneVisibilitySystem;\n\n  if (bubbleSystem) {\n    for (let i = 0, l = bubbleSystem.invaders.length; i < l; i++) {\n      bubbleSystem.invaders[i].disable();\n    }\n    // HACK, bone visibility typically takes a tick to update, but since we want to be able\n    // to have enable() and disable() be reflected this frame, we need to do it immediately.\n    boneVisibilitySystem.tick();\n    // scene.autoUpdate will be false so explicitly update the world matrices\n    boneVisibilitySystem.updateMatrices();\n  }\n\n  const renderTarget = renderTargets.get(camera);\n  renderTarget.needsUpdate = false;\n  renderTarget.lastUpdated = world.time.elapsed;\n\n  const tmpRenderTarget = renderer.getRenderTarget();\n  renderer.setRenderTarget(renderTarget);\n  renderer.render(sceneEl.object3D, world.eid2obj.get(CameraTool.cameraRef[camera]));\n  renderer.setRenderTarget(tmpRenderTarget);\n\n  renderer.xr.enabled = tmpVRFlag;\n  sceneEl.object3D.onAfterRender = tmpOnAfterRender;\n  sceneEl.object3D.autoUpdate = tmpAutoUpdate;\n\n  if (bubbleSystem) {\n    for (let i = 0, l = bubbleSystem.invaders.length; i < l; i++) {\n      bubbleSystem.invaders[i].enable();\n    }\n    // HACK, bone visibility typically takes a tick to update, but since we want to be able\n    // to have enable() and disable() be reflected this frame, we need to do it immediately.\n    boneVisibilitySystem.tick();\n    boneVisibilitySystem.updateMatrices();\n  }\n}\n\nfunction updateUI(world, camera) {\n  const snapMenuObj = world.eid2obj.get(CameraTool.snapMenuRef[camera]);\n  const snapBtnObj = world.eid2obj.get(CameraTool.snapRef[camera]);\n  const recBtnObj = world.eid2obj.get(CameraTool.recVideoRef[camera]);\n  const cancelBtnObj = world.eid2obj.get(CameraTool.cancelRef[camera]);\n  const nextBtnObj = world.eid2obj.get(CameraTool.button_next[camera]);\n  const prevBtnObj = world.eid2obj.get(CameraTool.button_prev[camera]);\n  const countdownLblObj = world.eid2obj.get(CameraTool.countdownLblRef[camera]);\n  const captureDurLblObj = world.eid2obj.get(CameraTool.captureDurLblRef[camera]);\n  const screenObj = world.eid2obj.get(CameraTool.screenRef[camera]);\n  const selfieScreenObj = world.eid2obj.get(CameraTool.selfieScreenRef[camera]);\n\n  const sndToggleBtnObj = world.eid2obj.get(CameraTool.sndToggleRef[camera]);\n  const sndToggleLblObj = world.eid2obj.get(TextButton.labelRef[CameraTool.sndToggleRef[camera]]);\n\n  const isIdle = CameraTool.state[camera] === CAMERA_STATE.IDLE;\n  const isCounting =\n    CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_PHOTO ||\n    CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_VIDEO ||\n    CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO;\n\n  const inVR = AFRAME.scenes[0].is(\"vr-mode\");\n  const showViewfinder = !inVR || (hasComponent(world, Held, camera) || !isIdle);\n  screenObj.visible = showViewfinder;\n  selfieScreenObj.visible = showViewfinder;\n\n  const playerInFrontOfCamera = isFacingCamera(world.eid2obj.get(camera));\n\n  const yRot = playerInFrontOfCamera ? 0 : Math.PI;\n  if (snapMenuObj.rotation.y !== yRot) {\n    snapMenuObj.rotation.y = yRot;\n    snapMenuObj.matrixNeedsUpdate = true;\n  }\n\n  snapBtnObj.visible = isIdle;\n\n  recBtnObj.visible = allowVideo && isIdle;\n  captureDurLblObj.visible = allowVideo && isIdle;\n  nextBtnObj.visible = allowVideo && isIdle;\n  prevBtnObj.visible = allowVideo && isIdle;\n  sndToggleBtnObj.visible = allowVideo && isIdle;\n\n  cancelBtnObj.visible = isCounting;\n  countdownLblObj.visible = isCounting;\n\n  if (countdownLblObj.visible) {\n    const timeLeftSec = Math.ceil((CameraTool.snapTime[camera] - world.time.elapsed) / 1000);\n    countdownLblObj.text = timeLeftSec;\n    countdownLblObj.sync(); // TODO this should probably happen in 1 spot per frame for all Texts\n  }\n\n  if (captureDurLblObj.visible) {\n    captureDurLblObj.text = CAPTURE_DURATIONS[CameraTool.captureDurIdx[camera]];\n    captureDurLblObj.sync(); // TODO this should probably happen in 1 spot per frame for all Texts\n  }\n\n  if (sndToggleBtnObj.visible) {\n    sndToggleLblObj.text = captureAudio ? \"Sound ON\" : \"Sound OFF\";\n    sndToggleLblObj.sync();\n  }\n\n  // TODO HACK hidden objects are still not having their matricies updated correctly\n  // Seems like a regression of #5421\n  snapMenuObj.matrixNeedsUpdate = true;\n}\n\nlet snapPixels;\nfunction captureSnapshot(world, camera) {\n  if (!snapPixels) {\n    snapPixels = new Uint8Array(RENDER_WIDTH * RENDER_HEIGHT * 4);\n  }\n  const renderer = AFRAME.scenes[0].renderer;\n  renderer.readRenderTargetPixels(renderTargets.get(camera), 0, 0, RENDER_WIDTH, RENDER_HEIGHT, snapPixels);\n  pixelsToPNG(snapPixels, RENDER_WIDTH, RENDER_HEIGHT).then(file => {\n    spawnCameraFile(world.eid2obj.get(camera), file, \"photo\");\n  });\n}\n\n// TODO this should be its own thing, not hardcoded to camera tools or mouse bindings\nfunction rotateWithRightClick(world, camera) {\n  const userinput = AFRAME.scenes[0].systems.userinput;\n  const transformSystem = AFRAME.scenes[0].systems[\"transform-selected-object\"];\n  const physicsSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].physicsSystem;\n  if (\n    !transformSystem.transforming &&\n    hasComponent(world, HoveredRemoteRight, camera) &&\n    userinput.get(paths.device.mouse.buttonRight)\n  ) {\n    const rightCursor = anyEntityWith(world, RemoteRight);\n    physicsSystem.updateBodyOptions(Rigidbody.bodyId[camera], { type: \"kinematic\" });\n    transformSystem.startTransform(world.eid2obj.get(camera), world.eid2obj.get(rightCursor), {\n      mode: \"cursor\"\n    });\n  } else if (transformSystem.target?.eid === camera && !userinput.get(paths.device.mouse.buttonRight)) {\n    transformSystem.stopTransform();\n  }\n}\n\nconst cameraToolQuery = defineQuery([CameraTool]);\nconst cameraToolEnterQuery = enterQuery(cameraToolQuery);\nconst cameraToolExitQuery = exitQuery(cameraToolQuery);\n\nexport function cameraToolSystem(world) {\n  cameraToolEnterQuery(world).forEach(function(eid) {\n    const renderTarget = new THREE.WebGLRenderTarget(RENDER_WIDTH, RENDER_HEIGHT, {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n    renderTarget.lastUpdated = 0;\n    renderTarget.needsUpdate = true;\n\n    // Only update the renderTarget when the screens are in view\n    function setRendertargetDirty() {\n      renderTarget.needsUpdate = true;\n    }\n\n    const screenObj = world.eid2obj.get(CameraTool.screenRef[eid]);\n    screenObj.material.map = renderTarget.texture;\n    screenObj.onBeforeRender = setRendertargetDirty;\n\n    const selfieScreenObj = world.eid2obj.get(CameraTool.selfieScreenRef[eid]);\n    selfieScreenObj.material.map = renderTarget.texture;\n    selfieScreenObj.onBeforeRender = setRendertargetDirty;\n\n    renderTargets.set(eid, renderTarget);\n  });\n\n  cameraToolExitQuery(world).forEach(function(eid) {\n    const renderTarget = renderTargets.get(eid);\n    renderTarget.dispose();\n    renderTargets.delete(eid);\n\n    const screenObj = world.eid2obj.get(CameraTool.screenRef[eid]);\n    screenObj.geometry.dispose();\n    screenObj.material.dispose();\n  });\n\n  cameraToolQuery(world).forEach((camera, i, allCameras) => {\n    rotateWithRightClick(world, camera);\n\n    if (CameraTool.trackTarget[camera]) {\n      if (entityExists(world, CameraTool.trackTarget[camera])) {\n        world.eid2obj.get(CameraTool.trackTarget[camera]).getWorldPosition(tmpVec3);\n        world.eid2obj.get(camera).lookAt(tmpVec3);\n      } else {\n        CameraTool.trackTarget[camera] = 0;\n      }\n    }\n\n    if (CameraTool.state[camera] === CAMERA_STATE.IDLE) {\n      if (clicked(CameraTool.snapRef[camera]) || grabberPressedSnapAction(world, camera)) {\n        CameraTool.state[camera] = CAMERA_STATE.COUNTDOWN_PHOTO;\n        CameraTool.snapTime[camera] = world.time.elapsed + 3000;\n      }\n\n      if (clicked(CameraTool.recVideoRef[camera])) {\n        CameraTool.state[camera] = CAMERA_STATE.COUNTDOWN_VIDEO;\n        CameraTool.snapTime[camera] = world.time.elapsed + 3000;\n      }\n\n      if (clicked(CameraTool.button_next[camera])) {\n        CameraTool.captureDurIdx[camera] = (CameraTool.captureDurIdx[camera] + 1) % CAPTURE_DURATIONS.length;\n      }\n\n      if (clicked(CameraTool.button_prev[camera])) {\n        CameraTool.captureDurIdx[camera] =\n          CameraTool.captureDurIdx[camera] === 0 ? CAPTURE_DURATIONS.length - 1 : CameraTool.captureDurIdx[camera] - 1;\n      }\n\n      if (clicked(CameraTool.sndToggleRef[camera])) {\n        captureAudio = !captureAudio;\n      }\n    }\n\n    if (\n      CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_PHOTO ||\n      CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_VIDEO\n    ) {\n      if (clicked(CameraTool.cancelRef[camera])) {\n        CameraTool.state[camera] = CAMERA_STATE.IDLE;\n      } else if (world.time.elapsed >= CameraTool.snapTime[camera]) {\n        if (CameraTool.state[camera] === CAMERA_STATE.COUNTDOWN_VIDEO) {\n          CameraTool.snapTime[camera] = world.time.elapsed + CAPTURE_DURATIONS[CameraTool.captureDurIdx[camera]] * 1000;\n          CameraTool.state[camera] = CAMERA_STATE.RECORDING_VIDEO;\n\n          const recorder = createRecorder(captureAudio);\n          videoRecorders.set(camera, recorder);\n          recorder.start();\n\n          APP.hubChannel.beginRecording();\n        } else {\n          CameraTool.state[camera] = CAMERA_STATE.SNAP_PHOTO;\n        }\n      } else {\n        // Floating point imprecision: Add epsilon to elapsed time so that the countdown sound always plays on the same frame that we click\n        const elapsed = world.time.elapsed + 0.01;\n        const msRemaining = CameraTool.snapTime[camera] - elapsed;\n        const msRemainingLastFrame = CameraTool.snapTime[camera] - (elapsed - world.time.delta);\n        if (Math.floor(msRemaining / 1000) !== Math.floor(msRemainingLastFrame / 1000)) {\n          AFRAME.scenes[0].systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\n        }\n      }\n    }\n\n    // TODO we previously did this in tock() since we wanted to run it late in the frame\n    // We actually want to run this before the normal scene render otherwise the camera view is a frame behind.\n    // This is not really a big deal since we also run the camera at a lower FPS anyway\n    const renderTarget = renderTargets.get(camera);\n    const elapsed = world.time.elapsed;\n\n    // Update render target when taking a photo, recording a video, or round robbin for cameras in view\n    if (\n      CameraTool.state[camera] === CAMERA_STATE.SNAP_PHOTO ||\n      (CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO &&\n        elapsed > renderTarget.lastUpdated + VIDEO_UPDATE_RATE) ||\n      (renderTarget.needsUpdate &&\n        world.time.tick % allCameras.length === i &&\n        elapsed > renderTarget.lastUpdated + VIEWFINDER_UPDATE_RATE)\n    ) {\n      updateRenderTarget(world, camera);\n      if (CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO) {\n        videoRecorders.get(camera).captureFrame(renderTargets.get(camera));\n      }\n    }\n\n    if (CameraTool.state[camera] === CAMERA_STATE.SNAP_PHOTO) {\n      captureSnapshot(world, camera);\n      CameraTool.state[camera] = CAMERA_STATE.IDLE;\n    } else if (CameraTool.state[camera] === CAMERA_STATE.RECORDING_VIDEO) {\n      if (clicked(CameraTool.cancelRef[camera])) {\n        endRecording(world, camera, true);\n        CameraTool.state[camera] = CAMERA_STATE.IDLE;\n      } else if (world.time.elapsed >= CameraTool.snapTime[camera]) {\n        endRecording(world, camera, false);\n        CameraTool.state[camera] = CAMERA_STATE.IDLE;\n      }\n    }\n\n    updateUI(world, camera);\n  });\n}\n","import { defineQuery, removeEntity } from \"bitecs\";\nimport { DestroyAtExtremeDistance } from \"../bit-components\";\n\nconst DIST = 1000;\nconst pos = new THREE.Vector3();\n\nconst query = defineQuery([DestroyAtExtremeDistance]);\nexport function destroyAtExtremeDistanceSystem(world) {\n  const ents = query(world);\n  if (!ents.length) return;\n\n  // Check only one per frame\n  const eid = ents[world.time.tick % ents.length];\n  const obj = world.eid2obj.get(eid);\n  obj.getWorldPosition(pos);\n  if (pos.x < -DIST || pos.x > DIST || pos.y < -DIST || pos.y > DIST || pos.z < -DIST || pos.z > DIST) {\n    removeEntity(world, eid);\n  }\n}\n","import { CursorTargettingSystem } from \"./cursor-targetting-system\";\nimport { PositionAtBorderSystem } from \"../components/position-at-border\";\nimport { BoneVisibilitySystem } from \"../components/bone-visibility\";\nimport { AnimationMixerSystem } from \"../components/animation-mixer\";\nimport { UVScrollSystem } from \"../components/uv-scroll\";\nimport { CursorTogglingSystem } from \"./cursor-toggling-system\";\nimport { PhysicsSystem } from \"./physics-system\";\nimport { TwoPointStretchingSystem } from \"./two-point-stretching-system\";\nimport { HoldableButtonSystem, HoverButtonSystem } from \"./button-systems\";\nimport { DrawingMenuSystem } from \"./drawing-menu-system\";\nimport { HoverMenuSystem } from \"./hover-menu-system\";\nimport { SuperSpawnerSystem } from \"./super-spawner-system\";\nimport { HapticFeedbackSystem } from \"./haptic-feedback-system\";\nimport { SoundEffectsSystem } from \"./sound-effects-system\";\nimport { ScenePreviewCameraSystem } from \"./scene-preview-camera-system\";\nimport { InteractionSfxSystem } from \"./interaction-sfx-system\";\nimport { SpriteSystem } from \"./sprites\";\nimport { CameraSystem } from \"./camera-system\";\nimport { WaypointSystem } from \"./waypoint-system\";\nimport { CharacterControllerSystem } from \"./character-controller-system\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { CursorPoseTrackingSystem } from \"./cursor-pose-tracking\";\nimport { MenuAnimationSystem } from \"./menu-animation-system\";\nimport { AudioSettingsSystem } from \"./audio-settings-system\";\nimport { AudioSystem } from \"./audio-system\";\nimport { ShadowSystem } from \"./shadow-system\";\nimport { InspectYourselfSystem } from \"./inspect-yourself-system\";\nimport { EmojiSystem } from \"./emoji-system\";\nimport { AudioZonesSystem } from \"./audio-zones-system\";\nimport { GainSystem } from \"./audio-gain-system\";\nimport { EnvironmentSystem } from \"./environment-system\";\nimport { NameTagVisibilitySystem } from \"./name-tag-visibility-system\";\n\n// new world\nimport { networkSendSystem, networkReceiveSystem } from \"./netcode\";\nimport { onOwnershipLost } from \"./on-ownership-lost\";\nimport { interactionSystem } from \"./bit-interaction-system\";\nimport { floatyObjectSystem } from \"./floaty-object-system\";\nimport { removeNetworkedObjectButtonSystem } from \"./remove-networked-object-button-system\";\nimport { removeObject3DSystem } from \"./remove-object3D-system\";\nimport { networkedTransformSystem } from \"./networked-transform\";\nimport { buttonSystems } from \"./single-action-button-system\";\nimport { constraintsSystem } from \"./bit-constraints-system\";\nimport { mediaFramesSystem } from \"./bit-media-frames\";\nimport { cameraToolSystem } from \"../bit-systems/camera-tool\";\n// import { holdableButtonSystem } from \"./holdable-button-system\";\nimport { physicsCompatSystem } from \"./bit-physics\";\nimport { destroyAtExtremeDistanceSystem } from \"./bit-destroy-at-extreme-distances\";\n\nAFRAME.registerSystem(\"hubs-systems\", {\n  init() {\n    waitForDOMContentLoaded().then(() => {\n      this.DOMContentDidLoad = true;\n    });\n    this.cursorTogglingSystem = new CursorTogglingSystem();\n    this.interactionSfxSystem = new InteractionSfxSystem();\n    this.superSpawnerSystem = new SuperSpawnerSystem();\n    this.cursorTargettingSystem = new CursorTargettingSystem();\n    this.positionAtBorderSystem = new PositionAtBorderSystem();\n    this.physicsSystem = new PhysicsSystem(this.el.object3D);\n    this.twoPointStretchingSystem = new TwoPointStretchingSystem();\n    this.holdableButtonSystem = new HoldableButtonSystem();\n    this.hoverButtonSystem = new HoverButtonSystem();\n    this.hoverMenuSystem = new HoverMenuSystem();\n    this.hapticFeedbackSystem = new HapticFeedbackSystem();\n    this.audioSystem = new AudioSystem(this.el);\n    this.soundEffectsSystem = new SoundEffectsSystem(this.el);\n    this.scenePreviewCameraSystem = new ScenePreviewCameraSystem();\n    this.spriteSystem = new SpriteSystem(this.el);\n    this.cameraSystem = new CameraSystem(this.el.camera, this.el.renderer);\n    this.drawingMenuSystem = new DrawingMenuSystem(this.el);\n    this.characterController = new CharacterControllerSystem(this.el);\n    this.waypointSystem = new WaypointSystem(this.el, this.characterController);\n    this.cursorPoseTrackingSystem = new CursorPoseTrackingSystem();\n    this.menuAnimationSystem = new MenuAnimationSystem();\n    this.audioSettingsSystem = new AudioSettingsSystem(this.el);\n    this.animationMixerSystem = new AnimationMixerSystem();\n    this.boneVisibilitySystem = new BoneVisibilitySystem();\n    this.uvScrollSystem = new UVScrollSystem();\n    this.shadowSystem = new ShadowSystem(this.el);\n    this.inspectYourselfSystem = new InspectYourselfSystem();\n    this.emojiSystem = new EmojiSystem(this.el);\n    this.audioZonesSystem = new AudioZonesSystem();\n    this.gainSystem = new GainSystem();\n    this.environmentSystem = new EnvironmentSystem(this.el);\n    this.nameTagSystem = new NameTagVisibilitySystem(this.el);\n\n    window.$S = this;\n  },\n\n  tick(t, dt) {\n    if (!this.DOMContentDidLoad) return;\n    const world = APP.world;\n\n    networkReceiveSystem(world);\n    onOwnershipLost(world);\n\n    physicsCompatSystem(APP.world);\n\n    networkedTransformSystem(world);\n\n    const systems = AFRAME.scenes[0].systems;\n    systems.userinput.tick2();\n\n    interactionSystem(world, this.cursorTargettingSystem, t, systems);\n\n    buttonSystems(world);\n    constraintsSystem(world, systems.userinput);\n\n    // We run this earlier in the frame so things have a chance to override properties run by animations\n    this.animationMixerSystem.tick(dt);\n\n    this.characterController.tick(t, dt);\n    this.cursorTogglingSystem.tick(systems.interaction, systems.userinput, this.el);\n    this.interactionSfxSystem.tick(systems.interaction, systems.userinput, this.soundEffectsSystem);\n    this.superSpawnerSystem.tick();\n    this.emojiSystem.tick(t, systems.userinput);\n    this.cursorPoseTrackingSystem.tick();\n    this.hoverMenuSystem.tick();\n    this.positionAtBorderSystem.tick();\n    // this.constraintsSystem.tick();\n    this.twoPointStretchingSystem.tick();\n\n    floatyObjectSystem(world);\n\n    this.holdableButtonSystem.tick();\n    this.hoverButtonSystem.tick();\n    this.drawingMenuSystem.tick();\n    this.hapticFeedbackSystem.tick(\n      this.twoPointStretchingSystem,\n      false,\n      false\n      // TODO: didInteractLeftThisFrame doesn't exist?\n      // this.singleActionButtonSystem.didInteractLeftThisFrame,\n      // this.singleActionButtonSystem.didInteractRightThisFrame\n    );\n    this.soundEffectsSystem.tick();\n    this.scenePreviewCameraSystem.tick();\n    this.physicsSystem.tick(dt);\n    this.inspectYourselfSystem.tick(this.el, systems.userinput, this.cameraSystem);\n    this.cameraSystem.tick(this.el, dt);\n    cameraToolSystem(world);\n    this.waypointSystem.tick(t, dt);\n    this.menuAnimationSystem.tick(t);\n    this.spriteSystem.tick(t, dt);\n    this.uvScrollSystem.tick(dt);\n    this.shadowSystem.tick();\n    mediaFramesSystem(world);\n    this.audioZonesSystem.tick(this.el);\n    this.gainSystem.tick();\n    this.nameTagSystem.tick();\n\n    destroyAtExtremeDistanceSystem(world);\n    removeNetworkedObjectButtonSystem(world);\n    removeObject3DSystem(world);\n\n    // We run this late in the frame so that its the last thing to have an opinion about the scale of an object\n    this.boneVisibilitySystem.tick();\n\n    networkSendSystem(world);\n  },\n\n  remove() {\n    this.cursorTargettingSystem.remove();\n  }\n});\n","import { handHoverSystem } from \"./bit-hand-hover-system\";\nimport { holdSystem } from \"./hold-system\";\nimport { dontHoldWithHandAndRemote, dontHoverAndHold } from \"./not-hovered-if-held\";\n\nexport function interactionSystem(world, cursorTargettingSystem, t, systems) {\n  cursorTargettingSystem.tick(t); // handles hovers for cursors\n  handHoverSystem(world, systems.interaction);\n\n  holdSystem(world, systems.userinput);\n  dontHoldWithHandAndRemote(world);\n  dontHoverAndHold(world);\n\n  // Copies hovered/held state (only for aframe entities) for querying by legacy systems/components\n  systems.interaction.updateLegacyState();\n}\n","import qsTruthy from \"../utils/qs_truthy\";\n\nAFRAME.registerSystem(\"capture-system\", {\n  init() {\n    this._gotAudioTrack = false;\n    this._recorderTimeout = null;\n  },\n\n  _initRecorder() {\n    if (!this.available()) return;\n\n    this._stream = new MediaStream();\n\n    const video = this.el.canvas.captureStream().getVideoTracks()[0];\n    this._stream.addTrack(video);\n\n    this._recorder = new MediaRecorder(this._stream, { mimeType: \"video/webm; codecs=vp8\" });\n\n    const chunks = [];\n\n    this._recorder.ondataavailable = e => {\n      chunks.push(e.data);\n    };\n    this._recorder.onstop = () => {\n      if (chunks.length === 0) return;\n      const mimeType = chunks[0].type;\n      const blob = new Blob(chunks, { type: mimeType });\n      chunks.length = 0;\n      this.el.emit(\"add_media\", new File([blob], \"capture\", { type: mimeType }));\n    };\n  },\n\n  available() {\n    return qsTruthy(\"video_capture\") && window.MediaRecorder && MediaRecorder.isTypeSupported(\"video/webm; codecs=vp8\");\n  },\n\n  started() {\n    return this._recorder && this._recorder.state !== \"inactive\";\n  },\n\n  _tryAddingAudioTrack() {\n    if (this._gotAudioTrack || !this.el.audioListener) return;\n\n    const listener = this.el.audioListener;\n    const destination = listener.context.createMediaStreamDestination();\n    listener.getInput().connect(destination);\n    const audio = destination.stream.getAudioTracks()[0];\n\n    this._stream.addTrack(audio);\n    this._gotAudioTrack = true;\n  },\n\n  start() {\n    if (!this._recorder) {\n      this._initRecorder();\n    }\n\n    // The scene doesn't get an audioListener until something in the scene is playing audio.\n    // So we have to get the audio track lazily.\n    this._tryAddingAudioTrack();\n\n    if (!this.started()) {\n      this._recorder.start();\n      this._recorderTimeout = setTimeout(() => {\n        if (this.started()) {\n          this._recorder.stop();\n        }\n      }, 15000);\n    }\n  },\n\n  stop() {\n    if (this.started()) {\n      clearTimeout(this._recorderTimeout);\n      this._recorder.stop();\n    }\n  }\n});\n","// Provides the idea of \"media linking\" -- if two media objects are linked\n// then updates to one (src, page, etc) will be reflected on the other, and vice versa.\n//\n// When you link a media element from A -> B via registerLinkage, a few notes:\n// - The media is assumed to be of the same kind, ideally created via media-utils/cloneMedia\n// - Sync is bidirectional, however, elB is assumed to be a 'derivate of' elA. this means:\n//   - for the video case, elA will have its volume set to zero and restored if elB is removed\n//   - when elA is removed, elB will be removed (done in media-loader) but not vice-versa\n\nimport { updateAudioSettings } from \"../update-audio-settings\";\n\n//\nAFRAME.registerSystem(\"linked-media\", {\n  init: function() {\n    this.handlers = [];\n    this.addLinkageHandler = this.addLinkageHandler.bind(this);\n    this.syncLinkage = this.syncLinkage.bind(this);\n  },\n\n  addLinkageHandler(elA, elB) {\n    const handler = () => {\n      // Since elB will have its event fired here if we change something, ignore it.\n      if (elB._handlingLinkage) return;\n      elA._handlingLinkage = true;\n      this.syncLinkage(elA, elB);\n      elA._handlingLinkage = false;\n    };\n\n    if (elA.components[\"media-loader\"].data) {\n      elA.addEventListener(\"componentchanged\", handler);\n    } else {\n      const waitForMediaLoader = evt => {\n        if (evt.detail.name === \"media-loader\") {\n          elA.removeEventListener(\"componentinitialized\", waitForMediaLoader);\n          elA.addEventListener(\"componentchanged\", handler);\n        }\n      };\n\n      elA.addEventListener(\"componentinitialized\", waitForMediaLoader);\n    }\n\n    return handler;\n  },\n\n  registerLinkage: function(elA, elB) {\n    this.syncLinkage(elA, elB);\n\n    const handlerA = this.addLinkageHandler(elA, elB);\n    const handlerB = this.addLinkageHandler(elB, elA);\n    elA.setAttribute(\"linked-media\", \"\");\n    elB.setAttribute(\"linked-media\", \"\");\n\n    // As a convenience, if elA has audio, we turn its volume off so we don't hear it twice\n    APP.mutedState.add(elA);\n    const audio = APP.audios.get(elA);\n    if (audio) {\n      updateAudioSettings(elA, audio);\n    }\n\n    this.handlers.push([elA, elB, handlerA, handlerB]);\n  },\n\n  deregisterLinkage: function(el) {\n    // Deregister elA -> elB, get list of elBs, and remove them\n    for (const [elA, elB, handlerA, handlerB] of this.handlers) {\n      if (el === elA || el === elB) {\n        elA.removeEventListener(\"componentchanged\", handlerA);\n        elB.removeEventListener(\"componentchanged\", handlerB);\n      }\n\n      APP.mutedState.delete(elA);\n      const audio = APP.audios.get(elA);\n      if (audio) {\n        updateAudioSettings(elA, audio);\n      }\n    }\n\n    this.handlers = this.handlers.filter(([elA, elB]) => elA !== el && elB !== el);\n  },\n\n  syncLinkage(elA, elB) {\n    if (elB.components[\"networked\"]) {\n      // Take ownership before updating\n      if (!NAF.utils.isMine(elB) && !NAF.utils.takeOwnership(elB)) return;\n    }\n\n    const { src, version } = elA.components[\"media-loader\"].data;\n\n    // For now, manually sync linkable properties.\n    elB.setAttribute(\"media-loader\", { src, version });\n\n    if (elA.components[\"media-pdf\"]) {\n      const { index } = elA.components[\"media-pdf\"].data;\n      elB.setAttribute(\"media-pdf\", { index });\n    }\n\n    if (elA.components[\"media-video\"]) {\n      const { time, videoPaused, loop, hidePlaybackControls } = elA.components[\"media-video\"].data;\n\n      // Sync time, pause state, playback controls, and tighten sync tolerance since its local\n      const syncedVideoAttributes = { time, videoPaused, loop, hidePlaybackControls };\n\n      const targetIsNetworked = !elB.components.networked;\n      if (targetIsNetworked) {\n        syncedVideoAttributes.syncTolerance = 0.25;\n      }\n\n      elB.setAttribute(\"media-video\", syncedVideoAttributes);\n      elB.components[\"media-video\"].updatePlaybackState(true);\n    }\n  }\n});\n\nAFRAME.registerComponent(\"linked-media\", {\n  remove: function() {\n    this.system.deregisterLinkage(this.el);\n  }\n});\n","export default \"precision highp float;\\nprecision highp int;\\n\\nvarying vec2 vUv;\\nvarying vec3 vNormal;\\nvoid main()\\n{\\n  vNormal = normalize(normal);\\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n  vUv = position.xz;\\n}\";","import audioDebugVert from \"./audio-debug.vert\";\nimport audioDebugFrag from \"./audio-debug.frag\";\nimport { DistanceModelType } from \"../components/audio-params\";\nimport { getWebGLVersion } from \"../utils/webgl\";\nimport { getMeshes } from \"../utils/aframe-utils\";\n\nconst fakePanner = {\n  distanceModel: DistanceModelType.Inverse,\n  maxDistance: 0,\n  refDistance: 0,\n  rolloffFactor: 0,\n  coneInnerAngle: 0,\n  coneOuterAngle: 0\n};\n\nAFRAME.registerSystem(\"audio-debug\", {\n  schema: {\n    enabled: { default: false }\n  },\n\n  init() {\n    this.maxDebugSources = 64;\n    this.unsupported = false;\n    const webGLVersion = getWebGLVersion(this.el.sceneEl.renderer);\n    if (webGLVersion < \"2.0\") {\n      this.unsupported = true;\n    } else {\n      const gl = this.el.sceneEl.renderer.getContext();\n      const maxUniformVectors = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);\n      // 10 is the number of uniform vectors in the shader. If we update that, this number must be updated accordingly.\n      this.maxDebugSources = Math.min(Math.floor(maxUniformVectors / 10), this.maxDebugSources);\n    }\n\n    window.APP.store.addEventListener(\"statechanged\", this.updateState.bind(this));\n\n    this.onSceneLoaded = this.onSceneLoaded.bind(this);\n    this.el.sceneEl.addEventListener(\"environment-scene-loaded\", this.onSceneLoaded);\n\n    this.navMeshObject = null;\n    this.zones = [];\n\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: { value: 0.0 },\n        colorInner: { value: new THREE.Color(\"#7AFF59\") },\n        colorOuter: { value: new THREE.Color(\"#FF6340\") },\n        colorGain: { value: new THREE.Color(\"#70DBFF\") },\n        count: { value: 0 },\n        maxDistance: { value: [] },\n        refDistance: { value: [] },\n        rolloffFactor: { value: [] },\n        distanceModel: { value: [] },\n        sourcePosition: { value: [] },\n        sourceOrientation: { value: [] },\n        coneInnerAngle: { value: [] },\n        coneOuterAngle: { value: [] },\n        gain: { value: [] },\n        clipped: { value: [] }\n      },\n      vertexShader: audioDebugVert,\n      fragmentShader: audioDebugFrag\n    });\n    this.material.side = THREE.FrontSide;\n    this.material.transparent = true;\n    this.material.uniforms.count.value = 0;\n    this.material.defines.MAX_DEBUG_SOURCES = this.maxDebugSources;\n\n    this.sourcePositions = new Array(this.maxDebugSources);\n    this.sourcePositions.fill(new THREE.Vector3());\n    this.sourceOrientations = new Array(this.maxDebugSources);\n    this.sourceOrientations.fill(new THREE.Vector3());\n    this.distanceModels = new Array(this.maxDebugSources);\n    this.distanceModels.fill(0);\n    this.maxDistances = new Array(this.maxDebugSources);\n    this.maxDistances.fill(0.0);\n    this.refDistances = new Array(this.maxDebugSources);\n    this.refDistances.fill(0.0);\n    this.rolloffFactors = new Array(this.maxDebugSources);\n    this.rolloffFactors.fill(0.0);\n    this.coneInnerAngles = new Array(this.maxDebugSources);\n    this.coneInnerAngles.fill(0.0);\n    this.coneOuterAngles = new Array(this.maxDebugSources);\n    this.coneOuterAngles.fill(0.0);\n    this.gains = new Array(this.maxDebugSources);\n    this.gains.fill(0.0);\n    this.clipped = new Array(this.maxDebugSources);\n    this.clipped.fill(0.0);\n  },\n\n  remove() {\n    window.APP.store.removeEventListener(\"statechanged\", this.updateState);\n    this.el.sceneEl.removeEventListener(\"environment-scene-loaded\", this.onSceneLoaded);\n  },\n\n  registerZone(zone) {\n    this.zones.push(zone);\n  },\n\n  unregisterZone(zone) {\n    const index = this.zones.indexOf(zone);\n\n    if (index !== -1) {\n      this.zones.splice(index, 1);\n    }\n  },\n\n  tick: (() => {\n    const sourcePos = new THREE.Vector3();\n    const sourceDir = new THREE.Vector3();\n    return function (time) {\n      if (!this.data.enabled) {\n        return;\n      }\n\n      let sourceNum = 0;\n      for (const [el, audio] of APP.audios.entries()) {\n        if (sourceNum >= this.maxDebugSources) continue;\n        if (APP.isAudioPaused.has(el)) continue;\n\n        audio.getWorldPosition(sourcePos);\n        audio.getWorldDirection(sourceDir);\n        this.sourcePositions[sourceNum] = this.navMeshObject.worldToLocal(sourcePos).clone(); // TODO: Use Vector3 pool\n        this.sourceOrientations[sourceNum] = this.navMeshObject.worldToLocal(sourceDir).clone();\n\n        const panner = audio.panner || fakePanner;\n\n        this.distanceModels[sourceNum] = 0;\n        if (panner.distanceModel === DistanceModelType.Linear) {\n          this.distanceModels[sourceNum] = 0;\n        } else if (panner.distanceModel === DistanceModelType.Inverse) {\n          this.distanceModels[sourceNum] = 1;\n        } else if (panner.distanceModel === DistanceModelType.Exponential) {\n          this.distanceModels[sourceNum] = 2;\n        }\n        this.maxDistances[sourceNum] = panner.maxDistance;\n        this.refDistances[sourceNum] = panner.refDistance;\n        this.rolloffFactors[sourceNum] = panner.rolloffFactor;\n        this.coneInnerAngles[sourceNum] = panner.coneInnerAngle;\n        this.coneOuterAngles[sourceNum] = panner.coneOuterAngle;\n\n        this.gains[sourceNum] = audio.gain.gain.value;\n        this.clipped[sourceNum] = APP.clippingState.has(el);\n        sourceNum++;\n      }\n\n      // Update material uniforms\n      this.material.uniforms.time.value = time;\n      this.material.uniforms.distanceModel.value = this.distanceModels;\n      this.material.uniforms.maxDistance.value = this.maxDistances;\n      this.material.uniforms.refDistance.value = this.refDistances;\n      this.material.uniforms.rolloffFactor.value = this.rolloffFactors;\n      this.material.uniforms.sourcePosition.value = this.sourcePositions;\n      this.material.uniforms.sourceOrientation.value = this.sourceOrientations;\n      this.material.uniforms.count.value = sourceNum;\n      this.material.uniforms.coneInnerAngle.value = this.coneInnerAngles;\n      this.material.uniforms.coneOuterAngle.value = this.coneOuterAngles;\n      this.material.uniforms.gain.value = this.gains;\n      this.material.uniforms.clipped.value = this.clipped;\n    };\n  })(),\n\n  enableDebugMode(enabled, force = false) {\n    if (((enabled === undefined || enabled === this.data.enabled) && !force) || this.unsupported) return;\n    this.zones.forEach(zone => {\n      zone.el.setAttribute(\"audio-zone\", \"debuggable\", enabled);\n    });\n\n    const collisionEntities = Array.from(this.el.sceneEl.querySelectorAll(\"[nav-mesh]\"));\n    const meshes = getMeshes(collisionEntities);\n\n    if (meshes.length) {\n      this.data.enabled = enabled;\n      meshes.forEach(obj => {\n        if (obj.isMesh) {\n          this.navMeshObject = obj;\n          obj.parent.visible = enabled;\n          if (obj.material) {\n            if (enabled) {\n              !obj._hubs_audio_debug_prev_material && (obj._hubs_audio_debug_prev_material = obj.material);\n              obj.material = this.material;\n              obj.material.needsUpdate = true;\n            } else if (obj._hubs_audio_debug_prev_material) {\n              obj.material = obj._hubs_audio_debug_prev_material;\n              obj._hubs_audio_debug_prev_material = null;\n              obj.material.needsUpdate = true;\n            }\n            obj.geometry.computeVertexNormals();\n          }\n        }\n      });\n    }\n\n    if (!this.navMeshObject) {\n      this.data.enabled = false;\n    }\n  },\n\n  updateState({ force }) {\n    const isEnabled = window.APP.store.state.preferences.showAudioDebugPanel;\n    if (force || isEnabled !== this.data.enabled) {\n      this.enableDebugMode(isEnabled, force);\n    }\n  },\n\n  onSceneLoaded() {\n    this.navMeshObject = null;\n    this.updateState({ force: true });\n  }\n});\n","export default \"// Based on: https://www.shadertoy.com/view/Mll3D4#\\n\\nprecision highp float;\\nprecision highp int;\\n\\nvarying vec2 vUv;\\nvarying vec3 vNormal;\\nuniform float time;\\n\\nconst int LINEAR = 0;\\nconst int INVERSE = 1;\\nconst int EXPONENTIAL = 2;\\n        \\nuniform vec3 colorInner;\\nuniform vec3 colorOuter;\\nuniform vec3 colorGain;\\nuniform int count;\\nuniform vec3 sourcePosition[MAX_DEBUG_SOURCES];\\nuniform vec3 sourceOrientation[MAX_DEBUG_SOURCES];\\nuniform float maxDistance[MAX_DEBUG_SOURCES];\\nuniform float refDistance[MAX_DEBUG_SOURCES];\\nuniform float rolloffFactor[MAX_DEBUG_SOURCES];\\nuniform int distanceModel[MAX_DEBUG_SOURCES];\\nuniform float coneInnerAngle[MAX_DEBUG_SOURCES];\\nuniform float coneOuterAngle[MAX_DEBUG_SOURCES];\\nuniform float gain[MAX_DEBUG_SOURCES];\\nuniform bool clipped[MAX_DEBUG_SOURCES];\\n\\nconst float kPi = 3.141592;\\nconst float kDegToRad = kPi / 180.0;\\nconst float kInvPi = 1.0 / 3.141592;\\nconst float kRefDistWidth = 0.05;\\n\\nfloat distance[MAX_DEBUG_SOURCES];\\nvec2 center[MAX_DEBUG_SOURCES];\\nfloat startOffset[MAX_DEBUG_SOURCES];\\nfloat clampedGain[MAX_DEBUG_SOURCES];\\n\\nfloat att_linear(float x, float rolloff, float dref, float dmax) {\\n  return 1.0-(rolloff*((x-dref)/(dmax-dref)));\\n}\\n\\nfloat att_inverse(float x, float rolloff, float dref) {\\n  return dref/(dref+(rolloff*(max(x, dref)-dref)));\\n}\\n\\nfloat att_exponential(float x, float rolloff, float dref) {\\n  return pow((max(x, dref)/dref),-rolloff);\\n}\\n\\nvec4 circle(vec2 center, float d, float len, float radius, float holeRadius, vec3 color, float offset) {  \\n  // Define how blurry the circle should be. \\n  // A value of 1.0 means 'sharp', larger values\\n  // will increase the bluriness.\\n  float bluriness = 1.0;\\n  \\n  // Calculate angle, so we can draw segments, too.\\n  float angle = atan( center.x, center.y ) * kInvPi * 0.5;\\n  angle = fract( angle + offset);\\n  \\n  // Create an anti-aliased circle.\\n  float wd = bluriness * fwidth( d );\\n  float circle = smoothstep( radius + wd, radius - wd, d );\\n  \\n  // Optionally, you could create a hole in it:\\n  float inner = holeRadius;\\n  circle -= smoothstep( inner + wd, inner - wd, d );\\n  \\n  // Or only draw a portion (segment) of the circle.\\n  float wa = bluriness * fwidth( angle );\\n  float segment = smoothstep( len + wa, len - wa, angle );\\n  segment *= smoothstep( 0.0, 2.0 * wa, angle );\\n  circle *= mix( segment, 1.0, step( 1.0, len ) );\\n      \\n  // Let's define the circle's color now.\\n  vec3 rgb = color * circle;\\n  \\n  // Output final color.\\n  return vec4( rgb, circle);\\n}\\n\\nfloat att(float d, float maxDistance, float refDistance, float rolloffFactor, int distanceModel) {\\n  // Calculate attenuation\\n  float attenuation = 1.0;\\n  if (distanceModel == LINEAR) {\\n    attenuation = att_linear(d, rolloffFactor, refDistance, maxDistance);\\n  } else if (distanceModel == INVERSE) {\\n    attenuation = att_inverse(d, rolloffFactor, refDistance);\\n  } else if (distanceModel == EXPONENTIAL) {\\n    attenuation = att_exponential(d, rolloffFactor, refDistance);\\n  }\\n  return clamp(attenuation, 0.0, 1.0);\\n}\\n\\nvec4 draw_att(float d, float attenuation, vec4 circle) {\\n  // Waves\\n  float v = sin((d * 2.0 * kPi) - (time * 0.005)) + 1.0;\\n  float waves = circle.a * attenuation * v;\\n  \\n  // Output final color.\\n  return vec4( circle.rgb, waves );\\n}\\n\\nvoid main() {\\n  // Draw background\\n  vec4 background = vec4(1.0, 1.0, 1.0, 0.0);\\n\\n  for (int i=0; i<count; i++) {\\n    center[i] = sourcePosition[i].xz - vUv;\\n\\n    // Calculate distance to (0,0).\\n    distance[i] = length( center[i] );\\n\\n    // Optional start Offset.\\n    vec2 orientation = normalize(sourceOrientation[i].xz);\\n    float ang = atan(-orientation.x, orientation.y) * kInvPi * 0.5;\\n    // Rotate to start drawing facing front\\n    ang -= 0.5;\\n    startOffset[i] = mod(ang, 1.0);\\n\\n    // Gain\\n    clampedGain[i] = clamp(gain[i], 0.0, 1.0);\\n  }\\n\\n  for (int i=0; i<count; i++) {\\n    float attenuation = att(distance[i], maxDistance[i], refDistance[i], rolloffFactor[i], distanceModel[i]);\\n\\n    // Draw inner cone\\n    float innerAngle = coneInnerAngle[i] * kDegToRad * kInvPi * 0.5;\\n    float innerStartAngle = startOffset[i] + innerAngle * 0.5;\\n    vec4 innerLayer = circle(center[i], distance[i], innerAngle, 10000.0, 1.0, colorInner, innerStartAngle);\\n    innerLayer = draw_att(distance[i], attenuation, innerLayer);\\n    background = mix(background, innerLayer, innerLayer.a * clampedGain[i]);\\n\\n    // Draw outer cone\\n    float outerAngle = coneOuterAngle[i] * kDegToRad * kInvPi * 0.5;\\n    float outerAngleDiffHalf = (outerAngle - innerAngle) * 0.5;\\n    vec4 outerLayer1 = circle(center[i], distance[i], outerAngleDiffHalf, 10000.0, 1.0, colorOuter, innerStartAngle + outerAngleDiffHalf);\\n    outerLayer1 = draw_att(distance[i], attenuation, outerLayer1);\\n    background = mix(background, outerLayer1, outerLayer1.a * clampedGain[i]);\\n    vec4 outerLayer2 = circle(center[i], distance[i], outerAngleDiffHalf, 10000.0, 1.0, colorOuter, innerStartAngle - innerAngle);\\n    outerLayer2 = draw_att(distance[i], attenuation, outerLayer2);\\n    background = mix(background, outerLayer2, outerLayer2.a * (clipped[i] ? 0.0 : 1.0) * clampedGain[i]);\\n  }\\n\\n  for (int i=0; i<count; i++) {\\n    // Draw base\\n    vec4 baseLayer = circle(center[i], distance[i], 1.0, 1.0, 0.1, vec3(0.5, 0.5, 0.5), 0.0);\\n    background = mix(background, baseLayer, baseLayer.a);\\n\\n    // Draw gain\\n    vec4 gainLayer = circle(center[i], distance[i], clampedGain[i], 1.0, 0.5, colorGain, startOffset[i]);\\n    background = mix(background, gainLayer, gainLayer.a);\\n    if (gain[i] > 1.0) {\\n      vec4 overGainLayer = circle(center[i], distance[i], gain[i] -  clampedGain[i], 1.0, 0.5, vec3(1.0, 0.0, 0.0), startOffset[i]);\\n      background = mix(background, overGainLayer, overGainLayer.a);\\n    }\\n  } \\n  \\n  // Blend\\n  gl_FragColor = vec4(background.rgb, background.a * vNormal.y);\\n}\";","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\n  const publicComponent = publicComponents[inputComponent];\n\n  if (!publicComponent) {\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\n  }\n\n  const publicProperty = publicComponent.publicProperties[inputProperty];\n\n  if (!publicProperty) {\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\n  }\n\n  return {\n    mappedComponent: publicComponent.mappedComponent,\n    mappedProperty: publicProperty.mappedProperty,\n    getMappedValue: publicProperty.getMappedValue\n  };\n}\n","import { sanitizeUrl } from \"@braintree/sanitize-url\";\nimport \"./components/gltf-model-plus\";\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\nimport { TYPE, SHAPE, FIT } from \"three-ammo/constants\";\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\nimport { AudioType, DistanceModelType, SourceType } from \"./components/audio-params\";\nimport { updateAudioSettings } from \"./update-audio-settings\";\nimport { renderAsEntity } from \"./utils/jsx-entity\";\nimport { Networked } from \"./bit-components\";\nimport { addComponent } from \"bitecs\";\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\", el => {\n  el.setAttribute(\"duck\", \"\");\n  el.setAttribute(\"quack\", { quackPercentage: 0.1 });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\n  //TODO: Do not automatically add these components\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n  el.setAttribute(\"hoverable-visuals\", \"\");\n  el.setAttribute(componentName, componentData);\n});\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"body-helper\", el => {\n  //This is only required for migration of old environments with super-spawners\n  //will no longer be needed when spawners are added via Spoke instead.\n  el.setAttribute(\"body-helper\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"shape-helper\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\n  if (componentData.distance === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n  if (componentData.castShadow) {\n    // HACK: component.light isn't set until one frame after setArrtibute\n    setTimeout(() => {\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\n    }, 0);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"billboard\", \"billboard\");\nAFRAME.GLTFModelPlus.registerComponent(\"simple-water\", \"simple-water\");\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"morph-audio-feedback\", \"morph-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\"uv-scroll\", \"uv-scroll\");\nAFRAME.GLTFModelPlus.registerComponent(\"frustrum\", \"frustrum\");\nAFRAME.GLTFModelPlus.registerComponent(\"mirror\", \"mirror\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"shape-helper\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation: { x: orientation.x, y: orientation.y, z: orientation.z, w: orientation.w }\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\", el => {\n  el.setAttribute(\"waypoint\", {\n    canBeSpawnPoint: true,\n    canBeOccupied: false,\n    canBeClicked: false,\n    willDisableMotion: false,\n    willDisableTeleporting: false,\n    willMaintainWorldUp: true\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"waypoint\", \"waypoint\", (el, componentName, componentData, components) => {\n  if (componentData.canBeOccupied) {\n    el.setAttribute(\"networked\", {\n      template: \"#template-waypoint-avatar\",\n      attachTemplateToLocal: false,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n  el.setAttribute(\"waypoint\", componentData);\n});\n\nimport { findAncestorWithComponent } from \"./utils/scene-graph\";\nimport { createElementEntity } from \"./utils/jsx-entity\";\n/** @jsx createElementEntity */ createElementEntity;\n\nAFRAME.GLTFModelPlus.registerComponent(\"media-frame\", \"media-frame\", (el, _componentName, componentData) => {\n  const eid = renderAsEntity(APP.world, <entity media-frame={componentData} />);\n\n  addComponent(APP.world, Networked, eid);\n\n  const networkedEl = findAncestorWithComponent(el, \"networked\");\n  const rootNid = (networkedEl && networkedEl.components.networked.data.networkId) || \"scene\";\n  Networked.id[eid] = APP.getSid(`${rootNid}.${el.object3D.children[0].userData.gltfIndex}`);\n  APP.world.nid2eid.set(Networked.id[eid], eid);\n\n  el.object3D.add(APP.world.eid2obj.get(eid));\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  const mediaLoaderAttributes = {\n    src: sanitizeUrl(componentData.src),\n    fitToBox: componentData.contentSubtype ? false : true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    contentSubtype: componentData.contentSubtype\n  };\n\n  if (componentData.version) {\n    mediaLoaderAttributes.version = componentData.version;\n  }\n\n  el.setAttribute(\"media-loader\", mediaLoaderAttributes);\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pdf\", { index: componentData.pageIndex });\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nasync function mediaInflator(el, componentName, componentData, components) {\n  let isControlled = true;\n\n  if (componentName === \"link\" && (components.video || components.image)) {\n    // video/image component will set link url specified in link component.\n    return;\n  }\n\n  if (components.networked) {\n    isControlled = componentData.controls || componentName === \"link\";\n\n    const hasVolume = componentName === \"video\" || componentName === \"audio\";\n    const templateName =\n      componentName === \"model\" || isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\n\n    el.setAttribute(\"networked\", {\n      template: templateName,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {};\n\n  if (componentName === \"video\" || componentName === \"image\") {\n    mediaOptions.projection = componentData.projection;\n    mediaOptions.alphaMode = componentData.alphaMode;\n    mediaOptions.alphaCutoff = componentData.alphaCutoff;\n  }\n\n  if (componentName === \"video\" || componentName === \"audio\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.hidePlaybackControls = !isControlled;\n\n    if (componentData.audioType) {\n      // This is an old version of this component, which had built-in audio parameters.\n      // The way we are handling it is wrong. If a user created a scene with this old version\n      // of the component, all of these parameters will be present whether the user explicitly set\n      // the values for them or not. But really, they should only count as \"overrides\" if the user\n      // meant for them to take precendence over the app and scene defaults.\n      // TODO: Fix this issue. One option is to just ignore this component data, which might break old scenes\n      //       but simplifying the handling. Another option is to compare the component data here with\n      //       the \"defaults\" and only save the values that are different from the defaults. However,\n      //       this loses information if the user changed the scene settings but wanted this specific\n      //       node to use the \"defaults\".\n      //       I don't see a perfect solution here and would prefer not to handle the \"legacy\" components.\n      //\n      // For legacy components we don't want artificial distance based attenuation to be applied to stereo audios\n      // so we set the distanceModel and rolloffFactor so the attenuation is always 1. The artificial distance based\n      // attenuation is calculated in the gain system for stereo audios.\n      APP.audioOverrides.set(el, {\n        audioType: componentData.audioType,\n        distanceModel:\n          componentData.audioType === AudioType.Stereo ? DistanceModelType.Linear : componentData.distanceModel,\n        rolloffFactor: componentData.audioType === AudioType.Stereo ? 0 : componentData.rolloffFactor,\n        refDistance: componentData.refDistance,\n        maxDistance: componentData.maxDistance,\n        coneInnerAngle: componentData.coneInnerAngle,\n        coneOuterAngle: componentData.coneOuterAngle,\n        coneOuterGain: componentData.coneOuterGain,\n        gain: componentData.volume\n      });\n      APP.sourceType.set(el, SourceType.MEDIA_VIDEO);\n\n      const audio = APP.audios.get(el);\n      if (audio) {\n        updateAudioSettings(el, audio);\n      }\n    }\n\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\n  }\n\n  if ((componentName === \"video\" || componentName === \"image\") && components.link) {\n    mediaOptions.href = sanitizeUrl(components.link.href);\n  }\n\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\n\n  el.setAttribute(\"media-loader\", {\n    src: sanitizeUrl(src),\n    fitToBox: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    mediaOptions,\n    moveTheParentNotTheMesh: true\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"model\", \"model\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"audio\", \"audio\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\n\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\n  el.setAttribute(\"media-loader\", {\n    src: sanitizeUrl(componentData.src),\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    moveTheParentNotTheMesh: true\n  });\n  el.setAttribute(\"css-class\", \"interactable\");\n  el.setAttribute(\"super-spawner\", {\n    src: sanitizeUrl(componentData.src),\n    resolve: true,\n    template: \"#interactable-media\",\n    mediaOptions: componentData.mediaOptions || {}\n  });\n  el.setAttribute(\"hoverable-visuals\", \"\");\n  el.setAttribute(\"body-helper\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nconst publicComponents = {\n  video: {\n    mappedComponent: \"video-pause-state\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  },\n  \"loop-animation\": {\n    mappedComponent: \"loop-animation\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  }\n};\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"trigger-volume\",\n  \"trigger-volume\",\n  (el, componentName, componentData, components, indexToEntityMap) => {\n    const {\n      size,\n      target,\n      enterComponent,\n      enterProperty,\n      enterValue,\n      leaveComponent,\n      leaveProperty,\n      leaveValue\n    } = componentData;\n\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\n\n    try {\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\n\n      // indexToEntityMap should be considered depredcated. These references are now resovled by the GLTFHubsComponentExtension\n      if (typeof target === \"number\") {\n        targetEntity = indexToEntityMap[target];\n      } else {\n        targetEntity = target?.el;\n      }\n\n      if (!targetEntity) {\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\n      }\n    } catch (e) {\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\n      return;\n    }\n\n    // Filter out scope and colliders properties.\n    el.setAttribute(\"trigger-volume\", {\n      colliders: \"#avatar-pov-node\",\n      size,\n      target: targetEntity,\n      enterComponent: enterComponentMapping.mappedComponent,\n      enterProperty: enterComponentMapping.mappedProperty,\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\n      leaveComponent: leaveComponentMapping.mappedComponent,\n      leaveProperty: leaveComponentMapping.mappedProperty,\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"heightfield\", \"heightfield\", (el, componentName, componentData) => {\n  el.setAttribute(\"shape-helper__heightfield\", {\n    type: SHAPE.HEIGHTFIELD,\n    margin: 0.01,\n    fit: FIT.MANUAL,\n    heightfieldDistance: componentData.distance,\n    offset: componentData.offset,\n    heightfieldData: componentData.data\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"trimesh\", \"trimesh\", el => {\n  el.setAttribute(\"shape-helper__trimesh\", {\n    type: SHAPE.MESH,\n    margin: 0.01,\n    fit: FIT.ALL,\n    includeInvisible: true\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"particle-emitter\", \"particle-emitter\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"networked-drawing-buffer\", \"networked-drawing-buffer\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"audio-settings\", \"audio-settings\", (el, _componentName, componentData) => {\n  const removeUndefined = obj => {\n    return Object.entries(obj).reduce((result, [key, value]) => {\n      if (value !== undefined) {\n        result[key] = value;\n      }\n      return result;\n    }, {});\n  };\n  // TODO: This component should only overwrite the scene audio defaults if this\n  //       component is on the scene node. If this component is on some other node\n  //       we don't care about it and should ignore it.\n  APP.sceneAudioDefaults.set(\n    SourceType.MEDIA_VIDEO,\n    removeUndefined({\n      distanceModel: componentData.mediaDistanceModel,\n      rolloffFactor: componentData.mediaRolloffFactor,\n      refDistance: componentData.mediaRefDistance,\n      maxDistance: componentData.mediaMaxDistance,\n      coneInnerAngle: componentData.mediaConeInnerAngle,\n      coneOuterAngle: componentData.mediaConeOuterAngle,\n      coneOuterGain: componentData.mediaConeOuterGain,\n      gain: componentData.mediaVolume\n    })\n  );\n  APP.sceneAudioDefaults.set(\n    SourceType.AVATAR_AUDIO_SOURCE,\n    removeUndefined({\n      distanceModel: componentData.avatarDistanceModel,\n      rolloffFactor: componentData.avatarRolloffFactor,\n      refDistance: componentData.avatarRefDistance,\n      maxDistance: componentData.avatarMaxDistance,\n      coneInnerAngle: componentData.avatarConeInnerAngle,\n      coneOuterAngle: componentData.avatarConeOuterAngle,\n      coneOuterGain: componentData.avatarConeOuterGain,\n      gain: componentData.avatarVolume\n    })\n  );\n  for (const [el, audio] of APP.audios.entries()) {\n    updateAudioSettings(el, audio);\n  }\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"video-texture-target\",\n  \"video-texture-target\",\n  (el, componentName, componentData, _components, indexToEntityMap) => {\n    const { targetBaseColorMap, targetEmissiveMap, srcNode } = componentData;\n\n    let srcEl;\n    if (srcNode !== undefined) {\n      // indexToEntityMap should be considered depredcated. These references are now resovled by the GLTFHubsComponentExtension\n      if (typeof srcNode === \"number\") {\n        srcEl = indexToEntityMap[srcNode];\n      } else {\n        srcEl = srcNode?.el;\n      }\n      if (!srcEl) {\n        console.warn(\n          `Error inflating gltf component \"video-texture-srcEl\": Couldn't find srcEl entity with index ${srcNode}`\n        );\n      }\n    }\n\n    el.setAttribute(componentName, {\n      src: srcEl ? \"el\" : \"\",\n      targetBaseColorMap,\n      targetEmissiveMap,\n      srcEl\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"video-texture-source\", \"video-texture-source\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"text\", \"text\");\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"audio-target\",\n  \"audio-target\",\n  (el, componentName, componentData, _components, indexToEntityMap) => {\n    const { srcNode } = componentData;\n\n    let srcEl;\n    if (srcNode !== undefined) {\n      // indexToEntityMap should be considered depredcated. These references are now resovled by the GLTFHubsComponentExtension\n      if (typeof srcNode === \"number\") {\n        srcEl = indexToEntityMap[srcNode];\n      } else {\n        srcEl = srcNode?.el;\n      }\n      if (!srcEl) {\n        console.warn(\n          `Error inflating gltf component ${componentName}: Couldn't find srcEl entity with index ${srcNode}`\n        );\n      }\n    }\n\n    if (componentData.positional !== undefined) {\n      // This is an old version of the audio-target component, which had built-in audio parameters.\n      // The way we are handling it is wrong. If a user created a scene in spoke with this old version\n      // of this component, all of these parameters will be present whether the user explicitly set\n      // the values for them or not. But really, they should only count as \"overrides\" if the user\n      // meant for them to take precendence over the app and scene defaults.\n      // TODO: Fix this issue. One option is to just ignore this component data, which might break old scenes\n      //       but simplifying the handling. Another option is to compare the component data here with\n      //       the \"defaults\" and only save the values that are different from the defaults. However,\n      //       this loses information if the user changed the scene settings but wanted this specific\n      //       node to use the \"defaults\".\n      //       I don't see a perfect solution here and would prefer not to handle the \"legacy\" components.\n      APP.audioOverrides.set(el, {\n        audioType: componentData.positional ? AudioType.PannerNode : AudioType.Stereo,\n        distanceModel: componentData.distanceModel,\n        rolloffFactor: componentData.rolloffFactor,\n        refDistance: componentData.refDistance,\n        maxDistance: componentData.maxDistance,\n        coneInnerAngle: componentData.coneInnerAngle,\n        coneOuterAngle: componentData.coneOuterAngle,\n        coneOuterGain: componentData.coneOuterGain,\n        gain: componentData.gain\n      });\n      APP.sourceType.set(el, SourceType.AUDIO_TARGET);\n\n      const audio = APP.audios.get(el);\n      if (audio) {\n        updateAudioSettings(el, audio);\n      }\n    }\n\n    el.setAttribute(componentName, {\n      minDelay: componentData.minDelay,\n      maxDelay: componentData.maxDelay,\n      debug: componentData.debug,\n      srcEl\n    });\n  }\n);\nAFRAME.GLTFModelPlus.registerComponent(\"zone-audio-source\", \"zone-audio-source\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"audio-params\", \"audio-params\", (el, componentName, componentData) => {\n  APP.audioOverrides.set(el, componentData);\n  const audio = APP.audios.get(el);\n  if (audio) {\n    updateAudioSettings(el, audio);\n  }\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"audio-zone\", \"audio-zone\", (el, componentName, componentData) => {\n  el.setAttribute(componentName, { ...componentData });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"background\", \"background\", (el, _componentName, componentData) => {\n  console.warn(\n    \"The `background` component is deprecated, use `backgroundColor` on the `environment-settings` component instead.\"\n  );\n  // This assumes the background component is on the root entity, which it is for spoke, the only thing using this component\n  el.setAttribute(\"environment-settings\", { backgroundColor: new THREE.Color(componentData.color) });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"fog\", \"fog\", (el, _componentName, componentData) => {\n  // TODO need to actually implement this in blender exporter before showing this warning\n  // console.warn(\n  //   \"The `fog` component is deprecated, use the fog properties on the `environment-settings` component instead.\"\n  // );\n  // This assumes the fog component is on the root entitycoco\n  el.setAttribute(\"environment-settings\", {\n    fogType: componentData.type,\n    fogColor: new THREE.Color(componentData.color),\n    fogNear: componentData.near,\n    fogFar: componentData.far,\n    fogDensity: componentData.density\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"environment-settings\",\n  \"environment-settings\",\n  (el, componentName, componentData) => {\n    // TODO a bit silly to be storing this as an aframe component. Use a glboal store of some sort\n    el.setAttribute(componentName, {\n      ...componentData,\n      backgroundColor: new THREE.Color(componentData.backgroundColor)\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"reflection-probe\", \"reflection-probe\", (el, componentName, componentData) => {\n  // TODO PMREMGenerator should be fixed to not assume this\n  componentData.envMapTexture.flipY = true;\n  // Assume texture is always an equirect for now\n  componentData.envMapTexture.mapping = THREE.EquirectangularReflectionMapping;\n\n  el.setAttribute(componentName, componentData);\n});\n","import { addComponent, removeComponent } from \"bitecs\";\nimport {\n  RemoteRight,\n  RemoteLeft,\n  HandRight,\n  HandLeft,\n  RemoteHoverTarget,\n  NotRemoteHoverTarget,\n  RemoveNetworkedEntityButton,\n  DestroyAtExtremeDistance\n} from \"./bit-components\";\n\n[\n  [\"remote-right\", RemoteRight],\n  [\"remote-left\", RemoteLeft],\n  [\"hand-right\", HandRight],\n  [\"hand-left\", HandLeft],\n  [\"is-remote-hover-target\", RemoteHoverTarget],\n  [\"is-not-remote-hover-target\", NotRemoteHoverTarget],\n  [\"remove-networked-object-button\", RemoveNetworkedEntityButton],\n  [\"destroy-at-extreme-distances\", DestroyAtExtremeDistance]\n].forEach(([aframeComponentName, bitecsComponent]) => {\n  AFRAME.registerComponent(aframeComponentName, {\n    init: function() {\n      addComponent(APP.world, bitecsComponent, this.el.object3D.eid);\n    },\n    remove: function() {\n      removeComponent(APP.world, bitecsComponent, this.el.object3D.eid);\n    }\n  });\n});\n","import * as bitecs from \"bitecs\";\nimport { addEntity, createWorld } from \"bitecs\";\nimport \"./aframe-to-bit-components\";\nimport { AEntity, Networked, Object3DTag, Owned } from \"./bit-components\";\nimport MediaSearchStore from \"./storage/media-search-store\";\nimport Store from \"./storage/store\";\nimport qsTruthy from \"./utils/qs_truthy\";\n\nwindow.$B = bitecs;\n\nconst timeSystem = world => {\n  const { time } = world;\n  const now = performance.now();\n  const delta = now - time.then;\n  time.delta = delta;\n  time.elapsed += delta;\n  time.then = now;\n  time.tick++;\n  return world;\n};\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n    this.hubChannel = null;\n    this.mediaDevicesManager = null;\n\n    // TODO: Remove comments\n    // TODO: Rename or reconfigure these as needed\n    this.audios = new Map(); //                           el -> (THREE.Audio || THREE.PositionalAudio)\n    this.sourceType = new Map(); //                       el -> SourceType\n    this.audioOverrides = new Map(); //                   el -> AudioSettings\n    this.zoneOverrides = new Map(); //                    el -> AudioSettings\n    this.audioDebugPanelOverrides = new Map(); // SourceType -> AudioSettings\n    this.sceneAudioDefaults = new Map(); //       SourceType -> AudioSettings\n    this.gainMultipliers = new Map(); //                  el -> Number\n    this.supplementaryAttenuation = new Map(); //         el -> Number\n    this.clippingState = new Set();\n    this.mutedState = new Set();\n    this.isAudioPaused = new Set();\n\n    this.world = createWorld();\n\n    // TODO: Create accessor / update methods for these maps / set\n    this.world.eid2obj = new Map(); // eid -> Object3D\n\n    this.world.nid2eid = new Map();\n    this.world.deletedNids = new Set();\n    this.world.ignoredNids = new Set();\n\n    this.str2sid = new Map([[null, 0]]);\n    this.sid2str = new Map([[0, null]]);\n    this.nextSid = 1;\n\n    window.$o = eid => {\n      this.world.eid2obj.get(eid);\n    };\n\n    // reserve entity 0 to avoid needing to check for undefined everywhere eid is checked for existance\n    addEntity(this.world);\n\n    // used in aframe and networked aframe to avoid imports\n    this.world.nameToComponent = {\n      object3d: Object3DTag,\n      networked: Networked,\n      owned: Owned,\n      AEntity\n    };\n  }\n\n  // TODO nothing ever cleans these up\n  getSid(str) {\n    if (!this.str2sid.has(str)) {\n      const sid = this.nextSid;\n      this.nextSid = this.nextSid + 1;\n      this.str2sid.set(str, sid);\n      this.sid2str.set(sid, str);\n      return sid;\n    }\n    return this.str2sid.get(str);\n  }\n\n  getString(sid) {\n    return this.sid2str.get(sid);\n  }\n\n  // This gets called by a-scene to setup the renderer, camera, and audio listener\n  // TODO ideally the contorl flow here would be inverted, and we would setup this stuff,\n  // initialize aframe, and then run our own RAF loop\n  setupRenderer(sceneEl) {\n    const canvas = document.createElement(\"canvas\");\n    canvas.classList.add(\"a-canvas\");\n    canvas.dataset.aframeCanvas = true;\n\n    // TODO this comes from aframe and prevents zoom on ipad.\n    // This should alreeady be handleed by disable-ios-zoom but it does not appear to work\n    canvas.addEventListener(\"touchmove\", function(event) {\n      event.preventDefault();\n    });\n\n    const renderer = new THREE.WebGLRenderer({\n      // TODO we should not be using alpha: false https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#avoid_alphafalse_which_can_be_expensive\n      alpha: true,\n      antialias: true,\n      depth: true,\n      stencil: true,\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: false,\n      logarithmicDepthBuffer: false,\n      // TODO we probably want high-performance\n      powerPreference: \"high-performance\",\n      canvas\n    });\n\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    renderer.debug.checkShaderErrors = qsTruthy(\"checkShaderErrors\");\n\n    // These get overridden by environment-system but setting to the highly expected defaults to avoid any extra work\n    renderer.physicallyCorrectLights = true;\n    renderer.outputEncoding = THREE.sRGBEncoding;\n\n    sceneEl.appendChild(renderer.domElement);\n\n    const camera = new THREE.PerspectiveCamera(80, window.innerWidth / window.innerHeight, 0.05, 10000);\n\n    const audioListener = new THREE.AudioListener();\n    APP.audioListener = audioListener;\n    camera.add(audioListener);\n\n    const renderClock = new THREE.Clock();\n\n    // TODO NAF currently depends on this, it should not\n    sceneEl.clock = renderClock;\n\n    // TODO we should have 1 source of truth for time\n    APP.world.time = {\n      delta: 0,\n      elapsed: 0,\n      then: performance.now(),\n      tick: 0\n    };\n\n    APP.world.scene = sceneEl.object3D;\n\n    // Main RAF loop\n    function mainTick(_rafTime, xrFrame) {\n      // TODO we should probably be using time from the raf loop itself\n      const delta = renderClock.getDelta() * 1000;\n      const time = renderClock.elapsedTime * 1000;\n\n      // TODO pass this into systems that care about it (like input) once they are moved into this loop\n      sceneEl.frame = xrFrame;\n\n      timeSystem(APP.world);\n\n      // Tick AFrame systems and components\n      if (sceneEl.isPlaying) {\n        sceneEl.tick(time, delta);\n      }\n\n      renderer.render(sceneEl.object3D, camera);\n    }\n\n    // This gets called after all system and component init functions\n    sceneEl.addEventListener(\"loaded\", () => {\n      renderer.setAnimationLoop(mainTick);\n      sceneEl.renderStarted = true;\n    });\n\n    return {\n      renderer,\n      camera,\n      audioListener\n    };\n  }\n}\n","import pinnedEntityToGltf from \"./pinned-entity-to-gltf\";\nimport { getPromotionTokenForFile } from \"./media-utils\";\nimport { SignInMessages } from \"../react-components/auth/SignInModal\";\n\nexport default class PinningHelper {\n  constructor(hubChannel, authChannel, store, performConditionalSignIn) {\n    this.hubChannel = hubChannel;\n    this.authChannel = authChannel;\n    this.store = store;\n    this.performConditionalSignIn = performConditionalSignIn;\n  }\n\n  async setPinned(el, pin) {\n    if (NAF.utils.isMine(el)) {\n      this._signInAndPinOrUnpinElement(el, pin);\n    } else {\n      console.warn(\"PinningHelper: Attempted to set pin state on object that was not mine.\");\n    }\n  }\n\n  _signInAndPinOrUnpinElement = (el, pin) => {\n    const action = pin ? () => this._pinElement(el) : () => this.unpinElement(el);\n\n    this.performConditionalSignIn(\n      () => this.hubChannel.signedIn,\n      action,\n      pin ? SignInMessages.pin : SignInMessages.unpin,\n      e => {\n        console.warn(`PinningHelper: Conditional sign-in failed. ${e}`);\n      }\n    );\n  };\n\n  async _pinElement(el) {\n    const { networkId } = el.components.networked.data;\n\n    const { fileId, src } = el.components[\"media-loader\"].data;\n    let fileAccessToken, promotionToken;\n    if (fileId) {\n      fileAccessToken = new URL(src).searchParams.get(\"token\");\n      const storedPromotionToken = getPromotionTokenForFile(fileId);\n      if (storedPromotionToken) {\n        promotionToken = storedPromotionToken.promotionToken;\n      }\n    }\n\n    const gltfNode = pinnedEntityToGltf(el);\n    if (!gltfNode) {\n      console.warn(\"PinningHelper: Entity did not produce a GLTF node.\");\n      return;\n    }\n    el.setAttribute(\"networked\", { persistent: true });\n    el.setAttribute(\"media-loader\", { fileIsOwned: true });\n\n    try {\n      await this.hubChannel.pin(networkId, gltfNode, fileId, fileAccessToken, promotionToken);\n\n      // If we lost ownership of the entity while waiting for the pin to go through,\n      // try to regain ownership before setting the \"pinned\" state.\n      if (!NAF.utils.isMine(el) && !NAF.utils.takeOwnership(el)) {\n        console.warn(\"PinningHelper: Pinning succeeded, but ownership was lost in the mean time\");\n      }\n\n      el.setAttribute(\"pinnable\", \"pinned\", true);\n      el.emit(\"pinned\", { el });\n      this.store.update({ activity: { hasPinned: true } });\n    } catch (e) {\n      if (e.reason === \"invalid_token\") {\n        await this.authChannel.signOut(this.hubChannel);\n        this._signInAndPinOrUnpinElement(el);\n      } else {\n        console.warn(\"PinningHelper: Pin failed for unknown reason\", e);\n      }\n    }\n  }\n\n  unpinElement(el) {\n    const components = el.components;\n    const networked = components.networked;\n\n    if (!networked || !networked.data || !NAF.utils.isMine(el)) {\n      console.warn(\"PinningHelper: Tried to unpin element that is not networked or not mine.\");\n      return;\n    }\n\n    const networkId = components.networked.data.networkId;\n    el.setAttribute(\"networked\", { persistent: false });\n\n    const mediaLoader = components[\"media-loader\"];\n    const fileId = mediaLoader.data && mediaLoader.data.fileId;\n\n    this.hubChannel.unpin(networkId, fileId);\n    el.setAttribute(\"pinnable\", \"pinned\", false);\n    el.emit(\"unpinned\", { el });\n  }\n}\n","export default function pinnedEntityToGltf(el) {\n  if (!NAF.utils.isMine(el)) return;\n\n  // Construct a GLTF node from this entity\n  const object3D = el.object3D;\n  const components = el.components;\n  const networkId = components.networked.data.networkId;\n\n  const gltfComponents = {};\n  // TODO: Move to MOZ_hubs_components and include version number. Requires migration of existing room objects.\n  // Please do this before making a breaking change to the data stored here.\n  const gltfNode = { name: networkId, extensions: { HUBS_components: gltfComponents } };\n\n  // Adapted from three.js GLTFExporter\n  const equalArray = (x, y) => x.length === y.length && x.every((v, i) => v === y[i]);\n  const rotation = object3D.quaternion.toArray();\n  const position = object3D.position.toArray();\n  const scale = object3D.scale.toArray();\n\n  if (!equalArray(rotation, [0, 0, 0, 1])) gltfNode.rotation = rotation;\n  if (!equalArray(position, [0, 0, 0])) gltfNode.translation = position;\n  if (!equalArray(scale, [1, 1, 1])) gltfNode.scale = scale;\n\n  if (components[\"media-loader\"]) {\n    const mediaSrc = components[\"media-loader\"].data.src;\n    const mediaVersion = components[\"media-loader\"].data.version;\n    const mediaContentSubtype = components[\"media-loader\"].data.contentSubtype;\n\n    if (mediaSrc.startsWith(\"hubs://\") && mediaSrc.endsWith(\"/video\")) {\n      // Do not persist hubs client video urls\n      return null;\n    }\n\n    gltfComponents.media = { src: mediaSrc, version: mediaVersion, contentSubtype: mediaContentSubtype, id: networkId };\n\n    if (components[\"media-pdf\"]) {\n      gltfComponents.media.pageIndex = components[\"media-pdf\"].data.index;\n    }\n\n    if (components[\"media-video\"] && components[\"media-video\"].data.videoPaused) {\n      gltfComponents.media.paused = true;\n      gltfComponents.media.time = components[\"media-video\"].data.time;\n    }\n  }\n\n  gltfComponents.pinnable = { pinned: true };\n\n  return gltfNode;\n}\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"scalable-when-grabbed\", {\n  tick: function() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    let deltaScale;\n    if (interaction.state.rightRemote.held === this.el) {\n      deltaScale = userinput.get(paths.actions.cursor.right.scaleGrabbedGrabbable);\n    }\n    if (interaction.state.leftRemote.held === this.el) {\n      deltaScale = userinput.get(paths.actions.cursor.left.scaleGrabbedGrabbable);\n    }\n    if (!deltaScale) return;\n\n    this.el.object3D.scale.addScalar(deltaScale).clampScalar(0.1, 100);\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { paths } from \"../../systems/userinput/paths\";\nimport { getLastWorldPosition, getLastWorldQuaternion } from \"../../utils/three-utils\";\nimport {\n  SOUND_PEN_START_DRAW,\n  SOUND_PEN_STOP_DRAW,\n  SOUND_PEN_UNDO_DRAW,\n  SOUND_PEN_CHANGE_COLOR\n} from \"../../systems/sound-effects-system\";\nimport { waitForDOMContentLoaded } from \"../../utils/async-utils\";\nimport { convertStandardMaterial } from \"../../utils/material-utils\";\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    startDrawing: paths.actions.rightHand.startDrawing,\n    stopDrawing: paths.actions.rightHand.stopDrawing,\n    undoDrawing: paths.actions.rightHand.undoDrawing,\n    switchDrawMode: paths.actions.rightHand.switchDrawMode,\n    penNextColor: paths.actions.rightHand.penNextColor,\n    penPrevColor: paths.actions.rightHand.penPrevColor,\n    scalePenTip: paths.actions.rightHand.scalePenTip\n  },\n  \"player-left-controller\": {\n    startDrawing: paths.actions.leftHand.startDrawing,\n    stopDrawing: paths.actions.leftHand.stopDrawing,\n    undoDrawing: paths.actions.leftHand.undoDrawing,\n    switchDrawMode: paths.actions.leftHand.switchDrawMode,\n    penNextColor: paths.actions.leftHand.penNextColor,\n    penPrevColor: paths.actions.leftHand.penPrevColor,\n    scalePenTip: paths.actions.leftHand.scalePenTip\n  },\n  \"right-cursor\": {\n    pose: paths.actions.cursor.right.pose,\n    startDrawing: paths.actions.cursor.right.startDrawing,\n    stopDrawing: paths.actions.cursor.right.stopDrawing,\n    undoDrawing: paths.actions.cursor.right.undoDrawing,\n    penNextColor: paths.actions.cursor.right.penNextColor,\n    penPrevColor: paths.actions.cursor.right.penPrevColor,\n    scalePenTip: paths.actions.cursor.right.scalePenTip\n  },\n  \"left-cursor\": {\n    pose: paths.actions.cursor.left.pose,\n    startDrawing: paths.actions.cursor.left.startDrawing,\n    stopDrawing: paths.actions.cursor.left.stopDrawing,\n    undoDrawing: paths.actions.cursor.left.undoDrawing,\n    penNextColor: paths.actions.cursor.left.penNextColor,\n    penPrevColor: paths.actions.cursor.left.penPrevColor,\n    scalePenTip: paths.actions.cursor.left.scalePenTip\n  }\n};\n\nconst DRAW_MODE = {\n  DEFAULT_3D: 0,\n  PROJECTION: 1\n};\n\nconst MAX_DISTANCE_BETWEEN_SURFACES = 1;\n\n/**\n * Pen tool\n * A tool that allows drawing on networked-drawing components.\n * @namespace drawing\n * @component pen\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen\", {\n  schema: {\n    drawFrequency: { default: 5 }, //frequency of polling for drawing points\n    minDistanceBetweenPoints: { default: 0.01 }, //minimum distance to register new drawing point\n    camera: { type: \"selector\" },\n    drawingManager: { type: \"string\" },\n    color: { type: \"color\", default: \"#FF0033\" },\n    availableColors: {\n      default: [\n        \"#FF0033\",\n        \"#FFFF00\",\n        \"#0099FF\",\n        \"#00FF33\",\n        \"#9900FF\",\n        \"#FF6600\",\n        \"#8D5524\",\n        \"#C68642\",\n        \"#E0AC69\",\n        \"#F1C27D\",\n        \"#FFDBAC\",\n        \"#FFFFFF\",\n        \"#222222\",\n        \"#111111\",\n        \"#000000\"\n      ]\n    },\n    radius: { default: 0.01 }, //drawing geometry radius\n    minRadius: { default: 0.005 },\n    maxRadius: { default: 0.2 },\n    far: { default: 100 },\n    near: { default: 0.01 },\n    drawMode: { default: DRAW_MODE.DEFAULT_3D, oneOf: [DRAW_MODE.DEFAULT_3D, DRAW_MODE.PROJECTION] },\n    penVisible: { default: true },\n    penTipPosition: { default: { x: 0, y: 0, z: 0 } }\n  },\n\n  init() {\n    this.timeSinceLastDraw = 0;\n\n    this.lastPosition = new THREE.Vector3();\n    this.lastPosition.copy(this.el.object3D.position);\n\n    this.direction = new THREE.Vector3(1, 0, 0);\n\n    this.currentDrawing = null;\n\n    this.normal = new THREE.Vector3();\n\n    this.worldPosition = new THREE.Vector3();\n\n    this.colorIndex = 0;\n\n    this.grabbed = false;\n\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n\n    this.originalPosition = this.el.object3D.position.clone();\n    this.lastIntersectionDistance = 0;\n\n    this.targets = [];\n    this.setDirty = this.setDirty.bind(this);\n    this.dirty = true;\n\n    let material = new THREE.MeshStandardMaterial();\n    const quality = window.APP.store.state.preferences.materialQualitySetting;\n    material = convertStandardMaterial(material, quality);\n\n    this.penTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 16, 12), material);\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n\n    this.el.setObject3D(\"mesh\", this.penTip);\n\n    this.penLaserAttributesUpdated = false;\n    this.penLaserAttributes = {\n      color: \"#FF0033\",\n      laserVisible: false,\n      laserInHand: false,\n      laserOrigin: { x: 0, y: 0, z: 0 },\n      remoteLaserOrigin: { x: 0, y: 0, z: 0 },\n      laserTarget: { x: 0, y: 0, z: 0 }\n    };\n\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.setDirty);\n\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.setDirty);\n      scene.addEventListener(\"object3dremove\", this.setDirty);\n    });\n\n    this.penSystem = this.el.sceneEl.systems[\"pen-tools\"];\n    this.penSystem.register(this.el);\n  },\n\n  play() {\n    this.drawingManager = document.querySelector(this.data.drawingManager).components[\"drawing-manager\"];\n  },\n\n  update(prevData) {\n    if (prevData.color != this.data.color) {\n      this.penTip.material.color.set(this.data.color);\n      this.penLaserAttributes.color = this.data.color;\n      this.el.setAttribute(\"pen-laser\", { color: this.data.color });\n    }\n    if (prevData.radius != this.data.radius) {\n      this.el.setAttribute(\"radius\", this.data.radius);\n    }\n\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick(t, dt) {\n    const isMine = this.el.parentEl.components.networked.initialized && this.el.parentEl.components.networked.isMine();\n\n    if (this.penTip.material.visible !== isMine) {\n      this.penTip.material.visible = isMine;\n    }\n\n    if (isMine) {\n      this._handleInput();\n\n      const cursorPose =\n        this.data.drawMode === DRAW_MODE.PROJECTION &&\n        (this.grabberId === \"right-cursor\" || this.grabberId === \"left-cursor\")\n          ? AFRAME.scenes[0].systems.userinput.get(pathsMap[this.grabberId].pose)\n          : null;\n\n      const intersection = this._getIntersection(cursorPose);\n\n      this._updatePenTip(intersection);\n\n      const laserVisible = this.data.drawMode === DRAW_MODE.PROJECTION && !!intersection;\n      const laserInHand = this.el.sceneEl.is(\"vr-mode\") && laserVisible;\n\n      if (this.penLaserAttributes.laserVisible !== laserVisible) {\n        this.penLaserAttributes.laserVisible = laserVisible;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (this.penLaserAttributes.laserInHand !== laserInHand) {\n        this.penLaserAttributes.laserInHand = laserInHand;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (laserVisible) {\n        this._updateLaser(cursorPose, intersection);\n      }\n\n      const penVisible = (this.grabberId !== \"left-cursor\" && this.grabberId !== \"right-cursor\") || !intersection;\n      this._setPenVisible(penVisible);\n      this.el.setAttribute(\"pen\", { penVisible: penVisible });\n\n      this._doDraw(intersection, dt);\n\n      if (this.penLaserAttributesUpdated) {\n        this.penLaserAttributesUpdated = false;\n        this.el.setAttribute(\"pen-laser\", this.penLaserAttributes, true);\n      }\n    } else {\n      this._setPenVisible(this.data.penVisible);\n    }\n  },\n\n  _handleInput() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    if (interaction.state.rightHand.held === this.el.parentNode) {\n      this.grabberId = \"player-right-controller\";\n    } else if (interaction.state.leftHand.held === this.el.parentNode) {\n      this.grabberId = \"player-left-controller\";\n    } else if (interaction.state.rightRemote.held === this.el.parentNode) {\n      this.grabberId = \"right-cursor\";\n      this.data.drawMode = DRAW_MODE.PROJECTION;\n    } else if (interaction.state.leftRemote.held === this.el.parentNode) {\n      this.grabberId = \"left-cursor\";\n      this.data.drawMode = DRAW_MODE.PROJECTION;\n    } else {\n      this.grabberId = null;\n    }\n\n    if (this.grabberId && pathsMap[this.grabberId]) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      const paths = pathsMap[this.grabberId];\n      if (userinput.get(paths.startDrawing)) {\n        this._startDraw();\n        sfx.playSoundOneShot(SOUND_PEN_START_DRAW);\n      }\n      if (userinput.get(paths.stopDrawing)) {\n        this._endDraw();\n        sfx.playSoundOneShot(SOUND_PEN_STOP_DRAW);\n      }\n      const penScaleMod = userinput.get(paths.scalePenTip);\n      if (penScaleMod) {\n        this._changeRadius(penScaleMod);\n      }\n      if (userinput.get(paths.penNextColor)) {\n        this._changeColor(1);\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n      }\n      if (userinput.get(paths.penPrevColor)) {\n        this._changeColor(-1);\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n      }\n      if (userinput.get(paths.undoDrawing)) {\n        this._undoDraw();\n        sfx.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\n      }\n      if (paths.switchDrawMode && userinput.get(paths.switchDrawMode)) {\n        this.data.drawMode = this.data.drawMode === DRAW_MODE.DEFAULT_3D ? DRAW_MODE.PROJECTION : DRAW_MODE.DEFAULT_3D;\n      }\n    }\n  },\n\n  _getIntersection: (() => {\n    const rawIntersections = [];\n    const worldQuaternion = new THREE.Quaternion();\n    return function(cursorPose) {\n      rawIntersections.length = 0;\n\n      if (this.data.drawMode === DRAW_MODE.PROJECTION) {\n        if (cursorPose) {\n          this.raycaster.ray.origin.copy(cursorPose.position);\n          this.raycaster.ray.direction.copy(cursorPose.direction);\n        } else if (this.grabberId !== null) {\n          getLastWorldPosition(this.el.parentEl.object3D, this.raycaster.ray.origin);\n          getLastWorldQuaternion(this.el.parentEl.object3D, worldQuaternion);\n          this.raycaster.ray.direction.set(0, -1, 0);\n          this.raycaster.ray.direction.applyQuaternion(worldQuaternion);\n        }\n\n        if (this.grabberId !== null) {\n          this.raycaster.intersectObjects(this.targets, true, rawIntersections);\n          return rawIntersections[0];\n        }\n      }\n\n      return null;\n    };\n  })(),\n\n  _updatePenTip(intersection) {\n    if (this.data.drawMode === DRAW_MODE.PROJECTION) {\n      if (intersection) {\n        this.el.object3D.position.copy(intersection.point);\n\n        this.el.parentEl.object3D.worldToLocal(this.el.object3D.position);\n\n        this.el.object3D.matrixNeedsUpdate = true;\n        this.worldPosition.copy(intersection.point);\n      } else {\n        this.el.object3D.position.copy(this.originalPosition);\n        this.el.object3D.matrixNeedsUpdate = true;\n        getLastWorldPosition(this.el.object3D, this.worldPosition);\n      }\n    } else {\n      this.el.object3D.position.copy(this.originalPosition);\n      this.el.object3D.matrixNeedsUpdate = true;\n      getLastWorldPosition(this.el.object3D, this.worldPosition);\n    }\n  },\n\n  _updateLaser: (() => {\n    const laserStartPosition = new THREE.Vector3();\n    const laserEndPosition = new THREE.Vector3();\n    const camerWorldPosition = new THREE.Vector3();\n    const remoteLaserOrigin = new THREE.Vector3();\n    return function(cursorPose, intersection) {\n      if (cursorPose) {\n        laserStartPosition.copy(cursorPose.position);\n      } else {\n        this.el.parentEl.object3D.getWorldPosition(laserStartPosition);\n      }\n\n      laserEndPosition.copy(intersection.point);\n\n      if (this.el.sceneEl.is(\"vr-mode\")) {\n        remoteLaserOrigin.copy(laserStartPosition);\n      } else {\n        this.data.camera.object3D.getWorldPosition(camerWorldPosition);\n        remoteLaserOrigin\n          .subVectors(laserEndPosition, camerWorldPosition)\n          .normalize()\n          .multiplyScalar(0.5);\n        remoteLaserOrigin.add(camerWorldPosition);\n      }\n\n      if (!almostEquals(0.001, this.penLaserAttributes.laserOrigin, laserStartPosition)) {\n        this.penLaserAttributes.laserOrigin.x = laserStartPosition.x;\n        this.penLaserAttributes.laserOrigin.y = laserStartPosition.y;\n        this.penLaserAttributes.laserOrigin.z = laserStartPosition.z;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (!almostEquals(0.001, this.penLaserAttributes.remoteLaserOrigin, remoteLaserOrigin)) {\n        this.penLaserAttributes.remoteLaserOrigin.x = remoteLaserOrigin.x;\n        this.penLaserAttributes.remoteLaserOrigin.y = remoteLaserOrigin.y;\n        this.penLaserAttributes.remoteLaserOrigin.z = remoteLaserOrigin.z;\n        this.penLaserAttributesUpdated = true;\n      }\n\n      if (!almostEquals(0.001, this.penLaserAttributes.laserTarget, laserEndPosition)) {\n        this.penLaserAttributes.laserTarget.x = laserEndPosition.x;\n        this.penLaserAttributes.laserTarget.y = laserEndPosition.y;\n        this.penLaserAttributes.laserTarget.z = laserEndPosition.z;\n        this.penLaserAttributesUpdated = true;\n      }\n    };\n  })(),\n\n  _doDraw(intersection, dt) {\n    //Prevent drawings from \"jumping\" large distances\n    if (\n      this.currentDrawing &&\n      (this.lastIntersectedObject !== (intersection ? intersection.object : null) &&\n        (!intersection ||\n          Math.abs(intersection.distance - this.lastIntersectionDistance) > MAX_DISTANCE_BETWEEN_SURFACES))\n    ) {\n      this.worldPosition.copy(this.lastPosition);\n      this._endDraw();\n    }\n    this.lastIntersectionDistance = intersection ? intersection.distance : 0;\n    this.lastIntersectedObject = intersection ? intersection.object : null;\n\n    if (!almostEquals(0.005, this.worldPosition, this.lastPosition)) {\n      this.direction.subVectors(this.worldPosition, this.lastPosition).normalize();\n      this.lastPosition.copy(this.worldPosition);\n    }\n\n    if (this.currentDrawing) {\n      const time = this.timeSinceLastDraw + dt;\n      if (\n        time >= this.data.drawFrequency &&\n        this.currentDrawing.getLastPoint().distanceTo(this.worldPosition) >= this.data.minDistanceBetweenPoints\n      ) {\n        this._getNormal(this.normal, this.worldPosition, this.direction);\n        this.currentDrawing.draw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n      }\n\n      this.timeSinceLastDraw = time % this.data.drawFrequency;\n    }\n\n    if (this.currentDrawing && !this.grabberId) {\n      this._endDraw();\n    }\n\n    if (this.dirty) {\n      this.populateEntities(this.targets);\n      this.dirty = false;\n    }\n  },\n\n  _setPenVisible(visible) {\n    if (this.el.parentEl.object3DMap.mesh && this.el.parentEl.object3DMap.mesh.visible !== visible) {\n      this.el.parentEl.object3DMap.mesh.visible = visible;\n    }\n  },\n\n  //helper function to get normal of direction of drawing cross direction to camera\n  _getNormal: (() => {\n    const directionToCamera = new THREE.Vector3();\n    return function(normal, position, direction) {\n      directionToCamera.subVectors(position, this.data.camera.object3D.position).normalize();\n      normal.crossVectors(direction, directionToCamera);\n    };\n  })(),\n\n  _startDraw() {\n    this.drawingManager.getDrawing(this).then(drawing => {\n      this.currentDrawing = drawing;\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.startDraw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n    });\n  },\n\n  _endDraw() {\n    if (this.currentDrawing) {\n      this.timeSinceLastDraw = 0;\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.endDraw(this.worldPosition, this.direction, this.normal);\n      this.drawingManager.returnDrawing(this);\n      this.currentDrawing = null;\n    }\n  },\n\n  _undoDraw() {\n    this.drawingManager.getDrawing(this).then(drawing => {\n      drawing.undoDraw();\n      this.drawingManager.returnDrawing(this);\n    });\n  },\n\n  _changeColor(mod) {\n    this.colorIndex = (this.colorIndex + mod + this.data.availableColors.length) % this.data.availableColors.length;\n    this.data.color = this.data.availableColors[this.colorIndex];\n    this.penTip.material.color.set(this.data.color);\n    this.penLaserAttributes.color = this.data.color;\n    this.penLaserAttributesUpdated = true;\n  },\n\n  _changeRadius(mod) {\n    this.data.radius = Math.max(this.data.minRadius, Math.min(this.data.radius + mod, this.data.maxRadius));\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n  },\n\n  setDirty() {\n    this.dirty = true;\n  },\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, #environment-root\");\n    for (let i = 0; i < els.length; i++) {\n      if (!els[i].classList.contains(\"pen\") && els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n  },\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\n    this.penSystem.deregister(this.el);\n  }\n});\n","const InterpolationBuffer = require(\"buffered-interpolation\");\nimport { convertStandardMaterial } from \"../../utils/material-utils\";\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen-laser\", {\n  schema: {\n    color: { type: \"color\", default: \"#FF0033\" },\n    laserVisible: { default: false },\n    laserInHand: { default: false },\n    laserOrigin: { default: { x: 0, y: 0, z: 0 } },\n    remoteLaserOrigin: { default: { x: 0, y: 0, z: 0 } },\n    laserTarget: { default: { x: 0, y: 0, z: 0 } }\n  },\n\n  init() {\n    let material = new THREE.MeshStandardMaterial({ color: \"red\", opacity: 0.5, transparent: true, visible: true });\n    const quality = window.APP.store.state.preferences.materialQualitySetting;\n    material = convertStandardMaterial(material, quality);\n\n    const tipMaterial = material.clone();\n\n    const lineCurve = new THREE.LineCurve3(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 2));\n    const geometry = new THREE.TubeBufferGeometry(lineCurve, 2, 0.003, 8, true);\n    this.laser = new THREE.Mesh(geometry, material);\n\n    this.laserTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 8, 6), tipMaterial);\n    this.laserTip.scale.setScalar(0.01);\n    this.laserTip.matrixNeedsUpdate = true;\n\n    //prevents the line from being a raycast target for the cursor\n    this.laser.raycast = function() {};\n\n    this.el.sceneEl.setObject3D(`pen-laser-${this.laser.uuid}`, this.laser);\n    this.el.sceneEl.setObject3D(`pen-laser-tip-${this.laser.uuid}`, this.laserTip);\n\n    this.originBuffer = new InterpolationBuffer(InterpolationBuffer.MODE_LERP, 0.1);\n    this.targetBuffer = new InterpolationBuffer(InterpolationBuffer.MODE_LERP, 0.1);\n  },\n\n  update: (() => {\n    const originBufferPosition = new THREE.Vector3();\n    const targetBufferPosition = new THREE.Vector3();\n\n    return function(prevData) {\n      if (prevData.color != this.data.color) {\n        this.laser.material.color.set(this.data.color);\n        this.laserTip.material.color.set(this.data.color);\n      }\n\n      if (prevData.remoteLaserOrigin && !almostEquals(0.001, prevData.remoteLaserOrigin, this.data.remoteLaserOrigin)) {\n        this.originBuffer.setPosition(\n          originBufferPosition.set(\n            this.data.remoteLaserOrigin.x,\n            this.data.remoteLaserOrigin.y,\n            this.data.remoteLaserOrigin.z\n          )\n        );\n      }\n\n      if (prevData.laserTarget && !almostEquals(0.001, prevData.laserTarget, this.data.laserTarget)) {\n        this.targetBuffer.setPosition(\n          targetBufferPosition.set(this.data.laserTarget.x, this.data.laserTarget.y, this.data.laserTarget.z)\n        );\n      }\n    };\n  })(),\n\n  tick: (() => {\n    const origin = new THREE.Vector3();\n    const target = new THREE.Vector3();\n    return function(t, dt) {\n      const isMine =\n        this.el.parentEl.components.networked.initialized && this.el.parentEl.components.networked.isMine();\n      let laserVisible = false;\n\n      if (isMine && this.data.laserVisible) {\n        origin.copy(this.data.laserOrigin);\n\n        if (!this.data.laserInHand) {\n          // On 2d mode, shift downards\n          origin.y = origin.y - 0.4;\n        }\n\n        target.copy(this.data.laserTarget);\n        laserVisible = true;\n      } else if (!isMine && this.data.laserVisible) {\n        this.originBuffer.update(dt);\n        this.targetBuffer.update(dt);\n        origin.copy(this.originBuffer.getPosition());\n        target.copy(this.targetBuffer.getPosition());\n        laserVisible = true;\n      }\n\n      if (laserVisible) {\n        this.laser.position.copy(origin);\n        this.laser.lookAt(target);\n        this.laser.scale.set(1, 1, origin.distanceTo(target));\n        this.laser.matrixNeedsUpdate = true;\n        this.laserTip.position.copy(target);\n        this.laserTip.matrixNeedsUpdate = true;\n      }\n\n      if (this.laser.material.visible !== laserVisible) {\n        this.laser.material.visible = laserVisible;\n      }\n\n      const laserTipVisible = laserVisible ? !(isMine && this.data.laserVisible) : false;\n      if (this.laserTip.material.visible !== laserTipVisible) {\n        this.laserTip.material.visible = laserTipVisible;\n      }\n    };\n  })(),\n\n  remove() {\n    this.el.sceneEl.removeObject3D(`pen-laser-${this.laser.uuid}`);\n    this.el.sceneEl.removeObject3D(`pen-laser-tip-${this.laser.uuid}`);\n  }\n});\n","export default class SharedBufferGeometry {\n  constructor(material, maxBufferSize) {\n    this.material = material;\n\n    this.maxBufferSize = maxBufferSize;\n    this.geometries = [];\n    this.current = null;\n    this.drawing = new THREE.Object3D();\n    this.addBuffer();\n  }\n\n  remove(prevIdx, idx) {\n    // Loop through all the attributes: position, color, normal,...\n    if (this.idx.position > idx.position) {\n      for (const key in this.idx) {\n        const componentSize = key === \"index\" ? 1 : 3;\n        let pos = prevIdx[key] * componentSize;\n        const start = (idx[key] + 1) * componentSize;\n        const end = this.idx[key] * componentSize;\n        for (let i = start; i < end; i++) {\n          if (key === \"index\") {\n            //index needs to be handled specially\n            this.current.index.array[pos++] = this.current.index.array[i] - idx.position - 1;\n          } else {\n            this.current.attributes[key].array[pos++] = this.current.attributes[key].array[i];\n          }\n        }\n        const diff = idx[key] - prevIdx[key] + 1;\n        this.idx[key] -= diff;\n      }\n    } else {\n      for (const key in this.idx) {\n        const diff = idx[key] - prevIdx[key];\n        this.idx[key] -= diff;\n      }\n    }\n\n    this.update();\n  }\n\n  undo(prevIdx) {\n    this.idx = prevIdx;\n    this.update();\n  }\n\n  addBuffer() {\n    const geometry = new THREE.BufferGeometry();\n\n    const vertices = new Float32Array(this.maxBufferSize * 3);\n    const normals = new Float32Array(this.maxBufferSize * 3);\n    const colors = new Float32Array(this.maxBufferSize * 3);\n    const indices = new Uint32Array(this.maxBufferSize * 3);\n\n    const mesh = new THREE.Mesh(geometry, this.material);\n\n    mesh.frustumCulled = false;\n    mesh.vertices = vertices;\n\n    const object3D = new THREE.Object3D();\n    this.drawing.add(object3D);\n    object3D.add(mesh);\n\n    geometry.setDrawRange(0, 0);\n    geometry.setAttribute(\"position\", new THREE.BufferAttribute(vertices, 3).setUsage(THREE.DynamicDrawUsage));\n    geometry.setAttribute(\"normal\", new THREE.BufferAttribute(normals, 3).setUsage(THREE.DynamicDrawUsage));\n    geometry.setAttribute(\"color\", new THREE.BufferAttribute(colors, 3).setUsage(THREE.DynamicDrawUsage));\n    geometry.setIndex(new THREE.BufferAttribute(indices, 1).setUsage(THREE.DynamicDrawUsage));\n\n    this.previous = null;\n    if (this.geometries.length > 0) {\n      this.previous = this.current;\n    }\n\n    this.idx = {\n      position: 0,\n      normal: 0,\n      color: 0,\n      index: 0\n    };\n\n    this.geometries.push(geometry);\n    this.current = geometry;\n  }\n\n  addColor(r, g, b) {\n    this.current.attributes.color.setXYZ(this.idx.color++, r, g, b);\n  }\n\n  addNormal(x, y, z) {\n    this.current.attributes.normal.setXYZ(this.idx.normal++, x, y, z);\n  }\n\n  addVertex(x, y, z) {\n    const buffer = this.current.attributes.position;\n    if (this.idx.position === buffer.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    }\n    buffer.setXYZ(this.idx.position++, x, y, z);\n  }\n\n  addIndex(a, b, c) {\n    this.current.index.setXYZ(this.idx.index, a, b, c);\n    this.idx.index += 3;\n  }\n\n  update() {\n    this.current.setDrawRange(0, this.idx.index);\n\n    this.current.attributes.color.needsUpdate = true;\n    this.current.attributes.normal.needsUpdate = true;\n    this.current.attributes.position.needsUpdate = true;\n    this.current.index.needsUpdate = true;\n  }\n\n  computeBoundingSpheres() {\n    for (let i = 0; i < this.geometries.length; i++) {\n      this.geometries[i].computeBoundingSphere();\n    }\n  }\n}\n","import SharedBufferGeometry from \"./sharedbuffergeometry\";\n\nexport default class SharedBufferGeometryManager {\n  constructor() {\n    this.sharedBuffers = {};\n  }\n\n  addSharedBuffer(name, material, maxBufferSize) {\n    this.sharedBuffers[name] = new SharedBufferGeometry(material, maxBufferSize);\n  }\n\n  getSharedBuffer(name) {\n    return this.sharedBuffers[name];\n  }\n}\n","/* global THREE */\n/**\n * Networked Drawing\n * Creates procedurally generated 'lines' (or tubes) that are networked.\n * @namespace drawing\n * @component networked-drawing\n */\n\nimport SharedBufferGeometryManager from \"../../utils/sharedbuffergeometrymanager\";\nimport { GLTFExporter } from \"three/examples/jsm/exporters/GLTFExporter\";\nimport { convertStandardMaterial } from \"../../utils/material-utils\";\nimport { addMedia, addMeshScaleAnimation } from \"../../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../../object-types\";\nimport { SOUND_PEN_START_DRAW } from \"../../systems/sound-effects-system\";\n\nconst MSG_CONFIRM_CONNECT = 0;\nconst MSG_BUFFER_DATA = 1;\nconst MSG_BUFFER_DATA_FULL = 2;\n\nfunction copyData(fromArray, toArray, fromIndex, toIndex) {\n  let i = fromIndex - 1;\n  let j = -1;\n  while (i + 1 <= toIndex) {\n    toArray[++j] = fromArray[++i];\n  }\n}\n\nAFRAME.registerComponent(\"networked-drawing\", {\n  schema: {\n    segments: { default: 8 }, //the number of \"sides\" the procedural tube should have\n    defaultRadius: { default: 0.01 }, //the radius of the procedural tube\n    maxDrawTimeout: { default: 600000 }, //the maximum time a drawn line will live\n    maxLines: { default: 50 }, //how many lines can persist before lines older than minDrawTime are removed\n    maxPointsPerLine: { default: 250 } //the max number of points a single line can have\n  },\n\n  init() {\n    this._receiveData = this._receiveData.bind(this);\n\n    this.networkBuffer = [];\n\n    this.sendNetworkBufferQueue = [];\n\n    this.drawStarted = false;\n    this.lineStarted = false;\n    this.remoteLineStarted = false;\n\n    this.receivedBufferParts = 0;\n    this.bufferIndex = 0;\n    this.connectedToOwner = false;\n    this.networkBufferInitialized = false;\n\n    const options = {\n      vertexColors: true\n    };\n\n    this.color = new THREE.Color();\n    this.radius = this.data.defaultRadius;\n    this.segments = this.data.segments;\n\n    let material = new THREE.MeshStandardMaterial(options);\n\n    const quality = window.APP.store.state.preferences.materialQualitySetting;\n    material = convertStandardMaterial(material, quality);\n\n    this.sharedBufferGeometryManager = new SharedBufferGeometryManager();\n    // NOTE: 20 is approximate for how many floats per point are added.\n    // maxLines + 1 because a line can be currently drawing while at maxLines.\n    // Multiply by 1/3 (0.333) because 3 floats per vertex (x, y, z).\n    const maxBufferSize = Math.round(this.data.maxPointsPerLine * 20 * (this.data.maxLines + 1) * 0.333);\n    this.sharedBufferGeometryManager.addSharedBuffer(0, material, maxBufferSize);\n\n    this.lastPoint = new THREE.Vector3();\n\n    this.lastSegments = [];\n    this.currentSegments = [];\n    for (let x = 0; x < this.segments; x++) {\n      this.lastSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n      this.currentSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n    }\n\n    this.sharedBuffer = this.sharedBufferGeometryManager.getSharedBuffer(0);\n    this.drawing = this.sharedBuffer.drawing;\n\n    this.el.setObject3D(\"mesh\", this.drawing);\n\n    this.prevIdx = Object.assign({}, this.sharedBuffer.idx);\n    this.idx = Object.assign({}, this.sharedBuffer.idx);\n    this.vertexCount = 0; //number of vertices added for current line (used for line deletion).\n    this.indexCount = 0; //number of indexes added for current line (used for line deletion);\n    this.networkBufferCount = 0; //number of items added to networkBuffer for current line (used for line deletion).\n    this.currentPointCount = 0; //number of points added for current line (used for maxPointsPerLine).\n    this.invalidPointRead = false; //flag flipped if we read a bad point anywhere during this line\n    this.lastReadPointCount = 0; //last read point count read off of the network, used for sanity checking\n    this.networkBufferHistory = []; //tracks vertexCount and networkBufferCount so that lines can be deleted.\n\n    NAF.connection.onConnect(() => {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkId = NAF.utils.getNetworkId(this.networkedEl);\n        this.drawingId = \"drawing-\" + this.networkId;\n        NAF.connection.subscribeToDataChannel(this.drawingId, this._receiveData);\n      });\n    });\n  },\n\n  play() {\n    AFRAME.scenes[0].systems[\"hubs-systems\"].drawingMenuSystem.registerDrawingMenu(this.el);\n  },\n\n  remove() {\n    NAF.connection.unsubscribeToDataChannel(this.drawingId, this._receiveData);\n\n    this.drawStarted = false;\n\n    this.el.removeObject3D(\"mesh\");\n\n    const drawingManager = this.el.sceneEl.querySelector(\"#drawing-manager\").components[\"drawing-manager\"];\n    drawingManager.destroyDrawing(this);\n\n    AFRAME.scenes[0].systems[\"hubs-systems\"].drawingMenuSystem.unregisterDrawingMenu(this.el);\n  },\n\n  tick(t) {\n    const connected = NAF.connection.isConnected() && this.networkedEl;\n    const isMine = connected && NAF.utils.isMine(this.networkedEl);\n\n    if (!this.connectedToOwner && connected) {\n      const owner = NAF.utils.getNetworkOwner(this.networkedEl);\n      if (!isMine && NAF.connection.hasActiveDataChannel(owner)) {\n        NAF.connection.sendDataGuaranteed(owner, this.drawingId, {\n          type: MSG_CONFIRM_CONNECT,\n          clientId: NAF.clientId\n        });\n        this.connectedToOwner = true;\n      }\n    }\n\n    if (this.networkBuffer.length > 0 && connected) {\n      if (!isMine) {\n        this._drawFromNetwork();\n      } else if (this.bufferIndex < this.networkBuffer.length) {\n        this._broadcastDrawing();\n      }\n    }\n\n    //TODO: handle possibility that a clientId gets stuck in sendNetworkBufferQueue\n    //if that client disconnects before this executes and an activeDataChannel is opened.\n    if (isMine && this.sendNetworkBufferQueue.length > 0) {\n      const connected = [];\n      for (let i = 0; i < this.sendNetworkBufferQueue.length; i++) {\n        if (NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[i])) {\n          connected.push(this.sendNetworkBufferQueue[i]);\n        }\n      }\n      for (let j = 0; j < connected.length; j++) {\n        const pos = this.sendNetworkBufferQueue.indexOf(connected[j]);\n        this._sendNetworkBuffer(connected[j]);\n        this.sendNetworkBufferQueue.splice(pos, 1);\n      }\n    }\n\n    this._deleteExpiredLines(t);\n  },\n\n  cloneMesh(sharedBufferGeometry) {\n    const originalGeometry = sharedBufferGeometry.current;\n    const idx = sharedBufferGeometry.idx;\n    const geometry = new THREE.BufferGeometry();\n\n    const positions = originalGeometry.getAttribute(\"position\").array.subarray(0, idx.position * 3);\n    const colors = originalGeometry.getAttribute(\"color\").array.subarray(0, idx.color * 3);\n    const normals = originalGeometry.getAttribute(\"normal\").array.subarray(0, idx.normal * 3);\n    const indices = originalGeometry.index.array.subarray(0, idx.index);\n\n    geometry.setAttribute(\"position\", new THREE.BufferAttribute(positions, 3));\n    geometry.setAttribute(\"color\", new THREE.BufferAttribute(colors, 3));\n    geometry.setAttribute(\"normal\", new THREE.BufferAttribute(normals, 3));\n    geometry.setIndex(new THREE.BufferAttribute(indices, 1));\n\n    const material = new THREE.MeshStandardMaterial({\n      vertexColors: THREE.VertexColors\n    });\n    return new THREE.Mesh(geometry, material);\n  },\n\n  async serializeDrawing() {\n    const exporter = new GLTFExporter();\n\n    //mesh needs to be cloned before exporting to get rid of excess geometry information\n    const mesh = this.cloneMesh(this.sharedBuffer);\n\n    mesh.userData.gltfExtensions = {\n      MOZ_hubs_components: {\n        version: 4,\n        \"networked-drawing-buffer\": { buffer: this.networkBuffer }\n      }\n    };\n\n    // TODO: Proper error handling\n    const glb = await new Promise((resolve, reject) => {\n      exporter.parse(mesh, resolve, reject, {\n        binary: true,\n        includeCustomExtensions: true\n      });\n    });\n\n    const file = new File([glb], \"drawing.glb\", {\n      type: \"model/gltf-binary\"\n    });\n\n    const { entity } = addMedia(file, \"#interactable-media\", ObjectContentOrigins.FILE, \"drawing\", false, false);\n\n    const min = new THREE.Vector3(Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY);\n    const max = new THREE.Vector3(Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY);\n    const temp = new THREE.Vector3();\n\n    const attribute = this.sharedBuffer.current.attributes.position;\n    for (let i = 0; i < this.sharedBuffer.idx.position; i++) {\n      temp.set(attribute.getX(i), attribute.getY(i), attribute.getZ(i));\n      min.min(temp);\n      max.max(temp);\n    }\n\n    entity.object3D.position.addVectors(min, max).multiplyScalar(0.5);\n    entity.object3D.matrixNeedsUpdate = true;\n  },\n\n  deserializeDrawing: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function(buffer) {\n      let head = buffer[0];\n      if (head === \"-\") {\n        this._undoDraw();\n        buffer.shift();\n        head = buffer[0];\n      }\n\n      while (head != null && buffer.length >= 11) {\n        position.set(buffer[1], buffer[2], buffer[3]);\n        direction.set(buffer[4], buffer[5], buffer[6]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(buffer[7], buffer[8], buffer[9]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        buffer.splice(0, 10);\n\n        if (!this.drawStarted) {\n          this.startDraw(position, direction, normal);\n        } else if (buffer[0] !== null) {\n          this.draw(position, direction, normal);\n        }\n\n        if (buffer[0] === null) {\n          this.endDraw(position, direction, normal);\n          buffer.shift();\n        }\n      }\n    };\n  })(),\n\n  _broadcastDrawing: (() => {\n    const copyArray = [];\n    return function() {\n      copyArray.length = 0;\n      copyData(this.networkBuffer, copyArray, this.bufferIndex, this.networkBuffer.length - 1);\n\n      //remove undo's from networkBuffer after they've been sent so that\n      //newly joining clients don't get them\n      let index = -1;\n      while ((index = this.networkBuffer.indexOf(\"-\")) != -1) {\n        this.networkBuffer.splice(index, 1);\n      }\n      this.bufferIndex = this.networkBuffer.length;\n      NAF.connection.broadcastDataGuaranteed(this.drawingId, { type: MSG_BUFFER_DATA, buffer: copyArray });\n    };\n  })(),\n\n  _drawFromNetwork: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function() {\n      let head = this.networkBuffer[0];\n      if (head === \"-\") {\n        this._undoDraw();\n        this.networkBuffer.shift();\n        head = this.networkBuffer[0];\n      }\n      let didWork = false;\n      while (head != null && this.networkBuffer.length >= 11) {\n        const pointCount = this.networkBuffer[0];\n\n        // This is a sanity check against the sequence number to help uncover remaining bugs.\n        // If the point is out-of-order, report the error and stop drawing this line.\n        if (pointCount !== this.lastReadPointCount + 1) {\n          this.invalidPointRead = true;\n\n          console.error(\n            `Draw networking error: ID ${this.drawingId} expected point ${this.lastReadPointCount +\n              1} but received ${pointCount}`\n          );\n        }\n\n        this.lastReadPointCount = pointCount;\n        position.set(this.networkBuffer[1], this.networkBuffer[2], this.networkBuffer[3]);\n        direction.set(this.networkBuffer[4], this.networkBuffer[5], this.networkBuffer[6]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(this.networkBuffer[7], this.networkBuffer[8], this.networkBuffer[9]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        this.networkBuffer.splice(0, 10);\n\n        if (!this.remoteLineStarted) {\n          this.startDraw(position, direction, normal);\n          this.remoteLineStarted = true;\n        }\n\n        if (this.networkBuffer[0] === null) {\n          if (!this.invalidPointRead) {\n            this._endDraw(position, direction, normal);\n          }\n\n          this.remoteLineStarted = false;\n          this.networkBuffer.shift();\n          this.lastReadPointCount = 0;\n          this.invalidPointRead = false;\n        } else {\n          if (!this.invalidPointRead) {\n            this._draw(position, direction, normal);\n            didWork = true;\n          }\n        }\n      }\n      if (didWork) this._updateBuffer();\n    };\n  })(),\n\n  _deleteExpiredLines(time) {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const drawTime = this.networkBufferHistory[0].time;\n      if (length > this.data.maxLines || drawTime + this.data.maxDrawTimeout <= time) {\n        const datum = this.networkBufferHistory[0];\n        this.idx.position = datum.vertexCount;\n        this.idx.normal = datum.vertexCount;\n        this.idx.color = datum.vertexCount;\n        this.idx.index = datum.indexCount;\n        this.sharedBuffer.remove(this.prevIdx, this.idx);\n        this.networkBufferHistory.shift();\n        if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n          this.networkBuffer.splice(0, datum.networkBufferCount);\n          this.bufferIndex -= datum.networkBufferCount;\n        }\n      }\n    }\n  },\n\n  _sendNetworkBuffer: (() => {\n    const copyArray = [];\n    //This number needs to be approx. < ~6000 based on napkin math\n    //see: https://github.com/webrtc/adapter/blob/682e0f2439e139da6c0c406370eae820637b8sc1a/src/js/common_shim.js#L157\n    const chunkAmount = 3000;\n    return function(clientId) {\n      if (NAF.utils.isMine(this.networkedEl)) {\n        if (this.networkBuffer.length <= chunkAmount) {\n          NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n            type: MSG_BUFFER_DATA_FULL,\n            parts: 1,\n            buffer: this.networkBuffer\n          });\n        } else {\n          let start = 0;\n          let end = 0;\n          while (end < this.networkBuffer.length) {\n            end = Math.min(end + chunkAmount, this.networkBuffer.length);\n            copyArray.length = 0;\n            copyData(this.networkBuffer, copyArray, start, end - 1);\n            start = end;\n            NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n              type: MSG_BUFFER_DATA_FULL,\n              parts: Math.ceil(this.networkBuffer.length / chunkAmount),\n              buffer: copyArray\n            });\n          }\n        }\n      }\n    };\n  })(),\n\n  _receiveData(_, dataType, data) {\n    switch (data.type) {\n      case MSG_CONFIRM_CONNECT:\n        this.sendNetworkBufferQueue.push(data.clientId);\n        break;\n      case MSG_BUFFER_DATA:\n        if (this.networkBufferInitialized) {\n          this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        }\n        break;\n      case MSG_BUFFER_DATA_FULL:\n        this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        if (++this.receivedBufferParts >= data.parts) {\n          this.networkBufferInitialized = true;\n        }\n        break;\n    }\n  },\n\n  getLastPoint() {\n    return this.lastPoint;\n  },\n\n  startDraw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected()) {\n      return;\n    }\n\n    this.drawStarted = true;\n\n    if (color) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this.lastPoint.copy(position);\n    this._addToNetworkBuffer(position, direction, normal);\n  },\n\n  draw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected() || !this.drawStarted) {\n      return;\n    }\n\n    if (color && color != \"#\" + this.color.getHexString().toUpperCase()) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this._addToNetworkBuffer(position, direction, normal);\n    this._draw(position, direction, normal);\n\n    this._updateBuffer();\n  },\n\n  _draw: (() => {\n    const capNormal = new THREE.Vector3();\n    return function(position, direction, normal, radiusMultiplier = 1.0) {\n      if (!this.lineStarted) {\n        this._generateSegments(this.lastSegments, position, direction, normal, this.radius * radiusMultiplier);\n\n        //get normal for tip of cap\n        capNormal.copy(direction).negate();\n        //get normals for rim of cap\n        for (let i = 0; i < this.segments; i++) {\n          this.lastSegments[i].normal.add(capNormal).multiplyScalar(0.5);\n        }\n\n        this._drawStartCap(this.lastPoint, this.lastSegments, capNormal);\n\n        this.lineStarted = true;\n      } else {\n        this._generateSegments(this.currentSegments, position, direction, normal, this.radius * radiusMultiplier);\n        this._drawCylinder();\n\n        if (this.currentPointCount > this.data.maxPointsPerLine) {\n          this._drawProjectedEndCap(position, direction);\n          this._endLine();\n        }\n      }\n      this.lastPoint.copy(position);\n    };\n  })(),\n\n  undoDraw() {\n    if (!NAF.connection.isConnected() || this.drawStarted) {\n      return;\n    }\n    this._undoDraw();\n    this._pushToNetworkBuffer(\"-\");\n  },\n\n  _undoDraw() {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const datum = this.networkBufferHistory.pop();\n      this.idx.position = 0;\n      this.idx.normal = 0;\n      this.idx.color = 0;\n      this.idx.index = 0;\n      if (length > 1) {\n        this.idx.position = this.sharedBuffer.idx.position - datum.vertexCount - 1;\n        this.idx.normal = this.sharedBuffer.idx.normal - datum.vertexCount - 1;\n        this.idx.color = this.sharedBuffer.idx.color - datum.vertexCount - 1;\n        this.idx.index = this.sharedBuffer.idx.index - datum.indexCount - 1;\n      }\n      this.sharedBuffer.remove(this.idx, this.sharedBuffer.idx);\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        this.networkBuffer.splice(this.networkBuffer.length - datum.networkBufferCount, datum.networkBufferCount);\n        this.bufferIndex -= datum.networkBufferCount;\n      }\n    }\n  },\n\n  endDraw(position, direction, normal) {\n    this._endDraw(position, direction, normal);\n    this._updateBuffer();\n  },\n\n  _endDraw(position, direction, normal) {\n    if (!this.lineStarted && this.drawStarted) {\n      this._drawPoint(position);\n    } else if (this.lineStarted && this.drawStarted) {\n      this._addToNetworkBuffer(position, direction, normal);\n      this._draw(position, direction, normal);\n      this._drawProjectedEndCap(position, direction);\n    }\n    this._endLine();\n  },\n\n  _drawProjectedEndCap: (() => {\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position, direction) {\n      if (this.lineStarted && this.drawStarted) {\n        projectedDirection.copy(direction).multiplyScalar(this.radius);\n        projectedPoint.copy(position).add(projectedDirection);\n        this._drawEndCap(projectedPoint, direction);\n      }\n    };\n  })(),\n\n  _endLine() {\n    if (!this.drawStarted) return;\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) this._pushToNetworkBuffer(null);\n\n    const datum = {\n      networkBufferCount: this.networkBufferCount,\n      vertexCount: this.vertexCount - 1,\n      indexCount: this.indexCount - 1,\n      time: this.el.sceneEl.clock.elapsedTime * 1000\n    };\n    this.networkBufferHistory.push(datum);\n    this.vertexCount = 0;\n    this.indexCount = 0;\n    this.networkBufferCount = 0;\n    this.currentPointCount = 0;\n    this.lineStarted = false;\n    this.drawStarted = false;\n\n    this.sharedBuffer.computeBoundingSpheres();\n  },\n\n  _addToNetworkBuffer: (() => {\n    const copyDirection = new THREE.Vector3();\n    const copyNormal = new THREE.Vector3();\n    return function(position, direction, normal) {\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        ++this.currentPointCount;\n        this._pushToNetworkBuffer(this.currentPointCount);\n        this._pushToNetworkBuffer(position.x);\n        this._pushToNetworkBuffer(position.y);\n        this._pushToNetworkBuffer(position.z);\n        copyDirection.copy(direction);\n        copyDirection.setLength(this.radius); //encode radius as length of direction vector\n        this._pushToNetworkBuffer(copyDirection.x);\n        this._pushToNetworkBuffer(copyDirection.y);\n        this._pushToNetworkBuffer(copyDirection.z);\n        copyNormal.copy(normal);\n        copyNormal.setLength(this.color.getHex() + 1); //encode color as length, add one in case color is black\n        this._pushToNetworkBuffer(copyNormal.x);\n        this._pushToNetworkBuffer(copyNormal.y);\n        this._pushToNetworkBuffer(copyNormal.z);\n      }\n    };\n  })(),\n\n  _pushToNetworkBuffer(val) {\n    //don't increment networkBufferCount if undo, because the undo character\n    //will be removed in tick() on the next frame\n    if (val !== \"-\") {\n      ++this.networkBufferCount;\n    }\n    this.networkBuffer.push(val);\n  },\n\n  //draw a cylinder from last to current segments\n  _drawCylinder() {\n    //average the normals with the normals from the lastSegment\n    //not a perfect normal calculation, but works well enough\n    for (let i = 0; i < this.segments; i++) {\n      this.currentSegments[i].normal.add(this.lastSegments[i].normal).multiplyScalar(0.5);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this._addVertex(this.currentSegments[i]);\n    }\n\n    const bufferVertexCount = this.sharedBuffer.idx.position;\n\n    for (let i = 0; i < this.segments; i++) {\n      const a = bufferVertexCount - (this.segments + (this.segments - i));\n      const b = i + 1 < this.segments ? a + 1 : bufferVertexCount - 2 * this.segments;\n      const c = bufferVertexCount - (this.segments - i);\n      const d = i + 1 < this.segments ? c + 1 : bufferVertexCount - this.segments;\n\n      this._addIndex(c, a, b);\n      this._addIndex(c, b, d);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this.lastSegments[i].position.copy(this.currentSegments[i].position);\n      this.lastSegments[i].normal.copy(this.currentSegments[i].normal);\n    }\n  },\n\n  //draw a standalone point in space\n  _drawPoint: (() => {\n    const up = new THREE.Vector3(0, 1, 0);\n    const down = new THREE.Vector3(0, -1, 0);\n    const left = new THREE.Vector3(1, 0, 0);\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position) {\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n      this.lastPoint.copy(projectedPoint);\n\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      this._draw(position, down, left);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n\n      this._drawEndCap(projectedPoint, down);\n    };\n  })(),\n\n  _drawStartCap(point, segments, normal) {\n    this._addVertex({ position: point, normal: normal });\n\n    for (let i = 0; i < this.segments; i++) {\n      this._addVertex(segments[i]);\n    }\n\n    const bufferVertexCount = this.sharedBuffer.idx.position;\n    const a = bufferVertexCount - this.segments - 1;\n    for (let i = 0; i < this.segments; i++) {\n      const b = bufferVertexCount - (this.segments - i);\n      const c = i + 1 < this.segments ? b + 1 : bufferVertexCount - this.segments;\n      this._addIndex(a, c, b);\n    }\n  },\n\n  _drawEndCap(point, normal) {\n    this._addVertex({ position: point, normal: normal });\n\n    const bufferVertexCount = this.sharedBuffer.idx.position;\n    const a = bufferVertexCount - 1;\n    for (let i = 0; i < this.segments; i++) {\n      const b = bufferVertexCount - (this.segments - i) - 1;\n      const c = i + 1 < this.segments ? b + 1 : bufferVertexCount - this.segments - 1;\n      this._addIndex(a, b, c);\n    }\n  },\n\n  _updateBuffer() {\n    this.sharedBuffer.update();\n  },\n\n  _addVertex(segment) {\n    const point = segment.position;\n    const normal = segment.normal;\n    this.sharedBuffer.addVertex(point.x, point.y, point.z);\n    this.sharedBuffer.addColor(this.color.r, this.color.g, this.color.b);\n\n    if (normal) {\n      this.sharedBuffer.addNormal(normal.x, normal.y, normal.z);\n    } else {\n      ++this.sharedBuffer.idx.normal;\n    }\n\n    ++this.vertexCount;\n  },\n\n  _addIndex(a, b, c) {\n    this.sharedBuffer.addIndex(a, b, c);\n    this.indexCount += 3;\n  },\n\n  //calculate the segments for a given point\n  _generateSegments(segmentsList, point, forward, up, radius) {\n    const angleIncrement = (Math.PI * 2) / this.segments;\n    for (let i = 0; i < this.segments; i++) {\n      const segment = segmentsList[i].position;\n      this._rotatePointAroundAxis(segment, point, forward, up, angleIncrement * i, radius);\n      segmentsList[i].normal.subVectors(segment, point).normalize();\n    }\n  },\n\n  _rotatePointAroundAxis: (() => {\n    const calculatedDirection = new THREE.Vector3();\n    return function(out, point, axis, up, angle, radius) {\n      calculatedDirection.copy(up);\n      calculatedDirection.applyAxisAngle(axis, angle);\n      out.copy(point).add(calculatedDirection.normalize().multiplyScalar(radius));\n    };\n  })()\n});\n\nAFRAME.registerComponent(\"networked-drawing-buffer\", {\n  schema: {\n    buffer: { default: [] }\n  },\n\n  play() {\n    const button = this._getDeserializeButton(this.el.parentEl);\n    if (button) {\n      button.object3D.visible = true;\n      button.components[\"deserialize-drawing-button\"].networkedDrawingBuffer = this;\n    }\n  },\n\n  _getDeserializeButton(entity) {\n    if (entity.classList.contains(\"interactable\")) {\n      return entity.querySelector(\".deserialize-drawing\");\n    } else if (entity.parentEl) {\n      return this._getDeserializeButton(entity.parentEl);\n    } else {\n      return null;\n    }\n  }\n});\n\nAFRAME.registerComponent(\"deserialize-drawing-button\", {\n  init() {\n    const drawingManager = this.el.sceneEl.querySelector(\"#drawing-manager\").components[\"drawing-manager\"];\n    this.networkedDrawingBuffer = null;\n\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      const finishDrawing = () => {\n        drawingManager.drawing.deserializeDrawing(this.networkedDrawingBuffer.data.buffer);\n        addMeshScaleAnimation(drawingManager.drawing.el.object3DMap.mesh, { x: 0.001, y: 0.001, z: 0.001 });\n\n        if (this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned) {\n          window.APP.pinningHelper.setPinned(this.targetEl, false);\n        }\n        this.targetEl.parentEl.removeChild(this.targetEl);\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PEN_START_DRAW);\n      };\n\n      //serialize any existing drawing and clear the drawing.\n      if (drawingManager.drawing) {\n        drawingManager.drawing.serializeDrawing().then(() => {\n          drawingManager.drawing.el.parentEl.removeChild(drawingManager.drawing.el);\n          drawingManager.destroyDrawing(drawingManager.drawing);\n\n          drawingManager.createDrawing().then(finishDrawing);\n        });\n      } else {\n        drawingManager.createDrawing().then(finishDrawing);\n      }\n    };\n\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    if (this.networkedDrawingBuffer) {\n      const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n      const canPin = window.APP.hubChannel.can(\"pin_objects\") && window.APP.hubChannel.signedIn;\n      this.el.object3D.visible = (!isPinned || canPin) && window.APP.hubChannel.can(\"spawn_drawing\");\n    } else {\n      this.el.object3D.visible = false;\n    }\n  }\n});\n","import { addComponent, removeComponent } from \"bitecs\";\nimport { CONSTANTS } from \"three-ammo\";\nimport { Rigidbody } from \"../bit-components\";\nconst ACTIVATION_STATE = CONSTANTS.ACTIVATION_STATE,\n  TYPE = CONSTANTS.TYPE;\n\nexport const ACTIVATION_STATES = [\n  ACTIVATION_STATE.ACTIVE_TAG,\n  ACTIVATION_STATE.ISLAND_SLEEPING,\n  ACTIVATION_STATE.WANTS_DEACTIVATION,\n  ACTIVATION_STATE.DISABLE_DEACTIVATION,\n  ACTIVATION_STATE.DISABLE_SIMULATION\n];\n\nAFRAME.registerComponent(\"body-helper\", {\n  schema: {\n    loadedEvent: { default: \"\" },\n    mass: { default: 1 },\n    gravity: { type: \"vec3\", default: { x: 0, y: -9.8, z: 0 } },\n    linearDamping: { default: 0.01 },\n    angularDamping: { default: 0.01 },\n    linearSleepingThreshold: { default: 1.6 },\n    angularSleepingThreshold: { default: 2.5 },\n    angularFactor: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    activationState: {\n      default: ACTIVATION_STATE.ACTIVE_TAG,\n      oneOf: ACTIVATION_STATES\n    },\n    type: { default: \"dynamic\", oneOf: [TYPE.STATIC, TYPE.DYNAMIC, TYPE.KINEMATIC] },\n    emitCollisionEvents: { default: false },\n    disableCollision: { default: false },\n    collisionFilterGroup: { default: 1 }, //32-bit mask,\n    collisionFilterMask: { default: 1 }, //32-bit mask\n    scaleAutoUpdate: { default: true }\n  },\n\n  init: function() {\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n    this.alive = true;\n    this.el.object3D.updateMatrices();\n    this.uuid = this.system.addBody(this.el.object3D, this.data);\n    const eid = this.el.object3D.eid;\n    addComponent(APP.world, Rigidbody, eid);\n    Rigidbody.bodyId[eid] = this.uuid; //uuid is a lie, it's actually an int\n  },\n\n  update: function(prevData) {\n    if (prevData) {\n      this.system.updateBody(this.uuid, this.data);\n    }\n  },\n\n  remove: function() {\n    this.system.removeBody(this.uuid);\n    const eid = this.el.object3D.eid;\n    removeComponent(APP.world, Rigidbody, eid);\n    this.alive = false;\n  }\n});\n","import { SHAPE, FIT } from \"three-ammo/constants\";\n\nAFRAME.registerComponent(\"shape-helper\", {\n  schema: {\n    type: {\n      default: SHAPE.HULL,\n      oneOf: [\n        SHAPE.BOX,\n        SHAPE.CYLINDER,\n        SHAPE.SPHERE,\n        SHAPE.CAPSULE,\n        SHAPE.CONE,\n        SHAPE.HULL,\n        SHAPE.HACD,\n        SHAPE.VHACD,\n        SHAPE.MESH,\n        SHAPE.HEIGHTFIELD\n      ]\n    },\n    fit: { default: FIT.ALL, oneOf: [FIT.ALL, FIT.MANUAL] },\n    halfExtents: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    minHalfExtent: { default: 0 },\n    maxHalfExtent: { default: Number.POSITIVE_INFINITY },\n    sphereRadius: { default: NaN },\n    cylinderAxis: { default: \"y\", oneOf: [\"x\", \"y\", \"z\"] },\n    margin: { default: 0.01 },\n    offset: { type: \"vec3\", default: { x: 0, y: 0, z: 0 } },\n    orientation: { type: \"vec4\", default: { x: 0, y: 0, z: 0, w: 1 } },\n    heightfieldData: { default: [] },\n    heightfieldDistance: { default: 1 },\n    includeInvisible: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\n    this.uuid = -1;\n    this.mesh = null;\n\n    let bodyEl = this.el;\n    this.bodyHelper = bodyEl.components[\"body-helper\"] || null;\n    while (!this.bodyHelper && bodyEl.parentNode != this.el.sceneEl) {\n      bodyEl = bodyEl.parentNode;\n      if (bodyEl.components[\"body-helper\"]) {\n        this.bodyHelper = bodyEl.components[\"body-helper\"];\n      }\n    }\n    if (!this.bodyHelper || this.bodyHelper.uuid === null || this.bodyHelper.uuid === undefined) {\n      console.error(\"body not found\");\n      return;\n    }\n    if (this.data.fit === FIT.ALL) {\n      if (!this.el.object3DMap.mesh) {\n        console.error(\"Cannot use FIT.ALL without object3DMap.mesh\");\n        return;\n      }\n      this.mesh = this.el.object3DMap.mesh;\n      this.mesh.updateMatrices();\n    }\n\n    this.uuid = this.system.addShapes(this.bodyHelper.uuid, this.mesh, this.data);\n  },\n\n  remove: function() {\n    // Removing a body already cleans up it's shapes\n    if (this.uuid !== -1 && this.bodyHelper.alive) {\n      this.system.removeShapes(this.bodyHelper.uuid, this.uuid);\n    }\n  }\n});\n","import Raven from \"raven-js\";\nimport configs from \"./utils/configs\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = configs.SENTRY_DSN;\n  const gaTrackingId = configs.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { IntlProvider } from \"react-intl\";\nimport \"@formatjs/intl-locale/polyfill\";\nimport \"@formatjs/intl-pluralrules/polyfill\";\nimport \"@formatjs/intl-pluralrules/locale-data/en\";\nimport \"@formatjs/intl-relativetimeformat/polyfill\";\nimport \"@formatjs/intl-relativetimeformat/locale-data/en\";\nimport { getLocale, getMessages } from \"../utils/i18n\";\n\nexport class WrappedIntlProvider extends React.Component {\n  static propTypes = {\n    children: PropTypes.node.isRequired\n  };\n\n  state = {\n    locale: getLocale(),\n    messages: getMessages()\n  };\n\n  updateLocale = () => {\n    this.setState({ locale: getLocale(), messages: getMessages() });\n  };\n\n  componentDidMount() {\n    this.updateLocale();\n    window.addEventListener(\"locale-updated\", this.updateLocale);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"locale-updated\", this.updateLocale);\n  }\n\n  render() {\n    return (\n      <IntlProvider locale={this.state.locale} messages={this.state.messages}>\n        {this.props.children}\n      </IntlProvider>\n    );\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./OAuthScreen.scss\";\nimport { Modal } from \"../modal/Modal\";\nimport { Column } from \"../layout/Column\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Button } from \"../input/Button\";\nimport { LegalMessage } from \"./LegalMessage\";\n\nconst providerLabel = {\n  discord: \"Discord\",\n  slack: \"Slack\"\n};\nexport function OAuthScreen({ provider, redirectUrl, termsUrl, privacyUrl, ...rest }) {\n  return (\n    <div className={styles.oauthScreen} {...rest}>\n      <Modal title={<FormattedMessage id=\"oauth-screen.title\" defaultMessage=\"Sign In To Continue\" />}>\n        <Column center padding>\n          <p>\n            <FormattedMessage\n              id=\"oauth-screen.description\"\n              defaultMessage=\"You'll need to sign in to {provider} to access this room.\"\n              values={{ provider: providerLabel[provider] }}\n            />\n          </p>\n          <p>\n            <FormattedMessage\n              id=\"oauth-screen.email-reason\"\n              defaultMessage=\"We'll ask for access to your e-mail address so you can skip signing in next time.\"\n            />\n          </p>\n          <p>\n            <small>\n              <LegalMessage termsUrl={termsUrl} privacyUrl={privacyUrl} />\n            </small>\n          </p>\n          <Button as=\"a\" href={redirectUrl} preset={provider === \"discord\" ? \"accent5\" : \"accent4\"}>\n            <FormattedMessage\n              id=\"oauth-screen.sign-in-button\"\n              defaultMessage=\"Sign Into {provider}\"\n              values={{ provider: providerLabel[provider] }}\n            />\n          </Button>\n        </Column>\n      </Modal>\n    </div>\n  );\n}\n\nOAuthScreen.propTypes = {\n  provider: PropTypes.string.isRequired,\n  redirectUrl: PropTypes.string.isRequired,\n  termsUrl: PropTypes.string,\n  privacyUrl: PropTypes.string\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"oauth-screen\":\"OAuthScreen__oauth-screen__qY3Hq\",\"oauthScreen\":\"OAuthScreen__oauth-screen__qY3Hq\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport configs from \"../../utils/configs\";\nimport { OAuthScreen } from \"./OAuthScreen\";\nimport { TERMS, PRIVACY } from \"../../constants\";\n\nexport function OAuthScreenContainer({ oauthInfo }) {\n  const { url, type } = oauthInfo[0];\n\n  return (\n    <OAuthScreen\n      provider={type}\n      redirectUrl={url}\n      termsUrl={configs.feature(\"show_terms\") && configs.link(\"terms_of_use\", TERMS)}\n      privacyUrl={configs.feature(\"show_privacy\") && configs.link(\"privacy_notice\", PRIVACY)}\n    />\n  );\n}\n\nOAuthScreenContainer.propTypes = {\n  oauthInfo: PropTypes.array\n};\n","import {\n  getCurrentHubId,\n  updateVRHudPresenceCount,\n  updateSceneCopresentState,\n  createHubChannelParams\n} from \"./utils/hub-utils\";\nimport \"./utils/debug-log\";\nimport configs from \"./utils/configs\";\nimport \"./utils/theme\";\nimport \"@babel/polyfill\";\n\nconsole.log(\n  `App version: ${\n    configs.IS_LOCAL_OR_CUSTOM_CLIENT\n      ? `Custom client or local client (undeploy custom client to run build ${process.env.BUILD_VERSION})`\n      : process.env.BUILD_VERSION || \"?\"\n  }`\n);\n\nimport \"./react-components/styles/global.scss\";\nimport \"./assets/stylesheets/globals.scss\";\nimport \"./assets/stylesheets/hub.scss\";\nimport loadingEnvironment from \"./assets/models/LoadingEnvironment.glb\";\n\nimport \"aframe\";\nimport \"./utils/aframe-overrides\";\n\n// A-Frame hardcodes THREE.Cache.enabled = true\n// But we don't want to use THREE.Cache because\n// web browser cache should work well.\n// So we disable it here.\nTHREE.Cache.enabled = false;\n\nimport \"./utils/logging\";\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"networked-aframe/src/index\";\nimport \"webrtc-adapter\";\nimport { detectOS, detect } from \"detect-browser\";\nimport {\n  getReticulumFetchUrl,\n  getReticulumMeta,\n  migrateChannelToSocket,\n  connectToReticulum,\n  denoisePresence,\n  presenceEventsForHub,\n  tryGetMatchingMeta\n} from \"./utils/phoenix-utils\";\nimport { Presence } from \"phoenix\";\nimport { emitter } from \"./emitter\";\nimport \"./phoenix-adapter\";\n\nimport nextTick from \"./utils/next-tick\";\nimport { addAnimationComponents } from \"./utils/animation\";\nimport Cookies from \"js-cookie\";\nimport { DialogAdapter, DIALOG_CONNECTION_ERROR_FATAL, DIALOG_CONNECTION_CONNECTED } from \"./naf-dialog-adapter\";\nimport \"./change-hub\";\n\nimport \"./components/scene-components\";\nimport \"./components/mute-mic\";\nimport \"./components/bone-mute-state-indicator\";\nimport \"./components/bone-visibility\";\nimport \"./components/fader\";\nimport \"./components/in-world-hud\";\nimport \"./components/emoji\";\nimport \"./components/emoji-hud\";\nimport \"./components/virtual-gamepad-controls\";\nimport \"./components/ik-controller\";\nimport \"./components/hand-controls2\";\nimport \"./components/hoverable-visuals\";\nimport \"./components/hover-visuals\";\nimport \"./components/offset-relative-to\";\nimport \"./components/player-info\";\nimport \"./components/name-tag\";\nimport \"./components/debug\";\nimport \"./components/hand-poses\";\nimport \"./components/hud-controller\";\nimport \"./components/freeze-controller\";\nimport \"./components/icon-button\";\nimport \"./components/text-button\";\nimport \"./components/block-button\";\nimport \"./components/mute-button\";\nimport \"./components/kick-button\";\nimport \"./components/close-vr-notice-button\";\nimport \"./components/leave-room-button\";\nimport \"./components/visible-if-permitted\";\nimport \"./components/visibility-on-content-types\";\nimport \"./components/hide-when-pinned-and-forbidden\";\nimport \"./components/visibility-while-frozen\";\nimport \"./components/stats-plus\";\nimport \"./components/networked-avatar\";\nimport \"./components/media-video\";\nimport \"./components/media-pdf\";\nimport \"./components/media-image\";\nimport \"./components/avatar-volume-controls\";\nimport \"./components/pinch-to-move\";\nimport \"./components/pitch-yaw-rotator\";\nimport \"./components/position-at-border\";\nimport \"./components/pinnable\";\nimport \"./components/pin-networked-object-button\";\nimport \"./components/mirror-media-button\";\nimport \"./components/close-mirrored-media-button\";\nimport \"./components/drop-object-button\";\nimport \"./components/camera-focus-button\";\nimport \"./components/unmute-video-button\";\nimport \"./components/visible-to-owner\";\nimport \"./components/emit-state-change\";\nimport \"./components/action-to-event\";\nimport \"./components/action-to-remove\";\nimport \"./components/emit-scene-event-on-remove\";\nimport \"./components/follow-in-fov\";\nimport \"./components/clone-media-button\";\nimport \"./components/open-media-button\";\nimport \"./components/refresh-media-button\";\nimport \"./components/tweet-media-button\";\nimport \"./components/remix-avatar-button\";\nimport \"./components/transform-object-button\";\nimport \"./components/scale-button\";\nimport \"./components/hover-menu\";\nimport \"./components/disable-frustum-culling\";\nimport \"./components/teleporter\";\nimport \"./components/track-pose\";\nimport \"./components/replay\";\nimport \"./components/visibility-by-path\";\nimport \"./components/tags\";\nimport \"./components/periodic-full-syncs\";\nimport \"./components/inspect-button\";\nimport \"./components/inspect-pivot-child-selector\";\nimport \"./components/inspect-pivot-offset-from-camera\";\nimport \"./components/optional-alternative-to-not-hide\";\nimport \"./components/avatar-audio-source\";\nimport \"./components/avatar-inspect-collider\";\nimport \"./components/video-texture-target\";\nimport \"./components/mirror\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { Router, Route } from \"react-router-dom\";\nimport { createBrowserHistory, createMemoryHistory } from \"history\";\nimport { pushHistoryState } from \"./utils/history\";\nimport UIRoot from \"./react-components/ui-root\";\nimport { ExitedRoomScreenContainer } from \"./react-components/room/ExitedRoomScreenContainer\";\nimport AuthChannel from \"./utils/auth-channel\";\nimport HubChannel from \"./utils/hub-channel\";\nimport LinkChannel from \"./utils/link-channel\";\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\nimport { proxiedUrlFor } from \"./utils/media-url-utils\";\nimport { traverseMeshesAndAddShapes } from \"./utils/physics-utils\";\nimport { handleExitTo2DInterstitial, exit2DInterstitialAndEnterVR } from \"./utils/vr-interstitial\";\nimport { getAvatarSrc } from \"./utils/avatar-utils.js\";\nimport MessageDispatch from \"./message-dispatch\";\nimport SceneEntryManager from \"./scene-entry-manager\";\nimport Subscriptions from \"./subscriptions\";\nimport { createInWorldLogMessage } from \"./react-components/chat-message\";\n\nimport \"./systems/nav\";\nimport \"./systems/frame-scheduler\";\nimport \"./systems/personal-space-bubble\";\nimport \"./systems/app-mode\";\nimport \"./systems/permissions\";\nimport \"./systems/exit-on-blur\";\nimport \"./systems/auto-pixel-ratio\";\nimport \"./systems/idle-detector\";\nimport \"./systems/pen-tools\";\nimport \"./systems/userinput/userinput\";\nimport \"./systems/userinput/userinput-debug\";\nimport \"./systems/ui-hotkeys\";\nimport \"./systems/tips\";\nimport \"./systems/interactions\";\nimport \"./systems/hubs-systems\";\nimport \"./systems/capture-system\";\nimport \"./systems/listed-media\";\nimport \"./systems/linked-media\";\nimport \"./systems/audio-debug-system\";\nimport \"./systems/audio-gain-system\";\n\nimport \"./gltf-component-mappings\";\n\nimport { App } from \"./App\";\nimport MediaDevicesManager from \"./utils/media-devices-manager\";\nimport PinningHelper from \"./utils/pinning-helper\";\nimport { sleep } from \"./utils/async-utils\";\nimport { platformUnsupported } from \"./support\";\n\nwindow.APP = new App();\nwindow.APP.dialog = new DialogAdapter();\nwindow.APP.RENDER_ORDER = {\n  HUD_BACKGROUND: 1,\n  HUD_ICONS: 2,\n  CURSOR: 3\n};\n\nconst store = window.APP.store;\nstore.update({ preferences: { shouldPromptForRefresh: false } }); // Clear flag that prompts for refresh from preference screen\nconst mediaSearchStore = window.APP.mediaSearchStore;\nconst OAUTH_FLOW_PERMS_TOKEN_KEY = \"ret-oauth-flow-perms-token\";\nconst NOISY_OCCUPANT_COUNT = 30; // Above this # of occupants, we stop posting join/leaves/renames\n\nconst qs = new URLSearchParams(location.search);\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isEmbed = window.self !== window.top;\nif (isEmbed && !qs.get(\"embed_token\")) {\n  // Should be covered by X-Frame-Options, but just in case.\n  throw new Error(\"no embed token\");\n}\n\nTHREE.Object3D.DefaultMatrixAutoUpdate = false;\n\nimport \"./components/owned-object-limiter\";\nimport \"./components/owned-object-cleanup-timeout\";\nimport \"./components/set-unowned-body-kinematic\";\nimport \"./components/scalable-when-grabbed\";\nimport \"./components/networked-counter\";\nimport \"./components/event-repeater\";\nimport \"./components/set-yxz-order\";\n\nimport \"./components/cursor-controller\";\n\nimport \"./components/tools/pen\";\nimport \"./components/tools/pen-laser\";\nimport \"./components/tools/networked-drawing\";\nimport \"./components/tools/drawing-manager\";\n\nimport \"./components/body-helper\";\nimport \"./components/shape-helper\";\n\nimport registerNetworkSchemas from \"./network-schemas\";\nimport registerTelemetry from \"./telemetry\";\n\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY, ONLY_SCREEN_AVAILABLE } from \"./utils/vr-caps-detect\";\nimport detectConcurrentLoad from \"./utils/concurrent-load-detector\";\n\nimport qsTruthy from \"./utils/qs_truthy\";\nimport { WrappedIntlProvider } from \"./react-components/wrapped-intl-provider\";\nimport { ExitReason } from \"./react-components/room/ExitedRoomScreen\";\nimport { OAuthScreenContainer } from \"./react-components/auth/OAuthScreenContainer\";\nimport { SignInMessages } from \"./react-components/auth/SignInModal\";\nimport { ThemeProvider } from \"./react-components/styles/theme\";\nimport { LogMessageType } from \"./react-components/room/ChatSidebar\";\n\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\nNAF.options.firstSyncSource = PHOENIX_RELIABLE_NAF;\nNAF.options.syncSource = PHOENIX_RELIABLE_NAF;\n\nlet isOAuthModal = false;\n\n// OAuth popup handler\n// TODO: Replace with a new oauth callback route that has this postMessage script.\ntry {\n  if (window.opener && window.opener.doingTwitterOAuth) {\n    window.opener.postMessage(\"oauth-successful\");\n    isOAuthModal = true;\n    window.close();\n  }\n} catch (e) {\n  console.error(\"Exception in oauth processing code\", e);\n}\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isTelemetryDisabled = qsTruthy(\"disable_telemetry\");\nconst isDebug = qsTruthy(\"debug\");\n\nif (!isBotMode && !isTelemetryDisabled) {\n  registerTelemetry(\"/hub\", \"Room Landing Page\");\n}\n\ndisableiOSZoom();\n\nif (!isOAuthModal) {\n  detectConcurrentLoad();\n}\n\nfunction setupLobbyCamera() {\n  console.log(\"Setting up lobby camera\");\n  const camera = document.getElementById(\"scene-preview-node\");\n  const previewCamera = document.getElementById(\"environment-scene\").object3D.getObjectByName(\"scene-preview-camera\");\n\n  if (previewCamera) {\n    camera.object3D.position.copy(previewCamera.position);\n    camera.object3D.rotation.copy(previewCamera.rotation);\n    camera.object3D.rotation.reorder(\"YXZ\");\n  } else {\n    const cameraPos = camera.object3D.position;\n    camera.object3D.position.set(cameraPos.x, 2.5, cameraPos.z);\n  }\n\n  camera.object3D.matrixNeedsUpdate = true;\n\n  camera.removeAttribute(\"scene-preview-camera\");\n  camera.setAttribute(\"scene-preview-camera\", \"positionOnly: true; duration: 60\");\n}\n\nlet uiProps = {};\n\n// Hub ID and slug are the basename\nlet routerBaseName = document.location.pathname.split(\"/\").slice(0, 2).join(\"/\");\n\nif (document.location.pathname.includes(\"hub.html\")) {\n  routerBaseName = \"/\";\n}\n\n// when loading the client as a \"default room\" on the homepage, use MemoryHistory since exposing all the client paths at the root is undesirable\nconst history = routerBaseName === \"/\" ? createMemoryHistory() : createBrowserHistory({ basename: routerBaseName });\nwindow.APP.history = history;\n\nconst qsVREntryType = qs.get(\"vr_entry_type\");\n\nfunction mountUI(props = {}) {\n  const scene = document.querySelector(\"a-scene\");\n  const disableAutoExitOnIdle =\n    qsTruthy(\"allow_idle\") || (process.env.NODE_ENV === \"development\" && !qs.get(\"idle_timeout\"));\n  const forcedVREntryType = qsVREntryType;\n\n  ReactDOM.render(\n    <WrappedIntlProvider>\n      <ThemeProvider store={store}>\n        <Router history={history}>\n          <Route\n            render={routeProps =>\n              props.showOAuthScreen ? (\n                <OAuthScreenContainer oauthInfo={props.oauthInfo} />\n              ) : props.roomUnavailableReason ? (\n                <ExitedRoomScreenContainer reason={props.roomUnavailableReason} />\n              ) : (\n                <UIRoot\n                  {...{\n                    scene,\n                    isBotMode,\n                    disableAutoExitOnIdle,\n                    forcedVREntryType,\n                    store,\n                    mediaSearchStore,\n                    ...props,\n                    ...routeProps\n                  }}\n                />\n              )\n            }\n          />\n        </Router>\n      </ThemeProvider>\n    </WrappedIntlProvider>,\n    document.getElementById(\"ui-root\")\n  );\n}\n\nexport function remountUI(props) {\n  uiProps = { ...uiProps, ...props };\n  mountUI(uiProps);\n}\n\nexport async function getSceneUrlForHub(hub) {\n  let sceneUrl;\n  let isLegacyBundle; // Deprecated\n  if (hub.scene) {\n    isLegacyBundle = false;\n    sceneUrl = hub.scene.model_url;\n  } else if (hub.scene === null) {\n    // delisted/removed scene\n    sceneUrl = loadingEnvironment;\n  } else {\n    const defaultSpaceTopic = hub.topics[0];\n    const glbAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"glb\");\n    const bundleAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"gltf_bundle\");\n    sceneUrl = (glbAsset || bundleAsset).src || loadingEnvironment;\n    const hasExtension = /\\.gltf/i.test(sceneUrl) || /\\.glb/i.test(sceneUrl);\n    isLegacyBundle = !(glbAsset || hasExtension);\n  }\n\n  if (qsTruthy(\"debugLocalScene\") && sceneUrl?.startsWith(\"blob:\")) {\n    // we skip doing this if you haven't entered because refreshing the page will invalidate blob urls and break loading\n    sceneUrl = document.querySelector(\"a-scene\").is(\"entered\") ? sceneUrl : loadingEnvironment;\n  } else if (isLegacyBundle) {\n    // Deprecated\n    const res = await fetch(sceneUrl);\n    const data = await res.json();\n    const baseURL = new URL(THREE.LoaderUtils.extractUrlBase(sceneUrl), window.location.href);\n    sceneUrl = new URL(data.assets[0].src, baseURL).href;\n  } else {\n    sceneUrl = proxiedUrlFor(sceneUrl);\n  }\n  return sceneUrl;\n}\n\nexport async function updateEnvironmentForHub(hub, entryManager) {\n  console.log(\"Updating environment for hub\");\n  const sceneUrl = await getSceneUrlForHub(hub);\n\n  const sceneErrorHandler = () => {\n    remountUI({ roomUnavailableReason: ExitReason.sceneError });\n    entryManager.exitScene();\n  };\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n  const sceneEl = document.querySelector(\"a-scene\");\n\n  const envSystem = sceneEl.systems[\"hubs-systems\"].environmentSystem;\n\n  console.log(`Scene URL: ${sceneUrl}`);\n  const loadStart = performance.now();\n\n  let environmentEl = null;\n\n  if (environmentScene.childNodes.length === 0) {\n    const environmentEl = document.createElement(\"a-entity\");\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        environmentEl.removeEventListener(\"model-error\", sceneErrorHandler);\n\n        console.log(`Scene file initial load took ${Math.round(performance.now() - loadStart)}ms`);\n\n        // Show the canvas once the model has loaded\n        document.querySelector(\".a-canvas\").classList.remove(\"a-hidden\");\n\n        sceneEl.addState(\"visible\");\n\n        envSystem.updateEnvironment(environmentEl);\n\n        //TODO: check if the environment was made with spoke to determine if a shape should be added\n        traverseMeshesAndAddShapes(environmentEl);\n      },\n      { once: true }\n    );\n\n    environmentEl.addEventListener(\"model-error\", sceneErrorHandler, { once: true });\n\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl, useCache: false, inflate: true });\n    environmentScene.appendChild(environmentEl);\n  } else {\n    // Change environment\n    environmentEl = environmentScene.childNodes[0];\n\n    // Clear the three.js image cache and load the loading environment before switching to the new one.\n    THREE.Cache.clear();\n    const waypointSystem = sceneEl.systems[\"hubs-systems\"].waypointSystem;\n    waypointSystem.releaseAnyOccupiedWaypoints();\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        environmentEl.addEventListener(\n          \"model-loaded\",\n          () => {\n            environmentEl.removeEventListener(\"model-error\", sceneErrorHandler);\n\n            envSystem.updateEnvironment(environmentEl);\n\n            console.log(`Scene file update load took ${Math.round(performance.now() - loadStart)}ms`);\n\n            traverseMeshesAndAddShapes(environmentEl);\n\n            // We've already entered, so move to new spawn point once new environment is loaded\n            if (sceneEl.is(\"entered\")) {\n              waypointSystem.moveToSpawnPoint();\n            }\n\n            const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\n\n            // Add a slight delay before de-in to reduce hitching.\n            setTimeout(() => fader.fadeIn(), 2000);\n          },\n          { once: true }\n        );\n\n        sceneEl.emit(\"leaving_loading_environment\");\n        if (environmentEl.components[\"gltf-model-plus\"].data.src === sceneUrl) {\n          console.warn(\"Updating environment to the same url.\");\n          environmentEl.setAttribute(\"gltf-model-plus\", { src: \"\" });\n        }\n        environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl });\n      },\n      { once: true }\n    );\n\n    if (!sceneEl.is(\"entered\")) {\n      environmentEl.addEventListener(\"model-error\", sceneErrorHandler, { once: true });\n    }\n\n    if (environmentEl.components[\"gltf-model-plus\"].data.src === loadingEnvironment) {\n      console.warn(\"Transitioning to loading environment but was already in loading environment.\");\n      environmentEl.setAttribute(\"gltf-model-plus\", { src: \"\" });\n    }\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: loadingEnvironment });\n  }\n}\n\nexport async function updateUIForHub(hub, hubChannel) {\n  remountUI({ hub, entryDisallowed: !hubChannel.canEnterRoom(hub) });\n}\n\nfunction onConnectionError(entryManager, connectError) {\n  console.error(\"An error occurred while attempting to connect to networked scene:\", connectError);\n  // hacky until we get return codes\n  const isFull = connectError.msg && connectError.msg.match(/\\bfull\\b/i);\n  remountUI({ roomUnavailableReason: isFull ? ExitReason.full : ExitReason.connectError });\n  entryManager.exitScene();\n}\n\n// TODO: Find a home for this\n// TODO: Naming. Is this an \"event bus\"?\nconst events = emitter();\nfunction handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data, permsToken) {\n  const scene = document.querySelector(\"a-scene\");\n  const isRejoin = NAF.connection.isConnected();\n\n  if (isRejoin) {\n    // Slight hack, to ensure correct presence state we need to re-send the entry event\n    // on re-join. Ideally this would be updated into the channel socket state but this\n    // would require significant changes to the hub channel events and socket management.\n    if (scene.is(\"entered\")) {\n      hubChannel.sendEnteredEvent();\n    }\n\n    // Send complete sync on phoenix re-join.\n    // TODO: We should be able to safely remove this completeSync now that\n    //       NAF occupancy is driven from phoenix presence state.\n    NAF.connection.entities.completeSync(null, true);\n    return;\n  }\n\n  // Turn off NAF for embeds as an optimization, so the user's browser isn't getting slammed\n  // with NAF traffic on load.\n  if (isEmbed) {\n    hubChannel.allowNAFTraffic(false);\n  }\n\n  const hub = data.hubs[0];\n  let embedToken = hub.embed_token;\n\n  if (!embedToken) {\n    const embedTokenEntry = store.state.embedTokens && store.state.embedTokens.find(t => t.hubId === hub.hub_id);\n\n    if (embedTokenEntry) {\n      embedToken = embedTokenEntry.embedToken;\n    }\n  }\n\n  console.log(`Dialog host: ${hub.host}:${hub.port}`);\n\n  remountUI({\n    messageDispatch: messageDispatch,\n    onSendMessage: messageDispatch.dispatch,\n    onLoaded: () => store.executeOnLoadActions(scene),\n    onMediaSearchResultEntrySelected: (entry, selectAction) =>\n      scene.emit(\"action_selected_media_result_entry\", { entry, selectAction }),\n    onMediaSearchCancelled: entry => scene.emit(\"action_media_search_cancelled\", entry),\n    onAvatarSaved: entry => scene.emit(\"action_avatar_saved\", entry),\n    embedToken: embedToken\n  });\n\n  scene.addEventListener(\"action_selected_media_result_entry\", e => {\n    const { entry, selectAction } = e.detail;\n    if ((entry.type !== \"scene_listing\" && entry.type !== \"scene\") || selectAction !== \"use\") return;\n    if (!hubChannel.can(\"update_hub\")) return;\n\n    hubChannel.updateScene(entry.url);\n  });\n\n  // Handle request for user gesture\n  scene.addEventListener(\"2d-interstitial-gesture-required\", () => {\n    remountUI({\n      showInterstitialPrompt: true,\n      onInterstitialPromptClicked: () => {\n        remountUI({ showInterstitialPrompt: false, onInterstitialPromptClicked: null });\n        scene.emit(\"2d-interstitial-gesture-complete\");\n      }\n    });\n  });\n\n  scene.addEventListener(\n    \"didConnectToNetworkedScene\",\n    () => {\n      // Append objects once we are in the NAF room since ownership may be taken.\n      const objectsScene = document.querySelector(\"#objects-scene\");\n      const objectsUrl = getReticulumFetchUrl(`/${hub.hub_id}/objects.gltf`);\n      const objectsEl = document.createElement(\"a-entity\");\n\n      objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\n\n      if (!isBotMode) {\n        objectsScene.appendChild(objectsEl);\n      }\n    },\n    { once: true }\n  );\n\n  scene.setAttribute(\"networked-scene\", {\n    room: hub.hub_id,\n    serverURL: `wss://${hub.host}:${hub.port}`, // TODO: This is confusing because this is the dialog host and port.\n    debug: !!isDebug,\n    adapter: \"phoenix\"\n  });\n\n  (async () => {\n    while (!scene.components[\"networked-scene\"] || !scene.components[\"networked-scene\"].data) await nextTick();\n\n    const loadEnvironmentAndConnect = () => {\n      console.log(\"Loading environment and connecting to dialog servers\");\n\n      updateEnvironmentForHub(hub, entryManager);\n\n      // Disconnect in case this is a re-entry\n      APP.dialog.disconnect();\n      APP.dialog.connect({\n        serverUrl: `wss://${hub.host}:${hub.port}`,\n        roomId: hub.hub_id,\n        joinToken: permsToken,\n        serverParams: { host: hub.host, port: hub.port, turn: hub.turn },\n        scene,\n        clientId: data.session_id,\n        forceTcp: qs.get(\"force_tcp\"),\n        forceTurn: qs.get(\"force_turn\"),\n        iceTransportPolicy: qs.get(\"force_tcp\") || qs.get(\"force_turn\") ? \"relay\" : \"all\"\n      });\n      scene.addEventListener(\n        \"adapter-ready\",\n        ({ detail: adapter }) => {\n          adapter.hubChannel = hubChannel;\n          adapter.events = events;\n          adapter.session_id = data.session_id;\n        },\n        { once: true }\n      );\n      scene.components[\"networked-scene\"]\n        .connect()\n        .then(() => {\n          scene.emit(\"didConnectToNetworkedScene\");\n        })\n        .catch(connectError => {\n          onConnectionError(entryManager, connectError);\n        });\n    };\n\n    window.APP.hub = hub;\n    updateUIForHub(hub, hubChannel);\n    scene.emit(\"hub_updated\", { hub });\n\n    if (!isEmbed) {\n      console.log(\"Page is not embedded so environment initialization will start immediately\");\n      loadEnvironmentAndConnect();\n    } else {\n      console.log(\"Page is embedded so environment initialization will be deferred\");\n      remountUI({\n        onPreloadLoadClicked: () => {\n          console.log(\"Preload has been activated\");\n          hubChannel.allowNAFTraffic(true);\n          remountUI({ showPreload: false });\n          loadEnvironmentAndConnect();\n        }\n      });\n    }\n  })();\n}\n\nasync function runBotMode(scene, entryManager) {\n  console.log(\"Running in bot mode...\");\n  const noop = () => {};\n  const alwaysFalse = () => false;\n  scene.renderer = {\n    setAnimationLoop: noop,\n    render: noop,\n    shadowMap: {},\n    vr: { isPresenting: alwaysFalse },\n    setSize: noop\n  };\n\n  while (!NAF.connection.isConnected()) await nextTick();\n  entryManager.enterSceneWhenLoaded(false, false);\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n  if (isOAuthModal) {\n    return;\n  }\n\n  await store.initProfile();\n\n  const canvas = document.querySelector(\".a-canvas\");\n  canvas.classList.add(\"a-hidden\");\n\n  if (platformUnsupported()) {\n    return;\n  }\n\n  const detectedOS = detectOS(navigator.userAgent);\n  const browser = detect();\n  // HACK - it seems if we don't initialize the mic track up-front, voices can drop out on iOS\n  // safari when initializing it later.\n  if ([\"iOS\", \"Mac OS\"].includes(detectedOS) && [\"safari\", \"ios\"].includes(browser.name)) {\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n    } catch (e) {\n      remountUI({ showSafariMicDialog: true });\n      return;\n    }\n  }\n\n  const hubId = getCurrentHubId();\n  console.log(`Hub ID: ${hubId}`);\n\n  // 외부 js 파일 만들어서 불러오기\n  // const scriptTag = document.createElement(\"script\");\n  // scriptTag.src = \"https://mpva.metatour.net/_clickEvent.js?\" + new Date().getMilliseconds();\n  // document.body.append(scriptTag); \n\n  const shouldRedirectToSignInPage =\n    // Default room won't work if account is required to access\n    !configs.feature(\"default_room_id\") &&\n    configs.feature(\"require_account_for_join\") &&\n    !(store.state.credentials && store.state.credentials.token);\n  if (shouldRedirectToSignInPage) {\n    document.location = `/?sign_in&sign_in_destination=hub&sign_in_destination_url=${encodeURIComponent(\n      document.location.toString()\n    )}`;\n  }\n\n  const subscriptions = new Subscriptions(hubId);\n  APP.subscriptions = subscriptions;\n  subscriptions.register();\n\n  const scene = document.querySelector(\"a-scene\");\n  window.APP.scene = scene;\n\n  const onSceneLoaded = () => {\n    const physicsSystem = scene.systems[\"hubs-systems\"].physicsSystem;\n    physicsSystem.setDebug(isDebug || physicsSystem.debug);\n  };\n  if (scene.hasLoaded) {\n    onSceneLoaded();\n  } else {\n    scene.addEventListener(\"loaded\", onSceneLoaded, { once: true });\n  }\n\n  // If the stored avatar doesn't have a valid src, reset to a legacy avatar.\n  const avatarSrc = await getAvatarSrc(store.state.profile.avatarId);\n  if (!avatarSrc) {\n    await store.resetToRandomDefaultAvatar();\n  }\n\n  const authChannel = new AuthChannel(store);\n  const hubChannel = new HubChannel(store, hubId);\n  window.APP.hubChannel = hubChannel;\n\n  const entryManager = new SceneEntryManager(hubChannel, authChannel, history);\n  window.APP.entryManager = entryManager;\n\n  APP.dialog.on(DIALOG_CONNECTION_CONNECTED, () => {\n    scene.emit(\"didConnectToDialog\");\n  });\n  APP.dialog.on(DIALOG_CONNECTION_ERROR_FATAL, () => {\n    // TODO: Change the wording of the connect error to match dialog connection error\n    // TODO: Tell the user that dialog is broken, but don't completely end the experience\n    remountUI({ roomUnavailableReason: ExitReason.connectError });\n    APP.entryManager.exitScene();\n  });\n\n  const audioSystem = scene.systems[\"hubs-systems\"].audioSystem;\n  APP.mediaDevicesManager = new MediaDevicesManager(scene, store, audioSystem);\n\n  const performConditionalSignIn = async (predicate, action, signInMessage, onFailure) => {\n    if (predicate()) return action();\n\n    await handleExitTo2DInterstitial(true, () => remountUI({ showSignInDialog: false }));\n\n    remountUI({\n      showSignInDialog: true,\n      signInMessage,\n      onContinueAfterSignIn: async () => {\n        remountUI({ showSignInDialog: false, onContinueAfterSignIn: null });\n        let actionError = null;\n        if (predicate()) {\n          try {\n            await action();\n          } catch (e) {\n            actionError = e;\n          }\n        } else {\n          actionError = new Error(\"Predicate failed post sign-in\");\n        }\n\n        if (actionError && onFailure) onFailure(actionError);\n        exit2DInterstitialAndEnterVR();\n      }\n    });\n  };\n\n  window.APP.pinningHelper = new PinningHelper(hubChannel, authChannel, store, performConditionalSignIn);\n\n  window.addEventListener(\"action_create_avatar\", () => {\n    performConditionalSignIn(\n      () => hubChannel.signedIn,\n      () => pushHistoryState(history, \"overlay\", \"avatar-editor\"),\n      SignInMessages.createAvatar\n    );\n  });\n\n  scene.addEventListener(\"scene_media_selected\", e => {\n    const sceneInfo = e.detail;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_hub\"),\n      () => hubChannel.updateScene(sceneInfo),\n      SignInMessages.changeScene\n    );\n  });\n\n  remountUI({\n    performConditionalSignIn,\n    embed: isEmbed,\n    showPreload: isEmbed\n  });\n  entryManager.performConditionalSignIn = performConditionalSignIn;\n  entryManager.init();\n\n  const linkChannel = new LinkChannel(store);\n  window.dispatchEvent(new CustomEvent(\"hub_channel_ready\"));\n\n  const handleEarlyVRMode = () => {\n    // If VR headset is activated, refreshing page will fire vrdisplayactivate\n    // which puts A-Frame in VR mode, so exit VR mode whenever it is attempted\n    // to be entered and we haven't entered the room yet.\n    if (scene.is(\"vr-mode\") && !scene.is(\"vr-entered\") && !isMobileVR) {\n      console.log(\"Pre-emptively exiting VR mode.\");\n      scene.exitVR();\n      return true;\n    }\n\n    return false;\n  };\n  remountUI({ availableVREntryTypes: ONLY_SCREEN_AVAILABLE, checkingForDeviceAvailability: true });\n  const availableVREntryTypesPromise = getAvailableVREntryTypes();\n  scene.addEventListener(\"enter-vr\", () => {\n    if (handleEarlyVRMode()) return true;\n\n    if (isMobileVR) {\n      // Optimization, stop drawing UI if not visible\n      remountUI({ hide: true });\n    }\n\n    document.body.classList.add(\"vr-mode\");\n\n    availableVREntryTypesPromise.then(availableVREntryTypes => {\n      // Don't stretch canvas on cardboard, since that's drawing the actual VR view :)\n      if ((!isMobile && !isMobileVR) || availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.yes) {\n        document.body.classList.add(\"vr-mode-stretch\");\n      }\n    });\n  });\n  handleEarlyVRMode();\n\n  // HACK A-Frame 0.9.0 seems to fail to wire up vrdisplaypresentchange early enough\n  // to catch presentation state changes and recognize that an HMD is presenting on startup.\n  window.addEventListener(\n    \"vrdisplaypresentchange\",\n    () => {\n      if (scene.is(\"vr-entered\")) return;\n      if (scene.is(\"vr-mode\")) return;\n\n      const device = AFRAME.utils.device.getVRDisplay();\n\n      if (device && device.isPresenting) {\n        if (!scene.is(\"vr-mode\")) {\n          console.warn(\"Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode.\");\n          scene.enterVR();\n        }\n      }\n    },\n    { once: true }\n  );\n\n  scene.addEventListener(\"exit-vr\", () => {\n    document.body.classList.remove(\"vr-mode\");\n    document.body.classList.remove(\"vr-mode-stretch\");\n\n    remountUI({ hide: false });\n\n    // HACK: Oculus browser pauses videos when exiting VR mode, so we need to resume them after a timeout.\n    if (/OculusBrowser/i.test(window.navigator.userAgent)) {\n      document.querySelectorAll(\"[media-video]\").forEach(m => {\n        const videoComponent = m.components[\"media-video\"];\n\n        if (videoComponent) {\n          videoComponent._ignorePauseStateChanges = true;\n\n          setTimeout(() => {\n            const video = videoComponent.video;\n\n            if (video && video.paused && !videoComponent.data.videoPaused) {\n              video.play();\n            }\n\n            videoComponent._ignorePauseStateChanges = false;\n          }, 1000);\n        }\n      });\n    }\n  });\n\n  registerNetworkSchemas();\n\n  remountUI({\n    authChannel,\n    hubChannel,\n    linkChannel,\n    subscriptions,\n    enterScene: entryManager.enterScene,\n    exitScene: reason => {\n      entryManager.exitScene();\n      remountUI({ roomUnavailableReason: reason || ExitReason.exited });\n    }\n  });\n\n  scene.addEventListener(\"leave_room_requested\", () => {\n    entryManager.exitScene();\n    remountUI({ roomUnavailableReason: ExitReason.left });\n  });\n\n  scene.addEventListener(\"hub_closed\", () => {\n    scene.exitVR();\n    entryManager.exitScene();\n    remountUI({ roomUnavailableReason: ExitReason.closed });\n  });\n\n  scene.addEventListener(\"action_camera_recording_started\", () => hubChannel.beginRecording());\n  scene.addEventListener(\"action_camera_recording_ended\", () => hubChannel.endRecording());\n\n  if (qs.get(\"required_version\") && process.env.BUILD_VERSION) {\n    const buildNumber = process.env.BUILD_VERSION.split(\" \", 1)[0]; // e.g. \"123 (abcd5678)\"\n\n    if (qs.get(\"required_version\") !== buildNumber) {\n      remountUI({ roomUnavailableReason: ExitReason.versionMismatch });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  }\n\n  getReticulumMeta().then(reticulumMeta => {\n    console.log(`Reticulum @ ${reticulumMeta.phx_host}: v${reticulumMeta.version} on ${reticulumMeta.pool}`);\n\n    if (\n      qs.get(\"required_ret_version\") &&\n      (qs.get(\"required_ret_version\") !== reticulumMeta.version || qs.get(\"required_ret_pool\") !== reticulumMeta.pool)\n    ) {\n      remountUI({ roomUnavailableReason: ExitReason.versionMismatch });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  });\n\n  availableVREntryTypesPromise.then(async availableVREntryTypes => {\n    if (isMobileVR) {\n      remountUI({\n        availableVREntryTypes,\n        forcedVREntryType: qsVREntryType || \"vr\",\n        checkingForDeviceAvailability: false\n      });\n\n      if (/Oculus/.test(navigator.userAgent) && \"getVRDisplays\" in navigator) {\n        // HACK - The polyfill reports Cardboard as the primary VR display on startup out ahead of\n        // Oculus Go on Oculus Browser 5.5.0 beta. This display is cached by A-Frame,\n        // so we need to resolve that and get the real VRDisplay before entering as well.\n        const displays = await navigator.getVRDisplays();\n        const vrDisplay = displays.length && displays[0];\n        AFRAME.utils.device.getVRDisplay = () => vrDisplay;\n      }\n    } else {\n      const hasVREntryDevice =\n        availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no ||\n        availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no ||\n        availableVREntryTypes.daydream !== VR_DEVICE_AVAILABILITY.no;\n\n      remountUI({\n        availableVREntryTypes,\n        forcedVREntryType: qsVREntryType || (!hasVREntryDevice ? \"2d\" : null),\n        checkingForDeviceAvailability: false\n      });\n    }\n  });\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n  environmentScene.addEventListener(\n    \"model-loaded\",\n    () => {\n      // Replace renderer with a noop renderer to reduce bot resource usage.\n      if (isBotMode) {\n        runBotMode(scene, entryManager);\n      }\n    },\n    { once: true }\n  );\n\n  environmentScene.addEventListener(\"model-loaded\", ({ detail: { model } }) => {\n    console.log(\"Environment scene has loaded\");\n\n    if (!scene.is(\"entered\")) {\n      setupLobbyCamera();\n    }\n\n    // This will be run every time the environment is changed (including the first load.)\n    remountUI({ environmentSceneLoaded: true });\n    scene.emit(\"environment-scene-loaded\", model);\n\n    // Re-bind the teleporter controls collision meshes in case the scene changed.\n    document.querySelectorAll(\"a-entity[teleporter]\").forEach(x => x.components[\"teleporter\"].queryCollisionEntities());\n\n    for (const modelEl of environmentScene.children) {\n      addAnimationComponents(modelEl);\n    }\n  });\n\n  // Socket disconnects on refresh but we don't want to show exit scene in that scenario.\n  let isReloading = false;\n  window.addEventListener(\"beforeunload\", () => (isReloading = true));\n\n  const socket = await connectToReticulum(isDebug);\n\n  socket.onClose(e => {\n    // We don't currently have an easy way to distinguish between being kicked (server closes socket)\n    // and a variety of other network issues that seem to produce the 1000 closure code, but the\n    // latter are probably more common. Either way, we just tell the user they got disconnected.\n    const NORMAL_CLOSURE = 1000;\n\n    if (e.code === NORMAL_CLOSURE && !isReloading) {\n      entryManager.exitScene();\n      remountUI({ roomUnavailableReason: ExitReason.disconnected });\n    }\n  });\n\n  // Reticulum global channel\n  APP.retChannel = socket.channel(`ret`, { hub_id: hubId });\n  APP.retChannel\n    .join()\n    .receive(\"ok\", data => {\n      subscriptions.setVapidPublicKey(data.vapid_public_key);\n    })\n    .receive(\"error\", res => {\n      subscriptions.setVapidPublicKey(null);\n      console.error(res);\n    });\n\n  const pushSubscriptionEndpoint = await subscriptions.getCurrentEndpoint();\n\n  APP.hubChannelParamsForPermsToken = permsToken => {\n    return createHubChannelParams({\n      profile: store.state.profile,\n      pushSubscriptionEndpoint,\n      permsToken,\n      isMobile,\n      isMobileVR,\n      isEmbed,\n      hubInviteId: qs.get(\"hub_invite_id\"),\n      authToken: store.state.credentials && store.state.credentials.token\n    });\n  };\n\n  const migrateToNewReticulumServer = async ({ ret_version, ret_pool }, shouldAbandonMigration) => {\n    console.log(`[reconnect] Reticulum deploy detected v${ret_version} on ${ret_pool}.`);\n\n    const didMatchMeta = await tryGetMatchingMeta({ ret_version, ret_pool }, shouldAbandonMigration);\n    if (!didMatchMeta) {\n      console.error(`[reconnect] Failed to reconnect. Did not get meta for v${ret_version} on ${ret_pool}.`);\n      return;\n    }\n\n    console.log(\"[reconnect] Reconnect in progress. Updated reticulum meta.\");\n    const oldSocket = APP.retChannel.socket;\n    const socket = await connectToReticulum(isDebug, oldSocket.params());\n    APP.retChannel = await migrateChannelToSocket(APP.retChannel, socket);\n    await hubChannel.migrateToSocket(socket, APP.hubChannelParamsForPermsToken());\n    authChannel.setSocket(socket);\n    linkChannel.setSocket(socket);\n\n    // Disconnect old socket after a delay to ensure this user is always registered in presence.\n    await sleep(10000);\n    oldSocket.teardown();\n    console.log(\"[reconnect] Reconnection successful.\");\n  };\n\n  const onRetDeploy = (function () {\n    let pendingNotification = null;\n    const hasPendingNotification = function () {\n      return !!pendingNotification;\n    };\n\n    const handleNextMessage = (function () {\n      let isLocked = false;\n      return async function handleNextMessage() {\n        if (isLocked || !pendingNotification) return;\n\n        isLocked = true;\n        const currentNotification = Object.assign({}, pendingNotification);\n        pendingNotification = null;\n        try {\n          await migrateToNewReticulumServer(currentNotification, hasPendingNotification);\n        } catch {\n          console.error(\"Failed to migrate to new reticulum server after deploy.\", currentNotification);\n        } finally {\n          isLocked = false;\n          handleNextMessage();\n        }\n      };\n    })();\n\n    return function onRetDeploy(deployNotification) {\n      // If for some reason we receive multiple deployNotifications, only the\n      // most recent one matters. The rest can be overwritten.\n      pendingNotification = deployNotification;\n      handleNextMessage();\n    };\n  })();\n\n  APP.retChannel.on(\"notice\", data => {\n    if (data.event === \"ret-deploy\") {\n      onRetDeploy(data);\n    }\n  });\n\n  const messageDispatch = new MessageDispatch(scene, entryManager, hubChannel, remountUI, mediaSearchStore);\n  APP.messageDispatch = messageDispatch;\n  document.getElementById(\"avatar-rig\").messageDispatch = messageDispatch;\n\n  const oauthFlowPermsToken = Cookies.get(OAUTH_FLOW_PERMS_TOKEN_KEY);\n  if (oauthFlowPermsToken) {\n    Cookies.remove(OAUTH_FLOW_PERMS_TOKEN_KEY);\n  }\n  const hubPhxChannel = socket.channel(`hub:${hubId}`, APP.hubChannelParamsForPermsToken(oauthFlowPermsToken));\n  hubChannel.channel = hubPhxChannel;\n  hubChannel.presence = new Presence(hubPhxChannel);\n  const { rawOnJoin, rawOnLeave } = denoisePresence(presenceEventsForHub(events));\n  hubChannel.presence.onJoin(rawOnJoin);\n  hubChannel.presence.onLeave(rawOnLeave);\n  hubChannel.presence.onSync(() => {\n    events.trigger(`hub:sync`, { presence: hubChannel.presence });\n  });\n\n  events.on(`hub:join`, ({ key, meta }) => {\n    scene.emit(\"presence_updated\", {\n      sessionId: key,\n      profile: meta.profile,\n      roles: meta.roles,\n      permissions: meta.permissions,\n      streaming: meta.streaming,\n      recording: meta.recording,\n      hand_raised: meta.hand_raised,\n      typing: meta.typing\n    });\n  });\n  events.on(`hub:join`, ({ key, meta }) => {\n    if (\n      APP.hideHubPresenceEvents ||\n      key === hubChannel.channel.socket.params().session_id ||\n      hubChannel.presence.list().length > NOISY_OCCUPANT_COUNT\n    ) {\n      return;\n    }\n    messageDispatch.receive({\n      type: \"join\",\n      presence: meta.presence,\n      name: meta.profile.displayName\n    });\n  });\n\n  events.on(`hub:leave`, ({ meta }) => {\n    if (APP.hideHubPresenceEvents || hubChannel.presence.list().length > NOISY_OCCUPANT_COUNT) {\n      return;\n    }\n    messageDispatch.receive({\n      type: \"leave\",\n      name: meta.profile.displayName\n    });\n  });\n\n  events.on(`hub:change`, ({ key, previous, current }) => {\n    if (\n      previous.presence === current.presence ||\n      current.presence !== \"room\" ||\n      key === hubChannel.channel.socket.params().session_id\n    ) {\n      return;\n    }\n\n    messageDispatch.receive({\n      type: \"entered\",\n      presence: current.presence,\n      name: current.profile.displayName\n    });\n  });\n  events.on(`hub:change`, ({ previous, current }) => {\n    if (previous.profile.displayName !== current.profile.displayName) {\n      messageDispatch.receive({\n        type: \"display_name_changed\",\n        oldName: previous.profile.displayName,\n        newName: current.profile.displayName\n      });\n    }\n  });\n  events.on(`hub:change`, ({ key, previous, current }) => {\n    if (\n      key === hubChannel.channel.socket.params().session_id &&\n      previous.profile.avatarId !== current.profile.avatarId\n    ) {\n      messageDispatch.log(LogMessageType.avatarChanged);\n    }\n  });\n  events.on(`hub:change`, ({ key, current }) => {\n    scene.emit(\"presence_updated\", {\n      sessionId: key,\n      profile: current.profile,\n      roles: current.roles,\n      permissions: current.permissions,\n      streaming: current.streaming,\n      recording: current.recording,\n      hand_raised: current.hand_raised,\n      typing: current.typing\n    });\n  });\n\n  // We need to be able to wait for initial presence syncs across reconnects and socket migrations,\n  // so we create this object in the outer scope and assign it a new promise on channel join.\n  const presenceSync = {\n    promise: null,\n    resolve: null\n  };\n  events.on(\"hub:sync\", () => {\n    presenceSync.resolve();\n  });\n  events.on(`hub:sync`, () => {\n    APP.hideHubPresenceEvents = false;\n  });\n  events.on(`hub:sync`, updateVRHudPresenceCount);\n  events.on(`hub:sync`, ({ presence }) => {\n    updateSceneCopresentState(presence, scene);\n  });\n  events.on(`hub:sync`, ({ presence }) => {\n    remountUI({\n      sessionId: socket.params().session_id,\n      presences: presence.state,\n      entryDisallowed: !hubChannel.canEnterRoom(uiProps.hub)\n    });\n  });\n\n  hubPhxChannel\n    .join()\n    .receive(\"ok\", async data => {\n      APP.hideHubPresenceEvents = true;\n      presenceSync.promise = new Promise(resolve => {\n        presenceSync.resolve = resolve;\n      });\n\n      socket.params().session_id = data.session_id;\n      socket.params().session_token = data.session_token;\n\n      const permsToken = oauthFlowPermsToken || data.perms_token;\n      hubChannel.setPermissionsFromToken(permsToken);\n\n      subscriptions.setHubChannel(hubChannel);\n      subscriptions.setSubscribed(data.subscriptions.web_push);\n\n      remountUI({\n        hubIsBound: data.hub_requires_oauth,\n        initialIsFavorited: data.subscriptions.favorites\n      });\n\n      await presenceSync.promise;\n      handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data, permsToken, hubChannel, events);\n    })\n    .receive(\"error\", res => {\n      if (res.reason === \"closed\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: ExitReason.closed });\n      } else if (res.reason === \"oauth_required\") {\n        entryManager.exitScene();\n        remountUI({ oauthInfo: res.oauth_info, showOAuthScreen: true });\n      } else if (res.reason === \"join_denied\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: ExitReason.denied });\n      }\n\n      console.error(res);\n    });\n\n  hubPhxChannel.on(\"message\", ({ session_id, type, body, from }) => {\n    const getAuthor = () => {\n      const userInfo = hubChannel.presence.state[session_id];\n      if (from) {\n        return from;\n      } else if (userInfo) {\n        return userInfo.metas[0].profile.displayName;\n      } else {\n        return \"Mystery user\";\n      }\n    };\n\n    const name = getAuthor();\n    const maySpawn = scene.is(\"entered\");\n\n    const incomingMessage = {\n      name,\n      type,\n      body,\n      maySpawn,\n      sessionId: session_id,\n      sent: session_id === socket.params().session_id\n    };\n\n    if (scene.is(\"vr-mode\")) {\n      createInWorldLogMessage(incomingMessage);\n    }\n\n    messageDispatch.receive(incomingMessage);\n  });\n\n  hubPhxChannel.on(\"hub_refresh\", ({ session_id, hubs, stale_fields }) => {\n    const hub = hubs[0];\n    const userInfo = hubChannel.presence.state[session_id];\n    const displayName = (userInfo && userInfo.metas[0].profile.displayName) || \"API\";\n\n    window.APP.hub = hub;\n    updateUIForHub(hub, hubChannel);\n\n    if (\n      stale_fields.includes(\"scene\") ||\n      stale_fields.includes(\"scene_listing\") ||\n      stale_fields.includes(\"default_environment_gltf_bundle_url\")\n    ) {\n      const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\n\n      fader.fadeOut().then(() => {\n        scene.emit(\"reset_scene\");\n        updateEnvironmentForHub(hub, entryManager);\n      });\n\n      messageDispatch.receive({\n        type: \"scene_changed\",\n        name: displayName,\n        sceneName: hub.scene ? hub.scene.name : \"a custom URL\"\n      });\n    }\n\n    if (stale_fields.includes(\"member_permissions\")) {\n      hubChannel.fetchPermissions();\n    }\n\n    if (stale_fields.includes(\"name\")) {\n      const titleParts = document.title.split(\" | \"); // Assumes title has | trailing site name\n      titleParts[0] = hub.name;\n      document.title = titleParts.join(\" | \");\n\n      // Re-write the slug in the browser history\n      const pathParts = history.location.pathname.split(\"/\");\n      const oldSlug = pathParts[1];\n      const { search, state } = history.location;\n      const pathname = history.location.pathname.replace(`/${oldSlug}`, `/${hub.slug}`);\n\n      history.replace({ pathname, search, state });\n\n      messageDispatch.receive({\n        type: \"hub_name_changed\",\n        name: displayName,\n        hubName: hub.name\n      });\n    }\n\n    if (hub.entry_mode === \"deny\") {\n      scene.emit(\"hub_closed\");\n    }\n\n    scene.emit(\"hub_updated\", { hub });\n  });\n\n  hubPhxChannel.on(\"permissions_updated\", () => hubChannel.fetchPermissions());\n\n  hubPhxChannel.on(\"mute\", ({ session_id }) => {\n    if (session_id === NAF.clientId) {\n      APP.mediaDevicesManager.micEnabled = false;\n    }\n  });\n\n  authChannel.setSocket(socket);\n  linkChannel.setSocket(socket);\n});\n","// Stores a key in localStorage and registeres a listener for the same key being set (by another tab).\n// When detected, fire a \"concurrentload\" event.\nexport default function detectConcurrentLoad(instanceKey = \"global\") {\n  const key = `___concurrent_load_detector_${instanceKey}`;\n  localStorage.setItem(key, JSON.stringify({ started_at: new Date() }));\n  const onStorageEvent = e => {\n    if (e.key !== key) return;\n    window.dispatchEvent(new CustomEvent(\"concurrentload\"));\n    window.removeEventListener(\"storage\", onStorageEvent);\n  };\n  window.addEventListener(\"storage\", onStorageEvent);\n}\n","export function emitter() {\n  let bindings = [];\n  let bindingRef = 0;\n  const on = (event, callback) => {\n    const ref = bindingRef++;\n    bindings.push({ event, ref, callback });\n    return ref;\n  };\n  const off = (event, ref) => {\n    bindings = bindings.filter(bind => {\n      return !(bind.event === event && (typeof ref === \"undefined\" || ref === bind.ref));\n    });\n  };\n  const trigger = (event, payload) => {\n    bindings.filter(bind => bind.event === event).forEach(bind => {\n      bind.callback(payload);\n    });\n  };\n  const getBindings = () => {\n    return bindings;\n  };\n  return {\n    on,\n    off,\n    trigger,\n    getBindings\n  };\n}\n","function registerNetworkSchemas() {\n  const vectorRequiresUpdate = epsilon => {\n    return () => {\n      let prev = null;\n\n      return curr => {\n        if (prev === null) {\n          prev = new THREE.Vector3(curr.x, curr.y, curr.z);\n          return true;\n        } else if (!NAF.utils.almostEqualVec3(prev, curr, epsilon)) {\n          prev.copy(curr);\n          return true;\n        }\n\n        return false;\n      };\n    };\n  };\n\n  // Note: networked template ids are semantically important. We use the template suffix as a filter\n  // for allowing and authorizing messages in reticulum.\n  // See `spawn_permitted?` in https://github.com/mozilla/reticulum/blob/master/lib/ret_web/channels/hub_channel.ex\n\n  // NAF schemas have been extended with a custom nonAuthorizedComponents property that is used to skip authorization\n  // on certain components and properties regardless of hub or user permissions. See permissions-utils.js.\n\n  NAF.schemas.add({\n    template: \"#remote-avatar\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"player-info\",\n      \"networked-avatar\",\n      {\n        selector: \".camera\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".camera\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"visible\"\n      },\n      {\n        selector: \".right-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"visible\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-media\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pdf\",\n        property: \"index\"\n      },\n      \"pinnable\"\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-emoji\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"emoji\",\n        property: \"emitEndTime\"\n      },\n      {\n        component: \"emoji\",\n        property: \"particleEmitterConfig\"\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"media-loader\",\n      \"pinnable\",\n      {\n        selector: \".particle-emitter\",\n        component: \"particle-emitter\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-controlled-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pdf\",\n        property: \"index\"\n      }\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-drawing\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"networked-drawing\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#template-waypoint-avatar\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"waypoint\"\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      \"waypoint\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-pen\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        component: \"scale\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"radius\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"color\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"drawMode\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"penVisible\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen-laser\",\n        property: \"laserVisible\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen-laser\",\n        property: \"remoteLaserOrigin\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen-laser\",\n        property: \"laserTarget\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      }\n    ]\n  });\n}\n\nexport default registerNetworkSchemas;\n","/* global AFRAME */\n\n/**\n * Toggle visibility of an entity based on if the user is in vr mode or not\n * @namespace vr-mode\n * @component vr-mode-toggle-visibility\n */\nAFRAME.registerComponent(\"vr-mode-toggle-visibility\", {\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.setAttribute(\"visible\", inVRMode !== this.data.invert);\n  }\n});\n\n/**\n * Toggle the isPlaying state of a component based on app mode\n * @namespace vr-mode\n * @component vr-mode-toggle-playing\n */\nAFRAME.registerComponent(\"vr-mode-toggle-playing\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const componentName = this.id;\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.components[componentName][inVRMode !== this.data.invert ? \"play\" : \"pause\"]();\n  }\n});\n\n/**\n * Toggle a CSS class based upon app mode.\n * @namespace vr-mode\n * @component vr-mode-toggle-class\n */\nAFRAME.registerComponent(\"vr-mode-toggle-class\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false },\n    class: { type: \"string\", default: \"\" }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n\n    if (inVRMode) {\n      this.el.classList.add(this.data.class);\n    } else {\n      this.el.classList.remove(this.data.class);\n    }\n  }\n});\n","// On high-DPI displays, measures the median FPS over time and reduces the\n// pixelRatio if the FPS drops below a threshold.\n\nconst LOW_FPS_THRESHOLD = 30;\nconst HIGH_FPS_THRESHOLD = 48;\nconst SKIP_SECONDS_AFTER_SCENE_VISIBLE = 30;\nconst MEASUREMENT_PERIOD_SECONDS = 5;\nconst MIN_PIXEL_RATIO = 1;\nconst CHANGE_RATE = 1;\nconst NUM_TIMES_DECREASED_BEFORE_CHANGING_MAX_PIXEL_RATIO = 3;\n\nAFRAME.registerSystem(\"auto-pixel-ratio\", {\n  init() {\n    // For now let's only enabled this on macs, since they tend to have retina displays.\n    // Note this test will also include iPads running iPadOS.\n    this.enabled = window.devicePixelRatio > 1 && /macintosh/i.test(navigator.userAgent);\n    this.deltas = [];\n    this.secondsSinceMeasurementStart = 0;\n    this.secondsSinceSceneVisible = 0;\n    this.maxPixelRatio = window.devicePixelRatio;\n    this.pixelRatioToTimesDecreased = {};\n\n    this.disabledByPref = window.APP.store.state.preferences.disableAutoPixelRatio;\n    this.onPreferenceChange = this.onPreferenceChange.bind(this);\n    window.APP.store.addEventListener(\"statechanged\", this.onPreferenceChange);\n  },\n  onPreferenceChange() {\n    this.disabledByPref = window.APP.store.state.preferences.disableAutoPixelRatio;\n  },\n  tick(time, delta) {\n    if (!this.enabled || this.disabledByPref || this.maxPixelRatio === MIN_PIXEL_RATIO) return;\n    if (!this.el.is(\"visible\")) return;\n    if (this.secondsSinceSceneVisible < SKIP_SECONDS_AFTER_SCENE_VISIBLE) {\n      this.secondsSinceSceneVisible += delta / 1000;\n      return;\n    }\n    if (document.visibilityState === \"hidden\") return;\n\n    this.deltas.push(delta);\n    this.secondsSinceMeasurementStart += delta / 1000;\n\n    if (this.secondsSinceMeasurementStart > MEASUREMENT_PERIOD_SECONDS) {\n      this.deltas.sort();\n      const medianDelta = this.deltas[Math.floor(this.deltas.length / 2)];\n      const medianFps = 1000 / medianDelta;\n\n      const currentPixelRatio = this.el.renderer.getPixelRatio();\n\n      const shouldDecrease = currentPixelRatio > MIN_PIXEL_RATIO && medianFps < LOW_FPS_THRESHOLD;\n      const shouldIncrease = currentPixelRatio < this.maxPixelRatio && medianFps > HIGH_FPS_THRESHOLD;\n      if (shouldDecrease || shouldIncrease) {\n        const newPixelRatio = currentPixelRatio + (CHANGE_RATE * shouldIncrease ? 1 : -1);\n        console.info(\n          `Hubs auto-pixel-ratio: Median FPS (${medianFps.toFixed()}) was ${\n            shouldIncrease ? `above ${HIGH_FPS_THRESHOLD}` : `below ${LOW_FPS_THRESHOLD}`\n          }. ` + `Adjusting pixel ratio to ${newPixelRatio}.`\n        );\n        this.el.renderer.setPixelRatio(newPixelRatio);\n        if (shouldDecrease) {\n          const timesDecreased = (this.pixelRatioToTimesDecreased[currentPixelRatio] || 0) + 1;\n          this.pixelRatioToTimesDecreased[currentPixelRatio] = timesDecreased;\n          if (timesDecreased >= NUM_TIMES_DECREASED_BEFORE_CHANGING_MAX_PIXEL_RATIO) {\n            console.info(\n              `Hubs auto-pixel-ratio: Attempts to maintain high frame rate with pixel ratio ${currentPixelRatio} failed ${timesDecreased} times and will not be attempted again. Lowering maximum pixel ratio to ${newPixelRatio}.`\n            );\n            this.maxPixelRatio = newPixelRatio;\n          }\n        }\n      }\n\n      // Clear deltas so that we start measuring a new median.\n      this.deltas.length = 0;\n      this.secondsSinceMeasurementStart = 0;\n    }\n  }\n});\n","/**\n * Emits an \"exit\" event when a user has stopped using the app for a certain period of time\n * @system exit-on-blur\n */\nAFRAME.registerSystem(\"exit-on-blur\", {\n  init() {\n    this.onBlur = this.onBlur.bind(this);\n    this.onFocus = this.onFocus.bind(this);\n    this.onTimeout = this.onTimeout.bind(this);\n    this.onEnterVR = this.onEnterVR.bind(this);\n\n    this.isOculusBrowser = navigator.userAgent.match(/Oculus/);\n    this.enteredVR = false;\n\n    window.addEventListener(\"blur\", this.onBlur);\n    window.addEventListener(\"focus\", this.onFocus);\n    this.el.addEventListener(\"enter-vr\", this.onEnterVR);\n\n    this.lastTimeoutCheck = 0;\n    this.exitTimeout = null;\n  },\n\n  tick(t) {\n    // This is a hack to detect when an Oculus Go user has taken off the headset and the headset has\n    // entered standby mode. Currently Oculus Browser is not emitting a blur, vrdisplaydeactivate,\n    // vrdisplayblur, visibilitychange, or vrdisplaypresentchange event, so we wait 15 seconds after\n    // the last requestAnimationFrame callback to determine if the headset has gone into standby mode.\n    // We also check that you have entered VR so that this timeout does not occur in the setup UI.\n    if (\n      this.isOculusBrowser &&\n      this.enteredVR &&\n      (this.lastTimeoutCheck === 0 || t - this.lastTimeoutCheck >= 1000.0) // Don't do this clear every frame, slow.\n    ) {\n      this.lastTimeoutCheck = t;\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onEnterVR() {\n    this.enteredVR = true;\n  },\n\n  onBlur() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onFocus() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n    }\n  },\n\n  onTimeout() {\n    if (window.APP.store.state.preferences.disableIdleDetection) return;\n    this.el.dispatchEvent(new CustomEvent(\"exit\"));\n  },\n\n  remove() {\n    clearTimeout(this.exitTimeout);\n    window.removeEventListener(\"blur\", this.onBlur);\n  }\n});\n","// Given a function and a queue name, schedules things so a single function\n// from a given queue will be called per frame.\nAFRAME.registerSystem(\"frame-scheduler\", {\n  init() {\n    // Registry a map from queue name to list of registered functions.\n    this.registry = new Map();\n    this.queues = [];\n    this.frameIndex = 0;\n  },\n\n  schedule(func, queue) {\n    if (!this.registry.has(queue)) {\n      this.queues.push(queue);\n      this.registry.set(queue, []);\n    }\n\n    this.registry.get(queue).push(func);\n  },\n\n  unschedule(func) {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      const idx = entries.indexOf(func);\n\n      if (idx >= 0) {\n        entries.splice(idx, 1);\n      }\n    }\n  },\n\n  tick: function() {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      if (entries.length === 0) continue;\n\n      entries[this.frameIndex % entries.length]();\n    }\n\n    this.frameIndex++;\n  }\n});\n","AFRAME.registerSystem(\"listed-media\", {\n  init: function() {\n    this.els = [];\n  },\n\n  register: function(el) {\n    this.els.push(el);\n    this.el.emit(\"listed_media_changed\");\n  },\n\n  unregister: function(el) {\n    this.els.splice(this.els.indexOf(el), 1);\n    this.el.emit(\"listed_media_changed\");\n  }\n});\n\nAFRAME.registerComponent(\"listed-media\", {\n  init: function() {\n    this.system.register(this.el);\n  },\n\n  remove: function() {\n    this.system.unregister(this.el);\n  }\n});\n","AFRAME.registerSystem(\"permissions\", {\n  onPermissionsUpdated(handler) {\n    if (window.APP.hubChannel) {\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", handler);\n    } else {\n      window.addEventListener(\n        \"hub_channel_ready\",\n        () => window.APP.hubChannel.addEventListener(\"permissions_updated\", handler),\n        { once: true }\n      );\n    }\n  },\n  can(permissionName) {\n    return !!window.APP.hubChannel.can(permissionName);\n  },\n  canOrWillIfCreator(permissionName) {\n    return !!window.APP.hubChannel.canOrWillIfCreator(permissionName);\n  },\n  fetchPermissions() {\n    return window.APP.hubChannel.fetchPermissions();\n  }\n});\n","import qsTruthy from \"./qs_truthy\";\n\nconst showLog = qsTruthy(\"debug_log\");\n\nif (showLog) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = `\n    <style>\n      #debug-log {\n        position: absolute;\n        top: 13em;\n        background: white;\n        opacity: 0.7;\n        z-index: 1000;\n      }\n      #debug-log, #debug-log-input {\n        font-family: monospace;\n        font-size: 11px;\n        width: 100%;\n      }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n    </style>\n    <div id=\"debug-log\">\n        <div id=\"debug-log-controls\">\n          <form id=\"debug-log-eval\">\n            <input id=\"debug-log-input\" placeholder=\"&gt;&gt;\" autocorrect=\"off\" autocapitalize=\"none\" />\n            <button>&gt;</button>\n          </form>\n          <button id=\"debug-log-minimize\">_</button>\n        </div>\n        <div id=\"debug-log-log\"></div>\n    </div>\n  `;\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    document.body.appendChild(template.content);\n  });\n\n  const debugLog = template.content.querySelector(\"#debug-log-log\");\n  debugLog.addEventListener(\"wheel\", e => e.stopPropagation());\n\n  const debugLogInput = template.content.querySelector(\"#debug-log-input\");\n  const debugLogEval = template.content.querySelector(\"#debug-log-eval\");\n  debugLogEval.onsubmit = e => {\n    e.preventDefault();\n    console.log(eval(`(${debugLogInput.value})`));\n  };\n\n  let minimized = false;\n  const debugLogMinimize = template.content.querySelector(\"#debug-log-minimize\");\n  debugLogMinimize.onclick = () => {\n    minimized = !minimized;\n    debugLog.className = minimized ? \"minimized\" : \"\";\n    debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  const origConsoleInfo = console.info;\n  const origConsoleLog = console.log;\n  const origConsoleError = console.error;\n  const origConsoleWarn = console.warn;\n\n  const log = function(className, objs) {\n    let entry;\n    if (debugLog.childNodes.length > 1000) {\n      entry = debugLog.firstChild;\n    } else {\n      entry = document.createElement(\"div\");\n      entry.classList.add(\"entry\");\n    }\n    entry.classList.remove(\"warn\", \"error\");\n    entry.classList.add(className);\n\n    const arr = Array.from(objs);\n    const firstObj = arr[0];\n    let content;\n    if (typeof firstObj === \"string\" && firstObj.includes(\"%c\")) {\n      content = firstObj.replace(/%c/g, \"\");\n    } else if (firstObj instanceof Error) {\n      content = `${firstObj.message}\\n${firstObj.stack}`;\n    } else {\n      content = arr\n        .map(obj => {\n          if (typeof obj === \"string\") return obj;\n          return JSON.stringify(obj);\n        })\n        .join(\" \");\n    }\n\n    const time = new Date().toISOString().substring(11, 23);\n    entry.textContent = `[${time}] ${content}`;\n\n    const shouldScroll = debugLog.scrollTop === debugLog.scrollHeight - debugLog.clientHeight;\n    debugLog.append(entry);\n    if (shouldScroll) debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  console.warn = function() {\n    origConsoleWarn.apply(null, arguments);\n    log(\"warn\", arguments);\n  };\n\n  console.error = function() {\n    origConsoleError.apply(null, arguments);\n    log(\"error\", arguments);\n  };\n\n  console.log = function() {\n    origConsoleLog.apply(null, arguments);\n    log(\"log\", arguments);\n  };\n\n  console.info = function() {\n    origConsoleInfo.apply(null, arguments);\n    log(\"info\", arguments);\n  };\n\n  window.onunhandledrejection = e => log(\"error\", [e.reason.message, e.reason.code, e.reason.name]);\n  window.onerror = e => log(\"error\", [e]);\n}\n","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n\nexport function qsGet(param) {\n  return qs.get(param);\n}\n","/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nTHREE.Water = function(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const textureWidth = options.textureWidth !== undefined ? options.textureWidth : 512;\n  const textureHeight = options.textureHeight !== undefined ? options.textureHeight : 512;\n\n  const clipBias = options.clipBias !== undefined ? options.clipBias : 0.0;\n  const alpha = options.alpha !== undefined ? options.alpha : 1.0;\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  //\n\n  const mirrorPlane = new THREE.Plane();\n  const normal = new THREE.Vector3();\n  const mirrorWorldPosition = new THREE.Vector3();\n  const cameraWorldPosition = new THREE.Vector3();\n  const rotationMatrix = new THREE.Matrix4();\n  const lookAtPosition = new THREE.Vector3(0, 0, -1);\n  const clipPlane = new THREE.Vector4();\n\n  const view = new THREE.Vector3();\n  const target = new THREE.Vector3();\n  const q = new THREE.Vector4();\n\n  const textureMatrix = new THREE.Matrix4();\n\n  const mirrorCamera = new THREE.PerspectiveCamera();\n\n  const parameters = {\n    minFilter: THREE.LinearFilter,\n    magFilter: THREE.LinearFilter,\n    format: THREE.RGBAFormat,\n    stencilBuffer: false\n  };\n\n  const renderTarget = new THREE.WebGLRenderTarget(textureWidth, textureHeight, parameters);\n\n  if (!THREE.MathUtils.isPowerOfTwo(textureWidth) || !THREE.MathUtils.isPowerOfTwo(textureHeight)) {\n    renderTarget.texture.generateMipmaps = false;\n  }\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"fog\"],\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        mirrorSampler: { value: null },\n        alpha: { value: 1.0 },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        textureMatrix: { value: new THREE.Matrix4() },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: [\n      \"uniform mat4 textureMatrix;\",\n      \"uniform float time;\",\n\n      \"varying vec4 mirrorCoord;\",\n      \"varying vec4 worldPosition;\",\n\n      THREE.ShaderChunk[\"fog_pars_vertex\"],\n      THREE.ShaderChunk[\"shadowmap_pars_vertex\"],\n\n      \"void main() {\",\n      \"\tmirrorCoord = modelMatrix * vec4( position, 1.0 );\",\n      \"\tworldPosition = mirrorCoord.xyzw;\",\n      \"\tmirrorCoord = textureMatrix * mirrorCoord;\",\n      \"\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\",\n      \"\tgl_Position = projectionMatrix * mvPosition;\",\n\n      THREE.ShaderChunk[\"fog_vertex\"],\n      THREE.ShaderChunk[\"shadowmap_vertex\"],\n\n      \"}\"\n    ].join(\"\\n\"),\n\n    fragmentShader: [\n      \"uniform sampler2D mirrorSampler;\",\n      \"uniform float alpha;\",\n      \"uniform float time;\",\n      \"uniform float size;\",\n      \"uniform float distortionScale;\",\n      \"uniform sampler2D normalSampler;\",\n      \"uniform vec3 sunColor;\",\n      \"uniform vec3 sunDirection;\",\n      \"uniform vec3 eye;\",\n      \"uniform vec3 waterColor;\",\n\n      \"varying vec4 mirrorCoord;\",\n      \"varying vec4 worldPosition;\",\n\n      \"vec4 getNoise( vec2 uv ) {\",\n      \"\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\",\n      \"\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\",\n      \"\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\",\n      \"\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\",\n      \"\tvec4 noise = texture2D( normalSampler, uv0 ) +\",\n      \"\t\ttexture2D( normalSampler, uv1 ) +\",\n      \"\t\ttexture2D( normalSampler, uv2 ) +\",\n      \"\t\ttexture2D( normalSampler, uv3 );\",\n      \"\treturn noise * 0.5 - 1.0;\",\n      \"}\",\n\n      \"void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\",\n      \"\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\",\n      \"\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\",\n      \"\tspecularColor += pow( direction, shiny ) * sunColor * spec;\",\n      \"\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\",\n      \"}\",\n\n      THREE.ShaderChunk[\"common\"],\n      THREE.ShaderChunk[\"packing\"],\n      THREE.ShaderChunk[\"bsdfs\"],\n      THREE.ShaderChunk[\"fog_pars_fragment\"],\n      THREE.ShaderChunk[\"lights_pars_begin\"],\n      THREE.ShaderChunk[\"shadowmap_pars_fragment\"],\n      THREE.ShaderChunk[\"shadowmask_pars_fragment\"],\n\n      \"void main() {\",\n      \"\tvec4 noise = getNoise( worldPosition.xz * size );\",\n      \"\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\",\n\n      \"\tvec3 diffuseLight = vec3(0.0);\",\n      \"\tvec3 specularLight = vec3(0.0);\",\n\n      \"\tvec3 worldToEye = eye-worldPosition.xyz;\",\n      \"\tvec3 eyeDirection = normalize( worldToEye );\",\n      \"\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\",\n\n      \"\tfloat distance = length(worldToEye);\",\n\n      \"\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;\",\n      \"\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.z + distortion ) );\",\n\n      \"\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\",\n      \"\tfloat rf0 = 0.3;\",\n      \"\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\",\n      \"\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\",\n      \"\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);\",\n      \"\tvec3 outgoingLight = albedo;\",\n      \"\tgl_FragColor = vec4( outgoingLight, alpha );\",\n\n      THREE.ShaderChunk[\"tonemapping_fragment\"],\n      THREE.ShaderChunk[\"fog_fragment\"],\n\n      \"}\"\n    ].join(\"\\n\")\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: true,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.mirrorSampler.value = renderTarget.texture;\n  material.uniforms.textureMatrix.value = textureMatrix;\n  material.uniforms.alpha.value = alpha;\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n  scope.mirrorCamera = mirrorCamera;\n\n  scope.onBeforeRender = function(renderer, scene, camera) {\n    mirrorWorldPosition.setFromMatrixPosition(scope.matrixWorld);\n    cameraWorldPosition.setFromMatrixPosition(camera.matrixWorld);\n\n    rotationMatrix.extractRotation(scope.matrixWorld);\n\n    normal.set(0, 0, 1);\n    normal.applyMatrix4(rotationMatrix);\n\n    view.subVectors(mirrorWorldPosition, cameraWorldPosition);\n\n    // Avoid rendering when mirror is facing away\n\n    if (view.dot(normal) > 0) return;\n\n    view.reflect(normal).negate();\n    view.add(mirrorWorldPosition);\n\n    rotationMatrix.extractRotation(camera.matrixWorld);\n\n    lookAtPosition.set(0, 0, -1);\n    lookAtPosition.applyMatrix4(rotationMatrix);\n    lookAtPosition.add(cameraWorldPosition);\n\n    target.subVectors(mirrorWorldPosition, lookAtPosition);\n    target.reflect(normal).negate();\n    target.add(mirrorWorldPosition);\n\n    mirrorCamera.position.copy(view);\n    mirrorCamera.up.set(0, 1, 0);\n    mirrorCamera.up.applyMatrix4(rotationMatrix);\n    mirrorCamera.up.reflect(normal);\n    mirrorCamera.lookAt(target);\n\n    mirrorCamera.far = camera.far; // Used in WebGLBackground\n\n    mirrorCamera.matrixNeedsUpdate = true;\n    mirrorCamera.updateMatrixWorld();\n    mirrorCamera.projectionMatrix.copy(camera.projectionMatrix);\n\n    // Update the texture matrix\n    textureMatrix.set(0.5, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.5, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 1.0);\n    textureMatrix.multiply(mirrorCamera.projectionMatrix);\n    textureMatrix.multiply(mirrorCamera.matrixWorldInverse);\n\n    // Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n    // Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n    mirrorPlane.setFromNormalAndCoplanarPoint(normal, mirrorWorldPosition);\n    mirrorPlane.applyMatrix4(mirrorCamera.matrixWorldInverse);\n\n    clipPlane.set(mirrorPlane.normal.x, mirrorPlane.normal.y, mirrorPlane.normal.z, mirrorPlane.constant);\n\n    const projectionMatrix = mirrorCamera.projectionMatrix;\n\n    q.x = (Math.sign(clipPlane.x) + projectionMatrix.elements[8]) / projectionMatrix.elements[0];\n    q.y = (Math.sign(clipPlane.y) + projectionMatrix.elements[9]) / projectionMatrix.elements[5];\n    q.z = -1.0;\n    q.w = (1.0 + projectionMatrix.elements[10]) / projectionMatrix.elements[14];\n\n    // Calculate the scaled plane vector\n    clipPlane.multiplyScalar(2.0 / clipPlane.dot(q));\n\n    // Replacing the third row of the projection matrix\n    projectionMatrix.elements[2] = clipPlane.x;\n    projectionMatrix.elements[6] = clipPlane.y;\n    projectionMatrix.elements[10] = clipPlane.z + 1.0 - clipBias;\n    projectionMatrix.elements[14] = clipPlane.w;\n\n    eye.setFromMatrixPosition(camera.matrixWorld);\n\n    //\n\n    const currentRenderTarget = renderer.getRenderTarget();\n\n    const currentXrEnabled = renderer.xr.enabled;\n    const currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n\n    scope.visible = false;\n\n    renderer.xr.enabled = false; // Avoid camera modification and recursion\n    renderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows\n\n    renderer.setRenderTarget(renderTarget);\n    renderer.render(scene, mirrorCamera);\n    renderer.setRenderTarget(null);\n\n    scope.visible = true;\n\n    renderer.xr.enabled = currentXrEnabled;\n    renderer.shadowMap.autoUpdate = currentShadowAutoUpdate;\n\n    renderer.setRenderTarget(currentRenderTarget);\n  };\n};\n\nTHREE.Water.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Water.prototype.constructor = THREE.Water;\n","/* eslint-disable @calm/react-intl/missing-formatted-message */\n\n/*\nNOTE: support.js needs to be as self-contained as possible, since it needs to work in legacy browers\nthat we do not support. Avoid adding imports to libraries or other modules from our own codebase\nthat might break the support UI in legacy browsers.\nWe also do not support localization in this file, since it would require additional transpiliation\nand polyfilling.\n*/\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport copy from \"copy-to-clipboard\";\nimport { detectOS } from \"detect-browser\";\nimport \"./react-components/styles/global.scss\";\nimport styles from \"./assets/stylesheets/support.scss\";\n\nconst SHORTHAND_INITIALIZER = \"var foo = 'bar'; var baz = { foo };\";\nconst SPREAD_SYNTAX = \"var foo = {}; var baz = { ...foo };\";\nconst CATCH_SYNTAX = \"try { foo(); } catch {}\";\n\nfunction syntaxSupported(syntax) {\n  try {\n    eval(syntax);\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction getPlatformSupport() {\n  return [\n    { name: \"Web Assembly\", supported: !!window.WebAssembly },\n    { name: \"Media Devices\", supported: !!navigator.mediaDevices },\n    {\n      name: \"Modern JavaScript Syntax\",\n      supported:\n        syntaxSupported(CATCH_SYNTAX) && syntaxSupported(SPREAD_SYNTAX) && syntaxSupported(SHORTHAND_INITIALIZER)\n    }\n  ];\n}\n\nfunction isInAppBrowser() {\n  // Some apps like Twitter, Discord and Facebook on Android and iOS open links in\n  // their own embedded preview browsers.\n  //\n  // On iOS this WebView does not have a mediaDevices API at all, but in Android apps\n  // like Facebook, the browser pretends to have a mediaDevices, but never actually\n  // prompts the user for device access. So, we show a dialog that tells users to open\n  // the room in an actual browser like Safari, Chrome or Firefox.\n  //\n  // Facebook Mobile Browser on Android has a userAgent like this:\n  // Mozilla/5.0 (Linux; Android 9; SM-G950U1 Build/PPR1.180610.011; wv) AppleWebKit/537.36 (KHTML, like Gecko)\n  // Version/4.0 Chrome/80.0.3987.149 Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/262.0.0.34.117;]\n  const detectedOS = detectOS(navigator.userAgent);\n  return (detectedOS === \"iOS\" && !navigator.mediaDevices) || /\\bfb_iab\\b/i.test(navigator.userAgent);\n}\n\nexport function platformUnsupported() {\n  return getPlatformSupport().some(s => !s.supported) || isInAppBrowser();\n}\n\nclass Support extends React.Component {\n  state = { showDetails: false, hasCopied: false };\n  toggleDetails = e => {\n    e.preventDefault();\n    this.setState(state => {\n      state.showDetails = !state.showDetails;\n      return state;\n    });\n  };\n  onCopyClicked = e => {\n    e.preventDefault();\n    copy(document.location);\n    this.setState({ hasCopied: true });\n  };\n  render() {\n    const platformSupport = getPlatformSupport();\n    const allSupported = platformSupport.every(s => s.supported);\n    const inAppBrowser = isInAppBrowser();\n\n    if (allSupported && !inAppBrowser) return null;\n\n    const detectedOS = detectOS(navigator.userAgent);\n\n    return (\n      <div className={styles.supportMain}>\n        <div className={styles.supportContent}>\n          <h1>Mozilla Hubs</h1>\n          <br />\n          <p className={styles.unsupportedLangs}>\n            · <span>Unsupported</span> · <span>No Soportado</span> · <span>Nicht Unterstützt</span>\n            {\" · \"}\n            <span>Sem Suporte</span> · <span>Non Compatible</span> · <span>不支援</span>\n            {\" · \"}\n            <span>не поддерживается</span> · <span>サポートされていません</span> ·\n          </p>\n          <br />\n          <p>\n            <span>Your browser is missing required features.</span>\n            <br />\n            {inAppBrowser ? (\n              detectedOS === \"iOS\" ? (\n                <span>Copy and paste this link directly into Safari</span>\n              ) : (\n                <span>Copy and paste this link directly into Chrome or Firefox</span>\n              )\n            ) : (\n              <span>Please try switching or updating to a newer browser</span>\n            )}\n            <br />\n            <br />\n            <input type=\"text\" readOnly onFocus={e => e.target.select()} value={document.location} />\n            <a className=\"copy-link\" href=\"#\" onClick={this.onCopyClicked}>\n              {this.state.hasCopied ? \"copied!\" : \"copy\"}\n            </a>\n            <br />\n            <br />\n            <a className={styles.detailsLink} href=\"#\" onClick={this.toggleDetails}>\n              <span>details</span>\n            </a>\n          </p>\n          {this.state.showDetails && (\n            <table className={styles.details}>\n              <tbody>\n                {platformSupport.sort((a, b) => (a.supported && !b.supported ? 1 : -1)).map(s => (\n                  <tr key={s.name}>\n                    <td>{s.name}</td>\n                    <td>{s.supported ? \"supported\" : \"unsupported\"}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  ReactDOM.render(<Support />, document.getElementById(\"support-root\"));\n});\n","// extracted by mini-css-extract-plugin\nexport default {\"support-main\":\"support__support-main__oWEp2\",\"supportMain\":\"support__support-main__oWEp2\",\"support-content\":\"support__support-content__6Fy7i\",\"supportContent\":\"support__support-content__6Fy7i\",\"unsupported-langs\":\"support__unsupported-langs__iVeQB\",\"unsupportedLangs\":\"support__unsupported-langs__iVeQB\",\"details\":\"support__details__dKlwm\"};","var map = {\n\t\"./de.json\": [\n\t\t33116,\n\t\t116\n\t],\n\t\"./es.json\": [\n\t\t27297,\n\t\t297\n\t],\n\t\"./fr.json\": [\n\t\t83056,\n\t\t56\n\t],\n\t\"./ja.json\": [\n\t\t23160,\n\t\t160\n\t],\n\t\"./ko.json\": [\n\t\t55540,\n\t\t540\n\t],\n\t\"./pt.json\": [\n\t\t10188,\n\t\t188\n\t],\n\t\"./ru.json\": [\n\t\t97441,\n\t\t441\n\t],\n\t\"./zh-cn.json\": [\n\t\t2030,\n\t\t30\n\t],\n\t\"./zh-tw.json\": [\n\t\t4076,\n\t\t76\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3 | 16);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 37472;\nmodule.exports = webpackAsyncContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"hubs:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"assets/js/\" + chunkId + \"-\" + {\"30\":\"2a313bb0559ce099018b\",\"56\":\"204d523e05a367e5b50f\",\"76\":\"238c3c7c458f7e791f6e\",\"116\":\"dfdfe9edbc5b94fe0d54\",\"160\":\"514c0c64dcfe2c8f3ba1\",\"188\":\"1c024b58d9a6b3a27b03\",\"297\":\"17c0e39486a4d8e7312a\",\"441\":\"21c791b89d435ef3c0ea\",\"540\":\"e6439bd9fcf2f8a75222\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.j = 488;","__webpack_require__.p = \"https://nztoverse-1-assets.nztoverse.com/hubs/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t488: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkhubs\"] = self[\"webpackChunkhubs\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [495,542,119,666], function() { return __webpack_require__(54560); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["AFRAME","registerComponent","multiple","schema","path","type","event","withPermission","init","this","needsPermission","data","updatePermissions","window","APP","hubChannel","hasPermission","canOrWillIfCreator","play","el","sceneEl","systems","permissions","onPermissionsUpdated","pause","removeEventListener","tick","scenes","userinput","get","emit","requireOwnership","default","NAF","utils","getNetworkedEntity","then","networkedEl","isMine","parentNode","removeChild","color","intensity","light","THREE","AmbientLight","setObject3D","update","prevData","set","convertSRGBToLinear","remove","removeObject3D","anime","require","components","animation","colorHelperFrom","Color","colorHelperTo","propertyPathCache","getComponentPropertyPath","str","delimiter","indexOf","split","getComponentProperty","name","splitName","constructor","String","getAttribute","setComponentProperty","value","setAttribute","splitCache","TYPE_COLOR","PROP_ROTATION","PROP_SCALE","STRING_COMPONENTS","toRadians","obj","x","MathUtils","degToRad","y","z","addEventListeners","eventNames","handler","i","length","addEventListener","removeEventListeners","getRawProperty","splitDot","setRawProperty","propertyName","targetValue","startsWith","r","g","b","isRawProperty","property","autoplay","delay","dir","dur","easing","elasticity","enabled","from","loop","parse","parseInt","startEvents","pauseEvents","resumeEvents","round","to","self","eventDetail","attrName","time","animationIsPlaying","onStartEvent","bind","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targets","targetsArray","updateConfigForDefault","updateConfigForRawColor","config","complete","id","oldData","direction","duration","createAndStartAnimation","t","dt","cancelDelayedStart","paused","pausedWasPlaying","updateConfig","delayTimeout","setTimeout","stopRelatedAnimations","key","waitComponentInitRawProperty","setColorConfig","push","lastValue","anim","animatables","target","isBoolean","isNaN","toString","parseFloat","aframeProperty","updateConfigForVector","coordinates","animations","Math","max","object3D","matrixNeedsUpdate","propType","component","componentName","cb","wait","evt","detail","clearTimeout","DEBUG_BBAA_COLOR","debugMaterial","MeshBasicMaterial","transparent","opacity","side","DoubleSide","inOut","outIn","debuggable","debugGeometry","BoxGeometry","debugMesh","Mesh","debugBBAA","BoxHelper","add","updateMatrixWorld","registerZone","audioZonesSystem","enableDebug","store","state","preferences","showAudioDebugPanel","unregisterZone","isEnabled","getBoundingBox","bbaa","Box3","copy","geometry","boundingBox","applyMatrix4","matrixWorld","visible","getAudioParams","audioOverrides","contains","position","containsPoint","isMobileVR","device","onlyY","_updateBillboard","_updateIsInView","schedule","unschedule","isInView","frustum","Frustum","frustumMatrix","Matrix4","box","boxTemp","expandBox","o","updateMatrices","computeBoundingBox","expandByPoint","min","screenCamera","playerCamera","document","getElementById","getObject3D","is","multiplyMatrices","projectionMatrix","matrixWorldInverse","setFromProjectionMatrix","makeEmpty","traverse","intersectsBox","targetPos","Vector3","worldPos","camera","setFromMatrixPosition","getWorldPosition","lookAt","onClick","block","owner","networked","clientId","hide","unmutedBoneName","mutedBoneName","onPos","offPos","onStateToggled","unmutedBone","getObjectByName","mutedBone","modelLoaded","updateMuteState","onMicStateChanged","dialog","on","off","muted","mediaDevicesManager","isMicEnabled","classList","log","origDispatch","dispatchEvent","Array","arguments","apply","e","includes","firstObject","console","info","JSON","stringify","k","undefined","method","castShadow","shadowMapResolution","shadowBias","shadowRadius","DirectionalLight","shadow","bias","radius","width","height","prevWidth","prevHeight","mapSize","map","dispose","frustumCulled","COLLISION_LAYERS","targetEl","takeOwnership","modifyGravityOnRelease","gravity","angularDamping","linearDamping","linearSleepingThreshold","angularSleepingThreshold","collisionFilterMask","DEFAULT_INTERACTABLE","physicsSystem","uuid","activateBody","initialForce","maxForce","maxScale","initialScale","scale","networkedEntity","entity","currentScale","force","angle","random","PI","cos","sin","transform","oneof","stateadded","stateremoved","eventSource","events","eventListeners","_handleEvent","mesh","BackSide","fog","object3DMap","fadeOut","beginTransition","fadeIn","_resolveFinish","Error","Promise","res","material","mat","offset","speed","snappedRot","Euler","snappedQ","Quaternion","snappedXForm","snappedXFormWorld","tempVector","isHovered","interaction","hoveredEl","rightRemote","hovered","leftRemote","_hoveredFrames","_applyMaskedTargetRotation","DEG2RAD","rotation","parent","worldToLocal","started","decompose","quaternion","reset","order","setFromEuler","compose","culled","updateDescendants","node","generateAndAddHeightfield","shape","mass","body","distance","orientation","CANNON","setFromAxisAngle","Vec3","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","HemisphereLight","whenPinned","_updateUI","_updateUIOnStateChange","isPinned","pinnable","pinned","pinnedAndForbidden","updateComponentState","materialQualitySetting","quality","template","isFlat","dim","onFrozenStateChange","hovering","getHoverMenu","applyHoverState","menuPromise","resolve","menu","appendChild","importNode","content","children","parentEl","animate","hoverContainer","querySelector","allowed","setScalar","image","hoverImage","activeImage","activeHoverImage","disabledImage","active","disabled","tooltip","tooltipText","activeTooltipText","onHover","updateButtonState","onHoverOut","sprite","warn","error","initializedInTick","cameraSystem","inspect","uninspect","selector","kick","close","mute","left_hand_pose","right_hand_pose","timestamps","Map","clear","count","size","register","has","performance","now","_destroyOldest","deregister","delete","oldestEl","minTs","Number","MAX_VALUE","forEach","ts","isHeld","_destroy","ttl","timeout","counter","_syncCounterRegistration","wasHeld","lastSync","syncAll","range","decay","PointLight","matrixAutoUpdate","playhead","poseIndex","overflow","poses","timestamp","setBodyKinematic","didThisOnce","UNOWNED_INTERACTABLE","innerConeAngle","outerConeAngle","SpotLight","penumbra","textHoverColor","textColor","backgroundHoverColor","backgroundColor","textEl","slice9","plane","toneMapped","once","noop","dependencies","raycast","penSpawner","drawingToPen","drawingEl","createDrawing","createDrawingPromise","createElement","handNetworkedDrawingInit","drawing","destroyDrawing","networkedDrawing","getDrawingPromise","getDrawing","pen","reject","returnDrawing","didRegister","cursorPoseTrackingSystem","unregister","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","colliders","enterComponent","enterProperty","enterValue","v","leaveComponent","leaveProperty","leaveValue","collidingLastFrame","setFromCenterAndSize","isColliding","onPauseStateChange","videoComponent","onVideoLoaded","video","togglePlaying","shouldBeVisible","contentTypes","contentSubtype","updateVisibility","contentType","catch","mediaLoader","mediaImage","mediaVideo","mediaPdf","currentContentType","matchesType","targetContentType","toLowerCase","endsWith","matchesSubtype","matches","onStateChange","newOwner","bit","nextBit","CL","ALL","NONE","INTERACTABLES","ENVIRONMENT","AVATAR","HANDS","MEDIA_FRAMES","DEFAULT_SPAWNER","module","exports","PRIVACY","TERMS","AVAILABLE_LOCALES","en","pt","ja","es","ru","fr","ko","de","FALLBACK_LOCALES","jp","defaultLocaleData","DEFAULT_LOCALE","cachedMessages","_locale","_localeData","setLocale","locale","resolvedLocale","locales","navigator","languages","language","userLanguage","unshift","curLocale","hasOwnProperty","primaryLanguageSubtag","findLocale","CustomEvent","localeData","interval","setInterval","clearInterval","getLocale","getMessages","configs","configTranslations","messageKey","entries","messages","replace","_match","subkey","reduce","acc","entry","isAdmin","process","URL","location","__webpack_public_path__","hasThumbnailServerMetaTag","IS_LOCAL_OR_CUSTOM_CLIENT","AVAILABLE_INTEGRATIONS","APP_CONFIG","theme","colorVars","style","innerHTML","join","head","insertBefore","firstChild","features","feature","featureName","localDevImages","imageName","cssUrl","url","images","link","linkName","defaultValue","links","setIsAdmin","_isAdmin","integration","availableIntegrations","translation","translationsConfig","translations","getMessage","updateVRHudPresenceCount","presence","occupantCount","Object","getOwnPropertyNames","getColorSchemePref","matchMedia","themes","find","darkModeDefault","STORYBOOK_APP_CONFIG","useDarkMode","darkMode","setDarkMode","useState","changeListener","useCallback","useEffect","darkmodeQuery","addListener","removeListener","ThemeProvider","themeId","setThemeId","onStoreChanged","nextThemeId","isArray","variables","styleTag","useTheme","useThemeFromStore","propTypes","PropTypes","waitForEvent","eventName","eventObj","waitForDOMContentLoaded","readyState","sleep","milliseconds","DEFAULT_ACTION_COLOR","DEFAULT_ACTION_COLOR_LIGHT","DEFAULT_COLORS","getThemeColor","activateTheme","actionColor","actionHoverColor","newThemeId","hackyMobileSafariTestValue","hackyMobileSafariTest","test","userAgent","hasTouchScreen","maxTouchPoints","msMaxTouchPoints","mQ","media","UA","detectTouchScreen","MOBILE_RE","TABLET_RE","isIpadOS","platform","isIOS","_isMobile","a","vendor","opera","substr","mockUserAgent","isTablet","isMobile","qs","URLSearchParams","search","isDebug","qsTruthy","logFilter","debug","names","chooseRandom","arr","floor","fetchRandomDefaultAvatarId","defaultAvatars","fetchReticulumAuthenticated","defaultAvatar","href","avatar","MediaDevicesEvents","freeze","PERMISSIONS_STATUS_CHANGED","MIC_SHARE_STARTED","MIC_SHARE_ENDED","VIDEO_SHARE_STARTED","VIDEO_SHARE_ENDED","DEVICE_CHANGE","PermissionStatus","GRANTED","DENIED","PROMPT","MediaDevices","MICROPHONE","SPEAKERS","CAMERA","SCREEN","NO_DEVICE_ID","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","Symbol","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","defaultMaterialQuality","MATERIAL_QUALITY_OPTIONS","qsMobileDefault","qsGet","qsDefault","isFirefoxReality","match","SCHEMA","definitions","profile","additionalProperties","properties","displayName","pattern","avatarId","personalAvatarId","credentials","token","email","activity","hasFoundFreeze","hasChangedName","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","hasOpenedShare","entryCount","settings","lastUsedMicDeviceId","micMuted","shouldPromptForRefresh","preferredMic","preferredSpeakers","preferredCamera","muteMicOnEntry","disableLeftRightPanning","audioNormalization","invertTouchscreenCameraMove","enableOnScreenJoystickLeft","detectMobile","enableOnScreenJoystickRight","enableGyro","animateWaypointTransitions","showFPSCounter","allowMultipleHubsInstances","disableIdleDetection","fastRoomSwitching","lazyLoadSceneMedia","preferMobileObjectInfoPanel","maxResolutionWidth","maxResolutionHeight","globalVoiceVolume","globalMediaVolume","globalSFXVolume","snapRotationDegrees","enableDynamicShadows","disableSoundEffects","disableMovement","disableBackwardsMovement","disableStrafing","disableTeleporter","disableAutoPixelRatio","movementSpeedModifier","disableEchoCancellation","disableNoiseSuppression","disableAutoGainControl","showRtcDebugPanel","enableAudioClipping","audioClippingThreshold","audioPanningQuality","cursorSize","nametagVisibility","nametagVisibilityDistance","avatarVoiceLevels","confirmedDiscordRooms","items","confirmedBroadcastedRooms","uploadPromotionTokens","fileId","promotionToken","creatorAssignmentTokens","hubId","creatorAssignmentToken","embedTokens","embedToken","onLoadActions","action","args","$ref","Store","EventTarget","super","_signOutOnExpiredAuthToken","jwtDecode","exp","Date","initProfile","_shouldResetAvatarOnInit","resetToRandomDefaultAvatar","_preferences","localStorage","getItem","setItem","oauthFlowCredentials","Cookies","maybeDispatchThemeChanged","previous","current","props","credentialsAccountId","sub","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","bumpEntryCount","currentEntryCount","enqueueOnLoadAction","executeOnLoadActions","clearOnLoadActions","arrayMerge","destinationArray","sourceArray","newState","mergeOpts","finalState","merge","valid","errors","validate","message","instance","argument","hasReticulumServer","isLocalClient","host","hubUrl","extraParams","slug","pathname","searchParams","resolverLink","directReticulumHostAndPort","reticulumMeta","invalidatedReticulumMetaThisSession","getReticulumFetchUrl","absolute","port","getReticulumMeta","version","pool","phx_host","fetch","json","phxHostOverride","refreshDirectReticulumHostAndPort","protocol","invalidateReticulumMeta","connectToReticulum","params","socketClass","Socket","getNewSocketUrl","socketUrl","socketSettings","logger","kind","msg","socket","connect","onError","endPointPath","endPoint","newEndPoint","payload","retUrl","headers","authorization","result","text","getPresenceEntryForSession","presences","sessionId","metas","getPresenceProfileForSession","migrateBindings","oldChannel","newChannel","doNotDuplicate","l","bindings","item","bindingRef","migrateChannelToSocket","channel","topic","pushBuffer","oldJoinPush","joinPush","recHooks","receive","status","callback","discordBridgesForPresences","channels","p","values","m","discordBridges","prototype","tryGetMatchingMeta","shouldAbandonMigration","ret_pool","ret_version","didMatchMeta","attempt","delayMS","ceil","transportForChannel","reliable","dataType","isOpen","connectionState","d","isFirstSync","clone","nafrPayload","naf","setDefaultSize","setRemovedRecycleThreshold","$isStringType","Networked","defineComponent","Types","creator","lastOwnerTime","Owned","NetworkedMediaFrame","capturedNid","MediaFrame","mediaType","bounds","preview","previewingNid","Text","Slice9","insets","NetworkedTransform","AEntity","Object3DTag","GLTFModel","CursorRaycastable","RemoteHoverTarget","NotRemoteHoverTarget","Holdable","RemoveNetworkedEntityButton","Interacted","HandRight","HandLeft","RemoteRight","RemoteLeft","HoveredHandRight","HoveredHandLeft","HoveredRemoteRight","HoveredRemoteLeft","HeldHandRight","HeldHandLeft","HeldRemoteRight","HeldRemoteLeft","Held","OffersRemoteConstraint","HandCollisionTarget","OffersHandConstraint","TogglesHoveredActionSet","HoverButton","TextButton","labelRef","HoldableButton","SingleActionButton","Pen","HoverMenuChild","Static","Inspectable","PreventAudioBoost","IgnoreSpaceBubble","Rigidbody","bodyId","collisionGroup","collisionMask","flags","PhysicsShape","shapeId","halfExtents","Pinnable","Pinned","DestroyAtExtremeDistance","MediaLoading","FloatyObject","releaseGravity","MakeKinematicOnRelease","CameraTool","snapTime","captureDurIdx","trackTarget","snapMenuRef","button_next","button_prev","snapRef","cancelRef","recVideoRef","screenRef","selfieScreenRef","cameraRef","countdownLblRef","captureDurLblRef","sndToggleRef","MyCameraTool","showHoverEffect","isFrozen","isSpawner","isEmojiSpawner","canMove","emoji","can","indexForComponent","fullComponent","findIndex","schemaComponent","nonAuthorizedSchemas","authorizeEntityManipulation","entityMetadata","sender","senderPermissions","isCreator","pin_objects","spawn_and_move_media","spawn_camera","spawn_drawing","spawn_emoji","getPendingOrExistingEntityMetadata","networkId","pendingData","connection","adapter","getPendingDataForNetworkId","schemas","schemaDict","pinnableComponent","entities","getEntity","authorizeOrSanitizeMessageData","nonAuthorizedComponents","nonAuthorizedComponent","index","initializeNonAuthorizedSchemas","nonAuthorizedIndices","sanitizeMessageData","persistentSyncs","stashPersistentSync","entityData","currentData","currentComponents","assign","from_session_id","emptyObject","applyPersistentSync","handleIncomingNAF","getTimeOffsetToServer","clientSentTime","serverReceivedTime","cache","getTime","precision","clientReceivedTime","getAverageTimeOffset","average","offsets","n","nextTick","addAnimationComponents","modelEl","adapters","persistent","presenceState","sanitizedAny","stashedAny","filter","authorizeOrSanitizeMessage","source","frozen","nafMessageReceived","storeMessage","handleIncomingNAFR","unparsedData","refs","frozenUpdates","_blockedClients","setServerUrl","setApp","setRoom","setWebRtcOptions","setServerConnectListeners","nafConnectSuccess","nafConnectFailed","setRoomOccupantListener","setDataChannelListeners","nafOccupantJoined","nafOccupantLeave","session_id","reliableTransport","unreliableTransport","list","shouldStartConnectionTo","startStreamConnection","closeStreamConnection","getConnectStatus","getMediaStream","getServerTime","sendData","sendDataGuaranteed","broadcastData","broadcastDataGuaranteed","disconnect","toggleFreeze","unfreeze","flushPendingUpdates","getPendingData","dataForUpdateMultiMessage","storeSingleMessage","storedMessage","storedData","isOutdatedMessage","isContemporaneousMessage","unblock","newDebug","PC_PROPRIETARY_CONSTRAINTS","optional","googDscp","WEBCAM_SIMULCAST_ENCODINGS","scaleResolutionDownBy","maxBitrate","SCREEN_SHARING_SIMULCAST_ENCODINGS","dtx","DIALOG_CONNECTION_CONNECTED","DIALOG_CONNECTION_ERROR_FATAL","DialogAdapter","EventEmitter","_micShouldBeEnabled","_micProducer","_cameraProducer","_shareProducer","_localMediaStream","_consumers","_pendingMediaRequests","_forceTcp","_forceTurn","_iceTransportPolicy","scene","_serverParams","_consumerStats","consumerStats","downlinkBwe","_downlinkBwe","getIceServers","turn","iceServers","_serverUrl","transports","urls","username","credential","getServerStats","_protoo","connected","_sendTransport","_closed","sendTransport","stats","request","transportId","producer","_producers","producerId","_recvTransport","recvTransport","consumer","consumerId","emitRTCEvent","iceRestart","transport","iceParameters","restartIce","recreateSendTransport","closeSendTransport","createSendTransport","restartSendICE","err","checkSendIceStatus","recreateRecvTransport","closeRecvTransport","createRecvTransport","restartRecvICE","checkRecvIceStatus","serverUrl","roomId","joinToken","serverParams","forceTcp","forceTurn","iceTransportPolicy","_roomId","_joinToken","_clientId","urlWithParams","append","protooTransport","protooClient","retry","retries","cleanUpLocalState","_retryConnectWithNewHost","accept","peerId","rtpParameters","appData","consume","removeConsumer","spatialLayers","temporalLayers","mediasoupClient","encodings","scalabilityMode","resolvePendingMediaRequestForTrack","track","notification","closePeer","spatialLayer","temporalLayer","score","_joinRoom","removeAllListeners","getHost","newServerUrl","pendingMediaRequests","audio","requests","MediaStream","keys","closed","promise","sendTransportInfo","producing","consuming","sctpCapabilities","_mediasoupDevice","iceCandidates","dtlsParameters","sctpParameters","proprietaryConstraints","errback","observer","level","_videoProducer","recvTransportInfo","routerRtpCapabilities","load","_device","rtpCapabilities","_useDataChannel","setLocalMediaStream","stream","sawAudio","sawVideo","all","getTracks","stop","replaceTrack","produce","stopTracks","codecOptions","opusStereo","opusDtx","zeroRtpOnPause","disableTrackOnPause","_hubs_contentHint","disableCamera","enableShare","disableShare","enableCamera","videoGoogleStartBitrate","share","toggleMicrophone","enableMicrophone","resume","room_id","room","user_id","whom","tag","msgFunc","toLocaleTimeString","hour12","hour","minute","second","unloadRoomObjects","querySelectorAll","loadRoomObjects","objectsScene","objectsUrl","objectsEl","src","useCache","inflate","changeHub","addToHistory","hub","hub_id","hideHubPresenceEvents","migrateToHub","reason","messageDispatch","hubs","history","pushState","updateUIForHub","subscriptions","setSubscribed","web_push","remountUI","hubIsBound","hub_requires_oauth","initialIsFavorited","favorites","removeRemoteEntities","connectedClients","activeDataChannels","childNodes","getSceneUrlForHub","updateEnvironmentForHub","entryManager","retChannel","perms_token","sendEnteredEvent","hubName","showLineBreak","newHubId","substring","AnimationMixerSystem","cmp","mixer","findAncestorWithComponent","easeOutQuadratic","initMixer","AnimationMixer","splice","elasticOut","s","asin","pow","registerComponentInstance","componentRegistry","deregisterComponentInstance","getCurrentStreamer","playerInfos","playerInfo","playerSessionId","streaming","updateVolume","newRawVolume","analyser","levels","getByteTimeDomainData","sum","amplitude","sqrt","calculateVolume","newPerceivedVolume","mapLinear","E","volume","prevVolume","getAnalyser","ikRootEl","analyserEl","disableUpdates","avatarIsTalking","_updateAnalysis","_runScheduledWork","ctx","AudioContext","getContext","createAnalyser","fftSize","Uint8Array","soundSource","lastSeenVolume","registerSystem","onMicEnabled","audioSystem","outboundAnalyser","analyserLevels","minScale","cameraEl","minValue","maxValue","meshes","skinnedmesh","group","isSkinnedMesh","morphs","morphNumber","morphTargetDictionary","morphValue","morphTargetInfluences","SPRITE_NAMES","MIC","MIC_HOVER","MIC_OFF","MIC_OFF_HOVER","prevSpriteName","audioAnalyser","spriteName","clamp","objectTypeForOrigin","contentOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","srcSuffixLookupMap","objectTypeForOriginAndContentType","prefix","suffix","updateMaterials","fn","HubsMeshBasicMaterial","Material","call","emissive","emissiveIntensity","emissiveMap","lightMap","lightMapIntensity","aoMap","aoMapIntensity","alphaMap","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","onBeforeCompile","shader","uniforms","_emissive","_emissiveIntensity","_emissiveMap","fragmentShader","HubsMeshPhongMaterial","MeshPhongMaterial","vertexShader","normalMapType","normalMap","normalScale","bumpMap","bumpScale","displacementMap","displacementScale","displacementBias","reflectivity","refractionRatio","convertStandardMaterial","isMeshStandardMaterial","fromMeshStandardMaterial","disposeTexture","texture","dash","HTMLVideoElement","hls","stopLoad","detachMedia","destroy","detectIOS","HAS_IMAGE_BITMAP","createImageBitmap","HubsTextureLoader","TextureLoader","manager","onLoad","onProgress","conversionRatio","newWidth","newHeight","canvas","drawImage","format","RGBAFormat","UnsignedByteType","resizeIfNeeded","_loadImageBitmapTexture","onUpdate","loadAsync","Texture","loader","ImageBitmapLoader","setCrossOrigin","crossOrigin","setPath","bitmap","needsUpdate","Cache","resolveURL","flipY","interactorOneTransform","interactorTwoTransform","validMaterials","enableSweepingEffect","geometryRadius","sweepParams","isTouchscreen","showEffect","toggling","cursorTogglingSystem","interactorOne","interactorTwo","ready","leftHand","held","options","leftToggledOff","rightToggledOff","rightHand","toArray","worldY","elements","ms1","ms2","ms3","scaledRadius","uniform","hubs_EnableSweepingEffect","hubs_IsFrozen","hubs_SweepParams","hubs_HighlightInteractorOne","hubs_InteractorOnePos","hubs_HighlightInteractorTwo","hubs_InteractorTwoPos","hubs_Time","nonCorsProxyDomains","hostname","commonKnownContentTypes","gltf","glb","png","jpg","jpeg","pdf","mp4","mp3","basis","ktx2","m3u8","mpd","scaledThumbnailUrlFor","extension","pathParts","extensionCandidate","pop","thumbnailUrl","btoa","encodeURIComponent","_","p1","fromCharCode","farsparkEncodeUrl","urlHostname","isNonCorsProxyDomain","domain","proxiedUrlFor","parsedUrl","getAbsoluteHref","baseUrl","relativeUrl","getAbsoluteUrl","getCustomGLTFParserURLResolver","gltfUrl","basisJsUrl","basisWasmUrl","dracoWrapperJsUrl","dracoWasmUrl","corsProxyPrefix","originalUrlParts","decodeURIComponent","slice","dataUrlRegex","guessContentType","exec","originIsHubsServer","isHubsServer","origin","hubsSceneRegex","hubsAvatarRegex","hubsRoomRegex","isLocalHubsUrl","isHubsSceneUrl","isLocalHubsSceneUrl","isHubsAvatarUrl","isLocalHubsAvatarUrl","isHubsRoomUrl","groups","MediaType","MODEL","IMAGE","VIDEO","PDF","ALL_2D","linkify","Linkify","tlds","mediaAPIEndpoint","resolveUrlCache","getDefaultResolveQuality","is360","useLowerQuality","resolveUrl","bustCache","resultPromise","response","ok","statusText","upload","file","desiredContentType","formData","FormData","getDirectReticulumFetchUrl","getOrientation","reader","FileReader","onload","view","DataView","getUint16","byteLength","marker","getUint32","little","tags","readAsArrayBuffer","getLatestMediaVersionOfSrc","els","coerceToUrl","urlOrText","addMedia","fitToBox","mediaOptions","linkedEl","nid","createNetworkId","templateBody","firstElementChild","cloneNode","elAttrs","attributes","attrIdx","needsToBeUploaded","File","fileIsOwned","srcUrl","meta","access_token","file_id","promotion_token","objectType","cloneMedia","sourceEl","injectCustomShaderChunks","shaderUniforms","object","isTroikaText","reflectionProbeMode","hubs_InjectedCustomShaderChunks","newMaterial","renderer","getPromotionTokenForFile","mediaPos","addAndArrangeMedia","snapCount","mirrorOrientation","pos","rotateY","idx","localToWorld","eventType","textureLoader","createImageTexture","Image","CanvasTexture","encoding","sRGBEncoding","anisotropy","createVideoOrAudioEl","preload","addMeshScaleAnimation","onComplete","step","MIN_VALUE","closeExistingMediaMirror","mirrorTarget","textures","tex","actionButtonSrc","button","buttonSrc","nametag","nametagSrc","nametagBorderSrc","alphaTest","bottom","left","padding","right","oneOf","top","usingCustomMaterial","usingAtlas","uvAtlasMin","uvAtlasMax","textureSrc","PlaneBufferGeometry","regenerateMesh","array","uvs","uv","setPos","setUV","u","w2","h2","diff","setStyle","FrontSide","parseSide","updateMap","setMap","promisifyWorker","worker","nextItemId","outstanding","onmessage","handlers","transfer","postMessage","mask","recursive","layers","tempVector3","getLastWorldPosition","disposeMaterial","mtrl","specularMap","envMap","metalnessMap","roughnessMap","disposeNode","IDENTITY","identity","tempMatrix4","setMatrixWorld","matrixIsModified","matrix","invert","multiply","near","childrenNeedMatrixWorldUpdate","parallelTraverse","cloneObject3D","preserveUUIDs","cloneLookup","cloneUUIDLookup","sourceNode","clonedNode","animationClip","sourceAnimationClip","clonedTracks","tracks","keyframeTrack","sourceKeyframeTrack","nodeName","objectName","objectIndex","propertyIndex","PropertyBinding","parseTrackName","clonedUUID","clonedKeyframeTrack","cloneKeyframeTrack","AnimationClip","cloneAnimationClip","isMesh","boundsTree","isDirectionalLight","isSpotLight","sourceBones","skeleton","bones","sourceBone","bindMatrix","findNode","root","pred","nodes","shift","concat","interpolateAffine","mat4","end","start","interpolated","startMat4","endMat4","progress","outMat4","setFromRotationMatrix","extractRotation","slerpQuaternions","lerpVectors","setFromMatrixColumn","setFromMatrixScale","affixToWorldUp","inRotationMat4","inForward","outForward","outSide","worldUp","inMat4Copy","inMat4","multiplyScalar","projectOnVector","normalize","crossVectors","makeBasis","setPosition","calculateCameraTransformForWaypoint","upAffixedCameraTransform","upAffixedWaypointTransform","detachFromWorldUp","cameraTransform","waypointTransform","rotateInPlaceAroundWorldUp","startRotation","endRotation","theta","makeRotationY","childMatch","inverseParentWorld","childRelativeToParent","childInverse","newParentMatrix","child","createPlaneBufferGeometry","widthSegments","heightSegments","setY","getY","isFacingCamera","objWorldDir","objWorld","camWorld","viewingCamera","getWorldDirection","dot","acceleratedRaycast","gltfCache","retain","cacheItem","release","inflightGltfs","extractZipFile","defaultInflator","componentData","cloneGltf","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","getHubsComponentsFromMaterial","GLTFModelPlus","componentKey","inflator","inflateEntities","indexToEntityMap","templates","isRoot","modelToWorldScale","childEntities","entityComponents","materialComponents","nodeHasBehavior","className","setFromQuaternion","generateUUID","gltfIndex","inflatedEntity","isFirstInflation","objectInflations","objectInflation","resolveNodeRefs","propName","__mhc_link_type","prop","attachTemplate","templateRoot","targetEls","getHubsComponentsExtension","extensions","extras","ktxLoader","dracoLoader","GLTFHubsPlugin","parser","jsonPreprocessor","beforeRoot","oldHeightfieldNode","heightfield","runMigration","afterRoot","Object3D","DefaultMatrixAutoUpdate","materialQuality","parsedPath","GLTFHubsComponentsExtension","deps","resolveComponents","gltfRootType","associations","ext","getDependency","loadedDep","MOZ_texture_rgbe","GLTFHubsLightMapExtension","loadMaterial","materialIndex","materialDef","materials","extensionDef","pending","results","isMeshBasicMaterial","GLTFHubsTextureBasisExtension","basisLoader","loadTexture","textureIndex","textureDef","BasisTextureLoader","detectSupport","loadTextureImage","GLTFMozTextureRGBE","minFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","NearestFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","LinearFilter","loadGLTF","fileMap","loadingManager","LoadingManager","setURLModifier","gltfLoader","GLTFLoader","RGBELoader","setDataType","HalfFloatType","KTX2Loader","DRACOLoader","setKTX2Loader","setDRACOLoader","finally","revokeObjectURL","loadModel","resolveAsset","charAt","assetEl","loadTemplates","applySrc","templateEl","lastSrc","inflatedEl","disposeLastInflatedEl","model","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","isInterleavedBufferAttribute","triCount","MeshBVH","strategy","maxDepth","object3DToSet","inflateComponents","rewires","f","removeAttribute","clip","activeClipIndex","activeClipIndices","mixerEl","currentActions","updateClip","clipName","clips","clipNames","clipAction","setLoop","LoopRepeat","Infinity","textureToData","registeredTextures","UVScrollSystem","instances","addScaledVector","increment","Vector2","isVisibleUpToRoot","FAKE_TROIKA_BOUNDS","computeLocalBoundingBox","vertex","rootInverse","toRootSpace","excludeInvisible","union","isGeometry","vertices","itemSize","fromBufferAttribute","computeObjectAABB","getBox","boxRoot","worldSpace","isEmpty","matrixWorldNeedsUpdate","getScaleCoefficient","dX","abs","dY","dZ","DISTANCE_MODEL_OPTIONS","SourceType","MEDIA_VIDEO","AVATAR_AUDIO_SOURCE","SFX","AUDIO_TARGET","AUDIO_ZONE","AudioType","DistanceModelType","PanningModelType","HRTF","EqualPower","AvatarAudioDefaults","audioType","distanceModel","panningModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","gain","MediaAudioDefaults","TargetAudioDefaults","defaultSettingsForSourceType","getOverriddenPanningModelType","getCurrentAudioSettings","sourceType","defaults","sceneOverrides","sceneAudioDefaults","audioDebugPanelOverrides","zoneSettings","zoneOverrides","preferencesOverrides","overriddenPanningModelType","clippingState","mutedState","gainMultipliers","supplementaryAttenuation","getCurrentAudioSettingsForSourceType","updateAudioSettings","panner","setDistanceModel","setRolloffFactor","setRefDistance","setMaxDistance","setTargetAtTime","context","currentTime","applySettings","shouldAddSupplementaryAttenuation","soundEnum","SOUND_HOVER_OR_GRAB","SOUND_THAW","SOUND_PEN_STOP_DRAW","SOUND_PEN_UNDO_DRAW","SOUND_PEN_CHANGE_COLOR","SOUND_TOGGLE_MIC","SOUND_TELEPORT_START","SOUND_TELEPORT_END","SOUND_WAYPOINT_START","SOUND_WAYPOINT_END","SOUND_SNAP_ROTATE","SOUND_SPAWN_PEN","SOUND_PEN_START_DRAW","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","SOUND_ENTER_SCENE","SOUND_QUACK","SOUND_SPECIAL_QUACK","SOUND_CHAT_MESSAGE","SOUND_FREEZE","SOUND_PIN","SOUND_MEDIA_LOADING","SOUND_MEDIA_LOADED","SOUND_CAMERA_TOOL_COUNTDOWN","SOUND_PREFERENCE_MENU_HOVER","SOUND_SPAWN_EMOJI","SOUND_SPEAKER_TONE","SoundEffectsSystem","pendingAudioSourceNodes","pendingPositionalAudios","positionalAudiosStationary","positionalAudiosFollowingObject3Ds","audioContext","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","URL_SPAWN_EMOJI","URL_SPEAKER_TONE","loading","audioBufferPromise","arrayBuffer","decodeAudioData","sounds","sound","audioBuffer","isDisabled","shouldBeDisabled","stopAllPositionalAudios","enqueueSound","createBufferSource","buffer","addAudio","enqueuePositionalSound","disablePositionalAudio","positionalAudio","Audio","audioListener","PositionalAudio","setBuffer","playPositionalSoundAt","playPositionalSoundFollowing","playSoundOneShot","playSoundLooped","playSoundLoopedWithGain","createGain","stopSoundNode","removeAudio","stopPositionalAudio","inPositionalAudio","pendingIndex","isPlaying","removeFromParent","pendingPositionalAudio","positionalAudioAndObject3D","loadingObject","loadingObjectSrc","playSoundEffect","moveTheParentNotTheMesh","showLoader","clearLoadingTimeout","onMediaLoaded","handleLinkedElRemoved","refresh","animating","updateScale","center","originalMeshMatrix","desiredObjectMatrix","addVectors","scaleCoefficient","removeShape","loaderMixer","sfx","soundEffectsSystem","loadingSoundEffect","loadedSoundEffect","useFancyLoader","loadingClip","loadingScaleClip","VectorKeyframeTrack","SHAPE","showLoaderTimeout","updateHoverableVisuals","boundingSphere","Sphere","hoverableVisuals","injectedCustomShaderChunks","setFromObject","getBoundingSphere","physicsShape","shouldUpdateScale","finish","minHalfExtent","registerLinkage","contentBounds","getSize","eid","entityExists","world","removeComponent","forceLocalRefresh","srcChanged","addComponent","thumbnail","canonicalUrl","canonicalAudioUrl","accessibleUrl","isLocalModelAsset","projection","origin_audio","expected_content_type","raw","isHLS","linkedVideoTexture","linkedAudioSource","linkedMediaElementAudioSource","linkedMediaVideo","videoTexture","audioSource","mediaElementAudioSource","qsTime","startTime","hash","reduceAngularFloat","audioSrc","applyGravity","mayChangeScene","maxIndex","onNext","onPrev","onSnap","hoverMenu","nextButton","prevButton","snapButton","pageLabel","pinnableElement","newIndex","quackPercentage","specialQuackPercentage","wasInteracting","isInteracting","quack","rand","paths","actions","toggleScreenShare","snapRotateLeft","snapRotateRight","angularVelocity","logDebugFrame","logInteractionState","debugUserInput","describeCurrentMasks","cameraDelta","lobbyCameraDelta","characterAcceleration","dCharSpeed","boost","startGazeTeleport","stopGazeTeleport","spawnPen","ensureFrozen","thaw","muteMic","toggleFly","toggleUI","waypointDeltaDistance","focusChat","focusChatCommand","toggleCamera","takeSnapshot","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","transformModifier","rayObjectRotation","cursor","pose","hideLine","grab","drop","modDelta","startDrawing","stopDrawing","undoDrawing","penNextColor","penPrevColor","scalePenTip","scaleGrabbedGrabbable","mediaVolumeMod","wake","switchDrawMode","startTeleport","stopTeleport","thumb","middleRingPinky","exitMirror","startInspecting","startInspectingSelf","stopInspecting","inspectZoom","inspectPanY","resetInspectView","nextCameraMode","spawnEmoji0","spawnEmoji1","spawnEmoji2","spawnEmoji3","spawnEmoji4","spawnEmoji5","spawnEmoji6","haptics","actuators","mouse","coords","movementXY","buttonLeft","buttonRight","buttonMiddle","wheel","smartMouse","cursorPose","shouldMoveCamera","touchscreen","touchCameraDelta","gyroCameraDelta","pinch","delta","initialDistance","currentDistance","isTouching","isTouchingGrabbable","tap1","tap2","tap3","tap4","tap5","anything","gyro","averageDeltaX","averageDeltaY","hud","penButton","keyboard","gamepad","gamepadIndex","buttonIndex","pressed","touched","axis","axisIndex","xbox","buttonName","axisName","axesSum","oculusgo","trigger","touchpad","axisX","axisY","gearVRController","daydream","rightOculusTouch","leftOculusTouch","axes","wmrController","wmr","grip","joystick","vive","webxr","thumbStick","touchpadX","touchpadY","joyX","joyY","tag2ecs","isHoldable","offersRemoteConstraint","isHandCollisionTarget","offersHandConstraint","togglesHoveredActionSet","singleActionButton","holdableButton","isPen","isHoverMenuChild","isStatic","inspectable","preventAudioBoost","ignoreSpaceBubble","isTagged","elOrObject3D","hasComponent","didUpdateOnce","tagName","isSet","customFOV","enableThirdPersonMode","q","orbit","owq","owp","cwq","cwp","rwq","UP","RIGHT","dPos","targetQuat","targetScale","targetMatrix","dhQ","dvQ","pivot","rig","dh","dv","dz","panY","getWorldQuaternion","applyQuaternion","premultiply","subVectors","zoom","newLength","moveRigSoCameraLooksAtPivot","oForw","defaultBoxMax","distanceMod","getCenter","vrMode","dist","fov","aspect","halfYExtents","halfXExtents","halfVertFOV","halfHorFOV","atan","tan","length1","length2","length3","calculateViewingDistance","NEXT_MODES","ensureLightsAreSeenByCamera","isLight","enable","firstPersonOnlyLayer","Layers","enableInspectLayer","disableInspectLayer","disable","CameraSystem","uiRoot","updateMatrix","entered","mode","quat","viewingRig","avatarRig","characterController","fly","avatarPOV","enteredScene","avatarPOVRotator","viewingCameraRotator","hoverEl","nextMode","ensureListenerIsParentedCorrectly","makeTranslation","horizontalDelta","verticalDelta","snapshot","audioSourceTargetTransform","lightsEnabled","audioTransform","xrManager","xr","updateXRCamera","updateCamera","xrCamera","getCamera","cameras","bg","fireChangeEvent","getInspectableInHierarchy","pivotFor","getInspectableAndPivot","hideEverythingButThisObject","c","getAudio","showEverythingAsNormal","toggleLights","notHiddenObject","lerp","newRot","positionOnly","scenePreviewCameraSystem","startPoint","targetPoint","targetRotDelta","targetRotation","backwards","ranOnePass","tick2","hubsSystems","streamerCamera","streamer","getStreamerCamera","translateZ","fromRot","toRot","BoxBufferGeometry","CubeCamera","PMREMGenerator","Scene","ShaderMaterial","UniformsLib","UniformsUtils","WebGLCubeRenderTarget","Sky","sky","_geometry","_inclination","_azimuth","_distance","updateSunPosition","turbidity","rayleigh","luminance","mieCoefficient","mieDirectionalG","inclination","azimuth","phi","sunPosition","generateEnvironmentMap","skyScene","cubeCamera","vrEnabled","pmremGenerator","fromCubemap","renderTarget","generateLightProbe","magFilter","lightProbe","LightProbeGenerator","skyIndex","playerHeight","loadedEvent","moveToSpawnPoint","spawnPoints","spawnPoint","MakeStaticWhenAtRest","makeStaticAtRestQuery","defineQuery","Not","makeKinematicOnReleaseExitQuery","exitQuery","enteredFloatyObjectsQuery","enterQuery","heldFloatyObjectsQuery","exitedHeldFloatyObjectsQuery","enterHeldFloatyObjectsQuery","unthrowable","spawnScale","NaN","spawnCooldown","spawnEvent","animateFromCursor","cooldownTimeout","handPosition","onSpawnEvent","tempSpawnHandPosition","handleMediaLoaded","spawnedMediaScale","spawnedEntity","divideScalar","hand","willAnimateFromCursor","activateCooldown","resetDynamicBody","sx","sy","sz","MobileWater","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","mirrorShader","ShaderChunk","lights","wrapS","wrapT","RepeatWrapping","create","Water","forceMobile","waterMesh","waterGeometry","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","water","mirrorCamera","MeshStandardMaterial","Octave","alternate","SimpleWater","resolution","lowQuality","rotateX","waterUniforms","ripplesSpeed","ripplesScale","materialClass","roughness","metalness","specular","receiveShadow","dynamic","octaves","simplex","SimplexNoise","tideHeight","tideScale","tideSpeed","waveHeight","waveScale","waveSpeed","positionAttribute","octave","noise","computeVertexNormals","vec2Equals","waterNormalsUrl","usePhongShader","defaultSrcUrl","defaultSrcImage","startColor","middleColor","endColor","startOpacity","middleOpacity","endOpacity","colorCurve","sizeCurve","startSize","endSize","sizeRandomness","ageRandomness","lifetime","lifetimeRandomness","particleCount","startVelocity","endVelocity","velocityCurve","particleEmitter","ParticleEmitter","updateParticles","setTexture","originalAudioParamsData","registerSource","unregisterSource","getPosition","sourcePos","audios","restore","THREE_SIDES","front","back","double","numberOrPercent","textAlign","anchorX","anchorY","clipRect","out","val","curveRadius","depthOffset","fillOpacity","fontUrl","fontSize","letterSpacing","lineHeight","maxWidth","outlineBlur","outlineColor","outlineOffsetX","outlineOffsetY","outlineOpacity","outlineWidth","overflowWrap","strokeColor","strokeOpacity","strokeWidth","textIndent","whiteSpace","troikaTextMesh","font","sync","outSize","bindAllEvents","unbindAllEvents","eventSrc","toggleEvents","muteEvents","unmuteEvents","onToggle","onMute","onUnmute","toggleMic","micEnabled","HIDDEN_SCALE","BoneVisibilitySystem","updateWhileInvisible","lastVisible","mic","spawn","cameraBtn","inviteBtn","background","updateButtonStates","onMicClick","onSpawnClick","onPenClick","onCameraClick","onInviteClick","onHubUpdated","entry_mode","emojis","emoji0Model","particle","emoji0Particle","emoji1Model","emoji1Particle","emoji2Model","emoji2Particle","emoji3Model","emoji3Particle","emoji4Model","emoji4Particle","emoji5Model","emoji5Particle","emoji6Model","emoji6Particle","particleEmitterConfig","spawnEmojiInFrontOfUser","emitDecayTime","emitFadeTime","emitEndTime","particleConfig","originalParticleCount","initialized","setOffsetVector","totalNumEmojis","spacing","offsetVector","sign","spawnerScale","spawnedScale","hudAngle","minHudAngle","maxHudAngle","hudDistance","spawnerPlatformWidth","spawnerPlatformSpacing","cameraWorldPosition","_onFrozen","_onThaw","spawnerEntities","spawnerEntity","requireHoverOnNonMobile","TYPE","collisionFilterGroup","cameraObject3D","_updateOffset","targetWorldPos","cameraForward","projectedCameraForward","angledCameraForward","defaultRight","transformDirection","projectOnPlane","DefaultUp","angleTo","angleOffset","applyAxisAngle","insertAfter","referenceEl","nextSibling","onEnterVr","onExitVr","onFirstInteraction","onMoveJoystickChanged","onMoveJoystickEnd","onLookJoystickChanged","onLookJoystickEnd","mockJoystickContainer","leftMock","styles","leftMockSmall","rightMock","rightMockSmall","enableLeft","enableRight","createLeftStick","createRightStick","onPreferenceChange","inVr","moving","rotating","displacement","lookDy","lookDx","newEnableLeft","newEnableRight","leftStick","leftTouchZone","rightStick","rightTouchZone","nipplejs","zone","fadeTime","ui","removeProperty","preferenceScreenIsVisible","radian","enqueueRelativeMotion","enqueueInPlaceRotationAroundWorldUp","display","cameraToolsQuery","leftController","rightController","HAND_ROTATIONS","makeRotationFromEuler","angleOnXZPlaneBetweenMatrixRotations","XZ_PLANE_NORMAL","v1","v2","matrixA","matrixB","leftEye","rightEye","neck","chest","rotationSpeed","maxLerpAngle","alwaysUpdate","headTransform","hipsPosition","invHipsToHeadVector","middleEyeMatrix","middleEyePosition","invMiddleEyeToHead","cameraYRotation","cameraYQuaternion","invHipsQuaternion","headQuaternion","rootToChest","invRootToChest","ikRoot","findIKRoot","hasConvergedHips","lastCameraTransform","forceIkUpdate","negate","hasNewCameraTransform","equals","_hadFirstTick","epsilon","w","quaternionAlmostEquals","updateHand","handRotation","handObject3D","controllerObject3D","isLeft","handMatrix","spaceInvader","setAlwaysHidden","tmpPos","isInViewOfCamera","cameraTools","screenObj","eid2obj","cameraObj","POSES","poseForFingers","subpath","handleLeftVisuals","handleRightVisuals","hadLeftVisualLastFrame","hadRightVisualLastFrame","interactingElement","hideVisual","selfDestruct","updateOffset","QUARTER_CIRCLE","rotateOnAxis","AVATARS_API","AVATAR_TYPES","getAvatarType","fetchSkinnableAvatar","resp","avatars","fetchAvatar","avatar_id","gltf_url","getAvatarSrc","fetchAvatarGltfUrl","files","avatarUnavailableImage","MAT_NAME","ensureAvatarMaterial","materialForMesh","primitives","primitive","remixAvatar","parentId","parent_avatar_listing_id","ensureAvatarNodes","some","originalRoot","avatarSrc","avatarType","isSharingAvatarCamera","applyProperties","handleModelError","handleRemoteModelError","onPresenceUpdated","onAvatarModelLoaded","isLocalPlayerInfo","getCreator","playerPresence","updateFromPresenceMeta","avatarEl","isAudioPaused","isSkinnedAvatar","erasingBonesIndex","dst","SkinnedMesh","skinIndexAttr","skinIndex","skinWeightAttr","skinWeight","getIndex","oldTriangles","triangles","bws","exclude","bw0","skin0","bw1","skin1","bw2","skin2","excludeTriangles","newTriangle","setIndex","onBeforeRender","Skeleton","boneInverses","createErasedMesh","createModelForSkinnedMesh","presenceMeta","perm","videoTextureTargets","DEBUG","ANIM_CONFIG","nametagVolumeGeometry","nametagVolumeMaterial","nametagTypingGeometry","CircleBufferGeometry","handRaisedTexture","handRaisedIconSrc","handRaisedGeometry","handRaisedMaterial","identityName","isTalking","isTyping","isOwner","isRecording","isHandRaised","volumeAvg","MovingAverage","avatarAABB","avatarAABBSize","avatarAABBCenter","nametagHeight","isAvatarReady","lastUpdateTime","onModelLoading","onModelLoaded","onModelIkFirstTick","onStateChanged","nametagIdentityName","nametagBackground","nametagStatusBorder","recordingBadge","modBadge","nametagText","handRaised","nametagVolume","nametagTyping","Group","depthWrite","updateTheme","avatarAABBHelper","Box3Helper","typingAnimTime","wasTalking","audioAnalyzer","resizeNameTag","setX","nametagElPosY","updateAvatarModelAABB","nameTagSystem","recording","roles","typing","hand_raised","updateDisplayName","updateHandRaised","prevDisplayName","tmpVector","NAMETAG_BACKGROUND_PADDING","open","thumbDown","indexDown","mrpDown","thumbUp","point","fist","NETWORK_POSES","animatePose","networkField","getNetworkedAvatar","networkedAvatar","prev","curr","LoopOnce","clampWhenFinished","setHandPose","TWOPI","lookCutoff","animRange","yawCutoff","onChildHovered","removeHoverEvents","isYLocked","lockedHeadPositionY","lookDir","lookEuler","hoverableChildren","pitch","RAD2DEG","yawDif","deltaAngle","forceHudVisible","hudLocked","hudOutOfView","wasInspecting","addState","removeState","withinDistance","withoutPermission","visibleIfOwned","camWorldPos","objWorldPos","hoverableSearch","hoverable","isVisible","shouldNotBeVisible","isWithinDistance","distanceToSquared","isTransforming","transforming","isHoldingAnything","toggle","ThreeStats","_rS","memory","geometries","programs","render","calls","points","attach","caption","over","fractions","HIDDEN_CLASS","$queries","allEntitiesQuery","aEntityQuery","onExpand","onCollapse","plugins","rStats","css","fps","below","createStats","statsEl","statsHeaderEl","statsTitleEl","collapseEl","fpsEl","lastFpsUpdate","lastFps","frameCount","inVR","vrStatsEnabled","initVRStats","lastUpdate","getOwnPropertySymbols","description","vrPanel","depthTest","toggleVRStats","frame","stepDuration","toFixed","show","getCurrentMirroredMedia","mirrorEl","refreshButton","localRefreshButton","errorImage","errorImageSrc","errorTexture","scaleToAspectRatio","ratio","browser","detect","browserIsSafari","os","ONCE_TRUE","TYPE_IMG_PNG","audioIconTexture","audioIcon","VOLUME_LABELS","j","timeFmt","h","hidePlaybackControls","videoPaused","tickRate","syncTolerance","updateHoverMenu","tryUpdateVideoPlaybackState","ensureOwned","isMineOrLocal","updateSrc","seekForward","seekBack","volumeUp","volumeDown","snap","changeVolumeBy","setupAudio","videoMutedAt","localSnapCount","isSnapping","videoIsLive","onSnapImageLoaded","hasAudioTracks","playbackControls","playPauseButton","volumeUpButton","volumeDownButton","seekForwardButton","seekBackButton","timeLabel","volumeLabel","linkButton","updateVolumeLabel","updatePlaybackState","getNetworkOwner","onPreferenceChanged","newDisableLeftRightPanning","newAudioPanningQuality","shouldRecreateAudio","shouldUpdateAudioSettings","gainMultiplier","videoWidth","videoHeight","blob","toBlob","_ignorePauseStateChanges","_playbackStateChangeTimeout","setNodeSource","mediaElement","audioSourceEl","cleanUp","createVideoTextureAudioSourceEl","refreshMediaMirror","audioTracks","mozHasAudio","webkitAudioDecodedByteCount","semver","createMediaElementSource","updateHLSLiveState","currentLevel","details","live","HLS","SphereBufferGeometry","isVideoTexture","pollTimeout","_audioSyncInterval","resolved","failLoad","videoEl","audioEl","isReady","VideoTexture","streamController","audioOnly","streamClientId","_onStreamUpdated","srcObject","getVideoTracks","dashPlayer","MediaPlayer","extend","modifyRequestHeader","xhr","modifyRequestURL","initialize","setTextDefaultEnabled","clearDefaultUTCTimingSources","addUTCTimingSource","xhrSetup","buildAbsoluteURL","loadSource","attachMedia","fatal","startLoad","recoverMediaError","setupHls","canPlayType","onerror","poll","mayModifyPlayHead","volumeModRight","volumeModLeft","pdfjs","canvasContext","renderTask","loadingSrc","numPages","page","getPage","viewport","getViewport","pw","ph","GIFTexture","frames","delays","disposals","_ctx","generateMipmaps","frameStartTime","clearRect","parseGIF","rawImageData","delayTimes","loadCnt","img","textureCache","inflightTextures","errorCacheItem","alphaMode","alphaCutoff","currentSrcIsRetained","inflightKey","createGIFTexture","mipmaps","createKTX2Texture","SMALL_GAIN_STEP","BIG_GAIN_STEP","calcLevel","MAX_VOLUME_LABELS","updateAvatarVolumesPref","muteButton","normalizer","onRemoteMuteUpdated","volumePref","updateGainMultiplier","updateLocalMuted","updatePref","isLocalMuted","calcGainStepUp","calcGainStepDown","numBars","pinchDelta","rotatePitchAndYaw","opq","oq","pq","yq","initialUpDot","initialForwardDotUp","newUpDot","newForwardDotUp","scenePreviewNode","pendingXRotation","lobby","isGhost","ROTATE_Y","updateFromLocalBB","currentPosition","localBox","offsetToCenter","updateTargetRotationFromCamera","up","forward","cameraPosition","cameraRotation","isVR","vrFocalPoint","desiredTargetQuaternion","positionAtBorderComponents","didInit","doInit","cam","didRegisterWithAnimationSystem","menuAnimationSystem","wasVisible","previousMesh","meshLocalBoundingBox","meshCenter","meshHalfExtents","meshOffsetToCenter","isTargetBoundingBoxDirty","targetLocalBoundingBox","targetCenter","targetHalfExtents","targetOffsetToCenter","markDirty","centerToCamera","intersectionToCam","desiredCenterPoint","desiredTargetPosition","currentTargetScale","desiredTargetScale","desiredTargetTransform","centerToBorder","currentMeshRotation","currentMeshScale","meshForward","boxCorners","currentMesh","isOpening","needsYRotate","intersection","getActiveIntersection","meshSphereRadius","distanceToSphere","distanceToCenter","divide","PositionAtBorderSystem","_persist","_persistAndAnimate","_animate","pinningHelper","setPinned","_isMine","isAnimationRunning","didFireThisFrame","transformObjectSystem","wasTransforming","tipSelector","labelSelector","tipEl","labelEl","onHovered","onUnhovered","wasPinned","_discordBridges","canPin","highlighted","queries","anyEntityWith","eids","$parentArray","$storeFlattened","defineNetworkSchema","Component","componentProps","shadowSymbols","ArrayBuffer","isView","shadowStore","subarray","createShadow","serialize","_world","isFullSync","changedPids","pid","getString","deserialize","updatedPids","getSid","myCam","tracking","menuPlacementRoots","findComponentsInNearestAncestor","hasEnteredFullScreenThisSession","shouldShowFullScreen","screenfull","willRequireUserGesture","showFullScreenIfAvailable","showFullScreenIfWasFullScreen","_isIn2DInterstitial","_exitAction","getUserGesture","handleExitTo2DInterstitial","isLower","exitAction","nonFullscreen","exitVR","vrNotice","exit2DInterstitialAndEnterVR","enterVR","isIn2DInterstitial","onlyOpenLink","label","exitImmersive","replaceState","initialTweet","mediaUrl","REMIX_LABEL","idForAvatarUrl","allow_remixing","copying","AMMO_BODY_ATTRIBUTES","TRANSFORM_MODE","AXIS","PUPPET","CURSOR","ALIGN","SCALE","STEP_LENGTH","CAMERA_WORLD_QUATERNION","CAMERA_WORLD_POSITION","TARGET_WORLD_QUATERNION","q2","eps","onGrabStart","transformSystem","startTransform","onGrabEnd","stopTransform","startQ","dxStore","dxApplied","dyAll","dyStore","dyApplied","raycasters","puppet","initialControllerOrientation","initialControllerOrientation_inverse","initialObjectOrientation","currentControllerOrientation","controllerOrientationDelta","planarInfo","normal","intersections","previousPointOnPlane","currentPointOnPlane","deltaOnPlane","finalProjectedVec","PI_AROUND_Y","pInv","startPlaneCasting","raycaster","far","sign2","dxAll","puppetingTick","cursorAxisOrScaleTick","cameraToPlaneDistance","modify","FORWARD","TWO_PI","calculatePlaneMatrix","planeMatrix","planeUp","planeForward","planeRight","planePosition","camPosition","planeForLeftCursor","planeForRightCursor","getMeshes","collisionEntities","isScaling","planeRotation","initialIntersectionPoint","intersectionPoint","initialObjectScale","desiredObjectScale","deltaScale","objectMatrix","dragVector","currentObjectScale","objectToScale","objectPosition","objectToCam","startScaling","didGetObjectReferences","leftEventer","leftCursorController","leftRaycaster","rightCursorController","rightRaycaster","raycastOnPlane","initialDistanceToObject","transformSelectedObjectSystem","endScaling","dotFactor","scaleFactor","CYLINDER_TEXTURE","RayCurve","numPoints","BufferGeometry","setPoint","A","B","C","D","P","Float32Array","BufferAttribute","setUsage","DynamicDrawUsage","setDirection","cross","setWidth","parabolicCurve","p0","v0","checkLineIntersection","referenceNormal","landingMaxAngle","hitPoint","intersects","intersectObjects","collisionNormal","angleNormals","isValidNormalsAngle","face","MISS_COLOR","LANDING_NORMAL","DRAW_TIME_MS","vecHelper","confirm","hitCylinderColor","hitCylinderRadius","outerRadius","hitCylinderHeight","isTeleporting","rayCurve","parabola","hit","Raycaster","rigWorldPosition","newRigWorldPosition","teleportOriginWorldPosition","teleportEventDetail","oldPosition","newPosition","prevHitHeight","hitEntity","createHitEntity","queryCollisionEntities","stopPlayingTeleportSound","teleportingSound","isTeleportingDisabled","timeTeleporting","teleportTo","playerScale","collidedIndex","timeSegment","percentToDraw","segmentT","dRadii","outerScale","easeIn","outerTorus","hitEntityOpacity","easeOutIn","torus","cylinder","TorusBufferGeometry","CylinderBufferGeometry","rotate","translate","INFO_INIT_FAILED","INFO_NO_NETWORKED_EL","INFO_NO_OWNER","SHOULD_CREATE_SILENT_AUDIO_ELS","getOwnerId","createAudio","isCreatingAudio","isRemoved","createSilentAudioEl","destination","createMediaStreamDestination","mediaStreamSource","createMediaStreamSource","destinationSource","mediaStream","ownerId","newStream","tmpWorldPos","onlyMods","muteSelf","gainFilter","whiteNoise","bufferSize","sampleRate","noiseBuffer","createBuffer","getChannelData","createWhiteNoise","setInput","getMaxScaleOnAxis","boundingRadiusSquared","LineSegments","WireframeGeometry","newInput","input","getGainFilter","trackingEl","minDelay","maxDelay","srcEl","connectAudio","delayNode","createDelay","delayTime","randFloat","setFilters","srcZone","isCamera","WebGLRenderTarget","depth","stencil","textureNeedsUpdate","tock","lastRenderTime","tmpXRFlag","tmpOnAfterRender","onAfterRender","tmpAutoUpdate","autoUpdate","setRenderTarget","targetBaseColorMap","targetEmissiveMap","getMaterial","mask1","originalMap","originalEmissiveMap","videoTextureSource","applyTexture","originalTexture","DEFAULT_MIRROR_GEOMETRY","DEFAULT_TEXTURE_WIDTH","innerWidth","devicePixelRatio","DEFAULT_TEXTURE_HEIGHT","innerHeight","reflector","Reflector","originalOnBeforeRender","originalRender","pushOrUpdateHistory","newPathname","newSearch","__historyLength","__duplicate","isDuplicate","pushHistoryState","pushHistoryPath","popToBeginningOfHubHistory","navigateToPriorPage","len","unsubscribe","listen","go","sluglessPath","withSlug","VR_DEVICE_AVAILABILITY","isMaybeGearVRCompatibleDevice","ua","isMaybeDaydreamCompatibleDevice","GENERIC_ENTRY_TYPE_DISALLOWED_DEVICES","getAvailableVREntryTypes","isSamsungBrowser","isWebVRCapableBrowser","hasNativeWebVRImplementation","isWebXRCapableBrowser","hasNativeWebXRImplementation","isDaydreamCapableBrowser","isIDevice","isFirefoxBrowser","isUIWebView","mediaDevices","safari","isCardboardCapableBrowser","displays","getVRDisplays","isOculusBrowser","screen","generic","cardboard","gearvr","capabilities","canPresent","ONLY_SCREEN_AVAILABLE","canShare","opts","title","tweetLink","ReactAudioContext","React","StateRoute","stateKey","stateValue","routeProps","MIC_PRESENCE_VOLUME_THRESHOLD","getMicrophonePresences","microphonePresences","sessionIds","currentSessionIds","talking","networkedAudioAnalysers","networkedAudioAnalyser","Sidebar","beforeTitle","afterTitle","contentClassName","disableOverflowScroll","classNames","defaultProps","IconButton","memo","forwardRef","ref","as","ButtonComponent","compactSm","lg","rest","buttonProps","_path","_path2","SvgClose","_ref","titleId","viewBox","fill","xmlns","stroke","strokeLinecap","strokeLinejoin","CloseButton","SvgChevronBack","BackButton","defaultMessage","Button","sm","xl","thin","thick","preset","NextButton","CancelButton","ContinueButton","AcceptButton","ApplyButton","InputField","htmlFor","fullWidth","_path3","SvgWarning","isExitingFullscreenDueToFocus","TextInput","invalid","beforeInput","afterInput","onFocus","onBlur","textInputStyles","InputElement","buttonStyles","iconButtonStyles","focus","select","handleTextFieldFocus","onChange","nextId","useId","TextInputField","inputClassName","labelId","labelClassName","Column","lastChildMargin","gap","centerMd","grow","gapClass","paddingClass","AvatarSettingsContent","displayNameInputRef","disableDisplayNameInput","onChangeDisplayName","avatarPreview","displayNamePattern","onChangeAvatar","spellCheck","required","AvatarSettingsSidebar","showBackButton","onBack","onClose","Modal","titleNode","disableFullscreen","AvatarSetupModal","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","CubeTextureLoader","Blob","createObjectURL","putImageData","toDataURL","disposeImageBitmap","imageBitmap","HTMLImageElement","TEXTURE_PROPS","base_map","emissive_map","normal_map","orm_map","ALL_MAPS","createRenderer","alpha","useDevicePixelRatio","antialias","premultipliedAlpha","preserveDrawingBuffer","powerPreference","WebGLRenderer","forceWebVR","outputEncoding","physicallyCorrectLights","setPixelRatio","ORBIT_ANGLE","fitBoxInFrustum","margin","applyEuler","AvatarPreview","componentDidMount","PerspectiveCamera","clientWidth","clientHeight","controls","OrbitControls","screenSpacePanning","enableKeys","loadId","avatarGltfUrl","loadCurrentAvatarGltfUrl","clock","Clock","snapshotCanvas","snapshotCamera","snapshotRenderer","setClearAlpha","previewRenderer","setClearColor","currentTheme","currentThemeObject","getThemeBackground","setAnimationLoop","getDelta","resize","mounted","parentElement","offsetWidth","offsetHeight","setSize","updateProjectionMatrix","setAvatar","resetCamera","setState","componentWillUnmount","domElement","imageBitmaps","componentDidUpdate","oldProps","applyMaps","loadPreviewAvatar","previewMesh","idleAnimation","idleAnimationAction","removeOnUpdate","getImage","originalMaps","createDefaultEnvironmentMap","applyMapToPreview","revertMap","bm","newLoadId","onGltfLoaded","newProps","mapName","applyMap","srcSet","linebreak","injectIntl","ProfileEntryPanel","getStateFromProfile","storeUpdated","saveStateAndFinish","preventDefault","hasChangedNowOrPreviously","finished","stopPropagation","setAvatarFromMediaResult","selectAction","replaceHistoryState","refetchAvatar","nameInput","_prevProps","prevState","avatarSettingsProps","inp","displayNameOverride","mediaSearchStore","sourceNavigateWithNoNav","onSubmit","containerType","EMPTY_RESULT","URL_SOURCE_TO_TO_API_SOURCE","videos","youtube","gifs","sketchfab","twitch","SOURCES","apiSource","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","_update","urlSource","getUrlMediaSource","previousSource","urlParams","requestIndex","currentRequestIndex","locationSearchParams","isMy","param","singular","lastSavedUrl","isFetching","nextCursor","next_cursor","lastFetchedUrl","pageNavigate","goBack","filterQueryNavigate","query","getSearchClearedSearchParams","keepSource","keepNav","keepSelectAction","_stashLastSearchParams","_stashedParams","_stashedSource","clearStashedQuery","sourceNavigate","_sourceNavigate","sourceNavigateToDefaultSource","hideNav","useLastStashedParams","currentQuery","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","pushExitMediaBrowserHistory","stashLastSearchParams","hasMediaPath","setHistory","AvatarUrlModal","handleSubmit","useForm","placeholder","rel","AvatarUrlModalContainer","SceneUrlModal","enableSpoke","editorName","onValidateUrl","isSubmitting","glblink","chunks","isValidGLB","getReader","header","read","readChunk","done","cancel","isValidSceneUrl","trim","SceneUrlModalContainer","intl","useIntl","formatMessage","updateScene","SvgAttach","strokeMiterlimit","ObjectUrlModal","showModelCollectionLink","modelCollectionUrl","watch","setValue","hasFile","fileName","onClear","showCloseButton","sketchfablink","collectionlink","ObjectUrlModalContainer","ducky","SvgSearch","SvgStar","SvgArrowForward","SvgArrowBack","FullscreenLayout","headerLeft","headerCenter","headerRight","MediaGrid","isVariableWidth","navTitleMessages","defineMessages","MediaBrowser","browserRef","searchInputRef","autoFocusSearch","searchPlaceholder","searchDescription","onSearchKeyDown","onClearSearch","mediaSources","selectedSource","onSelectSource","activeFilter","facets","onSelectFacet","onChangeQuery","hasNext","hasPrevious","onNextPage","onPreviousPage","noResultsMessage","autoFocus","onKeyDown","facet","_g","_defs","SvgUpload","clipPath","SvgLink","fillRule","clipRule","_path4","SvgPeople","SvgAdd","SvgPen","SvgDuplicate","SvgHelp","SvgExternalLink","PUBLISHER_FOR_ENTRY_TYPE","sketchfab_model","twitch_stream","BaseTile","additionalProps","TileComponent","tall","wide","tabIndex","role","TileAction","CreateTile","MediaTile","processThumbnailUrl","onEdit","onShowSimilar","onCopy","onInfo","attributions","publisherName","publisher","thumbnailWidth","thumbnailHeight","isImage","isAvatar","imageAspect","useMemo","imageWidth","imageHeight","useThumbnailSize","useThumbnail","last_activated_at","relativeTime","updateIntervalInSeconds","autoPlay","playsInline","alt","favorited","member_count","project_id","LegalMessage","termsUrl","privacyUrl","toslink","privacylink","SignInStep","SignInMessages","pin","unpin","changeScene","roomSettings","closeRoom","muteUser","kickUser","addOwner","removeOwner","createAvatar","remixScene","favoriteRoom","favoriteRooms","tweet","SubmitEmail","onSubmitEmail","initialEmail","setEmail","onSubmitForm","onChangeEmail","WaitForVerification","onCancel","showNewsletterSignup","SignInComplete","onContinue","SignInModal","closeable","PRIVACY_POLICY_LINKS","DEFAULT_FACETS","poweredByMessages","customObjectMessages","searchPlaceholderMessages","emptyMessages","MediaBrowserContainer","showNav","selectNextResult","clearStashedQueryOnClose","getStoreAndHistoryState","selectEntry","sourceChanged","inputRef","getUrlSource","suggestions","handleQueryUpdated","forceNow","_sendQueryTimeout","handleEntryClicked","lucky_query","handleFacetClicked","similar_to","similar_name","onMediaSearchResultEntrySelected","handleSourceClicked","showCustomMediaDialog","isAvatarApiType","showNonHistoriedDialog","handlePager","browserDiv","scrollTop","handleCopyAvatar","performConditionalSignIn","signedIn","handleCopyScene","parent_scene_id","onCreateAvatar","isSceneApiType","showCustomOption","hideSearch","showEmptyStringOnNoResult","handleCustomClicked","customObjectType","ctrlKey","blur","isScene","spokeProjectUrl","EntryStartPanel","entering","onEnteringCanceled","IfFeature","delistAvatarInfoMessage","defineMessage","defaultEditors","allowedEditors","GLTFBinarySplitterPlugin","bin","KHR_binary_glTF","asset","AvatarEditor","baseAvatarResults","editorLinks","previewGltfUrl","creatorAttribution","inputFiles","base_gltf_url","gltfs","randomAvatarResult","base","createOrUpdateAvatar","uploadAvatar","filesToUpload","uploading","fileUploads","onSave","deleteAvatar","fileField","getPreviewUrl","icon","faTimes","mapField","faCloudUploadAlt","textField","baseSid","avatarResult","selectListingField","sid","selectListingGrid","selected","paddingBottom","textarea","checkbox","checked","handleGltfLoaded","editors","companyName","license","licenselink","hideDelete","confirmDelete","has_listings","HMD_MIC_REGEXES","audioOutputSelectEnabled","HTMLMediaElement","detectedOS","detectOS","audioInputSelectEnabled","MediaDevicesManager","onDeviceChange","fetchMediaDevices","changeAudioOutput","selectedSpeakersDeviceId","_scene","_store","_micDevices","_videoDevices","_outputDevices","_deviceId","_audioTrack","_mediaStream","outboundStream","_permissionsStatus","isAudioOutputSelectEnabled","isAudioInputSelectEnabled","deviceId","audioTrack","defaultInputDeviceId","defaultOutputDeviceId","defaultVideoDeviceId","micDevicesOptions","videoDevicesOptions","outputDevicesOptions","selectedMicLabel","micLabelForAudioTrack","selectedMicDeviceId","deviceIdForMicDeviceLabel","isMicShared","getPermissionsStatus","isVideoShared","isWebcamShared","isScreenShared","micStatus","mediaDevice","videoStatus","speakersStatus","enumerateDevices","startMicShare","unmute","updatePrefs","constraints","ideal","_startMicShare","micDeviceId","micLabelForDeviceId","echoCancellation","noiseSuppression","autoGainControl","getUserMedia","addStreamToOutboundAudio","getAudioTracks","recreateAudioStream","stopMicShare","removeStreamFromOutboundAudio","startVideoShare","isDisplayMedia","success","videoTrackAdded","getDisplayMedia","frameRate","addTrack","stopVideoShare","removeTrack","shouldShowHmdMicWarning","enterInVR","hasHmdMicrophone","deviceIdForSpeakersDeviceLabel","speakersLabelForDeviceId","videoDeviceIdForMicLabel","videoLabelForDeviceId","updateGradient","backgroundImage","leftColor","rightColor","getLinearGradientCSS","Slider","useRef","addOrientationChangeListener","useCapture","ScreenOrientation","removeOrientationChangeListener","isNaturalOrientation","getScreenWidth","getScreenHeight","getScreenResolutionWidth","getMaxResolutionWidth","getMaxResolutionHeight","GLOBAL_VOLUME_MAX","WarnIcon","faExclamationTriangle","ResetToDefaultButton","faUndo","ResetToDefaultButtonPlaceholder","sanitize","countDigits","NumberRangeSelector","isFocused","displayValue","digitsFromUser","digits","storeKey","forceUpdate","sanitizedInput","numberOrReset","finalValue","num","CheckboxPlaceholder","BooleanPreference","MapCountPreference","storedPref","Select","PreferenceSelect","onChanged","MaxResolutionPreferenceItem","onOrientationChange","readOnly","multiplier","setMaxResolution","ListItem","indent","preferenceLabels","maxResolution","PreferenceListItem","isCheckbox","itemProps","prefType","isSmallScreen","prefSchema","resetToDefault","disableIfTrue","disableIfFalse","Control","IntlPreferenceListItem","TOP_LEVEL_CATEGORIES","categoryNames","NavItem","ariaLabel","controlType","ControlType","Section","Nav","RefreshPrompt","reportHeight","getComputedStyle","PreferencesScreen","onMediaDevicesUpdated","currentSpeakers","updateMediaDevices","micOptions","speakersOptions","videoOptions","category","toastHeight","createSections","browserDefault","availableLocales","availableThemes","DEFINITIONS","promptForRefresh","defaultBool","toItem","createItem","categoryName","minHeight","_path5","_path6","_path7","SvgWand","SvgChat","SvgSend","SvgReaction","TextAreaInput","TextareaAutosize","ToolbarButton","iconContainerClassName","large","statusColor","PopoverArrow","arrowClass","Popover","Content","showHeader","placement","offsetSkidding","offsetDistance","initiallyVisible","onChangeVisible","popoverApiRef","popoverClass","_visible","_setVisible","setVisible","referenceElement","setReferenceElement","popperElement","setPopperElement","arrowElement","setArrowElement","popper","popperStyles","arrow","arrowStyles","usePopper","modifiers","element","breakpoint","useCssBreakpoints","fullscreen","openPopover","closePopover","togglePopover","popoverVisible","triggerRef","createPortal","iconSheet","EmojiPicker","backgroundImageFn","sheetSize","emojiRegex","MAX_MESSAGE_LENGTH","formatMessageBody","emojiClassName","bodyLength","monospace","cleanedBody","toEmojis","multiline","emojiComponents","formattedBody","SpawnMessageButton","SendMessageButton","EmojiPickerPopoverButton","onSelectEmoji","shiftKeyDown","onKeyUp","onSelect","keepPickerOpen","pickerRemainedOpen","MessageAttachmentButton","ChatLengthWarning","messageLength","maxLength","ChatInput","warning","isOverMaxLength","onSpawn","enteredMessages","joinedMessages","LogMessageType","roomEntryRequired","flyModeDisabled","flyModeEnabled","unauthorizedSceneChange","invalidSceneUrl","unauthorizedRoomRename","captureUnavailable","captureStopped","captureStarted","captureAlreadyStopped","captureAlreadyRunning","positionalAudioEnabled","positionalAudioDisabled","setAudioNormalizationFactor","audioNormalizationDisabled","audioNormalizationNaN","invalidAudioNormalizationRange","audioSuspended","audioResumed","joinFailed","avatarChanged","logMessages","formatSystemMessage","oldName","newName","sceneName","messageType","SystemMessage","MessageBubble","ChatMessageGroup","sent","getMessageComponent","ChatMessageList","ChatSidebar","ChatToolbarButton","onScrollList","listRef","messageBodyDom","fromSessionId","onViewProfile","wrapStyle","messageBodyClasses","includeClientLink","onFromClick","renderChatMessage","allowEmojiRender","isEmoji","entryDom","ReactDOM","html2canvas","logging","meshEntity","blobUrl","meshMaterial","spawnChatMessage","ChatMessage","maySpawn","PhotoMessage","landingPageUrl","photoUrl","getLandingPageForPhoto","onShareClicked","shareHashtag","VideoMessage","ImageMessage","spawnImage","PresenceLog","domForEntry","entryClasses","expired","isBot","discord","includeFromLink","inRoom","systemMessage","presenceClasses","PreloadOverlay","loadButtonText","hubScene","screenshot_url","onLoadClicked","drawFunc","xData","yData","xSum","xRatio","yMax","yRatio","fillStyle","strokeStyle","lineWidth","x0","x1","y0","y1","beginPath","moveTo","lineTo","closePath","DataGraph","xAxis","yAxis","canvasRef","draw","animationFrameId","requestAnimationFrame","cancelAnimationFrame","useCanvas","CreatePropsFromData","propKey","propValue","Prop","DataPanel","graphData","alignSelf","flex","CollapsiblePanel","border","row","wrap","collapsed","download","rootClassName","rootStyle","flexGrow","buttonClassName","contentStyle","flexFlow","isCollapsed","collapse","openLink","SvgCaretDown","getItemValue","getSelectedItem","selectedItemValue","getItemLabel","SelectInputField","selectedItem","getToggleButtonProps","getMenuProps","getLabelProps","highlightedIndex","getItemProps","useSelect","onSelectedItemChange","selectedItemLabel","isRequired","DISTANCE_MAX","ANGLE_MAX","SelectProperty","padEnd","newValue","SliderProperty","parsedValue","getPrefs","AudioDebugPanel","isNarrow","onCollapsed","mediaSettings","setMediaSettings","avatarSettings","setAvatarSettings","onSettingChange","newSetting","setPreferences","onPreferencesUpdated","maxHeight","alignItems","marginLeft","TransportType","StatsType","ERROR_COLOR","MEDIASOUP_DOC_BASE_URL","MDN_DOC_BASE_URL","MessageButtonStyle","minWidth","isFirefox","capitalize","toUpperCase","PanelMessageButton","TrackStatsPanel","opened","codec","producerScore","producerScores","rtpStats","graph","TransportPanel","candidates","producers","consumers","isButtonEnabled","onRestart","SignalingPanel","onConnect","onDisconnect","RtcDebugPanel","logEvent","currentLog","showPanel","connectSignaling","disconnectSignaling","colorForLevel","createLogMsgs","logLines","reverse","createLog","Local","Log","Remote","runStats","getDeviceData","_recvRtpCapabilities","codecs","mimeType","clockRate","getCandidatesData","peer","getStats","selectedCandidatePairId","candidatePair","isCandidate","getTransportData","_connectionState","_id","getProducerConsumerData","profileFromPresence","profileFromConsumer","_appData","_paused","getTrackData","_kind","_track","getSignalingData","getServerData","getRtpStatsData","getGraphData","lastStats","statsData","last","bytesSent","bytesReceived","packetsSent","packetsReceived","bytesSentDelta","bytesReceivedDelta","packetsSentDelta","packetsReceivedDelta","timeDelta","getPeerSpeed","lastData","running","taskId","deviceData","serverData","signalingData","transportsData","speedData","rtpStatsData","createCandidates","createProducers","createConsumers","reducedConsumers","reducedConsumer","consumerPanels","createRemoteTransports","stat","showRtcDebug","showAudioDebug","filename","click","maskEmail","emailParts","emailIdentity","emailDomain","SvgHmcLogo","AppLogo","forceConfigurableLogo","logo","preferredThemeId","getCurrentTheme","getAppLogo","LoadingScreenLayout","SvgSpinner","Spinner","LoadingScreen","infoMessages","infoMessage","transitionDelay","messageTimeoutRef","queueNextMessage","currentIndex","useRandomMessageTransition","heading","reducer","objectCount","loadedCount","allObjectsLoaded","environmentLoaded","networkConnected","loaded","lazyLoadMedia","dialogConnected","loadingObjects","connectingScene","enteringRoom","LoadingScreenContainer","onLoaded","loadingTimeoutRef","dispatch","useReducer","onObjectLoading","onObjectLoaded","onEnvironmentLoaded","onNetworkConnected","onDialogConnected","useRoomLoadingState","Toolbar","styleUtils","hideLeft","hideRight","RoomLayout","viewportClassName","sidebar","sidebarClassName","toolbarLeft","toolbarCenter","toolbarRight","toolbarClassName","modal","objectFocused","viewportRef","RoomLayoutContainer","ResizeObserver","isPresenting","isVRPresenting","canvasRect","contentRect","rendererSize","pixelRatio","calculateRendererSize","observe","useResizeViewport","SvgEnter","SvgVr","SvgShow","SvgSettings","RoomEntryModal","roomName","showJoinRoom","onJoinRoom","showEnterOnDevice","onEnterOnDevice","showSpectate","onSpectate","showOptions","onOptions","EnterOnDeviceModal","shortUrl","loadingCode","code","headsetConnected","unsupportedBrowser","onEnterOnConnectedHeadset","char","_rect","SvgMicrophone","SvgMicrophoneMuted","SvgVolumeOff","SvgInfo","ToggleInput","MicSetupModal","microphoneOptions","onChangeMicrophone","speakerOptions","onChangeSpeaker","isMicrophoneEnabled","onPlaySound","isMicrophoneMuted","onChangeMicrophoneMuted","onEnterRoom","permissionStatus","isAudioInputSelectAvailable","isAudioOutputSelectAvailable","micLevelBar","speakerLevelBar","iconStyle","onMouseEnter","onMouseLeave","marginRight","useMicrophoneStatus","isMicMuted","setIsMicMuted","setIsMicEnabled","setPermissionsStatus","onMicMutedStateChanged","onMicDisabled","onPermissionsChanged","toggleMute","useMicrophone","micDevices","setMicDevices","micDeviceChanged","useSound","sfxSystem","analyserRef","mixerAnalyser","playSound","useSpeakers","speakerDevices","setSpeakerDevices","speakerDeviceChanged","LevelBar","useVolumeMeter","updateRate","movingAvgRef","meterRef","timout","meter","movingAverage","nextVolume","VolumeLevelBar","pct","MicSetupModalContainer","isMicMutedOnEntry","setIsMicMutedOnEntry","copyLabelMessage","copiedLabelMessage","CopyableTextInputField","buttonPreset","clipboard","useClipboard","copiedTimeout","copyLabel","copiedLabel","maxLabelLength","isSupported","copied","SvgInvite","InviteLinkInputField","fetchingInvite","inviteUrl","onRevokeInvite","showRevokeConfirmation","setShowRevokeConfirmation","revokeInvite","cancelConfirmRevokeInvite","confirmRevokeInvite","InvitePopoverContent","embed","inviteRequired","invitePopoverTitle","InvitePopoverButton","useInviteUrl","inviteId","setInviteId","fetchInvite","hub_invite_id","InvitePopoverContainer","embedText","embed_token","onInviteButtonClicked","canGenerateInviteUrl","SvgMore","MoreMenuItem","Icon","MoreMenuGroup","MoreMenuPopoverContent","MoreMenuContext","createContext","MoreMenuContextProvider","Provider","moreMenuTitle","MoreMenuPopoverButton","useContext","CompactMoreMenuButton","ChatContext","messageGroups","sendMessage","uniqueMessageId","ChatContextProvider","setMessageGroups","unreadMessages","setUnreadMessages","onReceiveMessage","newMessage","messageProps","lastMessageGroup","senderSessionId","shouldCreateNewMessageGroup","processChatMessage","updateMessageGroups","setMessagesRead","ChatSidebarContainer","canSpawnMessages","inputEffect","scrolledToBottom","setScrolledToBottom","scrollHeight","useMaintainScrollPosition","setMessage","typingTimeoutRef","shiftKey","endTyping","beginTyping","onSendMessage","onUploadAttachments","native","discordSnippet","ch","discordChannels","onScroll","ChatToolbarButtonContainer","joinChildren","renderSeparator","Children","SvgObjects","ContentMenuButton","ObjectsMenuButton","PeopleMenuButton","presenceCount","presencecount","ContentMenu","SvgCamera","SvgAvatar","SvgDelete","SvgFavorites","SvgStarOutline","SvgWarningCircle","SvgHome","SvgTextDocument","_path8","_path9","_path10","SvgSupport","SvgShield","SvgDiscord","SvgLeave","SvgDesktop","SvgPhone","SvgVolumeHigh","SvgVolumeMuted","_style","SvgHandRaised","xmlSpace","List","ButtonListItem","getDeviceLabel","hmd","mobile","getVoiceLabel","micPresence","PeopleSidebar","people","onSelectPerson","showMuteAll","onMuteAll","numPeople","person","DeviceIcon","VRIcon","DiscordIcon","PhoneIcon","DesktopIcon","getDeviceIconComponent","VoiceIcon","VolumeMutedIcon","VolumeHighIcon","VolumeOffIcon","getVoiceIconComponent","you","isMe","getPersonName","getPresenceMessage","PromoteClientModal","onConfirm","UserProfileSidebar","userId","hasMicPresence","isSignedIn","canPromote","onPromote","canDemote","onDemote","isHidden","onToggleHidden","canMute","isNetworkMuted","canKick","onKick","updateMultiplier","isMuted","updateMuted","onMultiplierChanged","getPlayerInfo","controlsEl","setMultiplier","setIsMuted","onMultiplierUpdated","onLocalMutedUpdated","useAvatarVolume","onLevelChanged","calcGainMultiplier","newLevel","UserProfileSidebarContainer","user","onCloseDialog","avatarThumbnailUrl","setAvatarThumbnailUrl","mayKick","mayMute","setIsOwner","signed_in","mayAddOwner","mayRemoveOwner","setIsHidden","getAvatarThumbnailUrl","toggleHidden","unhide","userFromPresence","micPresences","mySessionId","PeopleListContainer","mute_users","PeopleSidebarContainer","micUpdateFrequency","setPeople","updateMicrophoneState","usePeopleList","selectedPersonId","setSelectedPersonId","selectedPerson","setSelectedPerson","mediaSortOrder","mediaSort","el1","el2","faVideo","faMusic","faImage","faNewspaper","faQuestion","faCube","SORT_ORDER_TO_TYPE","getMediaType","getDisplayString","resourceName","httpIndex","lessHost","hostSplit","ObjectListContext","objects","focusedObject","selectedObject","focusObject","unfocusObject","inspectObject","uninspectObject","handleInspect","handleDeselect","ObjectListProvider","setObjects","setFocusedObject","setSelectedObject","setLightsEnabled","updateMediaEntities","sort","onInspectTargetChanged","inspectedEl","onLightsChanged","selectObject","deselectObject","selectNextObject","curObjIdx","nextObjIdx","selectPrevObject","activeObject","cloneElement","useObjectList","SvgObject","SvgImage","SvgVideo","SvgAudio","objectTypeNames","ObjectsSidebarItem","ObjectTypeIcon","VideoIcon","AudioIcon","ImageIcon","TextDocumentIcon","ObjectIcon","getObjectIcon","NoObjects","canAddObjects","ObjectsSidebar","ObjectsSidebarContainer","onUnfocusListItem","relatedTarget","onMouseOver","onMouseOut","SvgLightbulb","SvgLightbulbOutline","ObjectMenuButton","ObjectMenu","onPrevObject","onNextObject","currentObjectIndex","onToggleLights","removeNetworkedObject","getPinnedState","isPlayer","SvgPin","SvgGoTo","SvgHide","MyMenuItems","onOpenProfile","PlayerMenuItems","hideAvatar","useHideAvatar","ObjectMenuItems","onGoToObject","togglePinned","setIsPinned","pinObject","unpinObject","onPinStateChanged","userOwnsFile","usePinObject","canRemoveObject","removeObject","useRemoveObject","canGoTo","goToSelectedObject","enqueueWaypointTravelTo","willDisableMotion","willDisableTeleporting","snapToNavMesh","willMaintainInitialOrientation","useGoToSelectedObject","getObjectUrl","ObjectMenuContainer","menuItems","SvgGif","SvgScene","ButtonGridPopover","placePopoverTitle","PlacePopoverButton","filteredItems","PlacePopoverContainer","setItems","updateItems","hasActiveCamera","hasActivePen","getMyPen","nextItems","PenIcon","CameraIcon","GIFIcon","AvatarIcon","SceneIcon","UploadIcon","onSceneStateChange","SvgShare","sharePopoverTitle","SharePopoverButton","activeItem","SharePopoverContainer","sharingSource","canShareCamera","toggleShareCamera","canShareScreen","toggleShareScreen","canShareCameraToAvatar","toggleShareCameraToAvatar","setSharingSource","setCanShareCamera","setCanShareScreen","setCanShareCameraToAvatar","hasVideoTextureTarget","avatarModelEl","useAvatar","onShareVideoEnabled","onShareVideoDisabled","devices","hasCamera","useShare","Row","spaceBetween","breakpointColumn","topMargin","flexClassName","flexBasis","noWrap","childrenMarginR","breakpointColumnClass","topMarginClass","flexBasisClass","childrenMarginRClass","Divider","marginClass","AudioPopoverContent","nowrap","isSoundPlaying","AudioPopoverContentContainer","SvgArrow","AudioPopoverButton","micButton","ToolbarMicButton","rect","AudioPopoverButtonContainer","AudioPopoverContainer","ImageGridPopover","ReactionButton","HandRaisedButton","reactionPopoverTitle","ReactionPopoverContent","onToggleHandRaised","TooltipPopoverContent","ReactionPopoverButton","isReactionsVisible","setIsReactionsVisible","isTooltipVisible","setIsTooltipVisible","onTooltipHandLowered","emojiLabels","smile","laugh","clap","heart","wave","angry","cry","ReactionPopoverContainer","initialPresence","setPresence","onPresenceUpdate","usePresence","lowerHand","raiseHand","SafariMicModal","reload","RoomSignInModalContainer","cachedEmail","setCachedEmail","showTerms","showPrivacy","LeaveReason","reasonMessages","confirmationMessages","LeaveRoomModal","destinationUrl","SceneAttribution","attribution","unknown","author","SceneInfo","accountId","showAttributions","canChangeScene","onChangeScene","changeSceneButton","showSceneLink","account_id","allow_promotion","allowDisplayOfSceneLink","filteredAttributionElements","RoomSidebar","canEdit","TextAreaInputField","RadioInputContainer","RadioInputOption","RadioInputField","_RadioInputOption","NumericInput","inputMode","NumericInputField","RoomSettingsSidebar","maxRoomSize","showPublicRoomSetting","defaultValues","entryMode","spawnAndMoveMedia","shouldDirty","autoComplete","minLength","minRows","room_size","RoomSettingsSidebarContainer","applyChanges","updateHub","roomSize","AutoExitReason","AutoExitWarningModal","secondsRemaining","ExitReason","exited","denied","disconnected","full","sceneError","connectError","versionMismatch","ExitedRoomScreen","showSourceLink","subtitle","contactEmail","tcpUrl","tcpParams","CloseRoomModal","confirmText","setConfirmText","showIsNotMatchError","setShowIsNotMatchError","onClickConfirm","WebVRUnsupportedModal","emojiPlugin","createEmojiPlugin","hashtagPlugin","createHashtagPlugin","linkifyPlugin","createLinkifyPlugin","counterPlugin","createCounterPlugin","TweetEditorModal","editorState","editorRef","sending","mediaThumbnailUrl","onClickEditor","onSend","EmojiSuggestions","EmojiSelect","CharCounter","tweetLength","getCurrentContent","getPlainText","limit","TweetEditorModalContainer","setEditorState","createEditorStateWithText","contentState","entityKey","createEntity","emojiUnicode","getLastCreatedEntityKey","currentSelectionState","getSelection","emojiAddedContent","emojiEndPos","blockSize","afterRemovalContentState","Modifier","targetSelection","getSelectionAfter","getAnchorOffset","blockKey","getAnchorKey","getBlockForKey","getLength","newEditorState","EditorState","addEmoji","setSending","sendTweet","media_stored_file_url","TwitterOAuthModal","appName","TwitterOAuthModalContainer","onConnected","popupRef","getTwitterOAuthURL","screenLeft","screenTop","doingTwitterOAuth","popup","onMessage","TweetModalContainer","canTweet","setCanTweet","Tip","onDismiss","dismissLabel","moveKeys","turnLeftKey","turnRightKey","getLayoutMap","onboardingMessages","OkDismissLabel","SkipDismissLabel","FullscreenTip","TipContainer","inLobby","isStreaming","isEmbedded","lobbyTipDismissed","setLobbyTipDismissed","broadcastTipDismissed","setBroadcastTipDismissed","streamingTipDismissed","setStreamingTipDismissed","embeddedTipDismissed","setEmbeddedTipDismissed","onboardingTipId","setOnboardingTipId","onSkipOnboarding","tips","skipTips","tipId","activeTip","isBroadcasting","broadcastTarget","channelName","hasEmbedPresences","SpectatingLabel","avatarEditorDebug","IN_ROOM_MODAL_ROUTER_PATHS","IN_ROOM_MODAL_QUERY_VARS","LOBBY_MODAL_ROUTER_PATHS","LOBBY_MODAL_QUERY_VARS","LOBBY_MODAL_QUERY_VALUES","UIRoot","willCompileAndUploadMaterials","showShareDialog","linkCode","linkCodeCancel","miniInviteActivated","didConnectToNetworkedScene","noMoreLoadingUpdates","hideLoader","showPrefs","watching","waitingOnAudio","audioTrackClone","autoExitTimerStartedAt","autoExitTimerInterval","autoExitReason","secondsRemainingBeforeAutoExit","videoShareMediaSource","showVideoShareFailed","objectInfo","objectSrc","sidebarId","chatInputEffect","onConcurrentLoad","startAutoExitTimer","onIdleDetected","disableAutoExitOnIdle","onActivityDetected","endAutoExitTimer","showContextualSignInDialog","signInMessage","authChannel","onContinueAfterSignIn","authComplete","startAuthentication","closeDialog","updateSubscribedState","isSubscribed","toggleFavorited","isFavorited","onLoadingFinished","onSceneLoaded","sceneLoaded","onShareVideoFailed","shareVideo","mediaSource","endShareVideo","onSubscribeChanged","handleForceEntry","forcedVREntryType","enterDaydream","enter2D","secondsSinceStart","checkForAutoExit","exitScene","isWaitingForAutoExit","performDirectEntryFlow","hasGrantedMic","grantedMicLabels","beginOrSkipAudioSetup","onRequestMicPermission","availableVREntryTypes","onAudioReadyButton","clearHistoryState","muteOnEntry","enterScene","attemptLink","onFinished","linkChannel","generateCode","toggleShareDialog","DialogClass","toggleStreamerMode","beginStreaming","endStreaming","renderDialog","signOut","onMiniInviteClicked","hasEmbedPresence","onTweet","onFocusChat","setSidebar","renderInterstitialPrompt","onInterstitialPromptClicked","renderBotMode","sendEnteringCancelledEvent","renderEntryStartPanel","promptForNameAndAvatarBeforeEntry","entryDisallowed","sendEnteringEvent","renderDevicePanel","renderAudioSetupPanel","isInModalOrOverlay","overlay","exitEventHandler","prevProps","showSignInDialog","isBotMode","compile","isTexture","initTexture","roomLayoutStyles","hideUITip","entry_step","playerRig","UNSAFE_componentWillMount","otherState","selectedUserId","toggleSidebar","curSidebarId","getSelectedUser","rootStyles","showSafariMicDialog","showPreload","isLoading","showInterstitialPrompt","enteredOrWatching","enableSpectateVRButton","entryDialog","presenceLogEntries","showMediaBrowser","showObjectList","streamerName","renderEntryFlow","canCreateRoom","canCloseRoom","isModerator","moreMenu","LeaveIcon","EnterIcon","AddIcon","FavoritesIcon","SettingsIcon","HomeIcon","InviteIcon","StarIcon","StarOutlineIcon","DeleteIcon","closeHub","WarningCircleIcon","SupportIcon","resetTips","ShieldIcon","onPreloadLoadClicked","onSignIn","returnToProfile","onAvatarSaved","cameraMode","UIRootHooksWrapper","keyboardUserClass","keyboardUser","setKeyboardUser","onMouseDown","useAccessibleOutlineStyle","checkingForDeviceAvailability","environmentSceneLoaded","roomUnavailableReason","isSupportAvailable","ExitedRoomScreenContainer","constants","AuthChannel","setSocket","_signedIn","verifyAuthentication","authTopic","authToken","authPayload","leave","handleAuthCredentials","signIn","isSameMonth","da","db","getFullYear","getMonth","HUB_CREATOR_PERMISSIONS","VALID_PERMISSIONS","HubChannel","setPermissionsFromToken","_permissions","postgrest_role","nextRefresh","fetchPermissionsTimeout","fetchPermissions","entryDisplayType","vrDisplay","initialOccupantCount","entryState","entryEvent","getEntryTimingFlags","entryTimingFlags","isNewDaily","isNewMonthly","isNewDayWindow","isNewMonthWindow","storedLastEnteredAt","lastEntered","msSinceLastEntered","getDate","sendObjectSpawnedEvent","object_type","sendProfileUpdate","update_hub","hubInviteId","close_hub","subscribe","subscription","allowNAFTraffic","allow","_getCreatorAssignmentToken","creatorAssignmentTokenEntry","creator_assignment_token","auth_token","oauth_url","gltfNode","fileAccessToken","gltf_node","file_access_token","permsToken","_blockedSessionIds","completeSync","requestSupport","favorite","unfavorite","Set","permission","userCan","canEnterRoom","migrateToSocket","presenceBindings","onJoin","caller","onLeave","onSync","Presence","hubChannelParamsForPermsToken","migrateToChannel","beginRecording","endRecording","deriveKey","privateKey","publicKey","crypto","subtle","public","publicKeyToString","exportKey","stringToPublicKey","importKey","namedCurve","stringToArrayBuffer","buf","charCodeAt","arrayBufferToString","keyPair","generateKey","publicKeyString","incomingPublicKeyString","iv","incomingPublicKey","secret","encryptedData","encrypt","base64value","ciphertext","atob","decrypt","LINK_ACTION_TIMEOUT","LinkChannel","getLetter","readyToSend","leftChannel","incoming","generatePublicKeyAndEncryptedObject","public_key","target_session_id","reply_to_session_id","generateKeys","numOccupants","decryptObject","exceedsDensityThreshold","subtree","boundingData","isHighDensity","continueGeneration","leftResult","rightResult","isGeometryHighDensity","roots","_roots","traverseMeshesAndAddShapes","shapePrefix","shapes","meshRoot","__proto__","navMesh","fit","FIT","includeInvisible","groupEnd","interact","interactor","interactedQuery","rightRemoteQuery","leftRemoteQuery","BUTTON_TYPES","DEFAULT","ACTION","applyTheme","hoverColor","hoverComponents","hoverButtonsQuery","buttonSystems","hasAnyComponent","hoverButtonSystem","interactedEnts","interactorSettings","singleActionButtonSystem","rigidbodyQuery","rigidbodyEnteredQuery","rigidbodyExitedQuery","shapeExitQuery","DEFAULTS","isValidChild","preloadFont","characters","reservedAttrs","Ref","createRef","resolveRef","addEntity","createElementEntity","attrs","outputAttrs","attr","flat","addObject3DComponent","$isEidType","createDefaultInflator","inflators","holdable","rigidbody","guide","leftPadded","rightPadded","topPadded","bottomPadded","updateSlice9Geometry","TroikaText","modelEid","gltfSrc","renderAsEntity","entityDef","fromArray","childEid","buttonTexture","Label","cameraModelSrc","prefabs","screenMaterial","screenGeometry","buttonHeight","buttonScale","smallButtonScale","uiZ","cube","createMessageDatas","createNetworkedEntityFromRemote","prefabName","initialData","rootNid","nid2eid","spawnAllowed","createNetworkedEntity","networkedObjectsQuery","ownedNetworkObjectsQuery","networkableComponents","pendingMessages","pendingJoins","pendingParts","messageFor","created","updated","deleted","creates","updates","deletes","updateMessage","componentIds","isNetworkInstantiated","isNetworkInstantiatedByMe","subscribeToDataChannel","fromClientId","_dataType","pendingUpdatesForNid","rcvEnteredNetworkedObjectsQuery","nextNetworkTick","sendEnteredNetworkedObjectsQuery","sendExitedNetworkedObjectsQuery","MessageDispatch","commandParts","dispatchCommand","activeElement","command","scales","curScale","captureSystem","enableFly","avatarPov","setDebug","debugEnabled","inalidSceneUrl","rename","available","factor","effectiveFactor","addToPresenceLog","forceEnableTouchscreen","SceneEntryManager","whenSceneLoaded","_setupBlocking","hasEntered","_entered","session","verbose","waypointSystem","_setupPlayerRig","_setupKicking","_setupMedia","_setupCamera","_spawnAvatar","_runBot","toISOString","hasLoaded","enterSceneWhenLoaded","localMediaStream","_setPlayerInfoFromProfile","avatarScale","_lastFetchedAvatarId","kickedClientId","unpinElement","removeEntity","ev","removeEntitiesOfClient","spawnMediaInfrontOfPlayer","or","lastDebugScene","currentVideoShareEntity","forceExitFrom2DInterstitial","contentEditable","clipboardData","getData","dataTransfer","isHandlingVideoShare","shareSuccess","isVideoTrackAdded","shareError","delaySpawn","audioInput","dataInput","crossorigin","onchange","getRecording","audioStream","captureStream","mozCaptureStream","audioVolume","audioDestination","gainNode","urlBase64ToUint8Array","base64String","base64","repeat","rawData","outputArray","Subscriptions","setHubChannel","setRegistration","registration","setRegistrationFailed","setVapidPublicKey","vapidPublicKey","_isSubscribed","getCurrentEndpoint","serviceWorker","startedAt","pushManager","convertedVapidKey","permissionState","userVisibleOnly","applicationServerKey","getSubscription","endpoint","pushSubscription","has_remaining_subscriptions","Pathfinding","traverseFilteredSubtrees","pathfinder","removeNavMeshData","loadMesh","setZoneData","createZone","teleporters","helperMesh","_hubs_audio_debug_prev_material","zones","invaderPos","bubblePos","createSphereGizmo","line","invaders","bubbles","tickCount","_updateInvaders","registerBubble","bubble","unregisterBubble","registerInvader","invader","unregisterInvader","updateDebug","setInvading","tempInvasionFlags","setInvaderFlag","distanceSquared","radiusSum","flushInvadingFlagsForIndex","invading","DEBUG_OBJ","useMaterial","invadingOpacity","gltfRootEl","getGLTFModelRoot","alwaysHidden","radiusSquared","applyInvasionToMesh","originalProps","blending","NormalBlending","system","IDLE_TIMEOUT_MS","CHARACTER_ACCELERATION_PATH","BASIC_ACTIVITY_PATHS","resetTimeout","idleTimeout","lastInputCheck","onIdleTimeout","basicActivity","activityPath","penEls","updateMyPen","myPen","sets","modeMod","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","isInModal","MouseDevice","queueEvent","passive","deltaX","deltaY","deltaMode","middle","clientX","clientY","movementX","movementY","mouseDownLeftThisFrame","mouseDownRightThisFrame","mouseDownMiddleThisFrame","write","didStopProcessingEarly","setVector2","setValueType","ArrayBackedSet","initialItems","oncontextmenu","CODE_TO_KEY","KeyW","KeyA","KeyS","KeyD","KeyQ","KeyE","KeyboardDevice","seenKeys","HudDevice","XboxControllerDevice","buttonMap","buttonId","axisMap","axisId","getGamepads","xboxPaths","buttons","hapticActuators","Pose","fromOriginAndDirection","setFromUnitVectors","fromCameraProjection","normalizedX","normalizedY","unproject","applyArmModel","controllerEuler","deltaControllerPosition","controllerQuaternion","controllerPosition","gamepadPose","headObject3D","userHeight","copySittingToStandingTransform","stageParameters","sittingToStandingTransform","ONES","TOUCHPAD","TRIGGER","OculusGoControllerDevice","sittingToStandingMatrix","rayObject","rayMatrixWorld","setPose","setMatrix4","TOUCHPAD_X","TOUCHPAD_Y","GearVRControllerDevice","leftOculusTouchButtonMap","rightOculusTouchButtonMap","LEFT_HAND_OFFSET","RIGHT_HAND_OFFSET","OculusTouchControllerDevice","buttonMaps","devicePaths","handOffset","HAND_OFFSET","POSE","MATRIX","DaydreamControllerDevice","RAY_ROTATION","ViveControllerDevice","gamepads","WindowsMixedRealityControllerDevice","WebXRControllerDevice","referenceSpace","getPose","targetRaySpace","CircularBuffer","writePtr","difference","GyroDevice","hmdEuler","hmdQuaternion","prevX","prevY","dXBuffer","dYBuffer","hasPolyfill","webvrpolyfill","getPolyfillDisplays","frameData","VRFrameData","getFrameData","calculateCursorPose","AppAwareMouseDevice","touchIsAssigned","touch","assignments","assignment","identifier","jobIsAssigned","job","unassign","findByJob","findByTouch","findRemoteHoverTarget","hoveredRightRemoteQuery","hoveredLeftRemoteQuery","HIGHLIGHT","NO_HIGHLIGHT","TRANSFORM_COLOR_1","TRANSFORM_COLOR_2","defaultDistance","minDistance","cursorVisual","setCursorScale","renderOrder","RENDER_ORDER","firstHitOnly","lineGeometry","Line","LineBasicMaterial","rawIntersections","cameraPos","isGrabbing","isHoveringSomething","ray","cursorTargettingSystem","remoteHoverTarget","cursorModDelta","activeSets","leftCursorHoldingUI","rightCursorHoldingUI","lerpHSL","posePosition","cursorPosition","positionArray","computeBoundingSphere","MOVE_CURSOR_JOB","MOVE_CAMERA_JOB","FIRST_PINCHER_JOB","SECOND_PINCHER_JOB","TAP_PATHS","x2","y2","dx","dy","getPlayerCamera","AppAwareTouchscreenDevice","pendingTap","maxTouchCount","tapIndexToWriteNextFrame","getBoundingClientRect","framesUntilGrab","framesUntilUnassign","first","cameraMover","move","isFirstTouch","isSecondTouch","isThirdTouch","hasSecondPinch","setFromCamera","isSingleActionButton","isInteractable","isSceneFrozen","shouldMoveCursor","cursorJob","previousAssignment","changedTouches","touches","hasCursorJob","hasCameraJob","lastPose","angleTo4Direction","xforms","dest","scalar","scaleExp","deadzone","deadzoneSize","split_vec2","compose_vec2","copyIfFalse","bool","copyIfTrue","copyVec2IfTrue","zeroIfDefined","true","rising","risingWithFrameDelay","falling","vec2Zero","poseFromCameraProjection","vec2dpad","deadzoneRadius","invertX","invertY","deadzoneRadiusSquared","atan2","always","constValue","wasd_to_vec2","vec2","add_vec2","max_vec2","normalize_vec2","any","touch_axis_scroll","snap_to","touching","diff_vec2","invert_vec2_if_preference","preference","oneOrMinusOne","addSetsToBindings","mapping","setName","binding","wasd_vec2","keyboardCharacterAcceleration","arrows_vec2","togglePenWithRMB","togglePenWithEsc","togglePenWithP","togglePenWithHud","togglePen","startInspectingViaMouse","startInspectingViaKeyboard","stopInspectingViaKeyboard","stopInspectingViaKeyboardFocus","stopInspectingSelf","inspectZoomSpeed","keyboardMouseUserBindings","global","xform","priority","rightCursorHoldingPen","rightCursorHoldingCamera","rightCursorHoldingInteractable","rightCursorHoveringOnInteractable","rightCursorHoveringOnVideo","inputFocused","rightCursorHoveringOnUI","inspecting","zero","touchCamDeltaMaybeInverted","touchCamDelta","touchCamDeltaX","touchCamDeltaY","touchCamDeltaXScaled","touchCamDeltaYScaled","gyroCamDelta","gyroCamDeltaXScaled","gyroCamDeltaYScaled","touchscreenUserBindings","rightCursorHoveringOnPen","keyboardDebuggingBindings","leftButton","leftAxis","leftPose","rightButton","rightAxis","rightPose","wakeLeft","wakeRight","leftJoyXDeadzoned","leftJoyYDeadzoned","scaledLeftJoyX","scaledLeftJoyY","cursorDrop2","cursorDrop1","leftCursorDrop2","leftCursorDrop1","rightHandDrop2","rightGripRisingGrab","leftGripRisingGrab","rightDpadEast","rightDpadWest","rightJoy","rightJoyY1","rightJoyYDeadzoned","leftDpadEast","leftDpadWest","leftJoy","oculusTouchCharacterAcceleration","keyboardBoost","rightBoost","leftBoost","rightTouchSnapRight","rightTouchSnapLeft","keyboardSnapRight","keyboardSnapLeft","lowerButtons","upperButtons","ensureFrozenViaButtons","ensureFrozenViaKeyboard","thawViaButtons","thawViaKeyboard","leftGripPressed1","leftGripPressed2","rightGripPressed1","rightGripPressed2","leftTriggerPressed1","leftTriggerPressed2","rightTriggerPressed1","rightTriggerPressed2","oculusTouchUserBindings","north","south","east","west","override","leftHandHoveringOnNothing","leftCursorHoveringOnUI","leftCursorHoveringOnVideo","rightCursorHoveringOnNothing","leftCursorHoveringOnNothing","leftHandHoveringOnInteractable","leftHandHoldingInteractable","leftHandHoveringOnPen","leftHandHoldingPen","leftCursorHoveringOnInteractable","leftCursorHoldingInteractable","leftCursorHoldingPen","rightHandHoveringOnInteractable","rightHandHoldingInteractable","rightHandHoveringOnPen","rightHandHoldingPen","rightCursorHoveringOnCamera","rightHandHoveringOnCamera","leftHandHoveringOnCamera","rightHandHoldingCamera","leftHandHoldingCamera","leftCursorHoldingCamera","rightHandHoveringOnNothing","cursorDrop3","rightDpadNorth","rightDpadSouth","rightDpadCenter","leftDpadNorth","leftDpadSouth","leftDpadCenter","touchpadRising","dpadNorth","dpadSouth","dpadEast","dpadWest","dpadCenter","dpadCenterStrip","snapRotateRight1","snapRotateRight2","snapRotateLeft1","snapRotateLeft2","centerStripPressed","touchpadReleased","lowerButtonsReleased","webXRUserBindings","lButton","lAxis","lPose","lJoy","lJoyScaled","lJoyXScaled","lJoyYScaled","lJoyYDeadzoned","lTouch","lTouchScaled","lTouchXScaled","lTouchY","lTouchYScaled","lDpadNorth1","lDpadSouth1","lDpadEast1","lDpadWest1","lDpadCenter1","lDpadNorth2","lDpadSouth2","lDpadEast2","lDpadWest2","lDpadCenter2","lTriggerFallingStopDrawing","lGripFallingStopDrawing","lTriggerRisingGrab","lGripRisingGrab","lTouchpadRising2","lTouchpadRising1","touchCharacterAcceleration","lCharacterAcceleration","leftUndoDrawing","rButton","rAxis","rPose","rTouch","rJoy","rJoyYDeadzoned","rDpadNorth1","rDpadSouth1","rDpadEast1","rDpadWest1","rDpadCenter1","rDpadNorth2","rDpadSouth2","rDpadEast2","rDpadWest2","rDpadCenter2","rDpadCenterStrip","rTouchpadRising","rTouchpadFalling","rTriggerRisingGrab","rGripRisingGrab","rightCursorDrop1","rightCursorDrop2","rTriggerStopTeleport","rTouchpadStopTeleport","rootForFrozenOverrideWhenHolding","rightUndoDrawing","ensureFrozenViaDpad","thawViaDpad","freezeButtons","inspectButtons","rSnapRight1","rSnapLeft1","rSnapRight2","rSnapLeft2","leftTouchpadPressed1","leftTouchpadPressed2","leftTouchpadFallingStopTeleport","leftTriggerFallingStopTeleport","leftGripFallingWhileHoldingPen","viveUserBindings","rightHandTeleporting","leftHandTeleporting","leftCursorHoveringOnPen","leftCursorHoveringOnCamera","viveWandUserBindings","indexUserBindings","viveFocusPlusUserBindings","viveCosmosUserBindings","lGripPressed","rGripPressed","rTriggerPressed","rJoyNorth","rGripRising","rTriggerRising","rGripFalling","rTriggerFalling","dpadVariables","padWest","padEast","padNorth","padSouth","padCenter","padCenterStrip","dpadBindings","pad","neverFrozenBinding","penBindings","forCursor","padY","triggerPressed","padPressed","padTouched","padRising","padCenterStripTouched","handPoseBindings","gripPressed","holdingCameraBindings","wmrUserBindings","leftPadPressed","rightPadPressed","leftPadFalling","rightPadFalling","keyboardSaceFalling","freezeBindings","rJoyWest","rJoyEast","rJoyWestRising","rJoyEastRising","keyboardQRising","keyboardERising","teleportationAndRotationBindings","lJoyXDeadzoned","characterAccelerationBindings","cursorMediaVolumeModBindings","rPadNorthOrSouth","rPadNorthOrSouthPressed","rPadNorthOrSouthPressedY","cursorModDeltaBindings","scaledRightJoystickVertical","scaledLeftJoystickCursorDelta","scaledRightJoystickHorizontal","deadzonedRightJoystickHorizontal","deadzonedRightJoystickVertical","deadzonedLeftJoystickHorizontal","deadzonedLeftJoystickVertical","disableForwardOnTrigger","scaledLeftJoystickHorizontal","scaledLeftJoystickVertical","scaledLeftJoystickForwardAcceleration","xboxControllerUserBindings","rightCursorHoldingNothing","touchpadFalling","touchpadPressed","brushSizeDelta","dpadSouthDrop","dpadCenterDrop","grabBinding","dropOnCenterOrSouth","daydreamUserBindings","cardboardUserBindings","generate3DOFTriggerBindings","touchpadButton","triggerButton","touchpadXForPen","touchpadYForPen","triggerRising","triggerFalling","dpadBottomCenterStrip","dropBinding","leftTeleporter","rightTeleporter","hc","hcAFRAME","GamepadDevice","buttonPath","gamepadBindings","oculusGoUserBindings","gearVRControllerUserBindings","satisfiesPath","satisfyPath","satisfiedBy","notEmpty","isSubpath","canMask","masker","masked","maskerKey","maskerPath","maskedKey","maskedPath","isActive","toggleSet","pendingSetChanges","generation","generations","prevActiveSets","xformStates","activeDevices","registeredMappings","registeredMappingsChanged","vrGamepadMappings","nonVRGamepadMappings","addExtraMappings","activeDevice","deleteExtraMappings","updateBindingsForVRMode","inVRMode","gamepadConnected","gamepadDevice","isWebXRGamepad","gamepadDisconnected","retrieveXRGamepads","added","removed","inputSource","primaryProfile","profiles","handedness","xrSession","requestReferenceSpace","xrReferenceSpace","maybeToggleXboxMapping","vrAxesSum","mouseMovement","nonXboxActivity","hasXboxMapping","prevSortedBindings","sortedBindings","mappings","unsorted","sorted","dependencySort","masks","masksRow","bindingsRow","col","computeMasks","teleporter","leftHandHovering","leftHandHolding","leftRemoteHovering","leftRemoteHolding","rightHandHovering","rightHandHolding","rightRemoteHovering","rightRemoteHolding","leftHandHoveringOnVideo","rightHandHoveringOnVideo","leftCursorHoldingNothing","resolveActionSets","activeSetsChanged","il","elem","found","jl","arrayContentsDiffer","actives","prevActives","prevMasked","maskedRow","computeExecutionStrategy","bindingExistedLastFrame","oldValue","PATHS_TO_SHOW","replacer","userinputFrameStatus","pathsOutput","textContent","strings","maskers","logBindings","MEDIA_SEARCH_PATHS","ignoredStates","LOCAL_STORAGE_KEY","localStorageCache","tipPlatform","platformTips","desktop","standalone","markTipFinished","tip","storeData","VALIDATORS","look","locomotion","accel","turning","invite","_userinput","anyAframeEntityWith","isUI","identityFn","_performStep","prevTip","chosenTip","finishCount","rightCursorControllerEl","leftCursorControllerEl","grabPath","dropPath","previousState","updateLegacyState","cursorRaycastableQuery","enteredCursorRaycastableQuery","exitedCurserRaycastableQuery","CursorTargettingSystem","dirty","onMutation","onObject3DSet","onObject3DRemove","MutationObserver","childList","populateEntities","records","attributeName","shouldEnableRemote","handHovering","handHeld","remoteHeld","teleporting","woke","vrRemotePenIntersection","CursorTogglingSystem","domContentLoadedButComponentsMayNotHave","gotComponentReferences","rightHandTeleporter","leftHandTeleporter","gazeTeleporter","shouldEnableLeftRemote","shouldEnableRightRemote","MESSAGE_TYPES","CONSTANTS","BUFFER_CONFIG","WORLD_CONFIG","debugDrawMode","AmmoDebugConstants","PhysicsSystem","inverse","debugRequested","disableDebug","objectMatricesFloatArray","bodyUuids","bodyUuidToData","DYNAMIC","BODY_DATA_SIZE","MATRIX_OFFSET","linearVelocity","LINEAR_VELOCITY_OFFSET","ANGULAR_VELOCITY_OFFSET","collisions","COLLISIONS_OFFSET","collidingIndex","objectMatricesIntArray","indexToUuid","ammoWorker","TRANSFER_DATA","Atomics","debugIndex","setDrawRange","AmmoWorker","workerHelpers","WorkerHelpers","nextBodyUuid","nextShapeUuid","Int32Array","INIT","worldConfig","maxBodies","wasmUrl","ammoWasmUrl","READY","BODY_READY","bodyData","isInitialized","removeBodyMessageSent","SHAPES_READY","bodyUuid","shapesUuid","SharedArrayBuffer","debugSharedArrayBuffer","DefaultBufferSize","Uint32Array","debugVertices","debugColors","addAttribute","vertexColors","addBody","updateBody","updateBodyOptions","removeBody","otherId","otherData","addShapes","removeShapes","addConstraint","constraintId","targetUuid","removeConstraint","bodyInitialized","getLinearVelocity","getAngularVelocity","getCollisions","COLLISION_FILTER_MASK_HANDS","distanceBetweenStretchers","obj1","obj2","distanceTo","existsAndHeldInEither","holderA","holderB","TwoPointStretchingSystem","stretching","stretched","leftStretcher","rightStretcher","previousLeftStretcher","previousRightStretcher","initialStretchDistance","HoldableButtonSystem","prevHeld","heldLeft","prevHeldLeft","hasButtonComponent","BUTTON_COMPONENT_NAMES","getHoverableButton","HOVERED","UNHOVERED","HoverButtonSystem","button2","prevButtonLeft","DrawingMenuSystem","scaleMenus","cameraWorldPos","drawingMenus","getMenuScale","handleButtons","remotes","remote","undoDraw","serializeDrawing","showMenu","almostEquals","lastIntersection","finalScale","hideMenus","cursorControllers","getHovered","registerDrawingMenu","networkedDrawingEl","menuEl","undoButton","deleteButton","serializeButton","unregisterDrawingMenu","getSpecificHoverMenu","findHoverMenu","HoverMenuSystem","prevHoverMenu","hoverMenu2","prevHoverMenu2","SuperSpawnerSystem","maybeSpawn","HeldComponent","superSpawner","isPermitted","performSpawn","copyState","determineStrength","HapticFeedbackSystem","twoPointStretchingSystem","interactLeft","interactRight","leftActuator","rightActuator","leftHandStrength","rightHandStrength","rightRemoteStrength","leftRemoteStrength","buttonLeftStrength","buttonRightStrength","stretchingStrength","stretchSystem","stretcherLeft","stretcherRight","leftStrength","rightStrength","pulse","ScenePreviewCameraSystem","InteractionSfxSystem","colorShift","getThemeColorShifter","getImageData","ImageData","SHEET_TYPES","PNGS","spritesheetActionPng","notice","spritesheetNoticePng","ZEROS","getSheetType","spritesheetAction","didRegisterWithSystem","didFailToRegister","registered","spriteSystem","updateUVs","normalizedFrame","spritesheet","ret","raycastOnSprite","vA","vB","vC","vD","intersectionInfo","intersect","intersectTriangle","getHoverableVisuals","comp","hideDueToPinning","createGeometry","maxSprites","positions","indices","Uint16Array","drawRange","createMaterial","spritesheetTexture","RawShaderMaterial","u_spritesheet","SpriteSystem","sheetType","sprites","indicesFromSprites","WeakMap","HUD_ICONS","spritesheetPng","newTexture","oldTexture","uniformsNeedUpdate","aMv","aEnableSweepingEffect","aSweepParams","aEnableSweepingEffectNeedsUpdate","aSweepParamsNeedsUpdate","enableSweepingEffectValue","setXY","updateRange","spritesheetNotice","aUvs","lastSprite","calculateIconTransform","backward","camToWaypoint","m1","waypoint","extractBasis","isOccupiableSpawnPoint","waypointData","canBeOccupied","canBeSpawnPoint","isUnoccupiableSpawnPoint","loadTemplateAndAddToScene","templateId","isOccupiedByMe","waypointComponent","isOccupied","unoccupyWaypoint","unoccupyWaypoints","waypointComponents","WaypointSystem","helperMat4","previousWaypointHash","initialSpawnHappened","waypointForTemplateEl","elementsFromTemplatesFor","eventHandlers","lostOwnershipOfWaypoint","waypointPreviewAvatar","releaseAnyOccupiedWaypoints","currentWaypoint","teleportToWaypoint","iconEl","moveToWaypoint","tryTeleportToOccupiableWaypoint","previouslyOccupiedWaypoints","tryToOccupy","didOccupy","shouldLandWhenPossible","wp","setupEventHandlersFor","canBeClicked","onUnhover","onInteract","setupEventHandlers","waypointId","templateIds","templatesToLoadForWaypointData","elementsFromTemplates","li","unregisterComponent","ri","getUnoccupiableSpawnPoint","mightNeedRespawn","ownershipLostTime","shouldTryToOccupy","occupyWaypoint","tryToOccupyAnyOf","waypoints","candidate","currentMoveToSpawn","nextMoveToSpawn","waitOneTick","nextMoveToSpawnResolve","instant","moveToUnoccupiableSpawnPoint","waypointName","resolvedWaypointOrNull","currentMoveToSpawnResolve","waypointComponentOrNull","tickTemplateEl","elementFromTemplate","willMaintainWorldUp","mat4Pool","getCurrentPlayerHeight","NAV_ZONE","qsAllowWaypointLerp","calculateDisplacementToDesiredPOV","translationCoordinateSpace","translated","localTranslation","povMat4","allowVerticalMovement","localDisplacement","displacementToDesiredPOV","CharacterControllerSystem","deltaFromHeadToTargetForHead","targetForHead","targetForRig","targetWorldPosition","isMotionDisabled","navMeshExists","nav","findPositionOnNavMesh","travelByWaypoint","inPosition","outPosition","initialOrientation","finalPosition","finalPOV","shouldUnoccupyWaypointsOnceMoving","snapRotatedPOV","newPOV","startPOVPosition","desiredPOVPosition","navMeshSnappedPOVPosition","interpolatedWaypoint","startTranslation","waypointPosition","activeWaypoint","waypointComponentData","waypointTravelTime","isInstant","waypointTravelStartTime","animationIsOver","wasFlying","didStopFlying","navNode","dXZ","zCharacterAcceleration","relativeMotion","lerpC","nextRelativeMotion","triedToMove","lengthSq","speedModifier","shouldRecomputeNavGroupAndNavNode","shouldResnapToNavMesh","squareDistNavMeshCorrection","findPOVPositionAboveNavMesh","startingFeetPosition","desiredFeetPosition","outPOVPosition","shouldRecomputeGroupAndNode","navGroup","inTransform","motion","getClosestNode","outPos","getGroup","clampStep","CursorPoseTrackingSystem","pairs","MenuAnimationSystem","menuToCamera","menuScale","menuParentScale","menuPosition","viewingCameraEl","datum","isMenuVisible","isMenuOpening","wasMenuVisible","distanceToMenu","chooseScale","endingScale","menuOpenTime","startScaleAtMenuOpenTime","AudioSettingsSystem","onSceneReset","delayedReconnectTimeout","performDelayedReconnect","enableChromeAEC","isThreeAudio","loopbackDestination","outboundPeerConnection","RTCPeerConnection","inboundPeerConnection","addIceCandidate","iceConnectionState","streams","offer","createOffer","setLocalDescription","setRemoteDescription","answer","createAnswer","parsedSdp","sdpTransform","sdp","fmtp","AudioSystem","_resumeAudioContext","disableAEC","_sceneEl","audioNodes","mediaStreamDestinationNode","outboundGainNode","audioContextNeedsToBeResumed","getInput","_safariMobileAudioInterruptionFix","onPrefsUpdated","outputNode","newGain","sinkId","isDefault","outputMediaAudio","sink","setSinkId","onstatechange","frustumBox","inverseShadowCameraMatrixWorld","tempBox","verts","ShadowSystem","shadowCameraBoundingBox","previousShadowsEnabled","realtimeShadowsEnabled","shadowMap","PCFSoftShadowMap","computeShadowCameraBoundingBox","resizeShadowCameraFrustum","InspectYourselfSystem","EmojiSystem","emojiHudEntity","lastSpawnedEmoji","paramsReducer","addOrRemoveZone","isInZone","wasInZone","isUpdated","currZones","prevZones","predicate","setRay","hasIntersection","intersectTarget","intersectBox","updateSource","Ray","sourcePosition","sourceZones","listenerPosition","listenerZones","inOutParams","outInParams","AudioZonesSystem","didRegisterAudioListener","registerEntity","currListenerZones","sources","isListenerUpdated","unregisterEntity","distanceModels","linear","exponential","calculateAttenuation","listenerPos","GainSystem","attenuation","shouldBeClipped","toneMappingOptions","None","Linear","Reinhard","Cineon","ACESFilmic","CustomToneMapping","LUTToneMapping","outputEncodingOptions","LinearEncoding","GBEEncoding","GBM7Encoding","GBDEncoding","BasicDepthPacking","GBADepthPacking","defaultEnvSettings","toneMapping","toneMappingExposure","envMapTexture","backgroundTexture","fogType","fogColor","fogDensity","fogFar","fogNear","blenderLUTPromise","EnvironmentSystem","applyEnvSettings","setupDebugView","debugSettings","gui","GUI","debugGui","debugMode","$E","updateEnvironment","envEl","envSettingsEl","skyboxEl","navmeshEl","envSettings","skybox","getObjectByProperty","materialsNeedUpdate","newToneMapping","LUTCubeLoader","blenderLutPath","texture3D","tonemappingLUT","newOutputEncoding","lp","EquirectangularReflectionMapping","prevEnvMapTextureUUID","environment","Fog","FogExp2","density","forNear","ReflectionProbe","environmentSystem","debugBox","NameTagVisibilitySystem","avatarRigWorldPos","exitOwned","componentsToRemove","kinematicOptions","hoverHand","hoveredQuery","collision","handCollisions","findHandCollisionTargetForHand","leftHandHoveredQuery","rightHandHoveredQuery","GRAB_REMOTE_RIGHT","DROP_REMOTE_RIGHT","GRAB_REMOTE_LEFT","DROP_REMOTE_LEFT","GRAB_HAND_RIGHT","DROP_HAND_RIGHT","GRAB_HAND_LEFT","DROP_HAND_LEFT","queryHovered","hasPermissionToGrab","queryHeld","heldEid","queryHeldRemoteRight","queryHoveredRemoteRight","queryHeldRemoteLeft","queryHoveredRemoteLeft","queryHeldHandRight","queryHoveredHandRight","queryHeldHandLeft","queryHoveredHandLeft","removeHover","queryRemoteRight","queryRemoteLeft","queryHandRight","queryHandLeft","queryDoubleHeldRight","queryDoubleHeldLeft","queryDoubleHoverRight","queryDoubleHoverLeft","cleanupObjOnExit","cleanupSlice9s","cleanupGLTFs","cleanupTexts","cleanupMediaFrames","exitedObject3DQuery","tmpVec","tmpQuat","DISABLE_DEACTIVATION","ACTIVE_TAG","queryEnterRemoteRight","queryExitRemoteRight","queryEnterRemoteLeft","queryExitRemoteLeft","queryEnterHandRight","queryExitHandRight","queryEnterHandLeft","queryExitHandLeft","grabBodyOptions","activationState","releaseBodyOptions","offersConstraint","mediaFramesQuery","mediaTypeMaskFor","mediaTypeMask","isAncestor","ancestor","inOtherFrame","ignoredFrame","getCapturableEntity","frameObj","eidA","eidB","snapToFrame","framePos","frameQuat","frameScale","m4","targetObj","containerSize","setMatrixScale","scaleArray","tmpVec3","heldMediaTypes","capturable","shouldPreviewBeVisible","meshClone","srcMat","cloneObj","cloneForPreview","showPreview","hidePreview","captured","isHoldingObjectOfInterest","heldQuery","supportsCaptureStreamTrack","CanvasCaptureMediaStreamTrack","RenderTargetRecorder","captureWidth","captureHeight","srcAudioTrack","videoRenderTarget","tmpRenderTarget","getRenderTarget","videoCanvas","videoContext","videoImageData","createImageData","videoTrack","oscillator","createOscillator","setValueAtTime","createBlankAudioTrack","mediaRecorder","MediaRecorder","ondataavailable","captureFrame","srcRenderTarget","srcX0","srcY0","srcX1","srcY1","dstX0","dstY0","dstX1","dstY1","gl","srcFramebuffer","__webglFramebuffer","destFramebuffer","bindFramebuffer","READ_FRAMEBUFFER","DRAW_FRAMEBUFFER","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","blitFramebuffer","COLOR_BUFFER_BIT","LINEAR","readRenderTargetPixels","requestFrame","save","onstop","pixels","snapCanvas","imageData","videoCodec","isTypeSupported","videoMimeType","hasWebGL2","allowVideo","RENDER_WIDTH","CAPTURE_WIDTH","CAPTURE_HEIGHT","CAPTURE_DURATIONS","renderTargets","videoRecorders","captureAudio","clicked","spawnCameraFile","recorder","snapPixels","cameraToolQuery","cameraToolEnterQuery","cameraToolExitQuery","cameraToolSystem","setRendertargetDirty","lastUpdated","selfieScreenObj","allCameras","rightCursor","rotateWithRightClick","grabberPressedSnapAction","elapsed","createRecorder","msRemaining","msRemainingLastFrame","tmpVRFlag","bubbleSystem","boneVisibilitySystem","updateRenderTarget","pixelsToPNG","captureSnapshot","snapMenuObj","snapBtnObj","recBtnObj","cancelBtnObj","nextBtnObj","prevBtnObj","countdownLblObj","captureDurLblObj","sndToggleBtnObj","sndToggleLblObj","isIdle","isCounting","showViewfinder","yRot","timeLeftSec","updateUI","DIST","DOMContentDidLoad","interactionSfxSystem","superSpawnerSystem","positionAtBorderSystem","holdableButtonSystem","hoverMenuSystem","hapticFeedbackSystem","drawingMenuSystem","audioSettingsSystem","animationMixerSystem","uvScrollSystem","shadowSystem","inspectYourselfSystem","emojiSystem","gainSystem","$S","networkedObjects","partingClientId","nidString","deletedNids","ignoredNids","componentId","networkReceiveSystem","onOwnershipLost","angularFactor","ACTIVATION_STATE","emitCollisionEvents","scaleAutoUpdate","disableCollision","physicsCompatSystem","ents","networkedTransformSystem","legacyInteractionSystem","handHoverSystem","holdSystem","dontHoldWithHandAndRemote","dontHoverAndHold","interactionSystem","constraintsSystem","makeStaticAtRest","makeKinematicOnRelease","floatyObjectSystem","mediaTypesOf","mediaFrames","colliding","mediaFramesSystem","destroyAtExtremeDistanceSystem","removeNetworkedObjectButtonSystem","removeFromMap","removeObject3DSystem","networkSendSystem","_gotAudioTrack","_recorderTimeout","_initRecorder","_stream","_recorder","_tryAddingAudioTrack","listener","addLinkageHandler","syncLinkage","elA","elB","_handlingLinkage","waitForMediaLoader","handlerA","handlerB","deregisterLinkage","syncedVideoAttributes","fakePanner","maxDebugSources","unsupported","getParameter","VERSION","getWebGLVersion","maxUniformVectors","MAX_FRAGMENT_UNIFORM_VECTORS","updateState","navMeshObject","colorInner","colorOuter","colorGain","sourceOrientation","clipped","defines","MAX_DEBUG_SOURCES","sourcePositions","sourceOrientations","maxDistances","refDistances","rolloffFactors","coneInnerAngles","coneOuterAngles","gains","sourceDir","sourceNum","enableDebugMode","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","mediaInflator","isControlled","hasVolume","templateName","sanitizeUrl","euler","attachTemplateToLocal","_componentName","mediaLoaderAttributes","pageIndex","enterComponentMapping","leaveComponentMapping","targetEntity","heightfieldDistance","heightfieldData","removeUndefined","mediaDistanceModel","mediaRolloffFactor","mediaRefDistance","mediaMaxDistance","mediaConeInnerAngle","mediaConeOuterAngle","mediaConeOuterGain","mediaVolume","avatarDistanceModel","avatarRolloffFactor","avatarRefDistance","avatarMaxDistance","avatarConeInnerAngle","avatarConeOuterAngle","avatarConeOuterGain","avatarVolume","_components","srcNode","positional","aframeComponentName","bitecsComponent","$B","bitecs","PinningHelper","_signInAndPinOrUnpinElement","_pinElement","storedPromotionToken","gltfComponents","equalArray","every","mediaSrc","mediaVersion","mediaContentSubtype","pinnedEntityToGltf","addScalar","clampScalar","pathsMap","drawFrequency","minDistanceBetweenPoints","drawingManager","availableColors","minRadius","maxRadius","drawMode","penVisible","penTipPosition","timeSinceLastDraw","lastPosition","currentDrawing","worldPosition","colorIndex","grabbed","originalPosition","lastIntersectionDistance","setDirty","penTip","penLaserAttributesUpdated","penLaserAttributes","laserVisible","laserInHand","laserOrigin","remoteLaserOrigin","laserTarget","penSystem","_handleInput","grabberId","_getIntersection","_updatePenTip","_updateLaser","_setPenVisible","_doDraw","_startDraw","_endDraw","penScaleMod","_changeRadius","_changeColor","_undoDraw","worldQuaternion","laserStartPosition","laserEndPosition","camerWorldPosition","lastIntersectedObject","getLastPoint","_getNormal","directionToCamera","startDraw","endDraw","mod","InterpolationBuffer","tipMaterial","lineCurve","LineCurve3","TubeBufferGeometry","laser","laserTip","originBuffer","MODE_LERP","targetBuffer","originBufferPosition","targetBufferPosition","laserTipVisible","SharedBufferGeometry","maxBufferSize","addBuffer","prevIdx","componentSize","undo","normals","colors","addColor","setXYZ","addNormal","addVertex","addIndex","computeBoundingSpheres","SharedBufferGeometryManager","sharedBuffers","addSharedBuffer","getSharedBuffer","copyData","fromIndex","toIndex","segments","defaultRadius","maxDrawTimeout","maxLines","maxPointsPerLine","_receiveData","networkBuffer","sendNetworkBufferQueue","drawStarted","lineStarted","remoteLineStarted","receivedBufferParts","bufferIndex","connectedToOwner","networkBufferInitialized","sharedBufferGeometryManager","lastPoint","lastSegments","currentSegments","sharedBuffer","vertexCount","indexCount","networkBufferCount","currentPointCount","invalidPointRead","lastReadPointCount","networkBufferHistory","getNetworkId","drawingId","unsubscribeToDataChannel","isConnected","hasActiveDataChannel","_broadcastDrawing","_drawFromNetwork","_sendNetworkBuffer","_deleteExpiredLines","cloneMesh","sharedBufferGeometry","originalGeometry","VertexColors","exporter","GLTFExporter","binary","includeCustomExtensions","POSITIVE_INFINITY","NEGATIVE_INFINITY","temp","attribute","getX","getZ","deserializeDrawing","setHex","copyArray","didWork","pointCount","_draw","_updateBuffer","drawTime","chunkAmount","parts","_addToNetworkBuffer","getHexString","capNormal","radiusMultiplier","_generateSegments","_drawCylinder","_drawProjectedEndCap","_endLine","_drawStartCap","_pushToNetworkBuffer","_drawPoint","projectedDirection","projectedPoint","_drawEndCap","elapsedTime","copyDirection","copyNormal","setLength","getHex","_addVertex","bufferVertexCount","_addIndex","down","segment","segmentsList","angleIncrement","_rotatePointAroundAxis","calculatedDirection","_getDeserializeButton","networkedDrawingBuffer","finishDrawing","ACTIVATION_STATES","ISLAND_SLEEPING","WANTS_DEACTIVATION","DISABLE_SIMULATION","STATIC","KINEMATIC","alive","maxHalfExtent","sphereRadius","cylinderAxis","bodyEl","bodyHelper","ga","WrappedIntlProvider","updateLocale","providerLabel","slack","OAuthScreen","provider","redirectUrl","OAuthScreenContainer","oauthInfo","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","dataTexture","DataTexture","FloatType","Camera","getError","checkFloatTextureSupport","patchWebGLRenderingContext","createWorld","str2sid","sid2str","nextSid","$o","nameToComponent","object3d","owned","setupRenderer","dataset","aframeCanvas","logarithmicDepthBuffer","checkShaderErrors","AudioListener","renderClock","mainTick","_rafTime","xrFrame","timeSystem","renderStarted","HUD_BACKGROUND","OAUTH_FLOW_PERMS_TOKEN_KEY","isEmbed","PHOENIX_RELIABLE_NAF","firstSyncSource","syncSource","isOAuthModal","opener","isTelemetryDisabled","trackedPage","trackedTitle","sentryDsn","gaTrackingId","Raven","install","registerTelemetry","lastTouchAtMs","isDoubleTouch","disableiOSZoom","started_at","onStorageEvent","detectConcurrentLoad","uiProps","routerBaseName","createMemoryHistory","createBrowserHistory","basename","qsVREntryType","showOAuthScreen","mountUI","sceneUrl","isLegacyBundle","model_url","loadingEnvironment","defaultSpaceTopic","topics","glbAsset","assets","asset_type","bundleAsset","hasExtension","baseURL","LoaderUtils","extractUrlBase","sceneErrorHandler","environmentScene","envSystem","loadStart","environmentEl","fader","getBindings","emitter","vr","platformUnsupported","defaultRoomId","getCurrentHubId","onFailure","actionError","sceneInfo","handleEarlyVRMode","availableVREntryTypesPromise","getVRDisplay","vectorRequiresUpdate","almostEqualVec3","requiresNetworkUpdate","registerNetworkSchemas","buildNumber","hasVREntryDevice","runBotMode","previewCamera","reorder","setupLobbyCamera","isReloading","vapid_public_key","pushSubscriptionEndpoint","push_subscription_endpoint","createHubChannelParams","migrateToNewReticulumServer","oldSocket","teardown","onRetDeploy","pendingNotification","hasPendingNotification","handleNextMessage","isLocked","currentNotification","deployNotification","oauthFlowPermsToken","hubPhxChannel","rawOnJoin","rawOnLeave","beforeJoin","afterJoin","remaining","denoisePresence","presenceEventsForHub","presenceSync","updateSceneCopresentState","session_token","embedTokenEntry","onMediaSearchCancelled","serverURL","loadEnvironmentAndConnect","onConnectionError","handleHubChannelJoined","oauth_info","incomingMessage","userInfo","getAuthor","createInWorldLogMessage","stale_fields","titleParts","oldSlug","class","deltas","secondsSinceMeasurementStart","secondsSinceSceneVisible","maxPixelRatio","pixelRatioToTimesDecreased","disabledByPref","visibilityState","medianFps","currentPixelRatio","getPixelRatio","shouldDecrease","shouldIncrease","newPixelRatio","timesDecreased","onTimeout","onEnterVR","enteredVR","lastTimeoutCheck","exitTimeout","registry","queues","frameIndex","func","queue","permissionName","showLog","debugLog","debugLogInput","debugLogEval","onsubmit","eval","minimized","debugLogMinimize","onclick","origConsoleInfo","origConsoleLog","origConsoleError","origConsoleWarn","objs","firstObj","stack","shouldScroll","onunhandledrejection","scope","clipBias","mirrorPlane","Plane","mirrorWorldPosition","rotationMatrix","lookAtPosition","clipPlane","Vector4","textureMatrix","parameters","stencilBuffer","isPowerOfTwo","mirrorSampler","reflect","setFromNormalAndCoplanarPoint","constant","currentRenderTarget","currentXrEnabled","currentShadowAutoUpdate","SHORTHAND_INITIALIZER","SPREAD_SYNTAX","CATCH_SYNTAX","syntaxSupported","syntax","getPlatformSupport","supported","WebAssembly","isInAppBrowser","Support","showDetails","hasCopied","toggleDetails","onCopyClicked","platformSupport","allSupported","inAppBrowser","webpackAsyncContext","req","__webpack_require__","ids","__webpack_module_cache__","deferred","leafPrototypes","getProto","inProgress","dataWebpackPrefix","moduleId","cachedModule","__webpack_modules__","amdO","O","chunkIds","notFulfilled","fulfilled","getter","__esModule","getPrototypeOf","ns","def","definition","defineProperty","enumerable","chunkId","promises","miniCssF","globalThis","Function","script","needAttach","scripts","getElementsByTagName","charset","nc","onScriptComplete","doneFns","toStringTag","nmd","installedChunks","installedChunkData","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}